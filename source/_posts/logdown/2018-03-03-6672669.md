---
layout: post
title: 'Certbot更新憑證失敗記錄'
date: 2018-03-03 15:13
comments: true
categories: Apache
tags: [Linux,Aapache,certbot]
---
之前有做TSL加密自動化憑證
但是遇到一些問題
例否我更新Linux導至Certbot壞掉
但重安裝Certbot就沒有這個問題

除了我有設定防火牆問題
但還是失敗
不過最後還是找到原因，記錄一下

<!--more-->

更新完套件，指令換成了`certbot`
但用法還是大同小異
不過還是更新失敗了

首先手動執行
```
.certbot renew --dry-run
```
查看有什麼錯誤資訊

```
-------------------------------------------------------------------------------
Processing /etc/letsencrypt/renewal/zhukun.net.conf
-------------------------------------------------------------------------------
Cert not yet due for renewal

The following certs are not due for renewal yet:
  /etc/letsencrypt/live/zhukun.net/fullchain.pem (skipped)
No renewals were attempted.
```
有遇到正常的log
但看瀏覽器幫很正常...
後來爬文，原來要重啟apache...

有看到用hook-post方法
`certbot renew --post-hook "service httpd restart"`


不知道reload會不會就可以了
只能等下次5月更新才知道




* [启用Let’s Encrypt的免费SSL证书 | 月与灯依旧](https://www.zhukun.net/archives/8104)
* [Let's Encrypt SSL安装出现问题 - Linux面板 - 宝塔面板论坛](https://www.bt.cn/bbs/thread-7179-1-1.html)
* [letsencrypt 工具改成 certbot 了 | 壞蛋的密室](https://www.pigo.idv.tw/archives/3150)
* [通过Certbot配置Let's Encrypt的SSL（Apache） | StringBlog](https://stringblog.com/%E9%80%9A%E8%BF%87certbot%E9%85%8D%E7%BD%AElets-encrypt%E7%9A%84ssl%EF%BC%88apache%EF%BC%89/)