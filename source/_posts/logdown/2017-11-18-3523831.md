---
layout: post
title: "laradock架設筆記"
date: 2017-11-18 17:26
comments: true
categories: Laravel
tags: [Laravel, PHP, docker]
---

試試用 Docker 來記記 laravel 筆記

<!--more-->

1. 建置 laravel 專案
   composer 建立

```sh
composer global require "laravel/installer"
```

```sh
laravel new blog
```

或

```sh
composer create-project --prefer-dist laravel/laravel blog
```

沒有安裝 composer 可以直接 git clone 下來

```sh
git clone http://github.com/laravel/laravel
```

2. 建立 laradock 在 laravel 目錄下面

```sh
git submodule add https://github.com/Laradock/laradock.git
```

3. 在 laradocker 目錄下複製範例 example-env，命名為.env

```
cp env-example .env
```

4. 執行 docker

```sh
docker-compose up -d nginx mysql
```

5. 設置 laravel 目錄，env 設定 (PS:這邊的 env 跟 docker env 不一樣，不要搞錯了)

```
docker-compose exec workspace bash
```

```
$ root@workspace:/var/www# composer install
$ root@workspace:/var/www# cp .env.example .env
$ root@workspace:/var/www# php artisan key:generate
$ root@workspace:/var/www# exit
$root@server:~/laravel/laradock# cd ..
$root@server:~/laravel# sudo chmod -R 777 storage bootstrap/cache
```

6. 設定 laravel 裡的.env DB 設定

```
DB_DATABASE=default
DB_USERNAME=default
DB_PASSWORD=secret
```

請參照你的 laradocker DB 帳號、密碼去做設定
127.0.0.1 請改成 mysql or mariadb (依照 DB 選譯)

```
MYSQL_DATABASE=default
MYSQL_USER=default
MYSQL_PASSWORD=secret
```

已經測試過在 play with docker 可以跑了

2019-06-09
使用 MySQL 8.0 由於登入 caching_sha2_password
[unable to connect to MySQL after upgrade to latest (8) version · Issue #2043 · laradock/laradock](https://github.com/laradock/laradock/issues/2043)
[Documentation - Laradock](https://laradock.io/documentation/#change-the-mysql-version)
[SQLSTATE[HY000] [2054] The server requested authentication method unknown to the client · Issue #1392 · laradock/laradock](https://github.com/laradock/laradock/issues/1392#issuecomment-383631421)

假如 DB 沒限制的話，我推薦改使用 mariaDB
快速解決

參考來源
https://laravel.tw/docs/5.3/installation
http://laradock.io/guides/#set-up-your-laravel-project
不專業網管筆記: [ 練習] 使用 Laradock 建立 Laravel 開發環境 (舊版說明)
t301000.blogspot.com/2017/01/laradock-laravel.html
[laradock 数据库连接问题 | Laravel China 社区](https://learnku.com/articles/5893/laradock-database-connection-problem)
[Laradock — Laravel + Docker 輕量級環境打造 – Yifan Wu – Medium](https://medium.com/@yfancc20/laradock-%E8%BC%95%E9%87%8F-laravel-%E7%92%B0%E5%A2%83%E7%9A%84%E5%98%97%E8%A9%A6-%E5%B8%B8%E8%A6%8B%E9%8C%AF%E8%AA%A4-2fc6f0c21433)
