---
title: 程式發信 mail 的問題整理
date: 2020-10-28 23:59:31
tags: [linux]
categories: Linux
---

先蒐集，有空整理

<!--more-->


## 發信指令

[16 Command Examples to Send Email From The Linux Command Line](https://blog.edmdesigner.com/send-email-from-linux-command-line/)


## relay access denied

[Postfix - Relay access denied - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10069903)

[postfix relay access denied – 阿喵就像家](https://mlwmlw.org/2010/09/postfix-relay-access-denied/)

Mail Server 設定對應 IP 就可以發信出去了

## 黑名單

[DNSBL Information - Spam Database Lookup](https://www.dnsbl.info/dnsbl-database-check.php)

[Blocklist Removal Center - The Spamhaus Project](https://www.spamhaus.org/lookup/)


## 解決方案

1. 更換 Mail Server 主機 IP (workaround?)
2. DNS Server 設定MX
3. 設定SPF
4. 設定 DomainKey（DKIM）
5. 設定 DMARC
6. 開通25 Port


## 建製 mail 注意的事情

1. 整理發信來源IP
2. 調整DNS，A、PTR、MX、TXT record、DKIM
3. 向各Email服務商提出申請
4. 發信機主機名稱
5. LOG解析

## 相關DNS Resource 

調整DNS
A：正解
PTR：反解
MX：郵件交換紀錄
TXT record：SPF
DKIM

MX：讓DNS能正常解析
SPF：是一套電子郵件驗證機制，可指定哪些郵件伺服器有權為您的網域傳送電子郵件。
DKIM：會為每一封郵件加上數位簽名，幫助收件伺服器確認郵件並非偽造，而且在傳輸過程中未遭到竄改。

詳細: 
- [DNS資源紀錄(Resource Record)介紹](http://dns-learning.twnic.net.tw/bind/intro6.html)
- [鳥哥的 Linux 私房菜 -- DNS Server](http://linux.vbird.org/linux_server/0350dns.php)

nslookup
A記錄(正解)set q=a
ptr記錄(反解)set q=ptr
MX記錄(郵件交換記錄)set q=mx
TXT記錄(文字記錄)set q=txt


### nslookup 

[DNS傳播檢查 - Nslookup Tool](https://www.nslookuptool.com/cht/)

## 相關名稱意思

[ROKSO、SBL、XBL、PBL、DBL 是什么意思？ – 黄忠 – 博客](https://www.huangzhong.ca/zh/rokso-sbl-xbl-pbl-dbl/)